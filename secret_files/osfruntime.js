try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['osfruntime.js'] = (new Date()).getTime();
/* Office runtime JavaScript library */
/* Version: 16.0.7120.1000 */
/*
	Copyright (c) Microsoft Corporation.  All rights reserved.
*/


/*
	Your use of this file is governed by the Microsoft Services Agreement http://go.microsoft.com/fwlink/?LinkId=266419.
*/

var __extends=this&&this.__extends||function(b,a){for(var c in a)if(a.hasOwnProperty(c))b[c]=a[c];function d(){this.constructor=b}b.prototype=a===null?Object.create(a):(d.prototype=a.prototype,new d)},definePropertySave,isDefinePropertySupported=false;try{Object.defineProperty({},"myTestProperty",{"get":function(){return this.desc},"set":function(a){this.desc=a}});isDefinePropertySupported=true}catch(e){definePropertySave=Object.defineProperty;Object.defineProperty=function(){}}var OfficeExt;(function(b){var a=function(){var b=null,a=true;function c(){}c.prototype.isMsAjaxLoaded=function(){var b="function",c="undefined";if(typeof Sys!==c&&typeof Type!==c&&Sys.StringBuilder&&typeof Sys.StringBuilder===b&&Type.registerNamespace&&typeof Type.registerNamespace===b&&Type.registerClass&&typeof Type.registerClass===b&&typeof Function._validateParams===b&&Sys.Serialization&&Sys.Serialization.JavaScriptSerializer&&typeof Sys.Serialization.JavaScriptSerializer.serialize===b)return a;else return false};c.prototype.loadMsAjaxFull=function(b){var a=(window.location.protocol.toLowerCase()==="https:"?"https:":"http:")+"//ajax.aspnetcdn.com/ajax/3.5/MicrosoftAjax.js";OSF.OUtil.loadScript(a,b)};Object.defineProperty(c.prototype,"msAjaxError",{"get":function(){var a=this;if(a._msAjaxError==b&&a.isMsAjaxLoaded())a._msAjaxError=Error;return a._msAjaxError},"set":function(a){this._msAjaxError=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,"msAjaxSerializer",{"get":function(){var a=this;if(a._msAjaxSerializer==b&&a.isMsAjaxLoaded())a._msAjaxSerializer=Sys.Serialization.JavaScriptSerializer;return a._msAjaxSerializer},"set":function(a){this._msAjaxSerializer=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,"msAjaxString",{"get":function(){var a=this;if(a._msAjaxString==b&&a.isMsAjaxLoaded())a._msAjaxSerializer=String;return a._msAjaxString},"set":function(a){this._msAjaxString=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,"msAjaxDebug",{"get":function(){var a=this;if(a._msAjaxDebug==b&&a.isMsAjaxLoaded())a._msAjaxDebug=Sys.Debug;return a._msAjaxDebug},"set":function(a){this._msAjaxDebug=a},enumerable:a,configurable:a});return c}();b.MicrosoftAjaxFactory=a})(OfficeExt||(OfficeExt={}));var OsfMsAjaxFactory=new OfficeExt.MicrosoftAjaxFactory,OSF=OSF||{},OfficeExt;(function(b){var a=function(){function a(a){this._internalStorage=a}a.prototype.getItem=function(a){try{return this._internalStorage&&this._internalStorage.getItem(a)}catch(b){return null}};a.prototype.setItem=function(b,a){try{this._internalStorage&&this._internalStorage.setItem(b,a)}catch(c){}};a.prototype.clear=function(){try{this._internalStorage&&this._internalStorage.clear()}catch(a){}};a.prototype.removeItem=function(a){try{this._internalStorage&&this._internalStorage.removeItem(a)}catch(b){}};a.prototype.getKeysWithPrefix=function(d){var b=[];try{for(var e=this._internalStorage&&this._internalStorage.length||0,a=0;a<e;a++){var c=this._internalStorage.key(a);c.indexOf(d)===0&&b.push(c)}}catch(f){}return b};return a}();b.SafeStorage=a})(OfficeExt||(OfficeExt={}));OSF.XdmFieldName={ConversationUrl:"ConversationUrl",AppId:"AppId"};OSF.OUtil=function(){var h="focus",g="on",l="configurable",k="writable",f="enumerable",e="undefined",b=true,c=false,i=2147483647,a=null,d=-1,r=d,x="&_xdm_Info=",u="&_serializer_version=",v="_xdm_",A="_serializer_version=",o="#",t="&",m="class",q={},z=3e4,n=a,p=a,j=(new Date).getTime();function y(){var a=i*Math.random();a^=j^(new Date).getMilliseconds()<<Math.floor(Math.random()*(31-10));return a.toString(16)}function w(){if(!n){try{var b=window.sessionStorage}catch(c){b=a}n=new OfficeExt.SafeStorage(b)}return n}function s(e){for(var c=[],b=[],f=e.length,a,d=0;d<f;d++){a=e[d];if(a.tabIndex)if(a.tabIndex>0)b.push(a);else a.tabIndex===0&&c.push(a);else c.push(a)}b=b.sort(function(d,c){var a=d.tabIndex-c.tabIndex;if(a===0)a=b.indexOf(d)-b.indexOf(c);return a});return [].concat(b,c)}return {set_entropy:function(a){if(typeof a=="string")for(var b=0;b<a.length;b+=4){for(var d=0,c=0;c<4&&b+c<a.length;c++)d=(d<<8)+a.charCodeAt(b+c);j^=d}else if(typeof a=="number")j^=a;else j^=i*Math.random();j&=i},extend:function(b,a){var c=function(){};c.prototype=a.prototype;b.prototype=new c;b.prototype.constructor=b;b.uber=a.prototype;if(a.prototype.constructor===Object.prototype.constructor)a.prototype.constructor=a},setNamespace:function(b,a){if(a&&b&&!a[b])a[b]={}},unsetNamespace:function(b,a){if(a&&b&&a[b])delete a[b]},loadScript:function(f,g,h){if(f&&g){var k=window.document,d=q[f];if(!d){var e=k.createElement("script");e.type="text/javascript";d={loaded:c,pendingCallbacks:[g],timer:a};q[f]=d;var i=function(){if(d.timer!=a){clearTimeout(d.timer);delete d.timer}d.loaded=b;for(var e=d.pendingCallbacks.length,c=0;c<e;c++){var f=d.pendingCallbacks.shift();f()}},j=function(){delete q[f];if(d.timer!=a){clearTimeout(d.timer);delete d.timer}for(var c=d.pendingCallbacks.length,b=0;b<c;b++){var e=d.pendingCallbacks.shift();e()}};if(e.readyState)e.onreadystatechange=function(){if(e.readyState=="loaded"||e.readyState=="complete"){e.onreadystatechange=a;i()}};else e.onload=i;e.onerror=j;h=h||z;d.timer=setTimeout(j,h);e.src=f;k.getElementsByTagName("head")[0].appendChild(e)}else if(d.loaded)g();else d.pendingCallbacks.push(g)}},loadCSS:function(c){if(c){var b=window.document,a=b.createElement("link");a.type="text/css";a.rel="stylesheet";a.href=c;b.getElementsByTagName("head")[0].appendChild(a)}},parseEnum:function(b,c){var a=c[b.trim()];if(typeof a==e){OsfMsAjaxFactory.msAjaxDebug.trace("invalid enumeration string:"+b);throw OsfMsAjaxFactory.msAjaxError.argument("str")}return a},delayExecutionAndCache:function(){var a={calc:arguments[0]};return function(){if(a.calc){a.val=a.calc.apply(this,arguments);delete a.calc}return a.val}},getUniqueId:function(){r=r+1;return r.toString()},formatString:function(){var a=arguments,b=a[0];return b.replace(/{(\d+)}/gm,function(d,b){var c=parseInt(b,10)+1;return a[c]===undefined?"{"+b+"}":a[c]})},generateConversationId:function(){return [y(),y(),(new Date).getTime().toString()].join("_")},getFrameNameAndConversationId:function(b,c){var a=v+b+this.generateConversationId();c.setAttribute("name",a);return this.generateConversationId()},addXdmInfoAsHash:function(b,a){return OSF.OUtil.addInfoAsHash(b,x,a,c)},addSerializerVersionAsHash:function(c,a){return OSF.OUtil.addInfoAsHash(c,u,a,b)},addInfoAsHash:function(b,f,c,h){b=b.trim()||"";var e=b.split(o),g=e.shift(),d=e.join(o),a;if(h)a=[f,encodeURIComponent(c),d].join("");else a=[d,f,c].join("");return [g,o,a].join("")},parseXdmInfo:function(a){return OSF.OUtil.parseXdmInfoWithGivenFragment(a,window.location.hash)},parseXdmInfoWithGivenFragment:function(a,b){return OSF.OUtil.parseInfoWithGivenFragment(x,v,c,a,b)},parseSerializerVersion:function(a){return OSF.OUtil.parseSerializerVersionWithGivenFragment(a,window.location.hash)},parseSerializerVersionWithGivenFragment:function(a,c){return parseInt(OSF.OUtil.parseInfoWithGivenFragment(u,A,b,a,c))},parseInfoWithGivenFragment:function(m,j,k,i,l){var f=l.split(m),b=f.length>1?f[f.length-1]:a;if(k&&b!=a){if(b.indexOf(t)>=0)b=b.split(t)[0];b=decodeURIComponent(b)}var c=w();if(!i&&c){var e=window.name.indexOf(j);if(e>d){var g=window.name.indexOf(";",e);if(g==d)g=window.name.length;var h=window.name.substring(e,g);if(b)c.setItem(h,b);else b=c.getItem(h)}}return b},getConversationId:function(){var c=window.location.search,b=a;if(c){var d=c.indexOf("&");b=d>0?c.substring(1,d):c.substr(1);if(b&&b.charAt(b.length-1)==="="){b=b.substring(0,b.length-1);if(b)b=decodeURIComponent(b)}}return b},getInfoItems:function(b){var a=b.split("$");if(typeof a[1]==e)a=b.split("|");if(typeof a[1]==e)a=b.split("%7C");return a},getXdmFieldValue:function(e,d){var b="",c=OSF.OUtil.parseXdmInfo(d);if(c){var a=OSF.OUtil.getInfoItems(c);if(a!=undefined&&a.length>=3)switch(e){case OSF.XdmFieldName.ConversationUrl:b=a[2];case OSF.XdmFieldName.AppId:b=a[1]}}return b},validateParamObject:function(f,e){var a=Function._validateParams(arguments,[{name:"params",type:Object,mayBeNull:c},{name:"expectedProperties",type:Object,mayBeNull:c},{name:"callback",type:Function,mayBeNull:b}]);if(a)throw a;for(var d in e){a=Function._validateParameter(f[d],e[d],d);if(a)throw a}},writeProfilerMark:function(a){if(window.msWriteProfilerMark){window.msWriteProfilerMark(a);OsfMsAjaxFactory.msAjaxDebug.trace(a)}},outputDebug:function(a){typeof OsfMsAjaxFactory!==e&&OsfMsAjaxFactory.msAjaxDebug&&OsfMsAjaxFactory.msAjaxDebug.trace&&OsfMsAjaxFactory.msAjaxDebug.trace(a)},defineNondefaultProperty:function(e,f,a,c){a=a||{};for(var g in c){var d=c[g];if(a[d]==undefined)a[d]=b}Object.defineProperty(e,f,a);return e},defineNondefaultProperties:function(c,a,d){a=a||{};for(var b in a)OSF.OUtil.defineNondefaultProperty(c,b,a[b],d);return c},defineEnumerableProperty:function(c,b,a){return OSF.OUtil.defineNondefaultProperty(c,b,a,[f])},defineEnumerableProperties:function(b,a){return OSF.OUtil.defineNondefaultProperties(b,a,[f])},defineMutableProperty:function(c,b,a){return OSF.OUtil.defineNondefaultProperty(c,b,a,[k,f,l])},defineMutableProperties:function(b,a){return OSF.OUtil.defineNondefaultProperties(b,a,[k,f,l])},finalizeProperties:function(e,d){d=d||{};for(var g=Object.getOwnPropertyNames(e),i=g.length,f=0;f<i;f++){var h=g[f],a=Object.getOwnPropertyDescriptor(e,h);if(!a.get&&!a.set)a.writable=d.writable||c;a.configurable=d.configurable||c;a.enumerable=d.enumerable||b;Object.defineProperty(e,h,a)}return e},mapList:function(a,c){var b=[];if(a)for(var d in a)b.push(c(a[d]));return b},listContainsKey:function(d,e){for(var a in d)if(e==a)return b;return c},listContainsValue:function(a,d){for(var e in a)if(d==a[e])return b;return c},augmentList:function(a,b){var d=a.push?function(c,b){a.push(b)}:function(c,b){a[c]=b};for(var c in b)d(c,b[c])},redefineList:function(a,b){for(var d in a)delete a[d];for(var c in b)a[c]=b[c]},isArray:function(a){return Object.prototype.toString.apply(a)==="[object Array]"},isFunction:function(a){return Object.prototype.toString.apply(a)==="[object Function]"},isDate:function(a){return Object.prototype.toString.apply(a)==="[object Date]"},addEventListener:function(a,b,d){if(a.addEventListener)a.addEventListener(b,d,c);else if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&a.attachEvent)a.attachEvent(g+b,d);else a[g+b]=d},removeEventListener:function(b,d,e){if(b.removeEventListener)b.removeEventListener(d,e,c);else if(Sys.Browser.agent===Sys.Browser.InternetExplorer&&b.detachEvent)b.detachEvent(g+d,e);else b[g+d]=a},getCookieValue:function(b){var a=RegExp(b+"[^;]+").exec(document.cookie);return a.toString().replace(/^[^=]+./,"")},xhrGet:function(f,e,c){var a;try{a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState==4)if(a.status==200)e(a.responseText);else c(a.status)};a.open("GET",f,b);a.send()}catch(d){c(d)}},xhrGetFull:function(h,f,g,c){var a,e=f;try{a=new XMLHttpRequest;a.onreadystatechange=function(){if(a.readyState==4)if(a.status==200)g(a,e);else c(a.status)};a.open("GET",h,b);a.send()}catch(d){c(d)}},encodeBase64:function(c){if(!c)return c;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=[],b=[],h=0,j,g,i,d,e,f,a,m=c.length;do{j=c.charCodeAt(h++);g=c.charCodeAt(h++);i=c.charCodeAt(h++);a=0;d=j&255;e=j>>8;f=g&255;b[a++]=d>>2;b[a++]=(d&3)<<4|e>>4;b[a++]=(e&15)<<2|f>>6;b[a++]=f&63;if(!isNaN(g)){d=g>>8;e=i&255;f=i>>8;b[a++]=d>>2;b[a++]=(d&3)<<4|e>>4;b[a++]=(e&15)<<2|f>>6;b[a++]=f&63}if(isNaN(g))b[a-1]=64;else if(isNaN(i)){b[a-2]=64;b[a-1]=64}for(var k=0;k<a;k++)l.push(n.charAt(b[k]))}while(h<m);return l.join("")},getSessionStorage:function(){return w()},getLocalStorage:function(){if(!p){try{var b=window.localStorage}catch(c){b=a}p=new OfficeExt.SafeStorage(b)}return p},convertIntToCssHexColor:function(b){var a="#"+(Number(b)+16777216).toString(16).slice(-6);return a},attachClickHandler:function(a,b){a.onclick=function(){b()};a.ontouchend=function(a){b();a.preventDefault()}},getQueryStringParamValue:function(a,d){var e=Function._validateParams(arguments,[{name:"queryString",type:String,mayBeNull:c},{name:"paramName",type:String,mayBeNull:c}]);if(e){OsfMsAjaxFactory.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: Parameters cannot be null.");return ""}var b=new RegExp("[\\?&]"+d+"=([^&#]*)","i");if(!b.test(a)){OsfMsAjaxFactory.msAjaxDebug.trace("OSF_Outil_getQueryStringParamValue: The parameter is not found.");return ""}return b.exec(a)[1]},isiOS:function(){return window.navigator.userAgent.match(/(iPad|iPhone|iPod)/g)?b:c},isChrome:function(){return window.navigator.userAgent.indexOf("Chrome")>0&&!OSF.OUtil.isEdge()},isEdge:function(){return window.navigator.userAgent.indexOf("Edge")>0},isIE:function(){return window.navigator.userAgent.indexOf("Trident")>0},isFirefox:function(){return window.navigator.userAgent.indexOf("Firefox")>0},shallowCopy:function(a){var c=a.constructor();for(var b in a)if(a.hasOwnProperty(b))c[b]=a[b];return c},createObject:function(b){var d=a;if(b){d={};for(var e=b.length,c=0;c<e;c++)d[b[c].name]=b[c].value}return d},addClass:function(a,b){if(!OSF.OUtil.hasClass(a,b)){var c=a.getAttribute(m);if(c)a.setAttribute(m,c+" "+b);else a.setAttribute(m,b)}},hasClass:function(c,b){var a=c.getAttribute(m);return a&&a.match(new RegExp("(\\s|^)"+b+"(\\s|$)"))},focusToFirstTabbable:function(e,j){var g,i=c,f,k=function(){i=b},l=function(c,a,b){if(a<0||a>c)return d;else if(a===0&&b)return d;else if(a===c-1&&!b)return d;if(b)return a-1;else return a+1};e=s(e);g=j?e.length-1:0;if(e.length===0)return a;while(!i&&g>=0&&g<e.length){f=e[g];window.focus();f.addEventListener(h,k);f.focus();f.removeEventListener(h,k);g=l(e.length,g,j);if(!i&&f===document.activeElement)i=b}if(i)return f;else return a},focusToNextTabbable:function(f,o,m){var k,e,i=c,g,l=function(){i=b},n=function(b,c){for(var a=0;a<b.length;a++)if(b[a]===c)return a;return d},j=function(c,a,b){if(a<0||a>c)return d;else if(a===0&&b)return d;else if(a===c-1&&!b)return d;if(b)return a-1;else return a+1};f=s(f);k=n(f,o);e=j(f.length,k,m);if(e<0)return a;while(!i&&e>=0&&e<f.length){g=f[e];g.addEventListener(h,l);g.focus();g.removeEventListener(h,l);e=j(f.length,e,m);if(!i&&g===document.activeElement)i=b}if(i)return g;else return a}}}();OSF.OUtil.Guid=function(){var a=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return {generateNewGuid:function(){for(var c="",d=(new Date).getTime(),b=0;b<32&&d>0;b++){if(b==8||b==12||b==16||b==20)c+="-";c+=a[d%16];d=Math.floor(d/16)}for(;b<32;b++){if(b==8||b==12||b==16||b==20)c+="-";c+=a[Math.floor(Math.random()*16)]}return c}}}();window.OSF=OSF;var OfficeExt;(function(g){var c="\n",d=true,a=null,b="undefined",j=function(){function c(){}c.isInstanceOfType=function(f,e){if(typeof e===b||e===a)return false;if(e instanceof f)return d;var c=e.constructor;if(!c||typeof c!=="function"||!c.__typeName||c.__typeName==="Object")c=Object;return !!(c===f)||c.__typeName&&f.__typeName&&c.__typeName===f.__typeName};return c}();g.MsAjaxTypeHelper=j;var h=function(){var e="Parameter name: {0}";function d(){}d.create=function(c,b){var a=new Error(c);a.message=c;if(b)for(var d in b)a[d]=b[d];a.popStackFrame();return a};d.parameterCount=function(a){var c="Sys.ParameterCountException: "+(a?a:"Parameter count mismatch."),b=d.create(c,{name:"Sys.ParameterCountException"});b.popStackFrame();return b};d.argument=function(a,g){var b="Sys.ArgumentException: "+(g?g:"Value does not fall within the expected range.");if(a)b+=c+f.format(e,a);var h=d.create(b,{name:"Sys.ArgumentException",paramName:a});h.popStackFrame();return h};d.argumentNull=function(a,g){var b="Sys.ArgumentNullException: "+(g?g:"Value cannot be null.");if(a)b+=c+f.format(e,a);var h=d.create(b,{name:"Sys.ArgumentNullException",paramName:a});h.popStackFrame();return h};d.argumentOutOfRange=function(i,g,j){var h="Sys.ArgumentOutOfRangeException: "+(j?j:"Specified argument was out of the range of valid values.");if(i)h+=c+f.format(e,i);if(typeof g!==b&&g!==a)h+=c+f.format("Actual value was {0}.",g);var k=d.create(h,{name:"Sys.ArgumentOutOfRangeException",paramName:i,actualValue:g});k.popStackFrame();return k};d.argumentType=function(h,g,b,i){var a="Sys.ArgumentTypeException: ";if(i)a+=i;else if(g&&b)a+=f.format("Object of type '{0}' cannot be converted to type '{1}'.",g.getName?g.getName():g,b.getName?b.getName():b);else a+="Object cannot be converted to the required type.";if(h)a+=c+f.format(e,h);var j=d.create(a,{name:"Sys.ArgumentTypeException",paramName:h,actualType:g,expectedType:b});j.popStackFrame();return j};d.argumentUndefined=function(a,g){var b="Sys.ArgumentUndefinedException: "+(g?g:"Value cannot be undefined.");if(a)b+=c+f.format(e,a);var h=d.create(b,{name:"Sys.ArgumentUndefinedException",paramName:a});h.popStackFrame();return h};d.invalidOperation=function(a){var c="Sys.InvalidOperationException: "+(a?a:"Operation is not valid due to the current state of the object."),b=d.create(c,{name:"Sys.InvalidOperationException"});b.popStackFrame();return b};return d}();g.MsAjaxError=h;var f=function(){function a(){}a.format=function(c){for(var b=[],a=1;a<arguments.length;a++)b[a-1]=arguments[a];var d=c;return d.replace(/{(\d+)}/gm,function(d,a){var c=parseInt(a,10);return b[c]===undefined?"{"+a+"}":b[c]})};a.startsWith=function(b,a){return b.substr(0,a.length)===a};return a}();g.MsAjaxString=f;var i=function(){function a(){}a.trace=function(){};return a}();g.MsAjaxDebug=i;if(!OsfMsAjaxFactory.isMsAjaxLoaded()){var e=function(a,c,b){if(a.__typeName===undefined)a.__typeName=c;if(a.__class===undefined)a.__class=b};e(Function,"Function",d);e(Error,"Error",d);e(Object,"Object",d);e(String,"String",d);e(Boolean,"Boolean",d);e(Date,"Date",d);e(Number,"Number",d);e(RegExp,"RegExp",d);e(Array,"Array",d);if(!Function.createCallback)Function.createCallback=function(b,a){var c=Function._validateParams(arguments,[{name:"method",type:Function},{name:"context",mayBeNull:d}]);if(c)throw c;return function(){var e=arguments.length;if(e>0){for(var d=[],c=0;c<e;c++)d[c]=arguments[c];d[e]=a;return b.apply(this,d)}return b.call(this,a)}};if(!Function.createDelegate)Function.createDelegate=function(b,c){var a=Function._validateParams(arguments,[{name:"instance",mayBeNull:d},{name:"method",type:Function}]);if(a)throw a;return function(){return c.apply(b,arguments)}};if(!Function._validateParams)Function._validateParams=function(i,g,e){var c,f=g.length;e=e||typeof e===b;c=Function._validateParameterCount(i,g,e);if(c){c.popStackFrame();return c}for(var d=0,k=i.length;d<k;d++){var h=g[Math.min(d,f-1)],j=h.name;if(h.parameterArray)j+="["+(d-f+1)+"]";else if(!e&&d>=f)break;c=Function._validateParameter(i[d],h,j);if(c){c.popStackFrame();return c}}return a};if(!Function._validateParameterCount)Function._validateParameterCount=function(m,f,l){var b,e,c=f.length,g=m.length;if(g<c){var i=c;for(b=0;b<c;b++){var j=f[b];if(j.optional||j.parameterArray)i--}if(g<i)e=d}else if(l&&g>c){e=d;for(b=0;b<c;b++)if(f[b].parameterArray){e=false;break}}if(e){var k=h.parameterCount();k.popStackFrame();return k}return a};if(!Function._validateParameter)Function._validateParameter=function(e,c,j){var d,i=c.type,n=!!c.integer,m=!!c.domElement,o=!!c.mayBeNull;d=Function._validateParameterType(e,i,n,m,o,j);if(d){d.popStackFrame();return d}var g=c.elementType,h=!!c.elementMayBeNull;if(i===Array&&typeof e!==b&&e!==a&&(g||!h))for(var l=!!c.elementInteger,k=!!c.elementDomElement,f=0;f<e.length;f++){var p=e[f];d=Function._validateParameterType(p,g,l,k,h,j+"["+f+"]");if(d){d.popStackFrame();return d}}return a};if(!Function._validateParameterType)Function._validateParameterType=function(d,e,j,i,h,f){var c,k;if(typeof d===b)if(h)return a;else{c=g.MsAjaxError.argumentUndefined(f);c.popStackFrame();return c}if(d===a)if(h)return a;else{c=g.MsAjaxError.argumentNull(f);c.popStackFrame();return c}if(e&&!g.MsAjaxTypeHelper.isInstanceOfType(e,d)){c=g.MsAjaxError.argumentType(f,typeof d,e);c.popStackFrame();return c}return a};if(!window.Type)window.Type=Function;if(!Type.registerNamespace)Type.registerNamespace=function(d){for(var c=d.split("."),b=window,a=0;a<c.length;a++){b[c[a]]=b[c[a]]||{};b=b[c[a]]}};if(!Type.prototype.registerClass)Type.prototype.registerClass=function(a){a={}};typeof Sys===b&&Type.registerNamespace("Sys");if(!Error.prototype.popStackFrame)Error.prototype.popStackFrame=function(){var d=this;if(arguments.length!==0)throw h.parameterCount();if(typeof d.stack===b||d.stack===a||typeof d.fileName===b||d.fileName===a||typeof d.lineNumber===b||d.lineNumber===a)return;var e=d.stack.split(c),g=e[0],j=d.fileName+":"+d.lineNumber;while(typeof g!==b&&g!==a&&g.indexOf(j)===-1){e.shift();g=e[0]}var i=e[1];if(typeof i===b||i===a)return;var f=i.match(/@(.*):(\d+)$/);if(typeof f===b||f===a)return;d.fileName=f[1];d.lineNumber=parseInt(f[2]);e.shift();d.stack=e.join(c)};OsfMsAjaxFactory.msAjaxError=h;OsfMsAjaxFactory.msAjaxString=f;OsfMsAjaxFactory.msAjaxDebug=i}})(OfficeExt||(OfficeExt={}));var OfficeExt;(function(b){var a="undefined",c=null,d=function(){var h='["\\\\\\x00-\\x1F]',f='"',g="g";function d(){}d._init=function(){var c=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000b","\\f","\\r","\\u000e","\\u000f","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001a","\\u001b","\\u001c","\\u001d","\\u001e","\\u001f"];d._charsToEscape[0]="\\";d._charsToEscapeRegExs["\\"]=new RegExp("\\\\",g);d._escapeChars["\\"]="\\\\";d._charsToEscape[1]=f;d._charsToEscapeRegExs[f]=new RegExp(f,g);d._escapeChars[f]='\\"';for(var a=0;a<32;a++){var b=String.fromCharCode(a);d._charsToEscape[a+2]=b;d._charsToEscapeRegExs[b]=new RegExp(b,g);d._escapeChars[b]=c[a]}};d.serialize=function(b){var a=new e;d.serializeWithBuilder(b,a,false);return a.toString()};d.deserialize=function(a,f){if(a.length===0)throw b.MsAjaxError.argument("data","Cannot deserialize empty string.");try{var e=a.replace(d._dateRegEx,"$1new Date($2)");if(f&&d._jsonRegEx.test(e.replace(d._jsonStringRegEx,"")))throw c;return eval("("+e+")")}catch(g){throw b.MsAjaxError.argument("data","Cannot deserialize. The data does not correspond to valid JSON.")}};d.serializeBooleanWithBuilder=function(b,a){a.append(b.toString())};d.serializeNumberWithBuilder=function(a,c){if(isFinite(a))c.append(String(a));else throw b.MsAjaxError.invalidOperation("Cannot serialize non finite numbers.")};d.serializeStringWithBuilder=function(a,c){c.append(f);if(d._escapeRegEx.test(a)){d._charsToEscape.length===0&&d._init();if(a.length<128)a=a.replace(d._escapeRegExGlobal,function(a){return d._escapeChars[a]});else for(var e=0;e<34;e++){var b=d._charsToEscape[e];if(a.indexOf(b)!==-1)if(navigator.userAgent.indexOf("OPR/")>-1||navigator.userAgent.indexOf("Firefox")>-1)a=a.split(b).join(d._escapeChars[b]);else a=a.replace(d._charsToEscapeRegExs[b],d._escapeChars[b])}}c.append(a);c.append(f)};d.serializeWithBuilder=function(e,c,l,f){var g;switch(typeof e){case "object":if(e){if(f){for(var m=0;m<f.length;m++)if(f[m]===e)throw b.MsAjaxError.invalidOperation("Cannot serialize object with cyclic reference within child properties.")}else f=[];try{b.MsAjaxArray.add(f,e);if(b.MsAjaxTypeHelper.isInstanceOfType(Number,e))d.serializeNumberWithBuilder(e,c);else if(b.MsAjaxTypeHelper.isInstanceOfType(Boolean,e))d.serializeBooleanWithBuilder(e,c);else if(b.MsAjaxTypeHelper.isInstanceOfType(String,e))d.serializeStringWithBuilder(e,c);else if(b.MsAjaxTypeHelper.isInstanceOfType(Array,e)){c.append("[");for(g=0;g<e.length;++g){g>0&&c.append(",");d.serializeWithBuilder(e[g],c,false,f)}c.append("]")}else{if(b.MsAjaxTypeHelper.isInstanceOfType(Date,e)){c.append('"\\/Date(');c.append(e.getTime());c.append(')\\/"');break}var h=[],i=0;for(var j in e){if(b.MsAjaxString.startsWith(j,"$"))continue;if(j===d._serverTypeFieldName&&i!==0){h[i++]=h[0];h[0]=j}else h[i++]=j}l&&h.sort();c.append("{");var n=false;for(g=0;g<i;g++){var k=e[h[g]];if(typeof k!==a&&typeof k!=="function"){if(n)c.append(",");else n=true;d.serializeWithBuilder(h[g],c,l,f);c.append(":");d.serializeWithBuilder(k,c,l,f)}}c.append("}")}}finally{b.MsAjaxArray.removeAt(f,f.length-1)}}else c.append("null");break;case "number":d.serializeNumberWithBuilder(e,c);break;case "string":d.serializeStringWithBuilder(e,c);break;case "boolean":d.serializeBooleanWithBuilder(e,c);break;default:c.append("null")}};d.__patchVersion=0;d._charsToEscapeRegExs=[];d._charsToEscape=[];d._dateRegEx=new RegExp('(^|[^\\\\])\\"\\\\/Date\\((-?[0-9]+)(?:[a-zA-Z]|(?:\\+|-)[0-9]{4})?\\)\\\\/\\"',g);d._escapeChars={};d._escapeRegEx=new RegExp(h,"i");d._escapeRegExGlobal=new RegExp(h,g);d._jsonRegEx=new RegExp("[^,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]",g);d._jsonStringRegEx=new RegExp('"(\\\\.|[^"\\\\])*"',g);d._serverTypeFieldName="__type";return d}();b.MsAjaxJavaScriptSerializer=d;var f=function(){function b(){}b.add=function(a,b){a[a.length]=b};b.removeAt=function(a,b){a.splice(b,1)};b.clone=function(a){if(a.length===1)return [a[0]];else return Array.apply(c,a)};b.remove=function(c,d){var a=b.indexOf(c,d);a>=0&&c.splice(a,1);return a>=0};b.indexOf=function(e,f,b){if(typeof f===a)return -1;var d=e.length;if(d!==0){b=b-0;if(isNaN(b))b=0;else{if(isFinite(b))b=b-b%1;if(b<0)b=Math.max(0,d+b)}for(var c=b;c<d;c++)if(typeof e[c]!==a&&e[c]===f)return c}return -1};return b}();b.MsAjaxArray=f;var e=function(){function b(b){this._parts=typeof b!==a&&b!==c&&b!==""?[b.toString()]:[];this._value={};this._len=0}b.prototype.append=function(a){this._parts[this._parts.length]=a};b.prototype.toString=function(b){var e=this;b=b||"";var d=e._parts;if(e._len!==d.length){e._value={};e._len=d.length}var g=e._value;if(typeof g[b]===a){if(b!=="")for(var f=0;f<d.length;)if(typeof d[f]===a||d[f]===""||d[f]===c)d.splice(f,1);else f++;g[b]=e._parts.join(b)}return g[b]};return b}();b.MsAjaxStringBuilder=e;if(!OsfMsAjaxFactory.isMsAjaxLoaded())OsfMsAjaxFactory.msAjaxSerializer=d})(OfficeExt||(OfficeExt={}));OSF.OUtil.setNamespace("Microsoft",window);OSF.OUtil.setNamespace("Office",Microsoft);OSF.OUtil.setNamespace("Common",Microsoft.Office);OSF.SerializerVersion={MsAjax:0,Browser:1};var OfficeExt;(function(b){function a(){return true}b.appSpecificCheckOrigin=a})(OfficeExt||(OfficeExt={}));(function(a){"use strict";var j=new RegExp('"(\\\\.|[^"\\\\])*"',"g"),d=new RegExp("\\b(true|false|null)\\b","g"),h=new RegExp("-?(0|([1-9]\\d*))(\\.\\d+)?([eE][+-]?\\d+)?","g"),g=new RegExp("[^{:,\\[\\s](?=\\s*\\[)"),e=new RegExp("[^\\s\\[\\]{}:,]"),b="Cannot deserialize. The data does not correspond to valid JSON.";function k(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else a.attachEvent&&a.attachEvent("on"+b,c)}function f(){if(OsfMsAjaxFactory.msAjaxSerializer)return OsfMsAjaxFactory.msAjaxSerializer;return null}function i(f,k,i){var c;if(!k)return i(f);if(a.JSON&&a.JSON.parse)return a.JSON.parse(f);c=f.replace(j,"[]");c=c.replace(d,"[]");c=c.replace(h,"[]");if(g.test(c))throw b;if(e.test(c))throw b;try{eval("("+f+")")}catch(l){throw b}}function c(){var a=f(),b;if(a===null||typeof a.deserialize!=="function")return false;if(a.__patchVersion>=1)return true;b=a.deserialize;a.deserialize=function(a){return i(a,true,b)};a.__patchVersion=1;return true}!c()&&k(a,"load",function(){c()})})(window);Microsoft.Office.Common.InvokeType={async:0,sync:1,asyncRegisterEvent:2,asyncUnregisterEvent:3,syncRegisterEvent:4,syncUnregisterEvent:5};Microsoft.Office.Common.InvokeResultCode={noError:0,errorInRequest:-1,errorHandlingRequest:-2,errorInResponse:-3,errorHandlingResponse:-4,errorHandlingRequestAccessDenied:-5,errorHandlingMethodCallTimedout:-6};Microsoft.Office.Common.MessageType={request:0,response:1};Microsoft.Office.Common.ActionType={invoke:0,registerEvent:1,unregisterEvent:2};Microsoft.Office.Common.ResponseType={forCalling:0,forEventing:1};Microsoft.Office.Common.MethodObject=function(c,b,a){this._method=c;this._invokeType=b;this._blockingOthers=a};Microsoft.Office.Common.MethodObject.prototype={getMethod:function(){return this._method},getInvokeType:function(){return this._invokeType},getBlockingFlag:function(){return this._blockingOthers}};Microsoft.Office.Common.EventMethodObject=function(b,a){this._registerMethodObject=b;this._unregisterMethodObject=a};Microsoft.Office.Common.EventMethodObject.prototype={getRegisterMethodObject:function(){return this._registerMethodObject},getUnregisterMethodObject:function(){return this._unregisterMethodObject}};Microsoft.Office.Common.ServiceEndPoint=function(c){var a=this,b=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:false}]);if(b)throw b;a._methodObjectList={};a._eventHandlerProxyList={};a._Id=c;a._conversations={};a._policyManager=null;a._appDomains={};a._onHandleRequestError=null};Microsoft.Office.Common.ServiceEndPoint.prototype={registerMethod:function(g,h,b,e){var c="invokeType",a=false,d=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:a},{name:"method",type:Function,mayBeNull:a},{name:c,type:Number,mayBeNull:a},{name:"blockingOthers",type:Boolean,mayBeNull:a}]);if(d)throw d;if(b!==Microsoft.Office.Common.InvokeType.async&&b!==Microsoft.Office.Common.InvokeType.sync)throw OsfMsAjaxFactory.msAjaxError.argument(c);var f=new Microsoft.Office.Common.MethodObject(h,b,e);this._methodObjectList[g]=f},unregisterMethod:function(b){var a=Function._validateParams(arguments,[{name:"methodName",type:String,mayBeNull:false}]);if(a)throw a;delete this._methodObjectList[b]},registerEvent:function(f,d,c){var a=false,b=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:a},{name:"registerMethod",type:Function,mayBeNull:a},{name:"unregisterMethod",type:Function,mayBeNull:a}]);if(b)throw b;var e=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(d,Microsoft.Office.Common.InvokeType.syncRegisterEvent,a),new Microsoft.Office.Common.MethodObject(c,Microsoft.Office.Common.InvokeType.syncUnregisterEvent,a));this._methodObjectList[f]=e},registerEventEx:function(h,f,d,e,c){var a=false,b=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:a},{name:"registerMethod",type:Function,mayBeNull:a},{name:"registerMethodInvokeType",type:Number,mayBeNull:a},{name:"unregisterMethod",type:Function,mayBeNull:a},{name:"unregisterMethodInvokeType",type:Number,mayBeNull:a}]);if(b)throw b;var g=new Microsoft.Office.Common.EventMethodObject(new Microsoft.Office.Common.MethodObject(f,d,a),new Microsoft.Office.Common.MethodObject(e,c,a));this._methodObjectList[h]=g},unregisterEvent:function(b){var a=Function._validateParams(arguments,[{name:"eventName",type:String,mayBeNull:false}]);if(a)throw a;this.unregisterMethod(b)},registerConversation:function(c,g,b,f){var d="appDomains",a=true,e=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false},{name:"conversationUrl",type:String,mayBeNull:false,optional:a},{name:d,type:Object,mayBeNull:a,optional:a},{name:"serializerVersion",type:Number,mayBeNull:a,optional:a}]);if(e)throw e;if(b){if(!(b instanceof Array))throw OsfMsAjaxFactory.msAjaxError.argument(d);this._appDomains[c]=b}this._conversations[c]={url:g,serializerVersion:f}},unregisterConversation:function(b){var a=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false}]);if(a)throw a;delete this._conversations[b]},setPolicyManager:function(a){var b="policyManager",c=Function._validateParams(arguments,[{name:b,type:Object,mayBeNull:false}]);if(c)throw c;if(!a.checkPermission)throw OsfMsAjaxFactory.msAjaxError.argument(b);this._policyManager=a},getPolicyManager:function(){return this._policyManager}};Microsoft.Office.Common.ClientEndPoint=function(f,b,g,d){var c="targetWindow",a=this,e=Function._validateParams(arguments,[{name:"conversationId",type:String,mayBeNull:false},{name:c,mayBeNull:false},{name:"targetUrl",type:String,mayBeNull:false},{name:"serializerVersion",type:Number,mayBeNull:true,optional:true}]);if(e)throw e;try{if(!b.postMessage)throw OsfMsAjaxFactory.msAjaxError.argument(c)}catch(h){if(!Object.prototype.hasOwnProperty.call(b,"postMessage"))throw OsfMsAjaxFactory.msAjaxError.argument(c)}a._conversationId=f;a._targetWindow=b;a._targetUrl=g;a._callingIndex=0;a._callbackList={};a._eventHandlerList={};if(d!=null)a._serializerVersion=d;else a._serializerVersion=OSF.SerializerVersion.MsAjax};Microsoft.Office.Common.ClientEndPoint.prototype={invoke:function(h,d,b){var a=this,g=Function._validateParams(arguments,[{name:"targetMethodName",type:String,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"param",mayBeNull:true}]);if(g)throw g;var c=a._callingIndex++,k=new Date,e={callback:d,createdOn:k.getTime()};if(b&&typeof b==="object"&&typeof b.__timeout__==="number"){e.timeout=b.__timeout__;delete b.__timeout__}a._callbackList[c]=e;try{var i=new Microsoft.Office.Common.Request(h,Microsoft.Office.Common.ActionType.invoke,a._conversationId,c,b),j=Microsoft.Office.Common.MessagePackager.envelope(i,a._serializerVersion);a._targetWindow.postMessage(j,a._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(f){try{d!==null&&d(Microsoft.Office.Common.InvokeResultCode.errorInRequest,f)}finally{delete a._callbackList[c]}}},registerForEvent:function(d,g,c,i){var a=this,f=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:false},{name:"eventHandler",type:Function,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"data",mayBeNull:true,optional:true}]);if(f)throw f;var b=a._callingIndex++,k=new Date;a._callbackList[b]={callback:c,createdOn:k.getTime()};try{var h=new Microsoft.Office.Common.Request(d,Microsoft.Office.Common.ActionType.registerEvent,a._conversationId,b,i),j=Microsoft.Office.Common.MessagePackager.envelope(h,a._serializerVersion);a._targetWindow.postMessage(j,a._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer();a._eventHandlerList[d]=g}catch(e){try{c!==null&&c(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete a._callbackList[b]}}},unregisterForEvent:function(d,c,h){var a=this,f=Function._validateParams(arguments,[{name:"targetEventName",type:String,mayBeNull:false},{name:"callback",type:Function,mayBeNull:true},{name:"data",mayBeNull:true,optional:true}]);if(f)throw f;var b=a._callingIndex++,j=new Date;a._callbackList[b]={callback:c,createdOn:j.getTime()};try{var g=new Microsoft.Office.Common.Request(d,Microsoft.Office.Common.ActionType.unregisterEvent,a._conversationId,b,h),i=Microsoft.Office.Common.MessagePackager.envelope(g,a._serializerVersion);a._targetWindow.postMessage(i,a._targetUrl);Microsoft.Office.Common.XdmCommunicationManager._startMethodTimeoutTimer()}catch(e){try{c!==null&&c(Microsoft.Office.Common.InvokeResultCode.errorInRequest,e)}finally{delete a._callbackList[b]}}finally{delete a._eventHandlerList[d]}}};Microsoft.Office.Common.XdmCommunicationManager=function(){var d=true,k="channel is not ready.",c="conversationId",j="Unknown conversation Id.",b=false,a=null,m=[],l=a,f=a,p=10,i=b,g=a,v=2e3,o=65000,r=o,h={},e={},s=b;function x(b){for(var a in h)if(h[a]._conversations[b])return h[a];OsfMsAjaxFactory.msAjaxDebug.trace(j);throw OsfMsAjaxFactory.msAjaxError.argument(c)}function y(b){var a=e[b];if(!a){OsfMsAjaxFactory.msAjaxDebug.trace(j);throw OsfMsAjaxFactory.msAjaxError.argument(c)}return a}function B(e,c){var b=e._methodObjectList[c._actionName];if(!b){OsfMsAjaxFactory.msAjaxDebug.trace("The specified method is not registered on service endpoint:"+c._actionName);throw OsfMsAjaxFactory.msAjaxError.argument("messageObject")}var d=a;if(c._actionType===Microsoft.Office.Common.ActionType.invoke)d=b;else if(c._actionType===Microsoft.Office.Common.ActionType.registerEvent)d=b.getRegisterMethodObject();else d=b.getUnregisterMethodObject();return d}function E(a){m.push(a)}function D(){if(f!==a){if(!i)if(m.length>0){var b=m.shift();q(b)}else{clearInterval(f);f=a}}else OsfMsAjaxFactory.msAjaxDebug.trace(k)}function q(a){i=a.getInvokeBlockingFlag();a.invoke();l=(new Date).getTime()}function A(){if(g){var c,f=0,j=new Date,d;for(var i in e){c=e[i];for(var h in c._callbackList){var b=c._callbackList[h];d=b.timeout?b.timeout:r;if(d>=0&&Math.abs(j.getTime()-b.createdOn)>=d)try{b.callback&&b.callback(Microsoft.Office.Common.InvokeResultCode.errorHandlingMethodCallTimedout,a)}finally{delete c._callbackList[h]}else f++}}if(f===0){clearInterval(g);g=a}}else OsfMsAjaxFactory.msAjaxDebug.trace(k)}function z(){i=b}function C(a){if(window.addEventListener)window.addEventListener("message",a,b);else if(navigator.userAgent.indexOf("MSIE")>-1&&window.attachEvent)window.attachEvent("onmessage",a);else{OsfMsAjaxFactory.msAjaxDebug.trace("Browser doesn't support the required API.");throw OsfMsAjaxFactory.msAjaxError.argument("Browser")}}function n(e,f){var g=b;if(e===d)return d;if(!e||!f||!e.length||!f.length)return g;var c,a;c=document.createElement("a");a=document.createElement("a");c.href=e;a.href=f;g=u(c,a);delete c,a;return g}function w(a,g){var c=b;if(!g||!g.length||!a||!(a instanceof Array)||!a.length)return c;var f=document.createElement("a"),e=document.createElement("a");f.href=g;for(var d=0;d<a.length&&!c;d++)if(a[d].indexOf("://")!==-1){e.href=a[d];c=u(f,e)}delete f,e;return c}function u(a,b){return a.hostname==b.hostname&&a.protocol==b.protocol&&a.port==b.port}function F(e){var o="Access Denied";if(e.data!=""){var c,g=OSF.SerializerVersion.MsAjax,t=e.data;try{c=Microsoft.Office.Common.MessagePackager.unenvelope(t,OSF.SerializerVersion.Browser);g=c._serializerVersion!=a?c._serializerVersion:g}catch(j){}if(g!=OSF.SerializerVersion.Browser)try{c=Microsoft.Office.Common.MessagePackager.unenvelope(t,g)}catch(j){return}if(typeof c._messageType=="undefined")return;if(c._messageType===Microsoft.Office.Common.MessageType.request){var v=e.origin==a||e.origin=="null"?c._origin:e.origin;try{var h=x(c._conversationId),m=h._conversations[c._conversationId];g=m.serializerVersion!=a?m.serializerVersion:g;var u=h.getPolicyManager();if(u&&!u.checkPermission(c._conversationId,c._actionName,c._data))throw o;var J=B(h,c),G=new Microsoft.Office.Common.InvokeCompleteCallback(e.source,v,c._actionName,c._conversationId,c._correlationId,z,g),F=new Microsoft.Office.Common.Invoker(J,c._data,G,h._eventHandlerProxyList,c._conversationId,c._actionName,g),A=d;if(f==a)if((l==a||(new Date).getTime()-l>p)&&!i){q(F);A=b}else f=setInterval(D,p);A&&E(F)}catch(j){h&&h._onHandleRequestError&&h._onHandleRequestError(c,j);var C=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequest;if(j==o)C=Microsoft.Office.Common.InvokeResultCode.errorHandlingRequestAccessDenied;var I=new Microsoft.Office.Common.Response(c._actionName,c._conversationId,c._correlationId,C,Microsoft.Office.Common.ResponseType.forCalling,j),H=Microsoft.Office.Common.MessagePackager.envelope(I,g);e.source&&e.source.postMessage&&e.source.postMessage(H,v)}}else if(c._messageType===Microsoft.Office.Common.MessageType.response){var k=y(c._conversationId);k._serializerVersion=g;if(!n(k._targetUrl,e.origin))throw"Failed orgin check";if(c._responseType===Microsoft.Office.Common.ResponseType.forCalling){var r=k._callbackList[c._correlationId];if(r)try{r.callback&&r.callback(c._errorCode,c._data)}finally{delete k._callbackList[c._correlationId]}}else{var s=k._eventHandlerList[c._actionName];s!==undefined&&s!==a&&s(c._data)}}else return}}function t(){if(!s){C(F);s=d}}return {connect:function(b,d,f,c){var a=e[b];if(!a){t();a=new Microsoft.Office.Common.ClientEndPoint(b,d,f,c);e[b]=a}return a},getClientEndPoint:function(d){var a=Function._validateParams(arguments,[{name:c,type:String,mayBeNull:b}]);if(a)throw a;return e[d]},createServiceEndPoint:function(a){t();var b=new Microsoft.Office.Common.ServiceEndPoint(a);h[a]=b;return b},getServiceEndPoint:function(c){var a=Function._validateParams(arguments,[{name:"serviceEndPointId",type:String,mayBeNull:b}]);if(a)throw a;return h[c]},deleteClientEndPoint:function(d){var a=Function._validateParams(arguments,[{name:c,type:String,mayBeNull:b}]);if(a)throw a;delete e[d]},_setMethodTimeout:function(a){var c=Function._validateParams(arguments,[{name:"methodTimeout",type:Number,mayBeNull:b}]);if(c)throw c;r=a<=0?o:a},_startMethodTimeoutTimer:function(){if(!g)g=setInterval(A,v)}}}();Microsoft.Office.Common.Message=function(g,h,e,f,c){var b=false,a=this,d=Function._validateParams(arguments,[{name:"messageType",type:Number,mayBeNull:b},{name:"actionName",type:String,mayBeNull:b},{name:"conversationId",type:String,mayBeNull:b},{name:"correlationId",mayBeNull:b},{name:"data",mayBeNull:true,optional:true}]);if(d)throw d;a._messageType=g;a._actionName=h;a._conversationId=e;a._correlationId=f;a._origin=window.location.href;if(typeof c=="undefined")a._data=null;else a._data=c};Microsoft.Office.Common.Message.prototype={getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getOrigin:function(){return this._origin},getData:function(){return this._data},getMessageType:function(){return this._messageType}};Microsoft.Office.Common.Request=function(c,d,a,b,e){Microsoft.Office.Common.Request.uber.constructor.call(this,Microsoft.Office.Common.MessageType.request,c,a,b,e);this._actionType=d};OSF.OUtil.extend(Microsoft.Office.Common.Request,Microsoft.Office.Common.Message);Microsoft.Office.Common.Request.prototype.getActionType=function(){return this._actionType};Microsoft.Office.Common.Response=function(d,a,b,e,c,f){Microsoft.Office.Common.Response.uber.constructor.call(this,Microsoft.Office.Common.MessageType.response,d,a,b,f);this._errorCode=e;this._responseType=c};OSF.OUtil.extend(Microsoft.Office.Common.Response,Microsoft.Office.Common.Message);Microsoft.Office.Common.Response.prototype.getErrorCode=function(){return this._errorCode};Microsoft.Office.Common.Response.prototype.getResponseType=function(){return this._responseType};Microsoft.Office.Common.MessagePackager={envelope:function(a,b){if(b==OSF.SerializerVersion.Browser&&typeof JSON!=="undefined"){if(typeof a==="object")a._serializerVersion=b;return JSON.stringify(a)}else{if(typeof a==="object")a._serializerVersion=OSF.SerializerVersion.MsAjax;return OsfMsAjaxFactory.msAjaxSerializer.serialize(a)}},unenvelope:function(a,b){if(b==OSF.SerializerVersion.Browser&&typeof JSON!=="undefined")return JSON.parse(a);else return OsfMsAjaxFactory.msAjaxSerializer.deserialize(a,true)}};Microsoft.Office.Common.ResponseSender=function(f,i,k,g,h,j,e){var c=false,a=this,d=Function._validateParams(arguments,[{name:"requesterWindow",mayBeNull:c},{name:"requesterUrl",type:String,mayBeNull:c},{name:"actionName",type:String,mayBeNull:c},{name:"conversationId",type:String,mayBeNull:c},{name:"correlationId",mayBeNull:c},{name:"responsetype",type:Number,maybeNull:c},{name:"serializerVersion",type:Number,maybeNull:true,optional:true}]);if(d)throw d;a._requesterWindow=f;a._requesterUrl=i;a._actionName=k;a._conversationId=g;a._correlationId=h;a._invokeResultCode=Microsoft.Office.Common.InvokeResultCode.noError;a._responseType=j;var b=a;a._send=function(f){try{var d=new Microsoft.Office.Common.Response(b._actionName,b._conversationId,b._correlationId,b._invokeResultCode,b._responseType,f),c=Microsoft.Office.Common.MessagePackager.envelope(d,e);b._requesterWindow.postMessage(c,b._requesterUrl)}catch(a){OsfMsAjaxFactory.msAjaxDebug.trace("ResponseSender._send error:"+a.message)}}};Microsoft.Office.Common.ResponseSender.prototype={getRequesterWindow:function(){return this._requesterWindow},getRequesterUrl:function(){return this._requesterUrl},getActionName:function(){return this._actionName},getConversationId:function(){return this._conversationId},getCorrelationId:function(){return this._correlationId},getSend:function(){return this._send},setResultCode:function(a){this._invokeResultCode=a}};Microsoft.Office.Common.InvokeCompleteCallback=function(e,h,i,f,g,d,c){var b=this;Microsoft.Office.Common.InvokeCompleteCallback.uber.constructor.call(b,e,h,i,f,g,Microsoft.Office.Common.ResponseType.forCalling,c);b._postCallbackHandler=d;var a=b;b._send=function(f){try{var e=new Microsoft.Office.Common.Response(a._actionName,a._conversationId,a._correlationId,a._invokeResultCode,a._responseType,f),d=Microsoft.Office.Common.MessagePackager.envelope(e,c);a._requesterWindow.postMessage(d,a._requesterUrl);a._postCallbackHandler()}catch(b){OsfMsAjaxFactory.msAjaxDebug.trace("InvokeCompleteCallback._send error:"+b.message)}}};OSF.OUtil.extend(Microsoft.Office.Common.InvokeCompleteCallback,Microsoft.Office.Common.ResponseSender);Microsoft.Office.Common.Invoker=function(i,j,e,f,h,k,g){var c=true,b=false,a=this,d=Function._validateParams(arguments,[{name:"methodObject",mayBeNull:b},{name:"paramValue",mayBeNull:c},{name:"invokeCompleteCallback",mayBeNull:b},{name:"eventHandlerProxyList",mayBeNull:c},{name:"conversationId",type:String,mayBeNull:b},{name:"eventName",type:String,mayBeNull:b},{name:"serializerVersion",type:Number,mayBeNull:c,optional:c}]);if(d)throw d;a._methodObject=i;a._param=j;a._invokeCompleteCallback=e;a._eventHandlerProxyList=f;a._conversationId=h;a._eventName=k;a._serializerVersion=g};Microsoft.Office.Common.Invoker.prototype={invoke:function(){var a=this;try{var b;switch(a._methodObject.getInvokeType()){case Microsoft.Office.Common.InvokeType.async:a._methodObject.getMethod()(a._param,a._invokeCompleteCallback.getSend());break;case Microsoft.Office.Common.InvokeType.sync:b=a._methodObject.getMethod()(a._param);a._invokeCompleteCallback.getSend()(b);break;case Microsoft.Office.Common.InvokeType.syncRegisterEvent:var d=a._createEventHandlerProxyObject(a._invokeCompleteCallback);b=a._methodObject.getMethod()(d.getSend(),a._param);a._eventHandlerProxyList[a._conversationId+a._eventName]=d.getSend();a._invokeCompleteCallback.getSend()(b);break;case Microsoft.Office.Common.InvokeType.syncUnregisterEvent:var g=a._eventHandlerProxyList[a._conversationId+a._eventName];b=a._methodObject.getMethod()(g,a._param);delete a._eventHandlerProxyList[a._conversationId+a._eventName];a._invokeCompleteCallback.getSend()(b);break;case Microsoft.Office.Common.InvokeType.asyncRegisterEvent:var c=a._createEventHandlerProxyObject(a._invokeCompleteCallback);a._methodObject.getMethod()(c.getSend(),a._invokeCompleteCallback.getSend(),a._param);a._eventHandlerProxyList[a._callerId+a._eventName]=c.getSend();break;case Microsoft.Office.Common.InvokeType.asyncUnregisterEvent:var f=a._eventHandlerProxyList[a._callerId+a._eventName];a._methodObject.getMethod()(f,a._invokeCompleteCallback.getSend(),a._param);delete a._eventHandlerProxyList[a._callerId+a._eventName]}}catch(e){a._invokeCompleteCallback.setResultCode(Microsoft.Office.Common.InvokeResultCode.errorInResponse);a._invokeCompleteCallback.getSend()(e)}},getInvokeBlockingFlag:function(){return this._methodObject.getBlockingFlag()},_createEventHandlerProxyObject:function(a){return new Microsoft.Office.Common.ResponseSender(a.getRequesterWindow(),a.getRequesterUrl(),a.getActionName(),a.getConversationId(),a.getCorrelationId(),Microsoft.Office.Common.ResponseType.forEventing,this._serializerVersion)}};OSF.ShowWindowDialogParameterKeys={WindowUrl:"windowUrl",WindowSpecs:"windowSpecs",WindowName:"windowName",MarketPlaceId:"marketPlaceId"};var OfficeExt;(function(a){var b;(function(a){var b="&_app_context=",e="_app_context=";function f(c,a){return OSF.OUtil.addInfoAsHash(c,b,a,true)}a.addAppContextAsHash=f;function c(a,c){return OSF.OUtil.parseInfoWithGivenFragment(b,e,true,a,c)}a.parseAppContextWithGivenFragment=c;function d(a){if(typeof JSON!=="undefined")try{return JSON.stringify(a)}catch(b){}return ""}a.serializeObjectToString=d})(b=a.WACUtils||(a.WACUtils={}))})(OfficeExt||(OfficeExt={}));OSF.OUtil.setNamespace("OSF",window);OSF.AppName={Unsupported:0,Excel:1,Word:2,PowerPoint:4,Outlook:8,ExcelWebApp:16,WordWebApp:32,OutlookWebApp:64,Project:128,AccessWebApp:256,PowerpointWebApp:512,ExcelIOS:1024,Sway:2048,WordIOS:4096,PowerPointIOS:8192,Access:16384,Lync:32768,OutlookIOS:65536,OneNoteWebApp:131072,OneNote:262144,ExcelWinRT:524288,WordWinRT:1048576,PowerpointWinRT:2097152,OutlookAndroid:4194304,OneNoteWinRT:8388608};OSF.InternalPerfMarker={DataCoercionBegin:"Agave.HostCall.CoerceDataStart",DataCoercionEnd:"Agave.HostCall.CoerceDataEnd"};OSF.HostCallPerfMarker={IssueCall:"Agave.HostCall.IssueCall",ReceiveResponse:"Agave.HostCall.ReceiveResponse",RuntimeExceptionRaised:"Agave.HostCall.RuntimeExecptionRaised"};OSF.AgaveHostAction={Select:0,UnSelect:1,CancelDialog:2,InsertAgave:3,CtrlF6In:4,CtrlF6Exit:5,CtrlF6ExitShift:6,SelectWithError:7,NotifyHostError:8,RefreshAddinCommands:9,PageIsReady:10,TabIn:11,TabInShift:12,TabExit:13,TabExitShift:14,EscExit:15,F2Exit:16,ExitNoFocusable:17,ExitNoFocusableShift:18};OSF.SharedConstants={NotificationConversationIdSuffix:"_ntf"};OSF.DialogMessageType={DialogMessageReceived:0,DialogClosed:12006};OSF.OfficeAppContext=function(s,o,k,j,m,p,l,n,r,f,q,h,g,i,e,d,c,b){var a=this;a._id=s;a._appName=o;a._appVersion=k;a._appUILocale=j;a._dataLocale=m;a._docUrl=p;a._clientMode=l;a._settings=n;a._reason=r;a._osfControlType=f;a._eToken=q;a._correlationId=h;a._appInstanceId=g;a._touchEnabled=i;a._commerceAllowed=e;a._appMinorVersion=d;a._requirementMatrix=c;a._hostCustomMessage=b;a._isDialog=false;a.get_id=function(){return this._id};a.get_appName=function(){return this._appName};a.get_appVersion=function(){return this._appVersion};a.get_appUILocale=function(){return this._appUILocale};a.get_dataLocale=function(){return this._dataLocale};a.get_docUrl=function(){return this._docUrl};a.get_clientMode=function(){return this._clientMode};a.get_bindings=function(){return this._bindings};a.get_settings=function(){return this._settings};a.get_reason=function(){return this._reason};a.get_osfControlType=function(){return this._osfControlType};a.get_eToken=function(){return this._eToken};a.get_correlationId=function(){return this._correlationId};a.get_appInstanceId=function(){return this._appInstanceId};a.get_touchEnabled=function(){return this._touchEnabled};a.get_commerceAllowed=function(){return this._commerceAllowed};a.get_appMinorVersion=function(){return this._appMinorVersion};a.get_requirementMatrix=function(){return this._requirementMatrix};a.get_hostCustomMessage=function(){return this._hostCustomMessage};a.get_isDialog=function(){return this._isDialog}};OSF.OsfControlType={DocumentLevel:0,ContainerLevel:1};OSF.ClientMode={ReadOnly:0,ReadWrite:1};OSF.OUtil.setNamespace("Microsoft",window);OSF.OUtil.setNamespace("Office",Microsoft);OSF.OUtil.setNamespace("Client",Microsoft.Office);OSF.OUtil.setNamespace("WebExtension",Microsoft.Office);Microsoft.Office.WebExtension.InitializationReason={Inserted:"inserted",DocumentOpened:"documentOpened"};Microsoft.Office.WebExtension.ValueFormat={Unformatted:"unformatted",Formatted:"formatted"};Microsoft.Office.WebExtension.FilterType={All:"all"};Microsoft.Office.WebExtension.Parameters={BindingType:"bindingType",CoercionType:"coercionType",ValueFormat:"valueFormat",FilterType:"filterType",Columns:"columns",SampleData:"sampleData",GoToType:"goToType",SelectionMode:"selectionMode",Id:"id",PromptText:"promptText",ItemName:"itemName",FailOnCollision:"failOnCollision",StartRow:"startRow",StartColumn:"startColumn",RowCount:"rowCount",ColumnCount:"columnCount",Callback:"callback",AsyncContext:"asyncContext",Data:"data",Rows:"rows",OverwriteIfStale:"overwriteIfStale",FileType:"fileType",EventType:"eventType",Handler:"handler",SliceSize:"sliceSize",SliceIndex:"sliceIndex",ActiveView:"activeView",Status:"status",Xml:"xml",Namespace:"namespace",Prefix:"prefix",XPath:"xPath",Text:"text",ImageLeft:"imageLeft",ImageTop:"imageTop",ImageWidth:"imageWidth",ImageHeight:"imageHeight",TaskId:"taskId",FieldId:"fieldId",FieldValue:"fieldValue",ServerUrl:"serverUrl",ListName:"listName",ResourceId:"resourceId",ViewType:"viewType",ViewName:"viewName",GetRawValue:"getRawValue",CellFormat:"cellFormat",TableOptions:"tableOptions",TaskIndex:"taskIndex",ResourceIndex:"resourceIndex",Url:"url",MessageHandler:"messageHandler",Width:"width",Height:"height",RequireHTTPs:"requireHTTPS",MessageToParent:"messageToParent",XFrameDenySafe:"xFrameDenySafe"};OSF.OUtil.setNamespace("DDA",OSF);OSF.DDA.DocumentMode={ReadOnly:1,ReadWrite:0};OSF.DDA.PropertyDescriptors={AsyncResultStatus:"AsyncResultStatus"};OSF.DDA.EventDescriptors={};OSF.DDA.ListDescriptors={};OSF.DDA.UI={};OSF.DDA.getXdmEventName=function(b,a){if(a==Microsoft.Office.WebExtension.EventType.BindingSelectionChanged||a==Microsoft.Office.WebExtension.EventType.BindingDataChanged)return b+"_"+a;else return a};OSF.DDA.MethodDispId={dispidMethodMin:64,dispidGetSelectedDataMethod:64,dispidSetSelectedDataMethod:65,dispidAddBindingFromSelectionMethod:66,dispidAddBindingFromPromptMethod:67,dispidGetBindingMethod:68,dispidReleaseBindingMethod:69,dispidGetBindingDataMethod:70,dispidSetBindingDataMethod:71,dispidAddRowsMethod:72,dispidClearAllRowsMethod:73,dispidGetAllBindingsMethod:74,dispidLoadSettingsMethod:75,dispidSaveSettingsMethod:76,dispidGetDocumentCopyMethod:77,dispidAddBindingFromNamedItemMethod:78,dispidAddColumnsMethod:79,dispidGetDocumentCopyChunkMethod:80,dispidReleaseDocumentCopyMethod:81,dispidNavigateToMethod:82,dispidGetActiveViewMethod:83,dispidGetDocumentThemeMethod:84,dispidGetOfficeThemeMethod:85,dispidGetFilePropertiesMethod:86,dispidClearFormatsMethod:87,dispidSetTableOptionsMethod:88,dispidSetFormatsMethod:89,dispidExecuteRichApiRequestMethod:93,dispidAppCommandInvocationCompletedMethod:94,dispidCloseContainerMethod:97,dispidAddDataPartMethod:128,dispidGetDataPartByIdMethod:129,dispidGetDataPartsByNamespaceMethod:130,dispidGetDataPartXmlMethod:131,dispidGetDataPartNodesMethod:132,dispidDeleteDataPartMethod:133,dispidGetDataNodeValueMethod:134,dispidGetDataNodeXmlMethod:135,dispidGetDataNodesMethod:136,dispidSetDataNodeValueMethod:137,dispidSetDataNodeXmlMethod:138,dispidAddDataNamespaceMethod:139,dispidGetDataUriByPrefixMethod:140,dispidGetDataPrefixByUriMethod:141,dispidGetDataNodeTextMethod:142,dispidSetDataNodeTextMethod:143,dispidMessageParentMethod:144,dispidMethodMax:144,dispidGetSelectedTaskMethod:110,dispidGetSelectedResourceMethod:111,dispidGetTaskMethod:112,dispidGetResourceFieldMethod:113,dispidGetWSSUrlMethod:114,dispidGetTaskFieldMethod:115,dispidGetProjectFieldMethod:116,dispidGetSelectedViewMethod:117,dispidGetTaskByIndexMethod:118,dispidGetResourceByIndexMethod:119,dispidSetTaskFieldMethod:120,dispidSetResourceFieldMethod:121,dispidGetMaxTaskIndexMethod:122,dispidGetMaxResourceIndexMethod:123};OSF.DDA.EventDispId={dispidEventMin:0,dispidInitializeEvent:0,dispidSettingsChangedEvent:1,dispidDocumentSelectionChangedEvent:2,dispidBindingSelectionChangedEvent:3,dispidBindingDataChangedEvent:4,dispidDocumentOpenEvent:5,dispidDocumentCloseEvent:6,dispidActiveViewChangedEvent:7,dispidDocumentThemeChangedEvent:8,dispidOfficeThemeChangedEvent:9,dispidDialogMessageReceivedEvent:10,dispidActivationStatusChangedEvent:32,dispidAppCommandInvokedEvent:39,dispidTaskSelectionChangedEvent:56,dispidResourceSelectionChangedEvent:57,dispidViewSelectionChangedEvent:58,dispidDataNodeAddedEvent:60,dispidDataNodeReplacedEvent:61,dispidDataNodeDeletedEvent:62,dispidEventMax:63};OSF.XmlConstants={MaxXmlSize:1048576,MaxElementDepth:64};OSF.Xpath3Provider=function(f,e){var a=this;a._xmldoc=(new DOMParser).parseFromString(f,"text/xml");a._evaluator=new XPathEvaluator;a._namespaceMapping={};a._defaultNamespace=null;for(var d=e.split(" "),b,c=0;c<d.length;++c){b=/xmlns="([^"]*)"/g.exec(d[c]);if(b){a._defaultNamespace=b[1];continue}b=/xmlns:([^=]*)="([^"]*)"/g.exec(d[c]);if(b){a._namespaceMapping[b[1]]=b[2];continue}}a._resolver=a};OSF.Xpath3Provider.prototype={lookupNamespaceURI:function(a){var b=this._namespaceMapping[a];return b||this._defaultNamespace},selectSingleNode:function(d,a){var c=(a?"./":"/")+d;a=a||this.getDocumentElement();var b=this._evaluator.evaluate(c,a,this._resolver,XPathResult.FIRST_ORDERED_NODE_TYPE,null);if(b)return b.singleNodeValue;else return null},selectNodes:function(f,a){var e=(a?"./":"/")+f;a=a||this.getDocumentElement();var b=this._evaluator.evaluate(e,a,this._resolver,XPathResult.ORDERED_NODE_ITERATOR_TYPE,null),d=[];if(b){var c=b.iterateNext();while(c){d.push(c);c=b.iterateNext()}}return d},getDocumentElement:function(){return this._xmldoc.documentElement}};OSF.IEXpathProvider=function(f,e){for(var a=null,c=["MSXML2.DOMDocument.6.0"],b=0;b<c.length;b++)try{a=new ActiveXObject(c[b]);a.setProperty("ResolveExternals",false);a.setProperty("ValidateOnParse",false);a.setProperty("ProhibitDTD",true);a.setProperty("MaxXMLSize",OSF.XmlConstants.MaxXmlSize);a.setProperty("MaxElementDepth",OSF.XmlConstants.MaxElementDepth);a.async=false;a.loadXML(f);a.setProperty("SelectionLanguage","XPath");a.setProperty("SelectionNamespaces",e);break}catch(d){OsfMsAjaxFactory.msAjaxDebug.trace("xml doc creating error:"+d)}this._xmldoc=a};OSF.IEXpathProvider.prototype={selectSingleNode:function(c,a){var b=(a?"./":"/")+c;a=a||this.getDocumentElement();return a.selectSingleNode(b)},selectNodes:function(c,a){var b=(a?"./":"/")+c;a=a||this.getDocumentElement();return a.selectNodes(b)},getDocumentElement:function(){return this._xmldoc.documentElement},getActiveXObject:function(){return this._xmldoc}};OSF.DomParserProvider=function(g,f){var b=this;try{b._xmldoc=(new DOMParser).parseFromString(g,"text/xml")}catch(e){Sys.Debug.trace("xml doc creating error:"+e)}b._namespaceMapping={};b._defaultNamespace=null;for(var d=f.split(" "),a,c=0;c<d.length;++c){a=/xmlns="([^"]*)"/g.exec(d[c]);if(a){b._defaultNamespace=a[1];continue}a=/xmlns:([^=]*)="([^"]*)"/g.exec(d[c]);if(a){b._namespaceMapping[a[1]]=a[2];continue}}};OSF.DomParserProvider.prototype={selectSingleNode:function(d,c){var b=c||this._xmldoc,a=this._selectNodes(d,b);if(a.length===0)return null;return a[0]},selectNodes:function(c,b){var a=b||this._xmldoc;return this._selectNodes(c,a)},_selectNodes:function(h,g){var d=[];if(!h)return d;var a=h.split(":"),f,e;if(a.length===1){f=null;e=a[0]}else if(a.length===2){f=this._namespaceMapping[a[0]];e=a[1]}else throw OsfMsAjaxFactory.msAjaxError.argument("name");if(!g.hasChildNodes)return d;for(var c=g.childNodes,b=0;b<c.length;b++)e===this._removeNodePrefix(c[b].nodeName)&&f===c[b].namespaceURI&&d.push(c[b]);return d},_removeNodePrefix:function(b){var a=b.split(":");if(a.length===1)return b;else return a[1]},getDocumentElement:function(){return this._xmldoc.documentElement}};OSF.XmlProcessor=function(c,b){var a=this,d=Function._validateParams(arguments,[{name:"xml",type:String,mayBeNull:false},{name:"xmlNamespaces",type:String,mayBeNull:false}]);if(d)throw d;if(document.implementation&&document.implementation.hasFeature("XPath","3.0"))a._provider=new OSF.Xpath3Provider(c,b);else{a._provider=new OSF.IEXpathProvider(c,b);if(!a._provider.getActiveXObject())a._provider=new OSF.DomParserProvider(c,b)}};OSF.XmlProcessor.prototype={selectSingleNode:function(c,b){var a=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false},{name:"contextNode",mayBeNull:true,optional:true}]);if(a)throw a;return this._provider.selectSingleNode(c,b)},selectNodes:function(c,b){var a=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false},{name:"contextNode",mayBeNull:true,optional:true}]);if(a)throw a;return this._provider.selectNodes(c,b)},getDocumentElement:function(){return this._provider.getDocumentElement()},getNodeValue:function(b){var c=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(c)throw c;var a;if(b.text)a=b.text;else a=b.textContent;return a},getNodeXml:function(b){var c=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(c)throw c;var a;if(b.xml)a=b.xml;else a=(new XMLSerializer).serializeToString(b);return a},getNodeNamespaceURI:function(b){var a=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(a)throw a;return b.namespaceURI},getNodePrefix:function(b){var a=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(a)throw a;return b.prefix},getNodeBaseName:function(b){var c=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(c)throw c;var a;if(b.baseName)a=b.baseName;else a=b.localName;return a},getNodeType:function(b){var a=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false}]);if(a)throw a;return b.nodeType},_getAttributeLocalName:function(a){var b;if(a.localName)b=a.localName;else b=a.baseName;return b},readAttributes:function(e,c,h){var f=Function._validateParams(arguments,[{name:"node",type:Object,mayBeNull:false},{name:"attributesToRead",type:Object,mayBeNull:false},{name:"objectToFill",type:Object,mayBeNull:false}]);if(f)throw f;for(var a,d,b=0;b<e.attributes.length;b++){a=e.attributes[b];d=this._getAttributeLocalName(a);for(var g in c)if(d===g)h[c[g]]=a.value}}};var OfficeExt;(function(a){var c=function(){var a="undefined";function b(){}b.prototype.Serialize=function(b){try{if(typeof JSON!==a)return JSON.stringify(b);else return OsfMsAjaxFactory.msAjaxSerializer.serialize(b)}catch(c){return null}};b.prototype.Deserialize=function(b){try{if(typeof JSON!==a)return JSON.parse(b);else return OsfMsAjaxFactory.msAjaxSerializer.deserialize(b,true)}catch(c){return null}};return b}();a.SafeSerializer=c;var b=function(){function a(a,b){this._localStorage=a;this._serializer=b}a.prototype.GetCacheItem=function(g,d,e){var c=this;if(d===void 0)d=true;c.ValidateCurrentCache();var f=c._localStorage.getItem(g);if(f){var b=c._serializer.Deserialize(f);if(d){var h=new Date;if(Math.abs(h.getTime()-b.createdOn)<a.msPerDay*b.refreshRate)return b.data;else{c._localStorage.removeItem(g);if(e)e["cacheExpired"]=true}}else return b.data}};a.prototype.SetCacheItem=function(e,d,b){b=b||a.defaultRefreshRateInDays;var f=new Date,c={data:d,createdOn:f.getTime(),refreshRate:b};this._localStorage.setItem(e,this._serializer.Serialize(c))};a.prototype.RemoveCacheItem=function(a){this._localStorage.removeItem(a)};a.prototype.RemoveAll=function(c){for(var b=this._localStorage.getKeysWithPrefix(c),a=0,d=b.length;a<d;a++)this._localStorage.removeItem(b[a])};a.prototype.RemoveMatches=function(c){for(var d=this._localStorage.getKeysWithPrefix(""),a=0,g=d.length;a<g;a++)for(var e=d[a],b=0,f=c.length;b<f;b++)if(c[b].test(e)){this._localStorage.removeItem(e);break}};a.prototype.ValidateCurrentCache=function(){var b=this._localStorage.getItem(a.cacheVersionKey);if(b!=a.currentSchemaVersion){this.RemoveMatches([new RegExp("__OSF_(?!.*activated).*$","i")]);this._localStorage.setItem(a.cacheVersionKey,a.currentSchemaVersion)}};a.defaultRefreshRateInDays=3;a.msPerDay=8.64e7;a.currentSchemaVersion="1";a.checkedCache=false;a.cacheVersionKey="osfCacheVersion";return a}();a.AppsDataCacheManager=b})(OfficeExt||(OfficeExt={}));var OmexDataProvider=function(){var d=true,a=false,c=null;function b(a){this._cacheManager=a;this._cid="0"}b.GetInstance=function(a){if(b.instance==c)b.instance=new b(a);return b.instance};b.prototype.validateAndCacheNewManifest=function(){return a};b.prototype.localCacheAddinCommands=function(){};b.prototype.getEntitlementsAsync=function(f,h,e){var b,d=function(a){if(a!=c&&a.errorCode===OSF.InvokeResultCode.S_OK&&a.value){var g=a.value;b=[];for(var f=0;f<g.length;f++){var d=g[f],h={assetId:d[1],appVersion:d[4],storeId:d[11],storeType:OSF.StoreType.OMEX,targetType:d[3]};b.push(h)}}e(b)},g={storeType:OSF.StoreTypeEnum.MarketPlace,refresh:a,fromInsertDialog:a,callbackFunc:d};f.queryEntitlementDetails(g)};b.prototype.getManifestAsync=function(b,e){OSF.OUtil.validateParamObject(b,{contextActivationMgr:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a}},c);var g=this,h=function(a){if(a!=c&&a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var d=a.value,f=new OSF.Manifest.Manifest(d.manifest,b.contextActivationMgr.getAppUILocale());!a.cached&&g.SetManifestAndETokenCache(b,d);OSF.OsfManifestManager.cacheManifest(b.referenceInUse.id,b.referenceInUse.version,f);e({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:f,context:b})}else e({statusCode:OSF.ProxyCallStatusCode.Failed,value:c})},i=function(){if(b.contextActivationMgr._omexAnonymousWSProxy.isReady&&b.contextActivationMgr._omexAnonymousWSProxy.clientEndPoint!=c){b.anonymous=d;b.clientEndPoint=b.contextActivationMgr._omexAnonymousWSProxy.clientEndPoint;b.manifestManager=OSF.OsfManifestManager;var f={applicationName:b.contextActivationMgr._hostType,assetID:b.referenceInUse.id,build:OSF.Constants.FileVersion,clientName:b.contextActivationMgr._getClientNameForOmex(),clientVersion:b.contextActivationMgr._getClientVersionForOmex(),clientAppInfoReturnType:OSF.ClientAppInfoReturnType.urlOnly,errors:{},correlationId:c,contentMarket:b.referenceInUse.storeLocator,clearManifest:a};g.GetManifestAndEToken(b,f,h)}else e({statusCode:OSF.ProxyCallStatusCode.Failed,value:c})},f=OSF.OsfManifestManager.getCachedManifest(b.referenceInUse.id,b.referenceInUse.version);if(f==c)b.contextActivationMgr._createOmexProxy(b.contextActivationMgr._omexAnonymousWSProxy,i);else e({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:f,context:b})};b.prototype.GetCacheKeyPrefix=function(a){OSF.OUtil.validateParamObject(a,{anonymous:{type:Boolean,mayBeNull:d}},c);if(a.anonymous==c||a.anonymous)return b.anonymousCacheKeyPrefix;return b.gatedCacheKeyPrefix};b.prototype.GetCustomerId=function(){return this._cid};b.prototype.SetCustomerId=function(a){this._cid=a};b.prototype.AllCached=function(b,c){if(b&&!b.clearCache&&!b.clearToken&&!b.clearEntitlement&&!b.clearAppState&&!b.clearManifest)if(this.KilledAppsCached(b)&&this.AppStateCached(b,c)&&this.ManifestAndETokenCached(b,c))return d;return a};b.prototype.KilledAppsCached=function(f){var d=this.GetCacheKeyPrefix(f),e=OSF.OUtil.formatString(b.killedAppsWS.cacheKey,d),g=this._cacheManager.GetCacheItem(e,a);return g!=c};b.prototype.GetKilledApps=function(f,e,g){OSF.OUtil.validateParamObject(e,{clientName:{type:String,mayBeNull:d},clientVersion:{type:String,mayBeNull:d}},g);e.clearKilledApps=e.clearKilledApps||a;var h={context:f,statusCode:OSF.ProxyCallStatusCode.Succeeded,value:c,cached:a},i=OSF.OUtil.formatString(b.killedAppsWS.cacheKey,this.GetCacheKeyPrefix(f));if(e.clearKilledApps)this._cacheManager.RemoveCacheItem(i);else{var j=this._cacheManager.GetCacheItem(i,d,e.errors);if(j){h.value=j;h.cached=d;g(h);return}}f.manifestManager._invokeProxyMethodAsync(f,"OMEX_getKilledAppsAsync",g,e)};b.prototype.SetKilledAppsCache=function(f,d){OSF.OUtil.validateParamObject(d,{refreshRate:{type:String,mayBeNull:a}},c);var e=OSF.OUtil.formatString(b.killedAppsWS.cacheKey,this.GetCacheKeyPrefix(f));this._cacheManager.SetCacheItem(e,d,d.refreshRate/b.hourToDayConversionFactor)};b.prototype.AppStateCached=function(f,d){OSF.OUtil.validateParamObject(d,{assetID:{type:String,mayBeNull:a},contentMarket:{type:String,mayBeNull:a}},c);var e=OSF.OUtil.formatString(b.appStateWS.cacheKey,this.GetCacheKeyPrefix(f),d.contentMarket,d.assetID),g=this._cacheManager.GetCacheItem(e,a);return g!=c};b.prototype.GetAppState=function(f,e,g){OSF.OUtil.validateParamObject(e,{assetID:{type:String,mayBeNull:a},contentMarket:{type:String,mayBeNull:a},clientName:{type:String,mayBeNull:d},clientVersion:{type:String,mayBeNull:d}},g);e.clearAppState=e.clearAppState||a;var h={context:f,statusCode:OSF.ProxyCallStatusCode.Succeeded,value:c,cached:a},i=OSF.OUtil.formatString(b.appStateWS.cacheKey,this.GetCacheKeyPrefix(f),e.contentMarket,e.assetID);if(e.clearAppState)this._cacheManager.RemoveCacheItem(i);else{var j=this._cacheManager.GetCacheItem(i,d,e.errors);if(j){h.value=j;h.cached=d;g(h);return}}f.manifestManager._invokeProxyMethodAsync(f,"OMEX_getAppStateAsync",g,e)};b.prototype.SetAppStateCache=function(f,d){OSF.OUtil.validateParamObject(d,{refreshRate:{type:String,mayBeNull:a}},c);var e=f.referenceInUse,g=OSF.OUtil.formatString(b.appStateWS.cacheKey,this.GetCacheKeyPrefix(f),e.storeLocator,e.id);this._cacheManager.SetCacheItem(g,d,d.refreshRate/b.hourToDayConversionFactor)};b.prototype.ManifestAndETokenCached=function(f,d){OSF.OUtil.validateParamObject(d,{assetID:{type:String,mayBeNull:a},contentMarket:{type:String,mayBeNull:a}},c);var e;if(f.anonymous==c||f.anonymous)e=OSF.OUtil.formatString(b.anonymousAppInstallInfoWS.cacheKey,d.assetID,d.contentMarket);else e=OSF.OUtil.formatString(b.authenticatedAppInstallInfoWS.cacheKey,this._cid,d.assetID,d.userContentMarket,d.assetContentMarket);var g=this._cacheManager.GetCacheItem(e,a);return g!=c};b.prototype.GetManifestAndEToken=function(g,e,j){var k="OMEX_getManifestAndETokenAsync",l=this;OSF.OUtil.validateParamObject(e,{assetID:{type:String,mayBeNull:a},applicationName:{type:String,mayBeNull:a},contentMarket:{type:String,mayBeNull:d},userContentMarket:{type:String,mayBeNull:d},assetContentMarket:{type:String,mayBeNull:d},clientName:{type:String,mayBeNull:d},clientVersion:{type:String,mayBeNull:d}},j);e.clearToken=e.clearToken||a;e.clearManifest=e.clearManifest||a;var i={context:g,statusCode:OSF.ProxyCallStatusCode.Succeeded,value:c,cached:a},h;if(g.anonymous==c||g.anonymous)h=OSF.OUtil.formatString(b.anonymousAppInstallInfoWS.cacheKey,e.assetID,e.contentMarket);else h=OSF.OUtil.formatString(b.authenticatedAppInstallInfoWS.cacheKey,l._cid,e.assetID,e.userContentMarket,e.assetContentMarket);if(e.clearManifest)l._cacheManager.RemoveCacheItem(h);else{var f=l._cacheManager.GetCacheItem(h,d,e.errors);if(f){if(e.clearToken||f.tokenExpirationDate&&new Date(f.tokenExpirationDate)<=new Date){delete f.etoken;delete f.tokenExpirationDate;delete f.entitlementType}if((g.anonymous==c||g.anonymous||f.etoken)&&f.manifest){i.value=f;i.cached=d;j(i);return}}if(!g.anonymous){h=OSF.OUtil.formatString(b.anonymousAppInstallInfoWS.cacheKey,e.assetID,e.userContentMarket);var m=l._cacheManager.GetCacheItem(h,d,e.errors);if(m&&m.manifest){var n=function(b){var e=b.context;if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded&&b.value){var d=b.value,f=parseInt(d.status);if(f===OSF.OmexClientAppStatus.OK)d.manifest=m.manifest;i.context=e;i.value=d;j(i)}else j({context:e,statusCode:OSF.ProxyCallStatusCode.Failed,value:c,cached:a})};if(!f||!f.etoken){e.clientAppInfoReturnType=OSF.ClientAppInfoReturnType.etokenOnly;g.manifestManager._invokeProxyMethodAsync(g,k,n,e);return}}}}g.manifestManager._invokeProxyMethodAsync(g,k,j,e)};b.prototype.SetManifestAndETokenCache=function(d,f){var a=d.referenceInUse,e;if(d.anonymous==c||d.anonymous)e=OSF.OUtil.formatString(b.anonymousAppInstallInfoWS.cacheKey,a.id,a.storeLocator);else e=OSF.OUtil.formatString(b.authenticatedAppInstallInfoWS.cacheKey,this._cid,a.id,a.storeLocator,d.osfControl._omexEntitlement.contentMarket);this._cacheManager.SetCacheItem(e,f,b.manifestRefreshRate)};b.prototype.RemoveManifestAndEToken=function(d){var a=".*",c=[];c.push(new RegExp(OSF.OUtil.formatString(b.authenticatedAppInstallInfoWS.cacheKey,a,d,a,a),"i"));this._cacheManager.RemoveMatches(c)};b.prototype.AppDetailsCached=function(k,f){var c=[];for(var i in f){c=f[i].split(",");break}for(var j=[],e=0;e<c.length;++e){var g=OSF.OUtil.formatString(b.appDetailKey,c[e]),h=this._cacheManager.GetCacheItem(g,a);if(!h)return a}return d};b.prototype.GetAppDetails=function(f,e,i){OSF.OUtil.validateParamObject(e,{assetID:{type:String,mayBeNull:a},contentMarket:{type:String,mayBeNull:a},clientName:{type:String,mayBeNull:d},clientVersion:{type:String,mayBeNull:d}},i);e.clearCache=e.clearCache||a;e.appDetails=[];if(e.clearCache)this._cacheManager.RemoveAll(b.ungatedCacheKeyPrefix);else{for(var k=e.assetID.split(","),h=[],g=0;g<k.length;++g){var m=OSF.OUtil.formatString(b.appDetailKey,k[g]),l=this._cacheManager.GetCacheItem(m,d,e.errors);if(l)e.appDetails.push(l);else h.push(k[g])}if(h.length===0){var j={context:f,statusCode:OSF.ProxyCallStatusCode.Succeeded,value:c,cached:a};j.value=e.appDetails;j.cached=d;i(j);return}e.assetID=h.join(",")}f.appDetails=e.appDetails;f.manifestManager._invokeProxyMethodAsync(f,"OMEX_getAppDetailsAsync",i,e)};b.prototype.SetAppDetailsCache=function(f,d){for(var a,e,c=0;c<d.length;++c){a=d[c];e=OSF.OUtil.formatString(b.appDetailKey,a.assetId);this._cacheManager.SetCacheItem(e,a)}};b.anonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.";b.gatedCacheKeyPrefix="__OSF_GATED_OMEX.";b.ungatedCacheKeyPrefix="__OSF_OMEX.";b.manifestRefreshRate=5*365;b.hourToDayConversionFactor=24;b.anonymousAppInstallInfoWS={url:"/appinstall/unauthenticated?cmu={0}&assetid={1}&ret=0",cacheKey:b.anonymousCacheKeyPrefix+"appInstallInfo.{0}.{1}"};b.authenticatedAppInstallInfoWS={url:"/appinstall/authenticated?cmu={0}&cmf={1}&assetid={2}&ret={3}&rt=xml",cacheKey:b.gatedCacheKeyPrefix+"appinstall_authenticated.{0}.{1}.{2}.{3}"};b.killedAppsWS={url:"/appinfo/query?rt=xml",cacheKey:"{0}killedApps"};b.appStateWS={url:"/appstate/query?ma={0}:{1}",cacheKey:"{0}appState.{1}.{2}"};b.appDetailKey="__OSF_OMEX.appDetails.{0}";return b}(),OSFLog;(function(j){var f="Error",e="ResponseTime",d="Result",h="OperationMetadata",c="ErrorResult",g="AssetId",b="CorrelationId",a=true,i=function(){function b(a){this._table=a;this._fields={}}Object.defineProperty(b.prototype,"Fields",{"get":function(){return this._fields},enumerable:a,configurable:a});Object.defineProperty(b.prototype,"Table",{"get":function(){return this._table},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){};b.prototype.SetSerializedField=function(b,a){if(typeof a!=="undefined"&&a!==null)this._serializedFields[b]=a.toString()};b.prototype.SerializeRow=function(){var a=this;a._serializedFields={};a.SetSerializedField("Table",a._table);a.SerializeFields();return JSON.stringify(a._serializedFields)};return b}();j.BaseUsageData=i;var t=function(t){var s="Stage11Time",r="Stage10Time",q="Stage9Time",p="Stage8Time",o="Stage7Time",n="Stage6Time",m="Stage5Time",l="Stage4Time",k="Stage3Time",j="Stage2Time",i="Stage1Time",h="InstanceId",f="ActivationInfo",e="AppInfo";__extends(d,t);function d(){t.call(this,"AppLoadTime")}Object.defineProperty(d.prototype,b,{"get":function(){return this.Fields[b]},"set":function(a){this.Fields[b]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,h,{"get":function(){return this.Fields[h]},"set":function(a){this.Fields[h]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,g,{"get":function(){return this.Fields[g]},"set":function(a){this.Fields[g]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,i,{"get":function(){return this.Fields[i]},"set":function(a){this.Fields[i]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,j,{"get":function(){return this.Fields[j]},"set":function(a){this.Fields[j]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,k,{"get":function(){return this.Fields[k]},"set":function(a){this.Fields[k]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,l,{"get":function(){return this.Fields[l]},"set":function(a){this.Fields[l]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,m,{"get":function(){return this.Fields[m]},"set":function(a){this.Fields[m]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,n,{"get":function(){return this.Fields[n]},"set":function(a){this.Fields[n]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,o,{"get":function(){return this.Fields[o]},"set":function(a){this.Fields[o]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,p,{"get":function(){return this.Fields[p]},"set":function(a){this.Fields[p]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,q,{"get":function(){return this.Fields[q]},"set":function(a){this.Fields[q]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,r,{"get":function(){return this.Fields[r]},"set":function(a){this.Fields[r]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,s,{"get":function(){return this.Fields[s]},"set":function(a){this.Fields[s]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,c,{"get":function(){return this.Fields[c]},"set":function(a){this.Fields[c]=a},enumerable:a,configurable:a});d.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(b,a.CorrelationId);a.SetSerializedField(e,a.AppInfo);a.SetSerializedField(f,a.ActivationInfo);a.SetSerializedField(h,a.InstanceId);a.SetSerializedField(g,a.AssetId);a.SetSerializedField(i,a.Stage1Time);a.SetSerializedField(j,a.Stage2Time);a.SetSerializedField(k,a.Stage3Time);a.SetSerializedField(l,a.Stage4Time);a.SetSerializedField(m,a.Stage5Time);a.SetSerializedField(n,a.Stage6Time);a.SetSerializedField(o,a.Stage7Time);a.SetSerializedField(p,a.Stage8Time);a.SetSerializedField(q,a.Stage9Time);a.SetSerializedField(r,a.Stage10Time);a.SetSerializedField(s,a.Stage11Time);a.SetSerializedField(c,a.ErrorResult)};return d}(i);j.AppLoadTimeUsageData=t;var s=function(f){var d="NotificationClickInfo";__extends(e,f);function e(){f.call(this,"AppNotification")}Object.defineProperty(e.prototype,b,{"get":function(){return this.Fields[b]},"set":function(a){this.Fields[b]=a},enumerable:a,configurable:a});Object.defineProperty(e.prototype,c,{"get":function(){return this.Fields[c]},"set":function(a){this.Fields[c]=a},enumerable:a,configurable:a});Object.defineProperty(e.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});e.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(b,a.CorrelationId);a.SetSerializedField(c,a.ErrorResult);a.SetSerializedField(d,a.NotificationClickInfo)};return e}(i);j.AppNotificationUsageData=s;var r=function(d){__extends(b,d);function b(){d.call(this,"AppManagementMenu")}Object.defineProperty(b.prototype,g,{"get":function(){return this.Fields[g]},"set":function(a){this.Fields[g]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,h,{"get":function(){return this.Fields[h]},"set":function(a){this.Fields[h]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,c,{"get":function(){return this.Fields[c]},"set":function(a){this.Fields[c]=a},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(g,a.AssetId);a.SetSerializedField(h,a.OperationMetadata);a.SetSerializedField(c,a.ErrorResult)};return b}(i);j.AppManagementMenuUsageData=r;var p=function(i){var f="LastActiveTabCount",e="LastActiveTab",d="DialogState",c="TrustPageSessionTime",b="TotalSessionTime";__extends(h,i);function h(){i.call(this,"InsertionDialogSession")}Object.defineProperty(h.prototype,g,{"get":function(){return this.Fields[g]},"set":function(a){this.Fields[g]=a},enumerable:a,configurable:a});Object.defineProperty(h.prototype,b,{"get":function(){return this.Fields[b]},"set":function(a){this.Fields[b]=a},enumerable:a,configurable:a});Object.defineProperty(h.prototype,c,{"get":function(){return this.Fields[c]},"set":function(a){this.Fields[c]=a},enumerable:a,configurable:a});Object.defineProperty(h.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(h.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(h.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});h.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(g,a.AssetId);a.SetSerializedField(b,a.TotalSessionTime);a.SetSerializedField(c,a.TrustPageSessionTime);a.SetSerializedField(d,a.DialogState);a.SetSerializedField(e,a.LastActiveTab);a.SetSerializedField(f,a.LastActiveTabCount)};return h}(i);j.InsertionDialogSessionUsageData=p;var q=function(e){__extends(d,e);function d(){e.call(this,"UploadFileDevCatelog")}Object.defineProperty(d.prototype,b,{"get":function(){return this.Fields[b]},"set":function(a){this.Fields[b]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,h,{"get":function(){return this.Fields[h]},"set":function(a){this.Fields[h]=a},enumerable:a,configurable:a});Object.defineProperty(d.prototype,c,{"get":function(){return this.Fields[c]},"set":function(a){this.Fields[c]=a},enumerable:a,configurable:a});d.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(b,a.CorrelationId);a.SetSerializedField(h,a.OperationMetadata);a.SetSerializedField(c,a.ErrorResult)};return d}(i);j.UploadFileDevCatelogUsageData=q;var o=function(k){var j="AppSizeHeight",i="AppSizeWidth",h="IsAppCommand",g="AppTargetType",f="AppVersion",e="AppId",d="StoreType";__extends(c,k);function c(){k.call(this,"UploadFileDevCatalogUsage")}Object.defineProperty(c.prototype,b,{"get":function(){return this.Fields[b]},"set":function(a){this.Fields[b]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,g,{"get":function(){return this.Fields[g]},"set":function(a){this.Fields[g]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,h,{"get":function(){return this.Fields[h]},"set":function(a){this.Fields[h]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,i,{"get":function(){return this.Fields[i]},"set":function(a){this.Fields[i]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,j,{"get":function(){return this.Fields[j]},"set":function(a){this.Fields[j]=a},enumerable:a,configurable:a});c.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(b,a.CorrelationId);a.SetSerializedField(d,a.StoreType);a.SetSerializedField(e,a.AppId);a.SetSerializedField(f,a.AppVersion);a.SetSerializedField(g,a.AppTargetType);a.SetSerializedField(h,a.IsAppCommand);a.SetSerializedField(i,a.AppSizeWidth);a.SetSerializedField(j,a.AppSizeHeight)};return c}(i);j.UploadFileDevCatalogUsageUsageData=o;var k=function(c){__extends(b,c);function b(){c.call(this,"OneDriveCatalogGetAccessToken")}Object.defineProperty(b.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(d,a.Result);a.SetSerializedField(e,a.ResponseTime);a.SetSerializedField(f,a.Error)};return b}(i);j.OneDriveCatalogGetAccessTokenUsageData=k;var m=function(c){__extends(b,c);function b(){c.call(this,"OneDriveCatalogGetManifests")}Object.defineProperty(b.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(d,a.Result);a.SetSerializedField(e,a.ResponseTime);a.SetSerializedField(f,a.Error)};return b}(i);j.OneDriveCatalogGetManifestsUsageData=m;var n=function(g){var b="id";__extends(c,g);function c(){g.call(this,"OneDriveCatalogGetManifest")}Object.defineProperty(c.prototype,b,{"get":function(){return this.Fields[b]},"set":function(a){this.Fields[b]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(c.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});c.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(b,a.id);a.SetSerializedField(d,a.Result);a.SetSerializedField(e,a.ResponseTime);a.SetSerializedField(f,a.Error)};return c}(i);j.OneDriveCatalogGetManifestUsageData=n;var l=function(c){__extends(b,c);function b(){c.call(this,"OneDriveCatalogInsertManifest")}Object.defineProperty(b.prototype,d,{"get":function(){return this.Fields[d]},"set":function(a){this.Fields[d]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,e,{"get":function(){return this.Fields[e]},"set":function(a){this.Fields[e]=a},enumerable:a,configurable:a});Object.defineProperty(b.prototype,f,{"get":function(){return this.Fields[f]},"set":function(a){this.Fields[f]=a},enumerable:a,configurable:a});b.prototype.SerializeFields=function(){var a=this;a.SetSerializedField(d,a.Result);a.SetSerializedField(e,a.ResponseTime);a.SetSerializedField(f,a.Error)};return b}(i);j.OneDriveCatalogInsertManifestUsageData=l})(OSFLog||(OSFLog={}));var Telemetry;(function(a){var b=null;"use strict";(function(a){var c="verboseEx",b="unexpected";a[a[b]=10]=b;a[a["warning"]=15]="warning";a[a["info"]=50]="info";a[a["verbose"]=100]="verbose";a[a[c]=200]=c})(a.ULSTraceLevel||(a.ULSTraceLevel={}));var d=a.ULSTraceLevel;(function(a){var h="msoulscat_Osf_UploadFileDevCatalogUsage",g="msoulscat_Osf_UploadFileDevCatelog",f="msoulscat_Osf_InsertionDialogSession",e="msoulscat_Osf_AppManagementMenu",d="msoulscat_Osf_Runtime",c="msoulscat_Osf_Notification",b="msoulscat_Osf_Latency";a[a[b]=1401]=b;a[a[c]=1402]=c;a[a[d]=1403]=d;a[a[e]=1404]=e;a[a[f]=1405]=f;a[a[g]=1406]=g;a[a[h]=1411]=h})(a.ULSCat||(a.ULSCat={}));var f=a.ULSCat,h;(function(a){var d="IsAnonymous",c="InsertionDialogClosed",b="ConfirmationDialogCancel";a[a[b]=256]=b;a[a[c]=512]=c;a[a[d]=1024]=d})(h||(h={}));var g;(function(a){var d="TrustPageVisited",c="Canceled",b="Inserted",e="Undefined";a[a[e]=0]=e;a[a[b]=1]=b;a[a[c]=2]=c;a[a["Closed"]=3]="Closed";a[a[d]=8]=d})(g||(g={}));var c=function(){var a=true;function b(){this.timeValue=0}b.prototype.Start=function(){this.timeValue=-(new Date).getTime();this.finishedMeasurement=false};b.prototype.Stop=function(){if(this.timeValue<0){this.timeValue+=(new Date).getTime();this.finishedMeasurement=a}};Object.defineProperty(b.prototype,"Finished",{"get":function(){return this.finishedMeasurement},enumerable:a,configurable:a});Object.defineProperty(b.prototype,"ElapsedTime",{"get":function(){var a=this.timeValue;if(!this.Finished&&a<0)a=Math.abs(a)-(new Date).getTime();return a},enumerable:a,configurable:a});return b}();a.LatencyStopwatch=c;var v=function(){function a(){}return a}();a.Context=v;var e=function(){function a(){}a.SendULSTraceTag=function(a,b,d,c){if(!Microsoft.Office.WebExtension.FULSSupported)return;Diag.UULS.trace(c,a,b,d)};return a}(),m=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){e.SendULSTraceTag(a.category,a.level,b.SerializeRow(),6062431)};a.category=f.msoulscat_Osf_Notification;a.level=d.info;return a}();a.NotificationLogger=m;var l=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){e.SendULSTraceTag(a.category,a.level,b.SerializeRow(),17085957)};a.category=f.msoulscat_Osf_AppManagementMenu;a.level=d.info;return a}();a.AppManagementMenuLogger=l;var k=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){e.SendULSTraceTag(a.category,a.level,b.SerializeRow(),17085958)};a.category=f.msoulscat_Osf_UploadFileDevCatelog;a.level=d.info;return a}();a.UploadFileDevCatelogLogger=k;var i=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){e.SendULSTraceTag(a.category,a.level,b.SerializeRow(),17834653)};a.category=f.msoulscat_Osf_UploadFileDevCatalogUsage;a.level=d.info;return a}();a.UploadFileDevCatalogUsageLogger=i;var n=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){e.SendULSTraceTag(a.category,a.level,b.SerializeRow(),4748055)};a.category=f.msoulscat_Osf_Latency;a.level=d.info;return a}();a.LatencyLogger=n;var j=function(){function a(){}a.Instance=function(){if(!a.instance)a.instance=new a;return a.instance};a.prototype.LogData=function(b){e.SendULSTraceTag(a.category,a.level,b.SerializeRow(),17085959)};a.category=f.msoulscat_Osf_InsertionDialogSession;a.level=d.info;return a}();a.InsertionDialogSessionLogger=j;var t=function(){function a(){}a.LogNotification=function(c,d,b){var a=new OSFLog.AppNotificationUsageData;a.CorrelationId=c;a.ErrorResult=d;a.NotificationClickInfo=b;m.Instance().LogData(a)};return a}();a.AppNotificationHelper=t;var r=function(){function a(){}a.LogAppManagementMenuAction=function(c,b,i,d,f,g){var a=new OSFLog.AppManagementMenuUsageData,e=c.toLowerCase().indexOf("wa")===0?parseInt(c.substring(2),10):parseInt(c,10);if(d)b|=h.InsertionDialogClosed;if(f)b|=h.IsAnonymous;a.AssetId=e;a.OperationMetadata=b;a.ErrorResult=g;l.Instance().LogData(a)};return a}();a.AppManagementMenuHelper=r;var q=function(){function a(){}a.LogUploadFileDevCatelogAction=function(c,b,f,e,g,d){var a=new OSFLog.UploadFileDevCatelogUsageData;a.CorrelationId=c;a.OperationMetadata=b;a.ErrorResult=d;k.Instance().LogData(a)};return a}();a.UploadFileDevCatelogHelper=q;var o=function(){function a(){}a.LogUploadFileDevCatalogUsageAction=function(d,h,j,g,c,f,e,b){var a=new OSFLog.UploadFileDevCatalogUsageUsageData;a.CorrelationId=d;a.StoreType=h;a.AppId=j;a.AppVersion=g;a.AppTargetType=c;a.IsAppCommand=f;a.AppSizeWidth=e;a.AppSizeHeight=b;i.Instance().LogData(a)};return a}();a.UploadFileDevCatalogUsageHelper=o;var u=function(){var l="Stage11Time",k="Stage10Time",j="Stage9Time",i="Stage8Time",h="Stage7Time",g="Stage5Time",f="Stage4Time",e="Stage2Time",d="Stage1Time";function a(){}a.ActivationStart=function(b,o,p,m,n){a.activatingNumber++;b.LoadTime=new OSFLog.AppLoadTimeUsageData;b.Timers={};b.LoadTime.CorrelationId=m;b.LoadTime.AppInfo=o;b.LoadTime.ActivationInfo=0;b.LoadTime.InstanceId=n;b.LoadTime.AssetId=p;b.LoadTime.Stage1Time=0;b.Timers[d]=new c;b.LoadTime.Stage2Time=0;b.Timers[e]=new c;b.LoadTime.Stage3Time=0;b.LoadTime.Stage4Time=0;b.Timers[f]=new c;b.LoadTime.Stage5Time=0;b.Timers[g]=new c;b.LoadTime.Stage6Time=a.activatingNumber;b.LoadTime.Stage7Time=0;b.Timers[h]=new c;b.LoadTime.Stage8Time=0;b.Timers[i]=new c;b.LoadTime.Stage9Time=0;b.Timers[j]=new c;b.LoadTime.Stage10Time=0;b.Timers[k]=new c;b.LoadTime.Stage11Time=0;b.Timers[l]=new c;b.LoadTime.ErrorResult=0;a.StartStopwatch(b,d)};a.ActivationEnd=function(b){a.ActivateEndInternal(b)};a.PageStart=function(b){a.StartStopwatch(b,e)};a.PageLoaded=function(b){a.StopStopwatch(b,e)};a.ServerCallStart=function(b){a.StartStopwatch(b,f)};a.ServerCallEnd=function(b){a.StopStopwatch(b,f)};a.AuthenticationStart=function(b){a.StartStopwatch(b,g)};a.AuthenticationEnd=function(b){a.StopStopwatch(b,g)};a.EntitlementCheckStart=function(b){a.StartStopwatch(b,h)};a.EntitlementCheckEnd=function(b){a.StopStopwatch(b,h)};a.KilledAppsCheckStart=function(b){a.StartStopwatch(b,i)};a.KilledAppsCheckEnd=function(b){a.StopStopwatch(b,i)};a.AppStateCheckStart=function(b){a.StartStopwatch(b,j)};a.AppStateCheckEnd=function(b){a.StopStopwatch(b,j)};a.ManifestRequestStart=function(b){a.StartStopwatch(b,k)};a.ManifestRequestEnd=function(b){a.StopStopwatch(b,k)};a.OfficeJSStartToLoad=function(b){a.StartStopwatch(b,l)};a.OfficeJSLoaded=function(b){a.StopStopwatch(b,l)};a.SetAnonymousFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,0)};a.SetRetryCount=function(c,b){a.SetActivationInfoField(c,b,3,2)};a.SetManifestTrustCachedFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,5)};a.SetManifestDataCachedFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,7)};a.SetOmexHasEntitlementFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,9)};a.SetManifestDataInvalidFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,11)};a.SetAppStateDataCachedFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,13)};a.SetAppStateDataInvalidFlag=function(c,b){a.SetActivationInfoField(c,a.ConvertFlagToBit(b),2,15)};a.SetActivationRuntimeType=function(c,b){a.SetActivationInfoField(c,b,2,17)};a.SetErrorResult=function(b,c){if(b.LoadTime){b.LoadTime.ErrorResult=c;a.ActivateEndInternal(b)}};a.SetBit=function(b,e,d,c){a.SetActivationInfoField(b,e,c||2,d)};a.StartStopwatch=function(b,c){if(b.LoadTime&&b.Timers&&b.Timers[c]){b.Timers[c].Start();a.UpdateActivatingNumber(b)}};a.StopStopwatch=function(b,c){if(b.LoadTime&&b.Timers&&b.Timers[c]){b.Timers[c].Stop();a.UpdateActivatingNumber(b)}};a.ConvertFlagToBit=function(a){if(a)return 2;else return 1};a.SetActivationInfoField=function(b,e,c,d){if(b.LoadTime){a.UpdateActivatingNumber(b);b.LoadTime.ActivationInfo=a.SetBitField(b.LoadTime.ActivationInfo,e,c,d)}};a.SetBitField=function(d,e,c,a){var f=Math.pow(2,c)-1<<a,b=d&~f;return b|e<<a};a.UpdateActivatingNumber=function(b){if(b.LoadTime)b.LoadTime.Stage6Time=b.LoadTime.Stage6Time>a.activatingNumber?b.LoadTime.Stage6Time:a.activatingNumber};a.ActivateEndInternal=function(c){if(c.LoadTime){a.StopStopwatch(c,d);if(c.Timers)for(var e in c.Timers)if(c.Timers[e].ElapsedTime!=b)c.LoadTime[e]=c.Timers[e].ElapsedTime;n.Instance().LogData(c.LoadTime);c.LoadTime=b;a.activatingNumber--}};a.activatingNumber=0;return a}();a.AppLoadTimeHelper=u;var s=function(){var c=" AppCorrelationId:";function a(){}a.LogProxyFailure=function(f,h,g){var c;if(f==b)f="";c=OSF.OUtil.formatString("appCorrelationId:{0}, methodName:{1}",f,h);Object.keys(g).forEach(function(d){var a=g[d];if(a!=b)a=a.toString();c+=", "+d+":"+a});e.SendULSTraceTag(a.category,d.warning,c,6062432)};a.LogExceptionTag=function(i,f,h,j){var g=i;if(f){if(f.name)g+=" Exception name:"+f.name+".";if(f.paramName)g+=" Param name:"+f.paramName+"."}if(h!=b)g+=c+h+".";e.SendULSTraceTag(a.category,d.warning,g,j)};a.LogCommonMessage=function(g,f,h){if(f!=b)g+=c+f+".";e.SendULSTraceTag(a.category,d.info,g,h)};a.category=f.msoulscat_Osf_Runtime;return a}();a.RuntimeTelemetryHelper=s;var p=function(){function a(){}a.LogInsertionDialogSession=function(c,f,d,k,i,e){var a=new OSFLog.InsertionDialogSessionUsageData,h=c.toLowerCase().indexOf("wa")===0?parseInt(c.substring(2),10):parseInt(c,10),b=g.Undefined;if(k)b|=g.Inserted;else b|=g.Canceled;if(d>0)b|=g.TrustPageVisited;a.AssetId=h;a.TotalSessionTime=f;a.TrustPageSessionTime=d;a.DialogState=b;a.LastActiveTab=i;a.LastActiveTabCount=e;j.Instance().LogData(a)};return a}();a.InsertionDialogSessionHelper=p})(Telemetry||(Telemetry={}));var OfficeExt;(function(a){var b;(function(m){var h="ov:Control",d="ov:Description",c="ov:Title",g="bt:Image",f="ov:VersionOverrides",e="o:OfficeApp",a=null,i=function(){function a(a){this.name="AddinManifestError";this.message=this.name+": "+a}return a}(),t=function(){function a(a){this.name="AddinInternalError";this.message=a}return a}();function b(c,b){if(c==a)throw new i(b)}var n=function(){function a(b){var c="bt:String",a=this;a.Images={};a.Urls={};a.LongStrings={};a.ShortStrings={};var h=b.manifest._xmlProcessor.selectSingleNode(e),d=b.selectSingleNode(h,[f,"ov:Resources"]);a.parseCollection(b,b.selectChildNodes(g,d,["bt:Images"]),a.Images);a.parseCollection(b,b.selectChildNodes("bt:Url",d,["bt:Urls"]),a.Urls);a.parseCollection(b,b.selectChildNodes(c,d,["bt:LongStrings"]),a.LongStrings);a.parseCollection(b,b.selectChildNodes(c,d,["bt:ShortStrings"]),a.ShortStrings)}a.prototype.parseCollection=function(d,b,f){for(var e=b.length,a=0;a<e;a++){var c=b[a],g=c.getAttribute("id");f[g]=d.parseLocaleAwareSettingsAndGetValue(c)}};return a}();m.ManifestResourceManager=n;var j=function(){function e(d,c,b,e){var a=this;a.hostType=d;a.formFactor=c;a.entitlement=b;a.manifest=e;a.resources=new n(a)}e.prototype.parseIdRequired=function(c){var a=c.getAttribute("id");b(a,"Id required");return a};e.prototype.parseLabel=function(c){var b=this.manifest._xmlProcessor.selectSingleNode("ov:Label",c);if(b!=a)return this.getShortString(b);return a};e.prototype.parseLabelRequired=function(c){var a=this.parseLabel(c);b(a,"Label required");return a};e.prototype.parseRequiredSuperTip=function(c){var a=this.parseSuperTip(c);b(a,"SuperTip required");return a};e.prototype.parseSuperTip=function(k){var f=this,h=a,e=f.manifest._xmlProcessor.selectSingleNode("ov:Supertip",k);if(e!=a){var i=e,j,g;e=f.manifest._xmlProcessor.selectSingleNode(c,i);b(e,"Title is necessary for SuperTip.");j=f.getShortString(e);e=f.manifest._xmlProcessor.selectSingleNode(d,i);b(e,"Description is necessary for SuperTip.");g=f.getLongString(e);h={title:j,description:g}}return h};e.prototype.parseRequiredIcon=function(c){var a=this.parseIcon(c);b(a,"Icon required");return a};e.prototype.parseIcon=function(h){var c=this.selectChildNodes(g,h,["ov:Icon"]),f=c.length;if(f==0)return a;for(var e={},b=0;b<f;b++){var d=c[b],i=d.getAttribute("size");e[i]=this.getImageResource(d)}return e};e.prototype.parseChildControls=function(a,d,c){var b=this.manifest._xmlProcessor.selectNodes(a,d);return this.parseControls(b,c)};e.prototype.parseControls=function(e,f){for(var c=[],g=e.length,a=0;a<g;a++){var h=e[a],d=f(this,h);b(d,"parser must return a control.");c.push(d)}return c};e.prototype.parseControlInGroup=function(c){var b=c.getAttribute(e.typeAttributeName),a;switch(b){case "Menu":a=new C;break;case "Button":a=new G(b);break;default:throw new i("Unsupported control type.")}a.parse(this,c);return a};e.prototype.parseMenuItem=function(b){var a=new F;a.parse(this,b);return a};e.prototype.parseLocaleAwareSettingsAndGetValue=function(a){var c={},e=a.getAttribute("DefaultValue");c[this.manifest._defaultLocale]=e;var b=this.manifest._xmlProcessor.selectNodes("bt:Override",a);if(b)for(var h=b.length,d=0;d<h;d++){var a=b[d],f=a.getAttribute("Locale"),g=a.getAttribute("Value");c[f]=g}return this.manifest._getDefaultValue(c)};e.prototype.selectSingleNode=function(b,c){if(c==a)return b;for(var d=0;d<c.length;d++){b=this.manifest._xmlProcessor.selectSingleNode(c[d],b);if(b==a)break}return b};e.prototype.selectChildNodes=function(c,b,d){b=this.selectSingleNode(b,d);if(b==a)return [];return this.manifest._xmlProcessor.selectNodes(c,b)};e.prototype.getResourceByNode=function(e,d){var a=d.getAttribute("resid"),c=e[a];b(c,"resid: "+a+" not found");return c};e.prototype.getImageResource=function(a){return this.getResourceByNode(this.resources.Images,a)};e.prototype.getUrlResource=function(a){return this.getResourceByNode(this.resources.Urls,a)};e.prototype.getLongString=function(a){return this.getResourceByNode(this.resources.LongStrings,a)};e.prototype.getShortString=function(a){return this.getResourceByNode(this.resources.ShortStrings,a)};e.typeAttributeName="xsi:type";return e}();m.ParsingContext=j;var k=function(){function a(){}a.buildControls=function(c,b){for(var e=b.length,a=0;a<e;a++){var d=b[a];d.apply(c)}};return a}(),v=function(){function a(a,b){this.functionFile=a;this.builder=b}return a}(),z=function(){function a(){}a.prototype.parse=function(a,f){var e=a.manifest._xmlProcessor,h=e.selectSingleNode(c,f);b(h,"Title is necessary for GetStarted.");this.title=a.getShortString(h);var g=e.selectSingleNode(d,f);b(g,"Description is necessary for GetStarted.");this.description=a.getLongString(g);var i=e.selectSingleNode("ov:LearnMoreUrl",f);this.learnMoreUrl=a.getUrlResource(i)};return a}(),p=function(){function a(a){this.type=a}a.prototype.buildAction=function(){};a.prototype.parse=function(){};return a}(),B=function(d){__extends(c,d);function c(){d.apply(this,arguments);this.title=a}c.prototype.parse=function(a,d){var c=a.manifest._xmlProcessor.selectSingleNode("ov:SourceLocation",d);b(c,"SourceLocation is necessary for ShowTaskpane action");this.sourceLocation=a.getUrlResource(c)};return c}(p),x=function(d){__extends(b,d);function b(){d.apply(this,arguments)}b.prototype.buildAction=function(a){return a.actionBuilder.buildShowTaskpane(this.sourceLocation,this.title,this.taskpaneId)};b.prototype.parse=function(e,f){d.prototype.parse.call(this,e,f);var b=e.manifest._xmlProcessor.selectSingleNode("ov:TaskpaneId",f);if(b!=a)this.taskpaneId=b.firstChild.nodeValue;b=e.manifest._xmlProcessor.selectSingleNode(c,f);if(b!=a)this.title=e.getShortString(b)};return b}(B),u=function(c){__extends(a,c);function a(){c.apply(this,arguments)}a.prototype.buildAction=function(a){b(a.functionFile,"Function file source url is necessary for ExecuteFunctionAction.");return a.actionBuilder.buildCallFunction(a.functionFile,this.functionName,this.controlId)};a.prototype.parse=function(a,d){var c=a.manifest._xmlProcessor.selectSingleNode("ov:FunctionName",d);b(c,"FunctionName is necessary for ExecuteFunctionAction.");this.functionName=a.manifest._xmlProcessor.getNodeValue(c)};return a}(p),l=function(){function a(){}a.prototype.parse=function(a,b){this.id=a.parseIdRequired(b);this.label=a.parseLabelRequired(b)};return a}(),C=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.apply=function(a){a.controlBuilder.startBuildMenu(this);k.buildControls(a,this.children);a.controlBuilder.endBuildMenu()};a.prototype.parse=function(a,d){var c=this;b.prototype.parse.call(c,a,d);c.icon=a.parseRequiredIcon(d);c.superTip=a.parseRequiredSuperTip(d);var e=a.selectChildNodes("ov:Item",d,["ov:Items"]);c.children=a.parseControls(e,function(a,b){return a.parseMenuItem(b)})};return a}(l),o=function(c){__extends(a,c);function a(a){c.call(this);this.controlType=a}a.prototype.apply=function(b){var a=this,d=a.action.buildAction(b),c={id:a.id,label:a.label,icon:a.icon,superTip:a.superTip,actionType:a.actionType,action:d};a.applyControl(b,c)};a.prototype.parse=function(d,g){var a=this;c.prototype.parse.call(a,d,g);a.icon=a.parseIcon(d,g);a.superTip=d.parseRequiredSuperTip(g);var h=d.manifest._xmlProcessor.selectSingleNode("ov:Action",g);b(h,"Action is necessary for itemControl.");var e=h.getAttribute(j.typeAttributeName),f;switch(e){case "ShowTaskpane":f=new x(e);break;case "ExecuteFunction":var k=f=new u(e);k.controlId=a.id;break;default:throw new i("Unsupported action type.")}f.parse(d,h);a.actionType=e;a.action=f};a.prototype.applyControl=function(){throw new t("Not implemented method applyControl for ItemControl.")};a.prototype.parseIcon=function(a,b){return a.parseIcon(b)};return a}(l),G=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.applyControl=function(a,b){a.controlBuilder.addButton(b)};a.prototype.parseIcon=function(a,b){return a.parseRequiredIcon(b)};return a}(o),F=function(b){__extends(a,b);function a(){b.call(this,"MenuItem")}a.prototype.applyControl=function(a,b){a.controlBuilder.addMenuItem(b)};return a}(o),q=function(){function b(c){var b=this;b.label=a;b.isOfficeTab=false;b.children=[];b.isOfficeTab=c}b.prototype.apply=function(a){a.builder.ribbonBuilder.startBuildTab(this);for(var d=this.children.length,b=0;b<d;b++){var c=this.children[b];c.apply(a)}a.builder.ribbonBuilder.endBuildTab()};b.prototype.parse=function(b,c){var a=this;a.id=b.parseIdRequired(c);if(!a.isOfficeTab)a.label=b.parseLabelRequired(c);a.children=b.parseChildControls("ov:Group",c,function(b,c){var a=new D;a.parse(b,c);return a})};return b}(),D=function(b){__extends(a,b);function a(){b.apply(this,arguments)}a.prototype.parse=function(a,c){b.prototype.parse.call(this,a,c);this.icon=a.parseRequiredIcon(c);this.children=a.parseChildControls(h,c,function(a,b){return a.parseControlInGroup(b)})};a.prototype.apply=function(a){a.builder.ribbonBuilder.startBuildGroup(this);k.buildControls({functionFile:a.functionFile,actionBuilder:a.builder.actionBuilder,controlBuilder:a.builder.ribbonBuilder},this.children);a.builder.ribbonBuilder.endBuildGroup()};return a}(l),w=function(){function b(a){this.type=a;this.tabs=[]}b.prototype.apply=function(b){if(this.type==b.builder.commandSurface)for(var c=this.tabs.length,a=0;a<c;a++){var d=this.tabs[a];d.apply(b)}};b.prototype.parse=function(c,e){var b=c.manifest._xmlProcessor.selectSingleNode("ov:OfficeTab",e);if(b!=a){var d=new q(true);d.parse(c,b);this.tabs.push(d)}b=c.manifest._xmlProcessor.selectSingleNode("ov:CustomTab",e);if(b!=a){var d=new q(false);d.parse(c,b);this.tabs.push(d)}};return b}(),A=function(){function b(){}b.prototype.parse=function(a,b){this.id=a.parseIdRequired(b);this.children=a.parseChildControls(h,b,function(a,b){return a.parseControlInGroup(b)})};b.prototype.apply=function(b){b.controlBuilder.startBuildMenu({id:this.id,label:a,superTip:a});k.buildControls(b,this.children);b.controlBuilder.endBuildMenu()};return b}(),s=function(){function a(a){this.type=a}a.prototype.apply=function(a){this.type==a.builder.commandSurface&&k.buildControls({functionFile:a.functionFile,actionBuilder:a.builder.actionBuilder,controlBuilder:a.builder.contextMenuBuilder},this.children)};a.prototype.parse=function(a,b){this.children=a.parseChildControls("ov:OfficeMenu",b,function(b,c){var a=new A;a.parse(b,c);return a})};return a}(),y=function(){function b(){var b=this;b.getStartedNode=a;b.functionFile=a;b.cacheableUrls=[];b.ExtensionPoints=[]}b.prototype.cacheableResources=function(){return this.cacheableUrls};b.prototype.apply=function(b,e){var a=this;try{b.startApplyAddin({entitlement:a.extensionEntitlement,manifest:a.extensionManifest,startedNode:a.getStartedNode,overrides:{type:a.type,description:a.description}});for(var f=new v(a.functionFile,b),h=a.ExtensionPoints.length,d=0;d<h;d++){var g=a.ExtensionPoints[d];g.apply(f)}b.endApplyAddin()}catch(c){c instanceof i&&e.setErrorMessageForAddin(a.extensionEntitlement.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message);throw c}};b.prototype.parse=function(b,k){var c=this;c.type=k.getAttribute(j.typeAttributeName);var f=b.manifest._xmlProcessor.selectSingleNode(d,k);if(f!=a)c.description=b.getLongString(f);for(var o=b.selectChildNodes("ov:Host",k,["ov:Hosts"]),g=a,m=o.length,e=0;e<m;e++){var q=o[e],u=q.getAttribute(j.typeAttributeName);if(u==b.hostType){g=b.manifest._xmlProcessor.selectSingleNode("ov:"+b.formFactor,q);break}}var n=b.manifest._xmlProcessor.selectSingleNode("ov:GetStarted",g);if(n!=a){c.getStartedNode=new z;c.getStartedNode.parse(b,n)}f=b.manifest._xmlProcessor.selectSingleNode("ov:FunctionFile",g);if(f!=a)c.functionFile=b.getUrlResource(f);var p=b.manifest._xmlProcessor.selectNodes("ov:ExtensionPoint",g);m=p.length;for(var e=0;e<m;e++){var r=p[e],l=r.getAttribute(j.typeAttributeName),h;switch(l){case "Events":throw"Not Implemented";case "PrimaryCommandSurface":h=new w(l);break;case "ContextMenu":h=new s(l);break;default:throw new i("Unsupported extension type.")}h.parse(b,r);c.ExtensionPoints.push(h)}var t=b.resources.Images;for(var v in t)c.cacheableUrls.push(t[v]);c.extensionEntitlement=b.entitlement;c.extensionManifest=b.manifest};return b}(),E=function(){function a(){}a.prototype.cacheableResources=function(){return []};a.prototype.apply=function(){};return a}(),r=function(){function b(b,a){this.hostType=b;this.formFactor=a}b.prototype.parseExtensions=function(h,b,l){try{var k=b._xmlProcessor.selectSingleNode(e),g=b._xmlProcessor.selectSingleNode(f,k);if(g==a)return new E;var d=new y;d.parse(new j(this.hostType,this.formFactor,h,b),g);return d}catch(c){c instanceof i&&l.setErrorMessageForAddin(h.assetId,Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message);throw c}};return b}();m.AddinCommandsManifestParser=r})(b=a.Parser||(a.Parser={}))})(OfficeExt||(OfficeExt={}));var OfficeExt;(function(b){var a=function(){function a(){}a.createManifestForAddinAction=function(d,h,g,f){var b=null,c=new OSF.Manifest.ExtensionSettings,j=OSF.FormFactor.Default,e={};e[d._UILocale]=g;c._defaultHeight=b;c._defaultWidth=b;c._sourceLocations={};c._sourceLocations[d._UILocale]=h;var a=d,i=new OSF.Manifest.Manifest(function(d){d._xmlProcessor=a._xmlProcessor;d._displayNames=g!=b?e:a._displayNames;d._iconUrls=a._iconUrls;d._extensionSettings={formFactor:c};d._highResolutionIconUrls=a._highResolutionIconUrls;d._target=a._target;d._id=f!=b?f:a._id;d._version=a._version;d._providerName=a._providerName;d._idIssuer=a._idIssuer;d._alternateId=a._alternateId;d._defaultLocale=a._defaultLocale;d._signature=a._signature;d._capabilities=a._capabilities;d._hosts=a._hosts;d._descriptions=a._descriptions;d._appDomains=a._appDomains;d._permissions=a._permissions;d._requirements=a._requirements},a._UILocale);return i};a.cacheManifestForAction=function(b,c,a){OSF.OsfManifestManager.cacheManifest(c,a,b)};a.purgeManifestForAction=function(b,a){OSF.OsfManifestManager.purgeManifest(b,a)};return a}();b.AddinCommandsManifestManager=a})(OfficeExt||(OfficeExt={}));var OfficeExt;(function(b){var d="##UILessContainer##",a=null;b.AddinActionContextMap={};var g={};(function(a){var c="ExclusiveForNew",b="ExclusiveForCur";a[a["Default"]=1]="Default";a[a[b]=2]=b;a[a[c]=3]=c})(b.CommandInvokeMode||(b.CommandInvokeMode={}));var f=b.CommandInvokeMode,c;(function(a){var d="ooeOperationNotSupported",c="ooeSuccess",b="ooeTimeout";a[a[b]=-1]=b;a[a[c]=0]=c;a[a[d]=5e3]=d})(c||(c={}));var j=function(){function f(a,c,b){this.contextProvider=a;this.manifest=b;this.entitlement=c}f.prototype.buildShowTaskpane=function(a,c,b){return this.CreateManifestAndActivationContextForTaskpaneCommand(a,c,b)};f.prototype.buildCallFunction=function(a,b,c){return this.CreateManifestAndActivationContextForUILessCommand(a,b,c)};f.prototype.CreateManifestAndActivationContextForTaskpaneCommand=function(e,h,b){var f=function(d,e){if(e!=c.ooeSuccess)return;if(b!=a)g[b]=d},d=function(e,d){var b=g[e];if(b==a)return false;var c=d.getOsfControl(b);if(c==a)return false;c._refresh();return true};return this.CreateManifestAndActivationContext(e,h,b,function(h,c,g,e){b!=a&&d(b,c);h.showTaskpane(g,e,f)})};f.prototype.CreateManifestAndActivationContext=function(e,h,f,g){var c=this,d=b.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,e,h,a);return function(a){var e=c.contextProvider.createActionContext(a,function(i,h){var e={assetId:c.entitlement.assetId+(f||a),appVersion:c.entitlement.appVersion,storeId:c.entitlement.storeId,storeType:OSF.StoreType.InMemory,targetType:OSF.OsfControlTarget.TaskPane};b.AddinCommandsManifestManager.cacheManifestForAction(d,e.assetId,e.appVersion);g(i,h,e,d)});b.AddinActionContextMap[a]=e}};f.prototype.CreateManifestAndActivationContextForUILessCommand=function(i,j,h){var f=this,k=function(a,b){if(b!=c.ooeSuccess)return;var d={source:{id:h}};e.invokeAppCommand(a,j,d,function(){})},g=b.AddinCommandsManifestManager.createManifestForAddinAction(this.manifest,i,a,a);return function(a){var h=f.contextProvider.createActionContext(a,function(h){var a={assetId:f.entitlement.assetId+d,appVersion:f.entitlement.appVersion,storeId:f.entitlement.storeId,storeType:OSF.StoreType.InMemory,targetType:OSF.OsfControlTarget.TaskPane};b.AddinCommandsManifestManager.cacheManifestForAction(g,a.assetId,a.appVersion);h.createUILessSandbox(a,g,function(a,b){if(b==c.ooeSuccess)var d=e.ensureOsfHostEntry(a,h);k(a,b)})});b.AddinActionContextMap[a]=h}};return f}(),h=function(){function a(a,b){this.contextProvider=a;this.entitlement=b}a.prototype.buildShowTaskpane=function(){var a=this;return function(c){delete b.AddinActionContextMap[c];b.AddinCommandsManifestManager.purgeManifestForAction(a.entitlement.assetId+c,a.entitlement.appVersion)}};a.prototype.buildCallFunction=function(){var a=this;return function(c){delete b.AddinActionContextMap[c];b.AddinCommandsManifestManager.purgeManifestForAction(a.entitlement.assetId+d,a.entitlement.appVersion)}};return a}(),i=function(){function a(){}a.createActionBuilder=function(a,c,b){return new j(a,c,b)};a.createDeleterActionBuilder=function(a,b){return new h(a,b)};a.bindAction=function(a,c){var b=c;b(a)};a.retrieveActionContext=function(a){return b.AddinActionContextMap[a]};return a}();b.DefaultControlActionBinder=i;var k=function(){function b(){this.invocationQueue={}}b.prototype.invokeAppCommand=function(l,i,d,m,e){var g=this,h={dispid:OSF.DDA.EventDispId.dispidAppCommandInvokedEvent,controlId:g.osfControlId};h[0]=l;h[1]=i;h[2]=JSON.stringify(d);e=e?e:b.defaultTimeout;var j=d&&d.commandMode?d.commandMode:f.Default,k={args:h,onComplete:m,timeout:e,timeoutTimer:a},c=g.invocationQueue[i];if(c==a){c=[];g.invocationQueue[i]=c}!(j==f.ExclusiveForCur&&c.length>0)&&!(j==f.ExclusiveForNew&&c.length>1)&&c.push(k);c.length==1&&g.trySendInvocation(k)};b.prototype.invocationCompleted=function(f,g,i){var c=this,h=c;for(var e in c.invocationQueue){var d=c.invocationQueue[e],b=d[0];if(f==b.args[0]){if(d.length>1){d.splice(0,1);var j=d[0];window.setTimeout(function(){h.trySendInvocation(j)},0)}else delete c.invocationQueue[e];if(b.timeoutTimer!=a){window.clearTimeout(b.timeoutTimer);b.timeoutTimer=a}b.onComplete(g,i);return}}};b.prototype.sendInvocations=function(c){var b=this;b.eventHandler=c;if(c==a)return;for(var d in b.invocationQueue){var e=b.invocationQueue[d],f=e[0];b.sendInvocation(c,f)}};b.prototype.trySendInvocation=function(c){var b=this.eventHandler;b!=a&&this.sendInvocation(b,c)};b.prototype.sendInvocation=function(c,a){var d=this,b=a.args;c(b);a.timeoutTimer=window.setTimeout(function(){d.invocationTimeout(b[0])},a.timeout)};b.prototype.invocationTimeout=function(b){this.invocationCompleted(b,c.ooeTimeout,a)};b.prototype.disposeHost=function(){var b=this;for(var c in b.invocationQueue)return;b.host.disposeHost(b.osfControlId);b.onDisposed!=a&&b.onDisposed(b)};b.defaultTimeout=300*1e3;return b}(),e=function(){var f="targetId",e="controlId",d="eventDispId";function b(){}b.registerEvent=function(g,c,a){b.registerEventInternal(a[d],a[e],a[f],g,function(a){c&&c(a==0)})};b.unregisterEvent=function(g,c,a){b.unregisterEventInternal(a[d],a[e],a[f],g,function(a){c&&c(a==0)})};b.invokeAppCommand=function(d,c,f,e){var g=b.getOrCreateOsfHostEntry(d),a=b.getNextAppCommandId();g.invokeAppCommand(a,c,f,e)};b.invocationCompleted=function(e,c){var g=b.getOrCreateOsfHostEntry(e),d=c[0],f=c[1],h=c[2]?JSON.parse(c[2]):a;g.invocationCompleted(d,f,h)};b.ensureOsfHostEntry=function(d,e){var c=b.getOrCreateOsfHostEntry(d);if(c.host==a)c.host=e;return c};b.getNextAppCommandId=function(){return "AppCmd"+b._nextAppCommandId++};b.getOrCreateOsfHostEntry=function(d){var c=b._invocationQueues[d];if(c==a){c=new k;c.osfControlId=d;c.onDisposed=function(a){delete b._invocationQueues[a.osfControlId]};b._invocationQueues[d]=c}return c};b.registerEventInternal=function(d,e,h,f,a){switch(d){case OSF.DDA.EventDispId.dispidAppCommandInvokedEvent:var g=b.getOrCreateOsfHostEntry(e);a(c.ooeSuccess);g.sendInvocations(f);return}a(c.ooeOperationNotSupported)};b.unregisterEventInternal=function(f,g,i,h,d){switch(f){case OSF.DDA.EventDispId.dispidAppCommandInvokedEvent:var e=b.getOrCreateOsfHostEntry(g);if(e.eventHandler==h)e.eventHandler=a;d(c.ooeSuccess);return}d(c.ooeOperationNotSupported)};b._nextAppCommandId=0;b._invocationQueues={};return b}();b.AddinCommandsRuntimeManager=e})(OfficeExt||(OfficeExt={}));var SPCatalogDataProvider=function(){var a=null,b=false;function c(){}c.prototype.validateAndCacheNewManifest=function(){return b};c.prototype.localCacheAddinCommands=function(){};c.prototype.getEntitlementsAsync=function(c,j,g){if(!c||!c._enableMyOrg){g({statusCode:OSF.InvokeResultCode.E_CATALOG_NO_APPS,value:a});return}var f,d=function(b){if(b!=a&&b.errorCode===OSF.InvokeResultCode.S_OK&&b.value){var e=b.value;f=[];for(var d=0;d<e.length;d++){var c=e[d],h={assetId:c[1],appVersion:c[4],storeId:c[11],storeType:OSF.StoreType.SPCatalog,targetType:c[3]};f.push(h)}}g(f)},h=function(e){if(e!=a&&e.value){c._myOrgCatalogUrl=e.value;var f={storeType:OSF.StoreTypeEnum.Catalog,refresh:b,fromInsertDialog:b,callbackFunc:d};c.queryEntitlementDetails(f)}else d({statusCode:OSF.InvokeResultCode.E_GENERIC_ERROR,value:a})},i=0,e=function(b){if(b){var f={webUrl:c._spBaseUrl,clientEndPoint:b},g={webUrl:c._spBaseUrl};OSF.OsfManifestManager._invokeProxyMethodAsync(f,"OEM_getSPCatalogUrlAsync",h,g)}else if(i++<OSF.Constants.AuthenticatedConnectMaxTries)setTimeout(function(){c._createSharePointIFrameProxy(c._spBaseUrl,e)},500);else d({statusCode:OSF.InvokeResultCode.E_GENERIC_ERROR,value:a})};if(c._spBaseUrl&&c._iframeProxies&&c._iframeProxies[c._spBaseUrl]&&c._iframeProxies[c._spBaseUrl].clientEndPoint)e(c._iframeProxies[c._spBaseUrl].clientEndPoint);else c._createSharePointIFrameProxy(c._spBaseUrl,e)};c.prototype.getManifestAsync=function(c,d){OSF.OUtil.validateParamObject(c,{contextActivationMgr:{type:Object,mayBeNull:b},referenceInUse:{type:Object,mayBeNull:b}},a);var f=function(b){OSF.OUtil.writeProfilerMark(OSF.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd);if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded&&b.value){for(var h=b.context.referenceInUse,g=b.value.entitlements,i=g.length,c=a,f=0;f<i;f++){var e=g[f];if(e.OfficeExtensionID&&h.id&&e.OfficeExtensionID.toLowerCase()===h.id.toLowerCase())if(!c||OSF.OsfManifestManager.versionLessThan(c.OfficeExtensionVersion,e.OfficeExtensionVersion))c=e}if(c!=a){b.context.manifestUrl=c.EncodedAbsUrl;b.context.appInstanceId=c.AppInstanceID;b.context.productId=c.ProductID;OSF.OsfManifestManager.getManifestAsync(b.context,Function.createDelegate(this,d))}else d({statusCode:OSF.ProxyCallStatusCode.Failed,value:a})}else d({statusCode:OSF.ProxyCallStatusCode.Failed,value:a})},e=OSF.OsfManifestManager.getCachedManifest(c.referenceInUse.id,c.referenceInUse.version);if(e==a){c.webUrl=c.referenceInUse.storeLocator;c.osfControl={_contextActivationMgr:c.contextActivationMgr,_telemetryContext:{}};c.noTargetType=true;c.hostType=c.contextActivationMgr._hostType;OSF.OUtil.writeProfilerMark(OSF.OsfOfficeExtensionManagerPerfMarker.GetEntitlementStart);OSF.OsfManifestManager.getCorporateCatalogEntitlementsAsync(c,Function.createDelegate(this,f))}else d({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:e,context:c})};return c}(),OfficeExt;(function(b){var a=null,c=function(){var c=".";function b(a){this._cacheManager=a}b.prototype.validateAndCacheNewManifest=function(c,b,a,d,e){if(this.validateAddinIdAndVersion(b,a)){this.cacheManifest(c,b,a,d,e);return true}return false};b.prototype.localCacheAddinCommands=function(a,b){this.cacheMyAddins(this.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey(a),b)};b.prototype.getEntitlementsAsync=function(c,j,i){var b=this,h=b,d=[],g=[],f=j?b.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey(c):b.getUploadFileDevCatalogAddinsCacheKey(c),e=b._cacheManager.GetCacheItem(f);if(e!=a){e.forEach(function(b){var e=h._cacheManager.GetCacheItem(h.getUploadFileDevCatalogManifestCacheKey(c,b));if(e!=a){var f=new OSF.Manifest.Manifest(e,c.getAppUILocale()),i={assetId:b,appVersion:f.getMarketplaceVersion(),storeId:"developer",storeType:OSF.StoreType.UploadFileDevCatalog,targetType:f.getTarget()};g.push(i);d.push(b)}});if(d.length!=e.length)if(d.length>0)b._cacheManager.SetCacheItem(f,d);else b._cacheManager.RemoveCacheItem(f)}i(g)};b.prototype.getManifestAsync=function(b,e){OSF.OUtil.validateParamObject(b,{contextActivationMgr:{type:Object,mayBeNull:false},referenceInUse:{type:Object,mayBeNull:false}},a);var c=OSF.OsfManifestManager.getCachedManifest(b.referenceInUse.id,b.referenceInUse.version);if(c==a){var d=this._cacheManager.GetCacheItem(this.getUploadFileDevCatalogManifestCacheKey(b.contextActivationMgr,b.referenceInUse.id));if(d!=a){c=new OSF.Manifest.Manifest(d,b.contextActivationMgr.getAppUILocale());OSF.OsfManifestManager.cacheManifest(b.referenceInUse.id,b.referenceInUse.version,c)}}e(c!=a?{statusCode:OSF.ProxyCallStatusCode.Succeeded,value:c,context:b}:{statusCode:OSF.ProxyCallStatusCode.Failed,value:a})};b.prototype.cleanMyAddins=function(c){var b=this.getUploadFileDevCatalogAddinsCacheKey(c),d=this._cacheManager.GetCacheItem(b);d!=a&&this._cacheManager.RemoveCacheItem(b)};b.prototype.validateAddinIdAndVersion=function(c,a){return b.idRegExp.test(c)&&b.versionRegExp.test(a)};b.prototype.cacheManifest=function(c,b,e,d,f){var a=this;OSF.OsfManifestManager.cacheManifest(b,e,f);a.cacheMyAddins(a.getUploadFileDevCatalogAddinsCacheKey(c),b);a._cacheManager.SetCacheItem(a.getUploadFileDevCatalogManifestCacheKey(c,b),d)};b.prototype.cacheMyAddins=function(c,d){var b=this._cacheManager.GetCacheItem(c);if(b==a)b=[];if(b.lastIndexOf(d)<0){b.push(d);this._cacheManager.SetCacheItem(c,b)}};b.prototype.getUploadFileDevCatalogAddinsCacheKey=function(a){return b.UploadFileCatalogCacheKey.myAddins+c+a.getAppName()+c+a.getUserNameHashCode()};b.prototype.getUploadFileDevCatalogAddinCommandsMyAddinsCacheKey=function(a){return b.UploadFileCatalogCacheKey.addinCommandsMyAddins+c+a.getAppName()+c+a.getUserNameHashCode()};b.prototype.getUploadFileDevCatalogManifestCacheKey=function(a,d){return b.UploadFileCatalogCacheKey.manifest+c+a.getAppName()+c+d};b.UploadFileCatalogCacheKeyPrefix="__OSF_UPLOADFILE.";b.UploadFileCatalogCacheKey={myAddins:b.UploadFileCatalogCacheKeyPrefix+"MyAddins",addinCommandsMyAddins:b.UploadFileCatalogCacheKeyPrefix+"AddinCommandsMyAddins",manifest:b.UploadFileCatalogCacheKeyPrefix+"Manifest"};b.idRegExp=new RegExp("[\\w-]+");b.versionRegExp=new RegExp("(\\d{1,2}.)*\\d{1,2}");return b}(),d=function(){function d(){}d.createAddinDataProvider=function(e){var d=a;switch(e){case OSF.StoreType.UploadFileDevCatalog:d=new c(new b.AppsDataCacheManager(OSF.OUtil.getLocalStorage(),new b.SafeSerializer));break;case OSF.StoreType.OMEX:d=OmexDataProvider.GetInstance(new b.AppsDataCacheManager(OSF.OUtil.getLocalStorage(),new b.SafeSerializer));break;case OSF.StoreType.SPCatalog:d=new SPCatalogDataProvider}return d};return d}();b.AddinDataProviderFactory=d})(OfficeExt||(OfficeExt={}));if(!isDefinePropertySupported){if(!OsfMsAjaxFactory.msAjaxError)OsfMsAjaxFactory.msAjaxError=Error;if(!OsfMsAjaxFactory.msAjaxSerializer)OsfMsAjaxFactory.msAjaxSerializer=Sys.Serialization.JavaScriptSerializer;if(!OsfMsAjaxFactory.msAjaxString)OsfMsAjaxFactory.msAjaxString=String;if(!OsfMsAjaxFactory.msAjaxDebug)OsfMsAjaxFactory.msAjaxDebug=Sys.Debug;Object.defineProperty=definePropertySave}var _omexXmlNamespaces='xmlns="urn:schemas-microsoft-com:office:office" xmlns:o="urn:schemas-microsoft-com:office:office"';OSF.AppVersion={access:"ZAC150",excel:"ZXL150",excelwebapp:"WAE160",outlook:"ZOL150",outlookwebapp:"MOW150",powerpoint:"ZPP151",powerpointwebapp:"WAP160",project:"ZPJ150",word:"ZWD150",wordwebapp:"WAW160",onenotewebapp:"WAO160"};OSF.AppSubType={Taskpane:1,Content:2,Contextual:3,Dictionary:4};OSF.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2};function _getAppSubType(b){var a;if(b===0)a=OSF.AppSubType.Content;else if(b===1)a=OSF.AppSubType.Taskpane;else throw OsfMsAjaxFactory.msAjaxError.argument("officeExtentionTarget");return a}function _getAppVersion(b){var a=OSF.AppVersion[b.toLowerCase()];if(typeof a=="undefined")throw OsfMsAjaxFactory.msAjaxError.argument("applicationName");return a}function _invokeCallbackTag(g,h,l,k,a,m){var b=k;if(g){try{var d={status:h,result:l,failureInfo:null},e=function(a,c,b){if(a.failureInfo===null)a.failureInfo={};a.failureInfo[c]=b};if(a){var f=-1;if(a.get_statusCode)f=a.get_statusCode();if(!b)if(a.get_timedOut&&a.get_timedOut())b="Request timed out.";else if(a.get_aborted&&a.get_aborted())b="Request aborted.";if(f>=400||h===statusCode.Failed||b){e(d,"statusCode",f);e(d,"tagId",m);var c=a.get_webRequest();if(c){c.getResolvedUrl&&e(d,"url",c.getResolvedUrl());if(a.getResponseHeader&&c.get_userContext&&c.get_userContext()&&!c.get_userContext().correlationId){var j=a.getResponseHeader("X-CorrelationId");e(d,"correlationId",j)}}}}if(b){e(d,"message",b);OsfMsAjaxFactory.msAjaxDebug.trace(b)}}catch(i){OsfMsAjaxFactory.msAjaxDebug.trace("Encountered exception with logging: "+i)}g(d)}}var _serviceEndPoint=null,_defaultRefreshRate=3,_msPerDay=8.64e7,_defaultTimeout=6e4,_officeVersionHeader="X-Office-Version",_hourToDayConversionFactor=24,_buildParameter="&build=",_expectedVersionParameter="&expver=",_queryStringParameters={clientName:"client",clientVersion:"cv"},statusCode={Succeeded:1,Failed:0};function _sendWebRequest(e,h,c,g,b,d){b=b||{};var a=new Sys.Net.WebRequest;for(var f in c)a.get_headers()[f]=c[f];if(b){if(b.officeVersion)a.get_headers()[_officeVersionHeader]=b.officeVersion;if(b.correlationId)e+="&corr="+b.correlationId}d&&a.set_body(d);a.set_url(e);a.set_httpVerb(h);a.set_timeout(_defaultTimeout);a.set_userContext(b);a.add_completed(g);a.invoke()}function _onCompleted(a,g){var b=null,c=a.get_webRequest().get_userContext(),d=a.get_webRequest().get_url();if(a.get_timedOut()){OsfMsAjaxFactory.msAjaxDebug.trace("Request timed out: "+d);_invokeCallbackTag(c.callback,statusCode.Failed,b,b,a,8757955)}else if(a.get_aborted()){OsfMsAjaxFactory.msAjaxDebug.trace("Request aborted: "+d);_invokeCallbackTag(c.callback,statusCode.Failed,b,b,a,8757956)}else if(a.get_responseAvailable())if(a.get_statusCode()==200)try{c._onCompleteHandler(a,g)}catch(f){OsfMsAjaxFactory.msAjaxDebug.trace("Request failed with exception "+f+": "+d);_invokeCallbackTag(c.callback,statusCode.Failed,f,b,a,8757957)}else{var e=a.get_statusText();OsfMsAjaxFactory.msAjaxDebug.trace("Request failed with status code "+e+": "+d);_invokeCallbackTag(c.callback,statusCode.Failed,e,b,a,8757958)}else{OsfMsAjaxFactory.msAjaxDebug.trace("Request failed: "+d);_invokeCallbackTag(c.callback,statusCode.Failed,e,b,a,8757959)}}function _isProxyReady(b,a){a&&a({status:statusCode.Succeeded,result:true})}function _createQueryStringFragment(b){var c="";for(var d in b){var a=b[d];if(a===null||a===undefined||a==="")continue;c+="&"+encodeURIComponent(d)+"="+encodeURIComponent(a)}return c}OSF.HostSpecificFileVersionDefault="16.00";OSF.HostSpecificFileVersionMap={access:{web:"16.00"},agavito:{winrt:"16.00"},excel:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},onenote:{web:"16.00",win32:"16.00",winrt:"16.00"},outlook:{ios:"16.00",mac:"16.00",web:"16.01",win32:"16.00"},powerpoint:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"},project:{win32:"16.00"},sway:{web:"16.00"},word:{ios:"16.00",mac:"16.00",web:"16.00",win32:"16.01",winrt:"16.00"}};OSF.HostType={Excel:"Excel",Outlook:"Outlook",Access:"Access",PowerPoint:"PowerPoint",Word:"Word",Sway:"Sway",OneNote:"OneNote"};OSF.ManifestHostType={Workbook:"Workbook",Document:"Document",Presentation:"Presentation",Notebook:"Notebook"};OSF.HostPlatform={Web:"Web"};OSF.getAppVerCode=function(c){var b="Invalid appName.",a;switch(c){case OSF.AppName.ExcelWebApp:a="excel.exe";break;case OSF.AppName.AccessWebApp:a="ZAC";break;case OSF.AppName.PowerpointWebApp:a="WAP";break;case OSF.AppName.WordWebApp:a="WAW";break;case OSF.AppName.OneNoteWebApp:a="WAO";break;default:OsfMsAjaxFactory.msAjaxDebug.trace(b);throw b}return a};OSF.getManifestHostType=function(b){var a;switch(b){case OSF.HostType.Excel:a=OSF.ManifestHostType.Workbook;break;case OSF.HostType.Word:a=OSF.ManifestHostType.Document;break;case OSF.HostType.PowerPoint:a=OSF.ManifestHostType.Presentation;break;case OSF.HostType.OneNote:a=OSF.ManifestHostType.Notebook;break;default:OsfMsAjaxFactory.msAjaxDebug.trace("Invalid host type.");throw"Invalid hostType."}return a};OSF.Capability={Mailbox:"Mailbox",Document:"Document",Workbook:"Workbook",Project:"Project",Presentation:"Presentation",Database:"Database",Sway:"Sway",Notebook:"Notebook"};OSF.HostCapability={Excel:OSF.Capability.Workbook,Outlook:OSF.Capability.Mailbox,Access:OSF.Capability.Database,PowerPoint:OSF.Capability.Presentation,Word:OSF.Capability.Document,Sway:OSF.Capability.Sway,OneNote:OSF.Capability.Notebook};OSF.OsfControlTarget={InContent:0,TaskPane:1,Contextual:2};OSF.OsfControlPermission={Restricted:1,ReadDocument:2,WriteDocument:4,ReadWriteDocument:6,ReadItem:32,ReadWriteMailbox:64,ReadAllDocument:131};OSF.OsfControlStatus={NotActivated:1,Activated:2,AppStoreNotReachable:3,InvalidOsfControl:4,UnsupportedStore:5,UnknownStore:6,ActivationFailed:7,NotSandBoxSupported:8};OSF.OsfControlPageStatus={NotStarted:1,Loading:2,Ready:3,FailedHandleRequest:4,FailedOriginCheck:5,FailedPermissionCheck:6};OSF.StoreType={OMEX:"omex",SPCatalog:"spcatalog",SPApp:"spapp",FileSystem:"filesystem",Exchange:"exchange",OneDrive:"onedrive",Registry:"registry",InMemory:"inmemory",UploadFileDevCatalog:"uploadfiledevcatalog"};OSF.ManifestIdIssuer={Microsoft:"Microsoft",Custom:"Custom"};OSF.OmexClientAppStatus={OK:1,UnknownAssetId:2,KilledAsset:3,NoEntitlement:4,DownloadsExceeded:5,Expired:6,Invalid:7,Revoked:8,ServerError:9,BadRequest:10,LimitedTrial:11,TrialNotSupported:12,EntitlementDeactivated:13,VersionMismatch:14,VersionNotSupported:15};OSF.OmexState={Killed:0,OK:1,Withdrawn:2,Flagged:3,DeveloperWithdrawn:4};OSF.OmexTrialType={None:0,Office:1,External:2};OSF.OmexEntitlementType={Free:"free",Trial:"trial",Paid:"paid"};OSF.OmexAuthNStatus={NotAttempted:-1,CheckFailed:0,Authenticated:1,Anonymous:2,Unknown:3};OSF.OmexRemoveAppStatus={Failed:0,Success:1};OSF.OfficeAppType={ContentApp:OSF.OsfControlTarget.InContent,TaskPaneApp:OSF.OsfControlTarget.TaskPane,MailApp:OSF.OsfControlTarget.Contextual};OSF.FormFactor={Default:"DefaultSettings",Desktop:"DesktopSettings",Tablet:"TabletSettings",Phone:"PhoneSettings"};OSF.OsfOfficeExtensionManagerPerfMarker={GetEntitlementStart:"Agave.OfficeExtensionManager.GetEntitlementStart",GetEntitlementEnd:"Agave.OfficeExtensionManager.GetEntitlementEnd"};OSF.OsfControlActivationPerfMarker={ActivationStart:"Agave.AgaveActivationStart",ActivationEnd:"Agave.AgaveActivationEnd",DeactivationStart:"Agave.AgaveDeactivationStart",DeactivationEnd:"Agave.AgaveDeactivationEnd",SelectionTimeout:"Agave.AgaveSelectionTimeout"};OSF.NotificationUxPerfMarker={RenderLoadingAnimationStart:"Agave.NotificationUx.RenderLoadingAnimationStart",RenderLoadingAnimationEnd:"Agave.NotificationUx.RenderLoadingAnimationEnd",RemoveLoadingAnimationStart:"Agave.NotificationUx.RemoveLoadingAnimationStart",RemoveLoadingAnimationEnd:"Agave.NotificationUx.RemoveLoadingAnimationEnd",RenderStage1Start:"Agave.NotificationUx.RenderStage1Start",RenderStage1End:"Agave.NotificationUx.RenderStage1End",RemoveStage1Start:"Agave.NotificationUx.RemoveStage1Start",RemoveStage1End:"Agave.NotificationUx.RemoveStage1End",RenderStage2Start:"Agave.NotificationUx.RenderStage2Start",RenderStage2End:"Agave.NotificationUx.RenderStage2End",RemoveStage2Start:"Agave.NotificationUx.RemoveStage2Start",RemoveStage2End:"Agave.NotificationUx.RemoveStage2End"};OSF.ProxyCallStatusCode={Succeeded:1,Failed:0,ProxyNotReady:-1};OSF.ClientAppInfoReturnType={urlOnly:0,etokenOnly:1,both:2};OSF.SQMDataPoints={DATAID_APPSFOROFFICEUSAGE:10595,DATAID_APPSFOROFFICENOTIFICATIONS:10942};OSF.BWsaStreamTypes={Static:1};OSF.BWsaConfig={defaultMaxStreamRows:1e3};OSF.ErrorStatusCodes={E_OEM_EXTENSION_NOT_ENTITLED:2147758662,E_MANIFEST_SERVER_UNAVAILABLE:2147758672,E_USER_NOT_SIGNED_IN:2147758677,E_MANIFEST_DOES_NOT_EXIST:2147758673,E_OEM_EXTENSION_KILLED:2147758660,E_OEM_OMEX_EXTENSION_KILLED:2147758686,E_MANIFEST_UPDATE_AVAILABLE:2147758681,S_OEM_EXTENSION_TRIAL_MODE:275013,E_OEM_EXTENSION_WITHDRAWN_FROM_SALE:2147758690,E_TOKEN_EXPIRED:2147758675,E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED:2147757992,E_MANIFEST_REFERENCE_INVALID:2147758678,S_USER_CLICKED_BUY:274205,E_MANIFEST_INVALID_VALUE_FORMAT:2147758654,E_TRUSTCENTER_MOE_UNACTIVATED:2147757996,S_OEM_EXTENSION_FLAGGED:275040,S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE:275041,E_BROWSER_VERSION:2147758194,WAC_AgaveUnsupportedStoreType:1041,WAC_AgaveActivationError:1042,WAC_ActivateAttempLoading:1043,WAC_HTML5IframeSandboxNotSupport:1044,WAC_AgaveRequirementsErrorOmex:1045,WAC_AgaveRequirementsError:1046,WAC_AgaveOriginCheckError:1047,WAC_AgavePermissionCheckError:1048,WAC_AgaveHostHandleRequestError:1049,WAC_AgaveUnknownClientAppStatus:1050,WAC_AgaveAnonymousProxyCreationError:1051,WAC_AgaveOsfControlActivationError:1052,WAC_AgaveEntitlementRequestFailure:1053,WAC_AgaveManifestRequestFailure:1054,WAC_AgaveManifestAndEtokenRequestFailure:1055};OSF.InvokeResultCode={S_OK:0,E_REQUEST_TIME_OUT:-2147471590,E_USER_NOT_SIGNED_IN:-2147208619,E_CATALOG_ACCESS_DENIED:-2147471591,E_CATALOG_REQUEST_FAILED:-2147471589,E_OEM_NO_NETWORK_CONNECTION:-2147208640,E_PROVIDER_NOT_REGISTERED:-2147208617,E_OEM_CACHE_SHUTDOWN:-2147208637,E_OEM_REMOVED_FAILED:-2147209421,E_CATALOG_NO_APPS:-1,E_GENERIC_ERROR:-1e3,S_HIDE_PROVIDER:10};OSF.OmexClientNames=function(){var a={},b=OSF.AppName;a[b.ExcelWebApp]="WAC_Excel";a[b.WordWebApp]="WAC_Word";a[b.OutlookWebApp]="WAC_Outlook";a[b.AccessWebApp]="WAC_Access";a[b.PowerpointWebApp]="WAC_Powerpoint";a[b.OneNoteWebApp]="WAC_OneNote";return a}();OSF.OmexAppVersions=function(){var a={},b=OSF.AppName;a[b.ExcelWebApp]=OSF.AppVersion.excelwebapp;a[b.WordWebApp]=OSF.AppVersion.wordwebapp;a[b.OutlookWebApp]=OSF.AppVersion.outlookwebapp;a[b.AccessWebApp]=OSF.AppVersion.access;a[b.PowerpointWebApp]=OSF.AppVersion.powerpointwebapp;a[b.OneNoteWebApp]=OSF.AppVersion.onenotewebapp;return a}();OSF.ActivationTypes={V1Enabled:0,V1S2SEnabled:1,V2Enabled:2,V2S2SEnabled:3};OSF.Constants={FileVersion:"16.0.7120.1000",ThreePartsFileVersion:"16.0.7120",OmexAnonymousServiceExtension:"/anonymousserviceextension.aspx",OmexGatedServiceExtension:"/gatedserviceextension.aspx",OmexUnGatedServiceExtension:"/ungatedserviceextension.aspx",Http:"http",Https:"https",ProtocolSeparator:"://",SignInRedirectUrl:"/logontoliveforwac.aspx?returnurl=",ETokenParameterName:"et",ActivatedCacheKey:"__OSF_RUNTIME_.Activated.{0}.{1}.{2}",AuthenticatedConnectMaxTries:3,IgnoreSandBoxSupport:"Ignore_SandBox_Support",IEUpgradeUrl:"http://office.microsoft.com/redir/HA102789344.aspx",OmexForceAnonymousParamName:"SKAV",OmexForceAnonymousParamValue:"274AE4CD-E50B-4342-970E-1E7F36C70037",EndPointInternalSuffix:"_internal",PreloadOfficeJsId:"OFFICEJSPRELOAD",PreloadOfficeJsUrl:"//appsforoffice.microsoft.com/preloading/preloadoffice.js"};OSF.ManifestSchemaVersion={"1.0":"1.0","1.1":"1.1"};OSF.ManifestNamespaces={"1.0":'xmlns="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"',"1.1":'xmlns="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:o="http://schemas.microsoft.com/office/appforoffice/1.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0" xmlns:ov="http://schemas.microsoft.com/office/taskpaneappversionoverrides"'};OSF.OsfNavigationMode={DefaultMode:0,CategoryMode:1,TrustPageMode:2,QueryResultMode:3};OSF.StoreTypeEnum={MarketPlace:0,Catalog:1,OneDrive:9};OSF.RequirementsChecker=function(d,f,e,c,b){var a=this;a.setCapabilities(d);a.setHosts(f);a.setRequirements(e);a.setSupportedControlTargets(c);a.setSupportedOmexAppVersions(b);a.setFilteringEnabled(false)};OSF.RequirementsChecker.prototype={defaultMinMaxVersion:"1.1",isManifestSupported:function(a){if(!this.isFilteringEnabled())return true;if(!a)return false;var b=a.getManifestSchemaVersion()||OSF.ManifestSchemaVersion["1.0"];switch(b){case OSF.ManifestSchemaVersion["1.0"]:return this._checkManifest1_0(a);case OSF.ManifestSchemaVersion["1.1"]:return this._checkManifest1_1(a);default:return false}},isEntitlementFromOmexSupported:function(a){var c=this;if(!c.isFilteringEnabled())return true;if(!a)return false;var d;switch(a.appSubType){case "1":d=OSF.OsfControlTarget.TaskPane;break;case "2":d=OSF.OsfControlTarget.InContent;break;case "3":d=OSF.OsfControlTarget.Contextual;break;case "4":d=OSF.OsfControlTarget.TaskPane;break;default:return false}if(!c._checkControlTarget(d))return false;if(!a.requirements&&!a.hosts){if(!a.hasOwnProperty("appVersions"))return true;return c._checkOmexAppVersions(a.appVersions)}var b=new OSF.Manifest.Manifest(function(){}),e,f,h,g;if(a.requirements){b._xmlProcessor=new OSF.XmlProcessor(a.requirements,OSF.ManifestNamespaces["1.1"]);f=b._xmlProcessor.getDocumentElement()}e=b._parseRequirements(f);if(a.hosts){b._xmlProcessor=new OSF.XmlProcessor(a.hosts,OSF.ManifestNamespaces["1.1"]);g=b._xmlProcessor.getDocumentElement()}h=b._parseHosts(g);return c._checkHosts(h)&&c._checkSets(e.sets)&&c._checkMethods(e.methods)},isEntitlementFromCorpCatalogSupported:function(c){var a=this;if(!a.isFilteringEnabled())return true;if(!c)return false;var i=OSF.OfficeAppType[c.OEType];if(!a._checkControlTarget(i))return false;var b=new OSF.Manifest.Manifest(function(){}),g,h,f;if(c.OfficeExtensionCapabilitiesXML){b._xmlProcessor=new OSF.XmlProcessor(c.OfficeExtensionCapabilitiesXML,OSF.ManifestNamespaces["1.1"]);var e,d;e=b._xmlProcessor.getDocumentElement();d=b._parseRequirements(e);h=d.sets;f=d.methods;g=b._parseHosts(e)}return a._checkHosts(g)&&a._checkSets(h)&&a._checkMethods(f)},setCapabilities:function(a){this._supportedCapabilities=this._scalarArrayToObject(a)},setHosts:function(a){this._supportedHosts=this._scalarArrayToObject(a)},setRequirements:function(a){var b=this;b._supportedSets=a&&b._arrayToSetsObject(a.sets)||{};b._supportedMethods=a&&b._scalarArrayToObject(a.methods)||{}},setSupportedControlTargets:function(a){this._supportedControlTargets=this._scalarArrayToObject(a)},setSupportedOmexAppVersions:function(a){this._supportedOmexAppVersions=a&&a.slice?a.slice(0):[]},setFilteringEnabled:function(a){this._filteringEnabled=a?true:false},isFilteringEnabled:function(){return this._filteringEnabled},_checkManifest1_0:function(a){return this._checkCapabilities(a.getCapabilities())},_checkCapabilities:function(a){if(!a||a.length===0)return true;for(var b=0;b<a.length;b++)if(this._supportedCapabilities[a[b]])return true;return false},_checkManifest1_1:function(b){var a=b.getRequirements()||{};return this._checkHosts(b.getHosts())&&this._checkSets(a.sets)&&this._checkMethods(a.methods)},_checkHosts:function(a){if(!a||a.length===0)return true;for(var b=0;b<a.length;b++)if(this._supportedHosts[a[b]])return true;return false},_checkSets:function(b){var a=this;if(!b||b.length===0)return true;for(var e=0;e<b.length;e++){var c=b[e],d=a._supportedSets[c.name];if(!d)return false;if(c.version)if(a._compareVersionStrings(d.minVersion||a.defaultMinMaxVersion,c.version)>0||a._compareVersionStrings(d.maxVersion||a.defaultMinMaxVersion,c.version)<0)return false}return true},_checkMethods:function(a){if(!a||a.length===0)return true;for(var b=0;b<a.length;b++)if(!this._supportedMethods[a[b]])return false;return true},_checkControlTarget:function(a){return a!=undefined&&this._supportedControlTargets[a]},_checkOmexAppVersions:function(b){if(!b)return false;for(var a=0;a<this._supportedOmexAppVersions.length;a++)if(b.indexOf(this._supportedOmexAppVersions[a])>=0)return true;return false},_scalarArrayToObject:function(a){var c={};if(a&&a.length)for(var b=0;b<a.length;b++)if(a[b]!=undefined)c[a[b]]=true;return c},_arrayToSetsObject:function(a){var d={};if(a&&a.length)for(var c=0;c<a.length;c++){var b=a[c];if(b&&b.name!=undefined)d[b.name]=b}return d},_getSupportedSet:function(){for(var a={},c=Object.getOwnPropertyNames(this._supportedSets),b=0;b<c.length;b++){var d=this._supportedSets[c[b]];a[d.name.toLowerCase()]=d.maxVersion||this.defaultMinMaxVersion}if(typeof JSON!=="undefined")return JSON.stringify(a);return a},_compareVersionStrings:function(b,a){b=b.split(".");a=a.split(".");for(var f=Math.max(b.length,a.length),c=0;c<f;c++){var e=parseInt(b[c],10)||0,d=parseInt(a[c],10)||0;if(e===d)continue;return e-d}return 0}};var OfficeExt;(function(a){(function(a){var h="ManifestRequest",g="KilledAppsCheck",f="AppStateCheck",e="EntitlementCheck",d="Authentication",c="ServerCall",b="Activation";a[a[b]=0]=b;a[a[c]=1]=c;a[a[d]=2]=d;a[a[e]=3]=e;a[a[f]=4]=f;a[a[g]=5]=g;a[a[h]=6]=h})(a.Activity||(a.Activity={}));var f=a.Activity;(function(a){var j="ActivationRuntimeType",i="AppStateDataInvalidFlag",h="AppStateDataCachedFlag",g="ManifestDataInvalidFlag",f="OmexHasEntitlementFlag",e="ManifestDataCachedFlag",d="ManifestTrustCachedFlag",c="RetryCount",b="AnonymousFlag";a[a[b]=0]=b;a[a[c]=1]=c;a[a[d]=2]=d;a[a[e]=3]=e;a[a[f]=4]=f;a[a[g]=5]=g;a[a[h]=6]=h;a[a[i]=7]=i;a[a[j]=8]=j})(a.FlagName||(a.FlagName={}));var g=a.FlagName,d=function(){function b(b,c,e,f,d){var a=this;a.correlationId=b;a.perfContext=c;a.appInfo=e;a.assetId=f;a.instanceId=d}b.prototype.startActivity=function(e){var c=this;switch(e){case f.Activation:var d=OSF.ActivationTypes.V2Enabled;if((c.appInfo&15)===0&&a.S2SOmexCatalogService._requestHandler)d=OSF.ActivationTypes.V2S2SEnabled;c.setBits(g.ActivationRuntimeType,d);Telemetry.AppLoadTimeHelper.ActivationStart(c.perfContext,c.appInfo,c.assetId,c.correlationId,c.instanceId);return}Telemetry.AppLoadTimeHelper.StartStopwatch(c.perfContext,b.StopWatchName[e])};b.prototype.stopActivity=function(a){Telemetry.AppLoadTimeHelper.StopStopwatch(this.perfContext,b.StopWatchName[a])};b.prototype.setFlag=function(a,c){var b=c?2:1;this.setBits(a,b)};b.prototype.setBits=function(a,c){Telemetry.AppLoadTimeHelper.SetBit(this.perfContext,c,b.FlagOffsetMap[a],2)};b.FlagOffsetMap=[0,2,5,7,9,11,13,15,17];b.StopWatchName=["Stage1Time","Stage4Time","Stage5Time","Stage7Time","Stage9Time","Stage8Time","Stage10Time"];return b}();a.ActivationTelemetryContext=d;var b=function(){function a(a){this.correlationId=a}a.prototype.startActivity=function(){};a.prototype.stopActivity=function(){};a.prototype.setFlag=function(){};a.prototype.setBits=function(){};return a}();a.AddinCommandsTelemetryContext=b;var c=function(){function a(a){this.correlationId=a}a.prototype.startActivity=function(){};a.prototype.stopActivity=function(){};a.prototype.setFlag=function(){};a.prototype.setBits=function(){};return a}();a.InsertDialogTelemetryContext=c;var e=function(){function a(){}a.prototype.startActivity=function(){};a.prototype.stopActivity=function(){};a.prototype.setFlag=function(){};a.prototype.setBits=function(){};return a}();a.SimpleTelemetryContext=e})(OfficeExt||(OfficeExt={}));var OfficeExt;(function(a){(function(a){var d="UnknownUserType",c="ProxyNotReady",b="Succeeded";a[a[b]=1]=b;a[a["Failed"]=0]="Failed";a[a[c]=-1]=c;a[a[d]=2]=d})(a.DataServiceResultCode||(a.DataServiceResultCode={}));var b=a.DataServiceResultCode})(OfficeExt||(OfficeExt={}));var OfficeExt;(function(b){var a=function(){var o="description",n="provider",m="o:assets",l="contentMarket",k="appSubType",j="expirationDate",i="state",d="version",h="productId",b="assetId",g="o:asset",f="o:results",e="refreshRate",c=null;function a(){}a.ProcessLastStoreUpdate=function(d){var g={},b=new OSF.XmlProcessor(d,_omexXmlNamespaces),f=b.getDocumentElement(),a=f.selectSingleNode("o:update");if(a.firstChild!=c){var e=Date.parse(a.firstChild.nodeValue);return e}return c};a.ProcessAppState=function(l){var k={},c=new OSF.XmlProcessor(l,_omexXmlNamespaces),p=c.getDocumentElement();c.readAttributes(p,{rr:e},k);var m=c.selectSingleNode(f),o=c.selectSingleNode("o:lang",m),n=c.selectSingleNode(g,o);c.readAttributes(n,{assetid:b,prodid:h,ver:d,state:i,tdurl:"takeDownUrl",upv:"unsafePreviousVersion",expiry:j},k);return a.ConvertAppState(k)};a.ConvertAppState=function(b){b.refreshRate2=b.refreshRate?parseInt(b.refreshRate):0;b.state2=b.state?parseInt(b.state):0;b.expirationDate2=a.GetTickByDate(b.expirationDate);return b};a.ProcessEntitlement=function(q){var f={},c=new OSF.XmlProcessor(q,_omexXmlNamespaces),m=c.selectSingleNode("o:entitlementlist"),r=c.selectSingleNode("o:hdr",m);c.readAttributes(r,{pm:"billingMarket",pagesize:"pageSize",rr:e},f);for(var n=c.selectNodes("o:entitlement",c.selectSingleNode("o:entitlements",m)),o,g,p=[],i=0;i<n.length;++i){g={};o=n[i];c.readAttributes(o,{assetid:b,pid:h,ver:d,appst:k,cm:l,trlt:"licenseType",acqdate:"acquireDate",expiry2:j,attreq:"attentionRequired"},g);p.push(g)}f.entitlements=p;return a.ConvertEntitlementInfo(f)};a.ConvertEntitlementInfo=function(c){for(var e=c.entitlements,d=0;d<e.length;++d){var b=e[d];b.appSubType2=b.appSubType?parseInt(b.appSubType):0;b.acquireDate2=a.GetTickByDate(b.acquireDate);b.expirationDate2=a.GetTickByDate(b.expirationDate);b.attentionRequired2=b.attentionRequired==="true"?true:false}c.refreshRate2=c.refreshRate?parseInt(c.refreshRate):0;return c};a.ProcessKilledApps=function(l){var d={},c=new OSF.XmlProcessor(l,_omexXmlNamespaces),p=c.getDocumentElement();c.readAttributes(p,{rr:e},d);for(var k=[],n=c.selectSingleNode(m),j=c.selectNodes(g,n),i=0;i<j.length;++i){var o=j[i],f={};c.readAttributes(o,{assetid:b,pid:h},f);k.push({assetId:f.assetId,productId:f.productId})}d.killedApps=k;return a.ConvertKilledAppsInfo(d)};a.ConvertKilledAppsInfo=function(a){a.refreshRate2=a.refreshRate?parseInt(a.refreshRate):0;return a};a.ProcessClientAppInstallInfo=function(k,j){var f=new OSF.XmlProcessor(k,_omexXmlNamespaces),n=f.selectSingleNode(m),h=f.selectSingleNode(g,n),e={etoken:c,manifest:c};if(j===OSF.ClientAppInfoReturnType.urlOnly)f.readAttributes(h,{url:"url"},e);else if(j===OSF.ClientAppInfoReturnType.etokenOnly)f.readAttributes(h,{etok:"etoken"},e);else f.readAttributes(h,{url:"url",etok:"etoken"},e);f.readAttributes(h,{status:"status",cm:l,assetid:b,ver:d},e);if(j!=OSF.ClientAppInfoReturnType.urlOnly&&e.etoken){var i=new OSF.XmlProcessor(e.etoken,""),o=i.selectSingleNode("t",i.selectSingleNode("r"));i.readAttributes(o,{te:"tokenExpirationDate",et:"entitlementType",cid:"cid"},e)}return a.ConvertClientAppInstallInfo(e)};a.ConvertClientAppInstallInfo=function(b){b.status2=b.status?parseInt(b.status):0;b.tokenExpirationDate2=a.GetTickByDate(b.tokenExpirationDate);return b};a.ProcessManifest=function(a){return {manifest:a}};a.ProcessRemoveAppResponse=function(i){var d={};d.removedApps=[];for(var c=new OSF.XmlProcessor(i,_omexXmlNamespaces),k=c.getDocumentElement(),j=c.selectSingleNode("o:apps",c.selectSingleNode("o:removedApps")),g=c.selectNodes("o:app",j),h,e,f=0;f<g.length;++f){h=g[f];e={};c.readAttributes(h,{assetid:b,result:"result"},e);d.removedApps.push(e)}return a.ConvertRemoveAppResponse(d)};a.ConvertRemoveAppResponse=function(c){for(var d=c.removedApps,b=0;b<d.length;++b){var a=d[b];a.result2=a.result?parseInt(a.result):0}return c};a.ProcessAppDetails=function(m){for(var c=new OSF.XmlProcessor(m,_omexXmlNamespaces),p=c.selectSingleNode(f),h=c.selectNodes("o:wainfo",p),l,e,j=[],g=0;g<h.length;++g){l=h[g];e={};c.readAttributes(l,{assetid:b,defhei:"defaultHeight",defwid:"defaultWidth",title:"name",prov:n,desc:o,icon:"iconUrl",ver:d,state:i,appst:k,appvers:"appVersions",req:"requirements",hosts:"hosts",highresicon:"highResolutionIconUrl"},e);j.push(e)}return a.ConvertAppDetails(j)};a.ConvertAppDetails=function(b){for(var c=0;c<b.length;++c){var a=b[c];a.defaultHeight2=a.defaultHeight?parseInt(a.defaultHeight):0;a.defaultWidth2=a.defaultWidth?parseInt(a.defaultWidth):0;a.state2=a.state?parseInt(a.state):0;a.appSubType2=a.appSubType?parseInt(a.appSubType):0}return b};a.ProcessRecommendations=function(l){for(var a=new OSF.XmlProcessor(l,_omexXmlNamespaces),m=a.selectSingleNode(f),k=a.selectNodes("o:wa",m),e,j,h=[],c,g=0;g<k.length;++g){e=k[g];c={};a.readAttributes(e,{assetid:b,title:"name",desc:o,icon:"iconUrl",ver:d,state:i,rat:"rating",dls:"downloads",prov:n},c);j=a.selectSingleNode("o:price",e);a.readAttributes(j,{fop:"originalPrice",opt:"originalPriceTier",fpp:"promotionalPrice",ppt:"promotionalPriceTier",cmod:"priceModel"},c);h.push(c)}return h};a.ConvertAnonymousManifest=function(c,d){var a,b="";switch(c){case 200:a=OSF.OmexClientAppStatus.OK;b=d;break;case 204:case 1223:a=OSF.OmexClientAppStatus.NoEntitlement;break;case 400:a=OSF.OmexClientAppStatus.BadRequest;break;case 410:a=OSF.OmexClientAppStatus.KilledAsset;break;case 404:a=OSF.OmexClientAppStatus.UnknownAssetId;break;case 412:a=OSF.OmexClientAppStatus.VersionNotSupported;break;default:a=OSF.OmexClientAppStatus.ServerError}return {status2:a,manifest:b}};a.GetTickByDate=function(a){if(a)return (new Date(a)).getTime();return c};return a}();b.OmexXmlProcessor=a})(OfficeExt||(OfficeExt={}));var OfficeExt;(function(b){var a=function(){function a(){}a.anonymousCacheKeyPrefix="__OSF_ANONYMOUS_OMEX.";a.gatedCacheKeyPrefix="__OSF_GATED_OMEX.";a.ungatedCacheKeyPrefix="__OSF_OMEX.";a.manifestRefreshRate=5*365;a.hourToDayConversionFactor=24;a.anonymousAppInstallInfoCacheKey=a.anonymousCacheKeyPrefix+"appInstallInfo.{0}.{1}";a.authenticatedAppInstallInfoCacheKey=a.gatedCacheKeyPrefix+"appinstall_authenticated.{0}.{1}.{2}.{3}";a.killedAppsCacheKey="{0}killedApps";a.appStateCacheKey="{0}appState.{1}.{2}";a.appDetailKey="__OSF_OMEX.appDetails.{0}";a.entitlementsKey="entitle.{0}.{1}";return a}();b.CacheConsts=a})(OfficeExt||(OfficeExt={}));var OfficeExt;(function(a){var b=null,c=true,d=function(){function d(d,c,b){var a=this;a._handler=d;a._initParam=c;a._cacheManager=b.cacheManager;a._cachePrefix=b.cachePrefix;a._cid=b.cid;a._correlationId=b.telemetryContext.correlationId}d.prototype.tryFail=function(b,d){if(b==200)return false;d({httpStatus:b,status:a.DataServiceResultCode.Failed});return c};d.prototype.getLastStoreUpdate=function(c){var b=this,d=b,e=b._initParam.appUILocale;b._handler.getLastStoreUpdate(e,b._correlationId,function(b,e){if(d.tryFail(b,c)){d.logServiceCallResponseError("laststoreupdate",b);return}c({status:a.DataServiceResultCode.Succeeded,value:a.OmexXmlProcessor.ProcessLastStoreUpdate(e)})})};d.prototype.getEntitlementAsync=function(j,f,k){var d=this,e=d,h=OSF.OmexAppVersions[d._initParam.appName],g=OSF.OUtil.formatString(d._cachePrefix+a.CacheConsts.entitlementsKey,h,d._cid);if(k)d._cacheManager.RemoveCacheItem(g);else{var i=d._cacheManager.GetCacheItem(g,c);if(i!=b){f({status:a.DataServiceResultCode.Succeeded,value:i});return}}d._handler.getEntitlement(j,h,d._correlationId,function(c,d){if(e.tryFail(c,f)){e.logServiceCallResponseError("entitlement",c);return}var b=a.OmexXmlProcessor.ProcessEntitlement(d);b.cid=e._cid;e._cacheManager.SetCacheItem(g,b,b.refreshRate2/a.CacheConsts.hourToDayConversionFactor);f({status:a.DataServiceResultCode.Succeeded,value:b})})};d.prototype.getEToken=function(b,e,c){var d=this,h=e,i=b.storeId,f=b.assetId,g=b.appVersion;this._handler.getEToken(i,h,f,g,this._correlationId,function(b,e){if(d.tryFail(b,c)){d.logServiceCallResponseError("etoken",b);return}c({status:a.DataServiceResultCode.Succeeded,value:a.OmexXmlProcessor.ProcessClientAppInstallInfo(e,OSF.ClientAppInfoReturnType.etokenOnly)})})};d.prototype.getETokenAndManifest=function(d,c,b){var e=this;this.getEToken(d,c,function(f){if(f.status!=a.DataServiceResultCode.Succeeded){b(f);return}e.getManifest(d,c,function(c){if(c.status!=a.DataServiceResultCode.Succeeded){f.status=c.status;f.httpStatus=c.httpStatus;b(f);return}f.value.manifest=c.value.manifest;b(f)})})};d.prototype.getManifest=function(c,b,d){var e=b;this._handler.getManifest(e,c.assetId,this._correlationId,function(c,b){d({status:a.DataServiceResultCode.Succeeded,value:a.OmexXmlProcessor.ConvertAnonymousManifest(c,b)})})};d.prototype.getAppState=function(b,c){var d=this,e=b.storeId+":"+b.assetId;this._handler.getAppState(e,this._correlationId,function(b,e){if(d.tryFail(b,c)){d.logServiceCallResponseError("appstate",b);return}c({status:a.DataServiceResultCode.Succeeded,value:a.OmexXmlProcessor.ProcessAppState(e)})})};d.prototype.getKilledApps=function(b){var c=this;this._handler.getKilledApps(this._correlationId,function(d,e){if(c.tryFail(d,b)){c.logServiceCallResponseError("killedapps",d);return}b({status:a.DataServiceResultCode.Succeeded,value:a.OmexXmlProcessor.ProcessKilledApps(e)})})};d.prototype.getAppDetails=function(e,d,b){var c=this;this._handler.getAppDetails(d,e.join(","),this._correlationId,function(d,e){if(c.tryFail(d,b)){c.logServiceCallResponseError("appdetails",d);return}b({status:a.DataServiceResultCode.Succeeded,value:a.OmexXmlProcessor.ProcessAppDetails(e)})})};d.prototype.removeApps=function(d,c){var b=this;this._handler.removeApps(d.join(","),this._correlationId,function(e,f){if(b.tryFail(e,c)){b.logServiceCallResponseError("removeapps",e);return}var d=a.OmexXmlProcessor.ProcessRemoveAppResponse(f);d.removedApps.some(function(a){return a.result2==OSF.OmexRemoveAppStatus.Success})&&b.clearEntitlementCache();c({status:a.DataServiceResultCode.Succeeded,value:d})})};d.prototype.clearEntitlementCache=function(){var b=".*",c=new RegExp(OSF.OUtil.formatString(a.CacheConsts.entitlementsKey,b,b),"i");this._cacheManager.RemoveMatches([c])};d.prototype.logServiceCallResponseError=function(d,a){var c="s2s request "+d+" failed";if(a)c+=":"+a;Telemetry.RuntimeTelemetryHelper.LogExceptionTag(c,b,this._correlationId,18657699)};return d}();a.OmexCatalogServiceS2SScope=d;var e=function(){function e(a){this._cid="";this._initParam=a}e.initRequestHandler=function(a){if(e._requestHandler==b)e._requestHandler=a};e.prototype.getCID=function(){return this._cid};e.prototype.initialize=function(f,d){var g=this;if(e._requestHandler==b){d({status:a.DataServiceResultCode.Failed,httpStatus:404});return}if(this._initParam.omexForceAnonymous){d({status:a.DataServiceResultCode.Succeeded,value:{anonymous:c}});return}e._requestHandler.getUserId(f,function(e,h){if(e==200){g._cid=h.trim();d({status:a.DataServiceResultCode.Succeeded,value:{anonymous:false}})}else if(e==403)d({status:a.DataServiceResultCode.Succeeded,value:{anonymous:c}});else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("s2s getuserId request failed "+e,b,f,18657728);d({status:a.DataServiceResultCode.Failed,httpStatus:e})}})};e.prototype.createScope=function(a){return new d(e._requestHandler,this._initParam,a)};return e}();a.S2SOmexCatalogService=e})(OfficeExt||(OfficeExt={}));var _omexCacheManager=new OfficeExt.AppsDataCacheManager(OSF.OUtil.getLocalStorage(),new OfficeExt.SafeSerializer),_omexDataProvider=OmexDataProvider.GetInstance(_omexCacheManager),_omexCatalogServiceS2SWrapper=null;OSF.OsfControl=function(b){var d=null,e=true,c=false,a=this;OSF.OUtil.validateParamObject(b,{div:{type:Object,mayBeNull:c},contextActivationMgr:{type:Object,mayBeNull:c},id:{type:String,mayBeNull:c},marketplaceID:{type:String,mayBeNull:c},marketplaceVersion:{type:String,mayBeNull:c},store:{type:String,mayBeNull:c},storeType:{type:String,mayBeNull:c},alternateReference:{type:Object,mayBeNull:e},settings:{type:Object,mayBeNull:e},reason:{type:String,mayBeNull:e},osfControlType:{type:Number,mayBeNull:e},snapshotUrl:{type:String,mayBeNull:e},preactivationCallback:{type:Object,mayBeNull:e},virtualOsfControlActivationCallback:{type:Object,mayBeNull:e},isvirtualOsfControl:{type:Boolean,mayBeNull:e},isDialog:{type:Boolean,mayBeNull:e},hostCustomMessage:{type:String,mayBeNull:e}},d);a._div=b.div;a._contextActivationMgr=b.contextActivationMgr;a._id=b.id;a._storeType=b.storeType.toLowerCase();a._storeLocator=b.store;a._marketplaceID=b.marketplaceID;a._marketplaceVersion=b.marketplaceVersion;a._alternateReference=b.alternateReference;a._settings=b.settings||{};a._reason=b.reason==undefined?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:b.reason;a._osfControlType=b.osfControlType==undefined?OSF.OsfControlType.DocumentLevel:b.osfControlType;a._snapshotUrl=b.snapshotUrl;a._status=OSF.OsfControlStatus.NotActivated;a._notificationParams=[];a._highPriorityCount=0;a._iframeUrl=d;a._permission=d;a._conversationId=d;a._manifestUrl=d;a._pageStatus=OSF.OsfControlPageStatus.NotStarted;a._pageIsReadyTimerExpired=c;a._timer=d;a._retryLoadingNum=2;a._frame=d;a._agaveEndPoint=d;a._etoken="";a._sqmDWords=[0,0];a._preactivationCallback=b.preactivationCallback;a._telemetryContext={};a._controlFocus=c;a._agavePageUrl=d;a._agaveWindowName=d;a._dataProvider=OfficeExt.AddinDataProviderFactory.createAddinDataProvider(a._storeType,a._contextActivationMgr);a._manifest=d;a._virtualOsfControlActivationCallback=b.virtualOsfControlActivationCallback;a._isvirtualOsfControl=b.isvirtualOsfControl==undefined?c:b.isvirtualOsfControl;a._isvirtualOsfControlCallbackInvoked=c;a._isDialog=b.isDialog==undefined?c:b.isDialog;a._hostCustomMessage=b.hostCustomMessage;if(OSF.OUtil.isiOS()){a._div.style.webkitOverflowScrolling="touch";a._div.style.overflow="auto"}a._appCorrelationId=OSF.OUtil.Guid.generateNewGuid();a._iframeOnLoadDelegate=Function.createDelegate(a,a._iframeOnLoad);a._retryActivate=d;a._onKeyDownEventDelegate=Function.createDelegate(a,a._onKeydownEvent)};OSF.OsfControl.prototype={activate:function(d){var i=false,b=null,f=true,a=this,g=a;try{Telemetry.AppLoadTimeHelper.ActivationStart(a._telemetryContext,a._sqmDWords[0],a._sqmDWords[1],a.getCorrelationId(),a._id);a._controlFocus=f;a._pageStatus=OSF.OsfControlPageStatus.Loading;OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.ActivationStart);if(a._status!==OSF.OsfControlStatus.Activated){OSF.OUtil.addEventListener(a._div,"keydown",a._onKeyDownEventDelegate);if(a._frame){OSF.OUtil.removeEventListener(a._frame,"load",a._iframeOnLoadDelegate);a._frame=b}while(a._div.childNodes.length>0)a._div.removeChild(a._div.childNodes.item(0));a._contextActivationMgr._ErrorUXHelper.showProgress(a._div,a._id);a._contextActivationMgr.registerOsfControl(a);d=d||{};d.hostType=a._contextActivationMgr._hostType;d.osfControl=d.osfControl||a;d.referenceInUse=d.referenceInUse||{id:a._marketplaceID,version:a._marketplaceVersion,storeType:a._storeType,storeLocator:a._storeLocator};d.correlationId=d.osfControl._appCorrelationId;if(!a._doesBrowserSupportRequiredFeatures()){a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnsupportedBroswer_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._refresh),b,b,b,f,OSF.ErrorStatusCodes.E_BROWSER_VERSION);a.invokePreactivationCompletedCallback();return}var q=document.createElement("iframe"),y="sandbox" in q;q=b;var o=i,n=OSF.OUtil.getLocalStorage();if(n)o=n.getItem(OSF.Constants.IgnoreSandBoxSupport);if(a._contextActivationMgr._autoTrusted&&!y&&!o){a._contextActivationMgr._ErrorUXHelper.removeProgressDiv(a._div,a._id);a._status=OSF.OsfControlStatus.NotSandBoxSupported;a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AppsDisabled_WRN,description:Strings.OsfRuntime.L_NotSandBoxSupported_ERR,buttonTxt:Strings.OsfRuntime.L_EnableAppsButton_TXT,buttonCallback:Function.createCallback(a._activateAgavesBlockedBySandboxNotSupport,a._contextActivationMgr),url:OSF.Constants.IEUpgradeUrl,urlButtonTxt:Strings.OsfRuntime.L_UpgradeBrowserButton_TXT,dismissCallback:b,reDisplay:f,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.WAC_HTML5IframeSandboxNotSupport,highPriority:f});a.invokePreactivationCompletedCallback();return}var c=a;Telemetry.AppLoadTimeHelper.ServerCallStart(a._telemetryContext);var e=d.referenceInUse;if(e.storeType===OSF.StoreType.UploadFileDevCatalog)a._dataProvider.getManifestAsync({referenceInUse:d.referenceInUse,contextActivationMgr:a._contextActivationMgr},Function.createDelegate(a,a._onGetManifestCompleted));else if(e.storeType===OSF.StoreType.Exchange||e.storeType===OSF.StoreType.InMemory)OSF.OsfManifestManager.getManifestAsync(d,Function.createDelegate(a,a._onGetManifestCompleted));else if(e.storeType===OSF.StoreType.Registry&&a._contextActivationMgr._enableDevCatalog)if(d.osfControl.getReason()==Microsoft.Office.WebExtension.InitializationReason.DocumentOpened){var x=function(b){var a=new OSF.Manifest.Manifest(b,c._contextActivationMgr.getAppUILocale());!OSF.OsfManifestManager.hasManifest(a.getMarketplaceID(),a.getMarketplaceVersion())&&OSF.OsfManifestManager.cacheManifest(a.getMarketplaceID(),a.getMarketplaceVersion(),a);OSF.OsfManifestManager.getManifestAsync(d,Function.createDelegate(c,c._onGetManifestCompleted))},w=function(a){alert("Error when requsting manifest file: "+a)};OSF.OUtil.xhrGet(a._contextActivationMgr._devCatalogUrl+"/"+e.id+".xml",x,w)}else OSF.OsfManifestManager.getManifestAsync(d,Function.createDelegate(a,a._onGetManifestCompleted));else if(e.storeType===OSF.StoreType.OneDrive&&a._contextActivationMgr._enableOneDriveCatalog){var s=function(b){var a=new OSF.Manifest.Manifest(b,c._contextActivationMgr.getAppUILocale());OSF.OsfManifestManager.cacheManifest(e.id,a.getMarketplaceVersion(),a);OSF.OsfManifestManager.getManifestAsync(d,Function.createDelegate(c,c._onGetManifestCompleted))},t=function(){c._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(c,c._refresh),b,b,b,b,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},z=window.location.protocol+"//"+window.location.host;OSF.OneDriveOAuth.setHostCallbackUri(z);var j=a._contextActivationMgr._oneDriveCatalogBaseApiUrl+"/root:/Manifests/"+e.id+":/content?access_token=",u=function(a){j=j+a;OSF.OUtil.xhrGet(j,s,t)},v=function(){c._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(c,c._refresh),b,b,b,b,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)};OSF.OneDriveOAuth.getAccessToken(u,v)}else if(e.storeType===OSF.StoreType.SPCatalog)if(a._contextActivationMgr._doesUrlHaveSupportedProtocol(e.storeLocator)){Telemetry.AppLoadTimeHelper.EntitlementCheckStart(a._telemetryContext);d.webUrl=e.storeLocator;OSF.OUtil.writeProfilerMark(OSF.OsfOfficeExtensionManagerPerfMarker.GetEntitlementStart);OSF.OsfManifestManager.getCorporateCatalogEntitlementsAsync(d,Function.createDelegate(a,a._onGetEntitlementsCompleted))}else a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveUnknownStoreType_ERR,b,b,b,b,b,b,OSF.ErrorStatusCodes.E_MANIFEST_REFERENCE_INVALID);else if(e.storeType===OSF.StoreType.SPApp){Telemetry.AppLoadTimeHelper.EntitlementCheckStart(a._telemetryContext);d.baseUrl=a._contextActivationMgr.getPageBaseUrl();d.pageUrl=a._contextActivationMgr._docUrl;d.webUrl=a._contextActivationMgr._webUrl;d.appWebUrl=a._contextActivationMgr._webUrl;OSF.OsfManifestManager.getSPAppEntitlementsAsync(d,Function.createDelegate(a,a._onGetEntitlementsCompleted))}else if(e.storeType===OSF.StoreType.OMEX)if(a._contextActivationMgr.isExternalMarketplaceAllowed()&&a._contextActivationMgr._doesUrlHaveSupportedProtocol(a._contextActivationMgr._osfOmexBaseUrl)){if(!a._omexEntitlement){a._omexEntitlement={contentMarket:e.storeLocator,version:e.version,assetId:e.id,etoken:"",hasEntitlement:i};a._omexEntitlement.endPointUrl=a._contextActivationMgr._getOmexEndPointPageUrl(e.id,e.storeLocator)}d.clientVersion=a._contextActivationMgr._getClientVersionForOmex();if(d.clientVersion){d.clientName=a._contextActivationMgr._getClientNameForOmex();d.appVersion=a._contextActivationMgr._getAppVersionForOmex()}Telemetry.AppLoadTimeHelper.AuthenticationStart(a._telemetryContext);var p=f,C={contentMarket:e.storeLocator,assetID:e.id};if(_omexDataProvider.AllCached(d,C))try{Telemetry.AppLoadTimeHelper.AuthenticationEnd(c._telemetryContext);d.anonymous=f;d.clientEndPoint={};Telemetry.AppLoadTimeHelper.KilledAppsCheckStart(c._telemetryContext);OSF.OsfManifestManager.getOmexKilledAppsAsync(d,Function.createDelegate(c,c._onGetOmexKilledAppsCompleted));Telemetry.AppLoadTimeHelper.AppStateCheckStart(c._telemetryContext);OSF.OsfManifestManager.getOmexAppStateAsync(d,Function.createDelegate(c,c._onGetOmexAppStateCompleted));p=i}catch(r){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("omexDataProvider cache check failed.",r,b,17585049)}var l=OfficeExt.S2SOmexCatalogService._requestHandler?f:i;if(p){var h=_omexCatalogServiceS2SWrapper;if(h==b){var B={appName:a._contextActivationMgr.getAppName(),AppVersion:a._contextActivationMgr._getClientVersionForOmex(),clientMode:a._contextActivationMgr.getClientMode(),appUILocale:a._contextActivationMgr.getAppUILocale(),omexBaseUrl:a._contextActivationMgr.getOsfOmexBaseUrl(),docUrl:a._contextActivationMgr.getDocUrl(),omexForceAnonymous:a._contextActivationMgr._omexForceAnonymous};_omexCatalogServiceS2SWrapper=h={catalogService:new OfficeExt.S2SOmexCatalogService(B),hasBeenAuthenticated:i}}var A={assetId:e.id,storeId:e.storeLocator,appVersion:e.version,storeType:e.storeType,targetType:""};d.addInEntitlement=A;if(!l)h.catalogService.initialize=function(c,a){a({status:OfficeExt.DataServiceResultCode.Succeeded,value:b})};var k=a.getCorrelationId();h.catalogService.initialize(k,function(a){if(l&&a.status==OfficeExt.DataServiceResultCode.Succeeded){Telemetry.AppLoadTimeHelper.SetActivationRuntimeType(c._telemetryContext,OSF.ActivationTypes.V1S2SEnabled);if(!h.hasBeenAuthenticated){h.hasBeenAuthenticated=f;h.catalogService.initialize=function(c,b){b(a)}}var n;if(a.value.anonymous)n=OfficeExt.CacheConsts.anonymousCacheKeyPrefix;else n=OfficeExt.CacheConsts.gatedCacheKeyPrefix;d.useS2S=f;d.anonymous=a.value.anonymous;var p=h.catalogService.createScope({cacheManager:_omexCacheManager,cachePrefix:n,cid:h.catalogService.getCID(),anonymous:a.value.anonymous,telemetryContext:new OfficeExt.ActivationTelemetryContext(k,g._telemetryContext,g._sqmDWords[0],g._sqmDWords[1],g._id)});d.clientEndPoint=p;Telemetry.AppLoadTimeHelper.AuthenticationEnd(c._telemetryContext);Telemetry.AppLoadTimeHelper.SetAnonymousFlag(c._telemetryContext,d.anonymous);if(!a.value.anonymous){Telemetry.AppLoadTimeHelper.EntitlementCheckStart(c._telemetryContext);OSF.OsfManifestManager.getOmexEntitlementsAsync(d,Function.createDelegate(c,c._onGetOmexEntitlementsCompleted));Telemetry.AppLoadTimeHelper.KilledAppsCheckStart(c._telemetryContext);OSF.OsfManifestManager.getOmexKilledAppsAsync(d,Function.createDelegate(c,c._onGetOmexKilledAppsCompleted))}else{Telemetry.AppLoadTimeHelper.KilledAppsCheckStart(c._telemetryContext);OSF.OsfManifestManager.getOmexKilledAppsAsync(d,Function.createDelegate(c,c._onGetOmexKilledAppsCompleted));Telemetry.AppLoadTimeHelper.AppStateCheckStart(c._telemetryContext);OSF.OsfManifestManager.getOmexAppStateAsync(d,Function.createDelegate(c,c._onGetOmexAppStateCompleted))}}else{l&&Telemetry.RuntimeTelemetryHelper.LogCommonMessage("s2s enabled while fall back, error code "+a.status,k,0);Telemetry.AppLoadTimeHelper.SetActivationRuntimeType(c._telemetryContext,OSF.ActivationTypes.V1Enabled);var o=function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var d=parseInt(a.value);if(d==OSF.OmexAuthNStatus.Authenticated){c._contextActivationMgr._omexAuthNStatus=OSF.OmexAuthNStatus.Authenticated;c._contextActivationMgr._createOmexProxy(c._contextActivationMgr._omexGatedWSProxy,j)}else if(d==OSF.OmexAuthNStatus.Anonymous||d==OSF.OmexAuthNStatus.Unknown){c._contextActivationMgr._omexAuthNStatus=OSF.OmexAuthNStatus.Anonymous;c._contextActivationMgr._createOmexProxy(c._contextActivationMgr._omexAnonymousWSProxy,e)}}else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("OMEX_getAuthNStatus failed:"+OfficeExt.WACUtils.serializeObjectToString(a),b,b,17585048);c._contextActivationMgr._omexAuthNStatus=OSF.OmexAuthNStatus.CheckFailed;if(c._contextActivationMgr._omexForceAnonymous)c._contextActivationMgr._createOmexProxy(c._contextActivationMgr._omexAnonymousWSProxy,e);else c._contextActivationMgr._createOmexProxy(c._contextActivationMgr._omexGatedWSProxy,j)}},m=1,e=function(a){if(a)if(c._contextActivationMgr._omexAuthNStatus==OSF.OmexAuthNStatus.NotAttempted){var e={clientEndPoint:b};e.clientEndPoint=a;OSF.OsfManifestManager._invokeProxyMethodAsync(d,"OMEX_getAuthNStatus",o,e)}else{Telemetry.AppLoadTimeHelper.AuthenticationEnd(c._telemetryContext);Telemetry.AppLoadTimeHelper.KilledAppsCheckStart(c._telemetryContext);if(c._contextActivationMgr._omexAuthNStatus==OSF.OmexAuthNStatus.CheckFailed)c._contextActivationMgr._omexForceAnonymous=f;d.anonymous=f;Telemetry.AppLoadTimeHelper.SetAnonymousFlag(c._telemetryContext,d.anonymous);d.clientEndPoint=a;OSF.OsfManifestManager.getOmexKilledAppsAsync(d,Function.createDelegate(c,c._onGetOmexKilledAppsCompleted));Telemetry.AppLoadTimeHelper.AppStateCheckStart(c._telemetryContext);OSF.OsfManifestManager.getOmexAppStateAsync(d,Function.createDelegate(c,c._onGetOmexAppStateCompleted))}else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("ClientEndPoint is null after creating anonymouseOmexProxy.",b,b,17356608);c._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(c,c._refresh),b,b,b,b,OSF.ErrorStatusCodes.WAC_AgaveAnonymousProxyCreationError)}},j=function(a){Telemetry.AppLoadTimeHelper.SetRetryCount(c._telemetryContext,m);if(a){Telemetry.AppLoadTimeHelper.AuthenticationEnd(c._telemetryContext);Telemetry.AppLoadTimeHelper.EntitlementCheckStart(c._telemetryContext);d.anonymous=i;Telemetry.AppLoadTimeHelper.SetAnonymousFlag(c._telemetryContext,d.anonymous);d.clientEndPoint=a;OSF.OsfManifestManager.getOmexEntitlementsAsync(d,Function.createDelegate(c,c._onGetOmexEntitlementsCompleted));Telemetry.AppLoadTimeHelper.KilledAppsCheckStart(c._telemetryContext);OSF.OsfManifestManager.getOmexKilledAppsAsync(d,Function.createDelegate(c,c._onGetOmexKilledAppsCompleted))}else if(m<OSF.Constants.AuthenticatedConnectMaxTries){m++;if(c._contextActivationMgr._omexAuthNStatus==OSF.OmexAuthNStatus.CheckFailed)c._contextActivationMgr._createOmexProxy(c._contextActivationMgr._omexGatedWSProxy,j);else c._contextActivationMgr._createOmexProxy(c._contextActivationMgr._omexAnonymousWSProxy,e)}else c._contextActivationMgr._createOmexProxy(c._contextActivationMgr._omexAnonymousWSProxy,e)};if(g._contextActivationMgr._omexAuthNStatus==OSF.OmexAuthNStatus.CheckFailed)if(g._contextActivationMgr._omexForceAnonymous)g._contextActivationMgr._createOmexProxy(g._contextActivationMgr._omexAnonymousWSProxy,e);else g._contextActivationMgr._createOmexProxy(g._contextActivationMgr._omexGatedWSProxy,j);else if(g._contextActivationMgr._omexForceAnonymous)g._contextActivationMgr._createOmexProxy(g._contextActivationMgr._omexAnonymousWSProxy,e);else{g._contextActivationMgr._omexAuthNStatus=OSF.OmexAuthNStatus.NotAttempted;g._contextActivationMgr._createOmexProxy(g._contextActivationMgr._omexGatedWSProxy,j)}}})}a._contextActivationMgr._preloadOfficeJs()}else a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveOmexNotConfigured_ERR,b,b,b,b,b,b,OSF.ErrorStatusCodes.E_TRUSTCENTER_CATALOG_UNTRUSTED_ADMIN_CONTROLLED);else if(e.storeType===OSF.StoreType.FileSystem||e.storeType===OSF.StoreType.Registry)a._showActivationWarning(OSF.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,b,b,b,b,OSF.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType);else if(e.storeType===OSF.StoreType.OneDrive)a._showActivationWarning(OSF.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,b,b,b,b,OSF.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType);else a._showActivationError(OSF.OsfControlStatus.UnknownStore,Strings.OsfRuntime.L_AgaveUnknownStoreType_ERR,b,b,b,b,b,b,OSF.ErrorStatusCodes.E_MANIFEST_REFERENCE_INVALID)}}catch(m){OsfMsAjaxFactory.msAjaxDebug.trace("Error getting app data: "+m);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Error getting app data.",m,a.getCorrelationId(),8208995);a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._refresh),b,b,b,b,OSF.ErrorStatusCodes.WAC_AgaveOsfControlActivationError)}a.invokePreactivationCompletedCallback()},deActivate:function(){var b=null,a=this;try{OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.DeactivationStart);a._contextActivationMgr.dismissMessages(a._id);a._retryActivate=b;if(a._status!==OSF.OsfControlStatus.NotActivated){if(a._agaveEndPoint){Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(a._agaveEndPoint._conversationId);a._agaveEndPoint=b}if(a._frame){OSF.OUtil.removeEventListener(a._frame,"load",a._iframeOnLoadDelegate);a._frame=b}if(a._timer){window.clearTimeout(a._timer);a._timer=b}while(a._div.childNodes.length>0)a._div.removeChild(a._div.childNodes.item(0));a._status=OSF.OsfControlStatus.NotActivated;a._conversationId&&a._contextActivationMgr._getServiceEndPoint().unregisterConversation(a._conversationId);a._contextActivationMgr.raiseOsfControlStatusChange(a)}a._controlFocus=false;OSF.OUtil.removeEventListener(a._div,"keydown",a._onKeyDownEventDelegate);OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.DeactivationEnd)}catch(c){OsfMsAjaxFactory.msAjaxDebug.trace("Deactivate failed: "+c);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Deactivate failed.",c,a.getCorrelationId(),8209024)}},purge:function(d){var a=this,c=Function._validateParams(arguments,[{name:"purgeManifest",type:Boolean,mayBeNull:false}]);if(c)throw c;try{a._contextActivationMgr._ErrorUXHelper.purgeOsfControlNotification(a._id);a.deActivate();d&&OSF.OsfManifestManager.purgeManifest(a._marketplaceID,a._marketplaceVersion);a._contextActivationMgr.unregisterOsfControl(a)}catch(b){OsfMsAjaxFactory.msAjaxDebug.trace("Purge failed: "+b);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Purge failed.",b,a.getCorrelationId(),8209025)}},invokeVirtualOsfControlActivationCallback:function(b){var a=this;if(!a._isvirtualOsfControlCallbackInvoked&&a._virtualOsfControlActivationCallback){a._virtualOsfControlActivationCallback(a,b);a._isvirtualOsfControlCallbackInvoked=true}},onForceGetVirtualOsfControlManifestCompleted:function(a){var b=null;if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value)b=a.value;else this._status=OSF.OsfControlStatus.ActivationFailed;this.invokeVirtualOsfControlActivationCallback(b)},forceGetVirtualOsfControlManifest:function(){var b=null,a=this,c={contextActivationMgr:b,referenceInUse:b};c.referenceInUse={id:a._marketplaceID,version:a._marketplaceVersion,storeType:a._storeType,storeLocator:a._storeLocator};c.contextActivationMgr=a._contextActivationMgr;if(a._dataProvider!=b)a._dataProvider.getManifestAsync(c,Function.createDelegate(a,a.onForceGetVirtualOsfControlManifestCompleted));else{alert("AddinCommands is not supported in "+c.referenceInUse.storeType+" store.");a.onForceGetVirtualOsfControlManifestCompleted({statusCode:OSF.ProxyCallStatusCode.Failed,value:b})}},invokePreactivationCompletedCallback:function(){this._preactivationCallback&&this._preactivationCallback()},getMarketplaceID:function(){return this._marketplaceID},getMarketplaceVersion:function(){return this._marketplaceVersion},getContainingDiv:function(){return this._div},getID:function(){return this._id},getSettings:function(){return this._settings},setSettings:function(a){this._settings=a},getReason:function(){return this._reason},getManifest:function(){return this._manifest},getOsfControlType:function(){return this._osfControlType},getSnapshotUrl:function(){return this._snapshotUrl},getStoreType:function(){return this._storeType},getStoreLocator:function(){return this._storeLocator},getHostCustomMessage:function(){return this._hostCustomMessage},getProperty:function(b){var a=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false}]);if(a)throw a;return this._settings[b]},addProperty:function(c,b){var a=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false},{name:"value",type:String,mayBeNull:false}]);if(a)throw a;this._settings[c]=b},removeProperty:function(b){var a=Function._validateParams(arguments,[{name:"name",type:String,mayBeNull:false}]);if(a)throw a;delete this._settings[b]},getStatus:function(){return this._status},getPageStatus:function(){return this._pageStatus},getNotificationParams:function(){return this._notificationParams},removeFirstNotification:function(){var a=this;if(a._notificationParams[0]!=null&&a._notificationParams[0].highPriority)a._highPriorityCount--;a._notificationParams.shift()},getIframeUrl:function(){return this._iframeUrl},getPermission:function(){return this._permission},getTrustNoPrompt:function(){return false},getEToken:function(){return this._omexEntitlement?this._omexEntitlement.etoken:this._etoken},getCorrelationId:function(){return this._appCorrelationId},getAgavePageUrl:function(){return this._agavePageUrl},getAgaveWindowName:function(){return this._agaveWindowName},notifyAgave:function(a){this._agaveEndPoint&&this._agaveEndPoint.invoke("Office_notifyAgave",null,a)},_onKeydownEvent:function(a){var f="input, button, a",b=this;a.preventDefault=a.preventDefault||function(){a.returnValue=false};if(a.keyCode==117&&(a.ctrlKey||a.metaKey)){a.preventDefault();a.stopPropagation();var g=OSF.AgaveHostAction.CtrlF6Exit;if(a.shiftKey)g=OSF.AgaveHostAction.CtrlF6ExitShift;b._contextActivationMgr._notifyHost(b._id,g)}else if(a.keyCode==9){a.preventDefault();a.stopPropagation();var e=b._div.querySelectorAll(f),d=[],c=0;if(e.length==0)return;for(;c+1<e.length;c++)d[c]=e[c+1];d[c]=e[0];var i=OSF.OUtil.focusToNextTabbable(d,a.target||a.srcElement,a.shiftKey);if(!i)if(a.shiftKey)b._contextActivationMgr._notifyHost(b._id,OSF.AgaveHostAction.TabExitShift);else if(b._agaveEndPoint)b.notifyAgave(OSF.AgaveHostAction.TabIn);else b._contextActivationMgr._notifyHost(b._id,OSF.AgaveHostAction.TabExit)}else if(a.keyCode==27){a.preventDefault();b._contextActivationMgr._notifyHost(b._id,OSF.AgaveHostAction.EscExit)}else if(a.keyCode==113){a.preventDefault();b._contextActivationMgr._notifyHost(b._id,OSF.AgaveHostAction.F2Exit)}else if(a.keyCode==13||a.keyCode==32)for(var d=b._div.querySelectorAll(f),c=0;c<d.length;c++){var h=a.target||a.srcElement;if(d[c]===h){a.preventDefault();a.stopPropagation();h.click();return}}else{a.preventDefault();a.stopPropagation()}},_onGetEntitlementsCompleted:function(b){var a=null,d=this;b.context&&b.context.referenceInUse.storeType===OSF.StoreType.SPCatalog&&OSF.OUtil.writeProfilerMark(OSF.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd);if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded&&b.value){Telemetry.AppLoadTimeHelper.EntitlementCheckEnd(d._telemetryContext);for(var h=b.context.referenceInUse,g=b.value.entitlements,i=g.length,c,e=a,f=0;f<i;f++){c=g[f];if(c.OfficeExtensionID&&h.id&&c.OfficeExtensionID.toLowerCase()===h.id.toLowerCase())if(!e||d._lessThan(e.OfficeExtensionVersion,c.OfficeExtensionVersion))e=c}c=e;if(!c)d._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotExist_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createCallback(function(a){a.osfControl._refresh(a)},{clearCache:true,referenceInUse:b.context.referenceInUse,osfControl:b.context.osfControl}),a,a,a,a,OSF.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST);else if(c.OfficeExtensionKillbit)d._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByAdmin_ERR,a,a,a,a,a,a,OSF.ErrorStatusCodes.E_OEM_EXTENSION_KILLED);else{b.context.manifestUrl=c.EncodedAbsUrl;b.context.appInstanceId=c.AppInstanceID;b.context.productId=c.ProductID;if(b.context.appInstanceId)OSF.OsfManifestManager.getAppInstanceInfoByIdAsync(b.context,Function.createDelegate(d,d._onGetAppInstanceInfoByIdCompleted));else OSF.OsfManifestManager.getManifestAsync(b.context,Function.createDelegate(d,d._onGetManifestCompleted))}}else d._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(d,d._refresh),a,a,a,a,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetAppInstanceInfoByIdCompleted:function(e){var d=null,b=this;if(e.statusCode===OSF.ProxyCallStatusCode.Succeeded&&e.value){var c=e.value,a=e.context;if(c.AppWebFullUrl)a.appWebUrl=c.AppWebFullUrl;a.clientId=c.AppPrincipalId;a.remoteAppUrl=c.RemoteAppUrl;if(a.appWebUrl&&a.productId)OSF.OsfManifestManager.getSPTokenByProductIdAsync(a,Function.createDelegate(b,b._onGetSPTokenByProductIdCompleted));else OSF.OsfManifestManager.getManifestAsync(a,Function.createDelegate(b,b._onGetManifestCompleted))}else b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),d,d,d,d,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)},_onGetSPTokenByProductIdCompleted:function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value)this._etoken=a.value;OSF.OsfManifestManager.getManifestAsync(a.context,Function.createDelegate(this,this._onGetManifestCompleted))},_onGetOmexEntitlementsCompleted:function(b){var d=null,a=this;if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded&&b.value){Telemetry.AppLoadTimeHelper.EntitlementCheckEnd(a._telemetryContext);var g=b.context.referenceInUse,f=b.value.entitlements,i=f.length,c,h=false;a._contextActivationMgr._omexBillingMarket=b.value.billingMarket;_omexDataProvider.SetCustomerId(b.value.cid);for(var e=0;e<i;e++){c=f[e];if(c.assetId&&g.id&&c.assetId.toLowerCase()===g.id.toLowerCase()){h=true;break}}if(h){a._omexEntitlement.hasEntitlement=true;a._omexEntitlement.productId=c.productId;a._omexEntitlement.version=c.version;a._omexEntitlement.contentMarket=c.contentMarket;a._omexEntitlement.licenseType=c.licenseType;a._omexEntitlement.endPointUrl=a._contextActivationMgr._getOmexEndPointPageUrl(a._omexEntitlement.assetId,a._omexEntitlement.contentMarket)}Telemetry.AppLoadTimeHelper.SetOmexHasEntitlementFlag(a._telemetryContext,a._omexEntitlement.hasEntitlement);Telemetry.AppLoadTimeHelper.AppStateCheckStart(a._telemetryContext);OSF.OsfManifestManager.getOmexAppStateAsync(b.context,Function.createDelegate(a,a._onGetOmexAppStateCompleted))}else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("getOmexEntilements failed:"+OfficeExt.WACUtils.serializeObjectToString(b),d,d,17585050);a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._refresh),d,d,d,d,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)}},_onGetOmexKilledAppsCompleted:function(b){var a=null,c=this;if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded&&b.value){Telemetry.AppLoadTimeHelper.KilledAppsCheckEnd(c._telemetryContext);!b.cached&&_omexDataProvider.SetKilledAppsCache(b.context,b.value);for(var e=b.value.killedApps,g=e.length,f=false,d=0;d<g;d++)if(e[d].assetId===c._marketplaceID){f=true;break}if(f){c._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,a,a,c._omexEntitlement.endPointUrl,a,a,a,OSF.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED);return}}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("getOmexKilledApps failed:"+OfficeExt.WACUtils.serializeObjectToString(b),a,a,17585051)},_onGetOmexAppStateCompleted:function(e){var f=true,c=null,a=this;if(e.statusCode===OSF.ProxyCallStatusCode.Succeeded&&e.value){Telemetry.AppLoadTimeHelper.AppStateCheckEnd(a._telemetryContext);Telemetry.AppLoadTimeHelper.SetAppStateDataCachedFlag(a._telemetryContext,e.cached);var b=e.context,g=e.value,h=parseInt(g.state);if(h===OSF.OmexState.Killed){a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,c,c,a._omexEntitlement.endPointUrl,c,c,c,OSF.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED);return}else if(h===OSF.OmexState.Flagged)b.showSoftKilled=f;else if(h===OSF.OmexState.DeveloperWithdrawn)b.showDeveloperWithDrawWarning=f;if(!a._omexEntitlement.hasEntitlement&&(b.showDeveloperWithDrawWarning||b.showSoftKilled)){a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveRetired_ERR,c,c,a._omexEntitlement.endPointUrl,c,c,c,OSF.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE);if(b.showSoftKilled)return}a._omexEntitlement.latestVersion=g.version;if(a._omexEntitlement.hasEntitlement&&a._lessThan(a._omexEntitlement.version,a._omexEntitlement.latestVersion)){b.showNewerVersion=f;b.expectedVersion=a._omexEntitlement.latestVersion}!e.cached&&_omexDataProvider.SetAppStateCache(b,g);if(!b.anonymous&&a._reason!=Microsoft.Office.WebExtension.InitializationReason.Inserted&&!a._omexEntitlement.hasEntitlement){var d=a;if(b.useS2S){b.anonymous=f;Telemetry.AppLoadTimeHelper.ManifestRequestStart(d._telemetryContext);OSF.OsfManifestManager.getOmexManifestAndETokenAsync(b,Function.createDelegate(d,d._onGetOmexManifestAndETokenCompleted))}else{var i=function(){b.anonymous=f;b.clientEndPoint=d._contextActivationMgr._omexAnonymousWSProxy.clientEndPoint;Telemetry.AppLoadTimeHelper.ManifestRequestStart(d._telemetryContext);OSF.OsfManifestManager.getOmexManifestAndETokenAsync(b,Function.createDelegate(d,d._onGetOmexManifestAndETokenCompleted))};d._contextActivationMgr._createOmexProxy(d._contextActivationMgr._omexAnonymousWSProxy,i)}return}}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("getOmexAppState failed:"+OfficeExt.WACUtils.serializeObjectToString(e),c,c,17585052);Telemetry.AppLoadTimeHelper.ManifestRequestStart(a._telemetryContext);OSF.OsfManifestManager.getOmexManifestAndETokenAsync(e.context,Function.createDelegate(a,a._onGetOmexManifestAndETokenCompleted))},_onGetOmexManifestAndETokenCompleted:function(g){var a=null,c=true,b=this;if(g.statusCode===OSF.ProxyCallStatusCode.Succeeded&&g.value){var f=g.value,e=parseInt(f.status),d=g.context,h=d.referenceInUse;Telemetry.AppLoadTimeHelper.SetManifestDataCachedFlag(b._telemetryContext,g.cached);if(e===OSF.OmexClientAppStatus.OK){if(d.acceptedUpgrade){b._refresh({clearEntitlement:c,clearAppState:c,referenceInUse:h,osfControl:b});return}if(f.tokenExpirationDate&&new Date(f.tokenExpirationDate)<=new Date){b._showActivationWarning(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),a,a,OSF.ErrorStatusCodes.E_TOKEN_EXPIRED);return}b._omexEntitlement.etoken=f.etoken;b._omexEntitlement.entitlementType=f.entitlementType;if(!d.anonymous&&b._omexEntitlement.entitlementType&&b._omexEntitlement.entitlementType.toLowerCase()===OSF.OmexEntitlementType.Trial)d.showTrialInfo=c;try{!g.cached&&_omexDataProvider.SetManifestAndETokenCache(d,f);var i=new OSF.Manifest.Manifest(f.manifest,b._contextActivationMgr.getAppUILocale());d.manifestCached=f.cached;OSF.OsfManifestManager.cacheManifest(h.id,h.version,i);if(b._omexEntitlement.latestVersion&&b._lessThan(i.getMarketplaceVersion(),b._omexEntitlement.latestVersion)){d.showNewerVersion=c;d.expectedVersion=b._omexEntitlement.latestVersion}b._onGetManifestCompleted({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:i,context:d})}catch(j){OsfMsAjaxFactory.msAjaxDebug.trace("Invalid manifest from marketplace: "+j);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest from marketplace.",j,b.getCorrelationId(),8209026);b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),a,a,a,a,OSF.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT);return}}else if(e===OSF.OmexClientAppStatus.KilledAsset)b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveDisabledByOmex_ERR,a,a,b._omexEntitlement.endPointUrl,a,a,a,OSF.ErrorStatusCodes.E_OEM_OMEX_EXTENSION_KILLED);else if(e===OSF.OmexClientAppStatus.NoEntitlement||e===OSF.OmexClientAppStatus.TrialNotSupported||e===OSF.OmexClientAppStatus.LimitedTrial||e===OSF.OmexClientAppStatus.EntitlementDeactivated)if(!d.anonymous){var k=function(b){var a=b.osfControl;a._refresh({clearCache:c,referenceInUse:b.referenceInUse,osfControl:a})},m=function(d){var b=d.osfControl;window.open(b._omexEntitlement.endPointUrl);b._contextActivationMgr.displayNotification({id:b._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:Strings.OsfRuntime.L_AgaveLicenseNotAquiredRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:Function.createCallback(k,d),url:a,dismissCallback:a,detailView:c,reDisplay:c,displayDeactive:c,retryAll:c,errorCode:OSF.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED})};b._retryActivate=Function.createCallback(k,d);b._showActivationWarning(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveLicenseNotAquired_ERR,Strings.OsfRuntime.L_BuyButton_TXT,Function.createCallback(m,d),a,a,OSF.ErrorStatusCodes.E_OEM_EXTENSION_NOT_ENTITLED)}else{var n=function(d){var b=d.osfControl,c=window.location.href,a=b._contextActivationMgr._osfOmexBaseUrl+OSF.Constants.SignInRedirectUrl+encodeURIComponent(c);window.open(a)};Telemetry.RuntimeTelemetryHelper.LogExceptionTag("User not signed in.",a,b.getCorrelationId(),18661702);b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotViewableAnonymous_ERR,Strings.OsfRuntime.L_SignInButton_TXT,Function.createCallback(n,d),a,a,Strings.OsfRuntime.L_AgaveSigninRequiredTitle_TXT,a,OSF.ErrorStatusCodes.E_USER_NOT_SIGNED_IN)}else if(e===OSF.OmexClientAppStatus.UnknownAssetId)b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveNotExist_ERR,a,a,a,a,a,a,OSF.ErrorStatusCodes.E_MANIFEST_DOES_NOT_EXIST);else if(e===OSF.OmexClientAppStatus.Expired||e===OSF.OmexClientAppStatus.Invalid)b._showActivationWarning(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveLicenseExpired_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),a,a,OSF.ErrorStatusCodes.E_TOKEN_EXPIRED);else if(e===OSF.OmexClientAppStatus.Revoked)b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveRetired_ERR,a,a,b._omexEntitlement.endPointUrl,a,a,a,OSF.ErrorStatusCodes.E_OEM_EXTENSION_WITHDRAWN_FROM_SALE);else if(e===OSF.OmexClientAppStatus.VersionMismatch){var l=function(b){var a=b.osfControl;a._refresh({clearManifest:c,clearToken:c,referenceInUse:b.referenceInUse,osfControl:a,acceptedUpgrade:c,expectedVersion:f.version})};b._contextActivationMgr.displayNotification({id:b._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,buttonCallback:Function.createCallback(l,d),url:b._omexEntitlement.endPointUrl,dismissCallback:a,detailView:false,reDisplay:c,highPriority:c,displayDeactive:c,logAsError:c,errorCode:OSF.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE})}else if(e===OSF.OmexClientAppStatus.VersionNotSupported)b._showActivationWarning(OSF.OsfControlStatus.UnsupportedStore,Strings.OsfRuntime.L_AgaveUnsupportedStoreType_ERR,a,a,a,a,OSF.ErrorStatusCodes.WAC_AgaveUnsupportedStoreType);else b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),a,a,a,a,OSF.ErrorStatusCodes.WAC_AgaveUnknownClientAppStatus)}else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("GetOmexManifestAndEToken failed:"+OfficeExt.WACUtils.serializeObjectToString(g),a,a,17585053);b._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(b,b._refresh),a,a,a,a,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)}},_retryActivation:function(){var a=this;a._retryLoadingNum--;if(a._pageStatus===OSF.OsfControlPageStatus.Ready||a._retryLoadingNum<=0){a._contextActivationMgr._ErrorUXHelper.removeProgressDiv(a._div,a._id);a._retryLoadingNum=2}else a._refresh()},_iframeOnLoad:function(){var a=this;Telemetry.AppLoadTimeHelper.PageLoaded(this._telemetryContext);var b=function(a){var b=null;if(a){if(a._contextActivationMgr._ErrorUXHelper){OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.SelectionTimeout);a._contextActivationMgr._ErrorUXHelper.removeProgressDiv(a._div,a._id)}if(a._pageStatus!==OSF.OsfControlPageStatus.Ready)if(a._retryLoadingNum===2){var c=OSF.ErrorStatusCodes.WAC_AgaveActivationError;switch(a._telemetryContext.AppStatus){case "softKilled":c=OSF.ErrorStatusCodes.S_OEM_EXTENSION_FLAGGED;break;case "developerWithDrawWarning":c=OSF.ErrorStatusCodes.S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE}switch(a._pageStatus){case OSF.OsfControlPageStatus.FailedOriginCheck:c=OSF.ErrorStatusCodes.WAC_AgaveOriginCheckError;break;case OSF.OsfControlPageStatus.FailedPermissionCheck:c=OSF.ErrorStatusCodes.WAC_AgavePermissionCheckError;break;case OSF.OsfControlPageStatus.FailedHandleRequest:c=OSF.ErrorStatusCodes.WAC_AgaveHostHandleRequestError}a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveActivationError_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._retryActivation),b,b,b,b,c)}else a._retryLoadingNum===1&&a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_ActivateAttempLoading_ERR,Strings.OsfRuntime.L_ActivateButton_TXT,Function.createDelegate(a,a._retryActivation),b,b,b,b,OSF.ErrorStatusCodes.WAC_ActivateAttempLoading);else a._notifyHostIFrameOnLoaded();if(a._timer){window.clearTimeout(a._timer);a._timer=b}a._pageIsReadyTimerExpired=true}};if(a._pageStatus!==OSF.OsfControlPageStatus.Ready)a._timer=window.setTimeout(function(){b(a)},5e3*a._retryLoadingNum+1);else a._notifyHostIFrameOnLoaded()},_isOsfControlInEmbeddingMode:function(e){var a=false;try{var d=e.getContainingDiv().parentNode.parentNode,c=d.id,f=c.match(/^(m_excelEmbedRenderer_|ewaSynd).+$/ig);a=f!=null}catch(b){OsfMsAjaxFactory.msAjaxDebug.trace("_isOsfControlInEmbeddingMode error: "+b)}return a},_createIframeAndActivateOsfControl:function(c){var b=this,a=document.createElement("iframe");a.setAttribute("id",b._id);a.setAttribute("width","100%");a.setAttribute("height","100%");a.setAttribute("frameborder","0");var e=c?c:Strings.OsfRuntime.L_IframeTitle_TXT;a.setAttribute("title",e);a.style.msUserSelect="element";a.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");for(var d in b._contextActivationMgr._iframeAttributeBag)a.setAttribute(d,b._contextActivationMgr._iframeAttributeBag[d]);b._activate(a,b._iframeUrl);b._frame=a},_onGetManifestCompleted:function(h){var b=null,f=false,d=true,a=this;if(h.statusCode===OSF.ProxyCallStatusCode.Succeeded&&h.value){Telemetry.AppLoadTimeHelper.ManifestRequestEnd(a._telemetryContext);Telemetry.AppLoadTimeHelper.ServerCallEnd(a._telemetryContext);var g=h.value,c=h.context,j=c.referenceInUse,e=j.storeType,k=g.getDefaultDisplayName();a._manifest=g;if(c.manifestCached&&!c.retried){var q=g.getMarketplaceVersion();if(a._lessThan(q,j.version))if(e===OSF.StoreType.SPApp||e===OSF.StoreType.SPCatalog){a._refresh({clearCache:d,referenceInUse:j,osfControl:c.osfControl,retried:d});return}else if(e===OSF.StoreType.OMEX&&!c.showNewerVersion){c.showNewerVersion=d;c.expectedVersion=j.version}}if(g.requirementsSupported===f||g.requirementsSupported===undefined&&!a._contextActivationMgr.getRequirementsChecker().isManifestSupported(g)){g.requirementsSupported=f;var m,l,n=b;if(e===OSF.StoreType.OMEX){m=Strings.OsfRuntime.L_AgaveManifestRequirementsErrorOmex_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR;l=OSF.ErrorStatusCodes.WAC_AgaveRequirementsErrorOmex;n=a._omexEntitlement.endPointUrl}else{m=Strings.OsfRuntime.L_AgaveManifestRequirementsError_ERR||Strings.OsfRuntime.L_AgaveManifestError_ERR;l=OSF.ErrorStatusCodes.WAC_AgaveRequirementsError}a._showActivationError(OSF.OsfControlStatus.ActivationFailed,m,b,b,n,b,b,d,l);return}g.requirementsSupported=d;a._iframeUrl=g.getDefaultSourceLocation(a._contextActivationMgr.getFormFactor());a._permission=g.getPermission();a._appDomains=g.getAppDomains();if((e===OSF.StoreType.SPApp||e===OSF.StoreType.SPCatalog)&&a._iframeUrl){if(c.clientId)a._iframeUrl=a._iframeUrl.replace(/~clientid/ig,c.clientId);if(c.appWebUrl)a._iframeUrl=a._iframeUrl.replace(/~appweburl/ig,c.appWebUrl);if(c.remoteAppUrl)a._iframeUrl=a._iframeUrl.replace(/~remoteappurl/ig,c.remoteAppUrl)}if(!a._contextActivationMgr._doesUrlHaveSupportedProtocol(a._iframeUrl)){a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestError_ERR,b,b,b,b,b,b,OSF.ErrorStatusCodes.E_MANIFEST_INVALID_VALUE_FORMAT);return}if((!c.anonymous||!a._isOsfControlInEmbeddingMode(c.osfControl))&&!a._isvirtualOsfControl&&e!=OSF.StoreType.SPApp&&e!=OSF.StoreType.Exchange&&e!=OSF.StoreType.InMemory&&e!=OSF.StoreType.Registry&&e!=OSF.StoreType.UploadFileDevCatalog){var i=f,t=a._reason==Microsoft.Office.WebExtension.InitializationReason.Inserted||a._contextActivationMgr._autoTrusted||f;c.cacheKey=OSF.OUtil.formatString(OSF.Constants.ActivatedCacheKey,c.referenceInUse.id.toLowerCase(),c.referenceInUse.storeType,c.referenceInUse.storeLocator);i=a._getCachedFlag(c.cacheKey);if(e==OSF.StoreType.OMEX&&_omexDataProvider.GetCustomerId()!="0")i=a._omexEntitlement&&a._omexEntitlement.hasEntitlement;Telemetry.AppLoadTimeHelper.SetManifestTrustCachedFlag(a._telemetryContext,i);if(!i&&!t&&!a.getTrustNoPrompt()){OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.ActivationEnd);var s=function(c){var a=c.osfControl;a._setCachedFlag(c.cacheKey);Telemetry.AppLoadTimeHelper.ActivationStart(a._telemetryContext,a._sqmDWords[0],a._sqmDWords[1],a._appCorrelationId,a._id);this._pageStatus=OSF.OsfControlPageStatus.Loading;if(e==OSF.StoreType.OMEX&&_omexDataProvider.GetCustomerId()!="0"){c.anonymous=f;if(!c.useS2S)c.clientEndPoint=a._contextActivationMgr._omexGatedWSProxy.clientEndPoint;var g=function(c){if(c.statusCode===OSF.ProxyCallStatusCode.Succeeded&&c.value){var e=c.value,f=parseInt(e.status),g=c.context;if(f===OSF.OmexClientAppStatus.OK){!c.cached&&_omexDataProvider.SetManifestAndETokenCache(g,e);a._refresh({clearEntitlement:d,osfControl:a});return}}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Manual active getOmexManifestAndEToken failed:"+OfficeExt.WACUtils.serializeObjectToString(c),b,b,17585054);a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveServerConnectionFailed_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._refresh),b,b,b,b,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)};OSF.OsfManifestManager.getOmexManifestAndETokenAsync(c,Function.createDelegate(a,g))}else{Telemetry.AppLoadTimeHelper.SetAnonymousFlag(a._telemetryContext,c.anonymous);a._createIframeAndActivateOsfControl(k)}};a._showTrustError(k,g.getProviderName(),e,Function.createCallback(s,c));return}if(a._reason==Microsoft.Office.WebExtension.InitializationReason.Inserted){a._contextActivationMgr._setCachedFlag(c.cacheKey);c.osfControl._retryActivate=b;a._contextActivationMgr.retryAll(c.osfControl._marketplaceID)}}if(c.showNewerVersion){var r=function(a){var b=a.osfControl;b._refresh({clearManifest:d,clearToken:d,referenceInUse:a.referenceInUse,osfControl:b,acceptedUpgrade:d,expectedVersion:a.expectedVersion,retried:d})};a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:Strings.OsfRuntime.L_AgaveNewerVersion_ERR,buttonTxt:Strings.OsfRuntime.L_UpdateButton_TXT,buttonCallback:Function.createCallback(r,c),url:a._omexEntitlement.endPointUrl,dismissCallback:b,detailView:f,reDisplay:d,highPriority:d,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.E_MANIFEST_UPDATE_AVAILABLE})}else if(c.showDeveloperWithDrawWarning){a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:Strings.OsfRuntime.L_AgaveRetiring_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:b,url:a._omexEntitlement.endPointUrl,dismissCallback:b,detailView:f,reDisplay:d,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.S_OEM_EXTENSION_DEVELOPER_WITHDRAWN_FROM_SALE});c.osfControl._telemetryContext.AppStatus="developerWithDrawWarning"}else if(c.showSoftKilled){a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Warning,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:Strings.OsfRuntime.L_AgaveSoftKilled_ERR,buttonTxt:Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:b,url:a._omexEntitlement.endPointUrl,dismissCallback:b,detailView:f,reDisplay:d,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.S_OEM_EXTENSION_FLAGGED});c.osfControl._telemetryContext.AppStatus="softKilled"}else if(c.showTrialInfo){var o=function(b){var a=b.osfControl;a._refresh({clearCache:d,referenceInUse:b.referenceInUse,osfControl:a})},p=function(b){var a=b.osfControl;window.open(a._omexEntitlement.endPointUrl)};a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Information,title:Strings.OsfRuntime.L_AgaveInformationTitle_TXT,description:Strings.OsfRuntime.L_AgaveTrial_ERR,buttonTxt:Strings.OsfRuntime.L_BuyButton_TXT,buttonCallback:Function.createCallback(p,c),url:b,dismissCallback:b,reDisplay:d,highPriority:d,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.S_OEM_EXTENSION_TRIAL_MODE});a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.Information,title:Strings.OsfRuntime.L_AgaveInformationTitle_TXT,description:Strings.OsfRuntime.L_AgaveTrialRefresh_ERR,buttonTxt:Strings.OsfRuntime.L_RefreshButton_TXT,buttonCallback:Function.createCallback(o,c),url:b,dismissCallback:b,detailView:d,reDisplay:d,highPriority:d,displayDeactive:f,errorCode:OSF.ErrorStatusCodes.S_USER_CLICKED_BUY})}else a._isvirtualOsfControl&&a.invokeVirtualOsfControlActivationCallback(g);!a._isvirtualOsfControl&&a._createIframeAndActivateOsfControl(k)}else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("GetManifest failed:"+OfficeExt.WACUtils.serializeObjectToString(h),b,b,17585055);a._showActivationError(OSF.OsfControlStatus.ActivationFailed,Strings.OsfRuntime.L_AgaveManifestRetrieve_ERR,Strings.OsfRuntime.L_RetryButton_TXT,Function.createDelegate(a,a._refresh),b,b,b,b,OSF.ErrorStatusCodes.E_MANIFEST_SERVER_UNAVAILABLE)}},_lessThan:function(a,b){return OSF.OsfManifestManager.versionLessThan(a,b)},_showTrustError:function(g,f,i,e){var b=true,a=this,d=OSF.OUtil.formatString(Strings.OsfRuntime.L_AgaveName_INFO,g?g:"");d=a._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(d);var c=OSF.OUtil.formatString(Strings.OsfRuntime.L_AgaveProvider_INFO,f?f:"");c=a._contextActivationMgr._ErrorUXHelper.getHTMLEncodedString(c);var h=OSF.OUtil.formatString(Strings.OsfRuntime.L_AgaveUntrusted_INFO,d,c);a._retryActivate=e;a._contextActivationMgr.displayNotification({id:a._id,infoType:OSF.InfoType.SecurityInfo,title:Strings.OsfRuntime.L_AgaveNewAppTitle_TXT,description:h,buttonTxt:Strings.OsfRuntime.L_ActivateButton_TXT,buttonCallback:e,url:i===OSF.StoreType.OMEX?a._omexEntitlement.endPointUrl:null,dismissCallback:null,reDisplay:b,displayDeactive:b,logAsError:b,retryAll:b,errorCode:OSF.ErrorStatusCodes.E_TRUSTCENTER_MOE_UNACTIVATED})},_showActivationError:function(e,k,i,f,l,c,g,h,d){var b=true,a=this;a._status=e;var j={id:a._id,infoType:OSF.InfoType.Error,status:e,title:g||Strings.OsfRuntime.L_AgaveErrorTile_TXT,description:k,buttonTxt:i||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:f||null,url:l||null,dismissCallback:c||null,reDisplay:!c?b:false,displayDeactive:b,detailView:h?b:false,logAsError:b,errorCode:d?d:0};a._contextActivationMgr.displayNotification(j);a._contextActivationMgr.raiseOsfControlStatusChange(a)},_showActivationWarning:function(d,h,f,e,i,b,c){var a=this;a._status=d;var g={id:a._id,infoType:OSF.InfoType.Warning,status:d,title:Strings.OsfRuntime.L_AgaveWarningTitle_TXT,description:h,buttonTxt:f||Strings.OsfRuntime.L_OkButton_TXT,buttonCallback:e||null,url:i||null,dismissCallback:b||null,reDisplay:!b?true:false,displayDeactive:true,logAsError:true,errorCode:c?c:0};a._contextActivationMgr.displayNotification(g);a._contextActivationMgr.raiseOsfControlStatusChange(a)},_refresh:function(a){this.deActivate();this.activate(a)},_activateAgavesBlockedBySandboxNotSupport:function(b){b.activateAgavesBlockedBySandboxNotSupport();var a=OSF.OUtil.getLocalStorage();a&&a.setItem(OSF.Constants.IgnoreSandBoxSupport,"true")},_setCachedFlag:function(a){this._contextActivationMgr._setCachedFlag(a)},_getCachedFlag:function(a){return this._contextActivationMgr._getCachedFlag(a)},_deleteCachedFlag:function(a){this._contextActivationMgr._deleteCachedFlag(a)},_notifyHostIFrameOnLoaded:function(){this._contextActivationMgr._notifyHost&&this._contextActivationMgr._notifyHost(this._id,OSF.AgaveHostAction.PageIsReady)},_addETokenAsQueryParameter:function(e){var a=document.createElement("a");a.href=e;var f=this.getEToken(),b=OSF.Constants.ETokenParameterName+"="+encodeURIComponent(OSF.OUtil.encodeBase64(f)),d=a.search.length>1?a.search.substr(1)+"&":"";a.search=d+b;var c=a.href;a=null;return c},_activate:function(c,d){var a=this;Telemetry.AppLoadTimeHelper.PageStart(a._telemetryContext);d=a._addETokenAsQueryParameter(d);var h=a._contextActivationMgr.getClientId()+"_"+a._contextActivationMgr.getDocUrl()+"_"+a._id;a._conversationId=OSF.OUtil.getFrameNameAndConversationId(h,c);a._agaveWindowName=c.name;var f=function(d,e){d=d.trim()||"";var f="?",k="_host_Info=",g="&_host_Info=",c="#",i=d.split(c),b=i.shift(),j=i.join(c),h=b.split(f),a;if(h.length>1)a=b+g+e;else if(h.le>0)a=b+f+g+e;return [a,c,j].join("")},g=[a._contextActivationMgr._hostType,a._contextActivationMgr._hostPlatform,a._contextActivationMgr._hostSpecificFileVersion,a._contextActivationMgr._appUILocale,a.getCorrelationId(),a._isDialog?"isDialog":null],i=g.join("|"),b=f(d,i),e=window.location.href;b=OSF.OUtil.addXdmInfoAsHash(b,a._conversationId+"|"+a._id+"|"+(e.indexOf("$")>=0?encodeURIComponent(e):e));b=OSF.OUtil.addSerializerVersionAsHash(b,OSF.SerializerVersion.Browser);a._contextActivationMgr._getServiceEndPoint().registerConversation(a._conversationId,b,a._appDomains);a._pageIsReadyTimerExpired=false;OSF.OUtil.addEventListener(c,"load",a._iframeOnLoadDelegate);c.setAttribute("src",b);OSF.OUtil.addClass(c,"AddinIframe");a._agavePageUrl=b;a._div.appendChild(c);a._status=OSF.OsfControlStatus.Activated;OSF.OUtil.writeProfilerMark(OSF.OsfControlActivationPerfMarker.ActivationEnd);a._contextActivationMgr.raiseOsfControlStatusChange(a);Telemetry.AppLoadTimeHelper.OfficeJSStartToLoad(a._telemetryContext)},_getConversationId:function(){return this._conversationId},_doesBrowserSupportRequiredFeatures:function(){var a=false;if(Object.defineProperty)try{Object.defineProperty({},"myTestProperty",{"get":function(){return this.desc},"set":function(a){this.desc=a}});a=true}catch(b){}return a}};OSF.OUtil.setNamespace("Manifest",OSF);OSF.Manifest.HostApp=function(a){this._appName=a;this._minVersion=null};OSF.Manifest.HostApp.prototype={getAppName:function(){return this._appName},getMinVersion:function(){return this._minVersion},_setMinVersion:function(a){this._minVersion=a}};OSF.Manifest.ExtensionSettings=function(){this._sourceLocations={};this._defaultHeight=null;this._defaultWidth=null};OSF.Manifest.ExtensionSettings.prototype={getDefaultHeight:function(){return this._defaultHeight},getDefaultWidth:function(){return this._defaultWidth},getSourceLocations:function(){return this._sourceLocations},_addSourceLocation:function(a,b){this._sourceLocations[a]=b},_setDefaultWidth:function(a){this._defaultWidth=a},_setDefaultHeight:function(a){this._defaultHeight=a}};OSF.Manifest.Manifest=function(d,j){var f="o:OfficeApp",a=this;a._UILocale=j||"en-us";if(typeof d!=="string"){d(a);return}a._displayNames={};a._descriptions={};a._iconUrls={};a._extensionSettings={};a._highResolutionIconUrls={};var e;a._xmlProcessor=new OSF.XmlProcessor(d,OSF.ManifestNamespaces["1.1"]);if(a._xmlProcessor.selectSingleNode(f)){e=h;a._manifestSchemaVersion=OSF.ManifestSchemaVersion["1.1"]}else{a._xmlProcessor=new OSF.XmlProcessor(d,OSF.ManifestNamespaces["1.0"]);e=g;a._manifestSchemaVersion=OSF.ManifestSchemaVersion["1.0"]}var b=a._xmlProcessor.getDocumentElement();a._target=OSF.OUtil.parseEnum(b.getAttribute("xsi:type"),OSF.OfficeAppType);var c=a._xmlProcessor.selectSingleNode(f);b=a._xmlProcessor.selectSingleNode("o:Id",c);a._id=a._xmlProcessor.getNodeValue(b);var i=new RegExp("^[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}$","i");if(!i.test(a._id))throw OsfMsAjaxFactory.msAjaxError.argument("Manifest");b=a._xmlProcessor.selectSingleNode("o:Version",c);a._version=a._xmlProcessor.getNodeValue(b);b=a._xmlProcessor.selectSingleNode("o:ProviderName",c);a._providerName=a._xmlProcessor.getNodeValue(b);b=a._xmlProcessor.selectSingleNode("o:IdIssuer",c);a._idIssuer=a._parseIdIssuer(b);b=a._xmlProcessor.selectSingleNode("o:AlternateId",c);if(b)a._alternateId=a._xmlProcessor.getNodeValue(b);b=a._xmlProcessor.selectSingleNode("o:DefaultLocale",c);a._defaultLocale=a._xmlProcessor.getNodeValue(b);b=a._xmlProcessor.selectSingleNode("o:DisplayName",c);a._parseLocaleAwareSettings(b,Function.createDelegate(a,a._addDisplayName));b=a._xmlProcessor.selectSingleNode("o:Description",c);a._parseLocaleAwareSettings(b,Function.createDelegate(a,a._addDescription));b=a._xmlProcessor.selectSingleNode("o:AppDomains",c);a._appDomains=a._parseAppDomains(b);b=a._xmlProcessor.selectSingleNode("o:IconUrl",c);b&&a._parseLocaleAwareSettings(b,Function.createDelegate(a,a._addIconUrl));b=a._xmlProcessor.selectSingleNode("o:Signature",c);if(b)a._signature=a._xmlProcessor.getNodeValue(b);a._parseExtensionSettings();b=a._xmlProcessor.selectSingleNode("o:Permissions",c);a._permissions=a._parsePermission(b);a._allowSnapshot=true;b=a._xmlProcessor.selectSingleNode("o:AllowSnapshot",c);if(b)a._allowSnapshot=a._parseBooleanNode(b);e.apply(a);function g(){var a=this,d=a._xmlProcessor.selectSingleNode("o:Capabilities",c),b=a._xmlProcessor.selectNodes("o:Capability",d);a._capabilities=a._parseCapabilities(b)}function h(){var a=this,b=a._xmlProcessor.selectSingleNode("o:Hosts",c);a._hosts=a._parseHosts(b);b=a._xmlProcessor.selectSingleNode("o:Requirements",c);a._requirements=a._parseRequirements(b);b=a._xmlProcessor.selectSingleNode("o:HighResolutionIconUrl",c);b&&a._parseLocaleAwareSettings(b,Function.createDelegate(a,a._addHighResolutionIconUrl))}};OSF.Manifest.Manifest.prototype={getManifestSchemaVersion:function(){return this._manifestSchemaVersion},getMarketplaceID:function(){return this._id},getMarketplaceVersion:function(){return this._version},getDefaultLocale:function(){return this._defaultLocale},getProviderName:function(){return this._providerName},getIdIssuer:function(){return this._idIssuer},getAlternateId:function(){return this._alternateId},getSignature:function(){return this._signature},getCapabilities:function(){return this._capabilities},getDisplayName:function(a){return this._displayNames[a]},getDefaultDisplayName:function(){return this._getDefaultValue(this._displayNames)},getDescription:function(a){return this._descriptions[a]},getDefaultDescription:function(){return this._getDefaultValue(this._descriptions)},getIconUrl:function(a){return this._iconUrls[a]},getDefaultIconUrl:function(){return this._getDefaultValue(this._iconUrls)},getSourceLocation:function(d,c){var a=this._getExtensionSetting(c),b=a.getSourceLocations();return b[d]},getDefaultSourceLocation:function(c){var a=this._getExtensionSetting(c),b=a.getSourceLocations();return this._getDefaultValue(b)},getDefaultWidth:function(b){var a=this._getExtensionSetting(b);return a.getDefaultWidth()},getDefaultHeight:function(b){var a=this._getExtensionSetting(b);return a.getDefaultHeight()},getTarget:function(){return this._target},getPermission:function(){return this._permissions},hasPermission:function(a){return (this._permissions&a)===a},getHosts:function(){return this._hosts},getRequirements:function(){return this._requirements},getHighResolutionIconUrl:function(a){return this._highResolutionIconUrls[a]},getAppDomains:function(){return this._appDomains},isAllowSnapshot:function(){return this._allowSnapshot},_getDefaultValue:function(c){var d="undefined",b=this,a;if(typeof c[b._UILocale]==d)if(typeof c[b._defaultLocale]==d)for(var e in c){a=e;break}else a=b._defaultLocale;else a=b._UILocale;return c[a]},_getExtensionSetting:function(c){var a=this,b;if(typeof a._extensionSettings[c]!="undefined")b=a._extensionSettings[c];else for(var d in a._extensionSettings){b=a._extensionSettings[d];break}return b},_addDisplayName:function(a,b){this._displayNames[a]=b},_addDescription:function(a,b){this._descriptions[a]=b},_addIconUrl:function(a,b){this._iconUrls[a]=b},_parseLocaleAwareSettings:function(a,d){if(!a)throw OsfMsAjaxFactory.msAjaxError.argument("Manifest");var f=a.getAttribute("DefaultValue");d(this._defaultLocale,f);var b=this._xmlProcessor.selectNodes("o:Override",a);if(b)for(var i=b.length,c=0;c<i;c++){var e=b[c],g=e.getAttribute("Locale"),h=e.getAttribute("Value");d(g,h)}},_parseBooleanNode:function(b){if(!b)return false;else{var a=this._xmlProcessor.getNodeValue(b).toLowerCase();return a==="true"||a==="1"}},_parseIdIssuer:function(a){if(!a)return OSF.ManifestIdIssuer.Custom;else{var b=this._xmlProcessor.getNodeValue(a);return OSF.OUtil.parseEnum(b,OSF.ManifestIdIssuer)}},_parseCapabilities:function(d){for(var c=[],a,b=0;b<d.length;b++){var e=d[b];a=e.getAttribute("Name");a=OSF.OUtil.parseEnum(a,OSF.Capability);c.push(a)}return c},_parsePermission:function(a){if(!a)throw OsfMsAjaxFactory.msAjaxError.argument("Manifest");var b=this._xmlProcessor.getNodeValue(a);return OSF.OUtil.parseEnum(b,OSF.OsfControlPermission)},_parseExtensionSettings:function(){var a=this,c,d,b;for(var e in OSF.FormFactor){var g=a._xmlProcessor.selectSingleNode("o:OfficeApp");d=a._xmlProcessor.selectSingleNode("o:"+OSF.FormFactor[e],g);if(d){c=new OSF.Manifest.ExtensionSettings;b=a._xmlProcessor.selectSingleNode("o:SourceLocation",d);var f=function(a,b){c._addSourceLocation(a,b)};a._parseLocaleAwareSettings(b,f);b=a._xmlProcessor.selectSingleNode("o:RequestedWidth",d);b&&c._setDefaultWidth(a._xmlProcessor.getNodeValue(b));b=a._xmlProcessor.selectSingleNode("o:RequestedHeight",d);b&&c._setDefaultHeight(a._xmlProcessor.getNodeValue(b));a._extensionSettings[e]=c}}if(!c)throw OsfMsAjaxFactory.msAjaxError.argument("Manifest")},_parseHosts:function(d){var b=[];if(d)for(var c=this._xmlProcessor.selectNodes("o:Host",d),a=0;a<c.length;a++)b.push(c[a].getAttribute("Name"));return b},_parseRequirements:function(b){var a=this,c={sets:[],methods:[]};if(b){var e=a._xmlProcessor.selectSingleNode("o:Sets",b);c.sets=a._parseSets(e);var d=a._xmlProcessor.selectSingleNode("o:Methods",b);c.methods=a._parseMethods(d)}return c},_parseSets:function(a){var e=[];if(a)for(var g=a.getAttribute("DefaultMinVersion"),c=this._xmlProcessor.selectNodes("o:Set",a),b=0;b<c.length;b++){var d=c[b],f=d.getAttribute("MinVersion");e.push({name:d.getAttribute("Name"),version:f||g})}return e},_parseMethods:function(c){var d=[];if(c)for(var b=this._xmlProcessor.selectNodes("o:Method",c),a=0;a<b.length;a++)d.push(b[a].getAttribute("Name"));return d},_parseAppDomains:function(c){var d=[];if(c)for(var b=this._xmlProcessor.selectNodes("o:AppDomain",c),a=0;a<b.length;a++)d.push(this._xmlProcessor.getNodeValue(b[a]));return d},_addHighResolutionIconUrl:function(a,b){this._highResolutionIconUrls[a]=b},_isAddinCommandsManifest:function(h){var b=null,a=this,e=a._xmlProcessor.selectSingleNode("o:OfficeApp");if(e!==b&&a.getManifestSchemaVersion()===OSF.ManifestSchemaVersion["1.1"]){var f=a._xmlProcessor.selectSingleNode("ov:VersionOverrides",e);if(f!==b){var g=a._xmlProcessor.selectSingleNode("ov:Hosts",f);if(g!==b){var c=a._xmlProcessor.selectNodes("ov:Host",g);if(c!==b)for(var k=c.length,d=0;d<k;d++){var j=c[d].getAttribute("xsi:type");if(j===h){var i=a._xmlProcessor.selectSingleNode("ov:DesktopFormFactor",c[d]);if(i!=b)return true;else return false}}}}}return false}};OSF.OUtil.setNamespace("AppSpecificSetup",OSF);OSF.ContextActivationManager=function(f){var g="0",i="osfControl for the given ID doesn't exist.",c=null,e=true,a=false,b=this;OSF.OUtil.validateParamObject(f,{appName:{type:Number,mayBeNull:a},appVersion:{type:String,mayBeNull:a},clientMode:{type:Number,mayBeNull:a},appUILocale:{type:String,mayBeNull:a},dataLocale:{type:String,mayBeNull:a},osfOmexBaseUrl:{type:String,mayBeNull:e},devCatalogUrl:{type:String,mayBeNull:e},oneDriveCatalogBaseApiUrl:{type:String,mayBeNull:e},spBaseUrl:{type:String,mayBeNull:e},docUrl:{type:String,mayBeNull:e},hostControl:{type:Object,mayBeNull:e},pageBaseUrl:{type:String,mayBeNull:e},lcid:{type:String,mayBeNull:e},formFactor:{type:String,mayBeNull:e},controlStatusChanged:{type:Object,mayBeNull:e},notifyHost:{type:Object,mayBeNull:e},allowExternalMarketplace:{type:Boolean,mayBeNull:e},localizedScriptsUrl:{type:String,mayBeNull:e},localizedImagesUrl:{type:String,mayBeNull:e},localizedStylesUrl:{type:String,mayBeNull:e},localizedResourcesUrl:{type:String,mayBeNull:e},trustAgaves:{type:Boolean,mayBeNull:e},enableMyOrg:{type:Boolean,mayBeNull:e},enableMyApps:{type:Boolean,mayBeNull:e},enableDevCatalog:{type:Boolean,mayBeNull:e},enableOneDriveCatalog:{type:Boolean,mayBeNull:e},enableUploadFileDevCatalog:{type:Boolean,mayBeNull:e},omexForceAnonymous:{type:Boolean,mayBeNull:e},userNameHashCode:{type:Number,mayBeNull:e}},c);b._osfOmexBaseUrl=f.osfOmexBaseUrl;b._devCatalogUrl=f.devCatalogUrl;b._oneDriveCatalogBaseApiUrl=f.oneDriveCatalogBaseApiUrl;b._spBaseUrl=f.spBaseUrl;b._myOrgCatalogUrl=c;b._enableMyOrg=f.enableMyOrg||a;b._enableMyApps=f.enableMyApps||a;b._enableDevCatalog=f.enableDevCatalog||a;b._enableOneDriveCatalog=f.enableOneDriveCatalog||a;b._enableUploadFileDevCatalog=f.enableUploadFileDevCatalog||a;b._appName=f.appName;b._appVersion=f.appVersion;b._clientMode=f.clientMode;b._appUILocale=f.appUILocale;b._dataLocale=f.dataLocale;b._docUrl=f.docUrl;b._hostControl=f.hostControl;b._formFactor=f.formFactor||OSF.FormFactor.Default;b._pageBaseUrl=f.pageBaseUrl;b._lcid=f.lcid;b._controlStatusChanged=f.controlStatusChanged;b._notifyHost=f.notifyHost||function(){};b._allowExternalMarketplace=f.allowExternalMarketplace;b._localizedScriptsUrl=f.localizedScriptsUrl;b._localizedImagesUrl=f.localizedImagesUrl;b._localizedStylesUrl=f.localizedStylesUrl;b._localizedResourcesUrl=f.localizedResourcesUrl;b._autoTrusted=f.trustAgaves;b._omexForceAnonymous=f.omexForceAnonymous||a;b._userNameHashCode=f.userNameHashCode||0;if(b._pageBaseUrl&&b._pageBaseUrl.charAt(b._pageBaseUrl.length-1)!=="/")b._pageBaseUrl=b._pageBaseUrl+"/";if(b._localizedResourcesUrl&&b._localizedResourcesUrl.charAt(b._localizedResourcesUrl.length-1)!=="/")b._localizedResourcesUrl=b._localizedResourcesUrl+"/";b._clientId=OSF.OUtil.getUniqueId();b._cachedOsfControls={};b._iframeAttributeBag={};b._serviceEndPoint=c;b._serviceEndPointInternal=c;b._internalConversationId=c;b._iframeProxies={};b._iframeProxyCount=0;b._iframeNamePrefix="__officeExtensionProxy";b._webUrl=c;b._wsa=c;b._insertDialogDiv=c;b._hasPreloadedOfficeJs=a;b._contextMgrCorrelationId=OSF.OUtil.Guid.generateNewGuid();Telemetry.RuntimeTelemetryHelper.LogCommonMessage("_contextMgrCorrelationId :"+b._contextMgrCorrelationId,c,0);b._hostType=c;b._hostPlatform=c;b._hostSpecificFileVersion=c;b._requirementsChecker=new OSF.RequirementsChecker;b._onClickInstallOsfControl=c;if(b._osfOmexBaseUrl){var h,l=b._osfOmexBaseUrl.indexOf(OSF.Constants.ProtocolSeparator);if(l>=0)h=b._osfOmexBaseUrl.substr(l);else h=OSF.Constants.ProtocolSeparator+b._osfOmexBaseUrl;var n=OSF.Constants.Https+h,m=OSF.Constants.Https+h;if(OSF.OUtil.getQueryStringParamValue(window.location.search,OSF.Constants.OmexForceAnonymousParamName).toLowerCase()==OSF.Constants.OmexForceAnonymousParamValue.toLowerCase()){b._omexAuthNStatus=OSF.OmexAuthNStatus.Anonymous;b._omexForceAnonymous=e}else b._omexAuthNStatus=OSF.OmexAuthNStatus.NotAttempted;b._omexGatedWSProxy={proxyUrl:n+OSF.Constants.OmexGatedServiceExtension,proxyName:"__omexExtensionGatedProxy",isReady:a,clientEndPoint:c,pendingCallbacks:[]};b._omexWSProxy={proxyUrl:m+OSF.Constants.OmexUnGatedServiceExtension,proxyName:"__omexExtensionProxy",isReady:a,clientEndPoint:c,pendingCallbacks:[]};b._omexAnonymousWSProxy={proxyUrl:n+OSF.Constants.OmexAnonymousServiceExtension,proxyName:"__omexExtensionAnonymousProxy",isReady:a,clientEndPoint:c,pendingCallbacks:[]};b._omexBillingMarket=c;b._omexEndPointBaseUrl=m}OSF.OsfManifestManager._setUILocale(b._appUILocale);var d=b,t=function(p,m){var f="contextId",g=Function._validateParams(arguments,[{name:f,type:String,mayBeNull:a},{name:"gotAppContext",type:Function,mayBeNull:a}]);if(g){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Parameter validation error in getAppContextAsync.",g,c,9204816);throw g}var b=d.getOsfControl(p);if(!b){OsfMsAjaxFactory.msAjaxDebug.trace(i);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Cannot get osfControl with given ID.",c,c,9204817);throw OsfMsAjaxFactory.msAjaxError.argument(f)}else{Telemetry.AppLoadTimeHelper.OfficeJSLoaded(b._telemetryContext);var q=b.getEToken(),j=0;if(d._hostSpecificFileVersion&&d._hostSpecificFileVersion.indexOf(".")!=-1){var h=d._hostSpecificFileVersion.split("."),l=h[1];if(!isNaN(l))j=parseInt(h[1])}var n=d._requirementsChecker._getSupportedSet(),o=new OSF.OfficeAppContext(b.getMarketplaceID(),d._appName,d._appVersion,d._appUILocale,d._dataLocale,d._docUrl||window.location.href,d._clientMode,b.getSettings(),b.getReason(),b.getOsfControlType(),q,b._appCorrelationId,b.getID(),a,e,j,n,b.getHostCustomMessage());m(o);b._pageStatus=OSF.OsfControlPageStatus.Ready;b._pageIsReadyTimerExpired&&Telemetry.RuntimeTelemetryHelper.LogExceptionTag("App attempted to retrieve context after app activation error has occured.",c,b.getCorrelationId(),8209027);b._contextActivationMgr._ErrorUXHelper&&b._contextActivationMgr._ErrorUXHelper.removeProgressDiv(b._div,b._id);if(b._timer){window.clearTimeout(b._timer);b._timer=c}var k=b._conversationId+OSF.SharedConstants.NotificationConversationIdSuffix;b._agaveEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(k,b._frame.contentWindow,b._iframeUrl);Telemetry.AppLoadTimeHelper.ActivationEnd(b._telemetryContext)}};d.getContextForEmbeddingPage=function(){var b=0;if(d._hostSpecificFileVersion&&d._hostSpecificFileVersion.indexOf(".")!=-1){var a=d._hostSpecificFileVersion.split("."),c=a[1];if(!isNaN(c))b=parseInt(a[1])}var e=d._requirementsChecker._getSupportedSet();return {appName:d._appName,appVersion:d._appVersion,appUILocal:d._appUILocale,dataLocale:d._dataLocale,docUrl:d._docUrl||window.location.href,clientMode:d._clientMode,minorVersion:b,requirements:e}};var y=function(b){(!b||b.length!=2)&&OsfMsAjaxFactory.msAjaxDebug.trace("ContextActivationManager_notifyHost params is wrong.");var e=b[0],a=b[1],c=d.getOsfControl(e);if(!c)OsfMsAjaxFactory.msAjaxDebug.trace(i);else if(a===OSF.AgaveHostAction.TabExitShift||a===OSF.AgaveHostAction.ExitNoFocusableShift)d._ErrorUXHelper.focusOnNotificationUxShiftIn(e,a);else if(c._contextActivationMgr._notifyHost)c._contextActivationMgr._notifyHost(e,a);else OsfMsAjaxFactory.msAjaxDebug.trace("No notifyHost provided by the host.")},w=function(a){window.open(a.strUrl,a.strWindowName,a.strWindowFeatures)},j=function(f,h){if(!f.hasOwnProperty("fromInsertDialog")||f.fromInsertDialog)d._insertDialogDiv!=c&&d._insertDialogDiv.childNodes.length==2&&d._insertDialogDiv.removeChild(d._insertDialogDiv.lastChild);var g;if(f.storeType==OSF.StoreTypeEnum.MarketPlace)g={storeType:OSF.StoreType.OMEX,storeLocator:d._osfOmexBaseUrl};else if(f.storeType==OSF.StoreTypeEnum.Catalog)g={storeType:OSF.StoreType.SPCatalog,storeLocator:d._myOrgCatalogUrl};else if(f.storeType==OSF.StoreTypeEnum.OneDrive)g={storeType:OSF.StoreType.OneDrive,storeLocator:d._oneDriveCatalogBaseApiUrl};var b={assetId:"",contentMarket:"",anonymous:a,clientEndPoint:c,clearCache:a||f.refresh,clearKilledApps:a,referenceInUse:g,hostType:d._hostType},i=1;if(f&&f.storeType==OSF.StoreTypeEnum.MarketPlace){b.clientVersion=d._getClientVersionForOmex();if(b.clientVersion){b.clientName=d._getClientNameForOmex();b.appVersion=d._getAppVersionForOmex()}var l=function(g){if(g.statusCode===OSF.ProxyCallStatusCode.Succeeded&&g.value){var t=g.context.referenceInUse,o=g.value.entitlements,j=o.length;j===0&&h({errorCode:OSF.InvokeResultCode.S_OK});for(var f,c={},q=[],k=0;k<j;k++){f=o[k];if(c[f.contentMarket])c[f.contentMarket]+=","+f.assetId;else c[f.contentMarket]=f.assetId}i=1;var p=0,m=function(f){if(f.statusCode===OSF.ProxyCallStatusCode.Succeeded&&f.value&&f.value.length&&f.value.length>0){var a=f.value;!f.cached&&_omexDataProvider.SetAppDetailsCache(b,a);if(f.context.appDetails&&f.context.appDetails.length>0)for(var g=0;g<f.context.appDetails.length;g++)a.push(f.context.appDetails[g]);for(var i=d.getRequirementsChecker(),e=0;e<a.length;e++){if(i.isEntitlementFromOmexSupported(a[e])){var c=[];c.push(a[e].name);c.push(a[e].assetId);c.push(a[e].description);c.push(OSF.OUtil.getTargetType(a[e].appSubType));c.push(OSF.OUtil.normalizeAppVersion(a[e].version));c.push(a[e].assetId);c.push(OSF.StoreType.OMEX);c.push(parseInt(a[e].defaultWidth));c.push(parseInt(a[e].defaultHeight));c.push(a[e].iconUrl);c.push(a[e].provider);c.push(f.context.contentMarket);c.push(OSF.StoreType.OMEX);q.push(c)}p++}}if(p===j){var k={value:q,errorCode:OSF.InvokeResultCode.S_OK};h(k)}},l=function(e){if(e)for(var f in c){b.anonymous=a;b.clientEndPoint=e;b.assetId=c[f];b.contentMarket=f;var h=OSF.OUtil.shallowCopy(b);OSF.OsfManifestManager.getOmexAppDetailsAsync(h,Function.createDelegate(d,m))}else if(i<OSF.Constants.AuthenticatedConnectMaxTries){i++;d._createOmexProxy(d._omexWSProxy,l)}else{var j=window.location.href,g=d._osfOmexBaseUrl+OSF.Constants.SignInRedirectUrl+encodeURIComponent(j);window.location.assign(g)}},n=e;if(_omexDataProvider.AppDetailsCached(b,c))try{b.clientEndPoint=d._omexWSProxy.clientEndPoint;for(var r in c){b.anonymous=a;b.assetId=c[r];b.contentMarket=r;OSF.OsfManifestManager.getOmexAppDetailsAsync(b,Function.createDelegate(d,m))}n=a}catch(s){}n&&d._createOmexProxy(d._omexWSProxy,l)}},m=function(e){if(e.isReady){b.anonymous=a;b.clientEndPoint=e.clientEndPoint;OSF.OsfManifestManager.getOmexEntitlementsAsync(b,Function.createDelegate(d,l))}else{Telemetry.RuntimeTelemetryHelper.LogExceptionTag("asyncResult.isReady is false, set errorCode AS E_USER_NOT_SIGNED_IN.",c,d._contextMgrCorrelationId,18661703);var f={value:c,errorCode:OSF.InvokeResultCode.E_USER_NOT_SIGNED_IN};h(f)}};d._omexGatedWSProxy.refresh=f.refresh;d.isMyAppsReady(m)}else if(f&&f.storeType==OSF.StoreTypeEnum.Catalog){var k=function(e){e.context&&e.context.referenceInUse.storeType===OSF.StoreType.SPCatalog&&OSF.OUtil.writeProfilerMark(OSF.OsfOfficeExtensionManagerPerfMarker.GetEntitlementEnd);var f;if(e.statusCode===OSF.ProxyCallStatusCode.Succeeded&&e.value){for(var k=e.value.entitlements,n=k.length,b,l=[],j=0,m=d.getRequirementsChecker(),i=0;i<n;i++){b=k[i];if(m.isEntitlementFromCorpCatalogSupported(b)){var a=[];a.push(b.Title);a.push(b.OfficeExtensionID);a.push(b.OfficeExtensionDescription);a.push(OSF.OfficeAppType[b.OEType]);a.push(OSF.OUtil.normalizeAppVersion(b.OfficeExtensionVersion));a.push(b.OfficeExtensionID);a.push(OSF.StoreType.SPCatalog);a.push(parseInt(b.OfficeExtensionDefaultWidth.toString()));a.push(parseInt(b.OfficeExtensionDefaultHeight.toString()));a.push(b.OfficeExtensionIcon);a.push(b.OEProviderName);a.push(g.storeLocator);a.push(OSF.StoreType.SPCatalog);l.push(a);j++}}if(j>0)f={value:l,errorCode:OSF.InvokeResultCode.S_OK};else f={value:c,errorCode:OSF.InvokeResultCode.E_CATALOG_NO_APPS}}else if(!g.storeLocator)f={value:c,errorCode:OSF.InvokeResultCode.E_CATALOG_NO_APPS};else f={value:c,errorCode:OSF.InvokeResultCode.E_GENERIC_ERROR};h(f)};b.webUrl=g.storeLocator;b.osfControl={_contextActivationMgr:d,_telemetryContext:{}};b.noTargetType=e;OSF.OsfManifestManager.getCorporateCatalogEntitlementsAsync(b,Function.createDelegate(d,k))}else if(f&&f.storeType==OSF.StoreTypeEnum.OneDrive){var j=function(a){var b;if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var c=a.value.entitlements;b={value:c,errorCode:OSF.InvokeResultCode.S_OK};h(b)}};OSF.OsfManifestManager.getOneDriveEntitlementsAsync(b,j)}else OsfMsAjaxFactory.msAjaxDebug.trace("Unknown store type.")},x=function(){var b=window.location.href,a=d._osfOmexBaseUrl+OSF.Constants.SignInRedirectUrl+encodeURIComponent(b);window.location.assign(a)},v=function(a){window.open(a.pageUrl)},r=function(a){OsfMsAjaxFactory.msAjaxDebug.trace("onClickInsertOsfControl!");d._notifyHost(g,OSF.AgaveHostAction.InsertAgave,a)};b._onClickInstallOsfControl=function(i){if(!d._enableUploadFileDevCatalog)return;OsfMsAjaxFactory.msAjaxDebug.trace("onClickInstallOsfControl!");try{OSF.OUtil.validateParamObject(i,{manifest:{type:String,mayBeNull:a}},c);var f=new OSF.Manifest.Manifest(i.manifest,d.getAppUILocale()),h=f.getMarketplaceID(),k=f.getMarketplaceVersion(),l=OfficeExt.AddinDataProviderFactory.createAddinDataProvider(OSF.StoreType.UploadFileDevCatalog,c);if(l.validateAndCacheNewManifest(d,h,k,i.manifest,f)){var b={id:h,targetType:f.getTarget(),appVersion:k,currentStoreType:OSF.StoreType.UploadFileDevCatalog,storeId:"developer",assetId:h,assetStoreId:OSF.StoreType.UploadFileDevCatalog,width:parseInt(f.getDefaultWidth()||g),height:parseInt(f.getDefaultHeight()||g),isAddinCommands:f._isAddinCommandsManifest(OSF.getManifestHostType(d._hostType))};OSF.OUtil.validateParamObject(b,{id:{type:String,mayBeNull:a},targetType:{type:Number,mayBeNull:a},appVersion:{type:String,mayBeNull:a},width:{type:Number,mayBeNull:e},height:{type:Number,mayBeNull:e}},c);Telemetry.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,b.currentStoreType,b.assetId,b.appVersion,b.targetType,b.isAddinCommands,b.width,b.height);d._notifyHost(g,OSF.AgaveHostAction.InsertAgave,b)}else d._notifyHost(g,OSF.AgaveHostAction.NotifyHostError,c)}catch(j){OsfMsAjaxFactory.msAjaxDebug.trace("Invalid manifest from addincommands dev catalog: "+j);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest from addincommands dev catalog.",j,this._appCorrelationId,9315269);d._notifyHost(g,OSF.AgaveHostAction.NotifyHostError,c);return}};var q=function(a){OsfMsAjaxFactory.msAjaxDebug.trace("onClickRefreshfAddinCommands!");d._notifyHost(g,OSF.AgaveHostAction.RefreshAddinCommands,a)},s=function(){OsfMsAjaxFactory.msAjaxDebug.trace("onClickCancelDialog!");d._notifyHost(g,OSF.AgaveHostAction.CancelDialog);if(d._internalConversationId){d._serviceEndPointInternal.unregisterConversation(d._internalConversationId);d._internalConversationId=c}},o=function(f){var b={anonymous:c,clientAppInfoReturnType:OSF.ClientAppInfoReturnType.both,clientEndPoint:c,clientName:c,appVersion:c,clientVersion:c,hostType:c,osfControl:{_omexEntitlement:c},referenceInUse:c},j=e;b.referenceInUse={id:f.assetId,storeType:OSF.StoreType.OMEX,storeLocator:f.storeId};b.clientVersion=d._getClientVersionForOmex();if(b.clientVersion){b.clientName=d._getClientNameForOmex();b.appVersion=d._getAppVersionForOmex()}b.hostType=d._hostType;f.contentMarket=f.storeId;f.assetID=f.assetId;if(_omexDataProvider.AllCached(b,f))try{b.anonymous=e;b.clientEndPoint={};OSF.OsfManifestManager.getOmexKilledAppsAsync(b,i);OSF.OsfManifestManager.getOmexAppStateAsync(b,g);j=a}catch(m){}if(j){var k=function(b){if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded&&b.value){var j=b.context.referenceInUse,i=b.value.entitlements,l=i.length,d,k=a;_omexDataProvider.SetCustomerId(b.value.cid);for(var h=0;h<l;h++){d=i[h];if(d.assetId&&j.id&&d.assetId.toLowerCase()===j.id.toLowerCase()){k=e;break}}var f=b.context;f.osfControl._omexEntitlement={contentMarket:c,hasEntitlement:a,version:c};if(k){f.osfControl._omexEntitlement.contentMarket=d.contentMarket;f.osfControl._omexEntitlement.hasEntitlement=e;f.osfControl._omexEntitlement.version=d.version}OSF.OsfManifestManager.getOmexAppStateAsync(f,g)}},h=function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var b=a.value,c=parseInt(b.status),d=a.context;if(c===OSF.OmexClientAppStatus.OK)!a.cached&&_omexDataProvider.SetManifestAndETokenCache(d,b)}},i=function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value)!a.cached&&_omexDataProvider.SetKilledAppsCache(a.context,a.value)},g=function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var f=a.value,b=a.context;!a.cached&&_omexDataProvider.SetAppStateCache(a.context,f);var c=function(){b.clientEndPoint=d._omexAnonymousWSProxy.clientEndPoint;OSF.OsfManifestManager.getOmexManifestAndETokenAsync(b,h)};if(b.osfControl._omexEntitlement&&!b.osfControl._omexEntitlement.hasEntitlement){b.anonymous=e;d._createOmexProxy(d._omexAnonymousWSProxy,c)}else OSF.OsfManifestManager.getOmexManifestAndETokenAsync(b,h)}},l=function(a){try{b.anonymous=!a.isReady;b.clientEndPoint=b.anonymous?d._omexAnonymousWSProxy.clientEndPoint:d._omexGatedWSProxy.clientEndPoint;!b.anonymous&&OSF.OsfManifestManager.getOmexEntitlementsAsync(b,k);OSF.OsfManifestManager.getOmexKilledAppsAsync(b,i);b.anonymous&&OSF.OsfManifestManager.getOmexAppStateAsync(b,g)}catch(c){}};d.isMyAppsReady(l)}},k=function(e,h){var c={errorCode:OSF.InvokeResultCode.E_OEM_REMOVED_FAILED},b={assetId:e.id,clientVersion:d._getClientVersionForOmex(),clientName:d._getClientNameForOmex(),clientEndPoint:d._omexGatedWSProxy.clientEndPoint},g=d._insertDialogDiv,f=function(f){var l=0;if(f.statusCode===OSF.ProxyCallStatusCode.Succeeded&&f.value&&f.value.removedApps&&f.value.removedApps.length>0){for(var k=f.value.removedApps,j=OSF.InvokeResultCode.E_OEM_REMOVED_FAILED,i=0;i<k.length;i++)if(k[i].assetId==b.assetId){if(k[i].result==OSF.OmexRemoveAppStatus.Success)j=OSF.InvokeResultCode.S_OK;break}_omexDataProvider.RemoveManifestAndEToken(b.assetId);if(j==OSF.InvokeResultCode.S_OK){if(_omexCatalogServiceS2SWrapper){var m=_omexCatalogServiceS2SWrapper.catalogService.createScope({cacheManager:_omexCacheManager,cachePrefix:OfficeExt.CacheConsts.gatedCacheKeyPrefix,cid:_omexCatalogServiceS2SWrapper.catalogService.getCID(),anonymous:a,telemetryContext:new OfficeExt.SimpleTelemetryContext});m.clearEntitlementCache()}l=d.untrustOsfControls(e)}c.errorCode=j}var n=!document.documentElement.contains(g);Telemetry.AppManagementMenuHelper.LogAppManagementMenuAction(b.assetId,OSF.AppManagementAction.Remove,l,n,a,c.errorCode);h(c)};OSF.OsfManifestManager.removeOmexAppAsync(b,Function.createDelegate(d,f))},p=function(b){switch(b.datapointName){case OSF.DataPointNames.AppManagementMenu:OSF.OUtil.validateParamObject(b,{assetId:{type:String,mayBeNull:a},operationMetadata:{type:Number,mayBeNull:a},hrStatus:{type:Number,mayBeNull:a}},c);Telemetry.AppManagementMenuHelper.LogAppManagementMenuAction(b.assetId,b.operationMetadata,0,a,a,b.hrStatus);break;case OSF.DataPointNames.InsertionDialogSession:OSF.OUtil.validateParamObject(b,{assetId:{type:String,mayBeNull:a},totalSessionTime:{type:Number,mayBeNull:a},trustPageSessionTime:{type:Number,mayBeNull:a},appInserted:{type:Boolean,mayBeNull:a},lastActiveTab:{type:Number,mayBeNull:a},lastActiveTabCount:{type:Number,mayBeNull:a}},c);Telemetry.InsertionDialogSessionHelper.LogInsertionDialogSession(b.assetId,b.totalSessionTime,b.trustPageSessionTime,b.appInserted,b.lastActiveTab,b.lastActiveTabCount);break;case OSF.DataPointNames.UploadFileDevCatelog:OSF.OUtil.validateParamObject(b,{operationMetadata:{type:Number,mayBeNull:a},hrStatus:{type:Number,mayBeNull:a}},c);Telemetry.UploadFileDevCatelogHelper.LogUploadFileDevCatelogAction(this._appCorrelationId,b.operationMetadata,0,a,a,b.hrStatus);break;case OSF.DataPointNames.UploadFileDevCatalogUsage:OSF.OUtil.validateParamObject(b,{currentStoreType:{type:String,mayBeNull:a},id:{type:String,mayBeNull:e},appVersion:{type:String,mayBeNull:e},appTargetType:{type:Number,mayBeNull:a},isAppCommand:{type:String,mayBeNull:a},appSizeWidth:{type:Number,mayBeNull:e},appSizeHeight:{type:Number,mayBeNull:e}},c);Telemetry.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,b.currentStoreType,b.Id,b.appVersion,b.appTargetType,b.isAppCommand,b.appSizeWidth,b.appSizeHeight)}};b._serviceEndPoint=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(b._clientId);b._serviceEndPoint._onHandleRequestError=function(g,f){var e,a;if(g&&(e=g._data)){a=typeof e==="object"?e[0]:e;a=typeof a==="string"?a:c;var b;if(a&&(b=d.getOsfControl(a))){if(f==="Failed origin check")b._pageStatus=OSF.OsfControlPageStatus.FailedOriginCheck;else if(f==="Access Denied")b._pageStatus=OSF.OsfControlPageStatus.FailedPermissionCheck;else b._pageStatus=OSF.OsfControlPageStatus.FailedHandleRequest;Telemetry.RuntimeTelemetryHelper.LogExceptionTag(f,c,b.getCorrelationId(),17585056)}}};b._serviceEndPoint.registerMethod("ContextActivationManager_getAppContextAsync",t,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPoint.registerMethod("ContextActivationManager_notifyHost",y,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPoint.registerMethod("ContextActivationManager_openWindowInHost",w,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPointInternal=Microsoft.Office.Common.XdmCommunicationManager.createServiceEndPoint(b._clientId+OSF.Constants.EndPointInternalSuffix);b._serviceEndPointInternal.registerMethod("ContextActivationManager_getEntitlementsForInsertDialog",j,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeSignIn",x,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPointInternal.registerMethod("ContextActivationManager_invokeWindowOpen",v,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInsertOsfControl",r,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickInstallOsfControl",b._onClickInstallOsfControl,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickRefreshAddinCommands",q,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPointInternal.registerMethod("ContextActivationManager_onClickCancelDialog",s,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPointInternal.registerMethod("ContextActivationManager_removeAppForInsertDialog",k,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPointInternal.registerMethod("ContextActivationManager_logTelemetryDataForInsertDialog",p,Microsoft.Office.Common.InvokeType.async,a);b._serviceEndPointInternal.registerMethod("ContextActivationManager_getOmexData",o,Microsoft.Office.Common.InvokeType.async,a);OSF.AppSpecificSetup._setupFacade(b._hostControl,b,b._serviceEndPoint,b._serviceEndPointInternal);b._localeStringLoadingPendingCallbacks=[];if(b._localizedScriptsUrl&&b._localizedScriptsUrl!="null/"){var u=function(){this._ErrorUXHelper=new OSF._ErrorUXHelper(this)};b._loadLocaleString(Function.createDelegate(b,u))}b.queryEntitlementDetails=function(a){j(a,a.callbackFunc)};b._getOmexData=function(a){o(a)};b._removeAppForInsertDialog=function(a){k(a,a.callbackFunc)}};OSF.ContextActivationManager.prototype={insertOsfControl:function(a){var b=true,d=false,f=this;OSF.OUtil.validateParamObject(a,{div:{type:Object,mayBeNull:d},id:{type:String,mayBeNull:d},marketplaceID:{type:String,mayBeNull:d},marketplaceVersion:{type:String,mayBeNull:d},store:{type:String,mayBeNull:d},storeType:{type:String,mayBeNull:d},alternateReference:{type:Object,mayBeNull:b},settings:{type:Object,mayBeNull:b},reason:{type:String,mayBeNull:b},osfControlType:{type:Number,mayBeNull:b},snapshotUrl:{type:String,mayBeNull:b},preactivationCallback:{type:Object,mayBeNull:b},virtualOsfControlActivationCallback:{type:Object,mayBeNull:b},isvirtualOsfControl:{type:Boolean,mayBeNull:b},isDialog:{type:Boolean,mayBeNull:b},hostCustomMessage:{type:String,mayBeNull:b}},null);var e={div:a.div,id:a.id,marketplaceID:a.marketplaceID,marketplaceVersion:a.marketplaceVersion,store:a.store,storeType:a.storeType,alternateReference:a.alternateReference,settings:a.settings,reason:a.reason,osfControlType:a.osfControlType,snapshotUrl:a.snapshotUrl,contextActivationMgr:f,preactivationCallback:a.preactivationCallback,virtualOsfControlActivationCallback:a.virtualOsfControlActivationCallback,isvirtualOsfControl:a.isvirtualOsfControl,isDialog:a.isDialog,hostCustomMessage:a.hostCustomMessage},g=f.getSQMAgaveUsage(e.storeType,e.osfControlType,e.reason,a.marketplaceID),c=new OSF.OsfControl(e);c._sqmDWords[0]=g[0];c._sqmDWords[1]=g[1];c._contextActivationMgr._ErrorUXHelper&&c._contextActivationMgr._ErrorUXHelper.showProgress(c._div,c._id);var h=function(){c.activate()};f._loadLocaleString(Function.createDelegate(f,h));return c},setLocalizedUrl:function(d,e,f){var a=this,b=Function._validateParams(arguments,[{name:"scriptUrl",type:String,mayBeNull:false},{name:"imageUrl",type:String,mayBeNull:false},{name:"styleUrl",type:String,mayBeNull:false}]);if(b)throw b;a._localizedScriptsUrl=d;a._localizedImagesUrl=e;a._localizedStylesUrl=f;if(a._localizedScriptsUrl&&a._localizedScriptsUrl!="null/"){var c=function(){if(!this._ErrorUXHelper)this._ErrorUXHelper=new OSF._ErrorUXHelper(this)};a._loadLocaleString(Function.createDelegate(a,c))}},getOsfControlStatus:function(b){var a=this._cachedOsfControls[b];if(a)return a.getStatus();return OSF.OsfControlStatus.InvalidOsfControl},activateOsfControl:function(c){var b=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:false}]);if(b)throw b;var a=this._cachedOsfControls[c];typeof a!="undefined"&&a.activate()},deActivateOsfControl:function(c){var b=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:false}]);if(b)throw b;var a=this._cachedOsfControls[c];typeof a!="undefined"&&a.deActivate()},purgeOsfControl:function(d,c){var b=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:false},{name:"purgeManifest",type:Boolean,mayBeNull:false}]);if(b)throw b;var a=this._cachedOsfControls[d];typeof a!="undefined"&&a.purge(c)},purgeOsfControlNotifications:function(){for(var a in this._cachedOsfControls)this._ErrorUXHelper.purgeOsfControlNotification(a)},untrustOsfControls:function(a){var c=this,d=0,e=OSF.OUtil.formatString(OSF.Constants.ActivatedCacheKey,a.id.toLowerCase(),a.currentStoreType,a.storeId);c._deleteCachedFlag(e);for(var f in c._cachedOsfControls){var b=c._cachedOsfControls[f];if(b._marketplaceID.toLowerCase()==a.id.toLowerCase()){c._ErrorUXHelper.purgeOsfControlNotification(b._id);b.deActivate();b._showTrustError(a.displayName,a.providerName,a.currentStoreType,Function.createDelegate(b,b.activate));d++}}return d},retryAll:function(d){var b=this;for(var c in b._cachedOsfControls){var a=b._cachedOsfControls[c];if(a._marketplaceID.toLowerCase()==d.toLowerCase())if(a._retryActivate){b._ErrorUXHelper.purgeOsfControlNotification(a._id);b._ErrorUXHelper.removeInfoBarDiv(c,false);a._retryActivate();a._retryActivate=null}}},getOsfControl:function(b){var a=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:false}]);if(a)throw a;return this._cachedOsfControls[b]},getOsfControls:function(){var a=[];for(var b in this._cachedOsfControls)a.push(this._cachedOsfControls[b]);return a},getOsfOmexBaseUrl:function(){return this._osfOmexBaseUrl},getAppName:function(){return this._appName},getClientMode:function(){return this._clientMode},getClientId:function(){return this._clientId},getFormFactor:function(){return this._formFactor},getDocUrl:function(){return this._docUrl},getAppUILocale:function(){return this._appUILocale},getDataLocale:function(){return this._dataLocale},getPageBaseUrl:function(){return this._pageBaseUrl},getLcid:function(){return this._lcid},isExternalMarketplaceAllowed:function(){return this._allowExternalMarketplace},getLocalizedScriptsUrl:function(){return this._localizedScriptsUrl?this._localizedScriptsUrl:""},getLocalizedImagesUrl:function(){return this._localizedImagesUrl?this._localizedImagesUrl:""},getLocalizedStylesUrl:function(){return this._localizedStylesUrl?this._localizedStylesUrl:""},raiseOsfControlStatusChange:function(a){this._controlStatusChanged&&this._controlStatusChanged(a)},registerOsfControl:function(a){var b=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:false}]);if(b)throw b;this._cachedOsfControls[a.getID()]=a},unregisterOsfControl:function(b){var a=Function._validateParams(arguments,[{name:"osfControl",type:Object,mayBeNull:false}]);if(a)throw a;delete this._cachedOsfControls[b.getID()]},setIframeAttributeBag:function(a){this._iframeAttributeBag=a},displayNotification:function(a){var b=true,d=false,e=this;OSF.OUtil.validateParamObject(a,{infoType:{type:Number,mayBeNull:d},id:{type:String,mayBeNull:d},title:{type:String,mayBeNull:d},description:{type:String,mayBeNull:d},url:{type:String,mayBeNull:b},buttonTxt:{type:String,mayBeNull:b},buttonCallback:{type:Function,mayBeNull:b},dismissCallback:{type:Function,mayBeNull:b},"displayDeactive ":{type:Boolean,mayBeNull:b},highPriority:{type:Boolean,mayBeNull:b},detailView:{type:Boolean,mayBeNull:b},reDisplay:{type:Boolean,mayBeNull:b},logAsError:{type:Boolean,mayBeNull:b},errorCode:{type:Number,mayBeNull:b},retryAll:{type:Boolean,mayBeNull:b}},null);if(!a.errorCode)a.errorCode=0;var c=e._cachedOsfControls[a.id];if(c)if(c._isvirtualOsfControl){if(a.highPriority==undefined)a.highPriority=a.infoType===OSF.InfoType.Error?b:d;if(a.highPriority===d)c._notificationParams.push(a);else{c._notificationParams.splice(c._highPriorityCount,0,a);c._highPriorityCount++}if(!c._isvirtualOsfControlCallbackInvoked)if(c._manifest!=null)c.invokeVirtualOsfControlActivationCallback(c._manifest);else c.forceGetVirtualOsfControlManifest()}else{if(a.logAsError){Telemetry.AppLoadTimeHelper.SetErrorResult(c._telemetryContext,a.errorCode);if(e._notifyHostError){var f={errorCode:a.errorCode};e._notifyHostError(a.id,OSF.AgaveHostAction.NotifyHostError,f)}}if(a.displayDeactive)a.detailView=b;a["div"]=c._div;e._ErrorUXHelper.showNotification(a)}},dismissMessages:function(a){this._ErrorUXHelper&&this._ErrorUXHelper.dismissMessages(a)},notifyAgave:function(c,a){var d=Function._validateParams(arguments,[{name:"id",type:String,mayBeNull:false},{name:"actionId",type:Number,mayBeNull:false}]);if(d)throw d;var b=this._cachedOsfControls[c];if(typeof b!="undefined")if(a===OSF.AgaveHostAction.CtrlF6In||a===OSF.AgaveHostAction.TabIn||a===OSF.AgaveHostAction.Select)this._ErrorUXHelper.focusOnNotificationUx(c,a);else if(a===OSF.AgaveHostAction.TabInShift&&b._pageStatus!==OSF.OsfControlPageStatus.Ready)this._ErrorUXHelper.focusOnNotificationUxShiftIn(c,a);else b.notifyAgave(a)},setWSA:function(b){var a=this;a._wsa=b;if(a._wsa){a._wsa.createStreamUnobfuscated(OSF.SQMDataPoints.DATAID_APPSFOROFFICEUSAGE,OSF.BWsaStreamTypes.Static,2,OSF.BWsaConfig.defaultMaxStreamRows);a._wsa.createStreamUnobfuscated(OSF.SQMDataPoints.DATAID_APPSFOROFFICENOTIFICATIONS,OSF.BWsaStreamTypes.Static,4,OSF.BWsaConfig.defaultMaxStreamRows)}},getWSA:function(){return this._wsa},getSQMAgaveUsage:function(h,i,d,e){var a;switch(h.toLowerCase()){case OSF.StoreType.OMEX:a=0;break;case OSF.StoreType.SPCatalog:a=1;break;case OSF.StoreType.FileSystem:a=2;break;case OSF.StoreType.Registry:a=3;break;case OSF.StoreType.Exchange:a=4;break;case OSF.StoreType.SPApp:a=5;break;default:a=15}var b;switch(i){case OSF.OsfControlType.DocumentLevel:b=1;break;case OSF.OsfControlType.ContainerLevel:b=0;break;default:b=2}var c=7;if(d&&d.toLowerCase)switch(d.toLowerCase()){case Microsoft.Office.WebExtension.InitializationReason.Inserted.toLowerCase():c=0;break;case Microsoft.Office.WebExtension.InitializationReason.DocumentOpened.toLowerCase():c=1}var g=e.toLowerCase().indexOf("wa")===0?parseInt(e.substring(2),10):0,f=0;f=c<<8|b<<4|a;return [f,g]},isMyAppsReady:function(e){var b=null,c="omexAuthNStatus: ",d=false,a=this;if(!a._enableMyApps){e({isReady:d});return}if(a._omexGatedWSProxy&&a._omexGatedWSProxy.clientEndPoint){e({isReady:true,clientEndPoint:a._omexGatedWSProxy.clientEndPoint});return}var g=1,i=function(g){if(g.statusCode===OSF.ProxyCallStatusCode.Succeeded&&g.value){var h=parseInt(g.value);if(h==OSF.OmexAuthNStatus.Authenticated)a._omexAuthNStatus=OSF.OmexAuthNStatus.Authenticated;else if(h==OSF.OmexAuthNStatus.Anonymous||h==OSF.OmexAuthNStatus.Unknown){e({isReady:d});Telemetry.RuntimeTelemetryHelper.LogExceptionTag(c+a._omexAuthNStatus+". Auth is anonymous or unknown.",b,a._contextMgrCorrelationId,18661704);return}}else{a._omexAuthNStatus=OSF.OmexAuthNStatus.CheckFailed;Telemetry.RuntimeTelemetryHelper.LogExceptionTag(c+a._omexAuthNStatus+"OMEX_getAuthNStatus is not available or server doesn't respond for some reasons, asyncResult.statusCode: "+g.statusCode,b,a._contextMgrCorrelationId,18661705)}a._createOmexProxy(a._omexGatedWSProxy,f)},h=function(c){if(c&&(a._omexAuthNStatus==OSF.OmexAuthNStatus.NotAttempted||a._omexAuthNStatus==OSF.OmexAuthNStatus.Anonymous))if(a._omexAuthNStatus==OSF.OmexAuthNStatus.NotAttempted){var g={clientEndPoint:b};g.clientEndPoint=c;OSF.OsfManifestManager._invokeProxyMethodAsync(g,"OMEX_getAuthNStatus",i,g)}else a._omexAuthNStatus==OSF.OmexAuthNStatus.Anonymous&&e({isReady:d,clientEndPoint:c});else a._createOmexProxy(a._omexGatedWSProxy,f)},f=function(i){if(i)e({isReady:true,clientEndPoint:i});else if(g<OSF.Constants.AuthenticatedConnectMaxTries){g++;if(a._omexAuthNStatus==OSF.OmexAuthNStatus.CheckFailed){Telemetry.RuntimeTelemetryHelper.LogExceptionTag(c+a._omexAuthNStatus+", try to create gated proxy page for the "+g+" time.",b,a._contextMgrCorrelationId,18661706);setTimeout(function(){a._createOmexProxy(a._omexGatedWSProxy,f)},500)}else a._createOmexProxy(a._omexAnonymousWSProxy,h)}else{e({isReady:d});Telemetry.RuntimeTelemetryHelper.LogExceptionTag(c+a._omexAuthNStatus+" Excessive failed create proxy page.",b,a._contextMgrCorrelationId,18661707)}};a._createOmexProxy(a._omexGatedWSProxy,f)},isMyOrgReady:function(b){var a=this;if(!a._enableMyOrg){b({isReady:false});return}if(a._spBaseUrl&&a._iframeProxies&&a._iframeProxies[a._spBaseUrl]&&a._iframeProxies[a._spBaseUrl].clientEndPoint){b({isReady:true,clientEndPoint:a._iframeProxies[a._spBaseUrl].clientEndPoint});return}var c=function(a){if(a)b({isReady:true,clientEndPoint:a});else b({isReady:false})};a._createSharePointIFrameProxy(a._spBaseUrl,c)},openInputUrlDialog:function(d){var e=document.createElement("p");e.setAttribute("id","title-p");e.textContent="DevCatalog server Url is configured in settings.xml - Enter manifest file name only (AppId.xml):";d.appendChild(e);var a=document.createElement("input");a.setAttribute("type","url");a.setAttribute("id","url-input");a.setAttribute("size","80");d.appendChild(a);var c=this,f=function(d){var a=new OSF.Manifest.Manifest(d,c.getAppUILocale());!OSF.OsfManifestManager.hasManifest(a.getMarketplaceID(),a.getMarketplaceVersion())&&OSF.OsfManifestManager.cacheManifest(a.getMarketplaceID(),a.getMarketplaceVersion(),a);var b={id:a.getMarketplaceID(),targetType:a.getTarget(),appVersion:a.getMarketplaceVersion(),currentStoreType:OSF.StoreType.Registry,storeId:"developer",assetId:a.getMarketplaceID(),assetStoreId:OSF.StoreType.Registry,width:a.getDefaultWidth()||0,height:a.getDefaultHeight()||0,isAddinCommands:a._isAddinCommandsManifest(OSF.getManifestHostType(c._hostType))};Telemetry.UploadFileDevCatalogUsageHelper.LogUploadFileDevCatalogUsageAction(this._appCorrelationId,b.currentStoreType,b.id,b.appVersion,b.targetType,b.isAddinCommands,b.width,b.height);c._notifyHost("0",OSF.AgaveHostAction.InsertAgave,b)},g=function(a){alert("Error when requsting manifest file: "+a)},h=function(){OSF.OUtil.xhrGet(c._devCatalogUrl+"/"+a.value,f,g)},b=document.createElement("input");b.setAttribute("type","button");b.setAttribute("value","Insert");OSF.OUtil.addEventListener(b,"click",h);d.appendChild(b)},launchInsertDialog:function(e,l,g){var b=null,d="100%";e.childNodes.length!=0&&e.removeChild(e.childNodes.item(0));var c;if(this._enableDevCatalog){c=document.createElement("div");c.style.width=d;c.style.height="80%";e.appendChild(c);var h=document.createElement("div");h.style.width=d;h.style.height="20%";e.appendChild(h);this.openInputUrlDialog(h)}else c=e;var a=this;a._insertDialogDiv=c;var f=document.createElement("div");f.style.width=d;f.style.height=d;f.style.backgroundImage="url("+a.getLocalizedImageFilePath("progress.gif")+")";f.style.backgroundRepeat="no-repeat";f.style.backgroundPosition="center";c.appendChild(f);var m={MyApp:"0",MyOrg:"1",Store:"{98143890-AC66-440E-A448-ED8771A02D52}",OneDrive:"9"},i=function(c,d){if(!a._enableMyOrg){d({statusCode:OSF.InvokeResultCode.E_CATALOG_NO_APPS,value:b,context:c});return}OSF.OUtil.validateParamObject(c,{webUrl:{type:String,mayBeNull:false}},d);var e=function(a){if(a.isReady){c.clientEndPoint=a.clientEndPoint;var e={webUrl:c.webUrl};OSF.OsfManifestManager._invokeProxyMethodAsync(c,"OEM_getSPCatalogUrlAsync",d,e)}else d({statusCode:OSF.InvokeResultCode.E_GENERIC_ERROR,value:b,context:c})};a.isMyOrgReady(e)},j=function(n){var s=', "myOneDrive":',r='{ "myOrg":',q=', "myOrg":',i='{ "myApp":',h='"}',p='], "url":"',e=" }",f=document.createElement("iframe");f.setAttribute("id","InsertDialog");f.setAttribute("src","about:blank");f.setAttribute("width",d);f.setAttribute("height",d);f.setAttribute("marginHeight","0");f.setAttribute("marginWidth","0");f.setAttribute("frameBorder","0");f.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin ms-allow-popups allow-popups");typeof Strings!="undefined"&&Strings&&Strings.OsfRuntime&&f.setAttribute("title",Strings.OsfRuntime.L_InsertionDialogTile_TXT);var k=b,o=b,A='{ "IsUploadFileDevCatalogEnabled":'+a._enableUploadFileDevCatalog+e;if(a.isExternalMarketplaceAllowed()){var B=a._enableMyApps?OSF.InvokeResultCode.S_OK.toString():OSF.InvokeResultCode.S_HIDE_PROVIDER.toString();k='{ "provValues":[0,0,0,'+B+p+a._osfOmexBaseUrl+'", "client":"'+a._getClientNameForOmex()+h;o=i+k+e;Telemetry.RuntimeTelemetryHelper.LogCommonMessage("isExternalMarketplaceAllowed is true, myApp tab show firstly.",a._contextMgrCorrelationId,0)}var m=b;if(a._enableMyOrg){a._myOrgCatalogUrl=n.value;var y=n.statusCode;m='{ "provValues":[1,1,0,'+y+p+n.value+h;o=a.isExternalMarketplaceAllowed()?i+k+q+m+e:r+m+e}if(a._enableOneDriveCatalog)if(document.cookie.indexOf("OneDriveCatalog=true")!=-1){var j=b;a._myOneDriveCatalogUrl=n.value;j='{ "provValues":[9,9,0,0], "url":"'+n.value+h;if(a._enableMyOrg)o=a.isExternalMarketplaceAllowed()?i+k+q+m+s+j+e:r+m+',"myOneDrive":'+j+e;else o=a.isExternalMarketplaceAllowed()?i+k+s+j+e:'{"myOneDrive":'+j+e}a._internalConversationId&&a._serviceEndPointInternal.unregisterConversation(a._internalConversationId);var w=a.getClientId()+"_"+a.getDocUrl(),u=OSF.OUtil.getFrameNameAndConversationId(w,f);a._internalConversationId=OSF.OUtil.getFrameNameAndConversationId(w,f);var v=b;if(g!=b)v='{ "navigationMode":'+g.navigationMode+', "navigationModeParameter": "'+g.assetId+'", "category":"'+g.category+h;var t="",z=[u,encodeURIComponent(window.location.href),a._appVersion,OSF.getAppVerCode(a._appName),a.getLcid(),OSF.Constants.FileVersion,encodeURIComponent(o),l,encodeURIComponent(A),encodeURIComponent(v),a._contextMgrCorrelationId];if(a._localizedResourcesUrl)t=a._localizedResourcesUrl+"WefGallery.htm?b="+OSF.Constants.FileVersion;else t=a._pageBaseUrl+a.getLcid()+"/WefGallery.htm?b="+OSF.Constants.FileVersion;var x=OSF.OUtil.addXdmInfoAsHash(t,z.join("|"));a._serviceEndPointInternal.registerConversation(u,x);f.setAttribute("src",x);if(a._insertDialogDiv){c.childNodes.length!=0&&c.removeChild(c.childNodes.item(0));c.appendChild(f)}else{c.insertBefore(f,c.firstChild);a._insertDialogDiv=c}},k={webUrl:a._spBaseUrl};i(k,j);a._preloadOfficeJs()},activateAgavesBlockedBySandboxNotSupport:function(){for(var b in this._cachedOsfControls){var a=this._cachedOsfControls[b];a._status===OSF.OsfControlStatus.NotSandBoxSupported&&a.activate()}},setRequirementsChecker:function(a){this._requirementsChecker=a},getRequirementsChecker:function(){return this._requirementsChecker},appHasNotifications:function(a){if(this._ErrorUXHelper)return this._ErrorUXHelper.appHasNotifications(a);return false},_doesUrlHaveSupportedProtocol:function(b){var a=false;if(b){var c=decodeURIComponent(b),d=c.match(/^https?:\/\/.+$/ig);a=d!=null}return a},_loadLocaleString:function(c){var a=this;if(typeof Strings=="undefined"||!Strings||!Strings.OsfRuntime){a._localeStringLoadingPendingCallbacks.push(c);var b=a._localeStringLoadingPendingCallbacks;if(b.length===1){var e=function(){for(var c=b.length,a=0;a<c;a++){var d=b.shift();d()}};a._loadStringScript(e)}}else{for(var f=a._localeStringLoadingPendingCallbacks.length,d=0;d<f;d++){var g=a._localeStringLoadingPendingCallbacks.shift();g()}c()}},_loadStringScript:function(c){var a=this.getLocalizedScriptsUrl();a+="osfruntime_strings.js";var b=function(){if(typeof Strings=="undefined"||!Strings||!Strings.OsfRuntime){this._localeStringLoadingPendingCallbacks.length=0;throw OSF.OUtil.formatString("The locale, {0}, provided by the host app is not supported.",this.getLcid())}else c()};OSF.OUtil.loadScript(a,Function.createDelegate(this,b))},_getServiceEndPoint:function(){return this._serviceEndPoint},_getOmexEndPointPageUrl:function(b,a){return OSF.OUtil.formatString("{0}/{1}/downloads/{2}.aspx",this._omexEndPointBaseUrl,a,b)},_getManifestAndTargetByConversationId:function(b){for(var c in this._cachedOsfControls){var a=this._cachedOsfControls[c];if(b===a._getConversationId())return {manifest:OSF.OsfManifestManager.getCachedManifest(a.getMarketplaceID(),a.getMarketplaceVersion()),target:a.getOsfControlType()}}return null},_createOmexProxy:function(a,g){var f="load",b=null,h=b,i=function(){if(a.clientEndPoint)a.clientEndPoint.invoke("OMEX_isProxyReady",k,{__timeout__:500});else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error, iframe loaded again after failing OMEX_isProxyReady.",b,b,8209028);OSF.OUtil.set_entropy((new Date).getTime())};if(a.refresh){a.isReady=false;a.refresh=false;if(a.clientEndPoint){Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(a.clientEndPoint._conversationId);a.clientEndPoint=b}if(a.iframe){OSF.OUtil.removeEventListener(a.iframe,f,i);a.iframe.parentNode.removeChild(a.iframe)}}if(a.isReady){!a.clientEndPoint&&Telemetry.RuntimeTelemetryHelper.LogExceptionTag("OmexProxy is ready while clientEndPoint is null.",b,b,17356609);g(a.clientEndPoint)}else if(!a.clientEndPoint){if(!this._doesUrlHaveSupportedProtocol(a.proxyUrl)){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Protocal of proxyUrl is not supported.",b,b,17356610);g(b);return}var d=OSF.OUtil.generateConversationId(),c=document.createElement("iframe");c.setAttribute("id",a.proxyName);c.setAttribute("name",a.proxyName);var e=a.proxyUrl+"?"+d+"&ClientSessionId="+this._contextMgrCorrelationId;e=OSF.OUtil.addXdmInfoAsHash(e,d+"|"+a.proxyName+"|"+window.location.href);e=OSF.OUtil.addSerializerVersionAsHash(e,OSF.SerializerVersion.Browser);c.setAttribute("src",e);c.setAttribute("scrolling","auto");c.setAttribute("border","0");c.setAttribute("width","0");c.setAttribute("height","0");c.setAttribute("style","position: absolute; left: -100px; top:0px;");var k=function(k,l){var e=a.pendingCallbacks.length;if(e==0)return;if(k===0&&l.status){a.isReady=true;a.iframe=c;h=a.clientEndPoint}else{a.clientEndPoint=b;if(Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(d)){Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(d);OSF.OUtil.removeEventListener(c,f,i);c.parentNode.removeChild(c)}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error occured with marketplace proxy.",b,b,8209029);h=b}for(var g=0;g<e;g++){var j=a.pendingCallbacks.shift();j(h)}};try{document.body.appendChild(c);OSF.OUtil.addEventListener(c,f,i);a.clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(d,c.contentWindow,a.proxyUrl);a.pendingCallbacks.push(g)}catch(j){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Error creating client endpoint with proxyUrl=["+a.proxyUrl+"].",j,b,17356612);throw j}}else a.pendingCallbacks.push(g)},_createSharePointIFrameProxy:function(b,h){var c=null,d=this;if(!d._doesUrlHaveSupportedProtocol(b)){h(c);return}var l=b.length;if(b.charAt(l-1)==="/")b=b.substr(0,l-1);var i=d._iframeProxies[b];if(!i){var e=OSF.OUtil.generateConversationId(),a=document.createElement("iframe");d._iframeProxyCount=d._iframeProxyCount+1;var j=d._iframeNamePrefix+d._iframeProxyCount;a.setAttribute("id",j);a.setAttribute("name",j);var f=b+"/_layouts/15/OfficeExtensionManager.aspx?"+e;f=OSF.OUtil.addXdmInfoAsHash(f,e+"|"+j+"|"+window.location.href);f=OSF.OUtil.addSerializerVersionAsHash(f,OSF.SerializerVersion.Browser);a.setAttribute("scrolling","auto");a.setAttribute("border","0");a.setAttribute("width","0");a.setAttribute("height","0");a.setAttribute("style","position: absolute; left: -100px; top:0px;");var g=d,m=function(l,m){var f,d=g._iframeProxies[b];if(d&&l===0&&m.status){d.isReady=true;f=d.clientEndPoint}else{delete g._iframeProxies[b];if(Microsoft.Office.Common.XdmCommunicationManager.getClientEndPoint(e)){Microsoft.Office.Common.XdmCommunicationManager.deleteClientEndPoint(e);OSF.OUtil.removeEventListener(a,"load",k);a.parentNode.removeChild(a)}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Unexpected error occured with SharePoint proxy.",c,c,8209030);f=c}if(d)for(var i=d.pendingCallbacks.length,h=0;h<i;h++){var j=d.pendingCallbacks.shift();j(f)}},k=function(){if(g._iframeProxies[b]){g._iframeProxies[b].clientEndPoint=Microsoft.Office.Common.XdmCommunicationManager.connect(e,a.contentWindow,b);g._iframeProxies[b].clientEndPoint.invoke("OEM_isProxyReady",m,{__timeout__:2e3})}};document.body.appendChild(a);OSF.OUtil.addEventListener(a,"load",k);a.setAttribute("src",f);d._iframeProxies[b]={clientEndPoint:c,isReady:false,pendingCallbacks:[h]}}else if(i.isReady)h(i.clientEndPoint);else i.pendingCallbacks.push(h)},_getClientVersionForOmex:function(){if(!this._appVersion)return undefined;var b=this._appVersion.split("."),c=parseInt(b[0],10),d=parseInt(b[1],10)||0;if(c<=15&&d<=0)return undefined;var a=OSF.Constants.FileVersion.split(".");return c+"."+d+"."+a[2]+"."+a[3]},_getClientNameForOmex:function(){return OSF.OmexClientNames[this._appName]},_getAppVersionForOmex:function(){return OSF.OmexAppVersions[this._appName]},_setCachedFlag:function(b){var a=OSF.OUtil.getLocalStorage();a&&a.setItem(b,"true")},_getCachedFlag:function(c){var a=OSF.OUtil.getLocalStorage();if(a){var b=a.getItem(c);return b?true:false}},_deleteCachedFlag:function(b){var a=OSF.OUtil.getLocalStorage();a&&a.removeItem(b)},_preloadOfficeJs:function(){var b=this;if(b._hasPreloadedOfficeJs)return;var a=document.createElement("script");a.src=OSF.OUtil.formatString("{0}?locale={1}&host={2}&version={3}",OSF.Constants.PreloadOfficeJsUrl,b._appUILocale,b._appName,b._hostSpecificFileVersion);a.type="text/javascript";a.id=OSF.Constants.PreloadOfficeJsId;a.onerror=function(){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Failed to connect to preload service.",null,null,8757954)};document.getElementsByTagName("head")[0].appendChild(a);b._hasPreloadedOfficeJs=true},isAddinCommandsAsync:function(b,d){var c=null,a=false;OSF.OUtil.validateParamObject(b,{marketplaceId:{type:String,mayBeNull:a},marketplaceVersion:{type:String,mayBeNull:a},storeType:{type:String,mayBeNull:a},storeId:{type:String,mayBeNull:a},targetData:{type:Object,mayBeNull:a}},c);var e=b.storeType.toLowerCase(),g,f={contextActivationMgr:c,referenceInUse:c};try{f.referenceInUse={id:b.marketplaceId,version:b.marketplaceVersion,storeType:b.storeType,storeLocator:b.storeId};f.contextActivationMgr=this;if(OSF.StoreType.OMEX===e||OSF.StoreType.UploadFileDevCatalog===e||OSF.StoreType.SPCatalog===e){var i=function(e){if(e!=c&&e.statusCode==OSF.ProxyCallStatusCode.Succeeded&&e.value!=c)d(true,e.value._isAddinCommandsManifest(OSF.getManifestHostType(f.contextActivationMgr._hostType)),b);else d(a,a,b)};g=OfficeExt.AddinDataProviderFactory.createAddinDataProvider(e,this);if(g!=c)g.getManifestAsync(f,i);else d(a,a,b)}else d(true,a,b)}catch(h){Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Error for checking is addincommands or not",h,c,17425604);d(a,a,b)}},getManifestInvaildErrorString:function(){return Strings.OsfRuntime.L_AddinCommands_AddinNotSupported_Message},getUserNameHashCode:function(){return this._userNameHashCode}};OSF.OsfManifestManager=function(){var l="undefined",e="marketplaceVersion",d="marketplaceID",k="cacheExpired",j="OMEX_removeCacheAsync",i="OMEX_removeAppAsync",h="OMEX_getEntitlementSummaryAsync",b=null,c=true,a=false,f={},m="en-us",n={};function g(b,a){return b+"_"+a}return {getManifestAsync:function(d,h){OSF.OUtil.validateParamObject(d,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a}},h);var e=d.referenceInUse,k=g(e.id,e.version),i=f[k];d.manifestCached=a;if(i){d.manifestCached=c;h({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:i,context:d})}else if(d.clientEndPoint&&d.manifestUrl){Telemetry.AppLoadTimeHelper.ManifestRequestStart(d.osfControl._telemetryContext);var j=function(a){if(a.statusCode===OSF.ProxyCallStatusCode.Succeeded&&a.value){var d;try{d=a.context.osfControl;var f;if(typeof a.value==="string"){a.context.manifestCached=c;f=a.value}else{a.context.manifestCached=a.value.cached;f=a.value.manifest}Telemetry.AppLoadTimeHelper.SetManifestDataCachedFlag(d._telemetryContext,a.value.cached);a.value=new OSF.Manifest.Manifest(f,d._contextActivationMgr.getAppUILocale());OSF.OsfManifestManager.cacheManifest(e.id,e.version,a.value)}catch(g){a.value=b;var i;if(d)i=d._appCorrelationId;OsfMsAjaxFactory.msAjaxDebug.trace("Invalid manifest in getManifestAsync: "+g);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("Invalid manifest in getManifestAsync.",g,i,8209031)}}else Telemetry.RuntimeTelemetryHelper.LogExceptionTag("getManifestAsync failed:"+OfficeExt.WACUtils.serializeObjectToString(a),b,b,17585057);h(a)},l={manifestUrl:d.manifestUrl,id:e.id,version:e.version,clearCache:d.clearCache||a};this._invokeProxyMethodAsync(d,"OEM_getManifestAsync",j,l)}else h({statusCode:OSF.ProxyCallStatusCode.Failed,value:b,context:d})},getAppInstanceInfoByIdAsync:function(b,c){OSF.OUtil.validateParamObject(b,{webUrl:{type:String,mayBeNull:a},appInstanceId:{type:String,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a}},c);var d={webUrl:b.webUrl,appInstanceId:b.appInstanceId,clearCache:b.clearCache||a};this._invokeProxyMethodAsync(b,"OEM_getSPAppInstanceInfoByIdAsync",c,d)},getSPTokenByProductIdAsync:function(c,d){OSF.OUtil.validateParamObject(c,{appWebUrl:{type:String,mayBeNull:a},productId:{type:String,mayBeNull:a}},d);var f=this,e=function(e){if(e){var g={webUrl:c.appWebUrl,productId:c.productId,clearCache:c.clearCache||a,clientEndPoint:e};f._invokeProxyMethodAsync(c,"OEM_getSPTokenByProductIdAsync",d,g)}else d({statusCode:OSF.ProxyCallStatusCode.ProxyNotReady,value:b,context:c})};c.osfControl._contextActivationMgr._createSharePointIFrameProxy(c.appWebUrl,e)},getSPAppEntitlementsAsync:function(e,g){var d="/";OSF.OUtil.validateParamObject(e,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},baseUrl:{type:String,mayBeNull:a},pageUrl:{type:String,mayBeNull:a},webUrl:{type:String,mayBeNull:c}},g);if(!e.webUrl){var h=document.createElement("a");h.href=e.pageUrl;var o=h.pathname,m=o.split(d),r=m.length-1,f=h.href.substring(0,h.href.length-o.length);if(f&&f.charAt(f.length-1)!==d)f+=d;for(var j=[f],k=0;k<r;k++)if(m[k]){f=f+m[k]+d;j.push(f)}h=b;var p=this,l=e.osfControl._contextActivationMgr,i=j.pop(),q=function(b){if(b.statusCode===OSF.ProxyCallStatusCode.Succeeded){var a=b.value;if(a&&a.charAt(a.length-1)!==d)a+=d;l._webUrl=a;b.context.webUrl=a;b.context.appWebUrl=a;p.getCorporateCatalogEntitlementsAsync(b.context,g)}else g(b)},n=function(c){if(c){e.clientEndPoint=c;var d={pageUrl:e.pageUrl,baseUrl:i,clearCache:e.clearCache||a};p._invokeProxyMethodAsync(e,"OEM_getSPAppWebUrlFromPageUrlAsync",q,d)}else if(j.length>0){i=j.pop();l._createSharePointIFrameProxy(i,n)}else g({statusCode:OSF.ProxyCallStatusCode.Failed,value:b,context:e})};l._createSharePointIFrameProxy(i,n)}else this.getCorporateCatalogEntitlementsAsync(e,g)},getOneDriveEntitlementsAsync:function(e,o){var c="Content-Type",p=e.referenceInUse.storeLocator,m=e.referenceInUse.storeLocator+"/root:/Manifests",d=OSF.OneDriveOAuth.getAccessTokenFromCookie();if(d==""||d==undefined);var h="?access_token="+d,k=m+h,b=new XMLHttpRequest,a=new XMLHttpRequest;b.onreadystatechange=function(){if(b.readyState==4)if(b.status==200){var g=JSON.parse(b.response),f=g.id,d=e.referenceInUse.storeLocator+"/items/"+f+"/children"+h;a.open("GET",d);a.setRequestHeader(c,"json");a.send()}};var i=[],j=0,g=0,f=function(){j==g&&o({statusCode:OSF.ProxyCallStatusCode.Succeeded,value:{entitlements:i},context:e})},l=function(e,d){g++;var c=d;try{var b=new OSF.Manifest.Manifest(e.responseText),a=[];a.push(b.getDefaultDisplayName());a.push(c);a.push(b.getDefaultDescription());a.push(b.getTarget());a.push(b.getMarketplaceVersion());a.push(c);a.push(OSF.StoreType.OneDrive);a.push(b.getDefaultWidth()||0);a.push(b.getDefaultHeight()||0);a.push(b.getDefaultIconUrl());a.push(b.getProviderName());a.push(b.getDefaultLocale());a.push(OSF.StoreType.OneDrive);i.push(a)}catch(h){}f()},n=function(){g++;f()};a.onreadystatechange=function(){if(a.readyState==4&&a.status==200){for(var c=JSON.parse(a.responseText),b=0;b<c.value.length;b++)if(c.value[b].name.substr(c.value[b].name.length-4).toLowerCase()==".xml"){var e=p+"/root:/Manifests/"+c.value[b].name+":/content?access_token="+d;OSF.OUtil.xhrGetFull(e,c.value[b].name,l,n);j++}f()}};b.open("GET",k);b.setRequestHeader(c,"json");b.send()},getCorporateCatalogEntitlementsAsync:function(d,e){OSF.OUtil.validateParamObject(d,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},webUrl:{type:String,mayBeNull:a}},e);Telemetry.AppLoadTimeHelper.AuthenticationStart(d.osfControl._telemetryContext);var h=this,g=0,f=function(i){if(i){Telemetry.AppLoadTimeHelper.AuthenticationEnd(d.osfControl._telemetryContext);d.clientEndPoint=i;var j={webUrl:d.webUrl,applicationName:OSF.HostCapability[d.hostType],officeExtentionTarget:d.noTargetType||d.osfControl.getOsfControlType()===OSF.OsfControlTarget.TaskPane?b:d.osfControl.getOsfControlType(),clearCache:d.clearCache||a,supportedManifestVersions:{"1.0":c,"1.1":c}};h._invokeProxyMethodAsync(d,"OEM_getEntitlementSummaryAsync",e,j)}else if(g<OSF.Constants.AuthenticatedConnectMaxTries){g++;setTimeout(function(){d.osfControl._contextActivationMgr._createSharePointIFrameProxy(d.webUrl,f)},500)}else e({statusCode:OSF.ProxyCallStatusCode.ProxyNotReady,value:b,context:d})};d.osfControl._contextActivationMgr._createSharePointIFrameProxy(d.webUrl,f)},_invokeProxyMethodAsync:function(c,g,s,d){if(c.useS2S){d.officeVersion=OSF.Constants.ThreePartsFileVersion;var f=c.clientEndPoint,e=function(d){var e=OSF.ProxyCallStatusCode.Succeeded;if(d.status!=OfficeExt.DataServiceResultCode.Succeeded){e=OSF.ProxyCallStatusCode.Failed;var a;if(c&&c.osfControl)a=c.osfControl._appCorrelationId;Telemetry.RuntimeTelemetryHelper.LogExceptionTag("s2s _invokeProxyMethodAsync failed, method name: "+g,b,a,18416272)}s({statusCode:e,value:d.value,context:c})};switch(g){case h:f.getEntitlementAsync(a,e,c.clearEntitlement||a);break;case "OMEX_getKilledAppsAsync":f.getKilledApps(e);break;case "OMEX_getAppStateAsync":f.getAppState(c.addInEntitlement,e);break;case "OMEX_getManifestAndETokenAsync":if(!c.anonymous){var v=d?d.assetContentMarket:c.addInEntitlement.storeId;c.addInEntitlement.appVersion=d.expectedVersion||"";f.getETokenAndManifest(c.addInEntitlement,v,e)}else f.getManifest(c.addInEntitlement,d.contentMarket,function(a){e({status:a.status,value:{status:a.value.status2,etoken:"",manifest:a.value.manifest}})});break;case "OMEX_getAppDetailsAsync":f.getAppDetails(d.assetID,d.contentMarket,e)}}else{var w=d.clientEndPoint?d.clientEndPoint._targetUrl:c.clientEndPoint._targetUrl,q=[w,g],l;for(var t in d){l=typeof d[t];(l==="string"||l==="number"||l==="boolean")&&q.push(d[t])}var m=q.join("."),k=n,p={onCompleted:s,context:c,methodName:g},o=k[m];if(!o){k[m]=[p];var u=function(l,c){var h=b,g=OSF.ProxyCallStatusCode.Failed;if(l===0&&c.status){h=c.result;g=OSF.ProxyCallStatusCode.Succeeded}var f=k[m];delete k[m];for(var j=f.length,i=0;i<j;i++){var a=f.shift(),d;try{if(a.context&&a.context.osfControl)d=a.context.osfControl._appCorrelationId;c&&c.failureInfo&&Telemetry.RuntimeTelemetryHelper.LogProxyFailure(d,a.methodName,c.failureInfo);a.onCompleted({statusCode:g,value:h,context:a.context})}catch(e){OsfMsAjaxFactory.msAjaxDebug.trace("_invokeProxyMethodAsync failed: "+e);Telemetry.RuntimeTelemetryHelper.LogExceptionTag("_invokeProxyMethodAsync failed.",e,d,8209032)}}},r=c.clientEndPoint;if(d.clientEndPoint){r=d.clientEndPoint;delete d.clientEndPoint}if(c.referenceInUse&&c.referenceInUse.storeType===OSF.StoreType.OMEX)d.officeVersion=OSF.Constants.ThreePartsFileVersion;r.invoke(g,u,d)}else o.push(p)}},getOmexEntitlementsAsync:function(b,c){OSF.OUtil.validateParamObject(b,{referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a},anonymous:{type:Boolean,mayBeNull:a}},c);var d={applicationName:b.hostType,appVersion:b.appVersion,build:OSF.Constants.FileVersion,clearEntitlement:b.clearCache||b.clearEntitlement||a,clientName:b.clientName,clientVersion:b.clientVersion,correlationId:b.correlationId};this._invokeProxyMethodAsync(b,h,c,d)},getOmexAppDetailsAsync:function(b,d){OSF.OUtil.validateParamObject(b,{assetId:{type:String,mayBeNull:a},contentMarket:{type:String,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:c},anonymous:{type:Boolean,mayBeNull:a},clientName:{type:String,mayBeNull:a},clientVersion:{type:String,mayBeNull:a}},d);var e={assetid:"",assetID:b.assetId,contentMarket:b.contentMarket,build:OSF.Constants.FileVersion,clearCache:b.clearCache||b.clearEntitlement||a,clientName:b.clientName,clientVersion:b.clientVersion,correlationId:b.correlationId};b.manifestManager=this;_omexDataProvider.GetAppDetails(b,e,d)},getOmexKilledAppsAsync:function(b,c){OSF.OUtil.validateParamObject(b,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a},anonymous:{type:Boolean,mayBeNull:a}},c);var d={clearKilledApps:b.clearCache||b.clearKilledApps||a,clientName:b.clientName,clientVersion:b.clientVersion,correlationId:b.correlationId};b.manifestManager=this;_omexDataProvider.GetKilledApps(b,d,c)},getOmexAppStateAsync:function(b,d){OSF.OUtil.validateParamObject(b,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a},anonymous:{type:Boolean,mayBeNull:c}},d);var e=b.referenceInUse,f={assetID:e.id,contentMarket:e.storeLocator,clearAppState:b.clearCache||b.clearAppState||a,clientName:b.clientName,errors:{},clientVersion:b.clientVersion,correlationId:b.correlationId};b.manifestManager=this;_omexDataProvider.GetAppState(b,f,d);b.osfControl._telemetryContext&&Telemetry.AppLoadTimeHelper.SetAppStateDataInvalidFlag(b.osfControl._telemetryContext,f.errors[k])},getOmexManifestAndETokenAsync:function(b,e){OSF.OUtil.validateParamObject(b,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a},anonymous:{type:Boolean,mayBeNull:a}},e);var d=b.referenceInUse,c={applicationName:b.hostType,assetID:d.id,build:OSF.Constants.FileVersion,clientName:b.clientName,clientVersion:b.clientVersion,clientAppInfoReturnType:b.clientAppInfoReturnType,errors:{},correlationId:b.correlationId};if(b.anonymous){c.contentMarket=d.storeLocator;c.clearManifest=b.clearCache||b.clearManifest||a}else{c.assetContentMarket=b.osfControl._omexEntitlement.contentMarket;c.userContentMarket=d.storeLocator;c.clearToken=b.clearCache||b.clearToken||a;c.clearManifest=b.clearCache||b.clearManifest||a;if(b.acceptedUpgrade)c.expectedVersion=b.expectedVersion;else if(b.osfControl._omexEntitlement.hasEntitlement)c.expectedVersion=b.osfControl._omexEntitlement.version}b.manifestManager=this;_omexDataProvider.GetManifestAndEToken(b,c,e);b.osfControl._telemetryContext&&Telemetry.AppLoadTimeHelper.SetManifestDataInvalidFlag(b.osfControl._telemetryContext,c.errors[k])},removeOmexAppAsync:function(b,c){OSF.OUtil.validateParamObject(b,{assetId:{type:String,mayBeNull:a},clientName:{type:String,mayBeNull:a},clientVersion:{type:String,mayBeNull:a}},c);var d={assetID:b.assetId,clientName:b.clientName,clientVersion:b.clientVersion,correlationId:b.correlationId};this._invokeProxyMethodAsync(b,i,c,d)},removeOmexCacheAsync:function(b,e){OSF.OUtil.validateParamObject(b,{osfControl:{type:Object,mayBeNull:a},referenceInUse:{type:Object,mayBeNull:a},clientEndPoint:{type:Object,mayBeNull:a}},e);var d=b.referenceInUse,c={applicationName:b.hostType,assetID:d.id,officeExtentionTarget:b.osfControl.getOsfControlType(),clearEntitlement:b.clearEntitlement||a,clearToken:b.clearToken||a,clearAppState:b.clearAppState||a,clearManifest:b.clearManifest||a,appVersion:b.appVersion};if(b.anonymous)c.contentMarket=d.storeLocator;else{c.assetContentMarket=b.osfControl._omexEntitlement.contentMarket;c.userContentMarket=d.storeLocator}this._invokeProxyMethodAsync(b,j,e,c)},purgeManifest:function(i,h){var c=Function._validateParams(arguments,[{name:d,type:String,mayBeNull:a},{name:e,type:String,mayBeNull:a}]);if(c)throw c;var b=g(i,h);if(typeof f[b]!=l)delete f[b]},cacheManifest:function(i,h,b){var c=Function._validateParams(arguments,[{name:d,type:String,mayBeNull:a},{name:e,type:String,mayBeNull:a},{name:"manifest",type:Object,mayBeNull:a}]);if(c)throw c;var j=g(i,h);b._UILocale=m;f[j]=b},hasManifest:function(i,h){var b=Function._validateParams(arguments,[{name:d,type:String,mayBeNull:a},{name:e,type:String,mayBeNull:a}]);if(b)throw b;var j=g(i,h);if(typeof f[j]!=l)return c;return a},getCachedManifest:function(h,c){var b=Function._validateParams(arguments,[{name:d,type:String,mayBeNull:a},{name:e,type:String,mayBeNull:a}]);if(b)throw b;var i=g(h,c);return f[i]},versionLessThan:function(j,k){for(var e=j.split("."),d=k.split("."),g=Math.min(e.length,d.length),f,c,b=0;b<g;b++)try{f=parseFloat(e[b]);c=parseFloat(d[b]);if(f!=c)return f<c}catch(i){}if(e.length>=d.length)return a;else{g=d.length;var h=0;for(b=e.length;b<g;b++){try{c=parseFloat(d[b])}catch(i){c=0}h+=c}return h>0}},_setUILocale:function(a){m=a}}}();OSF.InfoType={Error:0,Warning:1,Information:2,SecurityInfo:3};OSF._ErrorUXHelper=function(J){var r="progress_",y="input,a,button",i=true,f=false,h="100%",q="center",p="no-repeat",o="alpha(opacity=100)",n="url(",g="onclick",k="tabindex",j="type",d="id",m="moe-background",a="class",e="div",x="notificationbackground_",w="moe-infobar-body_",u="agavedefaulticon96x96.png",l="moe_status_icons.png",E="progress.gif",t="img",c=J;OSF.OUtil.loadCSS(c.getLocalizedCSSFilePath("moeerrorux.css"));var O=document.createElement(t);O.src=c.getLocalizedImageFilePath(E);var M=document.createElement(t);M.src=c.getLocalizedImageFilePath(l);var L=document.createElement(t);L.src=c.getLocalizedImageFilePath(u);var b={},B=0,z=function(a){var d=a.childNodes.length,c=0,b;while(c<d){b=a.childNodes.item(c);if(b.tagName.toLowerCase()==="iframe")c++;else{a.removeChild(b);d--}}},C=function(b){var a=document.getElementById(b);a&&a.parentNode.removeChild(a)},P=function(a){OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveStage1Start);C("icon_"+a);OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveStage1End)},D=function(a,e){OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveStage2Start);var c;if(e)c=w+a;else c=x+a;var d=b[a]&&b[a].length>0;if(d&&b[a][0].highPriority)B--;C(c);d&&b[a].shift();OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveStage2End)},H=function(b){OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderStage1Start);z(b.div);var f=document.createElement(e);f.setAttribute(a,m);f.setAttribute(d,"icon_"+b.id);var i=document.createElement("input");i.setAttribute(d,"iconImg_"+b.id);i.setAttribute(j,"image");i.setAttribute(k,"0");i.src=c.getLocalizedImageFilePath(l);var w=function(a){a.sqmDWords[1]|=2;s(a.id);G(a)};i.setAttribute(g,"getIntoStage2(params)");OSF.OUtil.attachClickHandler(i,function(){w(b)});f.appendChild(i);if(b.displayDeactive){f.style.backgroundImage=n+c.getLocalizedImageFilePath(u)+")";f.style.backgroundColor="white";f.style.opacity="1";f.style.filter=o;f.style.backgroundRepeat=p;f.style.backgroundPosition=q;f.style.height=h}var r,v,t;if(b.infoType===OSF.InfoType.Error){r="moe-status-error-icon";v="iconImg_error_"+b.id;t=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT}else if(b.infoType===OSF.InfoType.Warning){r="moe-status-warning-icon";v="iconImg_warning_"+b.id;t=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT}else if(b.infoType===OSF.InfoType.Information){r="moe-status-info-icon";v="iconImg_info_"+b.id;t=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT}else{r="moe-status-secinfo-icon";v="iconImg_secinfo_"+b.id;t=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT}var x=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(x.exec(navigator.userAgent)!=null&&parseFloat(RegExp.$1)==9)r+="_ie";i.setAttribute(a,r);i.setAttribute(d,v);i.setAttribute("alt",t);if(b.div.childNodes.length!=0)b.div.insertBefore(f,b.div.childNodes[0]);else b.div.appendChild(f);A(b.id,OSF.AgaveHostAction.TabIn);OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderStage1End)},G=function(r){var O="moe-infobar-button",H="button",N="presentation";OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderStage2Start);z(r.div);var bb=r.description;if(r.title.length>100)r.title=r.title.substring(0,99);if(r.description.length>255)r.description=r.description.substring(0,254);var X=w+r.id,I=document.getElementById(X);if(I==undefined){I=document.createElement(e);I.setAttribute(a,"moe-infobar-body");I.setAttribute(d,X)}var S=document.createElement(e);S.innerHTML=bb;I.setAttribute("title",S.textContent);S=null;var L=document.createElement("table");L.setAttribute(a,"moe-infobar-infotable");L.setAttribute("role",N);for(var Y,U=0;U<3;U++){Y=L.insertRow(U);Y.setAttribute("role",N)}var y=L.rows;y[0].insertCell(0);y[0].insertCell(1);y[0].insertCell(2);y[0].cells[1].setAttribute("rowSpan","2");y[1].insertCell(0);y[1].insertCell(1);y[2].insertCell(0);y[2].insertCell(1);y[2].insertCell(2);y[0].cells[0].setAttribute(a,"moe-infobar-top-left-cell");y[0].cells[1].setAttribute(a,"moe-infobar-message-cell");y[0].cells[2].setAttribute(a,"moe-infobar-top-right-cell");y[2].cells[1].setAttribute(a,"moe-infobar-button-cell");var P=document.createElement(t);P.src=c.getLocalizedImageFilePath(l);var K,M;if(r.infoType===OSF.InfoType.Error){K="moe-infobar-error";M=Strings.OsfRuntime.L_InfobarIconErrorAccessibleName_TXT}else if(r.infoType===OSF.InfoType.Warning){K="moe-infobar-warning";M=Strings.OsfRuntime.L_InfobarIconWarningAccessibleName_TXT}else if(r.infoType===OSF.InfoType.Information){K="moe-infobar-info";M=Strings.OsfRuntime.L_InfobarIconInfoAccessibleName_TXT}else{K="moe-infobar-secinfo";M=Strings.OsfRuntime.L_InfobarIconSecInfoAccessibleName_TXT}P.setAttribute(a,K);P.setAttribute("alt",M);y[0].cells[0].appendChild(P);var Q=document.createElement(e);Q.setAttribute(a,"moe-infobar-message-div");var T=document.createElement("span");T.setAttribute(a,"moe-infobar-title");T.innerHTML=r.title;var V="moe-infobar-message_"+r.id,J=document.getElementById(V);if(J==undefined){J=document.createElement("span");J.setAttribute(a,"moe-infobar-message");J.setAttribute(d,V)}J.innerHTML=r.description;Q.appendChild(T);Q.appendChild(J);y[0].cells[1].appendChild(Q);var R=function(a){var b=c.getOsfControl(a.id);Telemetry.AppNotificationHelper.LogNotification(b._appCorrelationId,a.sqmDWords[0],a.sqmDWords[1])},W=function(){r.sqmDWords[1]|=8;R(r);!r.reDisplay&&D(r.id,r.displayDeactive);s(r.id);if(r.reDisplay)v(r);else if(b[r.id].length>0){var a=b[r.id][0];v(a)}else F(r.id);r.dismissCallback&&r.dismissCallback()},E=document.createElement("input");E.setAttribute(j,"image");E.setAttribute("src",c.getLocalizedImageFilePath(l));E.setAttribute(a,"moe-infobar-dismiss");E.setAttribute(d,"moe-infobar-dismiss_"+r.id);E.setAttribute(k,"0");E.setAttribute("alt",Strings.OsfRuntime.L_InfobarIconCloseButtonAccessibleName_TXT);E.setAttribute(g,"handleDismiss();");OSF.OUtil.attachClickHandler(E,W);y[0].cells[2].appendChild(E);r.detailView=f;var C=document.createElement(H);C.setAttribute(a,O);C.innerHTML=r.buttonTxt;C.setAttribute(d,"moe-infobar-button_"+r.id);C.setAttribute(k,"0");C.setAttribute(j,H);if(r.buttonCallback){var ab=function(){r.sqmDWords[1]|=4;R(r);D(r.id,f);s(r.id);if(b[r.id].length>0){var d=b[r.id][0];v(d)}else F(r.id);if(r.retryAll===i){var a=c.getOsfControl(r.id);a._retryActivate=null;c.retryAll(a._marketplaceID)}r.buttonCallback()};C.setAttribute(g,"handleButtonClick()");OSF.OUtil.attachClickHandler(C,ab)}else{C.setAttribute(g,"handleDismiss()");OSF.OUtil.attachClickHandler(C,W)}y[2].cells[1].appendChild(C);if(r.url){var Z=function(){r.sqmDWords[1]|=4;R(r);r.sqmDWords[1]=1;window.open(r.url)},G=document.createElement(H);G.setAttribute(a,O);G.innerHTML=r.urlButtonTxt?r.urlButtonTxt:Strings.OsfRuntime.L_MoreInfoButton_TXT;G.setAttribute(d,"moe-infobar-button2_"+r.id);G.setAttribute(g,"moreInfoButtonClick()");OSF.OUtil.attachClickHandler(G,Z);G.setAttribute(k,"0");G.setAttribute(j,H);y[2].cells[1].appendChild(G)}I.appendChild(L);var B=document.createElement(e);B.setAttribute(a,m);B.setAttribute(d,x+r.id);if(r.displayDeactive){B.style.backgroundImage=n+c.getLocalizedImageFilePath(u)+")";B.style.backgroundColor="white";B.style.opacity="1";B.style.filter=o;B.style.backgroundRepeat=p;B.style.backgroundPosition=q;B.style.height=h}B.appendChild(I);if(r.div.childNodes.length!=0)r.div.insertBefore(B,r.div.childNodes[0]);else r.div.appendChild(B);A(r.id,OSF.AgaveHostAction.TabIn);OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderStage2End)},s=function(b){var a=c.getOsfControl(b);if(a)a._controlFocus=i},F=function(d){var a=c.getOsfControl(d);if(!a)return;if(b[d]&&b[d].length>0)return;if(a.getStatus()===OSF.OsfControlStatus.Activated&&a.getPageStatus()===OSF.OsfControlPageStatus.Ready)a.notifyAgave(OSF.AgaveHostAction.TabIn);else{var f="_trySetFocusInAppContent$newCallback";if(a._notifyHostIFrameOnLoaded&&a._notifyHostIFrameOnLoaded.newCallbackIdentity&&a._notifyHostIFrameOnLoaded.newCallbackIdentity===f)return;var e=function(b){return function(){if(b)try{b()}catch(c){}a.getStatus()===OSF.OsfControlStatus.Activated&&a.getPageStatus()===OSF.OsfControlPageStatus.Ready&&a.notifyAgave(OSF.AgaveHostAction.TabIn);a._notifyHostIFrameOnLoaded=b}}(a._notifyHostIFrameOnLoaded);e["newCallbackIdentity"]=f;a._notifyHostIFrameOnLoaded=e}},A=function(d,h){var f=c.getOsfControl(d);if(f)if(f._controlFocus)if(b[d]&&b[d].length>0){var g=b[d][0];if(g&&g.div){var a=g.div.querySelectorAll(y);if(a&&a.length>0){var e;if(a.length===1)e=a[0];else e=a[1];if(e instanceof HTMLElement){window.focus();e.focus();c._notifyHost&&c._notifyHost(d,OSF.AgaveHostAction.SelectWithError)}}}}else f.notifyAgave(h)},I=function(a,i){var d=c.getOsfControl(a);if(d)if(d._controlFocus)if(b[a]&&b[a].length>0){var e=b[a][0];if(e&&e.div){var g=e.div.querySelectorAll(y);if(g&&g.length>0){var h=g[0];if(h instanceof HTMLElement){window.focus();h.focus();c._notifyHost&&c._notifyHost(a,OSF.AgaveHostAction.SelectWithError)}}}}else{d._controlFocus=f;c._notifyHost(a,i)}},v=function(a){if(a.detailView==undefined||a.detailView===f){a.sqmDWords[1]=0;H(a)}else{a.sqmDWords[1]=1;G(a)}},N=function(a){if(b[a]){if(b[a].length>0){var c=b[a][0].div;z(c)}delete b[a]}},K=function(c){var a=document.createElement(e),b=document.createTextNode(c);a.appendChild(b);return a.innerHTML};return {showProgress:function(k,i){try{OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderLoadingAnimationStart);var j=document.getElementById(r+i);if(!j){b[i]=[];var f=document.createElement(e);f.setAttribute(a,m);f.setAttribute(d,r+i);f.style.backgroundColor="rgba(255, 255, 255, 0.5)";f.style.opacity="1";f.style.filter=o;f.style.height=h;var g=document.createElement(e);g.style.width=h;g.style.height=h;g.style.backgroundImage=n+c.getLocalizedImageFilePath(E)+")";g.style.backgroundRepeat=p;g.style.backgroundPosition=q;f.appendChild(g);k.appendChild(f)}OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RenderLoadingAnimationEnd)}catch(l){}},showNotification:function(a){a.sqmDWords=[a.errorCode,0];delete a.errorCode;if(a.highPriority==undefined)a.highPriority=a.infoType===OSF.InfoType.Error?i:f;if(a.reDisplay==undefined)a.reDisplay=a.infoType===OSF.InfoType.Error?i:f;var c=b[a.id];if(c===undefined){c=[];b[a.id]=c}if(a.highPriority===f)c.push(a);else{c.splice(B,0,a);B++}(b[a.id].length===1||a.highPriority)&&v(c[0])},showICon:function(a){H(a)},removeDOMElement:function(a){C(a)},removeProgressDiv:function(a,c){OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveLoadingAnimationStart);var b=a.ownerDocument.getElementById(r+c);b&&z(a);OSF.OUtil.writeProfilerMark(OSF.NotificationUxPerfMarker.RemoveLoadingAnimationEnd)},removeIConDiv:function(a){P(a)},removeInfoBarDiv:function(b,a){D(b,a)},dismissMessages:function(a){N(a)},getHTMLEncodedString:function(a){return K(a)},purgeOsfControlNotification:function(d){var a=b[d],e=c.getOsfControl(d);a&&a.length>0&&e&&Telemetry.AppNotificationHelper.LogNotification(d,a[0].sqmDWords[0],a[0].sqmDWords[1])},focusOnNotificationUx:function(a,b){s(a);A(a,b)},focusOnNotificationUxShiftIn:function(a,b){s(a);I(a,b)},appHasNotifications:function(a){return b[a]&&b[a].length>0}}};OfficeExt.appSpecificCheckOrigin=function(d,a,c,b){try{if(!a||!a.source||!a.source.location||!a.source.location.pathname||a.source.location.pathname.indexOf("projection.aspx")<0)return false;return b(d,c._origin)}catch(e){return false}};
window.scriptsLoaded['osfruntime.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['osfruntime.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
