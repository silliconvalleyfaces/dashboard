try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.quickcompose.js'] = (new Date()).getTime();
Type.registerNamespace("_qc");_qc.q=function(n,t,i,r,u){this.a=n;this.b=t;this.h=i;this.g=r;this.i=u};_qc.q.prototype={a:null,b:null,h:null,k:null,e:null,g:null,f:null,d:null,i:null,c:null,j:null};_qc.f=function(n){this.a=n};_qc.f.prototype={a:null,c:!1,b:!1};_qc.n=function(){};_qc.c=function(n){this.a=n};_qc.c.prototype={a:0};_qc.t=function(n){this.b=n};_qc.t.prototype={b:null,a:function(){return this.b}};_qc.u=function(n){this.b=n};_qc.u.prototype={b:null,a:function(){return this.b}};_qc.v=function(n){_qc.v.initializeBase(this,[n])};_qc.v.prototype={b:function(n){var t=this.d.m(n)+1;return t<this.d.d.length?this.d.d[t]:""},c:function(n,t,i,r){for(var e=this.d.m(t),f=e;f<this.d.d.length;f++){var o="QC:"+this.d.d[f];var u=n.c[o];if(f!==e&&!u.y())break;u.u(i);u.D(r);n.d.a(_a.dQ,new _a.dQ(o,u))}},f:function(n,t,i){if(_bc.f.a(t.k().bk.ItemId)&&this.d.d.length>1){var f=this.d.m(i)-1;var e="QC:"+this.d.d[f];var r=n.c[e];if(!r.o()){var u=this.e(n);t.s(u.i())}}},g:function(n,t,i){var r=null;if(!this.d.m(t)&&this.d.d.length>1){var f="QC:"+this.d.d[1];r=n.c[f];var u=this.e(n);r.s(u.i())}this.d.n(t);return r},e:function(n){if(!!this.d.d.length){var t="QC:"+this.d.d[0];return n.c[t]}return null}};function QuickComposeComponent(){}QuickComposeComponent.$$cctor=function(){_a.u.a().a(QuickComposeComponent)};QuickComposeComponent.prototype={a:function(n,t,i){n.e(_qc.B).b(IQuickComposeEventAggregatorFactory).a();var o=this;n.b(_y.ep,function(){return new _qc.C(n.a(_g.N),n.d(IRecipientWellViewModelFactory),n.a(_j.u))}).a();var s=this;n.b(_y.eq,function(){return new _qc.D(n.a(_a.t),n.a(_j.j),n.a(_a.cq),i.a()==="Mouse"?n.c(ISendFailureNotificationProviderViewModel):null,n.a(_h.o).a())}).a();var h=this;n.b(_y.eo,function(){return new _qc.A(n.a(_a.t),n.d(IAttachmentWellViewModelFactory),n.d(IAttachmentsFilePickerPanelViewModel),n.a(_a.B),n.a(_a.bt),n.a(_a.l),n.a(_y.a),n.a(_g.a).bk.AttachmentPolicy,n.a(_j.j))}).a();var e=this;n.b(_qc.s,function(){return new _qc.s(n.d(IMailComposeContextFactory),n.a(_a.B),n.a(_a.l))}).a();var r=this;n.b(_y.ff,function(){return new _qc.y(n.a(_j.j),n.a(_g.N),n.a(_a.l))}).a();var u=this;n.b(IMailQuickComposeViewModel,function(){return new _qc.z(n.a(_j.j),n.a(_a.cq),n.a(_y.ff),n.a(IQuickComposeEventAggregatorFactory),n.a(_y.ep),n.a(_y.eq),n.a(_y.eo),n.a(_qc.s),n.a(_a.l).L,n.a(_a.B),n.c(IAtMentionsHandler))});var f=this;n.b(IMailInlineComposeConductorViewModelFactory,function(){return new _qc.x(n.a(_a.cq),n.d(IMailInlineComposeViewModelFactory),n.d(IMailComposeContextFactory),n.a(_a.f),n.a(_pe.e),n.a(_a.l))}).a()},b:function(){return null}};_qc.e=function(n,t,i,r,u,f,e,o,s,h,c,l){_qc.e.initializeBase(this);this.bo=_qc.e.b++;this.S=n;_qc.d.isInstanceOfType(t)&&(t.l=this);this.J=t;_qc.j.isInstanceOfType(i)&&(i.j=this);this.N=i;_qc.m.isInstanceOfType(r)&&(r.i=this);this.L=r;_qc.i.isInstanceOfType(u)&&(u.h=this);this.V=u;this.K=f;this.ba=e;this.br=s;this.bl=h;this.bb=c;this.U=l;var a=new _g.i;a.cs(new _g.w(new _g.s("HTML","")));a.dy("Normal");a.dm("Normal");a.gF(new _a.j);a.cx(o.f());this.I=a;this.T={};this.Z={};this.bn(!0);this.G("Creating new QuickComposeContext in context service with key "+n);e.a(_a.bW,new _a.bW(n,this))};_qc.e.prototype={ba:null,br:null,bl:null,I:null,bo:0,K:!1,bm:null,S:null,Q:null,P:null,bc:!1,bj:!1,U:null,bb:null,R:!1,bk:null,bd:!1,bp:!1,bi:null,W:null,Y:!1,bg:null,O:0,J:null,N:null,L:null,V:null,bA:function(n){this.apcl("SendSemaphore",n)},bu:function(n){this.rpcl("SendSemaphore",n)},d:function(){return this.J},a:function(){return this.N},g:function(){return this.L},h:function(){return this.V},e:function(){return this.S},z:function(){return this.bl},b:function(){return this.I},n:function(){return this.bb},o:function(){return this.R},u:function(n){this.R=n;return n},D:function(n){this.bk=n;return n},y:function(){return this.bd},F:function(n){this.U=n;return n},x:function(){return this.Q},p:function(n){if(this.Q!==n){this.Q=n;this.bv("InReplyToItem","InReplyToText")}return n},i:function(){return this.P},s:function(n){this.P=n;this.G("Updated default original item to be "+this.P?this.P.bk.ItemId.Id:"null");return n},k:function(){if(this.Q){this.G("returning inReplyToItem as the original item to respond to");return this.Q}if(this.P){this.G("returning the default original item from the defaultOriginalItemPartViewModelGetter.");return this.P}this.G("neither inReplyToItem nor defaultOriginalItemPartViewModelGetter were present, returning null as original item");return null},be:function(){if(this.bp)return!0;var n;var r=this.L.e();var u=this.J.j();if(this.Y){n=this.m();this.G("active context updated message body with editor content prior to IsEmpty check, contentLength="+(n?n.length:0))}else{var f=this.I;n=f.I().bk.Value;this.G("inactive context using body value as content for IsEmpty check, contentLength="+(n?n.length:0))}var t=_j.i.a(n)||this.W===n.replace("&nbsp;","");var i=t&&r&&u;this.G("IsEmpty="+i+" since isContentEmpty="+t+", isAttachmentWellEmpty="+r+", isRecipientWellUntouched="+u);return i},j:function(){return this.bc},c:function(n){if(this.bc!==n){if(n&&this.K){this.bL();var r;var i;var t;var e,f,u;this.bK(e={val:r},f={val:i},u={val:t}),r=e.val,i=f.val,t=u.val;if(!r||!i){this.G("Cannot enable edit mode since original item is not allowed reply all or edit");this.bc=!1;this.bs("IsInEditMode");_a.F.a(_nbs.a.ff,0);return n}this.bM();t?this.J.d():this.J.f()}else n&&this.J.d();this.bc=n;this.bs("IsInEditMode");this.bx(n)}else n&&this.A(new _cmc.G(!1));return n},bx:function(n){if(this.bj!==n){this.bj=n;this.bs("IsInEditModeCompleted")}return n},w:function(){return this.bi},A:function(n){if(this.bi!==n){var t=_y.dD.isInstanceOfType(n)?n.b():!1;this.bi=n;t&&this.bD(n);this.bs("EditorCallContext")}return n},q:function(n){if(this.Y!==n){this.Y=n;this.bs("IsActive")}return n},C:function(n){this.bp=n;return n},r:function(){return this.W},t:function(n){this.W=n;return n},v:function(){this.bm||(this.bm=this.bB());return this.bm},T:null,l:function(){return this.T},bJ:function(){return _cmc.h.c(_g.cp,this.T,_cmc.d.b,null)},Z:null,bE:function(){return _cmc.a.f(this.Z,null,!0)},bf:function(n){if(this.O!==n){this.O=n;this.bs("SendSemaphore")}return n},hb:function(){return!1},G:function(n){_j.e.a(_qc.e.c,this.bo+":"+this.S+": "+n)},m:function(){var t=new _cmc.j(!1);this.A(t);var n=t.d;if(n){this.I.I().b(n);this.G("updated message body with editor content "+n);return n}this.G("content is null, skipping message body update");return this.I.I().bk.Value},f:function(){var n=this.I.I().bk.Value;var t=new _cmc.r(n);this.A(t);this.G("updated editor content with message body "+n)},E:function(n){if(this.bd){this.G("update original item to "+n.bk.ItemId.Id);this.P=n;this.G("original item has valid item id and pending message is ready to be sent");this.N.i()}},bn:function(n){this.N.a().c(n);this.V.a().c(n);this.L.b().c((this.br.o()||!this.L.d())&&n)},bh:function(){var n=new _qc.q(this.S,this.W,this.bb,this.U,this.bl);_qc.d.isInstanceOfType(this.J)&&this.J.X(n);_qc.j.isInstanceOfType(this.N)&&this.N.R(n);this.ba.a(_qc.q,n);this.G("mark current context as inactive");this.q(!1);if(this.bg){this.G("restoring bottom app bar after creating initial state clone of the context");this.ba.a(_y.cR,new _y.cR(this.S,2,this.bg))}},bC:function(n,t){return _cmc.s.b(n,this.I,_mco.a.b(this.I.bk.From)||this.J.e(),_mco.a.b(this.I.bk.Sender)||this.J.e(),t)},bq:function(){this.A(new _cmc.r(""));this.G("resetting editor to empty string")},by:function(){if(this.L.a()&&this.L.a().w()){var n=null;this.J.b()&&this.J.a()?n=this.J.a().f():!this.J.b()&&this.J.c()&&(n=this.J.c().f());n&&this.L.a().bt(n)}},bt:function(){this.G("disposing this instance");this.G("dereferenced any variables holding external references");this.Q=null;this.J.g();this.N.e();this.L.c();this.V.d();this.J=null;this.N=null;this.L=null;this.V=null;_j.Q.prototype.bt.call(this)},bD:function(n){if(_y.bN.isInstanceOfType(n)){var i=this.I.I();if(_j.i.a(this.W)){var t=n.c();this.W=t;i.b(t);this.G("set the empty content and body content on editor get content callback to "+t)}}},bB:function(){var t=[new _y.f(_y.b.z(),_y.b.A(),_nbs.a.Ng,this.N.a()),new _y.f(_y.b.O(),_y.b.P(),_nbs.a.ho,this.L.b()),new _y.f(_y.b.l(),_y.b.m(),_nbs.a.gx,this.V.a())];var n=_y.k.a(null,t,null,!0);n.M(!0);return n},bL:function(){if(this.U){var n=this.U();if(n){this.G("Setting the default original item from the defaultOriginalItemPartViewModelGetter.");this.P=n.a()}}},bM:function(){this.G("entering edit mode, raising swap app bar event for the tnarrow reply scenario");var t=new _y.cR(this.S,1,this.v());this.ba.a(_y.cR,t);var n=t.b;if(n){this.G("recording bottom app bar since it is not null");this.bg=n}},bK:function(n,t,i){var u=this.k();var r=u?u.bB():null;if(r&&!r.a()){n.val=r.c();t.val=r.i();i.val=r.g()}else{n.val=!0;t.val=!0;i.val=!0}}};_qc.F=function(n,t,i){this.b=n;this.c=t;this.d=i};_qc.F.prototype={b:null,c:null,d:null};_qc.G=function(n,t,i,r,u,f,e,o,s){this.Q=Function.createDelegate(this,this.bz);this.be=Function.createDelegate(this,this.bp);this.ba=Function.createDelegate(this,this.bh);this.bd=Function.createDelegate(this,this.bo);this.Z=Function.createDelegate(this,this.bf);this.bc=Function.createDelegate(this,this.bw);this.O=Function.createDelegate(this,this.bu);this.P=Function.createDelegate(this,this.bv);this.bb=Function.createDelegate(this,this.bt);_qc.G.initializeBase(this);this.v=n;this.J=t;this.T=i;this.U=r;this.V=u;this.R=f;this.K=e;this.s=o;this.s&&this.s.c()&&s&&s.a(this.bb);this.v.b(_a.bW,this.P);this.v.b(_qc.q,this.O);this.bn=new _j.g(this.bc,_a.a.r)};_qc.G.prototype={v:null,J:null,T:null,U:null,V:null,R:null,K:!1,bn:null,x:null,E:null,I:null,C:!1,s:null,a:function(){var n=this.E;if(!n){_j.e.a(_a.a.r,"returning null context since key is null");return null}return this.J.c[n]},n:function(){return this.C},q:function(n){this.C=n;return n},f:function(){return this.C&&this.K},g:function(){return this.C&&!this.K},bx:function(){return 0},w:function(){return null},p:function(){return this.I},j:function(n){this.I=n;return n},by:function(){return!1},m:function(){var n=_y.hR.prototype.m.call(this);return n===2?1:n},o:function(){return null},c:function(n){return n},bi:function(){return _nbs.a.nr},bl:function(){return _nbs.a.eM},bk:function(){return!1},bm:function(){return"sentitems"},r:function(n){var t=this.J.c[n];t&&t.m()},e:function(n,t,i,r,u,f,e){this.t("switching to context "+n);var s=this.a();if(s){this.t("calling oldContext.UpdateMessageBodyWithEditorContent to preserve the content before switching context, marking it inactive");s.m();s.q(!1)}this.E=n;var o=this.J.c[n];this.t(i.b()+" to recipients are passed from modern reading pane in context switch");this.t(r.b()+" cc recipients are passed from modern reading pane in context switch");var h;var l;var c;if(f){h=this.bl();this.t("setting place holder text to "+h+" for reply during context switch");l=this.ba;c=this.be}else{h=this.bi();this.t("setting place holder text to "+h+" for new compose during context switch");l=this.Z;c=this.bd}if(o){this.t("Updating existing context and firing the context changed event");o.F(u);this.eu("Context");this.ee(o.v());this.t("updating editor content with message body on context switch");o.f();o.d().k(i,r)}else{o=this.bg(n,t,i,r,u,f,e,h,l,c);if(s)if(_j.i.a(s.r()))this.t("skipped transfer of empty content from old context to new context since it is not set in the old context");else{o.t(s.r());this.t("transferred empty content from old context to new context")}}this.t("marking the current context as active");o.q(!0)},d:function(n,t,i){return this.C?new _mco.c(new _g.bv,t.e().bk.ItemId,this.s,this.v):new _mco.a(t.A(!1),null,this.s,this.v)},i:function(n){if(this.x&&this.a()){var t=this.a().l();n.b()?this.x.a(n.a(),t):this.x.b(n,t,this.a().d().a(),null)}},l:function(n){if(this.x&&this.a()){var t=this.a().l();n.b()?this.x.c(n.a(),t):this.x.d(n,t,this.a().d().a(),_cmc.d.g)}},h:function(){return this.a()?_cmc.d.f(this.a().l()):null},bf:function(n,t){return new _mco.a(n.b(),null,this.s,this.v)},bh:function(n,t){return new _mco.c(new _g.bv,n.k().bk.ItemId,this.s,this.v)},bo:function(n){},bp:function(n){},ex:function(){this.v.c(_a.bW,this.P);this.v.c(_qc.q,this.O);this.bs();_y.hR.prototype.ex.call(this)},bg:function(n,t,i,r,u,f,e,o,s,h){_j.e.a(_a.a.r,"Creating new context with key "+n);var c=this.T.a();var v=this.U.a(e,c,i,r);var a=this.V.a(c,this.bk(),s,f,t,this.bm(),h);var l=this.R.a(t,c);return this.S(n,v,a,l,c,o,t,u)},bu:function(n){if(n.a===this.E){this.t("Create a new context on initial state clone event");var t=this.bg(n.a,n.h,n.k,n.e,n.g,n.f,n.d,n.i,n.c,n.j);this.t("mark the new context as active");t.q(!0);this.t("transferring empty content to new context, content="+n.b);t.t(n.b)}},bv:function(n){if(n.b===this.E){this.t("firing context changed event on new context with the same key, updating the new app bar");this.eu("Context");this.ee(n.a.v());if(this.I){this.t("closing the popup on new context");this.I()}}},bw:function(){this.v.a(_a.ep,new _a.ep)},t:function(n){_j.e.a(_a.a.r,this.E+": "+n)},bt:function(n){this.x=n;this.v.b(_y.cw,this.Q)},bs:function(){this.v.c(_y.cw,this.Q);this.x=null},bz:function(n){if(this.x&&this.a()&&this.a().d()){var t=this.a().d().a();this.x.e(n.a(),this.a().l())}}};_qc.h=function(n,t,i,r,u,f,e,o,s,h){_qc.h.initializeBase(this);this.v=new _qc.p(n,t,this,e,o,s);this.w=i;this.t=r;this.s=u;this.D=f;this.u=new _y.B;this.P=h;this.y=e};_qc.h.b=function(n){return _qc.h.a(n.bh(),n.V()?n.V().EmailAddress:null,!n.a())};_qc.h.a=function(n,t,i){var r=null;i&&!_j.i.a(t)?r=t:!i&&n&&(r=n.Id);if(r)return"QC:"+r;else{_j.e.b(_a.a.r,"context key is null. conversationId: "+(n?n.Id:"null")+" groupEmailAddress: "+t+" isNewMail: "+i);return null}};_qc.h.prototype={y:!1,t:null,w:null,s:null,E:!1,O:!1,z:!1,x:null,J:!1,D:null,u:null,v:null,P:null,G:null,k:function(){return this.y},Y:function(){return this.y&&this.S()},Z:function(){return this.y&&!this.S()},S:function(){return _j.F.a().L},c:function(){return this.z},n:function(n){if(this.z!==n){this.z=n;this.bs("IsShowingCompose")}return n},b:function(){return this.u.b()},o:function(n){this.J=n;return n},d:function(n){this.x=n;return n},q:function(){return this.E},j:function(n){this.E=n;this.U();return n},r:function(n){this.O=n;return n},p:function(){return this.I()?this.I().bk.SmtpAddress:null},I:function(){return this.D?this.D():null},U:function(){},m:function(n){this.s&&this.s.a(n)},e:function(n,t){if(!this.E)if(this.J){this.J=!1;this.s.cD(this)}else{this.j(!0);this.n(!1);this.ba(n.a());this.u.e(this.v);if(this.s.bQ()){this.s.bQ()();this.s.bx(null)}}},l:function(){this.g(!0);var t=this.I();var n=_qc.h.a(this.w?this.w.bk.ConversationId:null,t?t.bk.SmtpAddress:null,!this.w);if(n&&this.t.c[n]&&_y.cN.isInstanceOfType(this.t.c[n])){var i=this.t.c[n];this.F(i);this.x&&this.s.bV(this.x);return}this.n(!1);this.V();this.u.e(this.v)},g:function(n){if(this.z){var t=this.b();t.v(!0);var i=t.a();this.e(t,!1);n&&this.X(i)}},i:function(){if(this.z){var n=this.b();this.e(n,!1)}},V:function(){},T:function(){this.s.j(!1);this.j(!1);this.O=!1;this.n(!0)},bt:function(){this.u.dispose();this.u=null;var n;_a.h.a(n={val:this.v}),this.v=n.val;this.D=null;this.s=null;this.x=null;_j.Q.prototype.bt.call(this)},X:function(n){var t=_qc.h.b(n);t&&!this.t.c[t]&&this.t.d.a(_a.bW,new _a.bW(t,n))},ba:function(n){var t=_qc.h.b(n);t&&n===this.t.c[t]&&this.t.d.a(_a.bK,new _a.bK(t))},f:function(){return this.G},bb:function(n){if(n!==this.G){this.G=n;this.bs("ScrollManager")}return n},h:function(n,t,i){this.bb(new _cmc.i(n,t,i,null,10,this.P));return this.G}};_qc.w=function(n,t,i,r,u,f,e,o,s,h,c){_qc.w.initializeBase(this,[n,t,i,r,f,e,o,s,h,c]);this.A=u};_qc.w.prototype={A:null,U:function(){this.s&&this.s.j(this.E)},a:function(n){n.I()?this.m(n):this.F(n)},F:function(n){var t=this;this.A.a(function(i){t.s.cN();var r=i.a(n,null,null);r.e(t);t.T();t.u.e(r)})}};_qc.x=function(n,t,i,r,u,f){this.b=n;this.e=t;this.d=i;this.f=u;this.c=r;this.g=f};_qc.x.prototype={b:null,e:null,d:null,c:null,f:null,g:null,a:function(n,t,i,r,u){return new _qc.w(t,this.d,n,this.b,this.e,i,r,u,this.c,this.f,this.g)}};_qc.p=function(n,t,i,r,u,f){this.l=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.w);_qc.p.initializeBase(this);this.c=n;this.g=t;this.a=i;this.d=r;this.i=f;this.f=!!u&&u.a().bG().Enabled;this.j=new _j.g(this.n,_a.a.r);this.h=new _j.g(this.l,_a.a.r);this.b=!0};_qc.p.prototype={j:null,h:null,f:!1,i:null,a:null,c:null,g:null,d:!1,e:null,b:!1,o:function(){return this.d?_nbs.a.Tr:_nbs.a.nr},r:function(){return this.d?this.j:this.h},p:function(n){if(this.b!==n){this.b=n;this.eu("ButtonEnabled")}return n},t:function(){this.e||(this.e=this.q());return this.e},s:function(){return this.d&&this.f},ex:function(){this.c=null;this.a=null;_y.hR.prototype.ex.call(this)},w:function(){if(this.c){var n=this.c();if(n){_j.e.a(_a.a.r,"on reply all in inline compose");if(n.b().m.b){this.a.d(null);n.b().m.a()}else _a.F.a(_nbs.a.ff,0)}}},v:function(){var n=this;this.g.a(function(t){var i=t.a(!1,!1);i.v(_y.j.b(_a.a.w,"MailComposeNew",!0));i.bv();i.d(0);i.g(!1);i.cF(!0);i.z(n.o());n.a.d(null);n.a.a(i)})},q:function(){var t=_g.a.a().c();var n=new _g.f;n.EmailAddress=t.bk.UserEmailAddress;n.Name=t.bk.UserDisplayName;var i=_h.i.a(n);return this.i.b(i,2,!1,5,!1,null,!1,8,!1,!1)}};_qc.C=function(n,t,i){this.c=n;this.b=t;this.d=i};_qc.C.prototype={c:null,b:null,d:null,a:function(n,t,i,r){return new _qc.d(this.c,t,this.d,n,this.b,i,r)}};_qc.d=function(n,t,i,r,u,f,e){this.F=Function.createDelegate(this,this.bb);this.D=Function.createDelegate(this,this.P);this.C=Function.createDelegate(this,this.Y);this.E=Function.createDelegate(this,this.ba);this.G=Function.createDelegate(this,this.bc);this.K=Function.createDelegate(this,this.Z);_qc.d.resolveInheritance();this.g=this.dispose;_qc.d.initializeBase(this);this.A=n;this.p=t;this.J=i;this.r=r;this.v=u;this.u=f;this.t=e;this.I=new _j.g(this.K,_qc.d.a);this.p.b(_qc.n,this.G);this.p.b(_qc.f,this.E)};_qc.d.prototype={p:null,A:null,J:null,v:null,r:null,I:null,l:null,u:null,t:null,m:null,q:null,o:!1,z:null,s:!1,n:null,y:null,x:null,a:function(){return this.m},W:function(n){if(this.m===n)return n;if(this.m){this.l.G("unhook To well bulk resolve event and collection changed event");this.m.E&&this.m.E.g(this.C);this.m.cr(this.D);this.l.G("disposing and dereferencing the To recipient well");this.m.dispose()}if(n){this.m=n;this.m.t(!1);var t=this.m.F();t?t.M(!1):this.m.apcl("FindRecipientViewModel",this.F);this.s=!1;this.m.E&&this.m.E.e(this.C);this.m.ch(this.D)}else this.m=null;this.bv("ReadWriteRecipientWellViewModel","IsRecipientWellNull");return n},c:function(){return this.q},V:function(n){if(this.q!==n){this.q=n;this.bv("ReadOnlyRecipientWellViewModel","IsRecipientWellNull")}return n},b:function(){return this.o},U:function(n){if(this.o!==n){this.o=n;this.bs("IsReadWrite")}return n},h:function(){return this.o?!this.m:!this.q},i:function(){return this.I},e:function(){if(!this.z){var n=new _g.O;n.Mailbox=new _g.f;n.Mailbox.EmailAddress=this.A.bk.UserEmailAddress;n.Mailbox.Name=this.A.bk.UserDisplayName;n.Mailbox.RoutingType="SMTP";this.z=n}return this.z},N:function(){this.y||(this.y=_a.I.a(this.e().Mailbox.EmailAddress));return this.y},M:function(){!this.x&&this.r&&(this.x=_a.I.a(this.r.EmailAddress));return this.x},j:function(){return this.o?this.l.Y?!this.m||!this.s&&(!this.m.F()||_j.i.b(this.m.F().c())):!this.s:!0},Z:function(){this.S()},k:function(n,t){this.u=n;this.t=t},d:function(){this.U(!0);if(!this.m||!this.s){this.l.G("creating the read write to well first before showing the read write recipient well, wereToRecipientsEdited="+this.s);var n=this;this.v.a(function(t){n.l.G("framework read write recipient well factory called back");n.n={};var i=n.L();n.W(t.a(_qc.d.c,4,i,!0,!1,null,null,0,0,!1,!0))})}},f:function(){this.U(!1);if(!this.q){this.l.G("creating the read only to well first before showing the read only recipient well");var n=this;this.v.a(function(t){n.l.G("framework read only recipient well factory called back");n.n={};var i=n.L();n.V(t.b(_qc.d.b,_bc.e.a,i,2,!1,!0))})}},X:function(n){n.k=this.u;n.e=this.t;n.d=this.r},T:function(n,t){n.val=new _a.j;t.val=new _a.j;var i=null;this.o&&this.m?i=this.m.G:!this.o&&this.q&&(i=this.q.b());if(i)for(var e=i.x.length,u=0;u<e;u++){var r=i.x[u];var f=this.w(r);if(f in this.n)this.n[f]?t.val.c(r):n.val.c(r);else{this.l.G("Email address "+f+" is not in the local bookkeeping, add it to To");n.val.c(r)}}},bt:function(){this.u=null;this.t=null;this.p.c(_qc.n,this.G);this.p.c(_qc.f,this.E);this.V(null);this.W(null);_j.Q.prototype.bt.call(this)},S:function(){if(this.m){this.m.bj();this.m.cl()}},bc:function(n){var t;(t=this.l).bf(t.O+1);if(this.o){if(!this.m.G.x.length&&(!this.m.F()||_j.i.a(this.m.F().c()))){this.l.G("There are no recipients in the read write To well.");this.p.a(_qc.c,new _qc.c(2));return}this.l.G("start resolving recipients");try{this.S()}catch(i){this.l.G("Something went wrong during force resolve, we throw it but clean up send");this.p.a(_qc.c,new _qc.c(4));throw i;}}else this.P(!0)},ba:function(n){if(!n.c){if(this.o&&this.m||!this.o&&this.q){var i;var t;var u,r;this.T(u={val:i},r={val:t}),i=u.val,t=r.val;n.a.q(i.e);n.a.ba(t.e)}n.c=!0;this.p.a(_qc.f,n)}},bb:function(n,t){this.m.F().M(!1);this.m.rpcl("FindRecipientViewModel",this.F)},Y:function(n,t){var i=t.c;this.l.G("user edited the To recipients, marking the edited flag and process the "+i+" change");this.s=!0;this.l.L&&this.l.L.a()&&this.l.L.a().K(t);var u=t.b;var r=t.a;switch(i){case 0:this.Q(r);break;case 2:this.R(u);break;case 3:this.R(u);this.Q(r);break;default:throw Error.notImplemented("a new NotifyCollectionChangedAction "+i+" has been introduced and quick compose does not work with it");}},R:function(n){if(n)for(var f=n.length,r=0;r<f;r++){var u=n[r].k.a();var t=this.w(u);this.l.G("recording removed recipient "+t);if(t in this.n)if(t===this.M()){var i=this;this.J.a(_qc.d.a,"ProcessAlwaysKeepRecipients",function(){if(i.m){i.l.G("adding the always keep address "+t+" back in To well");i.m.bB(i.r)}},0)}else{this.l.G("removing removed recipient "+t+" from local copy");delete this.n[t]}}},Q:function(n){if(n)for(var r=n.length,t=0;t<r;t++){var u=n[t].k.a();var i=this.w(u);this.l.G("adding added recipient "+i+" to local copy");this.n[i]=0}},P:function(n){if(n){this.l.G("resolve succeeded");var i;var t;var f,u;this.T(f={val:i},u={val:t}),i=f.val,t=u.val;this.l.I.bX(t);this.l.I.bF(i);if(this.l.R){var r;(r=this.l).bf(r.O-1)}}else{this.l.G("resolve canceled, canceling send and switching from system initiated editing recipient to user initiated editing recipient state");this.p.a(_qc.c,new _qc.c(4))}},L:function(){this.l.G("begin calculating initial audience");var n=new _j.l;this.O(n,this.u,0);this.O(n,this.t,1);if(!n.x.length)if(this.l.M()){var i=this.M();this.l.G("adding always keep address "+i+" for group since the initial audience from To and Cc passed in is empty");n.a(this.r);this.n[i]=0}else{var t=this.N();this.l.G("adding self address "+t+" for non group since the initial audience from To and Cc passed in is empty");n.a(this.e().Mailbox);this.n[t]=0}this.l.G("end calculating initial audience");return n},O:function(n,t,i){var e=t?t.b():0;this.l.G("merging "+e+" "+i+" partial audience into audience");for(var o=this.l.M(),s=o?null:this.N(),r=0;r<e;r++){var u=t.a(r);var f=this.w(u);if(o){n.a(u);this.n[f]=i}else if(s!==f){n.a(u);this.n[f]=i}}},w:function(n){return n.EmailAddress?n.EmailAddress.toLowerCase():n.ItemId.Id}};_qc.D=function(n,t,i,r,u){this.b=n;this.d=t;this.c=i;this.f=r;this.e=u};_qc.D.prototype={b:null,d:null,c:null,f:null,e:!1,a:function(n,t,i,r,u,f,e){return new _qc.j(this.c,this.b,this.d,n,this.f,this.e,t,i,r,u,f,e)}};_qc.j=function(n,t,i,r,u,f,e,o,s,h,c,l){this.K=Function.createDelegate(this,this.Z);this.I=Function.createDelegate(this,this.W);this.J=Function.createDelegate(this,this.X);this.v=Function.createDelegate(this,this.bb);this.D=Function.createDelegate(this,this.Y);this.C=Function.createDelegate(this,this.T);this.G=Function.createDelegate(this,this.V);this.L=Function.createDelegate(this,this.ba);_qc.j.resolveInheritance();this.e=this.dispose;_qc.j.initializeBase(this);this.l=n;this.w=t;this.p=i;this.n=r;this.q=u;this.z=f;this.y=e;this.r=o;this.m=s;this.s=h;this.A=c;this.u=l;var a=_a.l.a();this.x=!a.k();this.t=new _j.g(this.L,_qc.j.a);this.E=new _j.g(this.G,_qc.j.a);this.n.b(_qc.c,this.C)};_qc.j.prototype={y:!1,E:null,w:null,p:null,n:null,q:null,z:!1,x:!1,A:"none",l:null,o:null,k:null,j:null,t:null,m:null,s:null,r:null,u:null,a:function(){return this.t},b:function(n){if(this.t!==n){this.t=n;this.bs("SendCommand")}return n},f:function(){return this.E},g:function(){return this.x},c:function(){return this.q},d:function(){this.j.G("update original item for resend");var t="OQC:"+this.m.bk.ConversationId.Id;var n=this.l.c[t];n.f(this.l,this.j,this.j.I.bk.InternetMessageId);this.i();this.j.G("update subsequent outstanding context to be pending send");n.c(this.l,this.j.I.bk.InternetMessageId,!0,"")},h:function(n){var r="OQC:"+this.m.bk.ConversationId.Id;var i=this.l.c[r];var t=i.g(this.l,n,this.j);i.d.d.length||this.l.d.a(_a.bK,new _a.bK(r));_h.c.n(this.m.bk.ConversationId,n);if(t&&this.q){var u=this;this.q.a(function(){u.p.a(IQuickComposeSendFailedEvent,new _qc.t(t))})}},i:function(){this.j.G("creating the action");var n=this.r(this.j,this.l);if(!this.j.M()){this.j.G("Setting CreateMessageItemAction fields for mail scenarios");this.P(n);if(this.j.K){this.j.G("set CreateResponseAction fields for the mail reply scenario");this.Q(n)}}this.j.K&&n.e(this.D);this.j.G("submitting the resend action");this.w.a(n);this.N();this.j.bd=!1},ba:function(){var n=this.S("QuickReplySendMeSpace","QuickReplySendWeSpace","QuickComposeSendWeSpace");n==="QuickReplySendMeSpace"&&(this.k=_a.d.b(_a.a.r,n));this.j.K&&(this.o=_a.d.b(_a.a.r,"Quick"+n));if(this.U()){this.j.bf(_qc.e.a);this.bc();this.n.a(_qc.n,new _qc.n);if(this.j.O===_qc.e.a){this.j.G("Send semaphore is AllowSendCount before property changed attached, OK to send");this.O()}else this.j.R&&this.j.bA(this.v)}else if(this.o&&this.j.K){this.o.k="InvalidToSend";_a.d.a(this.o);this.o=null}},R:function(n){n.f=this.m;n.c=this.r;n.j=this.u},bt:function(){this.r=null;this.u=null;this.m=null;this.s=null;this.j.bu(this.v);this.n.c(_qc.c,this.C);_j.Q.prototype.bt.call(this)},O:function(){if(this.u){this.j.G("start ctq tracing for send");this.u(this.j)}else this.j.G("ctq tracing is missing");if(this.j.K){this.j.G("perform immediate update by creating initial state clone to reset the compose UI back to initial state");this.j.bq();this.j.bh();if(!this.z||this.y){this.j.G("need to handle quick quickness reply");var i=this.j.I.bk.InternetMessageId;this.j.G("re-key current context to InternetMessageId: "+i);var u="QC:"+i;this.j.S=u;this.p.a(_a.bW,new _a.bW(u,this.j));var r="OQC:"+this.m.bk.ConversationId.Id;var t=this.l.c[r];if(t){this.j.G("update outstanding quick compose context with key "+r+" to track this context");t.d.c(i);t.f(this.l,this.j,i)}else{this.j.G("create outstanding quick compose context with key "+r+" to track this context");t=new _qc.v(i);this.p.a(_a.bW,new _a.bW(r,t))}this.j.G("create message for show and update the reading pane with it");var f=this.j.bC(this.m.bk,this.A);_h.c.G(this.m.bk.ConversationId);_h.c.B(f,this.M(this.j.k()),this.j.Q);this.N();if(this.j.K){_a.d.a(this.o);this.o=null}}}_cmc.d.e(this.j.I.I().bk.Value,this.j.I.bk.Subject,this.j.T);_cmc.a.e(this.j.I.I().bk.Value,this.j.I.bk.Subject,this.j.Z);this.j.I.fE(_cmc.d.d(this.j.I.I().bk.Value,this.j.I.bk.Subject,this.j.T));_cmc.h.b(this.j.I,this.j.T,this.j.bJ(),this.j.Z,this.j.bE());var n=this.r(this.j,this.l);if(!this.j.M()){this.j.G("Setting CreateMessageItemAction fields for mail scenarios");this.P(n);if(this.j.K){this.j.G("set CreateResponseAction fields for the mail reply scenario");this.Q(n);n.bJ=this.k}}if(this.j.K){n.d(this.K);n.e(this.D)}else{this.j.G("New compose send since conversation=null, setup success/failure callback on action since immediate update is not supported");n.d(this.J);n.e(this.I)}if(this.j.k()&&_bc.f.a(this.j.k().bk.ItemId)){this.j.G("do not submit send action yet since reference item still has client id");this.j.bd=!0}else{this.j.G("submitting the send action");this.w.a(n)}},F:function(){this.j.G("leaving sending state, re-enabling send and attach commands");this.j.R=!1;this.j.bn(!0)},U:function(){if(this.j.R){this.j.G("CanSend=false since we are already sending.");this.n.a(_qc.c,new _qc.c(0));if(this.k){this.k.k="alreadySending";_a.d.a(this.k);this.k=null}return!1}if(this.j.be()){this.j.G("CanSend=false since the content and the attachments are empty, recipient well was not edited.");this.n.a(_qc.c,new _qc.c(1));if(this.k){this.k.k="Empty";_a.d.a(this.k);this.k=null}return!1}if(this.m){var n=_y.P.c(this.j.k(),!1,!0,null);this.j.G("calling MailResponseCommandViewModel.IsReplyAllAllowedOnItem, result="+n);if(!n){this.n.a(_qc.c,new _qc.c(3));if(this.k){this.k.k="ReplyNotAllowedOnItem";_a.d.a(this.k);this.k=null}return!1}}return!0},bd:function(n){n===1?_a.F.a(_nbs.a.Ve,0):n===2?_a.F.a(_nbs.a.mr,0):n===3?_a.F.a(_nbs.a.pt,0):n===5&&_a.F.a(_nbs.a.RR,0)},T:function(n){this.bd(n.a);this.F();this.j.bu(this.v)},bb:function(n,t){this.j.G("Send semaphore is "+this.j.O);if(this.j.O===_qc.e.a){this.j.G("Send semaphore is AllowSendCount after property changed attached, OK to send");this.O()}},V:function(){if(this.x){this.j.G("user triggered alt+s send, calling OnSend");this.t.a()}else this.j.G("user triggered alt+s send but it is not supported, ignoring the request")},bc:function(){this.j.G("entering sending state, disabling send and attach commands");this.j.R=!0;this.j.bn(!1)},N:function(){var t=this.j.k();if(_g.i.isInstanceOfType(t)){this.j.G("marking last verb on original item");var n=t;n.cL(103);n.cM(_a.c.a())}},P:function(n){n.u=1;n.bK=!0;n.bk=this.m.bk.ConversationId;if(!this.z||this.y){n.bX=this.l;n.bh=_g.b.a.nameToId(this.A);n.bp=_g.n.c(n.bh);n.bB="QuickComposeItemPart";n.bo=_ff.e.a(_h.b.c());n.bo.ConversationShapeName="ConversationUberListView";n.bo.ConversationFolderId=_g.r.isInstanceOfType(this.s)?new _g.E(this.s):_g.n.c(this.s)}},Q:function(n){this.j.I.bk.Subject||this.j.I.cW(this.j.k().bk.Subject);n.by=this.j.k().ef();n.bE(this.j.I);n.bk=this.m.bk.ConversationId;n.bx=this.M(this.j.k())},M:function(n){return _g.i.isInstanceOfType(n)?n.bk.InternetMessageId:_g.bf.isInstanceOfType(n)?n.bk.InternetMessageId:null},X:function(n){this.j.G("send server call succeeded, creating initial state clone to reset the compose UI back to initial state");this.j.by();this.j.bq();this.j.bh();this.F();this.j.G("Firing QuickComposeSendEvent");this.p.a(_a.en,new _a.en);this.j.G("start disposing of associated context instance");this.j.dispose()},W:function(n){if(n.J){var t=n.J.message;this.j.G("send server call failed, recording context.LastErrorMessage: "+t);this.j.bk=t}var i=String.format(_nbs.a.hy,this.j.bk);_a.F.a(i,0);this.F()},Y:function(n){if(this.q){var t=this;this.q.a(function(){t.p.a(IQuickComposeSendFailedEvent,new _qc.t(t.j))})}},Z:function(n){this.j.by()},S:function(n,t,i){var r;r=this.j.M()&&this.j.K?t:!this.j.M()&&this.j.K?n:i;return r}};_qc.A=function(n,t,i,r,u,f,e,o,s){this.b=n;this.c=t;this.g=i;this.f=r;this.h=u;this.j=f;this.i=e;this.d=o;this.e=s};_qc.A.prototype={b:null,c:null,g:null,f:null,h:null,j:null,i:null,d:null,e:null,a:function(n,t){return new _qc.m(this.b,t,this.h,this.c,this.g,this.j,n,this.f,this.i,this.d,this.e)}};_qc.m=function(n,t,i,r,u,f,e,o,s,h,c){this.I=Function.createDelegate(this,this.S);this.J=Function.createDelegate(this,this.T);this.F=Function.createDelegate(this,this.C);this.G=Function.createDelegate(this,this.L);this.u=Function.createDelegate(this,this.P);this.v=Function.createDelegate(this,this.Q);this.w=Function.createDelegate(this,this.X);this.E=Function.createDelegate(this,this.O);_qc.m.resolveInheritance();this.c=this.dispose;_qc.m.initializeBase(this);this.x=n;this.l=t;this.t=i;this.y=r;this.r=u;this.m=f;this.o=e;this.n=o;this.D=s;this.q=h;this.p=c;this.z=new _j.g(this.E,_qc.m.a);this.l.b(_qc.n,this.w);this.l.b(_qc.f,this.v)};_qc.m.prototype={t:null,z:null,m:null,x:null,l:null,y:null,r:null,D:null,q:null,s:null,i:null,j:null,n:null,k:null,o:null,p:null,b:function(){return this.z},a:function(){return this.j},U:function(n){if(this.j!==n){this.j=n;this.bs("AttachmentWellViewModel")}return n},g:function(n){this.k=n;return n},d:function(){return!this.i.M()||!this.t.a(this.o.a.Mailbox.EmailAddress,"DraftsForGroupAttachments")},h:function(n){this.K();this.i.I.bO(n);this.i.I.fJ(!0);if(this.k&&this.k.b()>0){var t=this;this.A(function(){t.j.e(t.i.I.bk.ItemId,t.k,null)})}this.j&&this.j.e(this.i.I.bk.ItemId,this.k,null)},e:function(){if(this.i.Y)return!this.j||!this.j.o();else{var n=this.i.I;return!n.es()||!n.es().b()}},f:function(){if(this.i.M()&&this.j&&this.j.a())for(var n=0;n<this.j.a().x.length;n++)if(this.j.a().x[n].ef){this.p.a(_a.v,new _a.v([String.format(_nbs.a.CV,this.j.be())],1,null,0,!1,null,null,String.format(_nbs.a.nL,this.j.be())));return}},R:function(){this.i.G("start populating message with attachments in well");var u=this.j;if(!u){this.i.G("attachment well was not created, end populating message with attachments");return}var t=u.a();if(!t){this.i.G("no attachments found in well, end populating message with attachments");return}var n=t.x.length;if(!n){this.i.G("no attachments found in well, end populating message with attachments");return}var i=new Array(n);var f=0;var e=this;t.n(function(n){var u=n;var e=u.bm;var t=e;t.q(u.bL);var r=t.v();r.AttachmentId=t.bk.AttachmentId;i[f++]=r});var r=this.i.I.S();if(r){this.i.G("updating message attachments with "+n+" attachments");r.C(i)}else{this.i.G("creating message attachments and populating with "+n+" attachments");this.i.I.Z(new(_a.fE.$$(_g.Attachment,_g.bn))(i))}},bt:function(){this.l.c(_qc.n,this.w);this.l.c(_qc.f,this.v);var n=this.j;if(n){this.i.G("unhook events and dereferencing the attachment well view model");n.M(this.u);n=null}_j.Q.prototype.bt.call(this)},O:function(){var i=this.m.e()&&this.m.c()&&this.m.d().c().b>=4.4&&this.m.g()&&this.m.d().b()<33;if(i){var r=this.A(this.G);r&&this.L()}else{var n=this.A(this.F);if(n)if(this.m.b()){var t=this;_j.n.a().a(_qc.m.a,"On attach in quick compose",function(){t.C()},100)}else this.C()}},X:function(n){var i;(i=this.i).bf(i.O+1);this.i.M()||this.R();if(this.j&&this.j.k())this.l.a(_qc.c,new _qc.c(5));else{var t;(t=this.i).bf(t.O-1)}},Q:function(n){if(!n.b){this.j&&n.a.U(this.j.a());n.b=!0;this.l.a(_qc.f,n)}},A:function(n){var i=this.j;if(!i){this.i.G("start creating the attachment well");var t=this;this.y.a(function(r){t.i.G("creating the attachment well");var u=r.b(null);u.j(1);u.p(t.i.I.bk.ItemId);var f=t.i.M()?t.i.bb.a.Mailbox.EmailAddress:null;i=r.c(u,t.k,!1,0,!0,null,!0,new _db.i,null,null,null,null,f,!!t.i.J.a());i.ch(t.d());i.v(t.u);i.ci(!0);t.U(i);if(n){t.i.G("calling the on attachment well created callback");n()}});return null}this.i.G("returning the existing attachment well");return i},C:function(){if(this.N()){var t=_a.d.b(_a.a.c,"AttachmentsFilePickerPanelOpen");_j.e.a(_a.a.c,"Opening OWA's file picker from group quick compose");this.V(t)}else{var n=this.j;n.f(!1,null,null)}},L:function(){this.j.L(!1)},V:function(n){if(this.r){var t=this;this.r.a(function(i){t.s=i;if(t.s){var r=t.D;t.s.a(t.j,n,!1,r.t||(r.t=Function.createDelegate(r,r.d)),null,!1,0)}})}},P:function(){if(this.i.M()&&this.t.a(this.o.a.Mailbox.EmailAddress,"DraftsForGroupAttachments"))if(this.i.I.bk.ItemId){this.K();this.j&&this.j.e(this.i.I.bk.ItemId,this.k,null)}else{var n=this.M();this.W(n,this.J,this.I,null)}else this.j.e(null,new _j.l,null)},M:function(){var i=null;if(this.i.K){var r=new _g.bv;r.IsSpecificMessageReply=this.i.Q?!0:!1;var n=new _mco.c(r,this.i.k().bk.ItemId,this.n,this.p);n.S=this.o.a.Mailbox.EmailAddress;n.bE(this.i.I);n.by=this.i.k().ef();n.bk=this.i.k().bk.ConversationId;n.bx=this.i.k().bk.InternetMessageId;n.bK=!0;i=n}else{var t=new _mco.a(this.i.I,null,this.n,this.p);t.S=this.o.a.Mailbox.EmailAddress;t.bK=!0;i=t}return i},W:function(n,t,i,r){t&&n.d(t);n.e(i);r&&n.b(r);this.x.a(n)},K:function(){this.k||(this.k=new _j.l)},T:function(n){this.h(n.F)},S:function(n){this.j&&this.j.N()},N:function(){return!!this.n&&!!this.q&&this.n.j(this.q.AttachmentDataProviderAvailable)&&this.i.M()}};_qc.i=function(){this.m=Function.createDelegate(this,this.q);this.l=Function.createDelegate(this,this.p);this.n=Function.createDelegate(this,this.r);_qc.i.resolveInheritance();this.d=this.dispose;_qc.i.initializeBase(this);this.k=new _j.g(this.n,_qc.i.a)};_qc.i.prototype={k:null,h:null,i:null,j:!1,a:function(){return this.k},e:function(){return this.i},s:function(n){if(n!==this.i){this.i=n;this.bs("DiscardConfirmDialogButtonData")}return n},f:function(){return this.j},g:function(n){if(n!==this.j){this.j=n;this.bs("IsDiscardConfirmDialogShown")}return n},b:function(n){this.bw("IsDiscardingCompose",n)},c:function(n){this.bH("IsDiscardingCompose",n)},bt:function(){_j.Q.prototype.bt.call(this)},r:function(){var t=this.o("QuickReplyMeSpaceShowDiscardDialog","QuickReplyWeSpaceShowDiscardDialog","QuickComposeWeSpaceShowDiscardDialog");var n=_a.d.b(_a.a.r,t);this.h.G("user chose to discard");if(!this.k.b){this.h.G("skip this discard since the discard command has been disabled.");n.k="CommandDisabled";_a.d.a(n);return}if(this.h.be()){this.h.G("calling discard directly without showing the dialog since this instance is empty.");n.j="Empty editor";_a.d.a(n);this.p()}else{this.t();this.h.G("show the discard dialog");this.g(!0);_a.d.a(n)}},p:function(){var t=this.o("QuickReplyMeSpaceDiscard","QuickReplyWeSpaceDiscard","QuickComposeWeSpaceDiscard");var n=_a.d.b(_a.a.r,t);this.h.G("perform the discard by resetting the editor, creating an initial state clone and disposing the current instance");this.q();this.h.L.f();this.h.bq();this.h.bh();this.h.dispose();_a.d.a(n);this.ci("IsDiscardingCompose")},q:function(){if(this.j){this.h.G("hide the dialog");this.g(!1)}},t:function(){if(!this.i){this.h.G("setup discard confirm dialog");var n=new _j.l;n.a(new _ff.d(new _j.g(this.l,_qc.i.a),_nbs.a.KM,_nbs.a.Zk,!0));n.a(new _ff.d(new _j.g(this.m,_qc.i.a),_nbs.a.nG,_nbs.a.ht));this.s(n)}},o:function(n,t,i){var r;r=this.h.M()&&this.h.K?t:!this.h.M()&&this.h.K?n:i;return r}};_qc.s=function(n,t,i){this.b=n;this.a=t;this.c=i};_qc.s.prototype={b:null,a:null,c:null,d:function(n,t){return new _qc.o(n,t,this.b,this.c,this.a)}};_qc.o=function(n,t,i,r,u){this.h=Function.createDelegate(this,this.o);this.l=Function.createDelegate(this,this.p);this.g=n;this.k=t;this.j=i;this.n=r;this.i=u;this.f=new _j.g(this.l,_qc.o.a);this.g.b(_qc.f,this.h)};_qc.o.prototype={g:null,k:!1,f:null,n:null,j:null,d:null,e:null,i:null,b:function(){return this.k},c:function(){return this.f},a:function(){this.g.c(_qc.f,this.h)},p:function(){this.d.G("starting to upconvert, disabling the command first");this.f.c(!1);var t=_a.d.b(_a.a.r,"QuickReplyUpConvertMeSpace");if(this.e){this.d.G("using existing mail compose context and calling upconvert");this.m()}else{this.d.G("starting to create the mail compose context");var n=this;this.j.a(function(t){n.d.G("creating the mail compose context and calling upconvert");n.e=t.a(!1,!1);n.m()})}_a.d.a(t);t=null},m:function(){var n=this.e;if(this.d.K){this.d.G("preparing mail compose context for reply all upconvert");n.d(2);n.K(this.d.k())}else{this.d.G("preparing mail compose context for new compose upconvert");n.d(0)}this.d.G("stamping body and attachments, updating message body with edtior content first");this.d.m();var f=this.d.I;var i=f.I();n.n(i.a());if(this.i.b())n.w(i.bk.Value);else{var t;var u,r;r=_a.x.a(i.bk.Value,u={val:t}),t=u.val,r;n.w(t)}n.g(!1);this.g.a(_qc.f,new _qc.f(n))},o:function(n){if(n.b&&n.c&&!this.f.b){this.e=n.a;var t;if(this.d.K){this.d.G("using the factory on original item part to create a conductor for reply all upconvert");t=this.d.U().cd()}else{this.d.G("creating a new conductor for new compose upconvert");t=new _y.bm}this.d.G("navigate to full compose");t.a(this.e);this.d.G("reset with an initial state clone after upconvert");this.d.bh();this.d.G("dispose the current instance after upconvert");this.d.dispose();this.f.c(!0)}}};_qc.B=function(){};_qc.B.prototype={a:function(){return new _j.j}};_qc.z=function(n,t,i,r,u,f,e,o,s,h,c){_qc.z.initializeBase(this,[n,t,r,u,f,e,s,h,c]);this.A=o;this.y=i};_qc.z.prototype={A:null,y:null,D:function(){return!1},S:function(n,t,i,r,u,f,e,o){var s=this.A.d(u,this.D());return this.y.a(n,t,i,r,s,this.C,f,e,o)}};_qc.r=function(n,t,i,r,u,f,e,o,s,h,c,l,a){_qc.r.initializeBase(this,[n,t,i,r,u,e,o,s,h,c,l,a]);_qc.o.isInstanceOfType(f)&&(f.d=this);this.bz(f)};_qc.r.prototype={X:null,bz:function(n){if(this.X!==n){this.X=n;this.bs("UpconvertComponent")}return n},M:function(){return!1},bt:function(){this.X.a();this.X=null;_qc.e.prototype.bt.call(this)}};_qc.y=function(n,t,i){_qc.y.initializeBase(this,[n,t,i])};_qc.y.prototype={a:function(n,t,i,r,u,f,e,o,s){return new _qc.r(n,t,i,r,new _qc.i,u,f,this.b,this.c,this.d,e,o,s)}};_qc.l=function(){};_qc.l.d=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_qc.l.f=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_qc.l.g=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-tp-b")};_qc.l.e=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nta-b")};_qc.l.a=function(){return _fm.b.a(_fm.a.h,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_qc.l.b=function(){return _fm.b.a(_fm.a.h,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_qc.l.c=function(){return _fm.b.a(_fm.a.h,_fm.WebfontSizes.a.g,"ms-fcl-tp-b")};_qc.b=function(n,t,i,r,u,f){this.bg=Function.createDelegate(this,this.cj);this.bk=Function.createDelegate(this,this.ck);this.e=Function.createDelegate(this,this.cf);this.be=Function.createDelegate(this,this.ce);this.bp=Function.createDelegate(this,this.cp);_qc.b.initializeBase(this,[n]);this.p=t;this.d=i;this.k=u;this.bu=f;this.c=r.a();this.y("QuickComposeView");this.x=new _j.g(this.bp,_qc.b.a);this.u=new _j.g(this.be,_qc.b.a);this.b=new _j.q;if(this.k){this.bC=this.k.a().m().Enabled;this.bJ=this.k.a().k().Enabled}};_qc.b.b=function(n,t){t?_j.k.a(n,_b.m.a(),""):_j.k.a(n,_b.m.a(),_b.m.c(0,-1e4))};_qc.b.prototype={p:null,d:null,k:null,bu:null,c:0,u:null,m:!1,s:!1,l:0,a:null,o:null,j:null,i:null,n:null,bb:null,bd:0,x:null,q:!1,f:!1,h:null,t:null,g:null,r:!1,b:null,bC:!1,bJ:!1,bK:function(n){if(this.m!==n){this.m=n;this.bs("IsShowingContent");if(this.m!==n)return n;if(this.d.b()&&!n&&this.a){_j.e.a(_qc.b.a,"iOS fix for soft keyboard not hidden when quick compose session is done.");this.a.z.blur()}if(!n){if(this.h){_j.e.a(_qc.b.a,"moving quick compose back to under the original parent at the end of this compose session");_j.k.w(this.h,this.z);this.bO()}this.n&&this.n.P()}}n&&this.bB();return n},cm:function(n){if(this.s!==n){this.s=n;this.bs("IsShowingContentCompleted")}n&&this.bB();return n},co:function(n){n!==this.bd&&(this.bd=n);return n},v:function(n){if(this.f!==n){this.f=n;this.bv("IsImmersive","IsTouchNarrowOrIsImmersiveInTouchLayout")}return n},cc:function(){var n=this.c;return n==="TouchNarrow"||this.f&&n!=="Mouse"},bZ:function(){return _qc.l.d()},ca:function(){return _qc.l.g()},bY:function(){return _qc.l.f()},bX:function(){return _qc.l.e()},bU:function(){return _qc.l.a()},bW:function(){return _qc.l.c()},bR:function(){return _qc.l.b()},cb:function(){return this.a&&!this.a.bo()&&this.a.z.offsetHeight>0?!0:!1},br:function(n){if(this.b){_qc.b.b(n,!1);this.b.c(n);var t=this;this.p.a(_qc.b.a,"Restore this element on timer",function(){t.bQ(n)},0)}},bQ:function(n){if(this.b){_qc.b.b(n,!0);this.b.n(n)}},bP:function(){if(this.b)for(var n=this.b.d.length-1;n>=0;n--){_qc.b.b(this.b.d[n],!0);this.b.i(n)}},I:function(){_j.c.prototype.I.call(this);if(this.C){this.a=this.C.a("Editor");this.o=this.C.a("SendButtonId");this.j=this.C.a("DiscardButtonId");this.i=this.C.a("AttachButtonId");this.n=this.C.a("PlaceholderButtonId");this.bb=this.C.a("ToReadWriteRecipientWellViewId")}else{this.a=null;this.o=null;this.j=null;this.i=null;this.n=null;this.bb=null}},G:function(){_j.c.prototype.G.call(this);if(!this.q){if(this.d.b()){this.o.cH().bind("touchend",this.e);this.j.cH().bind("touchend",this.e);this.i.cH().bind("touchend",this.e)}else this.d.a()&&this.c==="Mouse"&&_j.k.b(this.a.z,"click",this.bk);this.q=!0}},bt:function(){if(this.q){if(this.d.b()){this.o.cH().unbind("touchend",this.e);this.j.cH().unbind("touchend",this.e);this.i.cH().unbind("touchend",this.e)}else this.d.a()&&this.c==="Mouse"&&_j.k.c(this.a.z,"click");this.q=!1}this.a=null;this.b=null;_j.c.prototype.bt.call(this)},w:function(n){this.t.style.height=String.format("{0}px",n)},cp:function(){this.bK(!0)},cf:function(n){_j.e.a(_qc.b.a,"user touched button, blur the editor to make the soft keyboard go away in iOS");this.a.z.blur()},cj:function(n){var t=this;this.p.a(_qc.b.a,"Store scroll buffer's original height",function(){t.w(10)},500);_j.k.c(this.a.z,"blur")},ck:function(n){_j.e.a(_qc.b.a,"Editor clicked.");this.a.P()},ce:function(){_j.e.a(_qc.b.a,"Preventing BACKSPACE/DELETE keys from deleting the conversation, HOME/END/UP/DOWN keys from navigating away in list view while in the quick compose view")},bB:function(){_j.e.a(_qc.b.a,"setting focus to the editor and scroll compose into view");if(this.c==="Mouse")this.z.scrollIntoView(!1);else if(!this.f&&this.cb()&&!this.r&&_j.k.e(this.t)>0){this.br(this.h);var i=this.g.c();this.a.P();this.g.b(i);_j.k.b(this.a.z,"blur",this.bg);var t=this;this.p.a(_qc.b.a,"Scroll quick compose editor to the top",function(){t.bP();t.cl()},500);this.r=!0}if((this.f||this.c==="Mouse")&&this.a){this.a.P();if(this.d.f()){var n=this.a.z;n.innerHTML=n.innerHTML+"&#8203;";n.innerHTML=""}}},bO:function(){this.w(10);this.r=!1;this.l=0},cl:function(){var n;n=this.l?this.l+this.z.offsetTop:this.h.offsetTop;this.c==="TouchNarrow"&&(n-=20);n>this.g.c()&&this.w(n-this.g.c());this.g.b(n)}};_qc.g=function(n,t){this.g=Function.createDelegate(this,this.o);this.h=Function.createDelegate(this,this.t);this.k=Function.createDelegate(this,this.q);this.l=Function.createDelegate(this,this.r);_qc.g.initializeBase(this,[n]);this.y("InlineComposeView");this.j=new _j.g(this.l,_qc.g.a);this.n=t};_qc.g.prototype={n:null,f:null,a:null,e:!1,d:null,j:null,i:!1,s:function(n){if(n!==this.f){this.f=n;this.f.e(this);this.bs("ScrollManager")}return n},p:function(n){if(this.e!==n){this.e=n;this.bs("IsConductorShowingCompose");if(!n&&this.d){_j.e.a(_qc.g.a,"moving inline compose back to under the original parent at the end of this compose session");this.d.appendChild(this.z)}}return n},c:!1,b:!1,I:function(){_j.c.prototype.I.call(this);if(this.C){this.a=this.C.a("Conductor");this.a.dS(this.h);this.a.apcl("CurrentConductableView",this.g);this.d=this.X.z}else{this.m();this.d=null}},bt:function(){this.m();_j.c.prototype.bt.call(this)},t:function(n){var t=this.W();if(t){this.p(!1);t.l();this.o(null,null)}},q:function(n,t,i){return new _ff.h(1e4,1e4,4)},o:function(n,t){if(!this.e&&this.i&&this.a.a){var i=this.a.a.a().z;i.style.display="none"}},m:function(){if(this.a){this.a.go(this.h);this.a.rpcl("CurrentConductableView",this.g);this.a=null}},r:function(){_j.e.a(_qc.g.a,"Preventing HOME/END/UP/DOWN keys from navigating away in list view while in the inline compose view")}};_qc.k=function(n){_qc.k.initializeBase(this,[n]);this.y("QuickReplyViewWrapper")};_qc.k.prototype={a:null,b:null,c:null,I:function(){_j.c.prototype.I.call(this);if(this.C){this.a=this.C.a("QuickReplyViewId");this.b=this.C.a("QuickReplyScrollBufferRegionId");this.a.h=this.z;this.a.t=this.b.z;this.a.g=this.c}else{this.a=null;this.b=null}}};_qc.a=function(){};_qc.a.$$cctor=function(){_qc.a._I()};_qc.a.bj=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_qc_2 ms-bg-color-white ms-border-color-neutralLight'></span> </div><div> <div class='_qc_d'></div> <div autoid=\"_qc_2\" class='_qc_e'></div> </div><div>  <div class='_qc_b ms-font-weight-semibold ms-font-color-neutralSecondary ms-bg-color-white ms-border-color-neutralLight'></div>  <div class='_qc_c ms-border-color-neutralLight'></div> </div><div> <span class='_qc_r'></span> <span class='_qc_s'></span> </div><div> <div class='_qc_t customScrollBar'> <div class='_qc_u ms-font-weight-regular ms-font-color-neutralPrimary'></div> </div> </div><div>  <div class='_qc_8'></div>  <div tabindex='-1' class='_qc_9 ms-border-color-neutralLight'>   <button autoid=\"_qc_0\" type='button' class='_qc_g ms-font-weight-semilight ms-font-color-themePrimary'></button>  <div> <div>  <div class='_qc_b ms-font-weight-semibold ms-font-color-neutralSecondary ms-bg-color-white ms-border-color-neutralLight'> <div class='_qc_d'></div> <div autoid=\"_qc_1\" class='_qc_e'></div> </div>  <div class='_qc_c ms-border-color-neutralLight'></div> </div> <div></div>  <div autoid=\"_qc_3\" class='_qc_q ms-bg-color-white ms-bg-color-white-hover'></div>  <div autoid=\"_qc_4\"></div>  <div autoid=\"_qc_5\" class='_qc_h ms-bg-color-white'></div>   <div autoid=\"_qc_6\" class='_qc_j ms-border-color-neutralLight'> <button autoid=\"_qc_7\" type='button' class='_qc_k _qc_n'></button> <button autoid=\"_qc_8\" type='button' class='_qc_k _qc_o'></button>  <button autoid=\"_qc_9\" type='button' class='_qc_p'></button> <button autoid=\"_qc_a\" type='button' class='_qc_p'></button> </div> </div>  </div>   <div></div> </div><div> <div class='_qc_x'></div> </div><div> <div></div> </div><div>  <div></div>  <div tabindex='-1' class='_qc_y ms-border-color-neutralLight'>  <div class='_qc_A ms-border-color-neutralLight'></div> </div>  <div></div> </div><div> <div class='_qc_D ms-bg-color-white'></div> </div><div> <div class='_qc_B ms-bg-color-white'></div>   </div><div> <div class='_qc_E ms-bg-color-white'></div> </div><div> <button autoid=\"_qc_b\" type='button' class='_qc_G ms-font-weight-semilight ms-font-color-themePrimary'></button> <div class='_qc_K'> <span class='_qc_H'></span> <div class='_qc_I'> <button type='button' class='_qc_J ms-font-weight-regular ms-font-color-neutralSecondary ms-bg-color-neutralLighter ms-font-color-neutralPrimary-hover ms-bg-color-neutralLight-hover'></button> </div> </div> </div><div> <span class='_qc_M ms-bg-color-white ms-border-color-neutralLight'></span> </div><div> <div class='_qc_T ms-bg-color-white'></div>  <div></div> </div><div> <div class='_qc_S'></div> </div><div> <div class='_qc_U'> <div></div> </div> </div><div> <div class='_qc_V'></div> <div class='_qc_W'></div> </div>";_j.h.a().appendChild(n);return n};_qc.a.bh=function(n){return n.n()};_qc.a.O=function(n){return n.rX()};_qc.a.bX=function(n){return n.f()};_qc.a.bY=function(n){return n.g()};_qc.a.b=function(n){return n.a()};_qc.a.h=function(n){return n.d()};_qc.a.bQ=function(n){return n.c()};_qc.a.w=function(n){return n.h()};_qc.a.i=function(n){return n.g()};_qc.a.m=function(n){return n.a()};_qc.a.l=function(n){return n.o()};_qc.a.bJ=function(n){return n.f};_qc.a.u=function(n){return n.h()};_qc.a.be=function(n){return n.a()};_qc.a.v=function(n){return n.a()};_qc.a.bT=function(n){return n.f()};_qc.a.bU=function(n){return n.g()};_qc.a.bg=function(n){return n.a()};_qc.a.c=function(n){return n.X};_qc.a.n=function(n){return n.u};_qc.a.bS=function(n){return n.i()};_qc.a.bu=function(n){return n.z()};_qc.a.q=function(n){return n.m};_qc.a.ba=function(n){return _qc.b.isInstanceOfType(n)?n.x:null};_qc.a.bo=function(n){return n.X};_qc.a.bf=function(n){return n.b()};_qc.a.bR=function(n){return n.a()};_qc.a.bt=function(n){return n.w()};_qc.a.br=function(n){return n.j};_qc.a.bK=function(n){return n.cc()};_qc.a.U=function(n){return _qc.r.isInstanceOfType(n)?n.X:null};_qc.a.bV=function(n){return n.b()};_qc.a.bW=function(n){return n.c()};_qc.a.Y=function(n){return n.bU()};_qc.a.bD=function(n){return n.bR()};_qc.a.bE=function(n){return n.bW()};_qc.a.bM=function(n){return n.b()};_qc.a.bH=function(n){return n.bZ()};_qc.a.bF=function(n){return n.bX()};_qc.a.bG=function(n){return n.bY()};_qc.a.bI=function(n){return n.ca()};_qc.a.bN=function(n){return n.e()};_qc.a.bO=function(n){return n.f()};_qc.a.bk=function(n){return n.c()};_qc.a.B=function(n){return n.y};_qc.a.X=function(n){return n.c};_qc.a.bA=function(n){return n.b};_qc.a.k=function(n){return n.j};_qc.a.bw=function(n){return n.u};_qc.a.bc=function(n){return n.a()};_qc.a.bB=function(n){return n.k};_qc.a.H=function(n){return n.c()};_qc.a.D=function(n){return n.e};_qc.a.bd=function(n){return n.k()};_qc.a.bL=function(n){return n.f()};_qc.a.T=function(n){return n.s()};_qc.a.S=function(n){return n.o()};_qc.a.R=function(n){return n.r()};_qc.a.C=function(n){return n.b};_qc.a.bz=function(n){return n.t()};_qc.a.bx=function(n){return n.Y()};_qc.a.by=function(n){return n.Z()};_qc.a.z=function(n){return n.j()};_qc.a.V=function(n){return _qc.e.isInstanceOfType(n)?n.bj:null};_qc.a.Z=function(n){return n.s};_qc.a.y=function(n,t){n.a(t)};_qc.a.p=function(n,t){n.ba(t)};_qc.a.P=function(n,t){n.Q(t)};_qc.a.f=function(n,t){n.J(t)};_qc.a.bn=function(n,t){n.a(t)};_qc.a.e=function(n,t){n.k=t};_qc.a.bm=function(n,t){n.m=t};_qc.a.o=function(n,t){n.k(t)};_qc.a.j=function(n,t){n.T(t)};_qc.a.bv=function(n,t){n.A(t)};_qc.a.bs=function(n,t){n.h(t)};_qc.a.Q=function(n,t){n.bn(t)};_qc.a.L=function(n,t){n.l(t)};_qc.a.J=function(n,t){n.x(t)};_qc.a.K=function(n,t){n.m(t)};_qc.a.N=function(n,t){n.s(t)};_qc.a.bq=function(n,t){n.d(t)};_qc.a.bp=function(n,t){n.j(t)};_qc.a.bP=function(n,t){n.g(t)};_qc.a.bl=function(n,t){n.a(t)};_qc.a.ca=function(n,t){n.b(t)};_qc.a.bZ=function(n,t){n.c(t)};_qc.a.cb=function(n,t){n.g=t};_qc.a.I=function(n,t){n.n(t)};_qc.a.E=function(n,t){n.p(t)};_qc.a.bC=function(n,t){n.s(t)};_qc.a.M=function(n,t){n.p(t)};_qc.a.G=function(n,t){n.co(t)};_qc.a.A=function(n,t){n.c(t)};_qc.a.F=function(n,t){n.bK(t)};_qc.a.W=function(n,t){n.bx(t)};_qc.a.bb=function(n,t){n.cm(t)};_qc.a.g=function(){_qc.a.r||(_qc.a.r=new _fc.k);return _qc.a.r};_qc.a.bi=function(){_qc.a.t||(_qc.a.t=new _b.ba);return _qc.a.t};_qc.a.x=function(){_qc.a.s||(_qc.a.s=new _fce.t);return _qc.a.s};_qc.a._I=function(){var c="NotchView";new _j.d(c,function(){_qc.a.a[c]===undefined&&(_qc.a.a[c]=[[[-1,5,["IsReply"],[_qc.a.bh],null,"_qc_3",null,null,0,null,null,null],[-1,5,["IsHtml5BaselineSupported"],[_qc.a.O],null,"_qc_4:_qc_6",null,null,1,null,null,null],[-1,5,["IsHtml5Reply"],[_qc.a.bX],null,"_qc_5",null,null,0,null,null,null],[-1,5,["IsNonHtml5Reply"],[_qc.a.bY],null,"_qc_7",null,null,0,null,null,null]]]);var n=_qc.a.d.childNodes[0].cloneNode(!0);var t=new _j.h(n.children[0]);return new _j.a(n,[t])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_qc.a.a);var l="QuickComposeView._tid2._tid3";new _j.d(l,function(){_qc.a.a[l]===undefined&&(_qc.a.a[l]=[[[-1,4,null,null,null,"Text",null,_qc.a.y,0,null,null,null,_nbs.a.Rb]],[[-1,4,null,null,null,"AriaLabel",null,_qc.a.P,0,null,null,null,_nbs.a.oZ],[-1,0,["Context","RecipientComponent","ReadOnlyRecipientWellViewModel"],[_qc.a.b,_qc.a.h,_qc.a.bQ],null,"DataContext",null,_qc.a.p,1,null,null,null]]]);var n=_qc.a.d.childNodes[1].cloneNode(!0);var t=new _j.c(n.children[1]);t.y("ReadOnlyRecipientWellView");var i=new _b.Q(n.children[0]);return new _j.a(n,[i,t])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var s="QuickComposeView._tid2";new _j.d(s,function(){_qc.a.a[s]===undefined&&(_qc.a.a[s]=[[[-1,0,["Context","RecipientComponent","IsRecipientWellNull"],[_qc.a.b,_qc.a.h,_qc.a.w],null,"IsHidden",null,_qc.a.f,1,null,null,!0]],[[-1,0,["Context","RecipientComponent","IsRecipientWellNull"],[_qc.a.b,_qc.a.h,_qc.a.w],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]]]);var n=_qc.a.d.childNodes[2].cloneNode(!0);var i=new _j.c(n.children[1]);var t=new _j.c(n.children[0]);t.y("QuickComposeView._tid2._tid3");return new _j.a(n,[t,i])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var h="QuickComposeView._tid4";new _j.d(h,function(){_qc.a.a[h]===undefined&&(_qc.a.a[h]=[[[-1,0,["Context","AttachmentComponent","AttachmentWellViewModel","VisibleCount"],[_qc.a.b,_qc.a.i,_qc.a.m,_qc.a.l],null,"Text",null,_qc.a.y,1,_qc.a.bi(),null,null]],[[-1,4,null,null,null,"Id",null,_qc.a.bn,0,null,null,null,_n.b.g()]]]);var n=_qc.a.d.childNodes[3].cloneNode(!0);var i=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var y="QuickComposeView._tid5";new _j.d(y,function(){_qc.a.a[y]===undefined&&(_qc.a.a[y]=[[[-1,0,["Context","AttachmentComponent","AttachmentWellViewModel"],[_qc.a.b,_qc.a.i,_qc.a.m],null,"DataContext",null,_qc.a.p,1,null,null,null],[0,5,["VisibleCount"],[_qc.a.l],null,"_qc_v",null,null,0,_qc.a.x(),null,null]]]);var t=_qc.a.d.childNodes[4].cloneNode(!0);var n=new _j.c(_j.a.a(t,[0,0]));n.y("AttachmentWellViewWrapper");n.K(!0);return new _j.a(t,[n])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var p="QuickComposeView";new _j.d(p,function(){_qc.a.a[p]===undefined&&(_qc.a.a[p]=[[[-1,1,["IsImmersive"],[_qc.a.bJ],null,"IsHidden",null,_qc.a.f,1,null,null,!0]],[[-1,5,["IsReply"],[_qc.a.bh],null,"_qc_a",null,null,0,null,null,null]],[[-1,1,["IsShowingContent"],[_qc.a.q],null,"IsHidden",null,_qc.a.f,1,null,null,!0],[-1,1,["ShowContentCommand"],[_qc.a.ba],null,"ClickCommand",null,_qc.a.j,1,null,null,null],[-1,0,["Context","PlaceHolderText"],[_qc.a.b,_qc.a.bu],null,"Text",null,_qc.a.o,1,null,null,null]],[[-1,1,["IsShowingContent"],[_qc.a.q],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]],[[-1,0,["Context","RecipientComponent","IsReadWrite"],[_qc.a.b,_qc.a.h,_qc.a.bf],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]],[[-1,0,["Context","RecipientComponent","IsRecipientWellNull"],[_qc.a.b,_qc.a.h,_qc.a.w],null,"IsHidden",null,_qc.a.f,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_qc.a.y,0,null,null,null,_nbs.a.Rb]],[[-1,4,null,null,null,"AriaLabel",null,_qc.a.P,0,null,null,null,_nbs.a.cH],[-1,0,["Context","RecipientComponent","ReadWriteRecipientWellViewModel"],[_qc.a.b,_qc.a.h,_qc.a.bR],null,"DataContext",null,_qc.a.p,1,null,null,null]],[[-1,0,["Context","RecipientComponent","IsRecipientWellNull"],[_qc.a.b,_qc.a.h,_qc.a.w],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]],[[-1,0,["Context","RecipientComponent","IsReadWrite"],[_qc.a.b,_qc.a.h,_qc.a.bf],null,"IsHidden",null,_qc.a.f,1,null,null,!0]],[[-1,0,["Context","EditorCallContext"],[_qc.a.b,_qc.a.bt],_qc.a.bv,"CallContext",_qc.a.br,_qc.a.bs,2,null,null,null]],[[-1,0,["Context","AttachmentComponent","AttachmentWellViewModel","VisibleCount"],[_qc.a.b,_qc.a.i,_qc.a.m,_qc.a.l],null,"IsHidden",null,_qc.a.f,1,_qc.a.x(),null,!0]],[[-1,5,["Context","AttachmentComponent","AttachmentWellViewModel","VisibleCount"],[_qc.a.b,_qc.a.i,_qc.a.m,_qc.a.l],null,"_qc_w",null,null,0,_qc.a.x(),null,null]],[[-1,1,["IsTouchNarrowOrIsImmersiveInTouchLayout"],[_qc.a.bK],null,"IsHidden",null,_qc.a.f,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_qc.a.o,0,null,null,null,_nbs.a.mc],[-1,0,["Context","SendComponent","SendCommand"],[_qc.a.b,_qc.a.v,_qc.a.bg],null,"ClickCommand",null,_qc.a.j,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_qc.a.o,0,null,null,null,_nbs.a.UH],[-1,0,["Context","DiscardComponent","DiscardCommand"],[_qc.a.b,_qc.a.u,_qc.a.be],null,"ClickCommand",null,_qc.a.j,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_qc.a.Q,0,null,null,null,_nbs.a.Bh],[-1,1,["AffordanceImageId"],[_qc.a.Y],null,"ImageId",null,_qc.a.L,0,null,null,null],[-1,1,["AffordanceImageId"],[_qc.a.Y],null,"DisabledImageId",null,_qc.a.J,0,null,null,null],[-1,1,["AffordanceHoverImageId"],[_qc.a.bD],null,"HoveredImageId",null,_qc.a.K,0,null,null,null],[-1,1,["AffordancePressedImageId"],[_qc.a.bE],null,"PressedImageId",null,_qc.a.N,0,null,null,null],[-1,0,["Context","UpconvertComponent","ShouldHideUpconvertButton"],[_qc.a.b,_qc.a.U,_qc.a.bV],null,"IsHidden",null,_qc.a.f,1,null,null,!0],[-1,0,["Context","UpconvertComponent","UpconvertCommand"],[_qc.a.b,_qc.a.U,_qc.a.bW],null,"ClickCommand",null,_qc.a.j,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_qc.a.Q,0,null,null,null,_nbs.a.FC],[-1,1,["AttachImageId"],[_qc.a.bH],null,"ImageId",null,_qc.a.L,0,null,null,null],[-1,1,["AttachDisabledImageId"],[_qc.a.bF],null,"DisabledImageId",null,_qc.a.J,0,null,null,null],[-1,1,["AttachHoverImageId"],[_qc.a.bG],null,"HoveredImageId",null,_qc.a.K,0,null,null,null],[-1,1,["AttachPressedImageId"],[_qc.a.bI],null,"PressedImageId",null,_qc.a.N,0,null,null,null],[-1,0,["Context","AttachmentComponent","AttachCommand"],[_qc.a.b,_qc.a.i,_qc.a.bM],null,"ClickCommand",null,_qc.a.j,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_qc.a.bq,0,null,null,null,_nbs.a.gv],[-1,0,["Context","DiscardComponent","DiscardConfirmDialogButtonData"],[_qc.a.b,_qc.a.u,_qc.a.bN],null,"ButtonDataList",null,_qc.a.bp,1,null,null,null],[-1,0,["Context","DiscardComponent","IsDiscardConfirmDialogShown"],[_qc.a.b,_qc.a.u,_qc.a.bO],_qc.a.bP,"IsShown",_qc.a.bk,_qc.a.bl,2,null,null,!1]]]);var n=_qc.a.d.childNodes[5].cloneNode(!0);var it=new _b.n(n.children[2],_j.b.Instance.a(_y.a),_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.b));it.g(!1);var rt=new _fc.b(_j.a.a(n,[1,1,5,3]));var et=new _fc.b(_j.a.a(n,[1,1,5,2]));var t=new _fc.b(_j.a.a(n,[1,1,5,1]));t.c("ms-font-color-black ms-bg-color-neutralLight ms-border-color-neutralLight");t.d("ms-font-color-white ms-bg-color-themePrimary ms-border-color-themePrimary");t.g("ms-font-color-neutralTertiary ms-bg-color-neutralLighter ms-border-color-neutralLighter");t.h("_qc_m ms-fwt-sb ms-font-color-neutralPrimary");t.f("ms-bg-color-neutralLighter ms-border-color-neutralLighter");var i=new _fc.b(_j.a.a(n,[1,1,5,0]));i.c("ms-bg-color-themeDark ms-border-color-themeDark");i.d("ms-bg-color-themePrimary ms-border-color-themePrimary");i.g("ms-font-color-neutralTertiary ms-bg-color-neutralLighter ms-border-color-neutralLighter");i.h("_qc_l ms-fwt-sb ms-font-color-white");i.f("ms-bg-color-themePrimary ms-border-color-themePrimary");var lt=new _j.h(_j.a.a(n,[1,1,5]));var tt=new _j.c(_j.a.a(n,[1,1,4]));tt.y("QuickComposeView._tid5");var g=new _j.c(_j.a.a(n,[1,1,3]));g.y("QuickComposeView._tid4");var nt=new _cmc.m(_j.a.a(n,[1,1,2]),_j.b.Instance.a(_j.o),_j.b.Instance.a(_g.e),_j.b.Instance.a(_ff.b));var ut=new _j.c(_j.a.a(n,[1,1,1]));ut.y("QuickComposeView._tid2");var ct=new _j.c(_j.a.a(n,[1,1,0,1]));var w=new _j.c(_j.a.a(n,[1,1,0,0,1]));w.y("ReadWriteRecipientWellView");var ht=new _b.Q(_j.a.a(n,[1,1,0,0,0]));var at=new _j.h(_j.a.a(n,[1,1,0,0]));var ot=new _j.h(_j.a.a(n,[1,1,0]));var st=new _j.h(_j.a.a(n,[1,1]));var v=new _fc.b(_j.a.a(n,[1,0]));var d=new _fc.g;var a=new _fc.c;a.V(_j.f.a(["AttachedControl","ShowContentCommand"],[_qc.a.bo,_qc.a.ba],null,"Command",null,_qc.a.e,1));a.i("ENTER");d.a([a]);v.D([d]);var k=new _j.h(n.children[1]);var b=new _fc.g;var y=new _fc.c;y.U(_j.f.a(["Context","DiscardComponent","DiscardCommand"],[_qc.a.b,_qc.a.u,_qc.a.be],null,"Command",null,_qc.a.e,1));y.i("ESC");var h=new _fc.c;h.U(_j.f.a(["Context","SendComponent","AltSSendCommand"],[_qc.a.b,_qc.a.v,_qc.a.bT],null,"Command",null,_qc.a.e,1)).U(_j.f.a(["Context","SendComponent","DoesSupportAltSForSend"],[_qc.a.b,_qc.a.v,_qc.a.bU],null,"PreventDefault",null,_qc.a.bm,1,null,null,!1));h.i("S");h.j=4;var c=new _fc.c;c.U(_j.f.a(["Context","SendComponent","SendCommand"],[_qc.a.b,_qc.a.v,_qc.a.bg],null,"Command",null,_qc.a.e,1));c.i("ENTER");c.j=2;var u=new _fc.c;u.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));u.i("BACKSPACE");u.l=!0;u.m=!1;var r=new _fc.c;r.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));r.i("DELETE");r.l=!0;r.m=!1;var f=new _fc.c;f.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));f.i("HOME");f.l=!0;f.m=!1;var e=new _fc.c;e.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));e.i("END");e.l=!0;e.m=!1;var s=new _fc.c;s.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));s.i("UPARROW");s.l=!0;s.m=!1;var o=new _fc.c;o.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.n],null,"Command",null,_qc.a.e,1));o.i("DOWNARROW");o.l=!0;o.m=!1;var l=new _fc.c;l.U(_j.f.a(["Context","RecipientComponent","ResolveCommand"],[_qc.a.b,_qc.a.h,_qc.a.bS],null,"Command",null,_qc.a.e,1));l.i("K");l.j=2;b.a([y,h,c,u,r,f,e,s,o,l]);k.D([b]);var ft=new _j.c(n.children[0]);ft.y("NotchView");return new _j.a(n,[ft,k,v,st,ot,at,ht,w,ct,ut,nt,g,tt,lt,i,t,et,rt,it]).l({PlaceholderButtonId:v,ToReadWriteRecipientWellViewId:w,Editor:nt,SendButtonId:i,DiscardButtonId:t,AttachButtonId:rt})},"",IQuickComposeViewModel,_qc.b,function(n){return new _qc.b(n,_j.b.Instance.a(_j.u),_j.b.Instance.a(_j.o),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j))},!1,!1,!1,0,_qc.a.a);var a="InlineComposeView._tid6";new _j.d(a,function(){_qc.a.a[a]===undefined&&(_qc.a.a[a]=[[[-1,0,["IsReply"],[_qc.a.B],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]]]);var t=_qc.a.d.childNodes[6].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("InlineComposeNotchView");return new _j.a(t,[n])},"",_qc.h,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var v="InlineComposeView._tid7";new _j.d(v,function(){_qc.a.a[v]===undefined&&(_qc.a.a[v]=[[[-1,0,["IsReply"],[_qc.a.B],null,"IsHidden",null,_qc.a.f,1,null,null,!0]]]);var t=_qc.a.d.childNodes[7].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("InlineComposeNotchView");return new _j.a(t,[n])},"",_qc.h,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_qc.a.a);var i="InlineComposeView";new _j.d(i,function(){_qc.a.a[i]===undefined&&(_qc.a.a[i]=[[[-1,1,["ShouldShowNotch"],[_qc.a.X],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]],[[-1,5,["ShouldShowBorder"],[_qc.a.bA],null,"_qc_z",null,null,1,_qc.a.g(),null,null]],[[-1,1,["TransitionProvider"],[_qc.a.bB],null,"TransitionProvider",null,_qc.a.cb,0,null,null,null],[-1,0,["Conductor"],[_qc.a.bw],null,"DataContext",null,_qc.a.p,1,null,null,null],[0,0,["ActiveNavigationStack"],[_qc.a.bc],null,"ActiveNavigationStack",null,_qc.a.ca,1,null,null,null],[0,0,["ActiveNavigationStack"],[_qc.a.bc],null,"ActiveItems",null,_qc.a.bZ,1,null,null,null]],[[-1,1,["ShouldShowNotch"],[_qc.a.X],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0]]]);var o=_qc.a.d.childNodes[8].cloneNode(!0);var h=new _j.c(o.children[2]);h.y("InlineComposeView._tid7");var a=new _n.g(_j.a.a(o,[1,0]),_j.b.Instance.a(_n.f),_j.b.Instance.a(_b.a));var l=new _j.h(o.children[1]);var v=new _fc.g;var e=new _fc.c;e.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));e.i("HOME");e.l=!0;e.m=!1;var t=new _fc.c;t.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));t.i("END");t.l=!0;t.m=!1;var n=new _fc.c;n.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));n.i("UPARROW");n.l=!0;n.m=!1;var r=new _fc.c;r.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));r.i("DOWNARROW");r.l=!0;r.m=!1;var s=new _fc.c;s.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));s.i("R");s.m=!1;var f=new _fc.c;f.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));f.i("R");f.j=1;f.m=!1;var u=new _fc.c;u.V(_j.f.a(["ContextParent","ContextParent","PreventBubblingCommand"],[_qc.a.c,_qc.a.c,_qc.a.k],null,"Command",null,_qc.a.e,1));u.i("F");u.j=1;u.m=!1;v.a([e,t,n,r,s,f,u]);l.D([v]);var c=new _j.c(o.children[0]);c.y("InlineComposeView._tid6");return new _j.a(o,[c,l,a,h]).l({Conductor:a})},"",_qc.h,_qc.g,function(n){return new _qc.g(n,_j.b.Instance.a(_j.j))},!0,!1,!1,0,_qc.a.a);var r="InlineComposeViewWrapper.GroupReplyWrapper";new _j.d(r,function(){_qc.a.a[r]===undefined&&(_qc.a.a[r]=[[[-1,0,["IsShowingCompose"],[_qc.a.H],_qc.a.I,"IsConductorShowingCompose",_qc.a.D,_qc.a.E,2,null,null,!1]]]);var t=_qc.a.d.childNodes[9].cloneNode(!0);var n=new _qc.g(t.children[0],_j.b.Instance.a(_j.j));n.c=!1;n.b=!1;return new _j.a(t,[n])},"",IInlineComposeConductorViewModel,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_qc.a.a);var n="InlineComposeViewWrapper";new _j.d(n,function(){_qc.a.a[n]===undefined&&(_qc.a.a[n]=[[[-1,0,["IsShowingCompose"],[_qc.a.H],_qc.a.I,"IsConductorShowingCompose",_qc.a.D,_qc.a.E,2,null,null,!1],[-1,5,["IsReply"],[_qc.a.bd],null,"_qc_C",null,null,0,null,null,null]]]);var i=_qc.a.d.childNodes[10].cloneNode(!0);var t=new _qc.g(i.children[0],_j.b.Instance.a(_j.j));t.c=!0;t.b=!0;return new _j.a(i,[t])},"",IInlineComposeConductorViewModel,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_qc.a.a);var t="InlineComposeEmptyPlaceholderViewWrapper";new _j.d(t,function(){_qc.a.a[t]===undefined&&(_qc.a.a[t]=[[[-1,0,["ScrollManager"],[_qc.a.bL],null,"ScrollManager",null,_qc.a.bC,1,null,null,null],[-1,0,["IsShowingCompose"],[_qc.a.H],_qc.a.I,"IsConductorShowingCompose",_qc.a.D,_qc.a.E,2,null,null,!1],[-1,5,["IsReply"],[_qc.a.bd],null,"_qc_F",null,null,0,null,null,null]]]);var i=_qc.a.d.childNodes[11].cloneNode(!0);var n=new _qc.g(i.children[0],_j.b.Instance.a(_j.j));n.i=!0;n.c=!1;n.b=!1;return new _j.a(i,[n])},"",IInlineComposeConductorViewModel,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_qc.a.a);var e="InlineComposePlaceholderView";new _j.d(e,function(){_qc.a.a[e]===undefined&&(_qc.a.a[e]=[[[-1,0,["ShouldShowPlaceholderWithPhoto"],[_qc.a.T],null,"IsHidden",null,_qc.a.f,1,null,null,!0],[-1,0,["PlaceholderText"],[_qc.a.S],null,"Text",null,_qc.a.o,1,null,null,null],[-1,0,["ComposeCommand"],[_qc.a.R],null,"ClickCommand",null,_qc.a.j,1,null,null,null],[-1,0,["ButtonEnabled"],[_qc.a.C],null,"IsEnabled",null,_qc.a.M,1,null,null,!1]],[[-1,0,["ShouldShowPlaceholderWithPhoto"],[_qc.a.T],null,"IsHidden",null,_qc.a.f,1,_qc.a.g(),null,!0],[-1,5,["ButtonEnabled"],[_qc.a.C],null,"_qc_L",null,null,0,_qc.a.g(),null,null]],[[-1,0,["UserPersonaViewModel"],[_qc.a.bz],null,"DataContext",null,_qc.a.p,1,null,null,null]],[[-1,0,["PlaceholderText"],[_qc.a.S],null,"Text",null,_qc.a.o,1,null,null,null],[-1,0,["ComposeCommand"],[_qc.a.R],null,"ClickCommand",null,_qc.a.j,1,null,null,null],[-1,0,["ButtonEnabled"],[_qc.a.C],null,"IsEnabled",null,_qc.a.M,1,null,null,!1]]]);var n=_qc.a.d.childNodes[12].cloneNode(!0);var r=new _fc.b(_j.a.a(n,[1,1,0]));r.g("ms-font-color-neutralSecondary-hover ms-bg-color-neutralLighter-hover");var i=new _pe.d(_j.a.a(n,[1,0]),_j.b.Instance.a(_a.q));i.y("PersonaView.DisplayPictureNoMargin");var u=new _j.h(n.children[1]);var t=new _fc.b(n.children[0]);t.g("ms-font-color-neutralTertiary ms-border-color-neutralLighter");return new _j.a(n,[t,u,i,r])},"",_qc.p,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_qc.a.a);var o="InlineComposeNotchView";new _j.d(o,function(){_qc.a.a[o]===undefined&&(_qc.a.a[o]=[[[-1,5,["IsReply"],[_qc.a.B],null,"_qc_N",null,null,0,null,null,null],[-1,5,["IsHtml5BaselineSupported"],[_qc.a.O],null,"_qc_O:_qc_Q",null,null,1,null,null,null],[-1,5,["IsHtml5Reply"],[_qc.a.bx],null,"_qc_P",null,null,0,null,null,null],[-1,5,["IsNonHtml5Reply"],[_qc.a.by],null,"_qc_R",null,null,0,null,null,null]]]);var n=_qc.a.d.childNodes[13].cloneNode(!0);var t=new _j.h(n.children[0]);return new _j.a(n,[t])},"",_qc.h,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_qc.a.a);var u="QuickComposeViewWrapper";new _j.d(u,function(){_qc.a.a[u]===undefined&&(_qc.a.a[u]=[null,[[-1,0,["Context","AttachmentComponent","AttachmentWellViewModel","VisibleCount"],[_qc.a.b,_qc.a.i,_qc.a.m,_qc.a.l],null,"VisibleAttachmentCount",null,_qc.a.G,1,null,null,0],[-1,0,["Context","IsInEditMode"],[_qc.a.b,_qc.a.z],_qc.a.A,"IsShowingContent",_qc.a.q,_qc.a.F,2,null,null,!1],[-1,0,["Context","IsInEditModeCompleted"],[_qc.a.b,_qc.a.V],_qc.a.W,"IsShowingContentCompleted",_qc.a.Z,_qc.a.bb,2,null,null,!1]]]);var n=_qc.a.d.childNodes[16].cloneNode(!0);var t=new _qc.b(_j.a.a(n,[0,0]),_j.b.Instance.a(_j.u),_j.b.Instance.a(_j.o),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j));t.v(!0);var i=new _fce.g(n.children[0],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));return new _j.a(n,[i,t])},"",IQuickComposeViewModel,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_qc.a.a);var f="QuickReplyViewWrapper";new _j.d(f,function(){_qc.a.a[f]===undefined&&(_qc.a.a[f]=[[[-1,0,["Context","AttachmentComponent","AttachmentWellViewModel","VisibleCount"],[_qc.a.b,_qc.a.i,_qc.a.m,_qc.a.l],null,"VisibleAttachmentCount",null,_qc.a.G,1,null,null,0],[-1,0,["Context","IsInEditMode"],[_qc.a.b,_qc.a.z],_qc.a.A,"IsShowingContent",_qc.a.q,_qc.a.F,2,null,null,!1],[-1,0,["Context","IsInEditModeCompleted"],[_qc.a.b,_qc.a.V],_qc.a.W,"IsShowingContentCompleted",_qc.a.Z,_qc.a.bb,2,null,null,!1]],null]);var t=_qc.a.d.childNodes[17].cloneNode(!0);var i=new _j.c(t.children[1]);var n=new _qc.b(t.children[0],_j.b.Instance.a(_j.u),_j.b.Instance.a(_j.o),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j));n.v(!1);return new _j.a(t,[n,i]).l({QuickReplyViewId:n,QuickReplyScrollBufferRegionId:i})},"",IQuickComposeViewModel,_qc.k,function(n){return new _qc.k(n)},!1,!1,!1,0,_qc.a.a)};_qc.q.registerClass("_qc.q");_qc.f.registerClass("_qc.f");_qc.n.registerClass("_qc.n");_qc.c.registerClass("_qc.c");_qc.v.registerClass("_qc.v",_cmc.bH,_h.eR,IOutstandingComposeContext,IContext);QuickComposeComponent.registerClass("QuickComposeComponent",null,_a.ic,_j.ce);_qc.e.registerClass("_qc.e",_j.Q,IQuickComposeContext,IQuickComposeContextModelScope,IContext,_j.bp,Sys.IDisposable);_qc.F.registerClass("_qc.F");_qc.G.registerClass("_qc.G",_y.hR,IQuickComposeViewModel,_bc.i,_bc.o,_bc.r,_a.iP,_j.bp,Sys.IDisposable,_y.gr);_qc.h.registerClass("_qc.h",_j.Q,IInlineComposeConductorViewModel,_y.fd,_j.bp,Sys.IDisposable);_qc.w.registerClass("_qc.w",_qc.h);_qc.p.registerClass("_qc.p",_y.hR);_qc.d.registerClass("_qc.d",_j.Q,IQuickComposeRecipientComponent);_qc.j.registerClass("_qc.j",_j.Q,IQuickComposeSendComponent);_qc.m.registerClass("_qc.m",_j.Q,IQuickComposeAttachmentComponent);_qc.i.registerClass("_qc.i",_j.Q,IQuickComposeDiscardComponent);_qc.s.registerClass("_qc.s");_qc.o.registerClass("_qc.o",null,IQuickComposeUpconvertComponent);_qc.B.registerClass("_qc.B",null,IQuickComposeEventAggregatorFactory);_qc.z.registerClass("_qc.z",_qc.G,IMailQuickComposeViewModel,IQuickComposeViewModel);_qc.r.registerClass("_qc.r",_qc.e);_qc.y.registerClass("_qc.y",_qc.F,_y.ff);_qc.b.registerClass("_qc.b",_j.c);_qc.g.registerClass("_qc.g",_j.c);_qc.k.registerClass("_qc.k",_j.c);QuickComposeComponent.$$cctor();_qc.e.a=0;_qc.e.c=_a.a.r;_qc.e.b=1;_qc.d.a=_a.a.r;_qc.d.c=7;_qc.d.b=1;_qc.j.a=_a.a.r;_qc.m.a=_a.a.r;_qc.i.a=_a.a.r;_qc.o.a=_a.a.r;_qc.b.a=_a.a.r;_qc.g.a=_a.a.r;_qc.a.d=_qc.a.bj();_qc.a.r=null;_qc.a.t=null;_qc.a.s=null;_qc.a.a={};_qc.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.quickcompose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.quickcompose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
