try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.attachments.js'] = (new Date()).getTime();
Type.registerNamespace("_at");_at.F=function(){this.a={}};_at.F.prototype={e:function(n){return this.a[_g.p.toString(n).toLowerCase()]},b:function(n,t){this.a[_g.p.toString(n).toLowerCase()]=t;return t},d:function(n){return _g.p.toString(n).toLowerCase()in this.a},c:function(n){var u=n.toLowerCase();var i=this.a;for(var t in i){var r={key:t,value:i[t]};if(r.key===u)return!0}return!1},f:function(){return _ff.j.a(this.a)}};_at.by=function(n,t,i,r,u,f){_at.by.initializeBase(this);this.i=n;this.l=t;this.j=i;this.k=r;this.f=u;this.c=f};_at.by.prototype={l:null,j:null,k:null,i:null,n:null,f:!1,c:null,K:function(n){var t=new _gg.rU(this.L);n.be(this.i,this.l,this.j,this.k,t,this.I,this.G,this.f,this.c)},cT:function(n,t,i){try{_a.b.c(n,"result");this.n=n;t()}catch(r){i(r)}}};function AttachmentsComponent(){}AttachmentsComponent.$$cctor=function(){_a.u.a().a(AttachmentsComponent)};AttachmentsComponent.prototype={a:function(n,t,i){if(t.a()){var a=this;n.b(_at.u,function(){var t=_bc.l.isInstanceOfType(_g.k.a)?_g.k.a:null;return new _at.d(n.a(_a.C),t?t.d().j():null,t?t.j():null)}).a()}else{var l=this;n.b(_at.u,function(){return new _at.bt}).a()}var c=this;n.b(IAttachmentPropertyChecker,function(){return _at.g.a()}).a();var p=this;n.b(_at.w,function(){return _at.C.a?new _at.C:null}).a();var y=this;n.b(_a.fv,function(){return i.e()}).a();var r=_at.l.b(i);var v=this;n.b(_at.x,function(){return new _at.x(n.a(IInferenceTracker),n.a(_j.o),n.a(_no.c),n.a(_a.t),n.a(_a.f),n.d(IAttachmentPreviewViewModelFactory),n.c(ISmimeCommandFactory),n.a(_a.bt),r?null:n.a(_at.r),n.a(_a.C),n.c(IImportCalendarEventViewModelFactory),n.a(_j.j),n.a(_at.j),n.a(_at.w),n.a(_a.fv))}).a();var f=this;n.b(IAttachmentViewModelFactory,function(){return new _at.bq(n.a(_y.a),n.a(_at.u),n.d(IAttachmentProviderItemViewModelFactory),n.d(IItemStoreGetterFactory),n.a(IUriFileAttachmentViewModelFactory),n.a(_g.a).bk.AttachmentPolicy,r?n.a(IDownloadAuthenticatorFactory):null,n.a(_at.x))}).a();var u=this;n.b(_at.ba,function(){return new _at.ba(n.a(_g.a).bk.AttachmentPolicy,r?n.a(_at.l):null,n.a(_at.x))}).b(IUriFileAttachmentViewModelFactory).a();var e=this;n.b(_at.l,function(){return new _at.l(n.a(_a.f).a().bq().Enabled,n.a(_g.a).i().bk.DownloadTokenRefreshMinutes,n.a(_g.a).i().bk.DownloadUrlBase,n.a(_g.a).c().bk.UserEmailAddress,n.a(_g.a).i().bk.FirstDownloadToken,i.d(),n.a(_a.t))}).b(IDownloadAuthenticatorFactory).a();var h=this;n.b(_at.r,function(){return new _at.r(n.a(_a.f).a().bq().Enabled,n.a(_g.a).i().bk.DownloadTokenRefreshMinutes,n.a(_g.a).i().bk.DownloadUrlBase,n.a(_g.a).c().bk.UserEmailAddress,n.a(_g.a).i().bk.FirstDownloadToken,i.d(),n.a(_a.t),!1)}).b(IDownloadAuthenticator).a();var s=this;n.b(_at.j,function(){return new _at.j(i.d())}).a();var o=this;n.b(_at.t,function(){return new _at.t}).b(IFileReader)},b:function(){return null}};_at.G=function(){};_at.G.a=function(n){var t=null;n&&n.d()&&n.d().a()===2&&(t=n.b());return t};_at.AttachmentPolicyLevel=function(){};_at.AttachmentPolicyLevel.prototype={undefined:0,block:1,forceSave:2,allow:3};_at.AttachmentPolicyLevel.registerEnum("_at.AttachmentPolicyLevel",!1);_at.bA=function(){};_at.w=function(){};_at.w.registerInterface("_at.w");_at.l=function(n,t,i,r,u,f,e){this.e=t;this.d=i;this.c=r;this.f=f;this.g=e;this.h=n&&!_j.i.b(this.d)&&!_j.i.b(this.c)&&!_j.i.b(u);t<1&&(t=1);this.b=new _at.r(this.h,this.e,this.d,this.c,u,this.f,this.g,!1)};_at.l.b=function(n){return n.b().a().co().Enabled};_at.l.a=function(n,t,i){if(!n)return t.h;var r=_at.G.a(i);return n.a(r)};_at.l.prototype={b:null,h:!1,d:null,e:0,c:null,f:!1,g:null,a:function(n){_j.i.b(n)&&(n=this.c);var t=this.b;if(t&&t.d===n)return t;t.o();this.b=new _at.r(this.h,this.e,this.d,n,null,this.f,this.g,!0);return this.b}};_at.bn=function(){_at.bn.initializeBase(this)};_at.bn.prototype={K:function(n){var t=new _gg.vp(this.L);t.explicitLogonUser=this.S;n.bB(t,this.I,this.G)},cT:function(n,t,i){_j.i.b(n)?i(Error.create("Download token is missing or empty.")):t()}};_at.r=function(n,t,i,r,u,f,e,o){this.l=Function.createDelegate(this,this.n);this.k=Function.createDelegate(this,this.m);this.c=i;this.d=r;this.f=u;this.h=f;this.i=e;this.j=o;this.g=n&&!_j.i.b(this.c)&&!_j.i.b(this.d);t<1&&(t=1);if(this.g){this.m();this.e=_j.n.a().e(_at.r.a,"DownloadAuthenticator",this.k,6e4*t)}};_at.r.prototype={g:!1,c:null,d:null,h:!1,i:null,j:!1,e:null,f:null,o:function(){if(this.e){_j.n.a().b(this.e);this.e=null;return!0}return!1},m:function(){var n=new _at.bn;n.S=this.d;n.d(this.l);this.i.a(n)},n:function(n){this.f=n.N},a:function(n,t,i,r){if(!n||!n.Id||n.Id.startsWith("smime-"))return null;i||(i=_g.x.a());var f=String.format(i,encodeURIComponent(n.Id));t&&(f+=_g.x.f());if(!this.g||!this.j&&!_j.i.a(r)){_j.i.a(r)||(f=String.format("{0}/{1}",r,f));return f}if(_j.i.a(this.c)){_j.e.c(_at.r.a,"Attachment download URL is not properly configured.");return f}var u;u=_a.bZ.a()?this.c+f+"&token="+this.f:this.c+this.d+"/"+f+"&token="+this.f;u=u+"&owa="+window.location.hostname;this.h&&(u=u+"&isc=1");return u},b:function(n,t,i,r){var u=_at.j.c(n);return u?u.c(t,i,r):null}};_at.g=function(n,t){this.d=n||_at.g.g();this.f=t;this.e=this.f?this.d.DirectFileAccessOnPublicComputersEnabled:this.d.DirectFileAccessOnPrivateComputersEnabled;this.g=_at.g.d(this.d.BlockedFileTypes,this.d.ForceSaveFileTypes,this.d.AllowedFileTypes);this.h=_at.g.d(this.d.BlockedMimeTypes,this.d.ForceSaveMimeTypes,this.d.AllowedMimeTypes);this.i=_at.g.f(this.d.ActionForUnknownFileAndMIMETypes)};_at.g.a=function(){_at.g.b||(_at.g.b=new _at.g(_g.a.a().bk.AttachmentPolicy,_g.a.a().O()));return _at.g.b};_at.g.f=function(n){var t;try{t=_j.t.b(_at.AttachmentPolicyLevel,n)}catch(i){t=1}return t};_at.g.d=function(n,t,i){var r={};_at.g.c(r,i,3);_at.g.c(r,t,2);_at.g.c(r,n,1);return r};_at.g.c=function(n,t,i){if(t)for(var u=t,e=u.length,r=0;r<e;++r){var f=u[r];n[f]=i}};_at.g.g=function(){var n=new _g.ff;return JsonParser.deserialize('{"AllowedFileTypes":[".rpmsg", ".xlsx", ".xlsm", ".xlsb", ".tiff", ".pptx", ".pptm", ".ppsx", ".ppsm", ".docx", ".docm", ".zip", ".xls", ".wmv", ".wma", ".wav", ".vsd", ".vss", ".vst",  ".vdx", ".vsx", ".vtx", ".vsdx", ".vssx", ".vstx", ".vsdm", ".vssm", ".vstm",".txt", ".tif", ".rtf", ".pub", ".ppt", ".png", ".pdf", ".one", ".mp3", ".jpg", ".gif", ".doc", ".bmp", ".avi"],"AllowedMimeTypes":["image/jpeg", "image/png", "image/gif", "image/bmp"],"ForceSaveFileTypes":[".swf", ".spl", ".dir", ".dcr"],"ForceSaveMimeTypes":["Application/x-shockwave-flash", "Application/octet-stream", "Application/futuresplash", "Application/x-director"],"BlockedFileTypes":[".vsmacros", ".msh2xml", ".msh1xml", ".ps2xml", ".ps1xml", ".mshxml", ".gadget", ".mhtml", ".psc2", ".psc1", ".msh2", ".msh1", ".aspx", ".xml", ".wsh", ".wsf", ".wsc", ".vsw", ".vbs", ".vbp", ".vbe", ".url", ".tmp", ".shs", ".shb", ".sct", ".scr", ".scf", ".reg", ".pst", ".ps2", ".ps1", ".prg", ".prf", ".plg", ".pif", ".pcd", ".osd", ".ops", ".mst", ".msp", ".msi", ".msh", ".msc", ".mht", ".mdz", ".mdw", ".mdt", ".mde", ".mdb", ".mda", ".maw", ".mav", ".mau", ".mat", ".mas", ".mar", ".maq", ".mam", ".mag", ".maf", ".mad", ".lnk", ".ksh", ".jse", ".its", ".isp", ".ins", ".inf", ".htc", ".hta", ".hpj", ".hlp", ".fxp", ".exe", ".der", ".csh", ".crt", ".cpl", ".com", ".cnt", ".cmd", ".chm", ".cer", ".bat", ".bas", ".asx", ".asp", ".app", ".adp", ".ade", ".ws", ".vb", ".js"],"BlockedMimeTypes":["application/x-javascript", "application/javascript", "application/msaccess", "x-internet-signup", "text/javascript", "application/xml", "application/prg", "application/hta", "text/scriplet", "text/xml"], "ActionForUnknownFileAndMIMETypes":"ForceSave","BlockWacViewingThroughUI":false,"WacViewableFileTypes":[".doc", ".docx", ".ppt", ".pptx", "xls", ".xlsx"],"WacViewingOnPublicComputersEnabled":true,"WacViewingOnPrivateComputersEnabled":true,"ForceWacViewingFirstOnPublicComputers":false,"ForceWacViewingFirstOnPrivateComputers":false,"DirectFileAccessOnPrivateComputersEnabled":true,"DirectFileAccessOnPublicComputersEnabled":true}')};_at.g.e=function(n,t){if(!n)return!1;for(var r=n,f=r.length,i=0;i<f;++i){var u=r[i];if(u===t)return!0}return!1};_at.g.prototype={f:!1,e:!1,i:0,d:null,g:null,h:null,b:function(){return this.d.WacEditableFileTypes?this.d.WacEditableFileTypes.length:0},a:function(n,t,i,r){!!i!==i&&(i=!0);n&&(n=n.toLowerCase());var f;f=this.j(n,t);var u=!1;var o=!1;var e=!1;if(f!==1&&i&&!r){this.l(n)&&(u=!0);o=this.k(this.f,u);u&&this.d.WacEditableFileTypes&&n&&(e=_at.g.e(this.d.WacEditableFileTypes,n))}u||this.e||(f=1);return new _at.J(this.e,f,u,o,e)},c:function(n,t){var i=this.a(n,t).a;return i===1||!i},j:function(n,t){var r=this.g[n]||0;if(r===1)return 1;var i=this.h[t]||0;return i===1?1:r===2||i===2?2:r===3||i===3?3:this.i},l:function(n){var t=this.f?this.d.WacViewingOnPublicComputersEnabled:this.d.WacViewingOnPrivateComputersEnabled;return t&&this.m(n)},k:function(n,t){return t?n?this.d.ForceWacViewingFirstOnPublicComputers:this.d.ForceWacViewingFirstOnPrivateComputers:!1},m:function(n){return _at.g.e(this.d.WacViewableFileTypes,n)}};_at.J=function(n,t,i,r,u){!n&&!i;this.d=n;this.a=t;this.b=i;this.f=r;this.e=u};_at.J.prototype={a:0,d:!1,f:!1,b:!1,e:!1,c:function(){return this.a!==1&&this.d},toString:function(){return String.format("Attachment PolicyLevel: {0}, DirectFileAccessEnabled: {1}, WAC: {2}, ForceBrowserView: {3}, WacEdit: {4}",this.a,this.d,this.b,this.f,this.e)}};_at.K=function(){};_at.K.a=function(n,t,i){n.n(function(n){var u=n;var r=u.j();r.a().b()>0&&_at.K.b(r.a().a(0),t)&&r.a().a(0).S().o(function(n){var t=n;(!t.a()||_dg.b.isInstanceOfType(t))&&i(r.a().a(0),t)})})};_at.K.b=function(n,t){return!!n.S()&&!n.bk.IsDraft&&!(t&&_g.b.a.doesIdEqualName(n.bk.ParentFolderId,"deleteditems"))};_at.t=function(){this.g=new FileReader};_at.t.prototype={g:null,h:null,c:function(){return this.g.error},d:function(){return this.h},b:function(){return this.g.result},f:function(n){this.g.onloadend=n;return n},e:function(n){if(_db.bt.isInstanceOfType(n)){var i=n;this.g.readAsDataURL(i.c)}else if(_h.bK.isInstanceOfType(n)){var t=n;this.g.readAsDataURL(t.c)}},a:function(n,t,i,r,u){var f=this;this.g.onloadend=function(){if(!f.g.error&&f.g.result){var h=f.g.result.indexOf(",");var l=f.g.result.substring(h+1,f.g.result.length);var c=null;var e=0,o=0;if(u&&f.g.result.length>10&&f.g.result.substring(0,10)==="data:image"){var s=document.createElement("canvas");var a=s.getContext("2d");var n=new Image;n.onload=function(){if(n.height<n.width){o=50;n.height&&(e=o*n.width/n.height)}else{e=50;n.width&&(o=e*n.height/n.width)}_j.e.a(r,"Attachments canvas width={0}, height={1}",e,o);if(e&&o){s.width=e;s.height=o;try{a.drawImage(n,0,0,e,o);c=s.toDataURL("image/jpeg",1)}catch(i){_j.e.b(r,"Failed to get thumbnail with error {0}, ",i.message)}}f.i(f.g.result,l,h,t,c,e,o,r)};n.onerror=function(){_j.e.b(r,"Failed to load thumbnail into image object to get client thumbnail");f.i(f.g.result,l,h,t,c,e,o,r)};n.src=f.g.result}else f.i(f.g.result,l,h,t,c,e,o,r)}else{_j.e.b(r,"File reader failed with error code {0}",f.g.error);i()}};try{this.e(n)}catch(e){this.h=e;_a.l.a().H&&e.name==="NS_ERROR_FILE_ACCESS_DENIED"?_j.e.a(r,"Firefox: failed to read an attachment. Exception: {0}",e.message):_j.e.b(r,"Unexpected exception was thrown by FileReader.ReadAsDataURL: "+e.message);i()}},i:function(n,t,i,r,u,f,e,o){_j.e.a(o,"No error - Reading the file.");n.substring(0,i).indexOf("base64")!==-1?r(t,u,f,e):r(_a.bl.b(t),u,f,e)}};_at.W=function(){};_at.W.prototype={a:function(){return new _at.t}};_at.C=function(){};_at.C.b=function(){try{var n="dummyKey";var t="dummyValue";sessionStorage.setItem(n,t);sessionStorage.removeItem(n);return!0}catch(i){return!1}};_at.C.prototype={a:function(n){return sessionStorage.getItem(n)},b:function(n,t){sessionStorage.setItem(n,t)},c:function(n){sessionStorage.removeItem(n)}};_at.m=function(){this.b={}};_at.m.a=function(){_at.m.b||(_at.m.b=new _at.m);return _at.m.b};_at.m.prototype={a:function(n,t){this.b[n]=new _at.m.c(t)},c:function(n){if(n in this.b){var t=this.b[n];if(t.c())delete this.b[n];else return t.a}return null}};_at.m.c=function(n){this.a=n;this.b=Date.now()+36e5};_at.m.c.prototype={b:0,a:null,c:function(){return this.b<Date.now()}};_at.o=function(n){_at.o.initializeBase(this);this.f=n};_at.o.b=function(){_at.o.a={}};_at.o.prototype={c:null,f:0,K:function(n){var i=new _gg.vg(this.L);var t=new _gg.iR;t.ClientVersion=this.f;n.bu(t,i,this.I,this.G)},cT:function(n,t,i){try{this.c=new Array(n.length);for(var r=0;r<n.length;r++){var u=n[r].Id;_at.o.a[u]||(_at.o.a[u]=_a.m.d(_gg.z,n[r],_gg.z));this.c[r]=_at.o.a[u]}t()}catch(f){i(f)}}};_at.bb=function(n){_at.bb.initializeBase(this);this.c=n};_at.bb.prototype={c:null,K:function(n){var t=new _gg.qT(this.L);n.W(this.c,t,this.I,this.G)},cT:function(n,t,i){n?t():i(null)}};_at.bc=function(n){_at.bc.initializeBase(this);this.c=new _gg.hm;this.c.cancellationId=n};_at.bc.prototype={c:null,K:function(n){var t=new _gg.qX(this.L);n.X(this.c,t,this.I,this.G)},cT:function(n,t,i){n?t():i(null)}};_at.bd=function(n){_at.bd.initializeBase(this);this.c=new _gg.hn;this.c.cancellationId=n};_at.bd.prototype={c:null,K:function(n){var t=new _gg.qY(this.L);n.Y(this.c,t,this.I,this.G)},cT:function(n,t,i){n?t():i(null)}};_at.be=function(n){_at.be.initializeBase(this);this.c=n};_at.be.prototype={c:null,K:function(n){var t=new _gg.rc(this.L);n.dp(this.c,t,this.I,this.G)},cT:function(n,t,i){n?t():i(null)}};_at.bf=function(n,t){_at.bf.initializeBase(this);this.c=new _gg.hv;this.c.ewsAttachmentId=n;this.c.itemId=t};_at.bf.prototype={c:null,f:null,K:function(n){var t=new _gg.rE(this.L);n.dv(this.c,t,this.I,this.G)},cT:function(n,t,i){try{_a.b.a(n,"result");if(n.ErrorMessage)throw Error.create(n.ErrorMessage);this.f=n.ContentId;t()}catch(r){i(r)}}};_at.bg=function(n,t,i,r){_at.bg.initializeBase(this);this.f=new _gg.hw;this.f.subscriptionId=i;this.f.ewsAttachmentId=n;this.f.itemId=t;this.f.channelId=_no.a.a;this.f.cancellationId=r;this.c=n.Id};_at.bg.prototype={f:null,c:null,K:function(n){var t=new _gg.rL(this.L);n.ba(this.f,t,this.I,this.G)},cT:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.bh=function(n,t,i,r,u,f){_at.bh.initializeBase(this);this.c=new _gg.hx;this.c.attachmentDataProviderId=t;this.c.ewsAttachmentId=n.Id;this.c.emailId=i;this.c.subscriptionId=r;this.c.channelId=_no.a.a;this.c.cancellationId=f;this.c.fullPathLocation=u;this.f=n.Id};_at.bh.prototype={c:null,f:null,K:function(n){var t=new _gg.rM(this.L);n.bb(this.c,t,this.I,this.G)},cT:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.i=function(n,t,i,r,u,f,e,o,s,h){_at.i.initializeBase(this);this.l=n;this.f=t;this.p=i;this.s=r;this.r=s;this.k=h;this.o=u;this.t=f;this.q=e;this.u=o};_at.i.b=function(){var n=new XMLHttpRequest;return n.upload&&n.upload.onprogress!==undefined};_at.i.d=function(n,t,i,r,u,f){try{var o=JsonParser.deserialize(n);if(o&&o.Body)if(o.Body.ResponseMessages){var s=o.Body.ResponseMessages.Items[0];if(s.ResponseCode!=="NoError"){_j.e.c(_at.i.a,"Got a attachment error response with {0}",s.ResponseCode);var l=s.MessageText;var h={};h.ResponseCode=s.ResponseCode;f(Error.create(l,h),null)}else{var e=s.Attachments[0];t.f(e.AttachmentId);i.Id=e.AttachmentId.RootItemId;i.ChangeKey=e.AttachmentId.RootItemChangeKey;t.h(e.Size||0);t.i(e.ContentType);t.a()&&t.o(e.ContentId);u(o)}}else{_j.e.c(_at.i.a,"Got no response message in the body; assuming it is a fault response");var c=o;f(Error.create(c.Body.FaultMessage),c.Body)}else{_j.e.c(_at.i.a,"Got no response or response without body");f(Error.create(""),null)}}catch(a){_j.e.c(_at.i.a,"Got exception processing response: {0}, exception: {1}",n,a);n===""&&(a=Error.create(""));f(a,null)}};_at.i.c=function(n,t,i,r){if(!n.IsCancelled){n.Attachments.length>0&&t.f(n.Attachments[0].AttachmentId);if(r){t.a()&&t.o(n.Attachments[0].ContentId);n.Attachments[0].Size>0&&t.h(n.Attachments[0].Size);i.Id=n.Attachments[0].AttachmentId.RootItemId;i.ChangeKey=n.Attachments[0].AttachmentId.RootItemChangeKey}}};_at.i.prototype={t:!1,l:0,f:null,p:null,c:null,s:null,r:0,k:0,o:null,j:null,i:null,q:null,u:!1,bj:function(){if(this.J||!this.Q||!this.Q.response){_j.e.a(_at.i.a,"No success response because there's an error, or action is not complete.  Error: {0}",this.J);return null}return this.Q.response.result},bb:function(){return this.q&&_at.i.b()?this.bk():_h.du.prototype.bb.call(this)},bc:function(){var n=null;!_j.i.a(this.o)&&this.t?n=this.o:this.c.Body&&this.c.Body.ParentItemId&&_a.ce.a(this.c.Body.ParentItemId.Id)&&(n=_g.a.a().c().bk.DefaultPublicFolderMailbox);return n},bk:function(){var n=new XMLHttpRequest;var t=this;n.onreadystatechange=function(){if(n.readyState===4){var r=Sys.Serialization.JavaScriptSerializer.deserialize(n.responseText);if(n.status===200)t.be(t.Q,r);else{var i=Error.create(String.format("CreateAttachment XHR failed with statusCode: {0}, response body: {1}",n.status,n.responseText));t.ba(i)}}};var f=this.q;var u=this;var r=function(n){var t=Math.round(n.loaded*100/n.total);u.q(t)};n.upload.onprogress=r;n.open("POST",_g.x.n(),!0);this.c=this.F();this.bl(n);var i=Sys.Serialization.JavaScriptSerializer.serialize(this.c);if(_dg.c.isInstanceOfType(this.f)&&this.u){n.setRequestHeader("X-OWA-UrlPostData",encodeURI(i));n.send(this.f.c)}else n.send(i);return 1},bl:function(n){n.setRequestHeader("X-OWA-Action","CreateAttachmentFromLocalFile");n.setRequestHeader(_a.A.c(),_a.A.e());var t=this.bc();_j.i.a(t)||n.setRequestHeader("X-OWA-ExplicitLogonUser",t)},K:function(n){this.c=this.F();if(this.s){this.j=new _gg.rT(this.L);this.j.explicitLogonUser=this.bc();this.j.clientStoreItem=this.l;this.j.isQueued=!1;this.j.palContext=new _g.eU(!1);n.bd(this.c,this.j,this.I,this.G)}else{this.i=new _gg.oq(this.L);this.i.explicitLogonUser=this.bc();this.i.clientStoreItem=this.l;this.i.isQueued=!1;this.i.palContext=new _g.eU(!1);n.d(this.c,this.i,this.I,this.G)}},cJ:function(n){this.bh(n)},bh:function(n){_at.i.c(n,this.f,this.p,this.k<=this.r+1)},F:function(){var i=new _g.g(this.p.Id);i.ChangeKey=this.p.ChangeKey;var t=this.f.v();var n=new _gg.el(i);n.Attachments=[t];n.RequireImageType=t.IsInline;n.IncludeContentIdInResponse=t.IsInline;n.ClientSupportsIrm=!0;n.CancellationId=this.s;if(this.k!==1){n.SliceNumber=this.r;n.TotalSlices=this.k}return new _gg.ek(this.M(),n)}};_at.bi=function(n,t,i,r,u,f){_at.bi.initializeBase(this,[n,t,i,r,u,f,null,!1,0,1]);var e=t.c;this.bf=e};_at.bi.prototype={bf:null,K:function(n){var u=this.F();var t=new _gg.oq(this.L);this.t&&(t.explicitLogonUser=this.o);t.clientStoreItem=this.l;t.isQueued=!0;for(var r=u.Body.Attachments,e=r.length,i=0;i<e;++i){var f=r[i];if(f.IsInline){t.isQueued=!1;break}}t.palContext=new _g.eU(!0);t.dataFile=this.bf.g();n.d(u,t,this.I,this.G)},cJ:function(n){this.bh(n)}};_at.I=function(n,t,i,r,u,f,e,o,s,h,c,l){_at.I.initializeBase(this);this.o=n;this.c=t;this.p=i;this.l=u;this.r=f;this.f=r;this.i=e;this.j=o;this.t=s;this.q=h;this.n=c;this.s=l};_at.I.prototype={o:null,c:null,p:null,l:null,r:null,f:null,i:null,j:null,t:null,q:null,n:!1,s:!1,k:null,K:function(n){var t=new _gg.st(this.L);this.s&&(t.explicitLogonUser=this.l);n.bg(this.o,this.c,this.p,this.f,this.i,this.r,t,this.I,this.G,this.j,this.t,this.q,this.n)},cT:function(n,t,i){try{_a.b.a(n,"result");this.k=n;t()}catch(r){i(r)}}};_at.bj=function(n,t,i){_at.bj.initializeBase(this);this.j=n;this.f=t;this.c=i;this.i=t.bk.AttachmentId||t.bk.TemporaryId};_at.bj.prototype={j:0,f:null,i:null,c:null,cJ:function(n){this.c.Id=n.RootItemId.RootItemId;this.c.ChangeKey=n.RootItemId.RootItemChangeKey;this.f.bk.TemporaryId&&this.f.f(this.f.bk.TemporaryId)},K:function(n){var r=new _gg.eq;r.ClientSupportsIrm=!0;var i=new _gg.sJ(this.L);i.itemContexts=new Array(1);var t=new _gg.JV;t.clientStoreItem=this.j;t.parentItemId=new _g.g(this.c.Id);t.parentItemId.ChangeKey=this.c.ChangeKey;r.AttachmentIds=[new _g.bm(this.i.Id)];var u=new _gg.hO(this.M());u.Body=r;i.itemContexts[0]=t;n.o(u,i,this.I,this.G)}};_at.bk=function(n){_at.bk.initializeBase(this);this.f=n};_at.bk.prototype={f:null,c:null,K:function(n){var t=new _gg.vc(this.L);n.bt(this.f,t,this.I,this.G)},cT:function(n,t,i){if(_j.i.b(n))i(Error.create("AddIns is null or empty."));else{this.c=n;t()}}};_at.v=function(n,t,i){_at.v.initializeBase(this);this.f=_a.d.b(_at.v.a,"DownloadAttachment");this.i=n;this.j=t;this.S=i};_at.v.prototype={i:null,c:null,f:null,j:!1,M:function(){return this.Y("Exchange2015")},K:function(n){var i=new _dg.cj(this.L);i.explicitLogonUser=this.S;var t=new _gg.iT(this.M());t.Body.AttachmentIds=[new _g.bm(this.i)];t.Body.ShapeName="ItemAttachment";t.Body.AttachmentShape=_h.b.W();if(this.j){t.Header.ManagementRole=new _g.cU;t.Header.ManagementRole.UserRoles=["MailboxSearch"]}n.bv(t,i,this.I,this.G)},cJ:function(n){var t=null;var u=n.Attachments.length;u!==1&&(t="GetAttachment response length = "+u);var r=n.Attachments[0];r||(t="GetAttachment response contained null attachment");var i=_a.m.d(_dg.i,r);this.c=i.q();this.c||(t="GetAttachment response contained null item");t?_j.e.b(_a.a.c,t):_j.e.a(_a.a.c,"GetAttachment succeeded for '{0}' on '{1}'",i.bk.Name,this.c.bk.Subject);if(this.f){this.f.k=this.P();this.f.m=t}_a.d.a(this.f);this.f=null}};_at.bl=function(n,t,i){_at.bl.initializeBase(this);this.f=n;this.c=t;this.j=i;this.i=t.bk.AttachmentId||t.bk.TemporaryId;if(!_dg.c.isInstanceOfType(t)&&!_dg.i.isInstanceOfType(t)&&!_g.B.isInstanceOfType(t))throw Error.notImplemented("Only FileAttachment, ItemAttachment and ItemIdAttachment are supported to get content.");};_at.bl.prototype={f:null,c:null,i:null,j:null,bb:function(){if(_dg.c.isInstanceOfType(this.c)){var n=this.c;if(_a.fr.isInstanceOfType(n.c)&&!n.t){var u=n.c;var r=new _at.W;var f=r.a();var t=this,i=this;f.a(u,function(i,r,u,f){n.q(t.k(i));t.W(null)},function(){var t=String.format("Unable to read content of file {0}.",n.bk.Name);_j.e.b(i.f,t);i.W(Error.create(t))},this.f,!1);return 1}else if(n.t&&n.bk.Content&&n.bk.Content.length>0){this.W(null);return 1}else return this.l()}else return _dg.i.isInstanceOfType(this.c)?this.l():_h.du.prototype.bb.call(this)},cT:function(n,t,i){var r=this.c;if(_j.i.a(n))i(Error.create(String.format("The MIME content of item {0} cannot be retrieved.",r.bk.ItemId.Id)));else{r.A(this.k(n));t()}},K:function(n){var t=new _g.g(this.c.bk.ItemId.Id);n.bV(t,null,this.I,this.G)},l:function(){var t=new XMLHttpRequest;var r=_dg.i.isInstanceOfType(this.c)?_g.x.a():_g.x.h();var i=String.format(r,encodeURIComponent(this.i.Id));_j.i.a(this.j)||(i=String.format("{0}/{1}",this.j,i));var n=this;t.onreadystatechange=function(){if(t.readyState===4)if(t.status===200){var r=n.k(t.responseText);_dg.c.isInstanceOfType(n.c)?n.c.q(r):_dg.i.isInstanceOfType(n.c)&&n.c.y(r);n.W(null)}else{var i=String.format("Unable to get file attachment content.\nAttachmentId = {0}\nResponseBody = {1}\nStatusText = {2}",n.i.Id,t.responseText,t.statusText);_j.e.c(n.f,i);n.W(Error.create(i))}};t.open("GET",i,!0);_a.p.H(t);t.send(null);return 1},k:function(n){if(n.startsWith("data:")){var t=";base64,";var i=n.indexOf(t);return n.substr(i+t.length)}else return n}};_at.q=function(n){_at.q.initializeBase(this);this.c=n};_at.q.b=function(n){if(_j.i.a(n)){_j.e.a(_a.a.c,"An invalid identifier was passed in as an argument.");return null}return!_at.q.a||!(n in _at.q.a)?null:_at.q.a[n]};_at.q.prototype={c:null,f:null,K:function(n){var t=new _gg.vn(this.L);t.explicitLogonUser=this.c;n.bz(t,this.I,this.G)},cT:function(n,t,i){var r=this.c||"PersonalOneDriveKey";_at.q.a||(_at.q.a={});_at.q.a[r]=n;this.f=n;t()}};_at.h=function(n){_at.h.initializeBase(this);this.c=n};_at.h.e=function(n){var t=_at.h.c(n);return t?t.FolderName:null};_at.h.d=function(n){var t=_at.h.c(n);return t?t.FolderId:null};_at.h.f=function(){return _at.h.b>=2?!0:!1};_at.h.c=function(n){if(_j.i.a(n)){_j.e.a(_a.a.c,"An invalid key was passed in as an argument.");return null}if(!_at.h.a||!(n in _at.h.a)){_j.e.a(_a.a.c,String.format("No response objects were cached with the given key: {0}",n));return null}return _at.h.a[n]};_at.h.prototype={c:null,i:null,f:null,K:function(n){var t=new _gg.vo(this.L);t.explicitLogonUser=this.c;n.bA(t,this.I,this.G);this.c||_at.h.b++},cT:function(n,t,i){if(!n){i(Error.create("Failed to get valid properties of the default upload folder."));return}var r=this.c||"PersonalOneDriveKey";_at.h.a||(_at.h.a={});this.f=n.FolderName;this.i=n.FolderId;_at.h.a[r]=n;t()}};_at.bm=function(n,t,i,r,u,f,e,o){_at.bm.initializeBase(this,[n,t,i,r,u,f,e]);this.f="GetSuiteExtensionsAttachmentInfo";this.q=_j.i.b(o)?null:o};_at.bm.prototype={q:null,K:function(n){var t=new _gg.vq(this.L);switch(this.l){case 0:this.f+="ClasicReadingPane";break;case 1:this.f+="ModernMail";break}if(this.l===2||!_j.i.a(this.k)){this.f+="ModernGroup";t.explicitLogonUser=this.k}this.f+=this.o?"Cloudy":"Classic";this.f+=this.i?"Edit":"Preview";t.actionName=this.f;this.n&&(t.isDiscovery=!0);n.eA(this.j,this.i,this.p,t,this.I,this.G,this.q)},cT:function(n,t,i){this.c=n;if(this.c)if(this.c.Status){var u=Error.create("GetAttachmentInfo was not successful.");i(u)}else{this.i||_at.m.a().a(this.j,this.c);t()}else{var r=new _dg.bj;r.Status=1;r.WacUrl="";this.c=r;i(Error.create("Server unavailable."))}}};_at.bz=function(n,t,i,r,u,f,e){_at.bz.initializeBase(this);this.j=n;this.i=t;this.p=i;this.o=r;this.l=u;this.k=f;this.n=e};_at.bz.prototype={c:null,f:"GetAttachmentInfo",j:null,i:!1,p:null,o:!1,l:0,k:null,n:!1};_at.S=function(n,t,i,r,u,f,e){_at.S.initializeBase(this,[n,t,i,r,u,f,e]);this.f="GetWacAttachmentInfo"};_at.S.prototype={K:function(n){var t=new _gg.Ae(this.L);switch(this.l){case 0:this.f+="ClasicReadingPane";break;case 1:this.f+="ModernMail";break}if(this.l===2||!_j.i.a(this.k)){this.f+="ModernGroup";t.explicitLogonUser=this.k}this.f+=this.o?"Cloudy":"Classic";this.f+=this.i?"Edit":"Preview";t.actionName=this.f;this.n&&(t.isDiscovery=!0);n.ct(this.j,this.i,this.p,t,this.I,this.G,null)},cT:function(n,t,i){this.c=n;if(this.c)if(this.c.Status){this.i||this.c.Status!==9||_at.m.a().a(this.j,this.c);var u=Error.create("GetWacAttachmentInfo was not successful.");i(u)}else{this.i||_at.m.a().a(this.j,this.c);t()}else{var r=new _dg.bj;r.Status=1;r.WacUrl="";this.c=r;i(Error.create("Server unavailable."))}}};_at.T=function(n,t,i,r,u,f,e){_at.T.initializeBase(this,[n,t,i,r,u,f,e]);this.f="GetWacInfoAction"};_at.T.prototype={K:function(n){var i=new _gg.Ag(this.L);switch(this.l){case 0:this.f+="ClasicReadingPane";break;case 1:this.f+="ModernMail";break}if(this.l===2||!_j.i.a(this.k)){this.f+="ModernGroup";i.explicitLogonUser=this.k}this.f+=this.o?"Cloudy":"Classic";this.f+=this.i?"Edit":"Preview";i.actionName=this.f;this.n&&(i.isDiscovery=!0);var t=new _gg.kF;t.Url=this.j;t.IsEdit=this.i;t.ProviderType=0;n.gf(t,i,this.I,this.G)},cT:function(n,t,i){this.c=n;if(this.c)if(this.c.Status){this.i||this.c.Status!==9||_at.m.a().a(this.j,this.c);var u=Error.create("GetWacAttachmentInfo was not successful.");i(u)}else{this.i||_at.m.a().a(this.j,this.c);t()}else{var r=new _dg.bj;r.Status=1;r.WacUrl="";this.c=r;i(Error.create("Server unavailable."))}}};_at.U=function(n,t,i,r){_at.U.initializeBase(this);this.c=new _gg.lV;this.c.subscriptionId=i;this.c.ewsAttachmentId=n;this.c.channelId=_no.a.a;this.c.itemId=t;this.c.groupSmtpAddress=r};_at.U.prototype={c:null,K:function(n){var t=new _gg.EC(this.L);_j.i.a(this.c.groupSmtpAddress)||(t.explicitLogonUser=this.c.groupSmtpAddress);n.cG(this.c,t,this.I,this.G)},cT:function(n,t,i){try{_a.b.a(n,"result");t()}catch(r){i(r)}}};_at.V=function(n,t,i,r){_at.V.initializeBase(this);this.i=n;this.j=t;this.f=i;this.l=r};_at.V.prototype={i:null,j:0,k:!1,f:null,l:!1,n:null,c:!1,K:function(n){var i=new _gg.Fp(this.L);var t=new _gg.ga;t.AttachmentIds=this.i;t.PermissionLevel=this.j;t.NewAttachLongPathNames=this.f;t.SetToOriginalPermissionLevel=this.l;n.cL(t,i,this.I,this.G)},cT:function(n,t,i){this.k=!0;if(n&&n.OperationSucceeded){this.n=n;t()}else i(Error.create("Error setting attachment permissions"))}};_at.s=function(n){this.n=Function.createDelegate(this,this.x);_at.s.initializeBase(this,[n])};_at.s.prototype={b:null,e:0,i:!1,d:!1,g:!1,q:function(n){if(this.d!==n){this.d=n;this.bs("ImageLoadSucceeded")}return n},p:function(n){if(n!==this.b){this.b=n;this.j()}return n},r:function(n){if(n!==this.e){this.e=n;this.j()}return n},f:function(n){_j.k.c(this.z,"error");this.a(_y.c.a.s(_y.e.a().c));this.v();this.i=!0},O:function(){_b.bp.prototype.O.call(this);_j.k.b(this.z,"load",this.n);this.j();this.u()},bt:function(){_j.k.c(this.z,"load");_j.h.prototype.bt.call(this)},x:function(n){this.q(!this.i);this.d&&!this.g&&this.w(this.z)},u:function(){var t=_a.d.b(_a.a.c,"AttachmentExternalImage");var n=new _a.o;n.c("L",!0);this.b?n.c("U",this.b.a):n.c("N",!0);t.j=n.toString();_a.d.a(t)},v:function(){var t=_a.d.b(_a.a.c,"AttachmentExternalImage");var n=new _a.o;n.c("E",!0);this.b?n.c("U",this.b.a):n.c("N",!0);t.j=n.toString();_a.d.a(t)},j:function(){this.b&&this.e&&this.a(this.b.c)},w:function(n){this.g=!1;var f=n;if(_at.s.a){f=window.document.createElement("img");f.src=n.src}var i=f.naturalHeight;i||(i=f.height);var r=f.naturalWidth;r||(r=f.width);i||(i=this.b.b);r||(r=this.b.d);if(!i||!r){_j.e.b(_a.a.c,"Stopping processing image since either imageHeight or width is 0");return}var y=0;var c=1;var w=0;var p=1;var t=this.b.e;if(t&&t.b()>=4)if(t.a(0)<t.a(2)&&t.a(1)<t.a(3)){_j.e.a(_a.a.c,"Top={0}, Left={1}, Bottom={2}, Right={3}",t.a(0),t.a(1),t.a(2),t.a(3));var h=255;y=t.a(0)/h;w=t.a(1)/h;c=t.a(2)/h;p=t.a(3)/h}else _j.e.b(_a.a.c,"Something wrong with the salient region, Top={0}, Left={1}, Bottom={2}, Right={3}",t.a(0),t.a(1),t.a(2),t.a(3));else _j.e.b(_a.a.c,"Using default value as the salient regions");var g=r/i;var o;var s;var b,l;_at.Q.a(this.e,b={val:s},l={val:o}),s=b.val,o=l.val;var nt=o/s;var e;var a=0,v=0;if(g>nt){e=s/i;a=this.o(e,r,o,(w+p)/2)}else{e=o/r;v=this.o(e,i,s,(y+c)/2)}var tt=Math.round(r*e);var it=Math.round(i*e);var k=a*-1;var d=v*-1;var u={};u.width=tt.toString()+"px";u.height=it.toString()+"px";u.top=d.toString()+"px";u[_fc.l.a()]=k.toString()+"px";this.z.style.cssText="width: "+u.width+"; "+"height"+": "+u.height+"; "+"top"+": "+u.top+"; "+_fc.l.a()+": "+u[_fc.l.a()]+"; "+"position"+": "+"absolute"+";";this.g=!0},o:function(n,t,i,r){var o=.5;var e=t*n;var u=(e-i)/e;var f;f=r-o>=u/2?Math.round(e*u):o-r>=u/2?0:Math.round((r-o+u/2)*e);return f}};_at.Q=function(){};_at.Q.a=function(n,t,i){switch(n){case 2:i.val=120;t.val=90;break;case 3:i.val=160;t.val=120;break;case 4:i.val=200;t.val=150;break;case 5:i.val=260;t.val=120;break;default:i.val=50;t.val=50;break}};_at.R=function(n){_at.R.initializeBase(this,[n])};_at.R.prototype={G:function(){_j.h.prototype.G.call(this);var n=this.W();if(n&&n.bm&&n.fD()){var i=_a.bh.a(n.bm.bk.Name).replace(".","");var t=SuiteExtensions.ControlFactory.CreateControl(i,0);t.Render(this.z)}}};_at.c=function(n){this.r=Function.createDelegate(this,this.w);this.q=Function.createDelegate(this,this.bg);this.t=Function.createDelegate(this,this.bR);this.u=Function.createDelegate(this,this.bU);this.s=Function.createDelegate(this,this.bu);_at.c.initializeBase(this,[n]);this.a("about:blank");this.A(-1);this.bj().load(this.s)};_at.c.prototype={b:null,d:null,e:0,k:!1,n:null,m:0,p:null,h:!1,l:null,i:function(){return this.ew(_at.c.c)},bB:function(n){this.ev(_at.c.c,n);return n},j:function(){return this.ew(_at.c.e)},bK:function(n){this.ev(_at.c.e,n);return n},bJ:function(n){n||(this.e=-1);this.ev(_at.c.g,n);return n},bk:function(){return this.ew(_at.c.d)},bC:function(n){this.ev(_at.c.d,n);return n},bp:function(){return this.ew(_at.c.b)},bO:function(n){this.ev(_at.c.b,n);return n},I:function(n){if(this.l===n)return n;this.l=n;this.bs("UploadAndShareAttachmentCommand");return n},br:function(){return this.ew(_at.c.f)},bP:function(n){this.ev(_at.c.f,n);return n},y:function(n){this.n=n;this.bs("Error");return n},x:function(n){this.m=n;this.bs("AttachmentError");return n},C:function(n){this.p=n;this.bs("SuccessResponse");return n},Z:function(){_j.h.prototype.Z.call(this);this.ev(_at.c.b,new _j.g(this.u,_at.c.a));this.I(new _j.g(this.t,_at.c.a))},bu:function(n){if(this.e){if(this.e===2){_j.e.a(_at.c.a,"Response received.");var t="";try{t=this.z.contentWindow.document.body.innerText}catch(u){if(!(_a.l.a().G&&u.number===-2146828218)){_j.e.d(_at.c.a,u,"Unhandled exception while executing HandleCreateAttachmentResponse");return}}if(this.k)_j.i.a(t)&&this.o(null,"Error sending the attachment upload form",1);else{var r=this,i=this;_at.i.d(t,this.i(),this.j(),_g.k.a,function(n){_j.e.a(_at.c.a,"HandleCreateAttachmentResponse completed.");r.o(n,null,0)},function(n,t){_j.e.a(_at.c.a,"HandleCreateAttachmentResponse failed: {0}",n.message);var r=1;if(n.ResponseCode){var u=n.ResponseCode.toString();i.i().a()&&u==="ErrorInvalidOperation"?r=4:u==="ErrorMessageSizeExceeded"&&(r=3)}var f=_at.k.d(t)||_at.k.a(n);i.o(null,f,r)})}}}else{_j.e.a(_at.c.a,"Initializing.");this.e=1;this.bz();_j.n.a().a(_at.c.a,"ExecuteOpenFilePicker",this.q,0)}},o:function(n,t,i){this.C(n);this.y(t);this.x(i);this.e=3;this.br().a();this.h=!1},bz:function(){var n=this.z;n.contentWindow.document.body.innerHTML="";this.b=n.contentWindow.document.createElement("form");this.b.method="POST";this.b.encType="multipart/form-data";this.b.encoding="multipart/form-data";this.be(this.b);this.d=$(n.contentWindow.document.createElement("input"));this.d.attr("type","file");this.d.attr("name","fileInput");var t=this;this.d.change(function(n){t.w()});_a.l.a().G&&this.d[0].attachEvent("onchange",this.r);this.b.appendChild(this.d[0])},be:function(n){this.z.contentWindow.document.body.appendChild(n)},w:function(){if(!this.h){this.h=!0;var n=this.d[0].value;if(!_j.i.a(n)){this.i().e(this.bQ(n));this.bk().a()}}},bQ:function(n){var t=n.lastIndexOf("\\");return n.substr(t+1)},bg:function(){this.d[0].click()},bU:function(){this.k=!1;this.b.action=_g.x.i();this.v()},bR:function(){this.k=!0;this.b.action=_g.x.l();this.f("subscriptionId",this.W().l());this.v()},v:function(){_j.e.a(_at.c.a,"Uploading attachment via form submit.");this.f("parentItemId",this.j().Id);this.f("parentChangeKey",this.j().ChangeKey);this.f("isInline",this.i().a().toString());this.f("cancellationId",this.W().bF());this.f(_a.A.c(),_a.A.e());this.b.submit();this.e=2},f:function(n,t){var i=$(this.b.ownerDocument.createElement("input"));i.attr("type","hidden");i.attr("name",n);i.val(t);this.b.appendChild(i[0])}};_at.H=function(n,t,i,r,u){this.i=Function.createDelegate(this,this.m);this.k=Function.createDelegate(this,this.n);_at.H.initializeBase(this,[n]);this.y("InlineImageAttachment");this.a=t;this.d=i;this.c=r;this.h=u;this.g=this.a[this.d];this.j=new _j.g(this.k,_a.a.c);if(this.l()){this.a[this.d]=null;this.e(!1)}else this.e(!0);$(this.c).bind("load",this.i)};_at.H.prototype={c:null,a:null,g:null,b:null,d:0,f:!1,j:null,h:null,bF:function(){$(this.c).unbind("load",this.i);this.a=null;this.g=null;this.b&&this.b.dispose();_j.c.prototype.bF.call(this)},I:function(){_j.c.prototype.I.call(this);this.z.style.display="inline-block";if(this.C){this.b=this.C.a("ImageContainerButton");this.b.p(this.f);if($(this.z).parents("a").length){this.b.z.parentNode.replaceChild(this.c,this.b.z);this.b.dispose();this.b=null}else this.b.z.appendChild(this.c)}},G:function(){_j.c.prototype.G.call(this);this.a[this.d]||this.e(!1)},n:function(){this.h&&this.h(this.a,this.d,!1)},m:function(n){if(this.l()){this.a[this.d]=null;this.e(!1)}else{this.a[this.d]=this.g;this.e(!0);var r=this.c.src;var t=this.c.getAttribute("data-downloadImage");var i=this.c.getAttribute("data-thumbnailImage");this.a[this.d].ImageUrl=this.c.src;this.a[this.d].ThumbnailUrl=i;this.a[this.d].PhotoPageUrl=t}},l:function(){var n=this.c;return n.naturalWidth<50||n.naturalHeight<50},e:function(n){this.f=n;this.b&&this.b.p(this.f);return n}};_at.X=function(){};_at.X.prototype={changePermission:0,convertLocalToRef:1,convertRefToLocal:2,copyLinkToClipboard:3,download:4,importIcsAttachment:5,moveAttachmentToInline:6,openInNewTab:7,preview:8,saveToCloud:9,viewInProvider:10};_at.X.registerEnum("_at.X",!1);_at.bC=function(){};_at.bC.registerInterface("_at.bC");_at.bE=function(){};_at.bE.registerInterface("_at.bE");var IAttachmentPreviewViewModelFactory=function(){};IAttachmentPreviewViewModelFactory.registerInterface("IAttachmentPreviewViewModelFactory");_at.Y=function(){};_at.Y.registerInterface("_at.Y");_at.bF=function(){};_at.bF.registerInterface("_at.bF");_at.bG=function(){};_at.bG.registerInterface("_at.bG");var IFilePreviewViewModelFactory=function(){};IFilePreviewViewModelFactory.registerInterface("IFilePreviewViewModelFactory");_at.u=function(){};_at.u.registerInterface("_at.u");_at.bD=function(){};_at.bD.registerInterface("_at.bD");_at.bo=function(n,t,i,r){_at.bo.initializeBase(this,[1,"AttachmentContextMenuClickDatapoint"]);this.a.C=_at.X.toString(n);this.a.X=t;this.a.E=i.toString();this.a.Z=r.toString()};_at.j=function(n){this.d=new _at.F;this.b=new _at.F;this.e=n};_at.j.c=function(n){var t;var r,i;return(i=_at.j.b(n,r={val:t}),t=r.val,i)?_at.j.a(t):null};_at.j.a=function(n){switch(n){case 0:return new _at.A(_u.n.Ei);case 1:return new _at.P(_u.n.KW);case 2:return new _at.N(_u.n.OK);case 3:return new _at.M(_u.n.DO);case 5:return new _at.z(_u.n.FV);case 4:return new _at.O(_u.n.KW);case 6:return new _at.br(_u.n.NC);default:_j.e.b(_a.a.c,"TryParseDataProviderType: unimplemented data provider type: {0}",n);return null}};_at.j.b=function(n,t){try{t.val=_j.t.b(_g.p,n);return!0}catch(i){t.val=null;_j.e.b(_a.a.c,"TryParseDataProviderType: unknown data provider type: {0}",n);return!1}};_at.j.prototype={e:!1,h:function(){return this.b.f()>0},g:function(n){this.b!==n&&(this.b=n);return n},a:function(){return this.e?this.c(1):this.c(0)},f:function(n){var t;var r,i;return(i=_at.j.b(n,r={val:t}),t=r.val,i)?this.c(t):null},c:function(n){if(this.d.d(n))return this.d.e(n);var t=_at.j.a(n);t&&this.d.b(n,t);return t}};_at.x=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.j=n;this.e=t;this.l=i;this.f=r;this.c=u;this.b=f;this.o=e;this.k=o;this.h=s;this.a=h;this.g=c;this.i=l;this.d=a;this.n=v;this.m=y};_at.x.prototype={j:null,e:null,l:null,f:null,c:null,b:null,o:null,k:null,h:null,a:null,g:null,i:null,d:null,n:null,m:null};_at.y=function(n,t,i,r,u){this.b=_j.i.a(n)?"#":n;this.d=t;this.a=i;this.c=r;this.f=u;this.e=u?_nbs.a.TT:_nbs.a.Jd;_j.e.a(_a.a.c,'AttachmentDownloadLinkViewModel isHidden={0}, preventNavigation={1}, text="{2}", URL={3}',this.c,this.d,this.e,this.b)};_at.y.c=function(n,t,i){_a.b.a(n,"viewModel");_a.b.a(i,"owaShell");var r;var f;var u;if(t){var h,c,l;_at.y.b(n,h={val:f},c={val:r},l={val:u}),f=h.val,r=c.val,u=l.val}else{var e,o,s;_at.y.a(n,e={val:f},o={val:r},s={val:u}),f=e.val,r=o.val,u=s.val}if(_at.b.isInstanceOfType(n)){var a=n;a.bH.a()&&(r=!0)}return new _at.y(f,r,u,!1,t)};_at.y.a=function(n,t,i,r){var u=!1;if(_at.b.isInstanceOfType(n)){var f=n;u=f.bH.a()}if(!n.bq.d||u||n.bq.f||n.bm.bk.IsSmimeDecoded){i.val=!0;t.val="#";r.val=n.ca;return}switch(n.bq.a){case 3:i.val=!1;t.val=n.bw;r.val=n.gj;break;case 2:i.val=!0;r.val=n.ca;t.val=n.bw;break;case 1:i.val=!0;t.val="#";r.val=n.ca;break;case 0:default:i.val=!0;t.val="#";r.val=n.ca;break}};_at.y.b=function(n,t,i,r){if(n.bm.bk.IsSmimeDecoded){i.val=!0;t.val="#";r.val=n.ca;return}switch(n.br()){case 5:i.val=!0;t.val="#";r.val=n.fW;break;case 3:i.val=!0;t.val="#";r.val=n.cR;break;case 1:case 2:i.val=!0;t.val="#";r.val=n.bq.a===3?new _j.g(function(){n.bn&&n.bn.ck(n)},_a.a.c):n.ca;break;default:_at.y.a(n,t,i,r);break}};_at.y.prototype={d:!1,b:null,a:null,e:null,c:!1,f:!1};_at.p=function(n,t,i,r,u){this.c=n;this.e=t;this.d=i;this.b=r;this.a=u};_at.p.prototype={c:null,a:!1,e:null,d:0,b:0};_at.bp=function(n,t,i,r,u){_at.bp.initializeBase(this,[1,"AttachmentUploadDatapoint"]);this.a.S=n;this.a.T=t.toString();this.a.E=i;this.a.X=r;this.a.Z=u.toString()};_at.L=function(n){_at.L.initializeBase(this);this.e=n;var t=this;this.d=new _j.g(function(){t.a(!1)},_a.a.c)};_at.L.prototype={c:!1,e:!1,d:null,b:function(){return this.c},a:function(n){if(this.c===n)return n;this.c=n;this.eu("IsShown");return n},o:function(){return 600},p:function(){return 300},g:function(){return!0}};_at.a=function(n,t,i,r,u,f,e,o,s,h,c){this.gK=Function.createDelegate(this,this.iO);this.gL=Function.createDelegate(this,this.iP);this.gZ=Function.createDelegate(this,this.jP);this.ha=Function.createDelegate(this,this.jQ);this.gX=Function.createDelegate(this,this.jN);this.gY=Function.createDelegate(this,this.jO);this.hc=Function.createDelegate(this,this.jT);this.hd=Function.createDelegate(this,this.jU);this.fe=Function.createDelegate(this,this.jE);this.fc=Function.createDelegate(this,this.iV);this.ff=Function.createDelegate(this,this.jS);this.gU=Function.createDelegate(this,this.jC);this.gV=Function.createDelegate(this,this.jD);this.gS=Function.createDelegate(this,this.iW);this.fd=Function.createDelegate(this,this.iX);this.gE=Function.createDelegate(this,this.iH);this.gF=Function.createDelegate(this,this.hq);this.fb=Function.createDelegate(this,this.hr);this.dD=Function.createDelegate(this,this.hK);this.dB=Function.createDelegate(this,this.cn);this.dC=Function.createDelegate(this,this.dO);this.gP=Function.createDelegate(this,this.iT);this.gQ=Function.createDelegate(this,this.iU);this.gN=Function.createDelegate(this,this.hs);this.hb=Function.createDelegate(this,this.jR);this.gO=Function.createDelegate(this,this.iS);this.fa=Function.createDelegate(this,this.fo);this.hm=Function.createDelegate(this,this.kK);this.gH=Function.createDelegate(this,this.iM);this.hl=Function.createDelegate(this,this.ks);this.gW=Function.createDelegate(this,this.jM);this.hh=Function.createDelegate(this,this.hR);this.hn=Function.createDelegate(this,this.kM);this.gM=Function.createDelegate(this,this.iQ);this.gD=Function.createDelegate(this,this.iG);this.hg=Function.createDelegate(this,this.jX);this.gG=Function.createDelegate(this,this.iI);this.gJ=Function.createDelegate(this,this.L);this.gI=Function.createDelegate(this,this.iN);this.hj=Function.createDelegate(this,this.ka);this.hi=Function.createDelegate(this,this.hT);this.hf=Function.createDelegate(this,this.eh);this.hk=Function.createDelegate(this,this.kn);this.gR=Function.createDelegate(this,this.db);this.he=Function.createDelegate(this,this.jV);this.dS=new _at.W;_at.a.initializeBase(this);this.bN=c.j;this.hV=c.m;this.bp=c.c;this.dH=c.b;this.fs=f;this.fU=e;this.cQ=o;this.fm=c.g;this.dc=c.i;this.da=c.d;this.dt=c.n;if(this.bp){this.fL=this.bp.a().p().Enabled;this.cD=this.bp.a().bn().Enabled;this.fI=this.bp.a().ei().Enabled;this.ee=this.bp.a().b().Enabled;this.fK=this.bp.a().er().Enabled;this.fN=this.bp.a().ce().Enabled;this.fJ=this.bp.a().bE().Enabled;this.dk=this.bp.a().G().Enabled;this.eg=this.bp.a().bK().Enabled;this.fO=this.bp.a().dW().Enabled}n||_j.e.c(_at.a.a,"Attachment is null in AttachmentViewModel ctor");this.ga(n);this.bB=t;this.bs=c.e;this.bZ=c.k;this.bI=c.f;this.cP=c.l;this.cO=c.a;this.cC=!1;this.dv=!1;_dg.c.isInstanceOfType(n)&&(this.bL=n.bk.Content);this.bA=i;this.bP=r;this.ce=h;this.bQ=s;this.gd(!this.bA);this.hW(_a.bh.a(n.bk.Name));this.bR=_at.G.a(u);this.ig(_at.g.a().a(this.bv,this.bm.bk.ContentType,!0,this.cK()));this.bm&&this.bm.bk.AttachmentId&&this.el(this.bq.b);this.cH();this.dy();this.eN();this.gr();this.cV();this.ca=new _j.g(this.he,_at.a.a);this.dR=new _j.g(this.gR,_at.a.a);this.gj=new _j.g(this.hk,_at.a.a);this.fW=new _j.g(this.hf,_at.a.a);this.cR=new _j.g(this.hi,_at.a.a);this.fY=new _j.g(this.hj,_at.a.a);this.fu=new _j.g(this.gI,_at.a.a);this.fv=new _j.g(this.gJ,_at.a.a);this.fq=new _j.g(this.gG,_at.a.a);this.fP=new _j.g(this.hg,_at.a.a);this.fl=new _j.g(this.gD,_at.a.a);this.fw=new _j.g(this.gM,_at.a.a);this.gv=new _j.g(this.hn,_at.a.a);this.fX=new _j.g(this.hh,_at.a.a);this.fQ=new _j.g(this.gW,_at.a.a);if(this.bp&&this.bp.a().bc().Enabled){this.go=new _j.g(this.hl,_at.a.a);this.ft=new _j.g(this.gH,_at.a.a)}(this.dk||this.eg)&&(this.cc=new _at.bu(this.bp));this.ib(u);this.cW=new _y.ca;this.gk=c.o;this.eU();this.bA||this.gm()};_at.a.o=function(){return"AttachmentViewModelSaveToCloudNotification"+(_a.c.a().h()+_ff.o.a(0,1e6)).toString()};_at.a.l=function(n,t){if(n.bk.IsSmimeDecoded){t.val=6;return!1}var r=!1;var i=_a.bh.a(n.bk.Name);i&&(r=_at.a.d.g(i.toLowerCase()));if(!r){t.val=6;return!1}var u=_dg.b.isInstanceOfType(n);_j.e.a(_at.a.a,"Attachment Type: {0}",u?"Cloudy":"Local");t.val=7;return!0};_at.a.m=function(n,t){if(n.bk.IsSmimeDecoded||_dg.b.isInstanceOfType(n)){t.val=6;return!1}var r=!1;var i=_a.bh.a(n.bk.Name);i&&(r=_at.a.n.g(i.toLowerCase()));if(!r){t.val=6;return!1}t.val=8;return!0};_at.a.k=function(n,t){if(n.bk.IsSmimeDecoded){t.val=6;return!1}if(_dg.b.isInstanceOfType(n)){t.val=6;return!1}var r=!1;var i=_a.bh.a(n.bk.Name);i&&(r=_at.a.h.g(i.toLowerCase()));if(!r){t.val=6;return!1}_j.e.a(_at.a.a,"Attachment Type: Local");t.val=9;return!0};_at.a.prototype={bp:null,fL:!1,cD:!1,fK:!1,fI:!1,fN:!1,fJ:!1,dk:!1,eg:!1,fO:!1,bR:null,bZ:null,fm:null,ca:null,dR:null,gj:null,fW:null,cR:null,fY:null,fl:null,fu:null,fv:null,fq:null,dQ:null,fS:null,fT:null,fP:null,fw:null,gv:null,fX:null,fQ:null,cW:null,bA:!1,bP:!1,ee:!1,bB:null,bs:null,cO:null,bK:null,dH:null,bN:null,bI:null,cP:null,dc:null,bm:null,bw:null,et:null,bC:0,bM:0,by:0,bz:0,dp:!1,ct:!1,fr:!1,dI:!1,gt:!1,hP:!1,bq:null,bn:null,hO:!1,cF:!1,es:null,er:null,cy:0,co:null,cJ:0,eQ:null,cM:null,ec:null,dK:!1,dL:!1,cl:null,dr:!1,bx:!1,cm:!1,ck:0,fn:null,di:!1,ef:!1,cC:!1,dv:!1,bv:null,cS:null,bY:null,cw:!1,eo:!1,dh:null,cY:null,dj:!1,bL:null,bU:null,cI:null,bD:null,cu:null,ej:null,dM:null,dN:null,cE:!1,dP:null,fx:null,bt:null,cg:!1,fs:null,cQ:null,dx:null,gk:null,cN:!1,bO:!1,dJ:null,cz:null,bE:0,bS:1,dw:0,bG:null,ce:null,da:null,dt:null,bQ:null,dq:!1,ei:null,dn:null,dm:null,bX:0,bW:0,eJ:null,cs:null,cX:null,bJ:null,fU:null,eR:null,gn:!1,cT:!1,cG:!1,go:null,ft:null,ch:0,cc:null,hV:null,ci:function(n){if(this.ch!==n&&this.bV()){this.ch=n;this.eu("ProgressBarValue");this.eu("ShowProgressBar");this.ch||this.eP()}return n},jA:function(){return!!this.ch},gl:function(){_j.e.a(_at.a.a,"Starting attachment upload.");var t=this,n=this;_g.k.a.E("CreateAttachment",this.hm,this.iR(),function(n){_j.e.a(_at.a.a,"Upload attachment enqueued. UploadOnlineOnlyAttachment will be called when we have connection to the server.")},function(t){_j.e.b(_at.a.a,"Enqueueing upload attachment failed: {0}",t.message);n.cj(1,_at.k.a(t),!0);n.dG(null)})},fi:!1,fg:null,fh:!1,dE:null,K:function(n){this.ez("OnUploadCompleteEvent",n)},z:function(n){this.eA("OnUploadCompleteEvent",n)},iE:function(n){this.ez("OnUploadFailedEvent",n)},bc:function(n){this.eA("OnUploadFailedEvent",n)},G:function(n){this.ez("OnDeleteCompleteEvent",n)},ba:function(n){this.eA("OnDeleteCompleteEvent",n)},I:function(n){this.ez("OnDownloadCompleteEvent",n)},bb:function(n){this.eA("OnDownloadCompleteEvent",n)},F:function(n){this.ez("OnCancelCompleteEvent",n)},jZ:function(n){this.eA("OnCancelCompleteEvent",n)},J:function(n){this.ez("OnSetSharingSettings",n)},y:function(n){this.eA("OnSetSharingSettings",n)},cv:function(n){if(n!==this.eJ){this.eJ=n;this.cT=!1;this.eB(["ThumbnailInfo","IsThumbnailImage","ShowDefaultImage","IsSuiteExtensionIconSupported","ShouldShowThumbnailPlaceholder"])}return n},cb:function(n){if(this.bC!==n){this.bC=n;this.eB(["ShouldShowSaveToCloudLabel","SaveFileToCloudStatus","SaveToCloudLabel","ShouldSizeBeHidden","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","IsViewHovered","ShouldShowCompletedStatusIcon","ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline"])}return n},ge:function(n){if(this.bM!==n){this.bM=n;this.eB(["ShouldShowAddToCalendarLabel","AddToCalendarLabel","ShouldSizeBeHidden","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","IsViewHovered","ShouldShowCompletedStatusIcon","ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline"])}return n},jv:function(){return this.ct&&!!this.bC&&this.bC!==1},jn:function(){return this.bM===2||this.bM===1},jj:function(){if(!this.bo()||!this.b())return"";switch(this.p()){case 3:return _nbs.a.hX;case 4:return _nbs.a.rf;case 6:return _nbs.a.NJ;case 5:return _nbs.a.gY;case 1:return this.b().o();case 2:return this.b().e();default:return""}},hA:function(){switch(this.bC){case 1:return this.cD&&!_j.i.a(this.bR)?_nbs.a.Fq:String.format(_nbs.a.pg,this.bn.j());case 2:return this.cD&&!_j.i.a(this.bR)?String.format(_nbs.a.kS,this.bn.g()):String.format(_nbs.a.Iq,this.bn.j(),this.bn.g());case 3:return String.format(_nbs.a.er,this.bn.g());case 4:return String.format(_nbs.a.WK,this.bn.g());case 5:return _nbs.a.pu;default:return null}},iY:function(){if(this.bM===2)return _nbs.a.Dw;else if(this.bM===1)return _nbs.a.Lx;return null},jm:function(){return this.bC===2||this.bM===1||this.de()},jl:function(){if(this.bV())return!1;var n=!1;(this.cC||this.bm&&!this.bm.bk.AttachmentId)&&(n=!0);if(n!==this.dv){this.dv=n;this.eP()}return this.dv},de:function(){return this.by===2||this.by===4||this.bz===2||this.bz===4},bV:function(){var n=new XMLHttpRequest;if(_at.i.b())return!!this.bp&&this.bp.a().cd().Enabled&&this.bp.a().cO().Enabled;else{_j.e.a(_at.a.a,"AttachmentViewModel.IsProgressBarEnabled: Unable to find Progress support in XHR");return!1}},eM:function(n){this.cC=n;this.eu("ShouldShowActivityIndicator")},il:function(){this.eB(["ShouldShowFailedStatusIcon","ShouldShowActivityIndicatorInline","ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick","ShouldSizeBeHidden","ShowDeleteButton","ShowCancelButton","IsConvertAttachmentInProgress"]);this.cV()},n:function(n){if(this.by!==n){this.by=n;this.gr();this.ey("ShouldShowConvertLocalToRefAttachmentLabel","ConvertLocalToRefAttachmentLabel");this.il()}return n},h:function(n){if(this.bz!==n){this.bz=n;this.ey("ShouldShowConvertRefToLocalAttachmentLabel","ConvertRefToLocalAttachmentLabel");this.il()}return n},hv:function(){if(this.by){if(this.by===3)return String.format(_nbs.a.WK,this.bn.g());else if(this.by===2)return String.format(_nbs.a.EB,this.bn.j(),this.bn.g());else if(this.by===4)return _nbs.a.GB}else return null;return String.format(_nbs.a.Yd,this.bn.j())},hw:function(){if(this.bz){if(this.bz===3)return _u.n.Is;else if(this.bz===2)return _u.n.RA;else if(this.bz===4)return _nbs.a.GB}else return null;return _u.n.MG},jr:function(){return this.dW()&&!!this.by&&this.by!==1},js:function(){return this.dX()&&!!this.bz&&this.bz!==1},dW:function(){return!!this.bp&&!!this.bn&&this.bp.a().bd().Enabled&&!this.bn.h()&&!_dg.b.isInstanceOfType(this.bm)&&this.br()!==4&&!this.bm.a()&&this.bn.I()&&!this.bn.b()&&!_j.i.a(this.bn.j())&&!this.dV()},dX:function(){return!!this.bp&&!!this.bn&&this.bp.a().bd().Enabled&&!this.bn.h()&&_dg.b.isInstanceOfType(this.bm)&&!this.bm.q()&&this.br()!==4&&this.bn.I()&&!this.bn.b()&&!_j.i.a(this.bn.j())&&!this.jJ()&&!this.dV()&&!this.dZ()&&!!this.b()},bk:function(){this.dM=_a.d.b(_a.a.c,"ConvertLocalAttachmentToReferenceAttachment")},bl:function(){this.dN=_a.d.b(_a.a.c,"ConvertRefToLocalAttachment")},N:function(){_a.d.a(this.dM);this.dM=null},O:function(){_a.d.a(this.dN);this.dN=null},s:function(n,t){if(!this.cc){_j.e.b(_a.a.c,"Cannot add sharing link. The handler is null.");return}this.cc.c(n,t)},m:function(n){if(!this.cc){_j.e.b(_a.a.c,"Cannot get sharing link. The handler is null.");return null}return this.cc.h(n,this.bo().bk.ProviderType)},x:function(n){if(!this.cc){_j.e.b(_a.a.c,"Cannot get sharing capability. The handler is null.");return!1}return this.cc.g(n)},ji:function(){this.ct&&this.bC&&this.bC!==1&&(this.dq=!0);return this.dq},gg:function(n){if(n!==this.dq){this.dq=n;this.eu("IsViewHovered")}return n},bd:function(n){this.cI=n;return n},br:function(){this.cy||(this.cy=this.eb());return this.cy},a:function(){return this.bm},ga:function(n){var t=this.bm;if(t!==n){t&&t.B(this.fa);this.bm=n;var i=!n;if(!i){n.H(this.fa);_j.e.a(_a.a.c,"Attachment: {0}",n.bk.Name)}this.hI(i?null:n.bk.AttachmentId);this.eu("Attachment");this.eu("ReferenceAttachment");this.eu("ReferenceAttachmentProviderTypeInfo");this.cV();this.eP();this.eu("ShouldShowActivityIndicator")}return n},p:function(){return this.bo()?this.bo().z():0},o:function(n){this.bo()&&this.bo().z()!==n&&this.bo().C(n);this.cV();this.cU();return n},t:function(){return this.bo()?this.bo().bk.AttachLongPathName:null},A:function(n){this.bo()&&this.bo().bk.AttachLongPathName!==n&&this.bo().A(n);return n},Q:function(){return this.dK},R:function(){return this.dL},kc:function(n){this.dL=n;this.dL&&(this.dK=!0);return n},bo:function(){return _dg.b.isInstanceOfType(this.bm)?this.bm:null},iZ:function(){var n=null;if(this.bo())n=this.hz();else{var t=new _b.Z;n=t.a(this.bm.b(),null)}return String.format("{0} {1}",this.bm.bk.Name,n)},hz:function(){return this.bo()&&this.bo().bk.ProviderType?this.b()?this.b().g():this.bJ:""},b:function(){return this.bo()&&!_j.i.a(this.bo().bk.ProviderType)?this.da.f(this.bo().bk.ProviderType):null},fj:null,T:function(){return this.fj},bu:function(){return this.bm&&this.bm.bk.AttachmentId?this.bm.bk.AttachmentId.Id:null},dg:function(){return!!this.bo()&&this.dY()},dY:function(){return this.br()===1||this.br()===2},jg:function(){return this.dg()&&this.bs.c()},hC:function(){return _dg.c.isInstanceOfType(this.bm)&&!this.bm.a()&&this.je()},ia:function(n){this.hO=n;this.eu("IsSelected");return n},jh:function(){if(this.bq.b||!this.bp||!this.bp.a().bj().Enabled)return!1;if(this.bm&&!(this.dn!=null)){var n=_a.bh.a(this.bm.bk.Name).replace(".","");this.dn=!!SuiteExtensions.ControlFactory.CreateControl(n,1)}return this.dn!=null?this.dn:!1},fD:function(){if(this.bq.b||this.W()||!this.bp||!this.bp.a().bj().Enabled)return!1;if(this.bm&&!(this.dm!=null)){var n=_a.bh.a(this.bm.bk.Name).replace(".","");this.dm=!!SuiteExtensions.ControlFactory.CreateControl(n,0)}return this.dm!=null?this.dm:!1},du:function(n){if(this.bw!==n){this.bw=n;_j.e.a(_at.a.a,"Attachment download URL: {0}",this.bw);this.eu("DownloadUrl")}return n},X:function(){return this.dp},bi:function(n){if(this.dp!==n){this.dp=n;this.eu("IsTriggeredPolicyTip")}return n},gd:function(n){this.fr=n;this.ey("CanDelete","ShowDeleteButton");return n},dF:!1,C:function(n){this.dF=n;return n},be:function(n){this.dI=n;this.ey("AttachmentWellPendingRefresh","ShowDeleteButton");return n},jz:function(){return(this.fr||this.dI)&&!this.de()},jx:function(){return this.by===2&&this.by!==4||this.bz===2&&this.bz!==4},gi:function(n){this.bA||this.dT()||this.gd(!n);this.gt=n;this.eu("UploadInProgress");return n},el:function(n){this.hP=n;this.eu("OpenDocumentInBrowserLinkVisible");return n},ig:function(n){this.bq=n;this.cy=this.eb();this.ij();return n},Z:function(){return this.bn},ib:function(n){if(n!==this.bn){this.bn=n;this.bn&&this.jF();this.eu("ParentWell")}return n},c:function(){return this.cF},em:function(n){if(this.cF!==n){this.cF=n;this.bn&&this.bn.bR(this);this.eu("ShouldBeHidden")}return n},gh:function(n){if(this.dr!==n){this.dr=n;this.eu("PendingNonHtml5Upload")}return n},fG:function(){this.ct&&this.bC&&this.bC!==1&&(this.cw=!0);this.dW()&&this.by&&this.by!==1&&(this.cw=!0);this.dX()&&this.bz&&this.bz!==1&&(this.cw=!0);this.bM&&(this.cw=!0);return this.cw},ki:function(n){if(this.cw!==n){this.cw=n;this.eu("ShouldSizeBeHidden")}return n},jt:function(){return this.by===3||this.bz===3||this.bC===4||this.bM===3},jp:function(){return this.bC===3||this.bM===2},hB:function(){return this.bM===1||this.ct&&this.bC===2||(this.dW()||this.dX())&&this.de()||this.cC||!this.bm||!this.bm.bk.AttachmentId||!this.cA()||!this.cA().p.x.length},kh:function(n){if(this.bJ!==n){this.bJ=n;this.eu("ReferenceAttachmentOpenUrl")}return n},cr:function(){return!1},hy:function(){return!1},ih:function(n){if(this.eo!==n){this.eo=n;this.eu("ShowPermissionsTextInCompose")}return n},hW:function(n){if(this.bv!==n){this.bv=n;this.eu("FileExtension")}return n},kk:function(n){this.es=n;this.eu("SubmitUploadFormCommand");return n},kj:function(n){this.er=n;this.eu("SubmitUploadAndShareFormCommand");return n},l:function(){this.et||(this.et=_at.a.o());return this.et},Y:function(){return this.ca},v:function(){return this.dQ},kf:function(n){this.co=n;_j.e.b(_at.a.a,"Attachment form upload error: {0}",this.co);this.eu("FormUploadError");return n},ke:function(n){this.cJ=n;_j.e.b(_at.a.a,"Attachment form upload error code: {0}",this.cJ);this.eu("FormUploadAttachmentError");return n},ii:function(n){this.eQ=n;this.eu("UploadSuccessResponse");return n},fE:function(){return!1},k:function(){return this.bx},P:function(){return this.ck},i:function(){return this.bY},g:function(n){this.bY=n;return n},dU:function(){var n=this.hH(_at.a.e,this.bm.bk.AttachmentId,_g.x.b());_j.e.a(_at.a.a,"Image preview URL: {0}",n);return n},fF:function(){return this.bo()&&this.bJ?this.bJ:null},V:function(){var n=this.ce.a(this.bm.bk.AttachmentId,this.bP,_g.x.a(),this.bR);_j.e.a(_at.a.a,"Image preview URL: {0}",n);return n},ea:function(){var n=this.ce.a(this.bm.bk.AttachmentId,this.bP,_g.x.a(),this.bR);_j.e.a(_at.a.a,"Media URL: {0}",n);return n},cq:function(){return this.hH(_at.a.f,this.bm.bk.AttachmentId,_g.x.c())},kl:function(n){if(this.cT!==n){this.cT=n;this.ey("ThumbnailLoadSucceeded","ShouldShowThumbnailPlaceholder")}return n},jw:function(){return this.W()&&!this.cT},W:function(){return this.dg()&&!_j.i.a(this.bm.bk.AttachmentThumbnailUrl)||this.hG()?this.bq.a===3:!1},jy:function(){return!this.W()&&!this.fD()},jd:function(){if(this.dh)return this.dh;var n;n=_a.g.b&&this.br()===5?!1:this.cp()?this.br()===5||!this.cf()&&(!this.bP||this.bP&&this.br()!==3):this.br()===5||this.bB.a()==="Mouse"&&this.br()!==3;_j.e.a(_at.a.a,"IconLinkViewModel preview = {0}",n);this.dh=_at.y.c(this,n,this.bB);return this.dh},cA:function(){if(!this.cY){var n=new Array(0);this.cY=new _fm.f(n)}return this.cY},kd:function(n){this.cY=n;this.eu("ContextMenu");return n},S:function(){return this.bK},hY:function(n){if(this.dj!==n){this.dj=n;this.dy()}return n},w:function(){return this.di},hX:function(n){if(this.di!==n){this.di=n;this.eu("IsDeleted")}return n},jc:function(){if(this.bo())if(_j.i.b(this.bJ)){if(this.bo().bk.AttachLongPathName)return this.bm.bk.Name+"\n \n"+this.bo().bk.AttachLongPathName}else return this.bm.bk.Name+"\n \n"+this.bJ;return this.bm.bk.Name},kg:function(n){this.bO!==n&&(this.bO=n);return n},gf:function(n){if(this.cN!==n){this.cN=n;this.eu("IsCancelling")}return n},fz:function(){_a.b.d(this.br()===5,"Invalid Operation: EmbeddedItemClass should only be invoked when the Attachment is an ItemAttachment");return this.bm.z()},U:function(){return this.bL},bf:function(n){this.bL=n;return n},fA:function(){return!!this.bp&&this.bp.a().cD().Enabled},jf:function(){return!!this.bp&&!!this.bQ&&this.bp.a().L().Enabled&&this.bQ.AttachmentDataProviderAvailable},cp:function(){return this.bq.a!==2&&this.fA()&&!this.gn&&(this.jH()||this.fH()||this.fC()||this.jh()||this.br()===1||this.br()===2||this.br()===7||this.br()===10||this.br()===8&&this.fN||this.jG())&&!this.cK()&&!this.jg()&&!this.bs.e()&&(!this.dl()||this.fM())},cf:function(){return this.bs.e()||!this.bA&&this.bB.a()==="TouchWide"||!!this.bp&&this.bp.a().dX().Enabled},kb:function(n){if(this.bU!==n){this.bU=n;this.eu("AttachmentPreviewViewModel")}return n},j:function(){return this.cE},q:function(n){this.cE=n;n&&this.el(!1);return n},hZ:function(n){if(this.cg!==n){this.cg=n;this.eu("IsOpenedInLightBox");this.eu("IsComposedInLightBox");this.dV()&&this.gd(!1);this.bn.h()||this.cU()}return n},dV:function(){_j.e.a(_a.a.a,"AttachementName={4}, IsComposedInLightBox={5}, ParentWellIsNULL={0}, isOpenedInLightBox = {1}, this.parentWell.IsReadOnly={2}, WacEdit={3}",!this.bn,this.cg,this.bn.h(),this.bq.e,this.bm?this.bm.bk.Name:"null",this.cg&&!this.bn.h()&&this.bq.e);return this.bn?this.cg&&!this.bn.h()&&this.bq.e:!1},bF:function(){!this.dJ&&this.dT()&&(this.dJ=(+new Date).toString());return this.dJ},fC:function(){return this.hx()},hx:function(){return this.fI&&this.br()===6&&!!this.bv&&_at.a.j.g(this.bv.toLowerCase())},km:function(n){if(this.eR!==n){this.eR=n;this.eu("WacStaticAssetsPreloadUrl")}return n},jq:function(){return this.df()&&!this.hB()},f:function(){return this.bX},bh:function(n){this.bX=n;return n},e:function(){return this.bW},bg:function(n){this.bW=n;return n},dT:function(){var n=!!this.bp&&this.bp.a().cD().Enabled;return!n||this.bs.c()||this.bs.t()?!1:!this.bn.b()||!!this.bZ&&this.bZ.a(this.bn.b(),"AttachmentUploadCancellation")},dd:function(){var n=!!this.bm.bk.AttachmentId;var i=n?this.bm.bk.AttachmentId.Id:null;var t=i?_bc.f.b(i):!1;var r=this.bq.c();_j.e.a(_at.a.a,"UpdateUrl: idExists={0}, isClientId={1}, policyInfo: {2}",n,t,this.bq.toString());return n&&r&&!t&&!this.bm.l()},cL:function(){return!this.bn.d()||this.bn.d().h()!==1||!this.fL},df:function(){return this.bq.a===2&&this.bB.a()==="Mouse"},jb:function(){return this.bo()?this.b()?this.b().a(this.p()):new Array(0):_at.a.g},hG:function(){return!_a.g.b&&!!this.bp&&this.bp.a().dz().Enabled&&this.dY()&&!this.bo()&&this.bm.b()<10485760&&!this.bm.a()},jk:function(){return!!this.bp&&this.bp.a().K().Enabled&&!!this.dt&&!this.ee},hF:function(){return!!this.bp&&this.bp.a().K().Enabled&&this.ee&&!_a.g.b&&!this.bo()},jF:function(){this.bK=this.bn.bc();this.ct=this.iL();this.dy();this.cV();if(!!this.bn){this.dQ=new _j.g(this.gO,_at.a.a);this.fS=new _j.g(this.hb,_at.a.a);this.fT=new _j.g(this.gN,_at.a.a)}this.cU();this.hS()},ja:function(){_j.e.a(_at.a.a,"Attachment class: {0}",this.cy);var n;switch(this.br()){case 0:case 11:case 9:n=!0;break;case 5:_j.e.a(_at.a.a,"Embedded item class: {0}",this.fz());switch(this.fz()){case 6:case 3:case 1:case 2:case 5:case 7:n=!0;break;default:n=!1;break}break;default:n=!1;break}_j.e.a(_at.a.a,"Can open: {0}",n);return n},jo:function(){return!!this.b()&&Array.contains(this.b().a(this.p()),0)&&this.jf()&&!!this.bo()&&!this.bA},ju:function(){return this.b()?this.b().i()?this.dl()&&!this.fM()?!1:!0:!1:!0},hE:function(){return!this.bo()||!!this.b()&&Array.contains(this.b().a(this.p()),4)&&!this.bo().q()&&!this.dZ()},hD:function(){if(this.dl()&&!this.fM())return!0;var n=!!this.b()&&(this.b().h()||!this.da.b.c(this.bo().bk.ProviderType));!n&&this.cB()&&(n=!this.bm.bk.ContentType||!this.cB().g(this.bm.bk.ContentType));return n},cB:function(){return this.b()?this.b().p():null},cK:function(){return this.bm.bk.IsSmimeDecoded||this.bm.l()},je:function(){return!!this.bp&&this.bp.a().dz().Enabled},dZ:function(){return!!this.bo()&&!this.bo().q()&&_j.i.a(this.bv)&&!!this.cB()&&!this.cB().g(this.bm.bk.ContentType)},dy:function(){this.bn?this.em(this.dj||this.bm.a()&&this.bn.bJ()&&!_dg.b.isInstanceOfType(this.bm)):this.em(this.dj||this.bm.a());this.em(this.cF||this.bm.n)},jJ:function(){return this.bm&&!_j.i.a(this.bm.bk.Name)?this.bm.bk.Name.endsWith(".one")||this.bm.bk.Name.endsWith(".onepkg"):!1},jR:function(){_j.e.a(_at.a.a,"File selected.");this.hY(!1);this.bn&&this.bn.bU(this)},kI:function(){_j.e.a(_at.a.a,"submitting upload to server");this.bx=!1;if(_dg.c.isInstanceOfType(this.bm)){var n=this.bm;this.gs(n)}else(_g.B.isInstanceOfType(this.bm)||_dg.i.isInstanceOfType(this.bm)||_dg.b.isInstanceOfType(this.bm))&&this.gl()},kr:function(){_j.e.a(_at.a.a,"submitting delete to server");this.bx=!1;if(!this.bn.c()){this.cd(_nbs.a.JY);this.hM(null,"ParentItemId is null");return}var n=new _at.bj(2,this.bm,this.bn.c());n.e(this.gQ);n.b(this.gP);_a.g.a.a(n)},jB:function(){var i=this.bm;var r=i.c;var n=this.dS.a();var t=this;n.f(function(){if(n.c())_j.e.b(_at.a.a,"HTML5 file reader attach failed with error code {0}",n.c());else{var r=n.b().indexOf(",");var i=n.b().substring(r+1,n.b().length);t.bL=n.b().substring(0,r).indexOf("base64")!==-1?i:_a.bl.b(i);t.eD("OnUploadCompleteEvent",t)}});try{n.e(r)}catch(u){this.bs.f()&&u.name==="NS_ERROR_FILE_ACCESS_DENIED"?_j.e.a(_at.a.a,"Firefox: failed to read an attachment. Exception: {0}",u.message):_j.e.d(_at.a.a,u,"Unexpected exception was thrown by FileReader.ReadAsDataURL.")}},jY:function(){this.bL=null;this.eD("OnDeleteCompleteEvent",this);if(this.bt){this.bt.j=this.cZ(1);_a.d.a(this.bt);this.bt=null}},kt:function(){this.cu=_a.d.b(_a.a.c,"AttachmentUploadQueue")},eL:function(n){if(this.cu){this.cu.k=n;this.cu.j=this.ht(!1);_a.d.a(this.cu);this.cu=null}},kv:function(){this.eL("");this.cI&&(this.bD=_a.d.b(_a.a.c,this.cI))},ik:function(){if(this.bD){var n="";this.bx&&(n=this.fn);var t=n.match(new RegExp("[a-zA-Z]+Exception"));if(t&&t.length>0){this.bD.k=t[0];this.bD.m=n}else if(this.ck){this.bD.k=_y.bc.toString(this.ck);this.bD.m=n}else this.bD.k=n;this.bD.j=this.ht(!0);_a.d.a(this.bD);var r=this.bD.n.j&1024?+new Date:this.bD.n.l;var i=new _at.bp(this.bD.e(),r-this.bD.n.k,n,this.bv,this.bm.b());_a.r.c.a(i);this.bD=null}},M:function(){_j.e.a(_at.a.a,"Getting attachment content from server");this.bx=!1;var n=new _at.bl(_at.a.a,this.bm,this.bR);var i=this;n.b(function(){i.eD("OnDownloadCompleteEvent",i);i.el(!1)});var t=this;n.e(function(){_j.e.b(_at.a.a,"Download failed with error: {0}",n.J.message);t.bx=!0;t.cE||t.dO(n)});_a.g.a.a(n)},iV:function(n,t){n&&this.db()},ed:function(n){if(_g.B.isInstanceOfType(this.bm)||_dg.i.isInstanceOfType(this.bm)){_j.e.a(_at.a.a,"Uploading item or id attachment.");this.kJ()}else if(_dg.c.isInstanceOfType(this.bm)){var t=this.bm;if(this.bL){_j.e.a(_at.a.a,"Uploading file attachment with pasted image from clipboard.");this.ek(this.bL)}else if(t.bk.Content){_j.e.a(_at.a.a,"Uploading file attachment with content.");this.ek(null)}else if(t.a()&&_a.cE.isInstanceOfType(this.bm.c)&&_at.b.isInstanceOfType(this)){_j.e.a(_at.a.a,"Uploading inline PAL image with content.");this.ip()}else if(this.bs.o()){_j.e.a(_at.a.a,"Uploading HTML5 file attachment.");this.bG=t.c;this.im()}else{_j.e.a(_at.a.a,"Uploading Non-HTML5 file attachment.");this.gu()}}else if(_dg.b.isInstanceOfType(this.bm)){this.ef=!0;if(this.bs.o()){_j.e.a(_at.a.a,"Uploading HTML5 reference attachment.");var i=this.bm;this.bG=i.c;this.im()}else{_j.e.a(_at.a.a,"Uploading Non-HTML5 reference attachment.");this.gu()}}else{_j.e.c(_at.a.a,"Unsupported upload type.");n(null)}},eb:function(){var n=0;if(_dg.c.isInstanceOfType(this.bm))if(this.bq.a===1)n=4;else if(this.fH())n=10;else if(this.bq.b)n=3;else{var e,f;if(f=_db.l.c(this.bm,e={val:n}),n=e.val,!f){var s,o,i,t;if((o=_at.a.l(this.bm,s={val:n}),n=s.val,!o)&&(t=_at.a.m(this.bm,i={val:n}),n=i.val,!t)){var u,r;(r=_at.a.k(this.bm,u={val:n}),n=u.val,r)||(n=6)}}}else n=_dg.i.isInstanceOfType(this.bm)?5:_g.B.isInstanceOfType(this.bm)?11:4;return n},cH:function(){if(!this.ce){_j.e.c(_a.a.c,"DownloadAuthenticator is NULL.");return}if(this.dd()){this.du(this.ce.a(this.bm.bk.AttachmentId,this.bP,null,this.bR));this.ho()&&this.du(this.bw+"&isDocumentPreview=True")}else this.du(null)},dO:function(n){this.cj(1,_at.k.c(n),!0)},hr:function(n){this.bE<this.bS-1&&!this.bO&&this.io()},cj:function(n,t,i){this.bx=!0;this.eM(!1);if(this.bO)_j.e.a(_at.a.a,"Attachment create failed callback after cancellation with cancellationId:{0} error: {1}, {2}",this.bF(),n,t);else{_j.e.b(_at.a.a,"Attachment create failed with cancellationId: {0} error: {1}, {2}",this.bF(),n,t);this.ck=n;this.fn=t;if(this.bn&&this.bn.r(this.bK)){this.bn.l(this,!1);this.dF&&this.bn.N()}}this.eD("OnUploadFailedEvent",this)},cn:function(n){if(_at.i.isInstanceOfType(n)){var t=n;if(t.r<t.k-1)return}this.ci(100);var i=this;_j.n.a().a(_at.a.a,"CreateAttachmentActionCompleted",function(){i.ci(0)},500);this.dG(n)},eN:function(){this.gh(!this.bA&&this.bs.t()&&!this.bm.bk.AttachmentId&&!_g.B.isInstanceOfType(this.bm))},fo:function(n,t){if(t==="Thumbnail"){this.ij();return}t==="ProviderType"&&this.eB(["PermissionsTextInCompose","ReferenceAttachmentProviderTypeInfo","DataProviderInfo"]);if(t==="ContentType"||t==="Name"||t==="AttachmentId"||t==="ProviderType"){t==="Name"&&this.hW(_a.bh.a(this.bm.bk.Name));if(t==="ContentType"||t==="Name"){this.ig(_at.g.a().a(this.bv,this.bm.bk.ContentType,!0,this.cK()));this.dy()}if(t==="AttachmentId"){this.hI(this.bm.bk.AttachmentId);this.eN();this.eP()}(t==="AttachmentId"||t==="Name")&&this.bn&&_dg.b.isInstanceOfType(this.bm)&&this.bn.bw(!0);this.cH();this.cU()}},ek:function(n){var f=this.bm;if(n){f.q(n);if(this.bE===this.bS-1&&this.bm.a()){var i=0;var t=0;var u,r;_at.f.c(this.bm.bk.ContentType,n,u={val:i},r={val:t}),i=u.val,t=r.val;this.bX=i;this.bW=t;this.bY=this.bn.J(this.bm.bk.Name,this.bX,this.bW)}}this.hU(f,!1)},fZ:function(n){var t=this.bm;if(n){t.c=n;t.q("")}this.hU(t,!0)},gu:function(){this.es.a()},hs:function(){_j.i.a(this.co)||this.cj(this.cJ,this.co,!1);this.dG(null)},cd:function(n){this.dc.a(_a.v,new _a.v([n],1,null,0,!1,_nbs.a.S,null,null,this.cQ,null))},gs:function(n){this.gl()},ip:function(){_j.e.a(_at.a.a,"Submitting action for PAL attachment upload.");var n=new _at.bi(2,this.bm,this.bn.c(),this.bF(),this.bn.b(),this.cL());n.e(this.dC);n.b(this.dB);_a.g.a.a(n)},fy:function(n){_j.e.a(_at.a.a,"Not a PAL file attachment.")},fV:function(n,t){this.hN(n,t)},fR:function(n,t){this.cl=t;this.hS();_j.e.a(_at.a.a,"Attachment ID: {0}",this.cl?this.cl.Id:"null")},ex:function(){var n;_a.h.a(n={val:this.bU}),this.bU=n.val;_a.jb.prototype.ex.call(this)},hN:function(n,t){_j.e.b(_at.a.a,"Opening attachment with URL {0}",n);this.bN&&this.bn&&this.bn.c()&&this.bN.d(this.bn.c(),"Downloaded",this.bv,!!this.bo());if(this.bs.c())if(this.cO.b(this.cO.d())&&this.cO.d().b().a()){_j.e.a(_at.a.a,"Launch URL from nativeBridge");this.cO.d().a(n)}else{_j.e.a(_at.a.a,"Creating an anchor element to download file as OpenInTarget doesn't work in PAL");var r=document.createElement("a");r.href=n;var i=document.createEvent("MouseEvent");i.initMouseEvent("click",!1,!1,window.self,0,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,0,null);r.dispatchEvent(i)}else t?this.cW.a(n,"_self"):this.cW.a(n,"_blank")},cU:function(){for(var n=new _fm.f(new Array(0)),i=this.jb(),t=0;t<i.length;t++)switch(i[t]){case 0:this.kw(n);break;case 1:this.kx(n);break;case 2:this.ky(n);break;case 3:this.kz(n);break;case 4:this.kA(n);break;case 5:this.kB(n);break;case 6:this.kC(n);break;case 7:this.kD(n);break;case 8:this.kE(n);break;case 9:this.kF(n);break;case 10:this.kG(n);break}this.bp&&this.bp.a().bc().Enabled&&n.J(this.ft);this.kd(n)},iF:function(n){!this.bs.c()&&this.hE()&&n.p.a(new _fm.d(_nbs.a.Jd,null,this.dR))},jW:function(n){this.bs.c()?n.p.a(new _fm.d(_nbs.a.Ux,null,this.dR)):this.bo()&&n.p.a(new _fm.d(_nbs.a.TT,null,this.fX))},jX:function(){this.bn.bW(this);this.bT(0)},hU:function(n,t){_j.e.a(_at.a.a,"Submitting server action for file attachment with content.");var r=null;if(this.bV()){r=this.dD;this.bE||this.ci(10)}var i=new _at.i(2,n,this.bn.c(),this.bF(),this.bn.b(),this.cL(),r,t,this.bE,this.bS);i.e(this.dC);i.d(this.fb);i.b(this.dB);_a.g.a.a(i)},hK:function(n){var r=65;if(this.bG){var i=this.bG.a();var t=this.bE*14680064;var e=this.bE<this.bS-1?14680064:i-t;var f=e*n/100;var u=(t+f)*r/i;n===100&&this.bE===this.bS-1?this.kp():this.ci(10+u)}else this.ci(10+r*n/100)},kp:function(){var n=this;var t=_j.n.a().e(_at.a.a,"HandleUploadProgress.ShowFakeProgress",function(){n.ch>0&&n.ch<95&&n.ci(n.ch+1)},500);var i=this;_j.n.a().a(_at.a.a,"HandleUploadProgress.CancelFakeProgressTask",function(){_j.n.a().b(t)},1e4)},bj:function(n){this.ei=n;return n},iS:function(){if(!this.bA&&!this.hJ(0)){_j.e.a(_at.a.a,"Deleting attachment.");this.bt=_a.d.b(_a.a.c,"AttachmentDeleteAttachment");this.hX(!0);var n="";var r=this.bp.a().cO().Enabled&&this.cC;var i=!!this.bm.bk.AttachmentId&&!!this.bm.bk.AttachmentId.Id&&!this.bm.bk.AttachmentId.Id.startsWith("smime-")&&!r;if(i){_j.e.a(_at.a.a,"Deleting attachment from server.");this.bn.l(this,!1);this.bn.bZ(this)}else if(this.gt)if(this.dT())this.fp();else{_j.e.c(_at.a.a,"Somehow a user was able to try to delete an attachment in the process of being uploaded.");this.bt.k=n="DeleteInProcess"}else{if(_dg.c.isInstanceOfType(this.bm)){var t=this.bm;this.fy(t)}else _j.e.a(_at.a.a,"Not a file attachment.");this.bn.l(this,!0);n="DeletedWhileInQueue"}if(this.bt){this.bt.j=this.cZ(0);_a.d.a(this.bt);this.bt=null}this.cu&&this.eL(n)}},fp:function(){if(!this.cN){_j.e.a(_at.a.a,"Cancel attachment with cancellationId {0}",this.bF());this.cm=!1;this.gf(!0);var n=new _at.bb(this.bF());n.d(this.gF);n.e(this.gE);_a.g.a.a(n)}},kK:function(n,t,i){this.gi(!0);if(this.di){_j.e.a(_at.a.a,"Attachment skipped because it's been deleted while it was pending.",this.bm.bk.Name);t(null);return}var u=n;var r=u.Body.ParentItemId;this.bn.c().Id=r.Id;this.bn.c().ChangeKey=r.ChangeKey;this.cS=t;this.ed(t)},im:function(){this.dP=this.dS.a();var i=!0;var t=!0;this.bV()&&this.ci(3);if(!_j.i.a(this.bn.b())){i=!!this.bZ&&this.bZ.a(this.bn.b(),"SlicedAttachments");t=!!this.bZ&&this.bZ.a(this.bn.b(),"ClassicSlicedAttachments")}var n=!!this.bp&&!!this.bp.a();var u=_dg.b.isInstanceOfType(this.bm)&&i&&n&&this.bp.a().bf().Enabled;var r=!_dg.b.isInstanceOfType(this.bm)&&t&&n&&this.bp.a().cN().Enabled;if((u||r)&&this.bs.o()&&this.bF()){this.bE=-1;this.dw=_dg.b.isInstanceOfType(this.bm)?10485760:14680064;this.bS=Math.ceil(this.bG.a()/this.dw);_dg.b.isInstanceOfType(this.bm)||this.eM(!0);this.io()}else if(this.bV()&&!this.bm.a()){_j.n.a().c(_at.a.a,"AttachmentViewModel.UploadHtml5Attachment",this.fd);this.fZ(this.bG)}else this.iq(this.hC(),this.bG)},io:function(){var t=this.hC();if(!this.bn||!this.bn.k()){_j.e.a(_at.a.a,"The attachment upload seems to have been stopped. Aborting further uploads.");return}if(t&&(this.bS>1||this.bV())){_j.n.a().c(_at.a.a,"AttachmentViewModel.UploadNextSlice",this.fd);t=!1}var n=this.bG;this.bE++;var r=this.dw*this.bE;var u=Math.min(r+this.dw,n.c.size);var i=n.c.slice(r,u,n.c.type);this.bV()&&!this.bm.a()?this.fZ(i):this.iq(t,new _db.bt(i))},iq:function(n,t){var i=this;this.dP.a(t,function(n,t,r,u){t&&i.cv(new _at.p(t,null,r,u,!1));i.ek(n)},this.gS,_at.a.a,n)},iX:function(){this.fx=this.dS.a();if(this.bG.a()<=10485760){var n=this,t=this;this.fx.a(this.bG,function(t,i,r,u){i&&n.cv(new _at.p(i,null,r,u,!1))},function(){},_at.a.a,!0)}},iW:function(){this.cj(2,_at.k.f(this.dP),!1);this.dG(null)},kJ:function(){_j.e.a(_at.a.a,"Submitting action for item or id attachment.");var t=null;if(this.bV()){t=this.dD;this.ci(10)}var n=new _at.i(2,this.bm,this.bn.c(),this.bF(),this.bn.b(),this.cL(),this.dD,!1,0,1);n.e(this.dC);n.b(this.dB);_a.g.a.a(n)},iR:function(){var t=this.bn.c();var n=new _g.g(t.Id);n.ChangeKey=t.ChangeKey;var i=new _gg.el(n);return new _gg.ek(null,i)},dG:function(n){var f=this.bx?_y.bc.toString(this.ck):"";_j.e.a(_at.a.a,"Attachment create completed. Status: {0} CancellationId: {1}",f,this.bF());this.eM(!1);if(!this.bO){if(this.cS){n&&_at.i.isInstanceOfType(n)&&this.ii(n.bj());this.cS(this.eQ)}this.gi(!1);this.el(!this.bx&&this.bq.b);if(_dg.i.isInstanceOfType(this.bm)){this.bn.l(this,!1);this.ga(n.f);this.cH();this.bn.F(this)}if(this.ko()){_j.e.a(_at.a.a,"Incrementing parent well size.");(!n||this.bn.r(this.bK))&&this.bn.bT(this.bm.b());this.gr()}if(_dg.b.isInstanceOfType(this.bm)){var u=this.bm.c;if(_y.D.isInstanceOfType(u)){var r=u;this.fj=r.c();!_j.i.a(r.h())&&this.dg()&&this.cv(new _at.p(r.h(),null,200,150,!0))}if(n&&_at.I.isInstanceOfType(n)){var t=n.N;if(t&&t.ResponseMessages&&t.ResponseMessages.Items&&t.ResponseMessages.Items.length>0){var i=t.ResponseMessages.Items[0];i&&i.Attachments&&i.Attachments.length>0&&this.bm.i(i.Attachments[0].ContentType)}}this.gm()}this.cU()}this.eD("OnUploadCompleteEvent",this)},gm:function(){if(!this.cM&&this.bp&&this.bp.a().bL().Enabled&&this.bo()&&!_j.i.a(this.bo().bk.AttachLongPathName)&&this.bo().bk.ProviderType&&this.bo().bk.ProviderType===_g.p.toString(0)&&!_db.l.a(this.p())){this.ec=_a.d.b(_a.a.c,"AttachmentsGetSharingInfoAction");this.cM=new _db.I(this.bo().bk.AttachLongPathName);this.cM.d(this.gV);this.cM.e(this.gU);this.bI.a(this.cM)}},jD:function(n){_j.e.a(_a.a.c,"GetSharingInfoAction succeeded for attachment id {0}.",this.bu());_a.d.a(this.ec);if(_db.I.isInstanceOfType(n)){var i=n;var t=i.f;if(t&&this.bn&&this.bn.a().w(this)&&!_j.i.a(this.bu())){t.CanShareInternally||this.kc(!0);t.CanShareExternally||(this.dK=!0);this.bn&&this.bn.bw(!1);if(this.cc&&(this.dk||this.eg)){this.cc.i(t);this.eC("OnSetSharingSettings")}}}},jC:function(n){_a.d.a(this.ec);_j.e.a(_a.a.c,"GetSharingInfoAction failed for attachment Id: {0}",this.bu())},ko:function(){if(this.bx||this.bO)return!1;if(this.bs.t()||_g.B.isInstanceOfType(this.bm)||_dg.b.isInstanceOfType(this.bm))return!0;if(_dg.c.isInstanceOfType(this.bm)){var n=this.bm.c;if(_y.cj.isInstanceOfType(n))return!0;if(_y.D.isInstanceOfType(n))return n.j()}return!1},hq:function(n){_j.e.a(_at.a.a,"Cancel attachment succeeded with cancellationId {0}",this.bF());this.gi(!1);this.bn&&this.bn.r(this.bK)&&this.bn.l(this,!1);this.hp(n)},iH:function(n){_j.e.b(_at.a.a,"cancel failed with error: {0} and cancellationId: {1}",n&&n.J?n.J.message:"N/A",this.bF());this.cm=!0;this.hp(n)},hp:function(n){this.cS&&this.cS(null);this.gf(!1);this.kg(!this.cm);this.bO&&this.cC&&this.eM(!1);this.eD("OnCancelCompleteEvent",this);if(this.bt){this.bt.k=this.cm&&n?n.P():null;this.bt.j=this.cZ(2);this.bt.l=n?n.O():null;_a.d.a(this.bt);this.bt=null}},iU:function(n){this.hM(n,"")},hM:function(n,t){_j.e.b(_at.a.a,"delete failed with error: {0}",n?n.J.message:t);this.bx=!0;this.hX(!1);this.bn.r(this.bK)&&!this.cE&&this.bn.F(this);if(this.bt){this.bt.k=n?n.P():t;this.bt.j=this.cZ(1);this.bt.l=n?n.O():null;_a.d.a(this.bt);this.bt=null}},iT:function(n){this.eD("OnDeleteCompleteEvent",this);if(this.bt){this.bt.j=this.cZ(1);this.bt.l=n?n.O():null;_a.d.a(this.bt);this.bt=null}},kn:function(){_y.bQ.a=this.bB.a()==="Mouse"&&this.bB.c()&&!this.cr();this.bN&&this.bn&&this.bn.c()&&this.bN.d(this.bn.c(),"Downloaded",this.bv,!!this.bo())},bT:function(n){if(this.bm){var t=new _at.bo(n,this.bv,!this.bo(),this.bm.b());_a.r.c.a(t)}},jV:function(){if((this.bA||this.bm.bk.AttachmentId)&&!this.hJ(1)){if(this.dk&&_db.l.a(this.p())&&this.cA().p&&this.cA().p.x.length>0){var n=this.cA().p.x[0];n.m.a();return}if(!this.cp()||this.cf()||this.hD())if((_dg.i.isInstanceOfType(this.bm)||this.br()===9)&&this.bB.a()!=="TouchNarrow")this.eh();else if(this.bo()&&(this.hD()||this.bo().q()||this.dZ()))this.hR();else if(this.df())return;else this.db();else this.hT()}},hJ:function(n){if(this.dI&&this.ei){_j.e.a(_at.a.a,"AttachmentWellPendingRefresh was true, so triggering refresh of the attachment well with operation: "+n);this.be(!1);this.ei(this.bm,n);return!0}return!1},db:function(){this.fA()&&(_y.bQ.a=this.bB.a()==="Mouse"&&this.bB.c()&&!this.cr());var t=this.bA&&!this.bo();var n=this.bw?this.bw.replace("&isDocumentPreview=True","&isDocumentPreview=False"):null;if(this.bm.bk.AttachmentId)if(_a.g.b){_j.e.a(_at.a.a,"GenericMailMode, always download the attachment.");this.ds(n,t)}else if(_dg.c.isInstanceOfType(this.bm))this.ds(n,t);else if(_g.B.isInstanceOfType(this.bm)){var i=this.bm;i.bk.ItemId?this.eh():i.bk.IsAttachmentItemAttachment?this.eh():this.ds(n,t)}else this.ds(n,t);this.bT(4)},eh:function(){if(!this.ja()){_j.e.a(_at.a.a,"Unsupported item.");this.cd(_nbs.a.CT);return}this.bN&&this.bn&&this.bn.c()&&this.bN.d(this.bn.c(),"Downloaded",this.bv,!!this.bo());if(this.bm.l()){var n=this;this.hu(function(t){t.a();n.hQ()})}else this.hQ()},iG:function(){this.cX=_a.d.b(_at.a.a,"AddIcsToCalendarFromDropDownMenu",!0);if(this.cs)this.hL();else{var n=this;this.fm.a(function(t){n.cs=t.a();n.hL()})}this.bT(5)},hL:function(){this.cs.e(this.bm.bk.Name);this.cs.a(this.bm.bk.AttachmentId.Id);this.cs.b(this.ff);this.ge(1);this.cs.c()},jS:function(n){if(_j.i.a(n)){this.ge(2);_a.d.a(this.cX)}else{this.ge(3);this.cX.m=n;_a.d.a(this.cX)}this.cs.d(this.ff)},hQ:function(){var n={};n.AttachmentItemID=this.bm.bk.AttachmentId.Id;this.bP&&(n.IsDiscovery="1");_j.e.a(_at.a.a,"Opening item attachment in pop-out window.");this.bB.o(IItemAttachmentPopOutFactory,null,n,_bc.d.a())},ds:function(n,t){this.kH();this.bm?this.bm.bk.AttachmentId?_j.e.a(_at.a.a,"SafeOpenAttachment: Name={0}, ID={1}",this.bm.bk.Name,this.bm.bk.AttachmentId.Id):_j.e.b(_at.a.a,"SafeOpenAttachment: AttachmentId is null"):_j.e.b(_at.a.a,"SafeOpenAttachment: Attachment is null");_j.e.a(_at.a.a,"SafeOpenAttachment: Policy={0}",this.bq.toString());if(this.bq.f){_j.e.a(_at.a.a,"Attachment policy forces browser viewing.");this.bB.a()==="Mouse"?this.cd(_nbs.a.YH):this.cd(_nbs.a.jf);return}if(!this.bq.d){this.cd(_nbs.a.Sl);return}if(this.bq.a===1){this.cd(_nbs.a.Vq);return}if(this.cK()){var i=this;this.hu(function(n){i.bN&&i.bn&&i.bn.c()&&i.bN.d(i.bn.c(),"Downloaded",i.bv,!!i.bo());n.c()});return}if(this.bq.a===2&&this.bB.a()!=="Mouse"){this.kq();return}this.bm&&this.dd()&&!_j.i.a(n)&&this.fV(n,t)},kq:function(){_j.e.a(_at.a.a,"Attachment policy forces save, but device doesn't support download.");this.cd(_nbs.a.Gp)},hT:function(){this.bT(8);if(this.bm){if(!this.bn||!this.bn.c()){_j.e.a(_at.a.a,"this.parentWell.ParentItemId is null - compose form is not upgraded.");this.cd(_nbs.a.Sq);return}this.bN&&this.bN.d(this.bn.c(),"Previewed",this.bv,!!this.bo());if(this.jI(this.bm.bk.Name)&&this.bm.b()>10485760){this.dc.a(_a.v,new _a.v([_nbs.a.jK],1,this.fc,1,!1,_nbs.a.Jd,_nbs.a.o,_nbs.a.MA,this.cQ,null));return}if(this.cy===8&&this.bm.b()>1048576){this.dc.a(_a.v,new _a.v([_nbs.a.NV],1,this.fc,1,!1,_nbs.a.Jd,_nbs.a.o,_nbs.a.MA,this.cQ,null));return}if(this.bU){this.bU.a()&&this.bn.E(this.bm.bk.AttachmentId);this.bU.b();return}if(this.dH){var n=this;this.dH.a(function(t){if(!n.bn){_j.e.c(_a.a.c,"Preview: Parent well is null.");return}if(!n.bm){_j.e.a(_a.a.c,"Preview: Attachment is null.");return}n.kb(t.a(n,n.bn.d(),n.fs,n.fU,n.cQ));n.bU.a()&&n.bn.E(n.bm.bk.AttachmentId);n.bU.b()})}}},jU:function(n){_j.e.a(_at.a.a,"Save to cloud action succeeded with Id:{0}.",this.bu());this.cb(3);this.gp()},jT:function(n){_j.e.a(_at.a.a,"Failed to save attachment with Id:{0} to Cloud.",this.bu());this.cb(4);this.gp()},jE:function(n){var t=n;if(t)if(t.ResultCode){_j.e.c(_a.a.c,String.format("Saving attachmentID: {0} failed with ResultCode: {1}. Exception: {2}",this.bu(),t.ResultCode,t.Exception));this.cb(4)}else this.cb(3);else _j.e.c(_a.a.c,String.format("Received NULL payload while saving attachment: {0} to cloud",this.bu()));this.gp()},gp:function(){_a.d.a(this.ej);this.ej=null;_db.l.d(this.cP,this.l(),this.fe)},ka:function(){if(this.ct){_j.e.a(_at.a.a,"Saving attachment with Id:{0} to Cloud.",this.bu());this.ej=_a.d.b(_a.a.c,"SaveSingleAttachmentToCloud");this.cb(2);_db.l.b(this.cP,this.l(),this.fe,"AttachmentViewModel",String.format("NotificationHandler is NULL for AttachmentID:{0}",this.cl));var n=new _at.U(this.bu(),null,this.l(),this.cD?this.bR:null);n.d(this.hd);n.e(this.hc);this.bI.a(n);this.bT(9)}},iN:function(){if(this.bn){this.cz=(_a.c.a().h()+_ff.o.a(0,1e6)).toString();this.bn.Z(this,this.cz)}this.bT(1)},L:function(){if(this.bn&&this.bm&&this.bo()){this.cz=(_a.c.a().h()+_ff.o.a(0,1e6)).toString();this.bn.bD(this,this.bo().bk.AttachLongPathName,this.cz)}this.bT(2)},iI:function(){this.bo()?this.iK():this.iJ()},iJ:function(){if(this.bu()){_j.e.a(_a.a.c,"Canceling convert local to reference attachment. Attachment Id: {0}.",this.bu());var n=new _at.bc(this.cz);n.d(this.gY);n.e(this.gX);this.bI.a(n);this.n(4);this.eu("ShowCancelButton")}},jO:function(n){_j.e.a(_a.a.c,"Cancel convert local to reference action succeeded for attachment id {0}.",this.bu())},jN:function(n){_j.e.a(_a.a.c,"Cancel convert local to reference action failed for attachment id {0}.",this.bu())},iK:function(){if(this.bu()){_j.e.a(_at.a.a,"Canceling convert reference to local attachment. Attachment Id:{0}.",this.bu());var n=new _at.bd(this.cz);n.d(this.ha);n.e(this.gZ);this.bI.a(n);this.h(4);this.eu("ShowCancelButton")}},jQ:function(n){_j.e.a(_a.a.c,"Cancel convert reference to local action succeeded for attachment id {0}.",this.bu())},jP:function(n){_j.e.a(_a.a.c,"Cancel convert reference to local action failed for attachment id {0}.",this.bu())},iQ:function(){window.clipboardData?window.clipboardData.setData("Text",this.bJ):prompt(_nbs.a.Cu,this.bJ);this.bT(3)},kM:function(){var n=this.bJ;var t=n.lastIndexOf("/");t>=1&&(n=n.substr(0,t));this.hN(n,!1);this.bT(10)},hI:function(n){var t=this.cl;t!==n&&this.fR(t,n)},gr:function(){this.ki(this.dr||!!this.bm&&!this.bm.b())},cV:function(){if(this.bo())if(!this.bm.bk.AttachmentId||this.by===3||this.bz===3||this.de())this.ih(!1);else{this.ih(!!this.p());this.eu("PermissionsTextInCompose")}},kH:function(){if(!this.cK()&&this.fE()){var n=_g.k.a.q(this.bm.bk.AttachmentId);this.bm.bk.AttachmentId.Id!==n.Id&&this.bm.f(n)}},ht:function(n){var t=new _a.o;if(this.bo()){var i=this.bo().y?this.bo().y:this.bo().c?this.bo().c.a():0;t.a("S",i)}else t.a("S",this.bm.b());t.a("W",this.bn.b()?1:0);t.a("C",this.bO?1:0);t.b("E",this.bv);if(n){_j.i.a(this.dE)||t.b("DP",this.dE);t.c("H",this.fi);t.b("P",this.fg);t.c("O",this.fh)}return t.toString()},cZ:function(n){var t=new _a.o;t.a("S",this.bm.b());var i="A";_at.B.isInstanceOfType(this)?i="C":this.br()===5?i="T":this.bm.a()&&(i="I");t.b("T",i);t.a("O",n);t.a("W",this.bn.b()?1:0);this.cI&&t.b("Q",this.cI);t.b("E",this.bv);return t.toString()},eP:function(){this.ey("ShouldAffordanceMenuBeHidden","ShouldShowContextMenuOnClick")},hu:function(n){if(this.cK()){_j.e.a(_a.a.k,"[AttachmentViewModel] Creating Smime command factory.");var t=this;this.gk.a(function(i){if(!t.dx){_j.e.a(_a.a.k,"[AttachmentViewModel] Creating smimeAttachmentViewModelCommand instance.");t.dx=i.d();t.dx.b(t.bm)}_j.e.a(_a.a.k,"[AttachmentViewModel] Executing smime operation.");n(t.dx)})}},iL:function(){var n=!!this.bn.d()&&this.bn.d().a()===2&&this.cD;return!!this.bp&&this.bp.a().cW().Enabled&&this.bQ.SaveAttachmentsToCloudEnabled&&this.bq.c()&&this.bn.I()&&!_dg.b.isInstanceOfType(this.bm)&&!this.bm.a()&&this.bn.h()&&(!this.bn.d()||this.bn.d().a()!==2||this.cD)&&(!_j.i.a(this.bn.j())||n)},ij:function(){if(this.bm){if(this.dg()){_j.i.a(this.bm.bk.AttachmentThumbnailUrl)||this.cv(new _at.p(this.bm.bk.AttachmentThumbnailUrl,null,200,150,!0));return}if(this.hG()){if(!this.bm.bk.AttachmentId)return;if(!this.jk()){this.cv(new _at.p(this.cq(),null,0,0,!1));return}this.kL()}}},kL:function(){var u=this.bm.bk.AttachmentId.Id;var o=_a.c.a();var f=this.dt.a(u);if(!_j.i.a(f)){this.cv(new _at.p(f,null,0,0,!1));return}var r=document.createElement("canvas");var e=r.getContext("2d");var n=new Image;n.crossOrigin="Anonymous";var t=this;n.onload=function(){if(t&&!t.eG){var f=n.width,o=n.height;r.width=f;r.height=o;var i=null;try{if(f>0&&o>0){e.drawImage(n,0,0,f,o);i=r.toDataURL("image/jpeg",.5)}}catch(h){_j.e.b(_at.a.a,"Failed to get thumbnail via canvas error={0}",h.message)}t.bm&&t.cv(new _at.p(i?i:t.cq(),null,0,0,!1));if(i)try{t.dt.b(u,i)}catch(s){_j.e.b(_at.a.a,"Failed to save thumbnailinfo into session storage, error={0}",s.message)}}};var i=this;n.onerror=function(){i&&!i.eG&&i.bm&&i.cv(new _at.p(i.cq(),null,0,0,!1))};n.src=this.cq()},hS:function(){if(this.cl&&this.fA()&&this.bq&&this.bq.b&&!_dg.i.isInstanceOfType(this.bm)&&!_db.l.a(this.p())){if(this.bm&&this.bm.bk.Name&&!_dg.b.isInstanceOfType(this.bm)&&this.bQ&&this.bQ.WacPreloadMappings&&this.bQ.WacPreloadMappings.length>0){if(!_at.a.b){_at.a.b={};for(var t=0;t<this.bQ.WacPreloadMappings.length;t++)_at.a.b[this.bQ.WacPreloadMappings[t][0]]=this.bQ.WacPreloadMappings[t][1]}var i=_a.bh.a(this.bm.bk.Name);if(i in _at.a.b){var o=_at.a.b[i];delete _at.a.b[i];this.km(o)}}var e=this.cl.Id;var f=this;var r=function(n){if(n&&n.Status===9){f.gn=!0;f.cU()}};var u=_at.m.a().c(e);if(u){r(u);return}var n=this;_j.n.a().d(_a.a.c,"AttachmentViewModel.PreloadWacAttachmentInfo",function(){if(n.bn&&n.bn.d()){var t=new _at.S(e,!1,null,!!n.bo(),n.bn.d().a(),n.bn.b(),n.bP);t.e(function(n){r(t.c)});n.bI.a(t)}})}},hH:function(n,t,i){var r=t.Id+_a.c.bI(_a.c.a());if(!this.hF()||!n.c(r)){var u=this.ce.a(t,this.bP,i,this.bR);if(!this.hF())return u;n.b(r,u)}return n.a[r]},jI:function(n){var t=_a.bh.a(n).toLowerCase();switch(t){case".xls":case".xlsx":case".xlsm":case".xlsb":return!0;default:return!1}},jG:function(){return(this.br()===5||this.br()===9)&&this.fK},jH:function(){return this.bq.b&&!(this.jK(this.bm.bk.Name)&&(this.bo()||this.bB.a()==="TouchNarrow"))&&!(this.bs.c()&&this.bB.a()==="TouchNarrow")&&!this.cB()&&(!this.jL(this.bm.bk.Name)||this.fO)},fH:function(){if(this.bs&&this.bs.d()&&(this.bs.d().a()===2||this.bs.d().a()===6||this.bs.d().a()===4)&&this.bp){var n=this.bp.a().bT().Enabled&&_at.a.c.g(this.bv.toLowerCase());return this.cB()?!!this.bm.bk.ContentType&&this.cB().g(this.bm.bk.ContentType):n}return!1},ho:function(){return this.bs&&this.bs.d()&&(this.bs.d().a()===2||this.bs.d().a()===6||this.bs.d().a()===4)&&this.bp?this.bp.a().bT().Enabled&&_at.a.c.g(this.bv.toLowerCase()):!1},jK:function(n){return _a.bh.a(n).toLowerCase()===".pdf"},jL:function(n){switch(_a.bh.a(n).toLowerCase()){case".vsd":case".vdx":case".vss":case".vsx":case".vst":case".vtx":return!0;default:return!1}},hR:function(){this.ds(this.bJ,!1);this.bT(7)},jM:function(){var n=new _at.bf(this.bm.bk.AttachmentId,this.bn.c().Id);n.d(this.gL);n.e(this.gK);this.bX=320;this.bW=220;if(_dg.c.isInstanceOfType(this.bm)&&this.bm.bk.Content){var i,t;_at.f.c(this.bm.bk.ContentType,this.bm.bk.Content,i={val:this.bX},t={val:this.bW}),this.bX=i.val,this.bW=t.val}this.bY=this.bn.J(this.bm.bk.Name,this.bX,this.bW);this.bI.a(n);this.bT(6)},iO:function(n){_j.e.b(_at.a.a,"AttachmentViewModel: ConvertToInlineAttachmentFailed. Deleting placeholder image");this.bn.bF(this.bY)},iP:function(n){var t=n.f;this.bm.g(!0);this.bm.o(t);this.bn.l(this,!1);this.bn.cc(this.bY,this.bw,t,this.bm.b(),this.bm.bk.ContentType)},kw:function(n){this.jo()&&n.p.a(new _fm.d(this.b().b(),null,this.fP))},ky:function(n){if(this.dX()){this.h(1);n.p.a(new _fm.d(this.hw(),null,this.fv))}},kx:function(n){if(this.dW()){this.n(1);n.p.a(new _fm.d(this.hv(),null,this.fu))}},kA:function(n){this.dl()||(this.bq.c()&&this.bq.a!==2&&!this.cf()||this.df()||this.cf())&&this.iF(n)},kD:function(n){(this.bq.c()&&this.bq.a!==2&&!this.cf()||this.df()||this.cf())&&this.jW(n)},kE:function(n){(this.br()===4||this.bq.a===2||this.cf())&&(this.df()||!this.cf())||this.dZ()||this.cp()&&this.ju()&&n.p.a(new _fm.d(_nbs.a.LU,null,this.cR))},kF:function(n){if(this.ct){this.bC=1;n.p.a(new _fm.d(this.hA(),null,this.fY))}},kG:function(n){this.dl()||this.bo()&&n.p.a(new _fm.d(this.b().m(),null,this.gv))},kz:function(n){this.bo()&&n.p.a(new _fm.d(_nbs.a.Dh,null,this.fw))},kB:function(n){this.hx()&&n.p.a(new _fm.d(_nbs.a.If,null,this.fl))},kC:function(n){this.bn&&this.bn.h()||!this.bp||!this.bp.a().ev().Enabled||!this.dY()||this.dg()||n.p.a(new _fm.d(_nbs.a.HU,null,this.fQ))},dl:function(){if(!this.bo()||_j.i.a(this.bo().bk.AttachLongPathName))return!1;try{var n=new _a.S(this.bo().bk.AttachLongPathName);var t=n.a;if(t.indexOf("safelinks.protection.outlook.com")>0||n.f.toLowerCase().indexOf(_at.a.i)>0)return!0}catch(i){}return!1},fM:function(){return this.bo()?this.bo().bk.ProviderType?this.bo().bk.ProviderType!==_g.p.toString(1)?!1:this.dY()?!0:!1:!1:!1},en:function(n){if(this.cG!==n){this.cG=n;this.eu("ShowConversationAttachmentContextMenu")}return n},ks:function(){this.en(!this.cG)},iM:function(){this.en(!1)}};_at.bq=function(n,t,i,r,u,f,e,o){this.n=_at.a;_a.b.a(n,"owaShell");_a.b.a(t,"palDownloadManager");_a.b.a(o,"attachmentDependencies");_a.b.a(o.e,"userAgent");_a.b.a(o.a,"nativeBridge");_a.b.a(r,"itemStoreGetterFactory");this.c=n;this.i=t;this.b=i;this.g=e;this.a=o;this.h=r;this.j=u;this.f=f};_at.bq.prototype={c:null,a:null,i:null,h:null,b:null,e:null,j:null,g:null,n:null,f:null,k:function(n,t,i,r,u,f,e){n||_j.e.c(_a.a.c,"AttachmentViewModelFactory.Create passing null as attachment");if(this.m()&&(_dg.b.isInstanceOfType(n)||_dg.c.isInstanceOfType(n)&&_y.D.isInstanceOfType(n.c))){if(!this.e&&this.b){var s=this;this.b.a(function(n){s.e=n})}_a.b.b(this.e,"attachmentProviderItemViewModelFactory");return this.e.a(n,this.c,t,i,r,u,f,e)}else if(_dg.c.isInstanceOfType(n)&&_y.cj.isInstanceOfType(n.c)){_a.b.b(this.j,"uriFileAttachmentViewModelFactory");return this.j.a(n,this.c,t,i,r,u,f,e)}else{var o=_at.l.a(this.g,this.a,r);return new _at.b(n,this.c,t,i,r,this.i,this.h,u,f,e,this.f,o,this.a)}},d:function(n,t,i,r,u,f,e,o){n||_j.e.c(_a.a.c,"AttachmentViewModelFactory.CreateAsync passing null as attachment");if(this.m()&&this.b&&(_dg.b.isInstanceOfType(n)||_dg.c.isInstanceOfType(n)&&_y.D.isInstanceOfType(n.c))){var c=this;var l=function(s){var h=s.a(n,c.c,t,i,r,f,e,o);u(h)};this.b.a(l)}else{this.b||_j.e.c(_a.a.c,"attachmentProviderItemViewModelFactoryLazy is null");_dg.b.isInstanceOfType(n)&&_j.e.b(_a.a.c,"We shall not construct PALAttachmentViewModel for ReferenceAttachment.");var s=_at.l.a(this.g,this.a,r);var h=new _at.b(n,this.c,t,i,r,this.i,this.h,f,e,o,this.f,s,this.a);u(h)}},p:function(n,t,i,r,u,f,e,o,s){if(this.b&&_dg.b.isInstanceOfType(t)){var c=this;var h=function(h){var l=h.b(t,c.c,i,r,u,n,e,o,s);f(l)};this.b.a(h)}},o:function(n,t,i,r,u,f,e,o){if(!n){u(null);return}if(!n.length){u(new Array(0));return}this.l(n,0,new Array(0),t,i,r,u,f,e,o)},l:function(n,t,i,r,u,f,e,o,s,h){var c=this;this.d(n[t],r,u,f,function(l){Array.add(i,l);t<n.length-1?c.l(n,t+1,i,r,u,f,e,o,s,h):e(i)},o,s,h)},m:function(){return this.a.c?this.a.c.a().L().Enabled:!1}};_at.D=function(n){this.a=n};_at.D.prototype={a:null};_at.M=function(n){_at.M.initializeBase(this,[n])};_at.M.prototype={i:function(){return!1},h:function(){return!0},m:function(){return""},o:function(){return _nbs.a.hX},e:function(){return""},t:function(){return""},s:function(){return _nbs.a.Zt},f:function(){return""},d:function(){return""},l:function(){return""},n:function(){return""},b:function(){return""},g:function(){return String.format(_nbs.a.Qv,this.r)},c:function(n,t,i){return t},a:function(n){return _at.M.a}};_at.br=function(n){_at.br.initializeBase(this,[n])};_at.br.prototype={h:function(){return!1},a:function(n){return null},c:function(n,t,i){return null},i:function(){return!0},u:function(){return!0},m:function(){return""},o:function(){return""},e:function(){return""},t:function(){return""},s:function(){return""},f:function(){return""},d:function(){return""},l:function(){return""},n:function(){return""},b:function(){return""},g:function(){return String.format(_nbs.a.Qv,this.r)}};_at.N=function(n){_at.N.initializeBase(this,[n])};_at.N.prototype={i:function(){return!1},h:function(){return!0},m:function(){return""},o:function(){return _nbs.a.hX},e:function(){return""},t:function(){return""},s:function(){return _nbs.a.Zt},f:function(){return""},d:function(){return""},l:function(){return""},n:function(){return""},b:function(){return""},g:function(){return String.format(_nbs.a.Qv,this.r)},c:function(n,t,i){var u=t.lastIndexOf("?");var r=t.substring(0,u);return r+"?dl=1"},a:function(n){return _at.N.a}};_at.z=function(n){_at.z.initializeBase(this,[n])};_at.z.prototype={i:function(){return!0},h:function(){return!1},m:function(){return""},o:function(){return _nbs.a.hX},e:function(){return _nbs.a.rf},t:function(){return""},s:function(){return _nbs.a.Zt},f:function(){return""},d:function(){return""},l:function(){return""},n:function(){return""},b:function(){return""},g:function(){return String.format(_nbs.a.Qv,this.r)},c:function(n,t,i){return t},a:function(n){return _at.z.a},p:function(){return _at.z.b}};_at.O=function(n){_at.O.initializeBase(this,[n])};_at.O.prototype={i:function(){return!0},u:function(){return!0},B:function(){return!0},E:function(){return!0},D:function(){return!0},C:function(){return!1},h:function(){return!0},m:function(){return""},o:function(){return""},e:function(){return""},t:function(){return""},s:function(){return _nbs.a.KY},f:function(){return""},d:function(){return""},l:function(){return""},n:function(){return""},b:function(){return""},g:function(){return String.format(_nbs.a.Qv,this.r)},c:function(n,t,i){n=encodeURIComponent(n);t=encodeURIComponent(t);return String.format(_g.x.g(),n,t)},a:function(n){return _at.O.a}};_at.P=function(n){_at.P.initializeBase(this,[n])};_at.P.prototype={i:function(){return!0},h:function(){return!1},m:function(){return""},o:function(){return _nbs.a.hX},e:function(){return _nbs.a.rf},t:function(){return _nbs.a.fx},s:function(){return _nbs.a.GZ},f:function(){return _nbs.a.j},d:function(){return _nbs.a.Sj},l:function(){return _nbs.a.rf},n:function(){return _nbs.a.hX},b:function(){return _nbs.a.Mu},c:function(n,t,i){n=encodeURIComponent(n);t=encodeURIComponent(t);return String.format(_g.x.g(),n,t)},a:function(n){return _at.P.a}};_at.A=function(n){_at.A.initializeBase(this,[n])};_at.A.prototype={a:function(n){switch(n){case 4:case 3:case 6:case 5:return _at.A.b;default:return _at.A.a}},q:function(){return _nbs.a.ap},k:function(){return!0},j:function(){return!0},i:function(){return!0},x:function(){return!0},h:function(){return!1},m:function(){return String.format(_nbs.a.Ne,_nbs.a.ap)},o:function(){return _nbs.a.Fz},e:function(){return _nbs.a.hU},t:function(){return _nbs.a.Mf},s:function(){return _nbs.a.re},f:function(){return _nbs.a.DV},d:function(){return _nbs.a.hF},l:function(){return _nbs.a.CH},n:function(){return _nbs.a.py},b:function(){return _nbs.a.Mu},c:function(n,t,i){n=encodeURIComponent(n);t=encodeURIComponent(t);var r=String.format(_g.x.g(),n,t);return _j.i.a(i)?r:String.format("{0}/{1}",i,r)}};_at.k=function(){};_at.k.c=function(n){var r;if(n){if(_h.bC.isInstanceOfType(n)&&(r=n.a())){var i=r.responseCode;if(i&&i!=="NoError")return i;var t=r.response;if(t){var f=t.fault;if(f){var u=_at.k.d(f);if(u)return u}if(t.statusCode)return"HTTP_"+t.statusCode}}if(n.J)return _at.k.a(n.J)}return"UnknownError_Action"};_at.k.a=function(n){if(n){var t;if((t=n.responseCode)&&t!=="NoError")return t.toString();if(t=n.StackTrace)return _at.k.e(t.toString());if(t=n.ErrorCode)return"HTTP_"+t;if(t=n.name){var i=t.toString();if(i!=="Error")return i;else if(n.message)return n.message}}return"UnknownError_Exception"};_at.k.d=function(n){if(n){if(n.ResponseCode&&n.ResponseCode!=="NoError")return n.ResponseCode;if(n.StackTrace)return _at.k.e(n.StackTrace);if(n.ErrorCode)return"HTTP_"+n.ErrorCode}return null};_at.k.e=function(n){var i;var t;if((i=n.indexOf(":"))!==-1||(i=n.indexOf("\n"))!==-1){t=n.substr(0,i);if((i=n.indexOf("\n"))!==-1){var u=new RegExp("[_a-zA-Z0-9.]+\\(");var r=u.exec(n.substr(i));r&&(t=t+"@"+r[0].substr(0,r[0].length-1))}}else t=n;return t};_at.k.f=function(n){var i=n.c();if(i){var t;t=Number.isInstanceOfType(i)?i:i.code;return t>=1&&t<_at.k.b.length?_at.k.b[t]:_at.k.a(i)}return n.d()?_at.k.a(n.d()):"UnknownError_FileReader"};_at.B=function(n,t,i,r,u,f,e,o,s,h,c){this.eS=Function.createDelegate(this,this.kO);this.gw=Function.createDelegate(this,this.kN);_at.B.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};_at.B.a=function(n){if(n){if(n.ResultCode===10)return 5;if(n.ResultCode===17)return 6;if(n.ResultCode===15)return 7}return 1};_at.B.prototype={eT:function(){_db.l.b(this.cP,this.l(),this.gw,this.gx(),"NULL NotificationHandler passed in from ExternalSourceAttachmentViewModel.")},is:function(){_db.l.d(this.cP,this.l(),this.gw)},cn:function(n){this.is();_at.a.prototype.cn.call(this,n)},kO:function(n){this.dO(n);this.cn(null)},kN:function(n){var i=null;var t=n;i=n?_j.i.a(t.Exception)?this.gy(t.Response):String.format("Exception from Server: "+t.Exception):"The notification received is null";if(i){t&&(i+=". AttachmentProviderResultCode = "+t.ResultCode);this.cj(_at.B.a(t),i,!0)}else this.ir(t);this.cn(null)},ir:function(n){},gy:function(n){var r=null;if(n&&n.ResponseMessages&&n.ResponseMessages.Items&&n.ResponseMessages.Items.length)if(n.ResponseMessages.Items[0].ResponseCode!=="NoError")r="ResponseMessages response code = "+n.ResponseMessages.Items[0].ResponseCode;else{var i=n.ResponseMessages.Items[0];this.bm.h(i.Attachments[0].Size);_at.i.c(i,this.bm,this.bn.c(),!0);if(_dg.b.isInstanceOfType(this.bm)&&i.Attachments.length>=1&&i.ResponseCode==="NoError"){var t=i.Attachments[0];if(t.AttachLongPathName){this.bm.D(t.ProviderType);this.bm.A(t.AttachLongPathName);this.bm.M(t.ProviderEndpointUrl);this.bm.o(t.ContentId);this.bm.L(t.AttachmentThumbnailUrl);this.bm.K(t.AttachmentPreviewUrl)}if(t.PermissionType){this.bm.C(t.PermissionType);this.cV()}this.bm.e(t.Name)}if(_dg.c.isInstanceOfType(this.bm)&&this.bm.a()){var u=i.Attachments[0];this.bm.o(u.ContentId);this.bm.i(u.ContentType)}}else r="The response message received is null";return r}};_at.bB=function(n){this.r=n};_at.bB.prototype={r:null,q:function(){return this.r},k:function(){return!1},j:function(){return!1},u:function(){return!1},x:function(){return!1},B:function(){return!1},E:function(){return!1},D:function(){return!1},C:function(){return!0},A:function(){return String.format(_nbs.a.Ny,this.r)},w:function(){return String.format(_nbs.a.dA,this.r)},v:function(){return String.format(_nbs.a.Dp,this.r)},y:function(){return String.format(_nbs.a.Pi,this.r)},z:function(){return String.format(_nbs.a.Pb,this.r)},p:function(){return null},g:function(){return String.format(_nbs.a.Qv,this.q())}};_at.f=function(){};_at.f.c=function(n,t,i,r){var u=_a.d.b(_a.a.c,"MailComposeImageSizeDecode");i.val=r.val=0;if(!t){u.k="EmptyContent";_a.d.a(u);return}if(n==="image/png")_at.f.o(t,i,r,u);else if(n==="image/jpeg")_at.f.n(t,i,r,u);else if(n==="image/gif")_at.f.m(t,i,r,u);else if(n==="image/bmp")_at.f.l(t,i,r,u);else{u.k="UnsupportedImage";u.m=String.format("Image type {0} is not supported.",n);_a.d.a(u)}};_at.f.k=function(n){var t=_a.bh.a(n);return _db.l.e.g(t.toLowerCase())};_at.f.o=function(n,t,i,r){var p=n.length>100?100:n.length;var w=n.substring(0,p);var s=_at.f.b(_a.bl.a(w));if(s.length>24){for(var h=0,f=0,y=new Array(8),u=0;u<8;u++)y[u]=s[u];if(_at.f.a(y,_at.f.j)){for(var o=16,e=4,v=new Array(e),l=0;l<e;l+=1){v[l]=s[o];o+=1}for(var a=new Array(e),c=0;c<e;c+=1){a[c]=s[o];o+=1}h=_at.f.d(v);f=_at.f.d(a);if(h<=0||f<=0){_j.e.b(_a.a.c,"Width and height of a png image have to be > 0.");r.k="IllegalDimensions";r.m="png";h=f=0}}else{_j.e.b(_a.a.c,"The png image has unexpected headers, exiting.");r.k="InvalidHeaders";r.m="png"}t.val=h;i.val=f}else{r.k="NotEnoughData";r.m="png"}_a.d.a(r)};_at.f.m=function(n,t,i,r){var p=n.length>20?20:n.length;var w=n.substring(0,p);var s=_at.f.b(_a.bl.a(w));if(s.length>10){for(var h=0,f=0,a=new Array(6),u=0;u<6;u++)a[u]=s[u];if(_at.f.a(a,_at.f.h)||_at.f.a(a,_at.f.i)){for(var o=6,e=2,y=new Array(e),l=0;l<e;l+=1){y[l]=s[o];o+=1}for(var v=new Array(e),c=0;c<e;c+=1){v[c]=s[o];o+=1}h=_at.f.e(y);f=_at.f.e(v);if(h<=0||f<=0){_j.e.b(_a.a.c,"Width and height of a gif image have to be > 0.");r.k="InvalidDimensions";r.m="gif";h=f=0}}else{_j.e.b(_a.a.c,"The gif image has unexpected headers, exiting.");r.k="InvalidHeaders";r.m="gif"}t.val=h;i.val=f}else{r.k="NotEnoughData";r.m="gif"}_a.d.a(r)};_at.f.l=function(n,t,i,r){var p=n.length>50?50:n.length;var w=n.substring(0,p);var s=_at.f.b(_a.bl.a(w));if(s.length>26){for(var h=0,f=0,y=new Array(2),u=0;u<2;u++)y[u]=s[u];if(_at.f.a(y,_at.f.g)){for(var o=18,e=4,v=new Array(e),l=0;l<e;l+=1){v[l]=s[o];o+=1}for(var a=new Array(e),c=0;c<e;c+=1){a[c]=s[o];o+=1}h=_at.f.f(v);f=_at.f.f(a);if(h<=0||f<=0){_j.e.b(_a.a.c,"Width and height of a bmp image have to be > 0.");r.k="InvalidDimensions";r.m="bmp";h=f=0}}else{_j.e.b(_a.a.c,"The bmp image has unexpected headers, exiting.");r.k="InvalidHeaders";r.m="bmp"}t.val=h;i.val=f}else{r.k="NotEnoughData";r.m="bmp"}_a.d.a(r)};_at.f.n=function(n,t,i,r){for(var f=_at.f.b(_a.bl.a(n)),c=f.length,l=!1,a=!1,u=0,o=0,s=0;!l&&!a&&u+1<c;){u+=1;var h=f[u];u+=1;var e=0;switch(h){case 216:case 217:e=0;break;case 221:e=2;break;default:if(u+2<c){var y=f[u];u+=1;var v=f[u];u+=1;e=(y<<8|v)-2}else{_j.e.b(_a.a.c,"Malformed jpeg.");r.k="MalformedJpeg";_a.d.a(r);return}break}h===217&&(a=!0);if(e>0){if(h===192){if(u+4<c){o=f[u+3]<<8|f[u+4];s=f[u+1]<<8|f[u+2]}else{_j.e.b(_a.a.c,"Malformed segment in jpeg.");r.k="MalformedJpeg";_a.d.a(r);return}l=!0}u+=e}}if(o<=0||s<=0){if(l){_j.e.b(_a.a.c,"Width and height of a jpeg image have to be > 0.");r.k="InvalidDimensions";r.m="jpeg"}else{_j.e.b(_a.a.c,"Image dimension segment not found for jpeg image.");r.k="MissingDimension";r.m="jpeg"}o=s=0}t.val=o;i.val=s;_a.d.a(r)};_at.f.b=function(n){for(var i=n.length,r=new Array(i),t=0;t<i;t++)r[t]=n.charCodeAt(t);return r};_at.f.d=function(n){for(var i=0,t=0;t<4;t++)i=(i<<8)-0+n[t];return i};_at.f.e=function(n){for(var i=0,t=1;t>=0;t--)i=(i<<8)-0+n[t];return i};_at.f.f=function(n){for(var i=0,t=3;t>=0;t--)i=(i<<8)-0+n[t];return i};_at.f.a=function(n,t){if(n.length!==t.length)return!1;for(var i=0;i<t.length;i++)if(n[i]!==t[i])return!1;return!0};_at.bs=function(n){this.g=n;this.c={};this.a=new _j.q};_at.bs.prototype={g:null,c:null,a:null,b:function(n){_a.b.c(n,"attachmentId");return n in this.c},h:function(n){this.d(n);if(!this.b(n.a)){this.a.c(n);this.c[n.a]=""}},e:function(n,t){this.d(t);if(!this.b(t.a)){this.a.l(n,t);this.c[t.a]=""}},i:function(){if(this.a.d.length>0){var n=this.a.d[0];this.f(n);return n}else return null},f:function(n){this.d(n);if(this.b(n.a)){delete this.c[n.a];for(var i=-1,t=0;t<this.a.d.length;t++)if(this.a.d[t].a===n.a){i=t;break}i!==-1&&this.a.i(i)}},d:function(n){_a.b.a(n,"parameter");_a.b.a(n.a,"AttachmentId")}};_at.n=function(){};_at.n.e=function(n,t,i,r,u,f,e){_a.b.a(n,"initNativeBridge");_a.b.a(t,"initClientStore");_a.b.a(i,"initAttachmentInfoRecord");_a.b.c(r,"initMimeType");_a.b.c(u,"fileName");_a.b.a(f,"initOnOpenAttachmentSuccess");_a.b.a(e,"initOnOpenAttachmentError");if(_at.n.b){_j.e.a(_at.n.a,"Already opening an attachment so returning.");return}_j.e.a(_at.n.a,"OpenAttachment with record DataID {0}, Size {1}, id {2}",i.AttachmentId,i.DataID,i.Size);_at.n.b=!0;n.d().f(i.DataID,r,u,function(n){_at.n.d(n,i,t,f,e)});t.l(i.AttachmentId,function(n){},null)};_at.n.c=function(n){var t=null;switch(n){case 0:break;case 1:case 3:t=_nbs.a.jB;break;case 2:t=_nbs.a.BM;break;default:break}_j.e.a(_at.n.a,"OpenPalAttachment error code {0}, string: {1}",n,t);return t};_at.n.d=function(n,t,i,r,u){_at.n.b=!1;var f=!0;switch(n){case 0:f=!1;break;case 1:case 3:break;case 2:i.g(t.AttachmentId);break;default:break}if(f){_j.e.b(_at.n.a,"OnOpenDocument failed with errorCode {0}",n);u(n)}else{_j.e.a(_at.n.a,"OnOpenDocument succeeded");r()}};_at.d=function(n,t,i){this.r=Function.createDelegate(this,this.A);this.s=Function.createDelegate(this,this.B);this.t=Function.createDelegate(this,this.w);_a.b.a(n,"initNativeBridge");var r=t?t.j():null;this.l=n;this.q=i;this.k=n.q().a(r);this.v(t)};_at.d.prototype={k:!1,g:null,f:null,h:null,m:0,j:null,l:null,q:null,n:null,a:function(){if(!this.k&&_g.k.a){var n=_bc.l.isInstanceOfType(_g.k.a)?_g.k.a:null;this.k=this.l.q().a(n?n.h():null);this.v(n?n.d().j():null)}return this.k},d:function(n,t){_a.b.c(n,"attachmentId");_a.b.a(t,"callbacks");if(this.a()){this.j[n]=t;this.y(n,t)}else _j.e.a(_at.d.a,"PAL does not support download.")},b:function(n){_a.b.c(n,"attachmentId");this.a()&&n in this.j&&delete this.j[n]},c:function(n){_a.b.a(n,"parameters");_a.b.a(n.a,"AttachmentId");_a.b.a(n.e,"DownloadUrl");_j.e.a(_at.d.a,"DownloadAttachment:Begin download Attachment for parameters {0}",n);if(this.a()){if(!(n.a in this.j))throw Error.invalidOperation("Subscribe must be called before calling DownloadAttachment.");var t=this.C(n);if(_j.i.a(t)){if((!this.f||this.f.a!==n.a)&&!this.g.b(n.a)){_j.e.a(_at.d.a,"Starting download for {0}",n);if(n.h){this.g.e(0,n);if(this.f){this.u();this.g.e(1,this.h);this.i(this.h,2)}else{this.i(n,2);this.p()}}else{this.g.h(n);this.i(n,2);this.p()}}}else this.x(n,t)}},e:function(n){_a.b.a(n,"parameters");_a.b.a(n.a,"AttachmentId");_j.e.a(_at.d.a,"Cancel download for parameters {0}",n);if(this.a())if(this.g.b(n.a)){this.g.f(n);_j.e.a(_at.d.a,"Found and removed from queue {0}. Pending Items in queue {1}",n,this.g.a.d.length);this.i(n,1)}else if(this.f&&this.f.a===n.a){_j.e.a(_at.d.a,"Current Download was canceled. {0}",this.f);this.u();this.i(this.h,1)}},z:function(n){var t=null;switch(n){case 0:break;case 7:break;case 8:break;case 9:t=_nbs.a.mW;break;case 2:t=_nbs.a.Js;break;default:break}return t},v:function(n){if(this.k){this.n=n;this.g=new _at.bs(_at.d.a);this.j={};this.h=null;this.f=null;this.m=0}},u:function(){_j.e.a(_at.d.a,"CancelCurrentDownload, canceling the current download");this.l.l().d();this.h=this.f;this.f=null},p:function(){_j.e.a(_at.d.a,"Inside StartDownloadInternal");if(this.h)_j.e.a(_at.d.a,"Still waiting for the canceled download to get canceled.");else if(this.f)_j.e.a(_at.d.a,"Still waiting for the current download to finish.");else{_j.e.a(_at.d.a,"StartDownloadInternal, pending items in queue {0}",this.g.a.d.length);this.f=this.g.i();this.m=0;if(this.f){_j.e.a(_at.d.a,"Starting download {0}",this.f);this.i(this.f,3);var n=this;this.q.c(this.n,this.l,this.t,function(t){_j.e.b(_at.d.a,"Scheduled cleanup failed due to error {0}",t);n.w()})}else _j.e.a(_at.d.a,"Download queue is empty.")}},w:function(){_j.e.a(_at.d.a,"Starting the download now for {0}",this.f);if(this.h){this.h=null;this.p()}else this.l.l().e(this.f.e,1,this.f.f,this.f.b,this.s,this.r)},B:function(n){if(this.f){this.m+=n;var t=this;this.o(this.f,function(n){n.D(t.m)})}},i:function(n,t){var i=this;this.o(n,function(n){n.d(t)})},x:function(n,t){var i=this;this.o(n,function(i){_j.e.b(_at.d.a,"Raising OnError event with error {0} for attachment {1}",t,n);i.E(t)})},o:function(n,t){var i=this.j[n.a];i&&t(i)},A:function(n,t,i){_j.e.a(_at.d.a,"OnDownloadComplete with errorCode = {0} httpStatusCode = {1} dataID = {2} for attachment {3}",n,t,i,this.f);if(this.h)this.h=null;else if(n||t!==200){var f=this.z(n);_j.i.a(f)||this.x(this.f,f);this.i(this.f,1)}else{var r=this.f;var u=new AttachmentInfoRecord(this.f.a,i,this.f.d,_a.c.get_utcNow().h(),this.f.g,0,_a.c.bJ(_a.c.get_utcNow()),!0);var e=this,s=this;this.n.q(u,function(n){_j.e.a(_at.d.a,"Successfully saved attachment in DB with dataID {0} and parameters {1}",i,r)},function(n){_j.e.b(_at.d.a,"Unable to save the attachment in DB with parameters {0} error {1}",r,n)});this.i(r,4);var o=this;this.o(r,function(n){_j.e.a(_at.d.a,"Raising OnAttachmentInfoRecordAvailable with record {0} for attachment {1}",u,r);n.r(u)})}this.f=null;this.p()},C:function(n){var t=null;if(_bc.f.b(n.a)){_j.e.a(_at.d.a,"The attachment is not uploaded to the server yet. {0}",n);t=_nbs.a.Kn}else if(_j.i.a(n.g)){_j.e.a(_at.d.a,"Attachment is a quick message {0}",n);t=_nbs.a.Kn}else if(_j.i.a(n.b)){_j.e.a(_at.d.a,"Attachment does not have content type set. {0}",n);t=_nbs.a.Js}else if(_j.i.a(n.f)){_j.e.a(_at.d.a,"Attachment does not have a valid file name {0}.",n);t=_nbs.a.Js}else if(this.g.a.d.length===10){_j.e.a(_at.d.a,"download queue max size reached. Rejecting attachment with params {0}.",n);t=String.format(_nbs.a.PA,10)}return t},y:function(n,t){if(this.f&&n===this.f.a){_j.e.a(_at.d.a,"FindStatusAndFireCallback. currently downloading attachment with id {0}",n);t.d(3)}else if(this.g.b(n)){_j.e.a(_at.d.a,"FindStatusAndFireCallback. Found in the queue. attachment with id {0}",n);t.d(2)}else{var r=this,i=this;this.n.p(n,function(i){if(i){_j.e.a(_at.d.a,"FindStatusAndFireCallback Found the record in db {0} and AttachmentId {1}",i.DataID,i.AttachmentId);t.d(4);t.r(i)}else{_j.e.a(_at.d.a,"FindStatusAndFireCallback. Did not find attachment with id {0} in the db.",n);t.d(1)}},function(i){_j.e.b(_at.d.a,"FindStatusAndFireCallback. Got error {0} from DB while retreiving record with id {1}",i,n);t.d(1)})}}};_at.E=function(){};_at.E.b=function(n){_a.b.a(n,"viewModel");_a.b.a(n.bw,"DownloadUrl should not be empty");var t=null;n.bn&&n.bn.c()&&(t=n.bn.c().Id);return _at.E.a(n.bm,n.bm.bk.Name,n.bm.bk.ContentType,n.bw,t,!1)};_at.E.a=function(n,t,i,r,u,f){_a.b.a(n,"attachment");_a.b.a(n.bk.AttachmentId,"attachmentId");_a.b.a(r,"downloadUrl");_a.b.a(r,"destinationFileName");var e=new _at.E;e.a=n.bk.AttachmentId.Id;e.d=n.b();e.c=t;e.f=_a.bh.a(e.c);e.b=i;e.e=_a.S.a(r);e.g=u;e.h=f;_j.i.a(e.b)&&!_a.l.a().K&&(e.b="fakeMimeType");return e};_at.E.prototype={b:null,c:null,f:null,a:null,g:null,e:null,d:0,h:!1,toString:function(){return String.format("Attachment with Name {0} Size {1} ContentType {2} AttachmentId{3}",this.c,this.d,this.b,this.a)}};_at.b=function(n,t,i,r,u,f,e,o,s,h,c,l,a){_at.b.initializeBase(this,[n,t,i,r,u,o,s,h,c,l,a]);_a.b.b(f,"palDownloadManager");_a.b.b(a.a,"nativeBridge");_a.b.b(e,"itemStoreGetter");this.bH=f;this.cx=a.a;this.dA=e;this.bm&&this.eX(null,this.bm.bk.AttachmentId)};_at.b.prototype={cx:null,bH:null,dA:null,eS:null,dz:0,eT:null,eV:function(n){this.dz=n;this.eu("PALAttachmentDownloadStatus");return n},gw:function(n){this.eT=n;this.eu("PALAttachmentCurrentDowloadedBytes");return n},fE:function(){return _at.a.prototype.fE.call(this)||_dg.c.isInstanceOfType(this.bm)&&_a.cE.isInstanceOfType(this.bm.c)},cp:function(){var n=_at.a.prototype.cp.call(this);if(n&&this.cx&&this.cx.b(this.cx.d())){var t=this.cx.h(_a.fl,2);_j.e.a(_at.b.a,"SetOneTimeAllowedUrlSupported is {0}",t);n=!!(n&t)}return n},hy:function(){return this.bs.c()&&this.bA},eY:function(){return this.cp()&&!this.cf()?!1:this.bH.a()&&this.bA},gy:function(){this.gx()},d:function(n){_j.e.a(_at.b.a,"Got attachment status {0}",n);this.eV(n)},D:function(n){this.gw(String.format(_nbs.a.Em,this.eW(n,1),this.eW(this.bm.b(),0)))},E:function(n){_j.e.b(_at.b.a,"Unable to download attachment with name {0} and error is {1}",this.bm.bk.Name,n);this.cd(n)},r:function(n){_j.e.a(_at.b.a,"Found/Saved the record in offline db {0} {1}",n.DataID,n.AttachmentId);this.eS=n},gs:function(n){_a.cE.isInstanceOfType(n.c)?n.a()?this.gl():this.ip():_at.a.prototype.gs.call(this,n)},fy:function(n){if(_a.cE.isInstanceOfType(n.c)){_j.e.a(_at.b.a,"Deleting file attachment via PAL.");var t=n.c;this.cx.i().a(t.c())}else _at.a.prototype.fy.call(this,n)},fV:function(n,t){if(this.bH.a()){_j.e.a(_at.b.a,"Will use PAL to open attachment.");this.eZ()}else _at.a.prototype.fV.call(this,n,t)},fR:function(n,t){this.eX(n,t);_at.a.prototype.fR.call(this,n,t)},eZ:function(){_j.e.a(_at.b.a,"OpenAttachmentUsingPAL, download status={0}",this.dz);if(!this.bn.r(this.bK)){_j.e.b(_at.b.a,"The context has changed from "+this.bK+" to "+this.bn.bc()+", opening attachment using PAL has been skipped.");return}if(this.bn.bg()||!this.bA){_j.e.a(_at.b.a,"Returning because the attachment is a fake message. IsComposeReadOnlyWell = {0} and IsReadOnly {1}",this.bn.bg(),this.bA);return}this.gz();var t=_at.E.b(this);_j.e.a(_at.b.a,"PAL attachment download parameters: {0}",t.toString());switch(this.dz){case 0:case 1:this.D(0);_j.e.a(_at.b.a,"Starting PAL attachment download.");this.bH.c(t);break;case 3:case 2:_j.e.a(_at.b.a,"Canceling PAL attachment download.");this.bH.e(t);break;case 4:_j.e.a(_at.b.a,"PAL attachment download complete.");var n=this;this.dA.a(function(){var i=n.dA.b().a(_g.a.a().a().bk.TimeZone);_at.n.e(n.cx,i.j(),n.eS,t.b,t.c,function(){_j.e.a(_at.b.a,"Attachment opened successfully.")},function(t){_j.e.b(_at.b.a,"Attachment open failed with errorCode {0}",t);t===2&&n.eV(1);var i=_at.n.c(t);n.cd(i)})});break;default:break}},eX:function(n,t){if(this.bH)if(_dg.i.isInstanceOfType(this.bm)){_j.e.a(_at.b.a,"ItemAttachment for PAL status:Downloaded");this.eV(4)}else if(this.bH.a()){n&&n.Id&&this.bH.b(n.Id);t&&t.Id&&this.bH.d(t.Id,this)}},gx:function(){if(this.bH.a()&&this.bm&&this.bm.bk.AttachmentId&&!_dg.i.isInstanceOfType(this.bm)){_j.e.a(_at.b.a,"Unsubscribing for attachment with name {0} and id {1}",this.bm.bk.Name,this.bm.bk.AttachmentId);this.bH.b(this.bm.bk.AttachmentId.Id)}},eW:function(n,t){var i;var r=n;if(n>=1073741824){r/=1073741824;i=_u.R.Fl}else if(n>=1048576){r/=1048576;i=_u.R.LI}else if(n>=1024){r/=1024;i=_u.R.Gp}else i=_u.R.l;return String.format(i,Math.round(r*Math.pow(10,t))/Math.pow(10,t))},gz:function(){if(this.bs.e()&&(_j.i.b(this.bm.bk.ContentType)||_at.b.d===this.bm.bk.ContentType.toLowerCase())){var t=_a.bh.a(this.bm.bk.Name);var n;if(_j.i.b(t))n=_at.b.d;else{n=_at.b.f[t.toLowerCase()];_j.i.a(n)&&(n=_at.b.d)}_j.e.a(_at.b.a,"PAL GetMimeType File(Name:'{0}', Ext='{1}'), MimeType:(original:'{2}' is replaced with:'{3}')",this.bm.bk.Name||"<NULL>",t||"<NULL>",this.bm.bk.ContentType||"<NULL>",n);this.bm.i(n)}}};_at.bt=function(){};_at.bt.prototype={a:function(){return!1},d:function(n,t){throw Error.invalidOperation("This method is not implemented for BOWA.");},b:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},c:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},e:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");}};_at.bu=function(n){this.e=!!n&&n.a().bK().Enabled;this.f=!!n&&n.a().G().Enabled};_at.bu.prototype={e:!1,f:!1,a:null,b:null,c:function(n,t){if(!_j.i.a(t)){this.a||(this.a={});switch(n){case 4:case 3:case 5:case 6:case 2:case 1:this.a[n.toString()]=t;break;default:_j.e.c(_a.a.c,String.format("Cannot add sharing link for permission type: {0}",n));break}}},d:function(n,t){this.b||(this.b={});switch(n){case 4:case 3:case 5:case 6:this.b[n.toString()]=t;break;default:_j.e.c(_a.a.c,"Cannot create link of this type. Skip adding to dictionary");break}},h:function(n,t){var i=null;if(this.a)switch(n){case 4:case 3:case 5:case 6:n.toString()in this.a&&(i=this.a[n.toString()]);break;case 2:case 1:if(t&&t===_g.p.toString(0)&&"2"in this.a){i=this.a["2"];break}n.toString()in this.a&&(i=this.a[n.toString()]);break;default:break}return i},g:function(n){if(this.b)switch(n){case 4:case 3:case 5:case 6:return n.toString()in this.b?this.b[n.toString()]:!1;case 1:case 2:return!0;default:_j.e.c(_a.a.c,String.format("Cannot create link of permission type: {0}. Returning false.",n));return!1}return!1},i:function(n){if(this.e){_j.i.a(n.AnonymousEditLink)?this.d(4,n.CanCreateAnonymousEditLink):this.c(4,n.AnonymousEditLink);_j.i.a(n.AnonymousViewLink)?this.d(3,n.CanCreateAnonymousViewLink):this.c(3,n.AnonymousViewLink)}if(this.f){_j.i.a(n.OrganizationEditLink)?this.d(6,n.CanCreateOrganizationEditLink):this.c(6,n.OrganizationEditLink);_j.i.a(n.OrganizationViewLink)?this.d(5,n.CanCreateOrganizationViewLink):this.c(5,n.OrganizationViewLink)}}};_at.Z=function(n,t,i,r,u,f,e,o,s,h,c){_at.Z.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};_at.Z.a=function(){return"UriFileAttachmentNotification"+(_a.c.a().h()+_ff.o.a(0,1e3)).toString()};_at.Z.prototype={d:null,l:function(){this.d||(this.d=_at.Z.a());return this.d},gx:function(){return"UriFileAttachmentViewModel"},dT:function(){return!1},ed:function(n){if(_dg.c.isInstanceOfType(this.bm)&&_y.cj.isInstanceOfType(this.bm.c)){_j.e.a(_a.a.h,"Uploading attachment from URL");var i=this.bm.c;this.eT();var t=new _at.by(this.bn.c(),i.c(),i.b(),this.l(),this.bm.a(),this.bm.bk.ContentId);t.e(this.eS);this.bI.a(t)}else{_j.e.c(_a.a.h,"Unsupported upload type detected in addFileAttachment");n(null)}},eN:function(){this.gh(!1)}};_at.ba=function(n,t,i){this.c=n;this.d=t;this.b=i};_at.ba.prototype={c:null,d:null,b:null,a:function(n,t,i,r,u,f,e,o){var s=_at.l.a(this.d,this.b,u);return new _at.Z(n,t,i,r,u,f,e,o,this.c,s,this.b)}};var IWellKnownFileTypes=function(){};IWellKnownFileTypes.registerInterface("IWellKnownFileTypes");_at.bv=function(){};_at.bv.prototype={a:function(n,t){return String.format(_nbs.a.IR,n)},b:function(n,t){throw Error.notImplemented();}};_at.bw=function(){};_at.bw.prototype={imageAttachmentNotLoaded:1,attachmentSize:2,attachmentDownloadingProgress:3,attachmentOverlay:4,attachmentWaitingDownloadText:5,attachmentNotDownloadedOverlay:6};_at.bw.registerEnum("_at.bw",!1);_at.bx=function(){};_at.bx.prototype={a:function(n,t){var i=n;var r=!0;try{var u=_j.t.c(_at.bw,t.toString());switch(u){case 1:i&&i!==1||(r=!1);break;case 2:i&&i!==1&&i!==4||(r=!1);break;case 3:i===3&&(r=!1);break;case 4:(i===3||i===2)&&(r=!1);break;case 5:i===2&&(r=!1);break;case 6:i!==1&&i||(r=!1);break}}catch(f){r=!0}return r},b:function(n,t){throw Error.notImplemented();}};_at.e=function(){};_at.e.$$cctor=function(){_at.e._I()};_at.e.i=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <button type='button' class='_at_5'></button> <div class='_at_2 ms-font-s ms-font-weight-regular ms-font-color-neutralSecondary'> <span class='_at_3 ms-font-l ms-font-weight-semilight'></span> <span class='_at_3'></span> <span class='_at_3 _at_4'></span> </div> </div><div> <div> <button type='button'></button> </div> </div>";_j.h.a().appendChild(n);return n};_at.e.h=function(n){return n.e};_at.e.n=function(n){return n.d};_at.e.m=function(n){return n.j};_at.e.g=function(n,t){n.J(t)};_at.e.f=function(n,t){n.T(t)};_at.e.l=function(n,t){n.l(t)};_at.e.k=function(n,t){n.m(t)};_at.e.j=function(n,t){n.Q(t)};_at.e.d=function(n,t){n.a(t)};_at.e.e=function(){_at.e.b||(_at.e.b=new _fc.k);return _at.e.b};_at.e._I=function(){var t="AttachmentOptionsIntroductionPeekView";new _j.d(t,function(){_at.e.a[t]===undefined&&(_at.e.a[t]=[[[-1,4,null,null,null,"ImageId",null,_at.e.l,0,null,null,null,_n.b.dj()],[-1,4,null,null,null,"HoveredImageId",null,_at.e.k,0,null,null,null,_n.b.dk()],[-1,4,null,null,null,"AriaLabel",null,_at.e.j,0,null,null,null,_u.R.Bk],[-1,0,["ShowTitle"],[_at.e.h],null,"IsHidden",null,_at.e.g,1,_at.e.e(),null,!0],[-1,0,["CloseCommand"],[_at.e.n],null,"ClickCommand",null,_at.e.f,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_at.e.d,0,null,null,null,_nbs.a.lq],[-1,0,["ShowTitle"],[_at.e.h],null,"IsHidden",null,_at.e.g,1,_at.e.e(),null,!0]],[[-1,4,null,null,null,"Text",null,_at.e.d,0,null,null,null,_nbs.a.UR]],[[-1,4,null,null,null,"Text",null,_at.e.d,0,null,null,null,_nbs.a.iD]]]);var n=_at.e.c.childNodes[0].cloneNode(!0);var u=new _fc.a(_j.a.a(n,[1,2]));var f=new _fc.a(_j.a.a(n,[1,1]));var i=new _fc.a(_j.a.a(n,[1,0]));var r=new _fc.b(n.children[0]);return new _j.a(n,[r,i,f,u])},"",_at.L,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_at.e.a);var n="InlineImageAttachment";new _j.d(n,function(){_at.e.a[n]===undefined&&(_at.e.a[n]=[[[-1,1,["PreviewCommand"],[_at.e.m],null,"ClickCommand",null,_at.e.f,1,null,null,null]]]);var i=_at.e.c.childNodes[1].cloneNode(!0);var t=new _fc.b(_j.a.a(i,[0,0]));return new _j.a(i,[t]).l({ImageContainerButton:t})},"",_j.c,_at.H,function(n){return new _at.H(n,_j.b.Instance.a(Array),_j.b.Instance.a(Number),_j.b.Instance.a(ImageElement),_j.b.Instance.a(Function))},!1,!1,!1,0,_at.e.a)};_at.F.registerClass("_at.F");_at.by.registerClass("_at.by",_h.fa);AttachmentsComponent.registerClass("AttachmentsComponent",null,_a.ic,_j.ce);_at.l.registerClass("_at.l",null,IDownloadAuthenticatorFactory);_at.bn.registerClass("_at.bn",_h.fa,_a.fs);_at.r.registerClass("_at.r",null,IDownloadAuthenticator);_at.t.registerClass("_at.t",null,IFileReader);_at.m.c.registerClass("_at.m.c");_at.o.registerClass("_at.o",_h.fa,_a.fs);_at.bb.registerClass("_at.bb",_h.fa,_a.fs);_at.bc.registerClass("_at.bc",_h.fa,_a.fs);_at.bd.registerClass("_at.bd",_h.fa,_a.fs);_at.be.registerClass("_at.be",_h.fa,_a.fs);_at.bf.registerClass("_at.bf",_h.fa);_at.bg.registerClass("_at.bg",_h.fa);_at.bh.registerClass("_at.bh",_h.fa);_at.i.registerClass("_at.i",_h.cO.$$(_gg.hy,_gg.hh));_at.bi.registerClass("_at.bi",_at.i);_at.I.registerClass("_at.I",_h.fa,_a.fs);_at.bj.registerClass("_at.bj",_h.cO.$$(_gg.hP,_gg.hR));_at.bk.registerClass("_at.bk",_h.fa);_at.v.registerClass("_at.v",_h.cO.$$(_gg.vt,_gg.hh));_at.bl.registerClass("_at.bl",_h.fa);_at.q.registerClass("_at.q",_h.fa);_at.h.registerClass("_at.h",_h.fa);_at.bz.registerClass("_at.bz",_h.fa);_at.bm.registerClass("_at.bm",_at.bz);_at.S.registerClass("_at.S",_at.bz);_at.T.registerClass("_at.T",_at.bz);_at.U.registerClass("_at.U",_h.fa);_at.V.registerClass("_at.V",_h.fa);_at.s.registerClass("_at.s",_b.bp);_at.R.registerClass("_at.R",_b.bp);_at.c.registerClass("_at.c",_b.D);_at.H.registerClass("_at.H",_j.c);_at.bo.registerClass("_at.bo",_a.br);_at.j.registerClass("_at.j");_at.x.registerClass("_at.x");_at.y.registerClass("_at.y");_at.p.registerClass("_at.p");_at.bp.registerClass("_at.bp",_a.br);_at.L.registerClass("_at.L",_a.bB,_y.el,_a.iP,_j.bp,Sys.IDisposable);_at.a.registerClass("_at.a",_a.bB,_at.Y,_y.ds,_j.bp,Sys.IDisposable);_at.D.registerClass("_at.D");_at.bB.registerClass("_at.bB",null,_at.bC);_at.M.registerClass("_at.M",_at.bB);_at.br.registerClass("_at.br",_at.bB);_at.N.registerClass("_at.N",_at.bB);_at.z.registerClass("_at.z",_at.bB);_at.O.registerClass("_at.O",_at.bB);_at.P.registerClass("_at.P",_at.bB);_at.A.registerClass("_at.A",_at.bB);_at.B.registerClass("_at.B",_at.a);_at.E.registerClass("_at.E");_at.b.registerClass("_at.b",_at.a,_at.bD);_at.bu.registerClass("_at.bu");_at.Z.registerClass("_at.Z",_at.B);_at.ba.registerClass("_at.ba",null,IUriFileAttachmentViewModelFactory);_at.bx.registerClass("_at.bx",null,_j.bQ);AttachmentsComponent.$$cctor();_at.l.c=_a.a.c;_at.r.a=_a.a.c;_at.g.b=null;_at.C.a=_at.C.b();_at.m.b=null;_at.o.a={};_at.i.a=_a.a.c;_at.v.a=_a.a.c;_at.q.a=null;_at.h.a=null;_at.h.b=0;_at.s.a=_a.l.a().G&&!_a.l.a().L;_at.c.c=new _a.e("Attachment",_g.Attachment,_at.c);_at.c.e=new _a.e("ParentItemId",_g.g,_at.c);_at.c.g=new _a.e("IsEnabled",Boolean,_at.c);_at.c.d=new _a.e("FileSelectedCommand",_j.L,_at.c);_at.c.b=new _a.e("UploadAttachmentCommand",_j.L,_at.c);_at.c.f=new _a.e("UploadCompletedCommand",_j.L,_at.c);_at.c.a=_a.a.c;_at.a.i="b7780972f918485c8cfc32b1ba7438eb";_at.a.f=_a.J.a();_at.a.e=_a.J.a();_at.a.a=_a.a.c;_at.a.d=new _j.q([".mp3"]);_at.a.n=new _j.q([".txt",".xml",".log"]);_at.a.h=new _j.q([".msg",".eml"]);_at.a.j=new _j.q([".ics",".ical",".icalendar",".vcs"]);_at.a.c=new _j.q([".pdf"]);_at.a.g=[8,1,4,9,5,6];_at.a.b=null;_at.M.a=[7,3];_at.N.a=[7,4,3];_at.z.b=new _j.q(["application/vnd.google-apps.document","application/vnd.google-apps.spreadsheet","application/vnd.google-apps.presentation"]);_at.z.a=[8,7,3];_at.O.a=new Array(0);_at.P.a=[8,0,2,4,7,3,5];_at.A.a=[8,0,2,4,7,3,10,5];_at.A.b=[8,0,2,4,7,3];_at.k.b=["","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR"];_at.f.j=[137,80,78,71,13,10,26,10];_at.f.h=[71,73,70,56,55,97];_at.f.i=[71,73,70,56,57,97];_at.f.g=[66,77];_at.n.a=_a.a.c;_at.n.b=!1;_at.d.a=_a.a.c;_at.b.a=_a.a.c;_at.b.d="application/octet-stream";_at.b.b="application/vnd.ms-excel";_at.b.e="application/msword";_at.b.c="application/vnd.ms-powerpoint";_at.b.f={".abc":"text/vnd.abc",".acgi":"text/html",".afl":"video/animaflex",".aif":"audio/aiff",".aifc":"audio/aiff",".aiff":"audio/aiff",".aip":"text/x-audiosoft-intra",".art":"image/x-jg",".asf":"video/x-ms-asf",".asm":"text/x-asm",".asp":"text/asp",".asx":"video/x-ms-asf",".au":"audio/basic",".avi":"video/avi",".avs":"video/avs-video",".bm":"image/bmp",".bmp":"image/bmp",".c":"text/plain",".c++":"text/plain",".cat":"application/vnd.ms-pki.seccat",".cc":"text/plain",".chm":"application/vnd.ms-htmlhelp",".conf":"text/plain",".cpp":"text/x-c",".cs":"text/plain",".css":"text/css",".csv":_at.b.b,".cxx":"text/plain",".def":"text/plain",".dif":"video/x-dv",".dl":"video/dl",".doc":_at.b.e,".docm":"application/vnd.ms-word.document.macroEnabled.12",".docx":"application/vnd.openxmlformats-officedocument.wordprocessingml.document",".dot":_at.b.e,".dotm":"application/vnd.ms-word.template.macroEnabled.12",".dotx":"application/vnd.openxmlformats-officedocument.wordprocessingml.template",".dv":"video/x-dv",".dwg":"image/vnd.dwg",".dxf":"image/vnd.dwg",".el":"text/x-script.elisp",".etx":"text/x-setext",".f":"text/plain",".f77":"text/x-fortran",".f90":"text/plain",".fif":"image/fif",".fli":"video/fli",".flo":"image/florian",".flx":"text/vnd.fmi.flexstor",".fmf":"video/x-atomic3d-feature",".for":"text/x-fortran",".fpx":"image/vnd.fpx",".funk":"audio/make",".g":"text/plain",".g3":"image/g3fax",".gif":"image/gif",".gl":"video/gl",".gsd":"audio/x-gsm",".gsm":"audio/x-gsm",".h":"text/plain",".hh":"text/plain",".hlb":"text/x-script",".htc":"text/x-component",".htm":"text/html",".html":"text/html",".htmls":"text/html",".htt":"text/webviewhtml",".htx":"text/html",".hxx":"text/plain",".ico":"image/x-icon",".idc":"text/plain",".ief":"image/ief",".iefs":"image/ief",".isu":"video/x-isvideo",".it":"audio/it",".jam":"audio/x-jam",".jav":"text/plain",".java":"text/plain",".jfif":"image/jpeg",".jfif-tbnl":"image/jpeg",".jpe":"image/jpeg",".jpeg":"image/jpeg",".jpg":"image/jpeg",".jps":"image/x-jps",".jut":"image/jutvision",".kar":"audio/midi",".la":"audio/nspaudio",".lam":"audio/x-liveaudio",".list":"text/plain",".lma":"audio/nspaudio",".log":"text/plain",".lst":"text/plain",".lsx":"text/x-la-asf",".m":"text/plain",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3u":"audio/x-mpequrl",".mar":"text/plain",".mcf":"text/mcf",".mid":"audio/midi",".midi":"audio/midi",".mjf":"audio/x-vnd.audioexplosion.mjuicemediafile",".mjpg":"video/x-motion-jpeg",".mod":"audio/mod",".moov":"video/quicktime",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"audio/mpeg",".mp3":"audio/mpeg",".mp4":"video/mp4",".mpa":"audio/mpeg",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpga":"audio/mpeg",".mpp":"application/vnd.ms-project",".mpt":"application/vnd.ms-project",".mpv":"application/vnd.ms-project",".mpx":"application/vnd.ms-project",".mv":"video/x-sgi-movie",".my":"audio/make",".nap":"image/naplps",".naplps":"image/naplps",".nif":"image/x-niff",".niff":"image/x-niff",".ogg":"video/ogg",".ogv":"video/ogg",".p":"text/x-pascal",".pas":"text/pascal",".pbm":"image/x-portable-bitmap",".pct":"image/x-pict",".pcx":"image/x-pcx",".pdf":"application/pdf",".pfunk":"audio/make",".pgm":"image/x-portable-greymap",".pic":"image/pict",".pict":"image/pict",".pko":"application/vnd.ms-pki.pko",".pl":"text/plain",".pm":"image/x-xpixmap",".png":"image/png",".pot":_at.b.c,".potm":"application/vnd.ms-powerpoint.template.macroEnabled.12",".potx":"application/vnd.openxmlformats-officedocument.presentationml.template",".ppa":_at.b.c,".ppam":"application/vnd.ms-powerpoint.addin.macroEnabled.12",".ppm":"image/x-portable-pixmap",".pps":_at.b.c,".ppsm":"application/vnd.ms-powerpoint.slideshow.macroEnabled.12",".ppsx":"application/vnd.openxmlformats-officedocument.presentationml.slideshow",".ppt":_at.b.c,".pptm":"application/vnd.ms-powerpoint.presentation.macroEnabled.12",".pptx":"application/vnd.openxmlformats-officedocument.presentationml.presentation",".ppz":_at.b.c,".pwz":_at.b.c,".py":"text/x-script.phyton",".qcp":"audio/vnd.qcelp",".qif":"image/x-quicktime",".qt":"video/quicktime",".qtc":"video/x-qtc",".qti":"image/x-quicktime",".qtif":"image/x-quicktime",".ra":"audio/x-pn-realaudio",".ram":"audio/x-pn-realaudio",".rast":"image/cmu-raster",".rexx":"text/x-script.rexx",".rf":"image/vnd.rn-realflash",".rgb":"image/x-rgb",".rmi":"audio/mid",".rmm":"audio/x-pn-realaudio",".rmp":"audio/x-pn-realaudio",".rp":"image/vnd.rn-realpix",".rpm":"audio/x-pn-realaudio-plugin",".rt":"text/richtext",".rtf":"text/richtext",".rtx":"text/richtext",".rv":"video/vnd.rn-realvideo",".s":"text/x-asm",".s3m":"audio/s3m",".sdml":"text/plain",".sgm":"text/sgml",".sgml":"text/sgml",".shtml":"text/html",".sid":"audio/x-psid",".sldm":"application/vnd.ms-powerpoint.slide.macroEnabled.12",".sldx":"application/vnd.openxmlformats-officedocument.presentationml.slide",".snd":"audio/basic",".spc":"text/x-speech",".ssi":"text/x-server-parsed-html",".sst":"application/vnd.ms-pki.certstore",".svf":"image/vnd.dwg",".talk":"text/x-speech",".tcsh":"text/x-script.tcsh",".text":"text/plain",".tif":"image/tiff",".tiff":"image/tiff",".tsi":"audio/tsp-audio",".tsv":"text/tab-separated-values",".turbot":"image/florian",".txt":"text/plain",".uil":"text/x-uil",".uni":"text/uri-list",".unis":"text/uri-list",".uri":"text/uri-list",".uris":"text/uri-list",".uue":"text/x-uuencode",".vcs":"text/x-vcalendar",".vdo":"video/vdo",".viv":"video/vivo",".vivo":"video/vivo",".voc":"audio/voc",".vos":"video/vosaic",".vox":"audio/voxware",".vqe":"audio/x-twinvq-plugin",".vqf":"audio/x-twinvq",".vql":"audio/x-twinvq-plugin",".vsd":"application/x-visio",".vst":"application/x-visio",".vsw":"application/x-visio",".w6w":"application/msword",".wav":"audio/wav",".wbmp":"image/vnd.wap.wbmp",".webm":"video/webm",".wiz":"application/msword",".wm":"video/x-ms-wm",".wma":"audio/x-ms-wma",".wmf":"windows/metafile",".wml":"text/vnd.wap.wml",".wmls":"text/vnd.wap.wmlscript",".wmp":"video/x-ms-wmp",".wmv":"video/x-ms-wmv",".wmx":"video/x-ms-wmx",".word":"application/msword",".wsc":"text/scriplet",".wvx":"video/x-ms-wvx",".xbm":"image/x-xbitmap",".xdr":"video/x-amt-demorun",".xif":"image/vnd.xiff",".xl":"application/excel",".xla":_at.b.b,".xlam":"application/vnd.ms-excel.addin.macroEnabled.12",".xlb":_at.b.b,".xlc":_at.b.b,".xld":_at.b.b,".xlk":_at.b.b,".xll":_at.b.b,".xlm":_at.b.b,".xls":_at.b.b,".xlsb":"application/vnd.ms-excel.sheet.binary.macroEnabled.12",".xlsm":"application/vnd.ms-excel.sheet.macroEnabled.12",".xlsx":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",".xlt":_at.b.b,".xltm":"application/vnd.ms-excel.template.macroEnabled.12",".xltx":"application/vnd.openxmlformats-officedocument.spreadsheetml.template",".xlv":_at.b.b,".xlw":_at.b.b,".xm":"audio/xm",".xpm":"image/xpm",".xps":"application/vnd.ms-xpsdocument",".x-png":"image/png",".xsr":"video/x-amt-showrun",".xwd":"image/x-xwd",".zsh":"text/x-script.zsh"};_at.e.c=_at.e.i();_at.e.b=null;_at.e.a={};_at.e.$$cctor();
window.scriptsLoaded['microsoft.owa.core.attachments.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.attachments.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
