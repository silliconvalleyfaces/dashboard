try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.adsbar.js'] = (new Date()).getTime();
Type.registerNamespace("_ab");function AdsbarComponent(){}AdsbarComponent.$$cctor=function(){_a.u.a().a(AdsbarComponent)};AdsbarComponent.prototype={a:function(n,t,i){var r=this;n.b(_ab.c,function(){return new _ab.c(n.a(_g.a),n.a(_j.bg),n.a(_a.cd),n.a(_j.j),n.a(_g.N),n.a(IInferenceTracker),n.a(_a.y).c(),n.a(_y.p),n.a(_db.J),n.a(_a.t),n.a(_a.y),n.a(_j.o))}).b(IAdsbarViewModel).a()},b:function(){return null}};_ab.d=function(){_ab.d.initializeBase(this)};_ab.d.prototype={K:function(n){var t=new _dg.cd(this.L);n.eo(t,this.I,this.G)},cT:function(n,t,i){t()}};_ab.c=function(n,t,i,r,u,f,e,o,s,h,c,l){this.C=Function.createDelegate(this,this.bg);this.z=Function.createDelegate(this,this.be);this.A=Function.createDelegate(this,this.bf);this.D=Function.createDelegate(this,this.bh);_ab.c.initializeBase(this);this.c=i;this.b=f;this.e=n;this.a=this.r();this.M=this.S();this.y=this.R();this.L=u;this.f=o;this.w=e;this.E=String.format(_nbs.a.Gx,String.format("http://windows.microsoft.com/{0}/outlook/ad-free-outlook",this.a));this.b.bl(this.a);this.n=h;this.F=c;this.d=r;this.x=l;this.i=[];this.K=t;if(this.w.b("overrideadssdkbaseurl")){this.h=e.a.overrideadssdkbaseurl;this.k=this.h+"adbar.js"}else if(this.bc()&&i.a().d().OwaAdBarScript&&i.a().d().OwaAdBarBaseUrl){this.k=i.a().d().OwaAdBarScript;this.h=i.a().d().OwaAdBarBaseUrl}else{this.k=i.a().d()&&i.a().d().AdBarSdkScript?i.a().d().AdBarSdkScript:"https://r1.res.office365.com/adbar/v2.0/adbar.js";this.h=i.a().d()&&i.a().d().AdBarSdkBaseUrl?i.a().d().AdBarSdkBaseUrl:"https://r1.res.office365.com/adbar/v2.0/"}this.p=this.w.b("overrideastsdkurl")?e.a.overrideastsdkurl:i.a().d().AstScriptUrl?i.a().d().AstScriptUrl:"https://acdn.adnxs.com/ast/ast.js";this.l=this.Y();this.l&&(this.G=this.Q());var a=this;s.d(function(n){a.g=n;a.m=a.bd()&&!a.W(n)&&a.X()&&!a.V()&&a.bb();a.q=a.m&&!a.Z();if(a.q){a.d.b(_a.bb,a.D);a.d.b(_a.cp,a.A);a.d.b(_a.di,a.z);a.d.b(_y.bg,a.C);a.j(!0)}else a.j(!1);a.bj();a.P()})};_ab.c.prototype={x:null,e:null,d:null,c:null,b:null,L:null,n:null,F:null,f:null,a:null,M:null,y:null,w:null,l:!1,G:null,k:null,h:null,p:null,q:!1,m:!1,v:!1,t:!1,K:null,o:null,g:null,I:!1,J:!1,i:null,j:function(n){n&&(!this.q||this.i.length)||this.f.i===n||this.f.bf(n)},O:function(n){if(this.v!==n){this.v=n;this.eu("ShowAdBlockMessage")}return n},E:null,N:function(n,t,i,r){if(n<=990){this.s("NotLoadedByNotMeetMinBrowserWidth");return}if(this.f&&this.f.a()&&this.f.a().a){this.s("NotLoadedByNotInMailModule");return}if(!this.I){this.O(!0);var u=this;this.K.a(this.k,function(){u.O(!1);if(window.wLive&&window.wLive.adbar){var e=u.T(i,r);window.wLive.adbar.init(e);window.wLive.adbar.show();u.d.a(_a.bb,new _a.bb("Mail"));var f=n.toString()+"x"+t.toString();u.b.bm(f,u.a);u.I=!0}else u.b.c("NotLoadedBySdkFail",u.a)})}},T:function(n,t){var i={};i.BaseUrl=this.h;i.Height=t;i.Width=n;i.Market=this.a;i.ContainerID="owaadbar";i.Environment="Prod";i.AstUrl=this.p;i.CallbackEventName="AdCallbackOwa";var f=this;i.Visibility=function(){return f.f.i&&f.t};var u={};var h=this;u.adErrorEventHandler=function(){};var s=this;u.hide=function(){};i.PublisherObject=u;var r={};var e=this;r.addEventListener=function(n,t){n==="contextChange"&&(e.o=t)};var o=this;r.removeEventListener=function(){};i.EventManager=r;return i},s:function(n){this.b.c(n,this.a);this.j(!1)},ex:function(){this.d.c(_a.bb,this.D);this.d.c(_a.cp,this.A);this.d.c(_a.di,this.z);this.d.c(_y.bg,this.C);_a.jb.prototype.ex.call(this)},bf:function(n){if(n.a==="NotLoadedByReadingPaneComposeHide"&&this.l){this.f.i&&!n.b&&this.b.c("LoadedOnReadingPaneComposeHide",this.a);return}this.bi(n);this.f.i&&!n.b&&this.b.c(n.a,this.a);this.j(n.b)},be:function(n){n.a&&this.b.bk();this.t=n.a},bh:function(n){if(this.f.i&&!this.t&&this.o){var t=this;_j.n.a().d(_a.a.y,"AdsRefresh",function(){t.b.bj(t.a,n.a);var i=t.l&&n.a==="MCompose"?t.G:null;t.o(n.a,null,i)})}},bd:function(){return this.c.a().d().Enabled},bb:function(){if(this.c.a().d()&&this.c.a().d().SupportedMarkets){var t=this.c.a().d().SupportedMarkets;var i=this.a.toUpperCase();var n=Array.contains(t,i);n||this.b.c("NotLoadedByUnSupportedMarket",this.a);return n}return!0},bc:function(){return this.c.a().gd().Enabled&&this.ba()},ba:function(){if(this.c.a().d().OwaAdBarCountries){var i=this.c.a().d().OwaAdBarCountries;var t=this.y.toUpperCase();return Array.contains(i,t)}return!1},r:function(){var t=this.e.bk.AdMarket;if(t)return t.toLowerCase();else{var n=this.e.s();return n?n.toLowerCase():"en-us"}},R:function(){var n=this.r();return n.split("-")[1]},S:function(){var n=this.r();return n.split("-")[0]},Q:function(){return("WAB4"+this.y+this.M).toUpperCase()},Y:function(){var n=this.c.a().d().AdsInComposeSupportedMarkets;return n&&n.length>0?this.c.a().gc().Enabled&&Array.contains(n,this.r().toUpperCase()):!1},bi:function(n){n.b?Array.remove(this.i,n.a):Array.contains(this.i,n.a)||Array.add(this.i,n.a)},X:function(){var n=this.e.z&&!this.L.bk.IsPremiumConsumerMailbox;n||(this.J?this.b.c("NotLoadedByAdPaidUserO365",this.a):this.b.c("NotLoadedByAdPaidUser",this.a));return n},W:function(n){if(n&&n.ConsumerSubscriptions)for(var t=0;t<n.ConsumerSubscriptions.length;t++){var i=n.ConsumerSubscriptions[t];if(i==="GA-O365HOMEPREM-XX-SUB"){this.J=!0;this.b.c("NotLoadedByUseHasO365SubscriptionTest",this.a);return!1}}return!1},V:function(){var n=this.e.z&&this.e.bk.IsConsumerChild;n&&this.b.c("NotLoadedByKidAccount",this.a);return n},Z:function(){var n=this.c.a().dx().Enabled;if(n)if(this.x.h()){this.b.c("NotLoadedByEdgeOffer",this.a);this.d.d(_db.bH,new _db.bH);return!0}else this.x.E()&&this.d.d(_db.bI,new _db.bI);return!1},bg:function(n){n.a&&!n.a.a?this.j(!0):this.s("NotLoadedByNotInMailModule")},P:function(){if(this.U()){var n=new _ab.d;var i=this;n.d(function(t){var r=n.N;var i="";r.Subscriptions&&(i=r.Subscriptions.join(","));_j.e.a(_a.a.y,"fetchUserSubscriptionAction success subscription offerid are: {0}",i)});var t=this;n.e(function(n){_j.e.c(_a.a.y,"fetchUserSubscriptionAction failed for user: {0}",t.e.c().bk.UserPuid)});this.n.a(n)}},U:function(){if(!this.c.a().dC().Enabled||!this.F.e().c("15.01.0452.000")||!this.g)return!1;if(this.g.ConsumerSubscriptions)for(var n=0;n<this.g.ConsumerSubscriptions.length;n++){var u=this.g.ConsumerSubscriptions[n];if(u==="GA-O365HOMEPREM-XX-SUB"){var r=_a.c.b(this.g.ConsumerSubscriptionExpireDates[n]);if(r.b(_a.c.a())>0)return!1}}var i=this.c.a().dC().DaysBeforeNextFetch;var t=null;this.g.ConsumerSubscriptionLastFetchDate&&(t=_a.c.b(this.g.ConsumerSubscriptionLastFetchDate));return!i||!t||t.c(i).b(_a.c.get_utcNow())<0?!0:!1},bj:function(){var i=(32768&this.e.a().x())!=32768;if(this.m!==i){if(this.m){var t;(t=this.e.a()).y(t.x()&-32769)}else{var n;(n=this.e.a()).y(n.x()|32768)}_h.f.a(this.e.a().v,this.n)}}};_ab.b=function(n,t,i){this.h=Function.createDelegate(this,this.m);this.e=Function.createDelegate(this,this.k);this.i=Function.createDelegate(this,this.n);this.f=Function.createDelegate(this,this.o);_ab.b.initializeBase(this,[n]);this.c=t;this.d=i;this.g=_g.a.a().s()?_g.a.a().s().toLowerCase():"en-us"};_ab.b.prototype={c:null,d:null,g:null,a:null,b:null,G:function(){_j.c.prototype.G.call(this);this.l()},O:function(){_j.c.prototype.O.call(this);this.c.h(this.f);_j.k.b(this.z,"AdCallbackOwa",this.i)},I:function(){_j.c.prototype.I.call(this);this.b=this.C.a("AdBlockHtmlLabel");this.b&&this.b.dS(this.e)},bF:function(){this.c&&this.c.j(this.f);this.z&&_j.k.c(this.z,"AdCallbackOwa");this.b&&this.b.go(this.e);_j.c.prototype.bF.call(this)},k:function(n){for(var i=_j.E.d(n.z.childNodes,"a[target]"),t=0;t<i.length;t++)_j.k.b(i[t],"click",this.h)},m:function(n){this.d.g("AdBlockPage",this.g)},l:function(){var n=this.j();this.a=this.W();this.a.N(window.document.body.clientWidth,window.document.body.clientHeight,160,n)},o:function(){if(window.document.body.clientWidth>990){var n=this.j();if(this.a){this.a.j(!0);window.wLive&&window.wLive.adbar&&window.wLive.adbar.resize(160,n)}else this.a.N(window.document.body.clientWidth,window.document.body.clientHeight,160,n)}else this.a.s("NotLoadedByNotMeetMinBrowserWidth")},j:function(){var t=window.document.body.clientHeight;var n=t-50;n<=0&&(n=660);return n},n:function(n){var t=n.p;this.d.bi(t.UserMarket,t.ContextRefreshName,t.Provider)}};_ab.a=function(){};_ab.a.$$cctor=function(){_ab.a._I()};_ab.a.e=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='__Microsoft_Owa_Adsbar_templates_cs_5'> <span class='__Microsoft_Owa_Adsbar_templates_cs_3 ms-fcl-nsa'> </span> <br/> <span class='__Microsoft_Owa_Adsbar_templates_cs_4 ms-fwt-r ms-font-color-black'></span> </div> </div><div> <div class='__Microsoft_Owa_Adsbar_templates_cs_2'></div> </div>";_j.h.a().appendChild(n);return n};_ab.a.h=function(n){return n.v};_ab.a.g=function(n){return n.E};_ab.a.f=function(n,t){n.a(t)};_ab.a.i=function(n,t){n.a(t)};_ab.a.d=function(){_ab.a.b||(_ab.a.b=new _fc.k);return _ab.a.b};_ab.a._I=function(){var t="AdsbarPanelView._tid1";new _j.d(t,function(){_ab.a.a[t]===undefined&&(_ab.a.a[t]=[[[-1,5,["ShowAdBlockMessage"],[_ab.a.h],null,"__Microsoft_Owa_Adsbar_templates_cs_6",null,null,0,_ab.a.d(),null,null]],[[-1,4,null,null,null,"Id",null,_ab.a.f,0,null,null,null,_fm.a.br]],[[-1,0,["AdBlockUseAdFreeMessage"],[_ab.a.g],null,"Html",null,_ab.a.i,1,null,null,null]]]);var n=_ab.a.c.childNodes[0].cloneNode(!0);var i=new _b.p(_j.a.a(n,[0,2]),_j.b.Instance.a(_a.f));var u=new _fc.d(_j.a.a(n,[0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var r=new _j.h(n.children[0]);return new _j.a(n,[r,u,i]).l({AdBlockHtmlLabel:i})},"",_ab.c,_ab.b,function(n){return new _ab.b(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(IInferenceTracker))},!1,!0,!1,0,_ab.a.a);var n="AdsbarPanelView";new _j.d(n,function(){_ab.a.a[n]===undefined&&(_ab.a.a[n]=[null]);var i=_ab.a.c.childNodes[1].cloneNode(!0);var t=new _ab.b(i.children[0],_j.b.Instance.a(_y.a),_j.b.Instance.a(IInferenceTracker));t.N("owaadbar");t.y("AdsbarPanelView._tid1");return new _j.a(i,[t])},"",_ab.c,_ab.b,function(n){return new _ab.b(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(IInferenceTracker))},!1,!1,!1,0,_ab.a.a)};AdsbarComponent.registerClass("AdsbarComponent",null,_a.ic,_j.ce);_ab.d.registerClass("_ab.d",_h.fa);_ab.c.registerClass("_ab.c",_a.bB,IAdsbarViewModel,_j.bp,Sys.IDisposable);_ab.b.registerClass("_ab.b",_j.c);AdsbarComponent.$$cctor();_ab.a.c=_ab.a.e();_ab.a.b=null;_ab.a.a={};_ab.a.$$cctor();
window.scriptsLoaded['microsoft.owa.adsbar.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.adsbar.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
