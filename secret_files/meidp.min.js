try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['meidp.min.js'] = (new Date()).getTime();
(function(){function f(){function e(){function n(){return((1+Math.random())*65536|0).toString(16).substring(1)}return(n()+n()+'-'+n()+'-4'+n().substr(0,3)+'-'+n()+'-'+n()+n()+n()).toLowerCase()}var u=this,i,f;n?(i=n.getItem(r)||e(),n.setItem(r,i)):i=e(),Date.now||(Date.now=function(){return+new Date}),u.setLogEvent=function(n){f=n},u.id=i,u.logQos=function(n,i,r,f,e){e=e||{},e[t]='qos',e.success=i?'1':'0',e.duration=r||0,e.errorCode=f||'',u.logEvent(n,e)},u.logEvent=function(n,r){r=r||{},r[t]||(r[t]='bici'),r.ts=Date.now(),r.uaid=i,f&&f(n,r)}}var i=window;i.MSA={};var u=i.MSA.MeControl={},n=i.sessionStorage,r='msameid',t='type';u.IDP={MSA:'msa',AAD:'aad'},u.Log=new f})(),function(n){function r(){function o(n,t,i){var u=i.s===t,r,e,f;return u||(t=t||0,r=n.charCodeAt(t),i.s=-1,r<55296||r>57343?i.c=r:r<=56319?(e=r,f=n.charCodeAt(t+1),i.c=(e-55296)*1024+(f-56320)+65536,i.s=t+1):(i.c=-1,u=!0)),!u}var r=this,f=!1,u={};r.addStrings=function(t){n.extend(u,t)},r.getString=function(n,t){var i=u[n]||r.format('ERROR: {0}',n);return t?r.encodeHtml(i):i},r.startsWith=function(n,t){return n.substr(0,t.length)===t},r.format=function(n){function v(n){var i=y[parseInt(n.replace(t,""))+1];return i==null&&(i=''),i}var y=arguments;return n.replace(e,v)},r.dispose=function(){f||(u=null,f=!0)},r.encodeHtml=function(n){if(!n)return'';var t={c:0,s:-1};return n.replace(i,function(n,i,r){return o(r,i,t)?['&#',t.c,';'].join(''):''})}}var u=window,f=u.MSA.MeControl,e=/\{\d+\}/g,t=/[\{\}]/g,i=/[^\w .,-]/g;f.Strings=new r}(window.MejQuery),function(){var i=window,n=i.MSA.MeControl,t=n.Strings;n.Util={appendQueryParameter:function(n,i,r){return n?t.format('{0}{1}{2}={3}',n,n.indexOf('?')===-1?'?':'&',i,r):''}}}(),function(n){function r(){function c(){n(i).on('message.msame',s)}function o(t,i){var u;if(t){var s=Date.now(),o='mecontrol_iframe_index_'+h++,e=n('<iframe style="display:none"></iframe>').attr('id',o).attr('src',t);e.appendTo('body'),i&&(u=f.getDomainFromUrl(t),r[u]||(r[u]={}),r[u][o]={callback:i,iframe:e[0],start:s})}}function s(t){var i=t.originalEvent;i&&r[i.origin]&&n.each(r[i.origin],function(n,t){i.source==t.iframe.contentWindow&&(u.logQos('IFrameCtrl',!0,Date.now()-t.start,'',{src:t.iframe.src}),t.callback(i))})}var f=this,e=!1,h=0,r={};f.getDomainFromUrl=function(n){var t=document.createElement('a'),i;return t.href=n,i=t.protocol+'//'+t.hostname,t.port!==null&&t.port!==''&&t.port!=='443'&&t.port!=='80'&&(i+=':'+t.port),i},f.openIFrame=function(n,i,r){if(r)for(var u in r)n=t.Util.appendQueryParameter(n,u,r[u]);o(n,i)},f.dispose=function(){e||(n(i).off('message.msame'),f=null,r=null,e=!0)},c();n(i).on('unload.msame',f.dispose)}var i=window,t=i.MSA.MeControl,u=t.Log,f=t.Strings;t.IFrameControl=new r}(window.MejQuery),function(n){function e(e){function a(t){var e,v,f,u,a;l&&(e=o.msaInfo.meTrustedOrigin&&t.origin===o.msaInfo.meTrustedOrigin,v=o.aadInfo.meTrustedOrigin&&t.origin===o.aadInfo.meTrustedOrigin,(e||v)&&typeof t.data=='string'&&(c--,f={currentIdp:e?i.IDP.MSA:i.IDP.AAD,messagesMissing:c},u=n.parseJSON(t.data),u&&u.userList&&u.userList.length>0?s.push.apply(s,u.userList):(a='InvalidIdpData',u&&u.error&&(f.IDPError=u.error,a='IDPError'),r.logQos('UserStatePartial',!1,Date.now()-y,a,f)),c===0&&(s&&s.length>0?h(!0):h(!1,'NoIdpData',f))))}function h(n,t,i){v=s||[],i=i||{},i.userCount=v.length,r.logQos('UserState',n,Date.now()-y,t,i),n?d(s):p&&p(),g()}function nt(){l&&(s&&s.length>0?h(!0,'',{timeout:!0,messagesMissing:c}):h(!1,'Timeout'))}function g(){c=0,l=!1,y=0,s=[]}var w=this,b=!1,o=e,s=[],v=null,d=null,p=null,k=1e4,c=0,l=!1,y;w.currentState=function(){return v||[]},w.getUserState=function(n,i,e){if(v=null,d=n,p=i,y=Date.now(),!f.postMessage){h(!1,'PostMessageNotSupported');return}if(location.protocol!=='https:'){h(!1,'HttpNotSupported');return}e&&(k=e),setTimeout(nt,k),l=!0,c=2;var s={uaid:r.id};o&&o.msaInfo&&o.aadInfo?o.msaInfo&&o.msaInfo.meUrl?(o.msaInfo.meTrustedOrigin=t.getDomainFromUrl(o.msaInfo.meUrl),o.aadInfo&&o.aadInfo.meUrl?(o.aadInfo.meTrustedOrigin=t.getDomainFromUrl(o.aadInfo.meUrl),t.openIFrame(o.msaInfo.meUrl,a,s),t.openIFrame(o.aadInfo.meUrl,a,s)):(s.idpflag=u,t.openIFrame(o.msaInfo.meUrl,a,s))):o.aadInfo&&o.aadInfo.meUrl&&(o.aadInfo.meTrustedOrigin=t.getDomainFromUrl(o.aadInfo.meUrl),s.idpflag=u,t.openIFrame(o.aadInfo.meUrl,a,s)):h(!1,'InvalidRpData')},w.dispose=function(){b||(b=!0)}}var f=window,i=f.MSA.MeControl,t=i.IFrameControl,r=i.Log,u='proxy';i.UserStateModel=e}(window.MejQuery);
window.scriptsLoaded['meidp.min.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['meidp.min.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
