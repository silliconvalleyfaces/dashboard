try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.prefetch.js'] = (new Date()).getTime();
Type.registerNamespace("_pt");_pt.g=function(n,t){this.f=Function.createDelegate(this,this.g);this.c=n;this.e=t;this.c.b(this.f)};_pt.g.prototype={c:null,e:null,d:null,b:function(n){this.d=n;return n},g:function(n){this.d&&this.d()},a:function(){this.c.v();this.e.a(this.c)}};_pt.h=function(){_pt.h.initializeBase(this,[1,"BootExp"])};_pt.d=function(n,t){this.i=Function.createDelegate(this,this.k);this.j=Function.createDelegate(this,this.l);this.f=t;this.e=n;this.a=!1;this.m()};_pt.d.prototype={f:null,e:null,b:0,c:null,a:!1,d:0,g:0,h:!1,m:function(){if(!this.a){this.b=0;this.d=_a.cB.a.length;this.a=!0;this.g=_a.M.b();this.h=!1;this.k()}},n:function(){this.b=0;this.c=null;this.a=!1},k:function(){if(this.a){var n=this.g+6e4<=_a.M.b();if(n||this.d===_a.cB.a.length&&!this.f.g()&&0!==this.b){_a.cB.b();this.e.d(_a.a.bj,"NetworkTaskMonitor",this.j);this.b=2;this.c&&this.c();this.n();return}else{this.d=_a.cB.a.length;this.b=1}this.e.a(_a.a.bn,"NetworkActivityMonitor",this.i,2e3)}},l:function(){for(var i="",e=0;e<_a.cB.a.length;e++){var l=_a.cB.a[e];try{var n;var o;var c,a;_a.A.l(l,c={val:n},a={val:o}),n=c.val,o=a.val;if(n.endsWith("service.svc")){var y=_a.A.g(o);i+="A:"+y.action+"|"}else{var v=n.indexOf(window.location.hostname);v>=0&&(n=n.substr(v+window.location.hostname.length));i+=n+"|"}}catch(w){_j.e.b(_a.a.bn,"url parse hit exception: {0}",l);i+="FailParsedUrl|"}}for(var u="",h=window.document.head.getElementsByTagName("script"),f=0;f<h.length;f++){var t=h[f];try{if(!_j.i.a(t.src)){var s=t.src.lastIndexOf("/");u+=(s>=0?t.src.substr(s):t.src)+"|"}}catch(p){_j.e.b(_a.a.bn,"script src parse hit exception: {0}",t.src);u+="FailParsedSrc|"}}var r=new _pt.h;r.a.xhr=i;r.a.src=u;r.a.to=this.h?1:0;_a.r.a.a(r)}};function PrefetchComponent(){}PrefetchComponent.$$cctor=function(){_a.u.a().a(PrefetchComponent)};PrefetchComponent.prototype={a:function(n,t,i){var o=this;n.b(_pt.d,function(){return new _pt.d(n.a(_j.u),n.a(_j.K))}).a();var s=this;n.b(_pt.f,function(){return new _pt.f(n.a(_pt.d))}).b(IPrefetchThrottler).a();var h=this;n.b(_pt.c,function(){var r=n.a(_j.o);var e=!r.a()||r.a()&&r.n();var u=["calendarsurface","calendarcompose","locationwell","calendarpeek"];var f=i.c().a.linkPrefetch;return f!=="0"&&i.b().a().fb().Enabled&&!_a.g.b&&!_a.g.k&&!t.a()&&!(i.r()&&n.a(_h.o).a())&&e&&i.g()?new _pt.c(n.a(_j.u),n.a(_j.j),n.a(_j.K),new _pt.i(n.a(_j.K),n.a(_j.bg),u,!1),i.b().a().H().Enabled?n.a(IPrefetchThrottler):null,u):null}).a();var u=!_a.g.b&&i.g()&&!i.c().f()&&!i.c().c()&&!(i.a()==="TouchWide"&&t.a());var r=i.b().a().bx().Enabled?0:8e3;r=i.a()==="TouchNarrow"?15e3:r;var e=this;n.b(_pt.a,function(){return u?new _pt.a(n.c(ICalendarPrefetcher),n.a(_j.u),n.a(_j.j),r,i.b().a().H().Enabled?n.a(IPrefetchThrottler):null):null}).a();var f=this;n.b(_pt.b,function(){return u?new _pt.b(n.a(_j.u),n.a(_j.j),i.b().a().H().Enabled?n.a(IPrefetchThrottler):null,r,n.a(_y.bF)):null}).a()},b:function(){return[new _j.w(_pt.c,2,9),new _j.w(_pt.a,2,9),new _j.w(_pt.b,2,9)]}};_pt.e=function(n){this.e=Function.createDelegate(this,this.f);this.d=n};_pt.e.prototype={c:null,d:null,b:function(n){this.c=n;return n},a:function(){this.d(this.e)},f:function(){this.c&&this.c()}};_pt.j=function(){};_pt.j.prototype={a:function(n,t){return new _pt.g(n,t)}};_pt.f=function(n){this.h=Function.createDelegate(this,this.f);this.i=Function.createDelegate(this,this.k);this.e=[];this.g=new _pt.j;this.d=!1;this.c=n};_pt.f.prototype={e:null,c:null,g:null,d:!1,b:function(){return this.g},a:function(n){n.b(this.i);Array.enqueue(this.e,n);this.f()},f:function(){this.c&&this.c.a&&this.c.b!==2?this.c.c=this.h:this.d||this.j()},k:function(){this.d=!1;this.f()},j:function(){var n=Array.dequeue(this.e);if(n){this.d=!0;n.a()}}};_pt.a=function(n,t,i,r,u){_pt.a.initializeBase(this,[t,i,_a.a.Z,u,r,"PrefetchCalendarData"]);this.g=n};_pt.a.prototype={g:null,j:function(){var n=this;this.g.a(function(n){n&&n.a()})}};_pt.k=function(n,t,i,r,u,f){this.h=Function.createDelegate(this,this.j);this.k=Function.createDelegate(this,this.m);this.i=Function.createDelegate(this,this.l);this.e=n;this.a=t;this.f=i;this.c=r;this.b=u;this.d=f;this.a.b(_j.ba,this.i)};_pt.k.prototype={b:0,a:null,e:null,f:null,c:null,d:null,l:function(n){if(this.c){var t=new _pt.e(this.k);this.c.a(t)}else this.e.a(this.f,this.d,this.h,this.b);this.a.c(_j.ba,this.i)},m:function(n){this.e.a(this.f,this.d,this.h,this.b);n()}};_pt.b=function(n,t,i,r,u){_pt.b.initializeBase(this,[n,t,_a.a.d,i,r,"PrefetchOptionsPermissions"]);this.g=u};_pt.b.prototype={g:null,j:function(){this.g.c(601)}};_pt.l=function(){};_pt.i=function(n,t,i,r){this.f=Function.createDelegate(this,this.e);this.b=[];this.k=n;this.j=t;this.h=i;this.i=r;this.g=document.getElementsByTagName("head")[0];var u=_a.l.a().J;this.d=u.a()===1&&u.b()>=11||u.a()===6||u.a()===2||u.a()===4};_pt.i.prototype={h:null,k:null,j:null,c:0,g:null,i:!1,d:!1,a:function(){this.o(this.h);if(this.d){this.m();return}while(this.c<1&&this.c<this.b.length)this.e()},m:function(){for(var n=0;n<this.b.length;n++)this.l(this.b[n])},e:function(){if(!(this.c>=this.b.length)){var n=this.b[this.c];this.c++;if(this.j.b(n))this.e();else{var t=this;_j.n.a().d(_a.a.eH,"LinkPF.SLP",function(){t.l(n)})}}},o:function(n){for(var u={},f=0,r=0;r<n.length;r++){var t=this.n(n[r]);if(t)for(var i=0;i<t.length;i++)if(!(t[i]in u)){this.b[f++]=t[i];u[t[i]]=!0}}},n:function(n){return this.k.f(n)},l:function(n){var t=document.createElement("link");t.rel=this.d?"prefetch":"stylesheet";t.href=n;if(!this.d){t.type="text/css";t.onerror=this.f;t.onload=this.f}this.g.appendChild(t);this.i&&this.e()}};_pt.c=function(n,t,i,r,u,f){this.f=Function.createDelegate(this,this.j);this.g=Function.createDelegate(this,this.l);this.d=Function.createDelegate(this,this.k);this.e=n;this.a=t;this.i=i;this.b=r;this.c=u;this.h=f;this.a.b(_j.ba,this.d)};_pt.c.prototype={a:null,e:null,i:null,b:null,h:null,c:null,k:function(n){this.e.d(_a.a.H,"PrefetchLink",this.g);this.a.c(_j.ba,this.d)},l:function(){if(this.c){var n=new _pt.e(this.f);this.c.a(n)}else this.b.a()},j:function(n){this.b.a();n()}};_pt.h.registerClass("_pt.h",_a.br);_pt.d.registerClass("_pt.d");PrefetchComponent.registerClass("PrefetchComponent",null,_a.ic,_j.ce);_pt.f.registerClass("_pt.f",null,IPrefetchThrottler);_pt.k.registerClass("_pt.k");_pt.a.registerClass("_pt.a",_pt.k);_pt.b.registerClass("_pt.b",_pt.k);_pt.c.registerClass("_pt.c");PrefetchComponent.$$cctor();
window.scriptsLoaded['microsoft.owa.prefetch.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.prefetch.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
