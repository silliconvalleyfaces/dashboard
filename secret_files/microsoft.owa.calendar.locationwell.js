try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.calendar.locationwell.js'] = (new Date()).getTime();
var IDurationChangedEvent=function(){};IDurationChangedEvent.registerInterface("IDurationChangedEvent");Type.registerNamespace("_lw");_lw.m=function(n,t,i){this.q=n;this.m=t;this.l=1;this.k=0;this.i=new _j.q;this.p=i};_lw.m.prototype={g:null,n:!1,i:null,h:!1,p:null,q:null,m:null,l:0,k:0,s:function(){return!!this.p&&this.p.a().fc().Enabled},f:function(){if(!this.s()){_j.e.a(_a.a.bu,"FindLocationFeedbackManager.StartOrResumeSession:AddEntityFeedback not enabled. Skip starting session.");return}try{if(this.h){var n=this.o("SessionResumed");this.j(n,!1);this.n=!1;_j.e.a(_a.a.bu,"Session resumed. Session id: {0}",this.g)}else{this.g=_a.I.c();var t=this.o("SessionStarted");this.j(t,!0);this.h=!0;_j.e.a(_a.a.bu,"Session started. Session id: {0}",this.g)}}catch(i){this.g="";_j.e.d(_a.a.bu,i,"Session failed to start or resume.")}},c:function(){try{if(this.h){var n=this.o("SessionEnded");this.j(n,!0);_j.e.a(_a.a.bu,"Session ended. Session id: {0}",this.g);this.g=""}}catch(t){_j.e.d(_a.a.bu,t,"Session failed to end. Session Id: {0}",this.g);this.g=""}},d:function(){if(this.h&&!this.n)try{var n=this.o("SessionPaused");this.j(n,!1);this.n=!0;_j.e.a(_a.a.bu,"Session paused. Session id: {0}",this.g)}catch(t){_j.e.d(_a.a.bu,t,"Session failed to pause. Session Id: {0}",this.g)}},a:function(n,t,i,r,u,f,e){if(this.h){_a.b.a(r,"locationIndex");_a.b.a(r,"location");try{var o={};var s={};s[i]=r;o.QueryString=t;o.EmailAddressAndPositionIndex=s;o.QueryStringLength=_j.i.a(t)?0:t.length;o.LocationSource=f;o.ScenarioName="LocationWell";o.RelevanceHints=Sys.Serialization.JavaScriptSerializer.serialize([e]);var c=Sys.Serialization.JavaScriptSerializer.serialize(Object.keys(s));var h=this.r(u,"EntityAdded",c,n,Sys.Serialization.JavaScriptSerializer.serialize(o));this.j(h,!1);_j.e.a(_a.a.bu,"Added Entity. Session id: {1}",this.g)}catch(l){_j.e.d(_a.a.bu,l,"Session failed to AddEntity. Session Id: {0}",this.g)}}},e:function(n,t){try{if(this.h){var r=Sys.Serialization.JavaScriptSerializer.serialize([n]);var i={};i.ScenarioName="LocationWell";i.RelevanceHints=Sys.Serialization.JavaScriptSerializer.serialize([t]);var f=Sys.Serialization.JavaScriptSerializer.serialize(i);var u=this.r("","EntityRemoved",r,0,f);this.j(u,!1);_j.e.a(_a.a.bu,"Removed entity {0}. Session id: {1}",r,this.g)}}catch(e){_j.e.d(_a.a.bu,e,"Session failed to RemoveEntity. Session Id: {0}",this.g)}},b:function(n,t,i,r){try{if(this.h){var u={};u.QueryString=_j.i.a(n)?"":n;u.QueryStringLength=_j.i.a(n)?0:n.length;u.ScenarioName="LocationWell";u.RelevanceHints=Sys.Serialization.JavaScriptSerializer.serialize(r);var o=Sys.Serialization.JavaScriptSerializer.serialize(u);var e=Sys.Serialization.JavaScriptSerializer.serialize(t);var f=this.r(i,"TransactionCompleted",e,0,o);this.j(f,!1);_j.e.a(_a.a.bu,"CompleteTransaction. Session id: {0}",this.g)}}catch(s){_j.e.d(_a.a.bu,s,"Session failed to CompleteTransaction. Session Id: {0}",this.g)}},j:function(n,t){this.i.c(n);if(t||this.i.d.length>=10){this.q.a(new _fp.u(this.i.j()));_j.e.a(_a.a.bu,"Submitted {0} entities.",this.i.d.length);this.i.f()}},o:function(n){if(_j.i.a(this.g))throw Error.invalidOperation("Session not started");var i={};i.ScenarioName="LocationWell";var u=Sys.Serialization.JavaScriptSerializer.serialize(i);var t;var r=(t=new _gg.bU,t.ClientEventTimeUtc=_a.c.get_utcNow().i(),t.ClientEventTimeLocal=_a.c.a().i(),t.ClientSessionId=this.g,t.ClientVersion=this.m,t.ClientId=this.l,t.EntrySequenceNumber=this.k,t.TransactionId="",t.EventType=n,t.TargetEntityList="",t.EntityAddSource=0,t.JsonPropertyBag=u,t.EntityType=4,t.ScenarioName="LocationWell",t);this.k++;return r},r:function(n,t,i,r,u){if(_j.i.a(this.g))throw Error.invalidOperation("Session not started");var f;var e=(f=new _gg.bU,f.ClientEventTimeUtc=_a.c.get_utcNow().i(),f.ClientEventTimeLocal=_a.c.a().i(),f.ClientSessionId=this.g,f.ClientVersion=this.m,f.ClientId=this.l,f.EntrySequenceNumber=this.k,f.TransactionId=n,f.EventType=t,f.TargetEntityList=i,f.EntityAddSource=r,f.JsonPropertyBag=u,f.EntityType=4,f.ScenarioName="LocationWell",f);this.k++;return e}};function CalendarLocationWellComponent(){}CalendarLocationWellComponent.$$cctor=function(){_a.u.a().a(CalendarLocationWellComponent)};CalendarLocationWellComponent.prototype={a:function(n,t,i){var u=this,r=this;n.b(ILocationWellViewModelFactory,function(){return new _lw.r(n.a(_a.B),n.d(IPlacePickerViewModelFactory),n.a(_y.a),n.a(_a.Z),n.a(_a.y),n.a(_a.cY),n.a(_j.j))}).a().c(function(t){t.h=n.a(_pe.e)})},b:function(){return[]}};_lw.l=function(n,t){this.d=n;this.c=t};_lw.l.prototype={d:null,c:0,b:function(){return this.d},a:function(){return this.c}};_lw.p=function(){};_lw.p.prototype={none:0,plainText:1,autosuggest:2,bingMap:3,addRoom:4};_lw.p.registerEnum("_lw.p",!1);_lw.c=function(n){_lw.c.initializeBase(this);n&&this.eq(n)};_lw.c.$$cctor=function(){_a.m.c(_lw.c,Object,function(n){return new _lw.c(n)})};_lw.c.prototype={d:function(){return this.ew(_lw.c.d)},a:function(){return this.ew(_lw.c.b)},c:function(){return this.ew(_lw.c.c)},b:function(){return this.ew(_lw.c.a)},e:function(){return this.d()?this.d():this.a()?this.a():this.c()?this.c():this.b()?this.b():""}};_lw.g=function(n){_lw.g.initializeBase(this);n&&this.eq(n)};_lw.g.$$cctor=function(){_a.m.c(_lw.g,Object,function(n){return new _lw.g(n)})};_lw.g.prototype={a:function(){return this.ew(_lw.g.a)},b:function(){return this.ew(_lw.g.b)}};_lw.b=function(n){_lw.b.initializeBase(this);if(n){this.eq(n);this.b()==="s:PostalAddress"&&this.f(new _lw.c(n))}};_lw.b.$$cctor=function(){_a.m.c(_lw.b,Object,function(n){return new _lw.b(n)})};_lw.b.prototype={b:function(){return this.ew(_lw.b.e)},e:function(){return this.ew(_lw.b.d)},a:function(){return this.ew(_lw.b.a)},f:function(n){this.ev(_lw.b.a,n);return n},c:function(){return this.ew(_lw.b.b)},d:function(){return this.ew(_lw.b.c)||this.a().e()}};_lw.j=function(n){this.d=n};_lw.j.b=function(n){var i=new _pc.a(null,!0,null);i.dp(4);var r;i.cF(n.d());var u;u=n.b()==="s:LocalBusiness"?"Business":n.b()==="s:PostalAddress"?"Home":"Other";if(n.b()!=="s:BusinessEntityType"){var t;r=(t=new _dg.e,t.z(u),t.i(n.a().d()),t.l(n.a().a()),t.o(n.a().c()),t.m(n.a().b()),t.n(null),t.h("LocationServices"),t.r(n.e()),t);if(n.c()){r.x(n.c().a());r.y(n.c().b())}i.bS(new(_pc.q.$$(_dg.e)));i.r().e(r,"0")}return i};_lw.j.prototype={a:null,b:0,d:null,c:null,f:function(){var n={};this.a.c()&&(n.ul=String.format("{0},{1},{2}",this.a.a,this.a.b,this.a.e));n.mr=this.b;n.types=this.d;n.q=this.c;n.appId="9D33F208D8235F41FFEDA38FBCB2DFD324BA0664";return n},e:function(n,t,i,r){this.c=n;this.a=i;this.b=t;var u={};u.type="GET";u.url="https://platform.bing.com/geo/autosuggest/V1/";u.data=this.f();u.dataType="jsonp";u.jsonp="cb";var f=this;u.success=function(n,t,i){var u=f.g(n);r(u)};var e=this;u.error=function(n,t,i){_j.e.b(_lw.j.a,"Bing Autosuggest Response timed out")};$.ajax(u)},g:function(n){var i=new _lw.h(n);var t=new _j.q;var r=this;i.a().n(function(n){t.c(_lw.j.b(n))});return t}};_lw.h=function(n){_lw.h.initializeBase(this);n&&this.eq(n)};_lw.h.$$cctor=function(){_lw.h.a.b(new _a.bv(_lw.b))};_lw.h.prototype={a:function(){return this.ew(_lw.h.a)}};_lw.n=function(n){_lw.n.initializeBase(this);this.f=n;this.c=new _gg.tc(this.L);this.c.shouldPrecedeOfflineSyncActions=this.i();this.c.id=n.Id};_lw.n.prototype={f:null,c:null,i:function(){return!1},K:function(n){n.bk(this.f,this.c,this.k,this.j)}};_lw.o=function(n){_lw.o.initializeBase(this,[n])};_lw.o.prototype={b:function(n){var i=_j.t.b(_bc.c,n.PersonaTypeString);var t=null;switch(i){case 4:var r=n.BusinessAddressesArray;t=n.BusinessAddressesArray[0].Value.LocationUri;break;case 1:t=_pc.m.prototype.b.call(this,n);break;case 3:t=n.EmailAddress.EmailAddress;break}return t}};_lw.e=function(){};_lw.e.g=function(){var n=new(_h.ds.$$(_lw.k))(_lw.e.b);return _h.c.b(n,_h.h.a(),function(n){return new _lw.k(n)})};_lw.e.e=function(n,t,i,r,u,f,e){return _lw.e.a(n,6,null,null,0,null)};_lw.e.d=function(n,t,i,r,u,f,e){return _lw.e.a(n,8,null,null,0,null)};_lw.e.c=function(n){return _lw.e.a(n,1,null,null,0,null)};_lw.e.f=function(n,t,i,r,u){return _lw.e.a(n,16,t,i,r,u)};_lw.e.a=function(n,t,i,r,u,f){var e=new _gg.bW;e.Query=n;e.Sources=t;e.RequiredAttendees=i;e.OptionalAttendees=r;if((t&16)==16&&f){e.MeetingTimeSlot=f;e.ResolveAvailability=!0}e.MaxResults=u?u:12;return new _lw.i(e)};_lw.k=function(n){_lw.k.initializeBase(this,[n,null,!0,null])};_lw.k.prototype={by:function(){return _a.a.eW},bK:function(n){var t=n;this.j=!0;return new _lw.o(t.N)},w:function(n){return _lw.e.c("")}};_lw.i=function(n,t){_lw.i.initializeBase(this);this.j=n;this.i=t?t:new _j.l};_lw.i.prototype={j:null,i:null,c:function(){return this.i},f:function(){return"Default"},K:function(n){var t=new _gg.uF(this.L);t.owsVersion="V2_66";n.bq(this.j,t,this.I,this.G)},cT:function(n,t,i){try{for(var f=new Array(n.length),u=0;u<n.length;u++){var r=new _pc.a(null,!0,null);r.eq(n[u]);if(r.d())r.df(2);else{r.df(1);r.cT(_h.i.f())}f[u]=r}this.i.f();f.length>0&&this.i.m(f);t()}catch(e){i(e)}}};_lw.q=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.cr=Function.createDelegate(this,this.du);this.cq=Function.createDelegate(this,this.cz);this.cu=Function.createDelegate(this,this.fP);this.ct=Function.createDelegate(this,this.er);this.cp=Function.createDelegate(this,this.cy);this.bD=Function.createDelegate(this,this.dC);this.bF=Function.createDelegate(this,this.gv);this.bE=Function.createDelegate(this,this.gt);this.cw=Function.createDelegate(this,this.ht);this.cv=Function.createDelegate(this,this.cG);this.cx=Function.createDelegate(this,this.cO);this.bI=new _a.by;_lw.q.initializeBase(this,[n,t,r,u,!1,v,c,e,null,i,null,0,null,null,"",null,""]);this.bf=_j.i.c(_lws.CalLWStrings.E,"");this.V=t;this.bJ=f;this.lx("");this.cn=new _j.g(this.cx,_a.a.U);this.bK=new _j.g(this.cv,_a.a.U);this.bL=o;this.c=!0;this.apcl("QueryString",this.cw);this.co=s;this.bk=h;this.bH=new _lw.j("address,business,place");this.N=l;this.by="";this.u="";this.bM=e;this.bz=new _j.l;this.bA=new _j.l;s&&this.be(_lws.CalLWStrings.D);this.e={};this.z=a;if(this.z){this.z.b(IAttendeesChangedEvent,this.bE);this.z.b(IDurationChangedEvent,this.bF)}};_lw.q.prototype={V:null,bJ:null,co:!1,bK:null,cn:null,T:!1,bf:null,bi:null,bC:!0,c:!1,bk:!1,bh:null,U:null,bL:null,N:null,bM:null,e:null,bH:null,bA:null,bz:null,z:null,bg:!1,bl:!1,cJ:function(n){this.bl!==n&&(this.bl=n);return n},jt:function(){return!1},hQ:function(){return"https://go.microsoft.com/fwlink/?LinkId=260597"},hS:function(){return!this.et&&!this.V.bu.x.length},jo:function(){return this.T},cl:function(n){if(this.T!==n){this.T=n;this.T&&this.dT(_lws.CalLWStrings.F);this.eu("IsLearnMoreButtonHighlighted")}return n},eg:function(){return this.bk&&!!this.dg&&_fp.c.prototype.eg.call(this)},gS:function(n){_fp.c.prototype.gS.call(this,n);return n},by:null,bG:null,u:null,jr:function(){return this.bK},js:function(){return this.bC},cI:function(n){if(this.bC!==n){this.bC=n;this.eu("ShowUseThisLocationButton")}return n},jv:function(){return this.bf},hu:function(n){if(this.bf!==n){this.bf=n;this.c&&this.dT(this.bf);this.eu("UseThisLocationString")}return n},ju:function(){return this.cn},jq:function(){return this.c},bB:function(n){if(this.c!==n){this.c=n;this.c&&this.dT(this.bf);this.eu("IsUseThisLocationButtonHighlighted")}return n},hR:function(){return _lws.CalLWStrings.B},ee:function(){return this.dm.a().M().Enabled},bj:function(){return!!this.dm&&this.dm.a().eY().Enabled&&this.dm.a().bS().Enabled&&this.bl},eo:function(){return this.bj()&&(!this.dg||this.dg.trim()==="")},cP:function(n){n&&!this.fQ(n)&&this.V.bu.a(n)},gn:function(){this.dB&&this.bj()&&_j.i.a(this.dg)&&this.ff()},hm:function(){if(this.dB){this.bg=!0;if((!this.dg||this.dg.trim()==="")&&this.bj()){_j.e.a(_a.a.U,"PerformSearch with no query");this.ff()}else _fp.c.prototype.hm.call(this)}},fL:function(){if(this.eW()){_j.e.b(_a.a.U,"OnBlur set last query to null."+this.eM);this.bi=null;this.gP()}this.bg=!1;_fp.c.prototype.fL.call(this)},hN:function(n){var i;var u,r;if(n&&(r=this.cL(n,u={val:i}),i=u.val,r)){this.V.bu.p(i);var t=new _gg.hX;n.d()&&n.d().Id&&!n.d().Id.startsWith("CLPID:")?t.EntityId=n.d().Id:t.Id=n.gz();var f=new _lw.n(t);this.dO.a(f)}},fQ:function(n){var r;var i,t;return t=this.cL(n,i={val:r}),r=i.val,t},gu:function(){if(this.bj()){this.bi=null;this.dg&&this.dg!==""||this.ff()}},cF:function(n){var i=this.dh.l(this.K());var t=this.dh.x[i];n.val=t.bR.gv();return this.cD(t)},cD:function(n){var t="";t=n.bR.gs()&&n.bR.gs()!==undefined?n.bR.gs():n.bR.Q()&&n.bR.Q().bk.LocationUri?n.bR.Q().bk.LocationUri:n.Y();return t},ih:function(){this.cl(!1);this.dE(!1);this.dD(-1);this.dw(-1);this.bB(!0)},cL:function(n,t){t.val=-1;if(_pc.a.isInstanceOfType(n))for(var u=n.gz(),f=n.c(),i=0;i<this.V.bu.x.length;i++){var r=this.V.bu.x[i];if(u&&r.gz()===u||r.c()===f){t.val=i;return!0}}return!1},ef:function(n){var t=new _pe.h(n,_pe.c.e,!1,this.fe,this.fz,8,0,null,!1);t.g(1,_cc.O.b,"");return t},gL:function(){this.L(!1);this.dw(-1);this.dD(-1);if(this.eW()){this.bi=null;this.gP()}this.bj()&&(this.bg=!1);if(this.N&&this.K()&&this.K().a()&&!_j.i.a(this.K().a().c())){var r="Cache";var u=2;if(this.U&&this.U.g(this.K())){r="Bing";u=8}var e=this.dh.l(this.K());var n;var t,i;var f=(i=this.cF(t={val:n}),n=t.val,i);this.N.a(u,this.by,f,e,this.u,r,n)}},ir:function(){return!1},hJ:function(){if(this.c)return!0;if(!this.dh.x.length&&this.dI){this.dE(!1);this.bB(!0);return!0}if(!this.eS){this.dD(-1);this.dw(-1);this.bB(!0);return!0}if(this.T){this.cl(!1);this.dE(!0);return!0}return _fp.c.prototype.hJ.call(this)},hI:function(){if(this.c){this.bB(!1);if(!this.dh.x.length){this.dE(!0);return!0}this.dD(0);this.dw(0);return!0}if(this.dI&&this.hS()){this.dE(!1);this.cl(!0);return!0}return this.T?!0:_fp.c.prototype.hI.call(this)},eW:function(){return!!this.dm&&this.dm.a().bS().Enabled&&this.bl},ge:function(){this.c?this.cO():this.T?this.cG():_fp.c.prototype.ge.call(this)},ff:function(){if(this.dg!==this.bi&&(this.eL||this.eo())){this.bi=this.dg;this.bg=!0;if(this.e&&this.dg in this.e){for(var i=this.e[this.dg],r=new _j.q,n=0;n<=i.x.length;n++)r.c(i.x[n]);var u=this.cN(r.d);this.cH(u)}else if(this.dg.length<this.ib){var e=this.cC(this.bz);var f=this.cC(this.bA);var t=_lw.e.f(this.dg,f,e,this.dJ,this.bG);t.b(this.bD);this.eh(!0);this.dO.a(t)}}},hv:function(n){if(!n){this.fu=null;return}this.fu=new _j.q;for(var t=0,i=n.d.length;t<i;t++)this.fu.c(this.ef(n.d[t]))},is:function(){_fp.c.prototype.is.call(this);this.cI(!1);this.bk=!1;this.ey("ShowLearnMoreLink","ShowInformationButton")},jx:function(){this.cI(!0);this.bk=!0;this.ey("ShowLearnMoreLink","ShowInformationButton")},cC:function(n){if(n){var t=new Array(0);var i=this;n.n(function(n){var i=n;i.bk.Mailbox&&!_j.i.b(i.bk.Mailbox.EmailAddress)&&t.push(n.bk.Mailbox.EmailAddress)});return t}return null},ii:function(n,t,i){this.iq(this.dJ,this.cp,t)},ex:function(){if(this.z){this.z.c(IAttendeesChangedEvent,this.bE);this.z.c(IDurationChangedEvent,this.bF)}_fp.c.prototype.ex.call(this)},iT:function(n,t){this.bL.b(this.ct,this.cu);this.eh(!0);this.bH.e(this.dg,n,this.bI.a,t)},dC:function(n){n.m(this.bD);var r=n;var i=r.N;r.Q&&(this.u=r.Q.activityId);this.eh(!1);var f=new _j.q;if(i&&i.length>0){for(var e=new _j.q,u=i,s=u.length,t=0;t<s;++t){var o=u[t];e.c(new _pc.a(o,!0,null))}f=this.cN(e.d);this.cz(n)}this.cH(f)},cH:function(n){this.cy(n);this.fj();this.fV();this.L(this.bg)},cN:function(n){var u=new _j.q;if(n&&n.length>0)for(var r=n,e=r.length,t=0;t<e;++t){var i=r[t];if(i&&i!==undefined){var f=this.bM.j(i,8,!1,0,5,!1);u.c(f)}}return u},cz:function(n){n.m(this.cq);var t=n;n.J||!_j.i.b(this.dg)&&this.e&&t.i.x.length>0&&(this.e[this.dg]=t.i)},du:function(n){for(var c=new _j.q,e=new _j.q,f=new _j.q,u=this.dJ-this.bh.d.length,h=this.bh.d,a=h.length,r=0;r<a;++r){var t=h[r];t.bR.Q()&&t.bR.Q().bk.LocationUri&&c.c(t.bR.Q().bk.LocationUri);e.c(this.cD(t));f.c(t.bR.gv())}this.U=new _j.q;for(var s=n.d,v=s.length,i=0;i<v;++i){var o=s[i];if(!u)break;if(u>0&&!this.bh.g(o)&&!c.g(o.r().c(0).bk.LocationUri)){var l=this.ef(o);this.U.c(l);e.c(l.bR.r().c(0).bk.LocationUri);f.c("BingAutoSuggest");u--}}this.dW();this.dh.m(this.bh.d);this.dh.m(this.U.d);this.N&&this.N.b(this.dg,e.j(),_j.i.a(this.u)?_a.I.c():this.u,f.j());this.eh(!1);this.fV()},cy:function(n){this.U=new _j.q;if(this.ee()&&n.d.length<this.dJ&&this.dg){this.bh=n;this.iT(this.dJ,this.cr)}else{this.dW();this.dh.m(n.d);if(this.N){for(var i=new _j.q,f=new _j.q,u=n.d,e=u.length,r=0;r<e;++r){var t=u[r];t.bR.Q()&&t.bR.Q().bk.LocationUri?i.c(t.bR.Q().bk.LocationUri):i.c(t.bR.c());f.c(t.bR.gv())}this.N.b(this.dg,i.j(),_j.i.a(this.u)?_a.I.c():this.u,f.j())}}},er:function(n){this.bI=n},fP:function(n){},cG:function(){this.bJ.a(this.hQ(),null,null,!1)},gt:function(n){this.cA();n.b()?this.bz=n.a():this.bA=n.a()},gv:function(n){_cc.a.D()&&this.cA()},cA:function(){if(this.e)for(var t=Object.keys(this.e),r=t.length,n=0;n<r;++n){var i=t[n];delete this.e[i]}},cO:function(){this.L(!1)},ht:function(n,t){this.hu(_j.i.c(_lws.CalLWStrings.E,this.dg));this.ey("ShowLearnMoreLink","ShowInformationButton")}};_lw.f=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.X=Function.createDelegate(this,this.br);this.Y=Function.createDelegate(this,this.bs);this.Z=Function.createDelegate(this,this.bt);this.bb=Function.createDelegate(this,this.bv);this.V=Function.createDelegate(this,this.bq);this.T=Function.createDelegate(this,this.bo);this.F=Function.createDelegate(this,this.bn);this.U=Function.createDelegate(this,this.bp);this.ba=Function.createDelegate(this,this.bu);this.S=Function.createDelegate(this,this.bk);_lw.f.initializeBase(this);_a.b.b(u,"owaShell");_a.b.b(s,"clientSettings");this.x=new _j.g(this.S,_lw.f.a);this.C=new _j.g(this.ba,_lw.f.a);this.R=[new _fm.d(_lws.CalLWStrings.G,null,this.x)];this.N=i;this.O=t;this.r=r;this.s=u;this.v=f;this.D=e;this.K=o;this.I=s;this.M=h;this.J=a;this.t=c;this.E=l;this.n=v;this.p=y;this.bj();this.bz();this.bm(n);this.apcl("Placeholder",this.U);this.p&&this.p.b(IDurationChangedEvent,this.F)};_lw.f.b=function(n){return!n.Q()||n.Q().b()!=="Resource"};_lw.f.prototype={K:null,I:null,t:!1,x:null,C:null,R:null,O:null,N:null,D:null,s:null,w:null,E:!1,m:null,k:null,j:null,M:null,r:null,l:null,v:null,q:!1,z:null,o:0,n:null,J:null,p:null,A:!1,bi:function(n){this.ez("OnPlacePickerClosed",n)},bw:function(n){if(n!==this.z){this.z=n;this.eu("Placeholder")}return n},P:function(n){if(this.m!==n){this.m=n;this.eu("PersonaViewModel")}return n},a:function(){return this.k},be:function(n){if(this.k!==n&&!this.k.bC(n)){this.k=n;this.eu("Location")}return n},bx:function(n){if(this.A!==n){this.A=n;this.j&&this.j.cJ(this.A)}return n},d:function(){return this.q},bd:function(n){if(this.q!==n){this.q=n;this.eu("IsLocationDirty")}return n},y:function(){return _g.a.a().bk.PolicySettings.PlacesEnabled},bI:function(){return this.v},W:function(n){this.v=n;return n},L:function(){var n=!1;this.r&&this.r.a()&&(n=this.r.a().M().Enabled);return n},bu:function(){if(!this.y())throw Error.invalidOperation("Places must be enabled to use the place picker");if(!this.m&&!_j.i.b(this.j.dg)){this.j.L(!1);this.j.i(!1);var n=this;this.bc(function(t){t.b(n.j.dg,null);n.v.d(t)})}},h:function(n){this.l?n(this.l):this.bc(n)},G:function(n){_j.i.a(n.Q().bk.LocationUri)||this.bl(n);this.be(n.fQ());this.Q(n)},bl:function(n){if(this.L()&&!_j.i.a(n.Q().bk.LocationUri)&&(!n.Q().bk.Latitude||!n.Q().bk.Longitude)){var t;var r=(t=new _gg.bW,t.Id=n.Q().bk.LocationUri,t.MaxResults=1,t.Sources=8,t);var i=new _lw.i(r);i.b(this.T);this.j.dO.a(i)}},bo:function(n){var i=n;if(!i.J&&i.i.x.length===1){var t=i.i.x[0];if(t.Q().bk.Latitude&&t.Q().bk.Longitude){t.cF(this.k.bk.DisplayName);this.G(t)}}},c:function(){if(this.q){if(this.m){if(this.k&&!this.j.dB){this.k.l(this.j.dg);this.eu("Location")}}else{if(this.k&&this.k.a().b()==="Resource"&&this.k.bk.DisplayName===this.j.dg)return;this.bg()}this.bd(!1)}},g:function(n,t){var i=n.r();this.b(i)},b:function(n){if(!this.k.bC(n)){var t=n||_dg.d.b();this.k=t.i();this.Q(_pc.a.f(this.k));this.j.cE(!1);this.eu("Location")}},f:function(n){if(n&&n.bk.DisplayName){n.a().b()==="Resource"&&(this.o=4);if(this.o){this.w=_a.d.b(_lw.f.a,"LocationSelection",!1);this.w.j=String.format("Location sourced from {0} and selected from {1}. The annotation was {2}used",n.a().b(),_j.t.d(_lw.p,this.o),_j.i.a(n.bk.Annotation)?"not ":"");_a.d.a(this.w);this.w=null}(n.h()||this.o===1)&&this.k.a().b()!=="Resource"&&this.j.cP(_pc.a.f(n))}},i:function(n,t){if(this.j&&_cc.a.D()){var i;this.j.bG=(i=new _gg.dj,i.StartTime=n.s().E(),i.DurationInMinutes=t,i)}},bj:function(){var n;n=this.L()?_lw.e.d:_lw.e.e;this.j=new _lw.q(n,_lw.e.g(),this.r,this.s,this.I,this.K,this.D,this.M,this.t,this.E,this.J,this.n,this.p,null);this.j.cJ(this.A);this.j.cK("PlaceDetailedView");if(this.y()){this.j.cm();this.j.F(!0)}else this.j.F(!1);this.j.o(!1);this.j.M(!1);this.j.G(0);this.j.cM(100)},ex:function(){this.p&&this.p.c(IDurationChangedEvent,this.F);if(this.j){this.j.dispose();this.j=null}_a.jb.prototype.ex.call(this)},bn:function(n){this.m&&this.m.fA("Unknown");this.i(n.b(),n.a())},bc:function(n){if(this.l){n(this.l);return}var t=this;this.N.a(function(i){t.l=i.a(9,t.O);t.l.g(t.V);t.s.a()!=="Mouse"||t.s.c()||t.l.e(function(){t.l.b(t.l.c(),t.l.a())});t.l.f(t.bb);t.eu("PlacePickerViewModel");n(t.l)})},bv:function(){this.eC("OnPlacePickerClosed")},bz:function(){this.j.jM(this.x);this.j.kl(this.Z);this.j.S(this.Y);this.j.apcl("QueryString",this.X);if(this.y()&&this.E){this.j.jG(this.C);this.j.jF(this.C)}else this.j.jG(null)},br:function(n,t){this.bd(!0)},bf:function(n){this.j.j(n);this.q=!1},bm:function(n){this.k=n?n.i():_dg.d.b();this.k.e(this.k.bk.DisplayName||"");this.Q(_pc.a.f(this.k))},Q:function(n){this.j.by=this.j.dg;n.b()!==4||n.bc()?this.k.h()||this.k.a().b()==="Resource"?this.by(n):this.bh(this.k.g()):this.bh(this.k.g())},bh:function(n){this.j.F(!1);this.bf(n);this.P(null);this.j.F(this.y())},by:function(n){this.j.be(_lws.CalLWStrings.A);this.j.F(!1);this.bf(this.k.bk.Annotation||"");this.q=!1;this.P(_cc.O.a(n,this.D,this.s,2,this.R,!0))},bp:function(n,t){this.j.be(this.t?this.z:"")},bk:function(){this.j.be(this.t?this.z:"");if(this.j.K()&&this.n){var n;var i,t;var r=(t=this.j.cF(i={val:n}),n=i.val,t);this.n.e(r,n)}this.P(null);this.bg();this.j.cE(!1);this.j.gu()},bt:function(n,t){if(this.j.dH){this.n&&this.n.f();return}if(this.n){this.j.ek||_j.i.a(this.j.dg)||this.n.a(4,this.j.dg,this.j.dg,-1,this.j.u,"Explicitly Typing","");this.n.d()}this.c()},bg:function(){this.j.F(this.y());this.be(_dg.d.a(this.j.dg));this.o=1},bs:function(n,t){if(this.j.K()){this.o=2;this.G(this.j.K().a())}},bq:function(n){if(n){this.o=3;this.G(n)}}};_lw.r=function(n,t,i,r,u,f,e){this.e=n;this.i=t;this.g=i;this.c=r;this.b=u;this.f=f;this.d=e};_lw.r.prototype={i:null,g:null,c:null,b:null,f:null,e:null,h:null,d:null,a:function(n,t,i,r,u,f,e){var o=null;f&&(o=_lw.f.b);return new _lw.f(n,t,this.i,this.e,this.g,i,this.h,this.c,this.b,this.f,r,u,o,e,this.d)}};_lw.d=function(n,t){this.q=Function.createDelegate(this,this.bb);this.v=Function.createDelegate(this,this.bg);this.w=Function.createDelegate(this,this.bk);this.n=Function.createDelegate(this,this.bp);this.o=Function.createDelegate(this,this.br);this.p=Function.createDelegate(this,this.s);this.t=_lws.CalLWStrings.D;_lw.d.initializeBase(this,[n]);this.y("LocationWellView");this.a=t;this.e=this.a.a()==="Mouse";this.r=this.a.a()==="Mouse"?2:0};_lw.d.prototype={u:!1,r:0,c:null,i:null,d:null,l:null,h:null,f:null,e:!1,m:!1,k:!1,a:null,j:null,bd:function(n){n=n||"";if(this.t!==n){this.t=n;this.W().bw(n);this.bs("Placeholder")}return n},bJ:function(n){if(this.m!==n){this.m=n;this.bs("UseExperimentalFeatures")}return n},g:!1,bC:function(n){if(this.e!==n){this.e=n;this.bs("SingleLineMode")}return n},x:function(){return!!this.W()&&this.W().L()},b:function(){return this.g||this.x()},bB:function(n){if(this.k!==n){this.k=n;this.bs("ExpandedPortraitLayout")}return n},cC:function(){return this.j},S:function(n){if(this.j!==n){this.j=n;this.bs("AriaLabelledBy")}return n},s:function(){var t=this.W();if((this.e||this.b())&&this.C&&t)if(t.m){this.c.J(!1);var i=this.cH().outerWidth(!0);if(this.b())this.h.J(!0);else{this.c.z.style.width=(_j.k.l(this.i.z,!1)+10).toString()+"px";this.d.z.style.display="";_j.k.a(this.d.z,"display","table-cell");var n=_j.k.l(this.l.z,!1);this.d.z.style.width=n.toString()+"px";this.f.z.style.display="none";var u=_j.k.l(this.c.z,!1);var r=i-u-n;r<258&&(this.c.z.style.width=((i-n)/2).toString()+"px");this.f.z.style.display=""}}else{this.c.J(!0);this.d.z.style.display="none";this.b()&&this.h.J(!1)}},Z:function(){_j.h.prototype.Z.call(this);var n=this.W();n&&n.bx(this.m)},I:function(){_j.c.prototype.I.call(this);this.C?this.be():this.bu()},G:function(){_j.c.prototype.G.call(this);if(!_g.a.a().bk.PolicySettings.PlacesEnabled){this.a.a()==="Mouse"&&(this.d.z.style.display="none");return}this.u=this.b()||this.a.a()!=="Mouse";if(this.b()||this.e&&this.a.a()==="Mouse"){this.s();this.a.h(this.p)}if(this.W()&&(this.b()||this.a.l())){var n=this;_j.n.a().d(this.F(),"OnActivate",function(){n.W().apcl("PlacePickerViewModel",n.o);n.i.apcl("DataContext",n.n)})}this.a.a()==="TouchWide"&&this.X.apcl("IsInExpandedComposeLayoutInPortraitOrientation",this.w);_j.k.b(this.f.z,"keydown",this.v)},P:function(){if(this.x()){this.bb();return!0}return _j.c.prototype.P.call(this)},M:function(){if(this.W()&&(this.b()||this.a.l())){this.W().rpcl("PlacePickerViewModel",this.o);this.W().rpcl("PersonaViewModel",this.n)}(this.b()||this.e&&this.a.a()==="Mouse")&&this.a.j(this.p);_j.c.prototype.M.call(this)},bt:function(){this.Y()&&this.M();_j.c.prototype.bt.call(this)},br:function(n,t){this.W().bi(this.q)},bp:function(n,t){(this.b()||this.a.a()==="Mouse")&&this.s();_j.n.a().a(_a.a.U,"RestoreFocus",this.q,0)},bg:function(n){(n.a()===13||n.a()===27)&&n.c()},bb:function(){this.W()&&this.W().m?this.c.P():this.f.P()},bk:function(n,t){this.bB(this.cH().width()<600)},be:function(){this.h=this.C.a("findViewWrapper");this.c=this.C.a("resolvedLocation");this.i=this.C.a("personaView");this.d=this.C.a("separatorCell");this.l=this.C.a("separatorText");this.f=this.C.a("findPlaceView")},bu:function(){this.c=null;this.h=null;this.i=null;this.d=null;this.l=null;this.f=null}};_lw.a=function(){};_lw.a.$$cctor=function(){_lw.a._I()};_lw.a.n=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span class='_lw_2 ms-bcl-nta ms-bcl-nsa-h'> <span class='_lw_4 ms-fwt-r ms-bg-color-neutralLight'> <span class='_lw_6 ms-fwt-r'></span> <button type='button' class='_lw_b ms-bg-color-neutralLight'></button>  </span>  <span class='_lw_7'> <span class='_lw_8 ms-font-s'></span> </span> <span class='_lw_9'> <div class='_lw_a ms-font-s'></div> </span> </span> </div><div> <span class='_lw_e'></span> </div><div> <span class='_lw_h'></span> </div>";_j.h.a().appendChild(n);return n};_lw.a.y=function(n){return n.e};_lw.a.t=function(n){return n.t};_lw.a.w=function(n){return n.k};_lw.a.b=function(n){return n.b()};_lw.a.i=function(n){return n.m};_lw.a.h=function(n){return n.x};_lw.a.C=function(n){return n.Z()};_lw.a.x=function(n){return n.u};_lw.a.s=function(n){return n.j};_lw.a.u=function(n){return n.r};_lw.a.v=function(n){return n.cC()};_lw.a.r=function(n){return n.co};_lw.a.k=function(n){return n.cE()};_lw.a.g=function(n,t){n.J(t)};_lw.a.f=function(n,t){n.k=t};_lw.a.l=function(n,t){n.ba(t)};_lw.a.q=function(n,t){n.bn(t)};_lw.a.o=function(n,t){n.T(t)};_lw.a.p=function(n,t){n.l(t)};_lw.a.z=function(n,t){n.c(t)};_lw.a.B=function(n,t){n.o(t)};_lw.a.A=function(n,t){n.S(t)};_lw.a.m=function(){_lw.a.e||(_lw.a.e=new _fc.m);return _lw.a.e};_lw.a.j=function(){_lw.a.d||(_lw.a.d=new _fc.k);return _lw.a.d};_lw.a._I=function(){var t="LocationWellView";new _j.d(t,function(){_lw.a.a[t]===undefined&&(_lw.a.a[t]=[[[-1,5,["SingleLineMode"],[_lw.a.y],null,"_lw_c",null,null,1,null,null,null],[-1,5,["UseUnifiedForms"],[_lw.a.t],null,"_lw_3",null,null,0,null,null,null],[-1,5,["ExpandedPortraitLayout"],[_lw.a.w],null,"_lw_d",null,null,1,null,null,null],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"_lw_5",null,null,1,null,null,null]],[[-1,0,["PersonaViewModel"],[_lw.a.i],null,"IsHidden",null,_lw.a.g,1,_lw.a.m(),null,!0],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"_lw_5",null,null,1,null,null,null],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"ms-font-color-themePrimary",null,null,1,null,null,null],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"ms-bg-color-white",null,null,1,null,null,null]],[[-1,0,["PersonaViewModel"],[_lw.a.i],null,"DataContext",null,_lw.a.l,1,null,null,null],[0,5,["UseSimpleLayout"],[_lw.a.b],null,"_lw_5:ms-font-color-neutralSecondary-hover",null,null,1,null,null,null],[0,5,["UseSimpleLayout"],[_lw.a.b],null,"ms-font-color-themeSecondary-hover:ms-font-color-neutralSecondary-hover",null,null,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_lw.a.q,0,null,null,null,_lws.CalLWStrings.C],[-1,4,null,null,null,"ImageId",null,_lw.a.p,0,null,null,null,_n.b.a()],[-1,1,["ShowDeleteButton"],[_lw.a.x],null,"IsHidden",null,_lw.a.g,1,_lw.a.j(),null,!0],[-1,0,["DeletePlace"],[_lw.a.h],null,"ClickCommand",null,_lw.a.o,1,null,null,null],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"_lw_5",null,null,1,null,null,null],[-1,5,["UseSimpleLayout"],[_lw.a.b],null,"ms-bg-color-white",null,null,1,null,null,null]],[[-1,1,["UseSimpleLayout"],[_lw.a.b],null,"IsHidden",null,_lw.a.g,1,_lw.a.j(),null,!0]],[[-1,4,null,null,null,"FormatString",null,_lw.a.z,0,null,null,null,_wss.i.a]],null,[[-1,1,["AnchorSpacing"],[_lw.a.u],null,"TypedownAnchorSpacing",null,_lw.a.B,1,null,null,0],[-1,1,["AriaLabelledBy"],[_lw.a.v],null,"AriaLabelledBy",null,_lw.a.A,1,null,null,null],[-1,0,["FindPlaceViewModel"],[_lw.a.s],null,"DataContext",null,_lw.a.l,1,null,null,null],[0,5,["UseUnifiedForms"],[_lw.a.r],null,"_lw_3",null,null,0,null,null,null]]]);var n=_lw.a.c.childNodes[0].cloneNode(!0);var i=new _fp.f(_j.a.a(n,[0,2,0]),_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.j));i.l(!0);i.k(!0);var l=new _fc.x(_j.a.a(n,[0,2]));var c=new _b.W(_j.a.a(n,[0,1,0]));var v=new _fc.x(_j.a.a(n,[0,1]));var r=new _fc.b(_j.a.a(n,[0,0,1]));var a=new _fc.g;var f=new _fc.c;f.U(_j.f.a(["DeletePlace"],[_lw.a.h],null,"Command",null,_lw.a.f,1));f.i("ENTER");a.a([f]);r.D([a]);var s=new _pe.d(_j.a.a(n,[0,0,0]),_j.b.Instance.a(_a.q));s.y("PersonaView.LocationBasicDetailsPopup");var u=new _fc.x(_j.a.a(n,[0,0]));var h=new _fc.g;var o=new _fc.c;o.U(_j.f.a(["DeletePlace"],[_lw.a.h],null,"Command",null,_lw.a.f,1));o.i("DELETE");var e=new _fc.c;e.U(_j.f.a(["PersonaViewModel","EnterKeyCommand"],[_lw.a.i,_lw.a.C],null,"Command",null,_lw.a.f,1));e.i("ENTER");h.a([o,e]);u.D([h]);var y=new _j.h(n.children[0]);return new _j.a(n,[y,u,s,r,v,c,l,i]).l({resolvedLocation:u,personaView:s,deleteButton:r,separatorCell:v,separatorText:c,findViewWrapper:l,findPlaceView:i}).b(i)},"",_lw.f,_lw.d,function(n){return new _lw.d(n,_j.b.Instance.a(_y.a))},!1,!1,!1,0,_lw.a.a);var n="PlaceDetailedView";new _j.d(n,function(){_lw.a.a[n]===undefined&&(_lw.a.a[n]=[[[-1,5,["ShowSelectedOrIsTouched"],[_lw.a.k],null,"ms-bg-color-themeLight",null,null,1,null,null,null]]]);var i=_lw.a.c.childNodes[1].cloneNode(!0);var t=new _pe.d(i.children[0],_j.b.Instance.a(_a.q));t.j("_lw_f ms-font-weight-semilight ms-font-color-neutralPrimary bidi");t.bJ("_lw_g ms-font-weight-semilight ms-font-color-neutralSecondary bidi");t.y("PersonaView.DisplayPictureTwoLinesDetailsCustomStyle");return new _j.a(i,[t])},"",_pe.h,_fce.e,function(n){return new _fce.e(n)},!1,!1,!1,0,_lw.a.a)};CalendarLocationWellComponent.registerClass("CalendarLocationWellComponent",null,_a.ic,_j.ce);_lw.c.registerClass("_lw.c",_a.dT);_lw.g.registerClass("_lw.g",_a.dT);_lw.b.registerClass("_lw.b",_a.dT);_lw.h.registerClass("_lw.h",_a.dT);_lw.n.registerClass("_lw.n",_h.fb);_lw.o.registerClass("_lw.o",_pc.m);_lw.k.registerClass("_lw.k",_fp.m);_lw.i.registerClass("_lw.i",_h.fa,_pc.v,_pc.F);_lw.q.registerClass("_lw.q",_fp.c);_lw.f.registerClass("_lw.f",_a.bB,_bc.r,_a.iP,_j.bp,Sys.IDisposable,ILocationWellViewModel);_lw.d.registerClass("_lw.d",_j.c);CalendarLocationWellComponent.$$cctor();_lw.c.d=new _a.e("s:streetAddress",String,_lw.c);_lw.c.b=new _a.e("s:addressLocality",String,_lw.c);_lw.c.e=new _a.e("b:addressSubregion",String,_lw.c);_lw.c.c=new _a.e("s:addressRegion",String,_lw.c);_lw.c.a=new _a.e("s:addressCountry",String,_lw.c);_lw.c.$$cctor();_lw.g.a=new _a.e("s:latitude",Number,_lw.g);_lw.g.b=new _a.e("s:longitude",Number,_lw.g);_lw.g.$$cctor();_lw.b.e=new _a.e("@type",String,_lw.b);_lw.b.d=new _a.e("s:url",String,_lw.b);_lw.b.c=new _a.e("s:name",String,_lw.b);_lw.b.b=new _a.e("s:geo",_lw.g,_lw.b);_lw.b.a=new _a.e("s:address",_lw.c,_lw.b);_lw.b.$$cctor();_lw.j.a=_a.a.ca;_lw.h.a=new _a.e("@graph",_j.l,_lw.h);_lw.h.$$cctor();_lw.e.b=new _g.l("PlaceItemQueryTable");_lw.f.a=_a.a.U;_lw.a.c=_lw.a.n();_lw.a.e=null;_lw.a.d=null;_lw.a.a={};_lw.a.$$cctor();
window.scriptsLoaded['microsoft.owa.calendar.locationwell.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.calendar.locationwell.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
