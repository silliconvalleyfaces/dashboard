try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.mail.common.js'] = (new Date()).getTime();
Type.registerNamespace("_mco");_mco.k=function(){};_mco.k.a=function(n){for(var u=n.querySelectorAll("span[id^='OWAHT']"),r=0;r<u.length;r++){var t=u[r];var i=document.createElement("a");i.setAttribute("href",t.textContent);i.setAttribute("ID",t.id);i.setAttribute("class","hashtagAnchor");i.protocol="http:";t.parentNode.replaceChild(i,t);t.setAttribute("class","hashtag");i.appendChild(t)}};_mco.d=function(){};_mco.d.a=function(n,t){var r;if(n&&n.b()>0){var i;if(t&&t.Mailbox)i=t.Mailbox;else{var u=_g.a.a().c();i=new _g.f;i.EmailAddress=u.bk.UserEmailAddress;i.Name=u.bk.UserDisplayName}var f=_mco.d.b(i);r=new Array(0);n.o(function(n){var t=n;t.CreatedBy=f;Array.add(r,t)})}else r=new Array(0);return r};_mco.d.b=function(n){var t;return t=new _dg.bq,t.PrimaryEmailAddress=n.EmailAddress,t.Name=n.Name,t.EmailAddress=n.EmailAddress,t.RoutingType=n.RoutingType,t.MailboxType=n.MailboxType,t.ItemId=n.ItemId,t.SipUri=n.SipUri,t.Submitted=n.Submitted,t.OriginalDisplayName=n.OriginalDisplayName,t.EmailAddressIndex=n.EmailAddressIndex,t.RelevanceScore=n.RelevanceScore,t};_mco.d.c=function(n){var t=$(n);t.find("a[id^='OWAAM']").attr("class","mention")};_mco.h=function(n,t){this.w=Function.createDelegate(this,this.G);this.u=Function.createDelegate(this,this.E);this.v=Function.createDelegate(this,this.F);this.y=Function.createDelegate(this,this.I);this.x=Function.createDelegate(this,this.H);this.r=Function.createDelegate(this,this.B);this.p=Function.createDelegate(this,this.z);this.q=Function.createDelegate(this,this.A);this.t=Function.createDelegate(this,this.D);this.s=Function.createDelegate(this,this.C);if(t.a().eW().Enabled&&n.g()){this.o=_a.I.c();this.a="?guid="+this.o+"&PartID=ExoProd";this.h="https://1.perf.msedge.net/cold.gif"+this.a;this.i="https://4.perf.msedge.net/cold.gif"+this.a;this.m="https://1.perf.msedge.net/hot.gif"+this.a;this.n="https://4.perf.msedge.net/hot.gif"+this.a;this.f="https://outlook.office365.com/owa/auth/current/themes/resources/lgnexlogo.gif"+this.a;this.e="https://outlook.live.com/owa/auth/current/themes/resources/lgnexlogo.gif"+this.a;this.g="https://edge.outlook.office365.com/owa/auth/current/themes/resources/lgnexlogo.gif"+this.a;this.k="https://outlook.office365.com/owa/auth/current/themes/resources/lgnbotm.gif"+this.a;this.j="https://outlook.live.com/owa/auth/current/themes/resources/lgnbotm.gif"+this.a;this.l="https://edge.outlook.office365.com/owa/auth/current/themes/resources/lgnbotm.gif"+this.a;this.c={};var f=new Image;f.onload=this.s;f.src=this.h;var e=new Image;e.onload=this.t;e.src=this.i;var u=new Image;u.onload=this.q;u.src=this.f;var i=new Image;i.onload=this.p;i.src=this.e;var r=new Image;r.onload=this.r;r.src=this.g}};_mco.h.prototype={o:null,a:null,h:null,i:null,m:null,n:null,f:null,e:null,g:null,k:null,j:null,l:null,c:null,C:function(){var n=new Image;n.onload=this.x;n.src=this.m;this.b(this.h,"t-a-cold")},D:function(){var n=new Image;n.onload=this.y;n.src=this.n;this.b(this.i,"t-b-cold")},H:function(){this.b(this.m,"t-a-hot");this.d()},I:function(){this.b(this.n,"t-b-hot");this.d()},A:function(){var n=new Image;n.onload=this.v;n.src=this.k;this.b(this.f,"t-cafe-cold")},z:function(){var n=new Image;n.onload=this.u;n.src=this.j;this.b(this.e,"t-live-cold")},B:function(){var n=new Image;n.onload=this.w;n.src=this.l;this.b(this.g,"t-edgecafe-cold")},F:function(){this.b(this.k,"t-cafe-hot");this.d()},E:function(){this.b(this.j,"t-live-hot");this.d()},G:function(){this.b(this.l,"t-edgecafe-hot");this.d()},b:function(n,t){if(_a.T.e()){var i=_a.T.j(n);this.c[t]=i?Math.floor(i.responseEnd-i.startTime).toString():""}},d:function(){Object.keys(this.c).length===10&&this.J()},J:function(){var n="{";n=n+String.format('"Guid":"{0}"',this.o);n=n+String.format(',"PartID":"ExoProd"');var u=this.c;for(var i in u){var r={key:i,value:u[i]};n=n+String.format(',"{0}":"{1}"',r.key,r.value)}n+="}";var f=encodeURIComponent(n);var t=new Sys.Net.WebRequest;t.set_url("https://1.perf.msedge.net/exoprodci?p="+f);t.set_httpVerb("Get");t.invoke()}};_mco.l=function(){};_mco.l.a=function(n,t){if(n&&n.d()){var u=_a.d.b(_a.a.cl,"InfoBarCount");u.o(new _a.ba(t));var o=n.d();var i=o.x.length;var r=new _a.o;r.a("T",i);if(i>0){var f="";var e=0;o.n(function(n){var t=n;f+=t.e.toString();e!==i-1&&(f+=",");e++});r.b("IDs",f)}u.j=r.toString();_a.d.a(u)}};function MailCommonComponent(){}MailCommonComponent.$$cctor=function(){_a.u.a().a(MailCommonComponent)};MailCommonComponent.prototype={a:function(n,t,i){var r=this;n.b(_mco.h,function(){return new _mco.h(n.a(_a.y),n.a(_a.f))}).a()},b:function(){return[new _j.w(_mco.h,2,1)]}};_mco.j=function(n,t,i,r,u){this.d=n;this.h=t;this.j=i;this.e=r;this.i=u};_mco.j.prototype={d:null,f:null,g:!1,c:function(n){this.g=n;return n},j:null,h:null,e:null,i:null,k:!1,a:function(n,t,i,r){if(!this.g){this.i&&t.a()==="Mouse"&&this.i(n);if(this.d){this.h&&this.d.a().k().Enabled&&this.h(n);this.j&&this.d.a().m().Enabled&&this.j(n);if(this.f&&this.d.b()&&this.d.a().cz().Enabled){var u=_a.d.b(_a.a.u,"EmojisProcessedInRP");n.innerHTML=this.f(n.innerHTML);_a.d.a(u)}}this.g=!0}!this.k&&this.e&&this.l(n,t,!0,i,r)},b:function(n,t,i,r){this.e&&this.l(n,t,!1,i,r)},l:function(n,t,i,r,u){var f=[];var e=this;_j.E.b(n.querySelectorAll("A"),function(n,t){var e=t;r&&u(e,t,i);Array.add(f,e)});this.e(f,n,t,i);this.k=i}};_mco.g=function(n,t){this.b=n;this.a=t};_mco.g.prototype={b:null,a:null};_mco.f=function(n){this.a=n};_mco.f.prototype={a:null};_mco.a=function(n,t,i,r){this.s=Function.createDelegate(this,this.bD);this.t=Function.createDelegate(this,this.bE);_mco.a.initializeBase(this,[2]);this.j=n;this.bL=n;this.bx=i;this.bf="CreateMessageForCompose";t&&(this.bp=_g.n.c(t));r&&(this.bl=r)};_mco.a.b=function(n){if(!n||!n.Mailbox){var i=_mco.a.g(null);if(i){n=new _g.O;n.Mailbox=new _g.f;n.Mailbox.EmailAddress=i}}if(!n||!n.Mailbox)return null;var t=_mco.a.f(n);if(t){n.Mailbox.Name=t.DisplayName;n.Mailbox.RoutingType="SMTP"}return n};_mco.a.g=function(n){var f=_g.a.a().c().bk.UserEmailAddress;var e=_g.a.a().z;var t;t=e?n?null:_g.a.a().c().bk.DefaultFromAddress:_g.a.a().a().bk.SendAddressDefault;if(!_j.i.a(t)){var u=_mco.a.j(t);u||(u=_mco.a.p(t));if(u)return u.EmailAddress;if(e){var a=_g.a.a().c().b();var v=_g.a.a().c().a();if(a&&a.g(t)||v&&v.g(t))return t}if(t===f)return null}if(n){var i=_g.i.isInstanceOfType(n)?n:null;if(i&&(_mco.a.c(i.m(),f)||_mco.a.c(i.o(),f)))return null;var p=_mco.a.j(n.hG());if(p)return p.EmailAddress;var w=_g.a.a().c().b();var b=_g.a.a().c().a();var k=_g.a.a().c().e();var r;var o,h,l,c,s,y;if(e&&i&&((h=_mco.a.n(i,w,o={val:r}),r=o.val,h)||(c=_mco.a.n(i,b,l={val:r}),r=l.val,c)||(y=_mco.a.r(i,k,s={val:r}),r=s.val,y)))return r}return null};_mco.a.e=function(n,t){var r=_mco.a.f(n);if(r){var i=new _g.U;i.ExtendedFieldURI=_g.c.w();i.Value=r.SubscriptionGuid;_mco.a.d(t,i)}else _mco.a.q(t,_g.c.w())};_mco.a.d=function(n,t){if(n.ExtendedProperty){for(var i=0;i<n.ExtendedProperty.length;i++)if(n.ExtendedProperty[i].ExtendedFieldURI.PropertySetId===t.ExtendedFieldURI.PropertySetId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyTag===t.ExtendedFieldURI.PropertyTag&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyId===t.ExtendedFieldURI.PropertyId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyName===t.ExtendedFieldURI.PropertyName&&n.ExtendedProperty[i].ExtendedFieldURI.DistinguishedPropertySetId===t.ExtendedFieldURI.DistinguishedPropertySetId){n.ExtendedProperty[i]=t;return}var r=[];Array.addRange(r,n.ExtendedProperty);Array.add(r,t);n.ExtendedProperty=r}else{n.ExtendedProperty=new Array(1);n.ExtendedProperty[0]=t}};_mco.a.q=function(n,t){var r=!1;if(n.ExtendedProperty){for(var u=[],i=0;i<n.ExtendedProperty.length;i++){if(n.ExtendedProperty[i].ExtendedFieldURI.PropertySetId===t.PropertySetId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyTag===t.PropertyTag&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyId===t.PropertyId&&n.ExtendedProperty[i].ExtendedFieldURI.DistinguishedPropertySetId===t.DistinguishedPropertySetId){r=!0;continue}Array.add(u,n.ExtendedProperty[i])}r&&(n.ExtendedProperty=u)}};_mco.a.j=function(n){if(!n)return null;for(var i=_g.a.a().c().e(),r=i?i.b():0,t=0;t<r;t++)if(n===i.a(t).SubscriptionGuid)return i.a(t);return null};_mco.a.p=function(n){if(!n)return null;for(var i=_g.a.a().c().e(),r=i?i.b():0,t=0;t<r;t++)if(n===i.a(t).EmailAddress)return i.a(t);return null};_mco.a.f=function(n){if(!n||!n.Mailbox)return null;for(var i=_g.a.a().c().e(),r=i?i.b():0,t=0;t<r;t++)if(i.a(t).EmailAddress===n.Mailbox.EmailAddress)return i.a(t);return null};_mco.a.o=function(n,t,i,r){if(_g.bf.isInstanceOfType(n)){var o=n;var e=new _g.cY;e.Subject=o.bk.Subject;e.Body=new _g.s(o.I().a()==="HTML"?"HTML":"Text",o.I().bk.Value);e.Importance=o.bM();var s=_mco.a.b(o.bk.From);e.From=s;_mco.a.e(s,e);e.Sensitivity=o.bR();_mco.a.e(s,e);_mco.a.i(e,o);return e}else{var u=n;var f=new _g.P;f.Subject=u.bk.Subject;f.Body=new _g.s(u.I().a()==="HTML"?"HTML":"Text",u.I().bk.Value);u.eQ()&&(f.DocLinks=u.eQ().f());f.Body.BodyType==="HTML"&&(f.Body.Value=_a.I.f(f.Body.Value,!0));if(u.bI()){f.ItemClass=u.bk.ItemClass;f.MimeContent=u.bk.MimeContent}else _db.f.b(u,f);f.Importance=u.bM();var h=_mco.a.b(u.bk.From);f.From=h;u.bk.Sender&&(f.Sender=u.bk.Sender);_mco.a.e(h,f);f.ToRecipients=_db.f.a(u.m());f.CcRecipients=_db.f.a(u.o());f.BccRecipients=_db.f.a(u.v());f.Sensitivity=u.bR();f.IsDeliveryReceiptRequested=u.bk.IsDeliveryReceiptRequested;f.IsReadReceiptRequested=u.bk.IsReadReceiptRequested;u.bk.InternetMessageId&&(f.InternetMessageId=u.bk.InternetMessageId);if(t){if(r===1){t.d()&&(f.AtAllMention=u.bk.AtAllMention);t.c()&&u.bZ()&&(f.MentionsEx=_mco.d.a(u.bZ(),u.bk.From));t.e()&&u.cd()&&(f.AppliedHashtags=u.cd().f())}!r&&t.i()&&(f.PendingSocialActivityTagIds=u.cX().f())}_mco.a.i(f,u);_mco.a.k(f,u);_mco.a.l(f,u);_mco.a.m(f,u);_mco.a.h(f,u);return f}};_mco.a.i=function(n,t){if(t.dt()){_mco.a.a(n,_g.c.J(),t.dt().toString());_mco.a.a(n,_g.c.F(),t.ed());_mco.a.a(n,_g.c.D(),t.eb());_mco.a.a(n,_g.c.E(),t.ec())}};_mco.a.l=function(n,t){var i=t.bG()?_g.c.a(t.bG().f(),_g.c.c()):null;if(i){_mco.a.a(n,_g.c.c(),i.bk.Value);i.dispose()}};_mco.a.m=function(n,t){var i=t.bG()?_g.c.a(t.bG().f(),_g.c.b()):null;if(i){_mco.a.a(n,_g.c.b(),i.bk.Value);i.dispose()}};_mco.a.k=function(n,t){t.df()&&_mco.a.a(n,_g.c.I(),t.df());t.cS()&&_mco.a.a(n,_g.c.H(),t.cS());t.ds()&&_mco.a.a(n,_g.c.G(),t.ds())};_mco.a.h=function(n,t){if(t.bG())for(var r=0,o=t.bG().b();r<o;r++){var e=t.bG().a(r);var i;var u,f;(f=_h.F.c(e,u={val:i}),i=u.val,f)&&_mco.a.d(n,i);e.dispose()}};_mco.a.a=function(n,t,i){var r=new _g.U;r.ExtendedFieldURI=t;r.Value=i;_mco.a.d(n,r)};_mco.a.n=function(n,t,i){i.val=null;if(t)for(var r=0;r<t.b();r++){i.val=t.a(r);if(_mco.a.c(n.m(),i.val)||_mco.a.c(n.o(),i.val))return!0}return!1};_mco.a.r=function(n,t,i){i.val=null;if(t)for(var u=0;u<t.b();u++){var r=t.a(u);if(_mco.a.c(n.m(),r.EmailAddress)||_mco.a.c(n.o(),r.EmailAddress)){i.val=r.EmailAddress;return!0}}return!1};_mco.a.c=function(n,t){t=t?t.toLowerCase():null;if(t&&n)for(var i=0;i<n.b();i++)if(n.a(i).EmailAddress&&n.a(i).EmailAddress.toLowerCase()===t)return!0;return!1};_mco.a.prototype={k:null,j:null,bx:null,bl:null,bC:function(n){if(!this.k){this.k=n;this.bw("ResponseSuccess",n);_h.CreateItemResponseProcessor.e(this.t);_h.CreateItemResponseProcessor.c(this.s)}},by:function(n){if(this.k){this.bH("ResponseSuccess",this.k);_h.CreateItemResponseProcessor.d(this.t);_h.CreateItemResponseProcessor.b(this.s);this.k=null}},bn:function(){if(!this.bh)switch(this.u){case 0:this.bh=_g.b.a.nameToId("drafts");break;default:this.bh=_g.b.a.nameToId("outbox");break}var n;_db.f.d(this.j.I(),n={val:this.bz},this.bq),this.bz=n.val;return[_mco.a.o(this.j,this.bx,this.bl,this.u)]},bc:function(){var n=_db.f.prototype.bc.call(this);var t=this.j.bB();t&&(n.rightsManagementLicenseData=_db.f.c(t));n.explicitLogonUser=this.S;n.itemPartsOrderDescending=_g.a.a().a().n()!=="ChronologicalNewestOnBottom";this.u===1&&(n.actionName=this.bf+"Send");n.setServiceUnavailableOnTransientError=!0;return n},bE:function(n,t){var i=n.a;var f=t;var u=new _g.eV;var r=i.itemIds[n.b];this.bN("ResponseSuccess",this)},bD:function(n){var t=n.id;if(this.Q.id===t){this.by(this.k);_h.CreateItemResponseProcessor.d(this.t);_h.CreateItemResponseProcessor.b(this.s)}}};_mco.c=function(n,t,i,r){this.cj=Function.createDelegate(this,this.ct);this.ck=Function.createDelegate(this,this.cz);_mco.c.initializeBase(this,[2]);this.bY=n;this.bY.ReferenceItemId=_g.g.a(t);this.cr=i;this.cq=r;this.bf="CreateResponse"};_mco.c.a=function(n){var t=null;if(_g.cJ.isInstanceOfType(n))t=new _g.bJ;else if(_g.cx.isInstanceOfType(n))t=new _g.bN;else if(_g.cw.isInstanceOfType(n))t=new _g.bv;else throw Error.invalidOperation("SmartResponseItem type is not supported.");return t};_mco.c.b=function(n,t,i,r,u,f,e){if(t){if(_g.i.isInstanceOfType(t)){var o=t;var s=n;if(o.bk.ItemId)if(i)s.UpdateResponseItemId=_bc.OutboxItemContext.a(o.bk.ItemId,_a.a.y);else if(r)s.UpdateResponseItemId=_bc.OutboxItemContext.a(r,_a.a.y);else{s.UpdateResponseItemId=new _g.g(o.bk.ItemId.Id);s.UpdateResponseItemId.ChangeKey=o.bk.ItemId.ChangeKey}o.bk.InternetMessageId&&(s.InternetMessageId=o.bk.InternetMessageId);var l=_mco.a.b(o.bk.From);_mco.a.e(l,s);s.From=l;o.bk.Sender&&(s.Sender=o.bk.Sender);o.m()&&(s.ToRecipients=_db.f.a(o.m()));o.o()&&(s.CcRecipients=_db.f.a(o.o()));o.v()&&(s.BccRecipients=_db.f.a(o.v()));if(u){if(e===1){u.d()&&(s.AtAllMention=o.bk.AtAllMention);u.c()&&o.bZ()&&(s.MentionsEx=_mco.d.a(o.bZ(),o.bk.From));u.e()&&o.cd()&&(s.AppliedHashtags=o.cd().f())}!e&&u.i()&&(s.PendingSocialActivityTagIds=o.cX().f())}s.IsDeliveryReceiptRequested=o.bk.IsDeliveryReceiptRequested;s.IsReadReceiptRequested=o.bk.IsReadReceiptRequested;var c=_g.bt.isInstanceOfType(t)?t.f():t.I();s.NewBodyContent=new _g.s(c.a()==="HTML"?"HTML":"Text",c.bk.Value);!u.b()&&s.UpdateResponseItemId&&s.NewBodyContent.BodyType==="HTML"&&_j.i.a(s.NewBodyContent.Value)&&(s.NewBodyContent.Value="<BR />");s.UpdateResponseItemId;_db.f.b(o,s);_mco.a.h(n,o)}else if(_g.bf.isInstanceOfType(t)){var a=n;var h=_g.bt.isInstanceOfType(t)?t.f():t.I();a.NewBodyContent=new _g.s(h.a()==="HTML"?"HTML":"Text",h.bk.Value)}n.Subject=t.bk.Subject;n.Importance=t.bM();n.Sensitivity=t.bR();_mco.a.i(n,t);e===1&&_mco.a.k(n,t)}return n};_mco.c.prototype={cr:null,cq:null,bY:null,bC:null,bl:null,by:0,bD:null,bx:null,bO:!1,j:function(n){if(!this.bD){this.bD=n;this.bw("ResponseSuccess",n);_h.CreateItemResponseProcessor.e(this.ck);_h.CreateItemResponseProcessor.c(this.cj)}},t:function(n){if(this.bD){this.bH("ResponseSuccess",this.bD);_h.CreateItemResponseProcessor.d(this.ck);_h.CreateItemResponseProcessor.b(this.cj);this.bD=null}},bE:function(n){this.bC=n;this.bL=n;return n},k:function(){var n=this.bj();var t=n.Body;n=null;return t},s:function(n){this.cJ(n)},bc:function(){var n=_db.f.prototype.bc.call(this);var t=this.bC.bB();t&&(n.rightsManagementLicenseData=_db.f.c(t));if(!!(!!this.bx&!!this.bk)){n.parentConversationNodeId=this.bx;n.conversationId=new _g.g(this.bk.Id)}var i=_g.b.a.nameToId("inbox");n.inboxFolderId=new _g.l(i.Id);n.explicitLogonUser=this.S;this.u===1&&(n.actionName=this.bf+"Send");n.setServiceUnavailableOnTransientError=!0;return n},bn:function(){if(!this.bh)switch(this.u){case 0:this.bh=_g.b.a.nameToId("drafts");break;default:this.bh=_g.b.a.nameToId("outbox");break}var n;_db.f.d(this.bC.I(),n={val:this.bz},this.bq),this.bz=n.val;this.bY.ReferenceItemDocumentId=this.by;!this.by;return[_mco.c.b(this.bY,this.bC,this.bu,this.bM,this.cr,this.cq,this.u)]},bj:function(){var n=_db.f.prototype.bj.call(this);this.bO&&_g.a.a().a().q()!=="AlwaysSend"&&(n.Body.ShouldSuppressReadReceipt=!0);n.Body.SendOnNotFoundError=!0;return n},cJ:function(n){_db.f.prototype.cJ.call(this,n);var t=n.Items[0];if(this.u)this.u===1&&this.bC.bk.ItemId&&_db.bh.a(this.bC.bk.ItemId,!1);else if(this.bo)(t.Body||t.NormalizedBody)&&this.cs(t);else{var i=t.ItemId;_h.c.z(i)}},cs:function(n){var t=_g.h.b(n);this.bl=t},cz:function(n,t){var r=n.a;var f=t;var u=new _g.eV;var i=r.itemIds[n.b];if(i&&this.F&&u.a(this.F,i)){this.cs(f.Items[0]);this.bN("ResponseSuccess",this)}},ct:function(n){var i=n.id;var t=this.Q;if(t&&t.id===i){this.t(this.bD);_h.CreateItemResponseProcessor.d(this.ck);_h.CreateItemResponseProcessor.b(this.cj)}}};_mco.i=function(n,t,i){_mco.i.initializeBase(this,[t]);this.c=n;this.i=n.bk.ItemId;this.f=i};_mco.i.prototype={i:null,c:null,f:null,M:function(){return this.Y("V2015_10_15")},K:function(n){var t=new _g.bH(_h.b.h());t.ItemIds=[new _g.g(this.i.Id)];t.ItemShape.AdditionalProperties=[new _g.d("AppliedHashtags")];var i=new _g.bK(this.L);i.clientStoreItem=0;var r=new _g.bG(this.M(),t);n.a(r,i,this.I,this.G)},cJ:function(n){if(n.ResponseClass==="Success"&&n.Items&&!(n.Items.length<1)){var f=n.Items[0];if(f){var r=f.AppliedHashtags;var e=r?r.length:0;if(e>0){for(var i=new _a.j,t=0;t<e;t++)i.c(r[t]);this.c.ej(i);var u=_h.d.a().a(this.i.Id);u&&u.ej(i)}}}}};_mco.b=function(n,t,i){this.bE=Function.createDelegate(this,this.cc);this.bK=Function.createDelegate(this,this.ce);_mco.b.initializeBase(this,[2]);this.f=n;this.bh=t;this.bX=i;this.u=0;this.bL=n.I().bk.Value;this.bo="AutoResolve";this.bA=_g.b.a.nameToId("outbox");this.r="UpdateMessageForCompose"};_mco.b.a=function(n,t,i,r){var f=new _g.v(i);var u=new _g.P;r(u,t);f.Item=u;Array.add(n,f)};_mco.b.k=function(n,t){n.Sensitivity=t.bR()};_mco.b.i=function(n,t){n.IsDeliveryReceiptRequested=t.bk.IsDeliveryReceiptRequested};_mco.b.j=function(n,t){n.IsReadReceiptRequested=t.bk.IsReadReceiptRequested};_mco.b.h=function(n,t){_mco.a.a(n,_g.c.J(),t.dt().toString())};_mco.b.d=function(n,t){_mco.a.a(n,_g.c.F(),t.ed())};_mco.b.b=function(n,t){_mco.a.a(n,_g.c.D(),t.eb())};_mco.b.c=function(n,t){_mco.a.a(n,_g.c.E(),t.ec())};_mco.b.g=function(n,t){_mco.a.a(n,_g.c.I(),t.df())};_mco.b.f=function(n,t){_mco.a.a(n,_g.c.H(),t.cS())};_mco.b.e=function(n,t){_mco.a.a(n,_g.c.G(),t.ds())};_mco.b.prototype={bX:null,f:null,bn:null,bj:null,l:null,bV:!1,bU:null,bq:null,br:null,bW:!1,bk:null,bh:null,c:function(n){this.bj=n;return n},cb:function(n){if(!this.bk){this.bk=n;this.bw("ResponseSuccess",n);_db.UpdateItemResponseProcessor.e(this.bK);_db.UpdateItemResponseProcessor.d(this.bE)}},bY:function(n){if(this.bk){this.bH("ResponseSuccess",this.bk);_db.UpdateItemResponseProcessor.c(this.bK);_db.UpdateItemResponseProcessor.b(this.bE);this.bk=null}},bf:function(){_h.cL.prototype.bf.call(this);var n=this.s;var t=this.f.bB();if(t){n.rightsManagementLicenseData=_db.f.c(t);n.isUpdatingRightsManagementLicenseData=!0}if(_g.i.isInstanceOfType(this.f)&&this.l){n.outboxItemId=new _g.g(this.l.Id);n.outboxItemId.ChangeKey=this.l.ChangeKey;var r=_g.b.a.nameToId("drafts");n.parentFolderId=new _g.l(r.Id)}if(_g.i.isInstanceOfType(this.f)&&this.bj){n.resendItemId=new _g.g(this.bj.Id);n.resendItemId.ChangeKey=this.bj.ChangeKey}if(!!(!!this.br&!!this.bq)){n.parentConversationNodeId=this.br;n.conversationId=new _g.g(this.bq.Id)}var i=_g.b.a.nameToId("inbox");n.inboxFolderId=new _g.l(i.Id);n.bodySubstring=this.bU;n.itemPartsOrderDescending=_g.a.a().a().n()!=="ChronologicalNewestOnBottom";this.u===1&&(n.actionName=this.r+"Send");n.setServiceUnavailableOnTransientError=!0},cJ:function(n){if(this.bV)throw Error.invalidOperation("Expected only one response message.");this.bV=!0;if(this.u)this.u===1&&_db.bh.a(this.f.bk.ItemId,!1);else{this.bn=n.Items[0].ItemId;_h.c.z(this.bn)}this.l&&_h.c.d([this.l],!1)},t:function(){var i=new _g.bq;var r;r=this.l?_bc.OutboxItemContext.a(this.l,_a.a.y):this.bj?_bc.OutboxItemContext.a(this.bj,_a.a.y):this.f.bk.ItemId;i.ItemId=new _g.g(r.Id);i.ItemId.ChangeKey=r.ChangeKey;this.f.I().a()==="HTML"&&this.f.I().b(_a.I.f(this.f.I().bk.Value,!1));if(this.bW&&this.f.I().a()==="HTML"){this.bO=!0;var l=_a.x.h(this.f.I().bk.Value);this.f.I().b(l)}var n=[];if(this.f.bI()){var ht=this;_mco.b.a(n,this.f,new _g.d("MimeContent"),function(n,t){n.MimeContent=t.bk.MimeContent})}else if(this.f.S()&&this.f.S().b()>0){var h=_db.f.g(this.f.S());if(h.length>0){var it=this;_mco.b.a(n,this.f,new _g.d("Attachments"),function(n,t){n.Attachments=h})}}if(this.f.eQ()){var rt=this;_mco.b.a(n,this.f,new _g.d("DocLinks"),function(n,t){n.DocLinks=t.eQ().f()})}if(this.f.bk.ItemClass){var tt=this;_mco.b.a(n,this.f,new _g.d("ItemClass"),function(n,t){n.ItemClass=t.bk.ItemClass})}var t=null;t=_g.i.isInstanceOfType(this.f)?this.f.bk.From:this.f.bk.From;t=_mco.a.b(t);var v=_mco.a.f(t);if(v){var g=this;_mco.b.a(n,this.f,_g.c.w(),function(n,i){_mco.a.e(t,n)})}else Array.add(n,new _g.bh(_g.c.w()));if(_g.i.isInstanceOfType(this.f)){if(t){var nt=this;_mco.b.a(n,this.f,new _g.d("From"),function(n,i){n.From=t})}else Array.add(n,new _g.bh(new _g.d("From")));var ut=this;_mco.b.a(n,this.f,new _g.d("CcRecipients"),function(n,t){n.CcRecipients=_db.f.a(t.o())});var st=this;_mco.b.a(n,this.f,new _g.d("BccRecipients"),function(n,t){n.BccRecipients=_db.f.a(t.v())});var k=this;_mco.b.a(n,this.f,new _g.d("ToRecipients"),function(n,t){n.ToRecipients=_db.f.a(t.m())});if(this.bh){if(this.u===1){if(this.bh.d()){var ot=this;_mco.b.a(n,this.f,new _g.d("AtAllMention"),function(n,t){n.AtAllMention=t.bk.AtAllMention})}if(this.bh.c()){var ft=this;_mco.b.a(n,this.f,new _g.d("MentionsEx"),function(n,t){var i=t;n.MentionsEx=_mco.d.a(i.bZ(),i.bk.From)})}if(this.bh.e()){var et=this;_mco.b.a(n,this.f,new _g.d("AppliedHashtags"),function(n,t){n.AppliedHashtags=t.cd().f()})}}if(!this.u&&this.bh.i()){var d=this;_mco.b.a(n,this.f,new _g.d("PendingSocialActivityTagIds"),function(n,t){n.PendingSocialActivityTagIds=t.cX().f()})}}_mco.b.a(n,this.f,new _g.d("IsReadReceiptRequested"),_mco.b.j);_mco.b.a(n,this.f,new _g.d("IsDeliveryReceiptRequested"),_mco.b.i);this.f.bG()&&_g.c.a(this.f.bG().f(),_g.c.c())&&_mco.b.a(n,this.f,_g.c.c(),_mco.a.l);this.f.bG()&&_g.c.a(this.f.bG().f(),_g.c.b())&&_mco.b.a(n,this.f,_g.c.b(),_mco.a.m)}var y=this;_mco.b.a(n,this.f,new _g.d("Subject"),function(n,t){n.Subject=t.bk.Subject});var p=this;_mco.b.a(n,this.f,new _g.d("Importance"),function(n,t){n.Importance=t.bM()});var w=this;_mco.b.a(n,this.f,new _g.d("Body"),function(n,t){n.Body=new _g.s(t.I().a()==="HTML"?"HTML":"Text",t.I().bk.Value)});_mco.b.a(n,this.f,new _g.d("Sensitivity"),_mco.b.k);if(this.f.dt()){_mco.b.a(n,this.f,_g.c.J(),_mco.b.h);_mco.b.a(n,this.f,_g.c.F(),_mco.b.d);_mco.b.a(n,this.f,_g.c.D(),_mco.b.b);_mco.b.a(n,this.f,_g.c.E(),_mco.b.c)}if(this.u===1){_j.i.d(this.f.df())||_mco.b.a(n,this.f,_g.c.I(),_mco.b.g);_j.i.d(this.f.cS())||_mco.b.a(n,this.f,_g.c.H(),_mco.b.f);this.f.ds()&&_mco.b.a(n,this.f,_g.c.G(),_mco.b.e)}if(this.f.bG())for(var e=0,a=this.f.bG().b();e<a;e++){var s=this.f.bG().a(e);var u;var o,c;if(c=_h.F.c(s,o={val:u}),u=o.val,c){var b=this;_mco.b.a(n,this.f,u.ExtendedFieldURI,function(n,t){_mco.a.d(n,u)})}s.dispose()}i.Updates=new Array(n.length);for(var f=0;f<n.length;f++)i.Updates[f]=n[f];return[i]},bp:function(){var n=_h.cL.prototype.bp.call(this);n.Body.PromoteInlineAttachments=this.f.I().a()==="Text";n.Body.SendOnNotFoundError=!0;return n},ce:function(n,t){var i=n.a;var f=t;var u=new _g.eV;var r=i.itemIds[n.b];this.bN("ResponseSuccess",this)},cc:function(n){var t=n.id;if(this.Q.id===t){this.bY(this.bk);_db.UpdateItemResponseProcessor.c(this.bK);_db.UpdateItemResponseProcessor.b(this.bE)}}};var IExtensibilityNotificationsManager=function(){};IExtensibilityNotificationsManager.registerInterface("IExtensibilityNotificationsManager");var IPersistedNotificationsManager=function(){};IPersistedNotificationsManager.registerInterface("IPersistedNotificationsManager");var IInfoBarNotificationsManager=function(){};IInfoBarNotificationsManager.registerInterface("IInfoBarNotificationsManager");_mco.e=function(){};_mco.e.registerInterface("_mco.e");_mco.o=function(){};_mco.o.registerInterface("_mco.o");_mco.n=function(){};_mco.n.registerInterface("_mco.n");var IGroupedConnectorCardsViewModelFactory=function(){};IGroupedConnectorCardsViewModelFactory.registerInterface("IGroupedConnectorCardsViewModelFactory");var ITailoredEntityViewModelFactory=function(){};ITailoredEntityViewModelFactory.registerInterface("ITailoredEntityViewModelFactory");_mco.m=function(){};_mco.m.registerInterface("_mco.m");_mco.p=function(){};var ICalendarCoauthoringMessageViewModelFactory=function(){};ICalendarCoauthoringMessageViewModelFactory.registerInterface("ICalendarCoauthoringMessageViewModelFactory");_mco.h.registerClass("_mco.h");MailCommonComponent.registerClass("MailCommonComponent",null,_a.ic,_j.ce);_mco.g.registerClass("_mco.g");_mco.f.registerClass("_mco.f");_mco.a.registerClass("_mco.a",_db.f);_mco.c.registerClass("_mco.c",_db.f,_h.et,_h.er,IActionBase,_h.bC,_h.es);_mco.i.registerClass("_mco.i",_h.cO.$$(_g.ex,_g.dA));_mco.b.registerClass("_mco.b",_h.cL,_h.ew,_h.ev);MailCommonComponent.$$cctor();_mco.c.c=_a.a.y;
window.scriptsLoaded['microsoft.owa.mail.common.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.mail.common.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
