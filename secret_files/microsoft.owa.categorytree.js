try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.categorytree.js'] = (new Date()).getTime();
Type.registerNamespace("_catr");_catr.d=function(n,t,i,r,u,f){this.e=n;this.f=t;this.g=i;this.b=r;this.c=u;this.d=f};_catr.d.prototype={e:null,f:null,g:null,b:null,c:null,d:null,a:function(){return new _catr.b(this.e,this.f,this.g,this.b,this.c,this.d)}};_catr.c=function(n,t,i,r,u){_catr.c.initializeBase(this,[n,t,i,null,null,!1,r,u,null,null]);this.bF(!1)};_catr.c.prototype={E:function(){_j.e.c(_a.a.cG,"CategoryTreeNodeViewModel.PopulateContextMenuItemsInFolderPicker not implemented");return null},z:function(){_j.e.c(_a.a.cG,"CategoryTreeNodeViewModel.PopulateContextMenuItemsInFolderPane not implemented");return null},K:function(){_j.e.c(_a.a.cG,"CategoryTreeNodeViewModel : Dragging category is not supported")}};_catr.b=function(n,t,i,r,u,f){this.r=Function.createDelegate(this,this.R);this.m=new _j.l;this.b=this.g;_catr.b.resolveInheritance();this.d=this.k;this.a=this.f;this.c=this.h;_catr.b.initializeBase(this,[null,!1,n,t,r,u,f,null]);this.o=i;this.A=u;this.o.b().apcl("UserCategoriesToShowInFolderPane",this.r);this.o.b().apcl("SystemCategoriesToShowInFolderPane",this.r)};_catr.b.prototype={o:null,A:null,z:!1,S:function(n){if(n!==this.z){this.z=n;this.ey("IsCategoryTreeCollapsed","CategoriesRootNodeToolTip")}return n},I:function(){return this.z?_u.n.MA:_u.n.K},J:function(){return!this.m||!this.m.x.length},g:function(){var n=new _j.q;var i=this.o.b().p();var t=this.o.b().n();i&&n.h(this.E(i,"SystemCategory").j());t&&n.h(this.E(t,"UserCategory").j());var r=this;n.k(function(n,t){return n.h.bk.DisplayName.localeCompare(t.h.bk.DisplayName)});this.m.m(n.j());this.eu("IsCategoryTreeEmpty")},P:function(n){_j.e.c(_a.a.cG,"CategoryTreeViewModel.OnFolderNodeDeleted is not implemented")},ex:function(){this.o.b().rpcl("UserCategoriesToShowInFolderPane",this.r);this.o.b().rpcl("SystemCategoriesToShowInFolderPane",this.r);_y.gw.prototype.ex.call(this)},R:function(n,t){for(var i=0;i<this.m.x.length;i++)this.m.x[i].dispose();while(this.m.x.length>0)this.m.p(0);this.g()},E:function(n,t){if(!n)return null;for(var f=new _j.q,i=0;i<n.b();i++){var u=t==="UserCategory"?n.a(i):_g.y.g(Number.parseInvariant(n.a(i)));if(_j.i.a(u))_j.e.b(_a.a.d,"[CategoryTreeViewModel] Category name cannot be null");else{var r=new _g.j;var e=t+"#"+u;r.h(new _g.bQ(e,t,n.a(i)));r.v(_g.b.a.nameToId("msgfolderroot"));r.f(u);f.c(new _catr.c(r,this,this.o,this.A,this.t))}}return f}};function CategoryTreeComponent(){}CategoryTreeComponent.$$cctor=function(){_a.u.a().a(CategoryTreeComponent)};CategoryTreeComponent.prototype={a:function(n,t,i){var r=this;n.b(ICategoryTreeFactory,function(){return new _catr.d(n.a(_j.j),n.a(_a.f),n.a(_g.a),n.a(_a.y),n.d(IDeferredActionsFactory),n.d(IDeferredTypeLoader))})},b:function(){return null}};_catr.a=function(){};_catr.a.$$cctor=function(){_catr.a._I()};_catr.a.r=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div></div> </div><div>  <div role=\"tree\" class='treeHeaderContainer firstHeaderTreeNodeRow nowrap'> <span> <button type='button' class='firstLevelTwisty ms-fwt-r'></button> </span> <span class='firstLevelFolderHead ms-fwt-sl ms-fcl-np ms-font-l'> </span> </div> <div class='modernNavigation'></div> </div><div> <div class='__Microsoft_Owa_CategoryTree_templates_cs_5'> <div class='__Microsoft_Owa_CategoryTree_templates_cs_2 nowrap border-color-transparent'> <div class='__Microsoft_Owa_CategoryTree_templates_cs_3'> <span class='__Microsoft_Owa_CategoryTree_templates_cs_4 ms-font-m ms-fwt-sl'></span> </div> </div> </div> </div><div>  <div class='__Microsoft_Owa_CategoryTree_templates_cs_6'> </div> <div></div> </div>";_j.h.a().appendChild(n);return n};_catr.a.i=function(n){return n.h};_catr.a.g=function(n){return n.bk.DisplayName};_catr.a.H=function(n){return n.n};_catr.a.z=function(n){return n.q()};_catr.a.J=function(n){return n.y};_catr.a.I=function(n){return n.s};_catr.a.P=function(n){return n.d()};_catr.a.Q=function(n){return n.f()};_catr.a.m=function(n){return n.c()};_catr.a.c=function(n){return n.X};_catr.a.o=function(n){return _n.c.isInstanceOfType(n)?n.bB:null};_catr.a.n=function(n){return _n.c.isInstanceOfType(n)?n.bu:null};_catr.a.f=function(n){return _n.c.isInstanceOfType(n)?n.br:null};_catr.a.l=function(n){return n.J()};_catr.a.h=function(n){return n.z};_catr.a.E=function(n){return n.I()};_catr.a.F=function(n){return n.m};_catr.a.U=function(n){return n.c()};_catr.a.T=function(n){return _n.c.isInstanceOfType(n)?n.be:null};_catr.a.S=function(n){return _n.c.isInstanceOfType(n)?n.bp:null};_catr.a.L=function(n){return n.p};_catr.a.bc=function(n){return n.f};_catr.a.N=function(n){return n.a()};_catr.a.A=function(n){return n.W()};_catr.a.O=function(n){return n.a};_catr.a.K=function(n){return n.x};_catr.a.bb=function(n,t){n.cq(t)};_catr.a.V=function(n,t){n.bY(t)};_catr.a.W=function(n,t){n.da(t)};_catr.a.Y=function(n,t){n.v(t)};_catr.a.Z=function(n,t){n.bP(t)};_catr.a.ba=function(n,t){n.bQ(t)};_catr.a.p=function(n,t){n.bJ(t)};_catr.a.b=function(n,t){n.k=t};_catr.a.C=function(n,t){n.A(t)};_catr.a.t=function(n,t){n.l(t)};_catr.a.u=function(n,t){n.s(t)};_catr.a.s=function(n,t){n.m(t)};_catr.a.x=function(n,t){n.o(t)};_catr.a.v=function(n,t){n.v(t)};_catr.a.y=function(n,t){n.bQ(t)};_catr.a.w=function(n,t){n.bb(t)};_catr.a.j=function(n,t){n.a(t)};_catr.a.k=function(n,t){n.bn(t)};_catr.a.D=function(n,t){n.J(t)};_catr.a.R=function(n,t){n.e(t)};_catr.a.G=function(n,t){n.S(t)};_catr.a.X=function(n,t){n.s(t)};_catr.a.M=function(n,t){n.D(t)};_catr.a.bg=function(n,t){n.g(t)};_catr.a.bd=function(n,t){n.j(t)};_catr.a.be=function(n,t){n.h(t)};_catr.a.bf=function(n,t){n.a=t};_catr.a.B=function(n,t){n.ba(t)};_catr.a.q=function(){_catr.a.e||(_catr.a.e=new _n.t);return _catr.a.e};_catr.a._I=function(){var r="CategoryTreeHeaderMouseView.CategoryTreeNodeHelperTemplate";new _j.d(r,function(){_catr.a.a[r]===undefined&&(_catr.a.a[r]=[[[-1,1,["ParentTreeNode"],[_catr.a.P],null,"ParentTreeNode",null,_catr.a.Z,1,null,null,null],[-1,1,["TreeLevel"],[_catr.a.Q],null,"TreeLevel",null,_catr.a.ba,1,null,null,0],[-1,1,["TreeContainer"],[_catr.a.m],null,"TreeContainer",null,_catr.a.p,1,null,null,null],[-1,0,["FolderNode","DisplayName"],[_catr.a.i,_catr.a.g],null,"TreeNodeDisplayName",null,_catr.a.bb,1,null,null,null],[-1,0,["ContextMenuViewModel","IsShown"],[_catr.a.H,_catr.a.z],null,"ContextMenuShown",null,_catr.a.V,1,null,null,!1],[-1,0,["IsShowingDialog"],[_catr.a.J],null,"DialogShown",null,_catr.a.W,1,null,null,!1],[-1,0,["DefaultSelected"],[_catr.a.I],null,"IsSelected",null,_catr.a.Y,1,null,null,!1]]]);var o=_catr.a.d.childNodes[0].cloneNode(!0);var n=new _n.q(o.children[0],_j.b.Instance.a(_n.d),_j.b.Instance.a(_j.o),_j.b.Instance.a(_a.f),_j.b.Instance.a(_a.y));n.e=!0;n.y("CategoryTreeNodeView.Mouse");var e=new _fc.g;e.b=!0;var f=new _fc.c;f.V(_j.f.a(["ContextParent","FocusOnPrevNodeCommand"],[_catr.a.c,_catr.a.o],null,"Command",null,_catr.a.b,1));f.i("UPARROW");var t=new _fc.c;t.V(_j.f.a(["ContextParent","FocusOnNextNodeCommand"],[_catr.a.c,_catr.a.n],null,"Command",null,_catr.a.b,1));t.i("DOWNARROW");var i=new _fc.c;i.V(_j.f.a(["ContextParent","SelectNodeCommand"],[_catr.a.c,_catr.a.f],null,"Command",null,_catr.a.b,1));i.i("ENTER");var u=new _fc.c;u.V(_j.f.a(["ContextParent","SelectNodeCommand"],[_catr.a.c,_catr.a.f],null,"Command",null,_catr.a.b,1));u.i("SPACE");e.a([f,t,i,u]);n.D([e]);return new _j.a(o,[n]).l({TreeNodeId:n})},"",_catr.c,_n.e,function(n){return new _n.e(n)},!1,!1,!1,0,_catr.a.a);var u="CategoryTreeHeaderMouseView";new _j.d(u,function(){_catr.a.a[u]===undefined&&(_catr.a.a[u]=[[[-1,5,["IsCategoryTreeEmpty"],[_catr.a.l],null,"hidden",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"ImageId",null,_catr.a.t,0,null,null,null,_n.b.L()],[-1,4,null,null,null,"PressedImageId",null,_catr.a.u,0,null,null,null,_n.b.N()],[-1,4,null,null,null,"HoveredImageId",null,_catr.a.s,0,null,null,null,_n.b.M()],[-1,4,null,null,null,"CheckedImageId",null,_catr.a.v,0,null,null,null,_n.b.k()],[-1,4,null,null,null,"PressedCheckedImageId",null,_catr.a.y,0,null,null,null,_n.b.H()],[-1,4,null,null,null,"HoveredCheckedImageId",null,_catr.a.w,0,null,null,null,_n.b.G()],[-1,0,["IsCategoryTreeEmpty"],[_catr.a.l],null,"AriaTabIndex",null,_catr.a.C,1,_catr.a.q(),0,0],[-1,0,["IsCategoryTreeCollapsed"],[_catr.a.h],null,"IsChecked",null,_catr.a.x,1,null,null,!1]],[[-1,4,null,null,null,"Text",null,_catr.a.j,0,null,null,null,_u.R.Im],[-1,0,["CategoriesRootNodeToolTip"],[_catr.a.E],null,"Title",null,_catr.a.k,1,null,null,null]],[[-1,0,["IsCategoryTreeCollapsed"],[_catr.a.h],null,"IsHidden",null,_catr.a.D,1,null,null,!0],[-1,0,["CategoryTreeNodeCollection"],[_catr.a.F],null,"DataSource",null,_catr.a.R,1,null,null,null]]]);var n=_catr.a.d.childNodes[1].cloneNode(!0);var t=new _n.e(n.children[1]);t.E(33);t.a("CategoryTreeHeaderMouseView.CategoryTreeNodeHelperTemplate");var f=new _fc.a(_j.a.a(n,[0,1]));var e=new _fc.j(_j.a.a(n,[0,0,0]));var i=new _j.h(_j.a.a(n,[0,0]));var r=new _j.h(n.children[0]);return new _j.a(n,[r,i,e,f,t]).l({TreeNodeContainer:r,TwistyContainer:i})},"",_catr.b,_n.c,function(n){return new _n.c(n,_j.b.Instance.a(_n.d),_j.b.Instance.a(_j.o))},!1,!1,!1,0,_catr.a.a);var i="CategoryTreeNodeView.Mouse";new _j.d(i,function(){_catr.a.a[i]===undefined&&(_catr.a.a[i]=[null,null,[[-1,0,["FolderNode","DisplayName"],[_catr.a.i,_catr.a.g],null,"Title",null,_catr.a.k,1,null,null,null],[-1,0,["FolderNode","DisplayName"],[_catr.a.i,_catr.a.g],null,"Text",null,_catr.a.j,1,null,null,null]]]);var t=_catr.a.d.childNodes[2].cloneNode(!0);var n=new _fc.a(_j.a.a(t,[0,0,0,0]));n.bf("folder");n.E(41);var u=new _j.h(_j.a.a(t,[0,0]));var r=new _j.h(t.children[0]);return new _j.a(t,[r,u,n]).l({TreeNodeLabel:r,TreeNodeContainer:u,TreeNodeLabelText:n})},"",_catr.c,_n.q,function(n){return new _n.q(n,_j.b.Instance.a(_n.d),_j.b.Instance.a(_j.o),_j.b.Instance.a(_a.f),_j.b.Instance.a(_a.y))},!1,!1,!1,0,_catr.a.a);var n="CategoryTreeView.Mouse.CategoryTreeNodeHelperTemplate";new _j.d(n,function(){_catr.a.a[n]===undefined&&(_catr.a.a[n]=[[[-1,1,["TreeContainer"],[_catr.a.m],null,"TreeContainer",null,_catr.a.p,1,null,null,null],[-1,0,["IsCategoryTreeCollapsed"],[_catr.a.h],_catr.a.G,"IsCollapsed",_catr.a.U,_catr.a.X,2,null,null,!1]]]);var h=_catr.a.d.childNodes[0].cloneNode(!0);var t=new _n.c(h.children[0],_j.b.Instance.a(_n.d),_j.b.Instance.a(_j.o));t.r(!0);t.x(!0);t.y("CategoryTreeHeaderMouseView");var o=new _fc.g;o.b=!0;var s=new _fc.c;s.V(_j.f.a(["ContextParent","ExpandCommand"],[_catr.a.c,_catr.a.T],null,"Command",null,_catr.a.b,1));s.i("RIGHTARROW");var e=new _fc.c;e.V(_j.f.a(["ContextParent","CollapseCommand"],[_catr.a.c,_catr.a.S],null,"Command",null,_catr.a.b,1));e.i("LEFTARROW");var i=new _fc.c;i.V(_j.f.a(["ContextParent","FocusOnPrevNodeCommand"],[_catr.a.c,_catr.a.o],null,"Command",null,_catr.a.b,1));i.i("UPARROW");var r=new _fc.c;r.V(_j.f.a(["ContextParent","FocusOnNextNodeCommand"],[_catr.a.c,_catr.a.n],null,"Command",null,_catr.a.b,1));r.i("DOWNARROW");var u=new _fc.c;u.V(_j.f.a(["ContextParent","SelectNodeCommand"],[_catr.a.c,_catr.a.f],null,"Command",null,_catr.a.b,1));u.i("ENTER");var f=new _fc.c;f.V(_j.f.a(["ContextParent","SelectNodeCommand"],[_catr.a.c,_catr.a.f],null,"Command",null,_catr.a.b,1));f.i("SPACE");o.a([s,e,i,r,u,f]);t.D([o]);return new _j.a(h,[t]).l({TreeNodeId:t})},"",_catr.b,_n.e,function(n){return new _n.e(n)},!1,!1,!1,0,_catr.a.a);var t="CategoryTreeView.Mouse";new _j.d(t,function(){_catr.a.a[t]===undefined&&(_catr.a.a[t]=[[[-1,1,["DataContext"],[_catr.a.A],null,"DataSource",null,_catr.a.be,1,null,null,null],[-1,1,["ForestContainer"],[_catr.a.O],null,"ForestContainer",null,_catr.a.bf,1,null,null,null],[-1,0,["SelectedFolder"],[_catr.a.L],_catr.a.M,"SelectedTreeNodeData",_catr.a.bc,_catr.a.bg,2,null,null,null],[-1,0,["ActivateFolderSelectionCommand"],[_catr.a.N],null,"ActivateTreeNodeSelectionCommand",null,_catr.a.bd,0,null,null,null]],[[-1,0,["MessageBoxViewModel"],[_catr.a.K],null,"DataContext",null,_catr.a.B,1,null,null,null]]]);var i=_catr.a.d.childNodes[3].cloneNode(!0);var r=new _j.c(i.children[1]);r.y("MessageBoxDefaultView");var n=new _n.m(i.children[0]);n.K(!0);n.e(4);n.b("CategoryTreeView.Mouse.CategoryTreeNodeHelperTemplate");n.E(33);return new _j.a(i,[n,r])},"",_catr.b,_n.j,function(n){return new _n.j(n)},!0,!1,!1,0,_catr.a.a)};_catr.c.registerClass("_catr.c",_y.br);_catr.b.registerClass("_catr.b",_y.gw,ICategoryTreeViewModel);CategoryTreeComponent.registerClass("CategoryTreeComponent",null,_a.ic,_j.ce);CategoryTreeComponent.$$cctor();_catr.a.d=_catr.a.r();_catr.a.e=null;_catr.a.a={};_catr.a.$$cctor();
window.scriptsLoaded['microsoft.owa.categorytree.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.categorytree.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
