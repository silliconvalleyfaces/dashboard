try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.mail.compose.js'] = (new Date()).getTime();
Type.registerNamespace("_mcp");_mcp.M=function(n,t,i,r){_mcp.M.initializeBase(this,[2]);_a.b.a(n,"approvalMessage");this.u=r;this.br=!0;this.bf="CreateApprovalResponse";this.k=n;this.j=t;this.s=i};_mcp.M.prototype={k:null,j:null,s:!1,R:function(){_a.cU.prototype.R.call(this);this.u===1&&_h.c.j(this.k.bk.ItemId,this.k.bk.ConversationId.Id)},bn:function(){var n;n=this.s?new _gg.bj:new _gg.ci;this.bh=this.u?_g.b.a.nameToId("outbox"):_g.b.a.nameToId("drafts");n.ReferenceItemId=_g.g.a(this.k.bk.ItemId);this.t(n);return[n]},cJ:function(n){!this.u&&n.Items&&n.Items[0]?this.F=n.Items[0].ItemId:this.u===1&&_h.c.f(this.k.bk.ItemId,this.k.bk.ConversationId.Id)},T:function(){_a.cU.prototype.T.call(this);this.u===1&&_h.c.f(this.k.bk.ItemId,this.k.bk.ConversationId.Id)},t:function(n){if(!this.j){var u=this.s?_nbs.a.ny:_nbs.a.OD;var r=String.format(_nbs.a.jS,u,this.k.cF());n.Subject=r;if(this.k.bk.Sender){var t=new _a.j;t.c(this.k.bk.Sender.Mailbox);n.ToRecipients=_db.f.a(t)}return}var i;_db.f.d(this.j.I(),i={val:this.bz},this.bq),this.bz=i.val;n.Importance=this.j.bM();this.j.m()&&this.j.m().b()>0&&(n.ToRecipients=_db.f.a(this.j.m()));this.j.o()&&this.j.o().b()>0&&(n.CcRecipients=_db.f.a(this.j.o()));this.j.v()&&this.j.v().b()>0&&(n.BccRecipients=_db.f.a(this.j.v()));n.Sensitivity=this.j.bR();n.IsDeliveryReceiptRequested=this.j.bk.IsDeliveryReceiptRequested;n.IsReadReceiptRequested=this.j.bk.IsReadReceiptRequested;this.j.I()&&(n.Body=new _g.s(this.j.I().a()==="HTML"?"HTML":"Text",this.j.I().bk.Value));n.Subject=this.j.bk.Subject}};_mcp.bs=function(n,t){_mcp.bs.initializeBase(this);this.f=n;this.c=t};_mcp.bs.prototype={f:null,c:null,i:null,K:function(n){var t=new _gg.sv(this.L);n.bi(this.f,this.c,t,this.I,this.G)},cT:function(n,t,i){this.i=n;t()}};_mcp.T=function(){this.f=Function.createDelegate(this,this.j);_mcp.T.initializeBase(this);if(!model)throw Error.argumentNull("model");this.c=model};_mcp.T.a=function(n){_a.b.b(n,"UserAgent shouldn't be null.");return n.q()?_nbs.a.Vo:n.r()?_nbs.a.Gv:n.e()?_nbs.a.qq:_nbs.a.Zz};_mcp.T.prototype={c:null,a:null,bb:function(){try{var n=_a.bk.a();var t=n.b("MOWA.IsSignatureChanged")==="true"?!0:!1;this.c.a(t?Boolean.parse(n.b("MOWA.AutoAddSignature")):!0);this.c.c(t?n.b("MOWA.SignatureText"):_mcp.T.a(_a.l.a()));this.c.e(t?Boolean.parse(n.b("MOWA.UseDesktopSignature")):!1);this.a=new _h.cc;this.a.d(this.f);_a.g.a.a(this.a)}catch(i){this.i(i)}return 1},k:function(){this.W(null)},i:function(n){this.W(n)},j:function(n){this.c.b(this.a.c.UserOptions.SignatureText);this.k()}};_mcp.be=function(n,t){_mcp.be.initializeBase(this);this.c=n;this.f=t};_mcp.be.prototype={c:null,i:null,f:"EwsLegacyId",j:function(){return this.i},K:function(n){var i=new _gg.ej(this.f);i.DestinationFormat=this.f;i.SourceIds=new Array(this.c.length);for(var t=0;t<this.c.length;t++){var f=new _gg.bi(this.c[t].Format,this.c[t].Id,this.c[t].Mailbox);i.SourceIds[t]=f}var u=new _gg.ei(this.M(),i);var r=new _gg.oo(this.L);n.Z(u,r,this.I,this.G)},cJ:function(n){this.i=n.AlternateId}};function MailComposeComponent(){}MailComposeComponent.$$cctor=function(){_a.u.a().a(MailComposeComponent)};MailComposeComponent.a=function(n,t,i){var o=n==="Mouse";var s=!(t.a()&&t.d().b()<9);var r=i.c().bk.UserCulture;var e=!!r&&r.startsWith("en");var f=!!i.i()&&i.i().bk.CheckForForgottenAttachmentsEnabled;var u=!!i.a()&&i.a().bk.CheckForForgottenAttachments;return o&&f&&u&&s&&e};MailComposeComponent.prototype={a:function(n,t,i){var y=this;n.b(_mcp.L,function(){return new _mcp.L(n.a(_a.B),n.c(ICancelCalendarItemActionFactory),n.a(_j.j))}).b(IMailComposeActionFactory).a();var p=this;n.b(_mcp.bo,function(){return new _mcp.bo(n.a(IInferenceTracker),n.a(_g.a),n.a(IMailComposeContextFactory),n.a(_mcp.L),n.c(ISmimeCommandFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory))}).b(IMailResponseViewModelFactory).a();var w=this;n.b(_mcp.bj,function(){return new _mcp.bj(n.a(_y.dH),n.a(_a.B))}).b(IMailComposeContextFactory).a();var o=n.a(_j.o);var e=n.a(_g.e);var u=MailComposeComponent.a(i.a(),o,e);var f=n.a(_a.f);var r=i.a()==="Mouse"&&_g.a.a().bk.AsyncSendEnabled;var d=this;n.b(_mcp.A,function(){return new _mcp.A(n.a(_a.t),n.a(_j.j),n.a(_g.e))}).a();var k=this;n.b(_mcp.bl,function(){return new _mcp.bl(n.c(IExtensibilityViewModelFactory),n.a(_rw.i),u?n.c(IForgottenAttachmentDetectorFactory):null,n.c(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.L),n.a(_pe.e),n.a(_y.a),n.c(IOfflineHelpProvider),n.a(_mcp.E),n.a(_y.K),n.a(_j.j),n.c(IAttachmentWellViewModelFactory),f,n.a(_a.B),n.d(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.cm),n.a(_a.C),n.c(IMailTipsHandlerFactory),n.c(IPeopleRecommendationsHandlerFactory),n.c(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.L):null,r?n.c(ISendNotificationProviderViewModel):null,r?n.c(ISendFailureNotificationProviderViewModel):null,n.c(IFindRecipientMailComposeViewModelFactory),n.d(IComponentOverrideFactory),n.a(_g.a).bk.AttachmentPolicy,n.c(IIntroductionControllerFactory),n.d(ILinkPreviewBuilderFactory),n.c(IToPeoplePickerViewModelFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory),n.c(ILocationViewModelFactory),n.c(IExtensibilityEntryPointCollection),n.c(IEntitySuggestionManager),n.c(IModernGroupCardViewModelFactory),n.a(_g.a).a(),n.a(_j.o),i,n.a(_y.r),n.a(_h.ba),n.a(_mcp.A),i.a()==="TouchNarrow"?n.a(_y.q):null,n.c(IAtMentionsHandler),n.c(IConsensusSchedulingViewModelFactory),n.c(IEmojiProcessor),n.c(IInfoBarNotificationsManager))}).b(IMailComposeViewModelFactory).a();var b=this;n.b(_mcp.bm,function(){return new _mcp.bm(n.c(IExtensibilityViewModelFactory),n.a(_rw.i),u?n.c(IForgottenAttachmentDetectorFactory):null,n.c(IRichPeoplePickerViewModelFactory),n.a(IMailComposeContextFactory),n.a(_mcp.L),n.a(_pe.e),n.a(_y.a),n.c(IOfflineHelpProvider),n.a(_mcp.E),n.a(_y.K),n.a(_j.j),n.c(IAttachmentWellViewModelFactory),f,n.a(_a.B),n.d(IAttachmentsFilePickerPanelViewModel),n.a(IInferenceTracker),n.a(_g.cm),n.a(_a.C),n.c(IMailTipsHandlerFactory),n.c(IPeopleRecommendationsHandlerFactory),n.c(IPolicyTipsHandlerFactory),i.a()==="Mouse"?n.a(_cmc.L):null,r?n.c(ISendNotificationProviderViewModel):null,r?n.c(ISendFailureNotificationProviderViewModel):null,n.c(IFindRecipientMailComposeViewModelFactory),n.d(IComponentOverrideFactory),n.a(_g.a).bk.AttachmentPolicy,n.c(IIntroductionControllerFactory),n.d(ILinkPreviewBuilderFactory),n.c(IToPeoplePickerViewModelFactory),n.c(IGetCalendarItemActionFactory),n.c(ICalendarTimeConverterFactory),n.c(ILocationViewModelFactory),n.c(IExtensibilityEntryPointCollection),n.c(IEntitySuggestionManager),n.c(IModernGroupCardViewModelFactory),n.a(_g.a).a(),n.a(_j.o),i,n.a(_y.r),n.a(_h.ba),n.a(_mcp.A),i.a()==="TouchNarrow"?n.a(_y.q):null,n.c(IAtMentionsHandler),n.c(IConsensusSchedulingViewModelFactory),n.c(IEmojiProcessor),n.c(IInfoBarNotificationsManager))}).b(IMailInlineComposeViewModelFactory).a();var c=this;n.b(_mcp.E,function(){return new _mcp.E(n.a(IMailComposeActionFactory))}).b(IMailComposeDiscardManager).a();var h=this;n.b(_mcp.U,function(){return new _mcp.U(n.a(_y.a),n.a(_j.u),n.a(_g.e),n.a(_j.j),n.a(IMailComposeViewModelFactory))}).a();var s=this;n.b(_mcp.m,function(){return new _mcp.m(window.document.createElement("div"),i.a(),n.a(_j.o),n.a(_a.B),n.a(_a.f),n.a(_j.j),n.a(_a.C),n.a(_b.d))});var v=this;n.b(_mcp.o,function(){return new _mcp.o(window.document.createElement("div"),i.a(),n.a(_j.o),n.a(_a.B),n.a(_a.f),n.a(_j.j),n.a(_a.C),n.a(_b.d))});var a=this;n.b(_mcp.S,function(){return new _mcp.S(window.document.createElement("div"),i.a(),n.a(_j.o),n.a(_a.B),n.a(_a.f),n.a(_j.j),n.a(_a.C),n.a(_b.d),!0)});var l=this;n.b(_mcp.V,function(){return new _mcp.V(n.d(IPopOutHelper),i.a())}).a();_a.n.a(_a.bF.e)},b:function(){return[new _j.w(_mcp.V,1,1),new _j.w(_mcp.A,1,73),new _j.w(_mcp.U,4,1)]}};_mcp.U=function(n,t,i,r,u){this.h=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.n);this.j=n;this.f=t;this.l=i;this.c=r;this.d=u;this.c.b(IDelayedSendEvent,this.g);this.c.b(_cmc.br,this.h)};_mcp.U.prototype={j:null,f:null,l:null,c:null,d:null,a:null,b:null,n:function(n){_j.s.a(n.a(),"SendEvent.DelayedSendCallback is null.");_j.s.a(n.b(),"SendEvent.MailComposeContext is null.");var u=n.c()*1e3;var t=n.b();var f=n.a();var i=this,o=this;var r=new _mcp.bx(this.c,u,function(){_j.e.a(_a.a.a,"UndoDelayedSendAction.undoDelegate - cancelling the queued delayed-send task.");_g.i.isInstanceOfType(t.P())&&_h.c.A(t.P(),!1);i.k()||_j.e.b(_a.a.a,"TryCancelQueuedTask failed on undo delayed send. Continuing to navigate to the draft.");_j.e.a(_a.a.a,"UndoDelayedSendAction.undoDelegate - popping the cancelled undo action from the undo stack.");i.e();i.o(t)},function(){_j.e.a(_a.a.a,"UndoDelayedSendAction.flushDelegate - cancelling the queued delayed-send task.");if(o.k()){_j.e.a(_a.a.a,"Flushing the delayed-send task by firing the send callback.");f()}});_j.e.a(_a.a.a,"HandleDelayedSendEvent - pushing the undo action to the undo stack.");this.q(r);_j.e.a(_a.a.a,"HandleDelayedSendEvent - queueing the delayed-send task.");var e=this;this.a=_j.n.a().a(_a.a.a,"SubmitDelayedComposeAction",function(){e.m(f,r)},u)},m:function(n,t){_j.e.a(_a.a.a,"DelayedSendTaskDelegate - executing the delayed-send task callback.");t.a();this.a=null;if(t===this.b){_j.e.a(_a.a.a,"DelayedSendTaskDelegate - action flushed; now popping the action from the undo stack.");this.e()}},k:function(){_j.e.a(_a.a.a,"TryCancelQueuedTask - attempting to cancel the queued delayed-send task...");var n=!1;if(this.a){this.a=this.f.b(this.a);_j.e.a(_a.a.a,"TryCancelQueuedTask - delayed-send task has been cancelled.");n=!this.a}else _j.e.b(_a.a.a,"TryCancelQueuedTask- queuedTaskHandle is null on flush, skipping...");return n},o:function(n){_j.e.a(_a.a.a,"NavigateToDelayedMessage - navigating to the cancelled draft message.");n.g(!1);var t=this.d.a(n,null,null);t.cc=!1;t.ce=!1;t.bn().c(new _y.bm);var i=this;t.j(function(){t.dispose()});t.bn().b().a()},p:function(n){this.i()},q:function(n){this.i();this.b=n},i:function(){var n=this.e();n&&n.a()},e:function(){var n=this.b;this.b=null;return n}};_mcp.V=function(n,t){if(t==="Mouse"){var i=this;n.d(function(n){n.a(_mcp.b,"MailComposeContext")},!1)}};_mcp.A=function(n,t,i){this.e=Function.createDelegate(this,this.i);this.f=Function.createDelegate(this,this.j);_mcp.A.initializeBase(this);this.d=n;this.h=t;this.c=i.a();this.a=0;var r=this.c.bk.SignatureHtml;r===""||r||this.k()};_mcp.A.prototype={d:null,h:null,c:null,a:0,b:null,k:function(){this.b=new _cmc.g(_a.a.a,"MailComposeSigPreload",!1);this.a=1;var n=new _mcp.bu;n.d(this.f);n.e(this.e);this.d.a(n)},j:function(n){this.c.bG(n.c.bk.SignatureHtml);this.c.bH(n.c.bk.SignatureText);this.a=2;this.eu("CurrentStatus");this.g(n,!1)},i:function(n){this.a=3;_j.e.b(_a.a.a,"SignaturePreloadService.OnPreloadFailed - error: '{0}'",n.J?n.J.message:"");this.eu("CurrentStatus");this.g(n,!0)},g:function(n,t){if(this.b)if(t){this.b.k(n.O());this.b.d(n.P(),null)}else this.b.b()}};_mcp.bw=function(){};_mcp.bv=function(n){_mcp.bv.initializeBase(this);this.f=n;this.k=_a.a.bF;this.i="GetSuggestedGroupsFromRecipientsAction"};_mcp.bv.prototype={c:null,n:0,j:!1,f:null,i:null,k:null,K:function(n){var i=new _gg.kh(this.M());var t=new _gg.yX(this.L);t.actionName="GetSuggestedGroupsFromRecipientsAction";i.Body.Recipients=this.f;_a.n.b(this.k,this.i,!0);n.fP(i,t,this.I,this.G)},cT:function(n,t,i){try{if(n.Body.ResponseCode==="NoError"){this.c=n.Body.SuggestedUnifiedGroups;this.n=n.Body.SuggestedUnifiedGroupCount;this.j=n.Body.ShouldCreateNewGroup;this.l(null);t()}else{var r=Error.create("GetSuggestedGroupsFromRecipientsAction: group suggestions could not be retrieved.ResponseCode: "+n.Body.ResponseCode+"."+"MessageText: "+n.Body.MessageText+".");this.l(r);i(r)}}catch(u){this.l(u);i(u)}},l:function(n){var i=null;n&&(i=n.message?n.message:n.name?n.name.toString():"UnknownError");var r=_a.n.c(this.i);if(r){var t=new _a.o;this.f&&t.a("rc",this.f.length);if(this.c){t.a("sgc",this.c.length);if(this.c[0].TopRelevantMembers){t.a("sgmc",this.c[0].TopRelevantMembers.length);t.a("mrp",this.c[0].TopRelevantMembers.length*100/this.f.length)}}this.j?t.c("scng",!0):t.c("scng",!1);r.j=t.toString();r.k=i;r.l=this.O();_a.n.a(this.i)}}};_mcp.bx=function(n,t,i,r){this.p=Function.createDelegate(this,this.a);this.l=n;this.o=i;this.n=r;var u=this;this.l.a(_a.bj,new _a.bj(11,_u.P.a,_u.P.t,_u.P.L,this.p,function(){u.g()}))};_mcp.bx.prototype={l:null,o:null,n:null,m:!1,toString:function(){return _u.n.ME},g:function(){this.m=!0;this.o();this.m=!1;this.k();return!0},a:function(){this.n();this.l.a(_a.bj,new _a.bj(13,"","","",null,null))},j:function(){this.l.a(_a.bj,new _a.bj(4,"","","",null,null))},k:function(){this.l.a(_a.bj,new _a.bj(12,"","","",null,null))},f:function(){return this.m},c:function(){return null},e:function(n){return!1},d:function(n){return!1},b:function(n){return!0},i:function(n){},h:function(){}};_mcp.C=function(n){_mcp.C.initializeBase(this);this.c=n};_mcp.C.prototype={c:null,K:function(n){var i=this.f();var t=new _gg.sw(this.L);t.explicitLogonUser=this.c.D();this.c.c()&&!t.actionName&&(t.actionName=this.c.c());n.dK(i,t,this.I,this.G)},f:function(){var t=this.c.k();var i=new _gg.hL(this.M());var n=new _gg.ep;n.Items=t.Items;n.ItemShape=t.ItemShape;n.ShapeName=t.ShapeName;n.SubjectPrefix=t.SubjectPrefix;n.ClientSupportsIrm=t.ClientSupportsIrm;n.ComplianceId=t.ComplianceId;n.ComposeOperation=t.ComposeOperation;n.IsNonDraft=t.IsNonDraft;n.MessageDisposition=t.MessageDisposition;n.OutboundCharset=t.OutboundCharset;n.SavedItemFolderId=t.SavedItemFolderId;n.SendOnNotFoundError=t.SendOnNotFoundError;n.ShouldSuppressReadReceipt=t.ShouldSuppressReadReceipt;n.UseGB18030=t.UseGB18030;n.UseISO885915=t.UseISO885915;n.TimeFormat=t.TimeFormat;i.Body=n;return i},ba:function(n){_h.fa.prototype.ba.call(this,n)},cJ:function(n){this.c.s(n)}};_mcp.bt=function(){_mcp.bt.initializeBase(this)};_mcp.bt.prototype={c:null,f:null,i:null,K:function(n){var i=new _gg.eV(this.M());var t=new _gg.oE(200);n.x(i,t,this.I,this.G)},cT:function(n,t,i){if(n.Options){this.c=n.Options.EmailAddresses;this.f=n.Options.NotManagedEmailAddresses;this.i=n.Options.SendEnabledConnectedAccounts;t&&t()}else!_j.i.a(n.ErrorMessage)&&i&&i(Error.create(n.ErrorMessage))}};_mcp.bu=function(){_mcp.bu.initializeBase(this)};_mcp.bu.prototype={c:null,K:function(n){var t=new _gg.oJ(this.L);n.z(t,this.I,this.G)},cT:function(n,t,i){this.c=new _gg.h(n.Options);t()}};var IMailComposeOverridable=function(){};IMailComposeOverridable.registerInterface("IMailComposeOverridable");_mcp.bk=function(){};_mcp.bk.a=function(n){var t=null;_db.f.isInstanceOfType(n)?t=n.F:_mco.b.isInstanceOfType(n)?t=n.bn:_mcp.C.isInstanceOfType(n)&&(t=n.c.f());return t};_mcp.N=function(n,t,i,r){_mcp.N.initializeBase(this,["AddOriginalAttachmentInfoBarView"]);this.a=n;this.d=t;this.b=new _j.g(i,_a.a.a);this.c=new _j.g(r,_a.a.a)};_mcp.N.prototype={d:0,a:null,f:function(){return this.a.length===1?String.format(_u.R.LE,this.a[0].Name):String.format(_u.n.PQ,this.a.length)},e:function(){return this.d>1?_u.n.CR:_u.n.Cb},b:null,c:null};_mcp.bU=function(n,t,i){this.e=n;this.f=t;this.d=i};_mcp.bU.prototype={e:0,c:function(){return this.e},f:null,b:function(){return this.f},d:null,a:function(){return this.d}};_mcp.bV=function(){};_mcp.bX=function(n,t){this.c=n;this.d=t};_mcp.bX.prototype={c:null,d:null,a:function(){return this.c},b:function(){return this.d}};_mcp.bq=function(n){this.a=n};_mcp.bq.prototype={a:null};_mcp.ca=function(n){this.b=n};_mcp.ca.prototype={b:null,a:function(){return this.b}};_mcp.R=function(n,t,i,r){this.g=n;this.e=t;this.h=i;this.f=r};_mcp.R.prototype={g:!1,e:null,h:!1,f:null,c:function(){return this.g},a:function(){return this.e},d:function(){return this.h},b:function(){return this.f}};_mcp.br=function(n){this.b=n};_mcp.br.prototype={b:!1,a:function(){return this.b}};_mcp.cb=function(n){this.b=n};_mcp.cb.prototype={b:null,a:function(){return this.b}};_mcp.L=function(n,t,i){this.f=n;this.j=t;this.g=i};_mcp.L.prototype={f:null,j:null,g:null,h:function(n,t){var i=n.ba;var u=i.a();var s=3===u||2===u||1===u;var e=this.f.b()&&i.i();(n.bQ().j()||i.dr()&&(i.dj()||n.bh().l()>0))&&(e=!!(e&i.bk()));var f=null;if(s&&!e||14===i.a())f=this.l(i,t);else if(i.bs()){_j.e.a(_a.a.a,"Creating UpdateMessageForComposeAction; disposition={0}",t);var h=this.m(t,i);f=h}else if(8===i.a()){_j.e.a(_a.a.a,"Creating CancelCalendarItemAction; disposition={0}",t);f=this.o(i,t)}else if(u!==5&&u!==6&&u!==7)if(u===9||u===10){_j.e.a(_a.a.a,"CreateComposeAction: ApprovalRequestAction");f=this.n(i,t)}else{_j.e.a(_a.a.a,"Creating CreateMessageForComposeAction; disposition={0}",t);var r=null;if(u===11||u===12){r=new _mco.a(i.bx(!1),i.bK(),this.f,this.g);r.u=0}else{var o=this.k(i);r=new _mco.a(o,null,this.f,this.g);r.u=t}r.bq=!this.f.b();i.u()&&(r.bA=i.u());r.cg=i.bS(100);r.ch=_y.l.toString(i.a());r.bS=i.bP();r.bU=i.T();f=r}f.X=i.b();return f},i:function(n,t,i){var r=new _h.cv(200,n);r.i=t||_h.b.e();r.q=_j.t.a(i)?"MailCompose":i;return r},a:function(n,t){var r=t?"HardDelete":"MoveToDeletedItems";return new _db.cp([n],r,2)},d:function(n,t){var r=null;r=n.S()?n.bx(!0):n.A(!0);var i=this.c(n,r);i.bo=t;i.bB=!this.f.b()&&n.l()==="HTML"?"MailComposeNormalizedBody":"MailCompose";i.cc=_g.a.a().a().bk.TimeFormat;return i},o:function(n,t){var i=null;var r=this;this.j.b(function(t){i=t.a(n.E(),1,n.df());i.k(n.A(!1));n.u()&&i.j(n.u())});return i},c:function(n,t){var r=n.cr()?new _db.r(n.E()):n.E();var i=null;i=new _mco.c(this.q(n.a()),r,this.f,this.g);i.bE(t);i.by=n.dl();i.bq=!this.f.b();n.u()&&(i.bA=n.u());i.bk=n.bh();i.bx=n.dm();i.X=n.b();n.e()&&_g.i.isInstanceOfType(n.e())&&n.e().bk.IsReadReceiptRequested&&(i.bO=!0);switch(n.a()){case 1:case 2:i.bV=_u.n.Pl;break;case 3:i.bV=_nbs.a.Zf;break}return i},e:function(n,t,i){return new _mco.b(n,t,i)},b:function(n,t,i){var r;r=_g.bt.isInstanceOfType(n)?this.p(n,this.f):new _mco.a(n,null,this.f,this.g);return r},l:function(n,t){var r;_j.e.a(_a.a.a,"Creating CreateResponseAction; layout={0}; disposition={1}",_y.c.a.a(),t);var f=n.A(!1);var i=this.c(n,f);i.u=t;i.cg=n.bS(100);i.ch=_y.l.toString(n.a());i.bS=n.bP();i.bU=n.T();if(n.bp()){var u=new _mcp.C(i);r=u}else r=i;return r},k:function(n){return n.A(!1)},m:function(n,t){var i=null;if(t.S()){i=new _mco.b(t.bx(!1),this.f,this.g);i.bl=_g.n.c(t.bK());i.u=0}else{i=new _mco.b(t.A(!1),this.f,this.g);i.u=n}i.bW=!this.f.b();i.bu=t.bP();i.bx=t.T();t.u()&&(i.bc=t.u());i.bU=t.bS(100);i.bo="AlwaysOverwrite";i.by=_y.l.toString(t.a());return i},q:function(n){switch(n){case 1:return new _g.bN;case 2:return new _g.bv;case 3:return new _g.bJ;case 12:return new _g.eG;case 14:return new _g.dH;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.l.toString(n));}},n:function(n,t){var r=n.e();var i=new _mcp.M(r,n.A(!1),n.a()===9,t);i.bq=!this.f.b();return i},p:function(n,t){var r=_mco.c.a(n);var i=new _mco.c(r,n.bk.ReferenceItemId,this.f,this.g);i.bq=!t.b();i.bE(n);i.by=n.n();i.bO=!0;return i}};_mcp.bj=function(n,t){this.d=n;this.c=t};_mcp.bj.prototype={c:null,d:null,a:function(n,t){var i=new _mcp.b;if(this.c){i.ee(this.c.b());i.ee(this.c.b())}i.t(n?0:this.d.a());return i},b:function(n,t,i,r){var u=this.a(!1,!1);u.t(this.d.a());u.d(4);u.g(!1);u.L(n);u.dU(t);r&&!r.a()?u.n(r.h()):u.n(i===1?"Text":"HTML");return u}};_mcp.bl=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi){_a.b.b(k,"nativeBridge");this.A=n;this.O=t;this.D=i;this.P=r;this.Z=u;this.i=f;this.M=e;this.e=o;this.K=s;this.x=h;this.N=c;this.y=l;this.c=v;this.d=y;this.B=p;this.s=a;this.F=w;this.u=b;this.J=k;this.n=d;this.o=g;this.p=nt;this.w=tt;this.R=it;this.Q=rt;this.C=ut;this.T=ft;this.r=et;this.H=ot;this.I=st;this.U=ht;this.l=ct;this.k=lt;this.m=at;this.z=vt;this.f=yt;this.g=pt;this.h=wt;this.V=bt;this.t=kt;this.E=dt;this.L=gt;this.S=ni;this.j=ti;this.q=ii;this.v=ri;this.X=ui;this.G=fi};_mcp.bl.prototype={z:null,A:null,O:null,D:null,P:null,Z:null,i:null,y:null,M:null,e:null,K:null,x:null,N:null,c:null,d:null,B:null,U:null,s:null,u:null,F:null,w:null,J:null,n:null,o:null,p:null,R:null,Q:null,C:null,T:null,r:null,H:null,I:null,l:null,k:null,m:null,V:null,t:null,E:null,L:null,S:null,j:null,q:null,v:null,X:null,G:null,f:null,g:null,h:null,b:function(n,t,i){return this.ba(n,null,t,i)},a:function(n,t,i){return this.W(n,null,t,i)},ba:function(n,t,i,r){var u=this.Z.a(!1,!1);u.gR(n);return this.W(u,t,i,r)},W:function(n,t,i,r){var u=null;u=this.e.a()==="Mouse"&&this.c&&this.c.a().e().Enabled?new _mcp.v(n,t,this.A,this.O,this.D,this.P,this.M,this.e,this.K,this.x,this.N,this.y,this.s,this.c,this.d,this.B,this.F,this.u,this.J,this.i,i,r,this.n,this.o,this.p,this.w,this.R,this.Q,this.C,this.T,this.r,this.H,this.I,this.U,this.l,this.k,this.m,this.z,this.f,this.g,this.h,this.V,this.t,this.E,this.L,this.S,this.j,this.q,this.v,this.X,this.G):new _mcp.e(n,t,this.A,this.O,this.D,this.P,this.M,this.e,this.K,this.x,this.N,this.y,this.s,this.c,this.d,this.B,this.F,this.u,this.J,this.i,i,r,this.n,this.o,this.p,this.w,this.R,this.Q,this.C,this.T,this.r,this.H,this.I,this.U,this.l,this.k,this.m,this.z,this.f,this.g,this.h,this.V,this.t,this.E,this.L,this.S,this.j,this.q,this.v,this.X,this.G);u.cB();return u}};_mcp.bm=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi){_mcp.bm.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi])};_mcp.bm.prototype={W:function(n,t,i,r){var u=new _mcp.j(n,t,this.A,this.O,this.D,this.P,this.M,this.e,this.K,this.x,this.N,this.y,this.s,this.c,this.d,this.B,this.F,this.u,this.J,this.i,i,r,this.n,this.o,this.p,this.w,this.R,this.Q,this.C,this.T,this.r,this.H,this.I,this.U,this.l,this.k,this.m,this.z,this.f,this.g,this.h,this.V,this.t,this.E,this.L,this.S,this.j,this.q,this.v,this.X,this.G);u.cB();return u}};_mcp.P=function(n,t,i,r,u,f,e,o){this.i=Function.createDelegate(this,this.G);this.j=Function.createDelegate(this,this.I);this.r=Function.createDelegate(this,this.J);_mcp.P.initializeBase(this,["GroupCreateSuggestionInfoBarView"]);this.k=new _j.g(n,_a.a.a);this.l=new _j.g(this.r,_a.a.a);this.m=t;this.b=i;this.e=r;this.q=u;this.v(f);this.c=e;this.p=o;this.b.b(ICreateGroupInGroupSuggestionEvent,this.j);this.b.b(ICreateGroupCompleteInGroupSuggestionEvent,this.i)};_mcp.P.prototype={a:null,m:null,p:null,b:null,h:!1,g:!0,f:!1,n:!1,o:!0,d:!1,c:null,e:null,q:null,C:function(){this.a||(this.a=new _mcp.K(this.m,this.b,this.e,this.q,this.p));return this.a},w:function(n){if(this.h!==n){this.h=n;this.eu("IsCreatingGroupStatus")}return n},t:function(n){if(this.g!==n){this.g=n;this.eu("BeforeCreateGroupStatus")}return n},s:function(n){if(this.f!==n){this.f=n;this.eu("AfterCreateGroupStatus");this.eu("AfterCreateGroupText")}return n},I:function(n){this.w(!0);this.t(!1);this.s(!1);var t=this;_j.n.a().a(_a.a.X,"GroupCreationSuggestion",function(){t.F()},12e3)},G:function(n){this.o=n.a();this.w(!1);this.t(!1);this.s(!0)},F:function(){this.n=!0;this.eu("CreatingGroupText")},A:function(){return this.n?_nbs.a.aW:_nbs.a.jM},x:function(){return this.o?_nbs.a.KL:_nbs.a.gA},E:function(){return this.d?String.format(_nbs.a.qH,this.c.DisplayName):_nbs.a.NQ},v:function(n){if(this.d!==n){this.d=n;this.eu("HasExistingGroup");this.eu("InfoBarText")}return n},K:function(){this.eu("InfoBarText");this.a&&this.a.C()},l:null,J:function(){var r=this.e.b(0);var n=new _g.f;n.Name=this.c.DisplayName;n.EmailAddress=this.c.SmtpAddress;n.MailboxType="GroupMailbox";var u=r.l(n);u.E(!0);var t=this.c.TopRelevantMembers;if(t)for(var i=0;i<t.length;i++)r.i(t[i].EmailAddress.EmailAddress);_a.d.c(_a.a.bF,"GroupSuggestionOnCompose_ClickReplaceWithGroupLink")},ex:function(){this.e=null;var n;_a.h.a(n={val:this.a}),this.a=n.val;this.b.c(ICreateGroupInGroupSuggestionEvent,this.j);this.b.c(ICreateGroupCompleteInGroupSuggestionEvent,this.i);_a.jb.prototype.ex.call(this)},k:null,y:function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.c,"ms-fcl-ns-b")},z:function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.c,"ms-fcl-nd-b")}};_mcp.K=function(n,t,i,r,u){this.j=Function.createDelegate(this,this.y);_mcp.K.initializeBase(this);var f=this;this.n=new _j.g(function(){f.a(!1)},_a.a.a);this.k=n;this.h=t;this.e=i;this.m=r;this.l=u;this.h.b(ICreateGroupInGroupSuggestionEvent,this.j);this.q()};_mcp.K.prototype={f:!1,n:null,k:null,d:null,i:!0,s:"http://groups.outlook.com/",h:null,e:null,m:null,l:null,c:null,q:function(){var n=this;this.k.a(function(t){if(!n.d&&n.e){n.z(t.d(n.l,n.e.b(0).f()));n.A(!1)}})},z:function(n){this.d=n;this.eu("GroupCreationViewModel");return n},t:function(){this.c&&this.r();this.c=new _j.l;for(var e=this.e.t(),u=this.e.e(),f=Math.min(6,u),n=0;n<f;n++){var t=_h.i.a(e.d[n]);var i=1;var r=this.m.a(t,2,!1,i,!1,!1);this.c.a(r)}return this.c},x:function(){return this.e.e()>6?!0:!1},w:function(){var n=this.e.e()-6;n=n>0?n:0;return String.format(_nbs.a.fr,n)},v:function(){return this.i||!this.d},A:function(n){if(this.i!==n){this.i=n;this.eu("IsCreateGroupPaneLoading")}return n},C:function(){this.eu("GroupMemberPersonas");this.eu("ShowPersonasTotalNumber");this.eu("PersonasTotalNumber")},y:function(n){this.a(!1)},ex:function(){this.e=null;var n;_a.h.a(n={val:this.d}),this.d=n.val;this.r();this.h.c(ICreateGroupInGroupSuggestionEvent,this.j);_a.jb.prototype.ex.call(this)},r:function(){if(this.c){for(var n=0;n<this.c.x.length;n++){var r=this.c.x[n];var i;_a.h.a(i={val:r}),r=i.val}var t;_a.h.a(t={val:this.c}),this.c=t.val}},b:function(){return this.f},a:function(n){if(this.f===n)return n;if(n){var t;_a.h.a(t={val:this.d}),this.d=t.val;this.q();_a.d.c(_a.a.bF,"GroupSuggestionOnCompose_ClickCreateGroupLink")}this.f=n;this.eu("IsShown");return n},o:function(){return 431},p:function(){return 320},g:function(){return!0}};_mcp.bi=function(){_mcp.bi.initializeBase(this)};_mcp.bi.prototype={b:null,a:null,d:function(n){if(this.b!==n){this.b=n;this.eu("Description")}return n},c:function(n){if(this.a!==n){this.a=n;this.eu("ConversationOwner")}return n}};_mcp.Z=function(n){this.e=Function.createDelegate(this,this.i);_mcp.Z.initializeBase(this);this.b=_a.g.a;this.c=n};_mcp.Z.prototype={c:null,b:null,a:function(n,t,i,r){t&&n.d(t);n.e(i||this.e);r&&n.b(r);this.b.a(n)},f:function(n,t){var i=_nbs.a.Nc;this.g(n,i,null,i,null,t)},h:function(n,t,i,r,u,f){var e=t;var o=n.J;if(o){if(_g.Q.a(o)){var h=o;if(h.ErrorCode===503){_j.e.a(_a.a.a,"GetErrorMessage returning service unavailable {0} since the specified exception was a service unavailable json fault body",_u.R.Dh);e=_u.R.Dh}else if(h.ErrorCode===408&&u){_j.e.a(_a.a.a,"GetErrorMessage returning request timeout {0} since the specified exception was a request timeout json fault body",u);e=u}else if(_g.Q.c(h)&&i){_j.e.a(_a.a.a,"GetErrorMessage returning disconnected {0} since the specified exception was a disconnected json fault body",i);e=i}}if(e===t){var s=_a.b.l(o);s?r&&s==="ErrorItemNotFound"?e=r:s==="ErrorAccessDenied"?e=_u.R.DR:f&&s==="ErrorQuotaExceeded"?e=f:_j.e.a(_a.a.cl,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not one of the specific jsonFaultBody or response code exceptions we are currently looking for"):_j.e.b(_a.a.cl,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not a JsonFaultBody exception or an exception with response code. The exception.Message was "+o.message)}}else _j.e.a(_a.a.a,"GetErrorMessage returning default message {0} since the exception was null",t);_j.e.a(_a.a.a,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},g:function(n,t,i,r,u,f){var e=this.h(n,t,i,r,u,null);this.c.g(0,e,f)},i:function(n){this.f(n,null);this.d(n)},d:function(n){this.bN("MailComposeActionFailed",n)}};_mcp.b=function(){this.ft=Function.createDelegate(this,this.gB);this.s=this.G;this.cW=this.z;this.cU=this.C;this.cV=this.bC;this.et=this.l;this.es=this.p;_mcp.b.initializeBase(this);this.n("Html"===_g.a.a().a().m()?"HTML":"Text");this.apcl(_mcp.b.b.a,this.ft);this.apcl(_mcp.b.i.a,this.ft);if(_a.p.a&&_a.p.d()){this.ej(_g.a.a().a().bk.SmimeEncrypt);this.el(_g.a.a().a().bk.SmimeSign)}this.fa=-1;this.eM={};this.eQ={}};_mcp.b.$$cctor=function(){_mcp.b.m.b(new _a.bv(_g.f));_mcp.b.g.b(new _a.bv(_g.f));_mcp.b.f.b(new _a.bv(_g.f));_mcp.b.l.b(new _a.bv(_pc.a));_mcp.b.d.b(new _a.bv(_g.Attachment));_mcp.b.h.b(new _a.bv(_g.be));_mcp.b.e.b(new _a.bv(_db.d))};_mcp.b.bZ=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _j.i.a(u)?r:_j.t.b(n,u)};_mcp.b.bY=function(n,t,i){if(!(t in n))return i;var r=n[t];return _j.i.a(r)?i:Boolean.parse(r)};_mcp.b.bX=function(n){return!_j.i.b(_mcp.b.a)&&!_j.i.b(n)&&(_mcp.b.a===n||_mcp.b.a.toLowerCase()===n.toLowerCase())};_mcp.b.cc=function(n){return n.replace(_mcp.b.ca,"\r\n")};_mcp.b.prototype={fC:null,eR:null,eY:!1,fs:null,gx:function(n){this.ez("BeforeDraftUpdateEvent",n)},gY:function(n){this.eA("BeforeDraftUpdateEvent",n)},gw:function(n){this.ez("AfterDraftUpdateEvent",n)},gX:function(n){this.eA("AfterDraftUpdateEvent",n)},cX:function(n){this.ez("OnAsyncSendCallbackEvent",n)},dz:function(n){this.eA("OnAsyncSendCallbackEvent",n)},gy:function(n){this.ez("OnInitializingDraftContentEvent",n)},gZ:function(n){this.eA("OnInitializingDraftContentEvent",n)},gz:function(n){this.ez("OnPrepareQuotedBodyEvent",n)},ha:function(n){this.eA("OnPrepareQuotedBodyEvent",n)},fm:!1,dh:function(){return this.fm},cG:function(n){this.fm=n;return n},b:function(){return this.ew(_mcp.b.bT)},fK:function(n){this.ev(_mcp.b.bT,n);return n},a:function(){return this.ew(_mcp.b.b)},d:function(n){this.ev(_mcp.b.b,n);return n},k:function(){return this.ew(_mcp.b.j)},t:function(n){this.ev(_mcp.b.j,n);return n},E:function(){return this.ew(_mcp.b.bp)},cd:function(n){this.ev(_mcp.b.bp,n);return n},dl:function(){return this.ew(_mcp.b.bo)},ea:function(n){this.ev(_mcp.b.bo,n);return n},e:function(){this.eR||(this.eR=this.ew(_mcp.b.bq));return this.eR},cL:function(n){this.eR=n;this.ev(_mcp.b.bq,this.eR);return n},h:function(){return this.ew(_mcp.b.F)},L:function(n){if(this.h()&&n){this.h().Id=n.Id;this.h().ChangeKey=n.ChangeKey}else this.ev(_mcp.b.F,n);return n},bs:function(){return!!this.h()},be:function(){return!this.gf()},gH:function(){return this.ew(_mcp.b.bN)},hh:function(n){this.ev(_mcp.b.bN,n);return n},G:function(){return this.ew(_mcp.b.bO)},z:function(n){this.ev(_mcp.b.bO,n);return n},C:function(){return this.ew(_mcp.b.I)},w:function(n){this.ev(_mcp.b.I,n);return n},x:function(){return this.ew(_mcp.b.bB)},cM:function(n){this.ev(_mcp.b.bB,n);return n},de:function(){return this.ew(_mcp.b.H)},cC:function(n){this.ev(_mcp.b.H,n);return n},eP:null,bC:function(){return this.eP},dM:function(n){this.eP=n;return n},l:function(){return this.ew(_mcp.b.r)},n:function(n){this.ev(_mcp.b.r,n);return n},f:function(){return this.ew(_mcp.b.m)},q:function(n){this.ev(_mcp.b.m,n);return n},bO:function(){return this.ew(_mcp.b.l)},em:function(n){this.ev(_mcp.b.l,n);return n},bn:function(){return this.ew(_mcp.b.bP)},cP:function(n){this.ev(_mcp.b.bP,n);return n},j:function(){return this.ew(_mcp.b.g)},ba:function(n){this.ev(_mcp.b.g,n);return n},bg:function(){return this.ew(_mcp.b.t)},dD:function(n){this.ev(_mcp.b.t,n);return n},c:function(){return this.ew(_mcp.b.f)},bU:function(n){this.ev(_mcp.b.f,n);return n},N:function(){return this.ew(_mcp.b.q)},dC:function(n){this.ev(_mcp.b.q,n);return n},fZ:function(){return this.ew(_mcp.b.k)},g:function(n){this.ev(_mcp.b.k,n);return n},X:function(){return this.ew(_mcp.b.S)},dO:function(n){this.ev(_mcp.b.S,n);return n},dp:function(){return this.ew(_mcp.b.bx)},ff:function(n){this.ev(_mcp.b.bx,n);return n},gG:function(){return this.ew(_mcp.b.bG)},ei:function(n){this.ev(_mcp.b.bG,n);return n},bM:function(){return this.ew(_mcp.b.bI)},cN:function(n){this.ev(_mcp.b.bI,n);return n},ga:function(){return this.ew(_mcp.b.bJ)},ek:function(n){this.ev(_mcp.b.bJ,n);return n},fy:function(){return this.ew(_mcp.b.n)},cz:function(n){this.ev(_mcp.b.n,n);return n},fi:0,O:function(){return this.fi},bZ:function(n){this.fi=n;return n},eS:null,bz:function(){return this.eS},bT:function(n){this.eS=n;return n},eX:0,cu:function(){return this.eX},M:function(n){this.eX=n;return n},fU:function(){return this.ew(_mcp.b.Y)},eZ:function(n){this.ev(_mcp.b.Y,n);return n},bq:function(){return this.ew(_mcp.b.i)},fH:function(n){this.ev(_mcp.b.i,n);return n},br:function(){return this.ew(_mcp.b.bc)},fI:function(n){this.ev(_mcp.b.bc,n);return n},di:function(){return this.ew(_mcp.b.bj)},gn:function(n){this.ev(_mcp.b.bj,n);return n},fq:function(){return this.ew(_mcp.b.bn)},go:function(n){this.ev(_mcp.b.bn,n);return n},bE:function(){return this.ew(_mcp.b.P)},gj:function(n){this.ev(_mcp.b.P,n);return n},dg:function(){return this.ew(_mcp.b.U)},dQ:function(n){this.ev(_mcp.b.U,n);return n},m:function(){return this.ew(_mcp.b.L)},cD:function(n){this.ev(_mcp.b.L,n);return n},bt:function(){return this.ew(_mcp.b.bC)},ef:function(n){this.ev(_mcp.b.bC,n);return n},i:function(){return this.ew(_mcp.b.bm)},cJ:function(n){this.ev(_mcp.b.bm,n);return n},dr:function(){return this.ew(_mcp.b.bF)},hg:function(n){this.ev(_mcp.b.bF,n);return n},D:function(){return this.ew(_mcp.b.ba)},dT:function(n){this.ev(_mcp.b.ba,n);return n},bF:function(){return this.ew(_mcp.b.W)},fr:function(n){this.ev(_mcp.b.W,n);return n},R:function(){return this.ew(_mcp.b.V)},ca:function(n){this.ev(_mcp.b.V,n);return n},bL:function(){return this.ew(_mcp.b.bt)},ec:function(n){this.ev(_mcp.b.bt,n);return n},bK:function(){return this.ew(_mcp.b.bs)},eb:function(n){this.ev(_mcp.b.bs,n);return n},gE:function(){return!!this.cj()},cj:function(){return this.ew(_mcp.b.s)},cA:function(n){this.ev(_mcp.b.s,n);return n},cr:function(){return this.ew(_mcp.b.be)},cH:function(n){this.ev(_mcp.b.be,n);return n},df:function(){return this.ew(_mcp.b.K)},dK:function(n){this.ev(_mcp.b.K,n);return n},fT:function(){return this.ew(_mcp.b.T)},dP:function(n){this.ev(_mcp.b.T,n);return n},bD:function(){return this.ew(_mcp.b.O)},fF:function(n){this.ev(_mcp.b.O,n);return n},co:function(){return this.ew(_mcp.b.N)},dN:function(n){this.ev(_mcp.b.N,n);return n},bP:function(){return this.ew(_mcp.b.bQ)},cQ:function(n){this.ev(_mcp.b.bQ,n);return n},T:function(){return this.ew(_mcp.b.bR)},hi:function(n){this.ev(_mcp.b.bR,n);return n},bl:function(){return this.ew(_mcp.b.bk)},cI:function(n){this.ev(_mcp.b.bk,n);return n},P:function(){return this.ew(_mcp.b.G)},dI:function(n){this.gL();this.ev(_mcp.b.G,n);this.gK();return n},bf:function(){return this.ew(_mcp.b.o)},hc:function(n){this.ev(_mcp.b.o,n);return n},V:function(){return this.ew(_mcp.b.M)},cE:function(n){this.ev(_mcp.b.M,n);return n},p:function(){return this.ew(_mcp.b.d)},U:function(n){var i=null;if(n){i=new _j.l;for(var t=0;t<n.b();t++)i.a(n.c(t))}this.ev(_mcp.b.d,i);this.gu();return n},by:function(){return this.ew(_mcp.b.e)},dB:function(n){this.ev(_mcp.b.e,n);return n},gD:function(){return this.ew(_mcp.b.E)},hd:function(n){this.ev(_mcp.b.E,n);return n},J:function(){return this.ew(_mcp.b.bS)},eo:function(n){this.ev(_mcp.b.bS,n);return n},eJ:function(){return this.ew(_mcp.b.p)},fh:function(n){this.ev(_mcp.b.p,n);return n},eL:null,eN:!1,bp:function(){return this.eN},cF:function(n){this.eN=n;return n},fv:!1,cq:function(){return this.fv},F:function(){return this.ew(_mcp.b.bA)},ce:function(n){if(n!==this.F()){this.ev(_mcp.b.bA,n);this.ey("IsCopyRestricted","IsPrintRestricted")}return n},u:function(){return this.ew(_mcp.b.y)},bY:function(n){this.ev(_mcp.b.y,n);return n},fM:!1,eh:function(n){this.fM=n;return n},bi:function(){return this.eY},dS:function(n){if(this.eY!==n){this.eY=n;n&&!this.eJ()&&this.fS();this.eu("IsEditorInitialized")}return n},fu:null,dJ:function(n){this.fu=n;return n},fw:!1,dY:function(n){this.fw=n;return n},bG:function(){return this.ew(_mcp.b.bb)},fG:function(n){this.ev(_mcp.b.bb,n);return n},du:function(){return this.ew(_mcp.b.bU)},eV:function(n){this.ev(_mcp.b.bU,n);return n},W:function(){return this.ew(_mcp.b.R)},gl:function(n){this.ev(_mcp.b.R,n);return n},fW:function(){return this.ew(_mcp.b.bd)},dU:function(n){this.ev(_mcp.b.bd,n);return n},cx:function(){return this.ew(_mcp.b.bV)},fL:function(n){this.ev(_mcp.b.bV,n);return n},fX:function(){return!!this.F()&&!this.F().a()&&!this.F().e()&&!this.F().b()},bu:function(){return this.bq()&&_mcp.h.g(this)},fV:function(){return!!this.F()&&0===this.F().a()&&!this.F().f()&&!this.F().b()},bd:function(){return null},cf:function(){return this.G()},bw:function(){return this.fC},bo:function(){return this.ew(_mcp.b.X)},cb:function(n){this.ev(_mcp.b.X,n);return n},da:function(){return this.ew(_mcp.b.v)},bX:function(n){this.ev(_mcp.b.v,n);return n},cn:function(){return this.ew(_mcp.b.D)},dH:function(n){this.ev(_mcp.b.D,n);return n},cm:function(){return this.ew(_mcp.b.C)},dG:function(n){this.ev(_mcp.b.C,n);return n},gC:function(){return this.ew(_mcp.b.B)},dF:function(n){this.ev(_mcp.b.B,n);return n},ck:function(){return this.ew(_mcp.b.x)},bV:function(n){this.ev(_mcp.b.x,n);return n},cl:function(){return this.ew(_mcp.b.u)},bW:function(n){this.ev(_mcp.b.u,n);return n},db:function(){return this.ew(_mcp.b.w)},gh:function(n){this.ev(_mcp.b.w,n);return n},y:function(){return this.ew(_mcp.b.bE)},eg:function(n){this.ev(_mcp.b.bE,n);return n},Y:function(){return this.ew(_mcp.b.Z)},dR:function(n){this.ev(_mcp.b.Z,n);return n},Z:function(){return this.ew(_mcp.b.bh)},dW:function(n){this.ev(_mcp.b.bh,n);return n},fz:function(){return this.I()},bN:function(){return this.ew(_mcp.b.bK)},cO:function(n){this.ev(_mcp.b.bK,n);return n},I:function(){return _a.p.a&&(this.o()||this.r())},o:function(){if(!_a.p.a||!_a.p.i()||!this.dy()||_g.a.a().a().bk.AlwaysShowFrom)return!1;var n=_g.a.a().bk.SmimeAdminSettings;return!!n&&n.AlwaysEncrypt||this.ew(_mcp.b.bH)},ej:function(n){this.ev(_mcp.b.bH,n);this.eu(_mcp.b.c);_j.e.a(_a.a.k,"Context.SmimeEncryptMessage is set to {0}",n);return n},r:function(){if(!_a.p.a||!_a.p.i()||!this.dy()||_g.a.a().a().bk.AlwaysShowFrom)return!1;var n=_g.a.a().bk.SmimeAdminSettings;return!!n&&n.AlwaysSign||this.ew(_mcp.b.bL)},el:function(n){this.ev(_mcp.b.bL,n);this.eu(_mcp.b.c);_j.e.a(_a.a.k,"Context.SmimeSignMessage is set to {0}",n);return n},ds:function(){return _g.a.a().bk.SmimeAdminSettings&&(_g.a.a().bk.SmimeAdminSettings.AlwaysEncrypt||_g.a.a().a().bk.AlwaysShowFrom)||this.D()?!1:!0},dt:function(){return _g.a.a().bk.SmimeAdminSettings&&(_g.a.a().bk.SmimeAdminSettings.AlwaysSign||_g.a.a().a().bk.AlwaysShowFrom)||this.D()?!1:!0},fa:0,bh:function(){return this.ew(_mcp.b.z)},fE:function(n){this.ev(_mcp.b.z,n);return n},dm:function(){return this.ew(_mcp.b.br)},fJ:function(n){this.ev(_mcp.b.br,n);return n},bI:function(){if(this.bq()||_y.c.a.i()||this.I()||this.eN)return!1;var n=this.F();return!n||!!n.a()||n.b()},bH:function(){return _a.g.b?!1:this.a()!==8&&!this.S()},eT:function(){return this.ew(_mcp.b.bg)},he:function(n){this.ev(_mcp.b.bg,n);return n},fn:!1,fN:!1,bm:function(){return this.fN},S:function(){return this.a()===11||this.a()===12||this.a()===13},bA:function(){return this.ew(_mcp.b.bv)},v:function(n){this.ev(_mcp.b.bv,n);return n},fe:function(){return this.ew(_mcp.b.bu)},bb:function(n){this.ev(_mcp.b.bu,n);return n},gI:function(){return this.ew(_mcp.b.bW)},bc:function(n){this.ev(_mcp.b.bW,n);return n},dq:function(){return this.ew(_mcp.b.bz)},ee:function(n){this.ev(_mcp.b.bz,n);return n},Q:function(){return this.ew(_mcp.b.h)},dL:function(n){this.ev(_mcp.b.h,n);return n},bk:function(){return this.ew(_mcp.b.bf)},dV:function(n){this.ev(_mcp.b.bf,n);return n},dj:function(){return this.ew(_mcp.b.bl)},dX:function(n){this.ev(_mcp.b.bl,n);return n},cp:function(){return this.ew(_mcp.b.Q)},gk:function(n){this.ev(_mcp.b.Q,n);return n},gF:function(){return this.ew(_mcp.b.bD)},hf:function(n){this.ev(_mcp.b.bD,n);return n},cv:function(){this.fs||(this.fs=this.bR());return this.fs},cS:function(){return this.ew(_mcp.b.bw)},cg:function(n){this.ev(_mcp.b.bw,n);return n},bB:function(){return this.ew(_mcp.b.A)},cB:function(n){this.ev(_mcp.b.A,n);return n},bj:function(){if(this.Q()){var n=_g.c.a(this.Q().d(),_g.c.c());return!!n&&n.bk.Value.toUpperCase()==="TRUE"}return!1},cc:function(n){_j.e.a(_a.a.a,"Setting IsOmeRequested to {0}",n);this.hl(n);return n},bJ:function(){if(!this.Q())return null;var n=_g.c.a(this.Q().d(),_g.c.b());if(n&&n.bk.Value){var i=n.bk.Value;var t=_a.c.b(i);t||_j.e.c(_a.a.G,"Attempt to get OME expiration time but value in extended property cannot be parsed into a datetime object.  Value: {0}",i);return t}else return null},cK:function(n){_j.e.a(_a.a.a,"Setting OmeTimeExpiration to {0}",n);this.hm(n?_a.c.bJ(n):"");return n},fY:function(){return this.a()===1||this.a()===2||this.fj===1},fb:null,cs:function(){return this.fb},dZ:function(n){this.fb=n;return n},fc:null,ed:function(n){this.fc=n;return n},eM:null,dn:function(){return this.eM},dk:function(){return _cmc.h.c(_g.cp,this.eM,_cmc.d.b,null)},eQ:null,ct:function(){return this.eQ},cZ:function(){return _cmc.a.f(this.eQ,this.fl,!0)},fl:null,fg:null,dc:function(){return this.fg},dE:function(n){this.fg=n;return n},fj:0,dd:function(){return this.fj},fd:!1,cw:function(){return this.fd},en:function(n){this.fd=n;return n},ci:function(){return this.ew(_mcp.b.bM)},gr:function(n){this.ev(_mcp.b.bM,n);return n},ch:function(){return this.ew(_mcp.b.J)},gi:function(n){this.ev(_mcp.b.J,n);return n},er:function(){return this.ew(_mcp.b.by)},gp:function(n){this.ev(_mcp.b.by,n);return n},cT:function(){return this.ew(_mcp.b.bi)},gm:function(n){this.ev(_mcp.b.bi,n);return n},cy:function(n){return _gg.b.isInstanceOfType(n)?2:1},gR:function(n){this.t(_mcp.b.bZ(_y.dG,n,_mcp.b.j.a,0));this.d(_mcp.b.bZ(_y.l,n,_mcp.b.b.a,0));this.g(_mcp.b.bY(n,_mcp.b.k.a,!0));var t=_mcp.b.bY(n,"IsCalendarItem",!1);this.cA(t?1:0);if(n&&"StoreId"in n){this.eZ(!1);this.hh(n.StoreId)}this.gS(n);this.cJ(0===this.a()||4===this.a())},dw:function(n){_g.cx.isInstanceOfType(n)?this.d(1):_g.cw.isInstanceOfType(n)?this.d(2):_g.cJ.isInstanceOfType(n)&&this.d(3);this.gv(n,n.f());this.cd(n.bk.ReferenceItemId);this.ea(n.n());this.L(n.bk.ItemId);this.z(n.bk.Subject);this.w(n.f().bk.Value);this.cD(n.bk.From);this.q(n.m()?n.m().e:null);this.ba(n.o()?n.o().e:null);this.bU(n.v()?n.v().e:null);this.g(!1);this.dO(n.bM());this.fo(n);this.ce(n.bB());this.eg(n.bR());this.dR(n.bk.IsDeliveryReceiptRequested);this.dW(n.bk.IsReadReceiptRequested);this.dQ(n.bk.InternetMessageId);this.fP(n);this.ge(n);this.cJ(!1);this.eZ(!0);_j.e.a(_a.a.a,"Initialized context with smart response")},dv:function(n){if(!n)throw Error.argumentNull("message");this.gv(n,n.I());this.dI(n);this.L(n.bk.ItemId);this.z(n.bk.Subject);this.w(n.co()?n.co().bk.Value:n.I().bk.Value);this.gM();this.fE(n.bk.ConversationId);if(_g.i.isInstanceOfType(n)){var t=n;this.cD(t.bk.From);this.q(t.m()?t.m().x():null);this.ba(t.o()?t.o().x():null);this.bU(t.v()?t.v().x():null);this.dR(t.bk.IsDeliveryReceiptRequested);this.dW(t.bk.IsReadReceiptRequested);this.dQ(t.bk.InternetMessageId);if(t.bk.ParentMessageId){this.cd(t.bk.ParentMessageId);this.fj=t.dM()}n.cX()&&_cmc.h.f(n.cX(),this.eM,this.eQ,_mco.d.b);n.cd()&&(this.fl=n.cd())}else if(_g.bf.isInstanceOfType(n)){var u=n;this.cD(u.bk.From)}this.g(!1);this.dO(n.bM());this.fo(n);this.ce(n.bB());this.eg(n.bR());n.bB()&&!n.bB().a()?this.n(n.bB().h()):n.co()?this.n(n.co().a()):this.n(n.du()===1?"Text":"HTML");this.fH(_dg.o.isInstanceOfType(n));if(this.bq()){var i=n;this.fp(i.y());this.fI(_dg.j.isInstanceOfType(i));i.bk.From&&this.cD(i.bk.From);i.bk.Sender&&this.ef(i.bk.Sender)}n.cw()&&n.cw().b()?this.U(n.cw()?n.cw().e:null):(!this.eT()||this.i())&&this.U(n.S()?n.S().e:null);if(this.p()&&n.I().a()==="Text")for(var r=0;r<this.p().b();r++)this.p().c(r)&&this.p().c(r).a()&&this.p().c(r).g(!1);this.ge(n);this.cJ(!0);this.eZ(!0);_j.e.a(_a.a.a,"Initialized context with draft")},K:function(n){this.cL(n);this.gO(n)},gd:function(){this.eD("OnAsyncSendCallbackEvent",this)},gM:function(){this.eC("OnInitializingDraftContentEvent")},gN:function(){this.eC("OnPrepareQuotedBodyEvent")},gL:function(){this.eD("BeforeDraftUpdateEvent",this)},gK:function(){this.eD("AfterDraftUpdateEvent",this)},A:function(n){var i=new _g.i;var t;this.gs(i,t={val:n}),n=t.val;return i},bx:function(n){var i=new _g.bf;var t;this.gs(i,t={val:n}),n=t.val;return i},cY:function(){var t=this.fR();_a.b.b(this.eP,"GetEditorContentCommand");this.eP.a();var n=this.C();t.a()==="Text"&&(n=_mcp.b.cc(n));t.b(n);this.fa=_j.i.a(n)?0:n.length;_j.e.a(_a.a.a,"MailComposeContext.CreateBodyFromEditor, ContentLength: {0}",this.fa);return t},hk:function(n){var t=this.eJ();if(!t||this.X()===t.i()){this.dO(n);t&&t.A(n)}},fS:function(){if(this.eY&&this.fw){this.eP.a();if(this.eJ()){_mcp.c.z(this.eJ(),this);_j.e.a(_a.a.a,"Updated baseline")}else{this.fh(_mcp.c.b(this));_j.e.a(_a.a.a,"Captured baseline for the first time");if(this.fn&&this.eL){this.eL.r(this.eJ().a());this.fn=!1}if(!this.h()||this.eT()&&this.du()){this.eL=_mcp.c.b(this);_j.e.a(_a.a.a,"Captured initial baseline for context")}}}},gf:function(){if(!this.eJ())return!1;this.eP&&this.eP.a();return!this.eJ().t(this)},bS:function(n){var t=null;if(this.l()==="HTML"){var r,i;i=_a.x.a(this.C(),r={val:t}),t=r.val,i}else t=this.C();t=t?t.length>n?t.substr(0,n)+"...":t:"";return t},eW:function(n,t,i,r,u){this.q(new _j.l);var f=n?n.Mailbox:null;if(!_mcp.b.a){var h=_g.a.a().c();_mcp.b.a=_j.i.a(h.bk.SharePointUrl)?h.bk.UserEmailAddress||"":h.bk.LogonEmailAddress||""}this.a()!==8&&this.dP(!0);if(f&&_mcp.b.bX(f.EmailAddress)){var a;var l;if(this.a()===1&&(a=t?t.b():0)+(l=i?i.b():0)+(r?r.b():0)===1){this.dP(!1);a===1?this.f().a(t.c(0)):l===1?this.f().a(i.c(0)):this.f().a(r.c(0))}else this.a()===2&&this.dP(!1)}if(this.a()===8&&this.fT()||this.a()!==8&&(!u||!u.b())&&f&&this.fT()){this.f().a(f);_j.e.a(_a.a.a,"Adding original From to To, Operation = {0}; From= {1}; Self= {2}",this.a(),_g.m.m(n),_mcp.b.a)}if(this.a()===2||this.a()===8){_j.e.a(_a.a.a,"Adding {0} To recipients to To.",t?t.b():0);this.fx(t,this.f(),f,null);_j.e.a(_a.a.a,"Adding {0} Cc recipients to Cc.",i?i.b():0);this.ba(new _j.l);this.fx(i,this.j(),f,this.f());_j.e.a(_a.a.a,"Adding {0} Bcc recipients to Bcc.",r?r.b():0);this.bU(new _j.l);this.fx(r,this.c(),f,this.f())}if(u&&u.b()>0)if(this.a()===1){this.f().f();for(var e=0;e<u.b();e++){var v=u.c(e);this.f().a(v)}}else if(this.a()===2)for(var o=0;o<u.b();o++){var s=u.c(o);var y=this;if(this.f().b()===this.f().i(function(n){return _g.m.a(s,n)})){var p=this;var c=this.j().i(function(n){return _g.m.a(s,n)});c!==this.j().b()&&this.j().p(c);this.f().a(s)}}if(this.a()!==8&&f&&0===this.f().b()&&(!this.j()||0===this.j().b())){this.f().a(f);_j.e.a(_a.a.a,"Adding original From since there are no recipients left, From = {0}",_g.m.m(n))}this.fO()},dA:function(){_j.e.a(_a.a.a,"Context reset start.");this.fK(null);this.eP=null;this.a()&&this.d(0);this.k()&&this.t(0);this.E()&&this.cd(null);this.e()&&this.cL(null);this.h()&&this.L(null);_j.i.a(this.G())||this.z(null);_j.i.a(this.C())||this.w("");this.f()&&this.q(null);_j.i.a(this.bn())||this.cP(null);this.j()&&this.ba(null);_j.i.a(this.bg())||this.dD(null);this.c()&&this.bU(null);_j.i.a(this.N())||this.dC(null);this.fZ()||this.g(!0);this.X()!=="Normal"&&this.dO("Normal");_j.i.a(this.dp())||this.ff(null);this.fU()&&this.eZ(!1);this.bq()&&this.fH(!1);this.br()&&this.fI(!1);this.di()&&this.gn(!1);this.fq()&&this.go(null);this.bE()&&this.gj(!1);this.dg()&&this.dQ(null);this.ci()&&this.gr(null);this.ch()&&this.gi(null);this.er()&&this.gp(null);this.cT()&&this.gm(!1);this.m()&&this.cD(null);this.bt()&&this.ef(null);this.i()&&this.cJ(!1);this.D()&&this.dT(!1);this.bF()&&this.fr(!1);this.R()&&this.ca(!1);this.p()&&this.U(null);this.by()&&this.dB(null);this.J()&&this.eo(!1);this.eJ()&&this.fh(null);this.bD()&&this.fF(!1);this.co()&&this.dN(!1);this.bl()&&this.cI(!1);this.P()&&this.dI(null);this.F()&&this.ce(null);_j.i.a(this.u())||this.bY(null);this.bo()&&this.cb(!1);_j.i.a(this.da())||this.bX(null);_j.i.a(this.ck())||this.bV(null);_j.i.a(this.cl())||this.bW(null);this.db()&&this.gh(!1);this.y()!=="Normal"&&this.eg("Normal");this.Y()&&this.dR(!1);this.Z()&&this.dW(!1);this.o()&&this.ej(!1);this.r()&&this.el(!1);this.ga()&&this.ek(null);this.bh()&&this.fE(null);_j.i.a(this.dm())||this.fJ(null);this.cj()&&this.cA(0);this.cr()&&this.cH(!1);this.bG()&&this.fG(!1);this.fW()&&this.dU(!1);this.Q()&&this.dL(null);this.fd&&(this.fd=!1);if(this.bA()){_y.j.a(this.bA(),null,"ContextReset",null,null);this.v(null)}_j.e.a(_a.a.a,"Context reset end.")},dx:function(){return!!this.e().bB()&&0===this.e().bB().a()&&!this.e().bB().i()&&!this.e().bB().l()},bQ:function(){var n=null;if(this.m()&&this.m().Mailbox&&!_j.i.a(this.m().Mailbox.EmailAddress))n=this.m().Mailbox;else if(this.bt()&&this.bt().Mailbox&&!_j.i.a(this.bt().Mailbox.EmailAddress))n=this.bt().Mailbox;else if(!_j.i.a(_mcp.b.a)){n=new _g.f;n.EmailAddress=_mcp.b.a;n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},dy:function(){if(!_a.p.a||_a.p.o)return!1;switch(this.a()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.P()&&!this.fA(this.P())?!1:this.e()&&!this.fA(this.e())?!1:_j.i.a(this.bB())?!0:!1},fA:function(n){if(_j.i.a(n.bk.ItemClass)||n.bk.ItemClass==="IPM.Note"||n.bI())return!0;else{var i=this.a()===1||this.a()===2;var t=i||this.a()===3;return i&&(n.bk.ItemClass.startsWith("IPM.Schedule.Meeting")||n.bk.ItemClass.startsWith("IPM.Appointment"))?!0:t&&n.bk.ItemClass.startsWith("REPORT.IPM.Note")?!0:t&&n.bk.ItemClass.startsWith("IPM.Note.Rules")?!0:t&&n.bk.ItemClass==="IPM.Post"?!0:!1}},cR:function(n){_j.e.a(_a.a.k,"Updating S/MIME options...");if(_a.p.a)switch(n){case 6:this.ej(!0);this.el(!1);break;case 10:case 11:this.ej(!1);this.el(!0);break;case 12:case 13:case 14:this.ej(!0);this.el(!0);break;case-1:case 0:default:this.ej(!1);this.el(!1);break}},hn:function(n){_j.e.a(_a.a.k,"Upgrading S/MIME options...");if(_a.p.a)switch(n){case 6:this.ej(!0);break;case 10:case 11:this.el(!0);break;case 12:case 13:case 14:this.ej(!0);this.el(!0);break;case-1:case 0:default:break}},bv:function(){if(this.bA()){var t=!1;var n=this;this.fC=function(i){if(!t&&n.bA()){_y.j.a(n.bA(),null,i);n.v(null);t=!0}}}},bR:function(n,t){var i=this.ga();if(!i||!i.length)return null;_j.B.a(n)&&(n=0);_j.B.a(t)&&(t=i.length);for(var r=new _j.q,h=n;h<n+t;h++){var s=i[h];if(s&&s.length)for(var a=s,v=a.length,f=0;f<v;++f){var u=a[f];_j.i.a(u)||r.g(u)||r.c(u)}}if(n+t<i.length){var o=i[i.length-1];if(o&&o.length>0)for(var l=o,y=l.length,e=0;e<y;++e){var c=l[e];_j.i.a(c)||r.g(c)||r.c(c)}}return r.d.length>0?r.d:null},gs:function(n,t){t.val=!!t.val!==t.val?!1:t.val;n.cW(this.G());n.dy(this.X());n.bO(this.h());n.Z(new(_a.fE.$$(_g.Attachment,_g.bn)));if(this.I()){var s=_g.a.a().bk.SmimeAdminSettings.ClearSign;n.eY(this.o()?"IPM.Note.SMIME":s?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");n.bk.ItemClass==="IPM.Note.SMIME.MultipartSigned"?n.cs(this.fQ(t.val)):n.cs(new _g.w(new _g.s(this.l(),"")));var o=_a.bl.b(this.gG());n.hV(new _g.eB(o))}else{n.cs(this.fQ(t.val));(this.P()&&this.P().bI()||this.e()&&this.e().bI())&&n.eY("IPM.Note");this.p()&&n.S().i(this.p().d())}n.hY(this.F());n.dm(this.y());n.eX(this.bo());n.eT(this.ck());n.eV(this.cl());n.eW(this.da());n.gx(this.cn());n.gw(this.cm());n.gv(this.gC());n.hN(this.gD());if(this.Q()){n.fG(new(_a.fE.$$(_g.be,_g.U)));n.bG().i(this.Q().d())}if(_g.i.isInstanceOfType(n)){var i=n;i.cl(this.m());_cmc.d.e(i.I().bk.Value,i.bk.Subject,this.eM);_cmc.a.e(i.I().bk.Value,i.bk.Subject,this.eQ);var e=_cmc.d.d(i.I().bk.Value,i.bk.Subject,this.eM);i.fE(e);this.gV(e);_cmc.h.b(i,this.eM,this.dk(),this.eQ,this.cZ());if(this.I()&&this.eX){if(this.eX===1){i.bF(new _a.j);this.f()&&i.m().i(this.f().d());i.bX(new _a.j);this.j()&&i.o().i(this.j().d())}else if(this.eX===2){i.cc(new _a.j);this.c()&&i.v().c(this.c().c(this.fi))}else if(this.eX===3){i.cc(new _a.j);this.c()&&i.v().i(this.c().d())}}else{i.bF(new _a.j);this.f()&&i.m().i(this.f().d());i.bX(new _a.j);this.j()&&i.o().i(this.j().d());i.cc(new _a.j);this.c()&&i.v().i(this.c().d())}i.cD(this.Y());i.cI(this.Z());i.dV(this.o());i.dW(this.r());this.dg()&&i.cz(this.dg())}else{var u=n;u.cB(this.bK());var f=_g.a.a().c();var r=null;r=_j.i.a(f.bk.LogonEmailAddress)?null!==this.m()&&this.m().Mailbox?this.m().Mailbox.EmailAddress:_mco.a.g(null)||f.bk.UserEmailAddress:f.bk.LogonEmailAddress;if(r){u.g(new _g.O);u.bk.From.Mailbox=new _g.f;u.bk.From.Mailbox.EmailAddress=r}}},gV:function(n){if(n){var r="AtAllMention_Mail_";r=r+(this.eN?"Group_":"ME_");var h=_y.l.toString(this.a());var e=new _a.br(1,r+h);_a.r.c.a(e);for(var t=this.f(),i=!1,u=0;u<t.b();u++)if(t.c(u).MailboxType==="GroupMailbox"){i=!0;break}if(!i){t=this.j();for(var f=0;f<t.b();f++)if(t.c(f).MailboxType==="GroupMailbox"){i=!0;break}}if(!i){t=this.c();for(var o=0;o<t.b();o++)if(t.c(o).MailboxType==="GroupMailbox"){i=!0;break}}var s="MsgHasAtleastAGroup_";i||(s="MsgHasNoGroup_");e=new _a.br(1,r+s+h);_a.r.c.a(e)}},fx:function(n,t,i,r){if(n)for(var f=0;f<n.b();f++){var u=n.c(f);if(_g.m.a(u,i)){_j.e.a(_a.a.a,"Excluding original from {0}",i);continue}if(_mcp.b.bX(u.EmailAddress)||this.gU(u.EmailAddress)){_j.e.a(_a.a.a,"Excluding self address {0}",_mcp.b.a||"null");continue}var e=this;if(r&&r.b()!==r.i(function(n){return _g.m.a(u,n)})){_j.e.a(_a.a.a,"Excluding address {0} already in to",u);continue}t.a(u)}},gU:function(n){var t=this.m();return!!t&&!!t.Mailbox&&t.Mailbox.EmailAddress===n},gB:function(n,t){this.eu("ShowMeetingReadonlyFields")},gS:function(n){var t=this.gW(n);switch(this.a()){case 0:case 4:this.L(t);break;case 1:case 2:case 3:this.cd(t);break}},ge:function(n){if(n.bG()){this.dL(new _j.l);this.Q().m(n.bG().f())}},gW:function(n){var t=null;if(n&&"Id"in n){t=new _g.g(n.Id);"ChangeKey"in n&&(t.ChangeKey=n.ChangeKey)}return t},gv:function(n,t){0===n.du()&&n.fL(t&&t.a()==="Text"?1:3)},gQ:function(n){var r=_mco.a.g(n);if(r){this.cD(new _g.O);this.m().Mailbox=new _g.f;this.m().Mailbox.EmailAddress=r}this.cA(0);switch(this.a()){case 1:case 2:case 12:this.fo(n);if(_g.i.isInstanceOfType(n)){var t=n;t.x()?this.eW(t.bk.From||t.bk.Sender,null,null,null,null):this.eW(t.bk.From||t.bk.Sender,t.m()?t.m().e:null,t.o()?t.o().e:null,t.v()?t.v().e:null,t.db()?t.db().e:null);this.gn(this.a()===2&&n.hE()&&!t.bk.IsGroupEscalationMessage);this.ea(n.ef())}else if(_g.bf.isInstanceOfType(n)){var i=n;this.eW(i.bk.From||i.bk.Sender,null,null,null,null)}this.fD(n);break;case 3:_dg.o.isInstanceOfType(n)||this.fo(n);this.ea(n.ef());this.fO();this.fD(n);this.hb(n);break;case 9:case 10:_g.i.isInstanceOfType(n)?this.eW(n.bk.Sender,null,null,null,null):_g.bf.isInstanceOfType(n)&&this.eW(n.bk.Sender,null,null,null,null);this.fD(n);break;case 5:case 6:case 7:default:this.gt();break}_j.e.a(_a.a.a,"Initialized context with original email message")},gO:function(n){this.cd(n.bk.ItemId);var i=this.dx();this.ce(i?null:n.bB());this.hj(n.cF());this.eg(n.bR());this.w(this.C()||"");this.fP(n);if(!this.i()){this.cJ(!(this.a()===1||this.a()===2||this.a()===3||this.a()===12));this.a()!==3||_a.p.a&&n.bI()||i||this.F()&&this.F().a()||this.U(n.S()?n.S().e:null)}if(_dg.ICalendaring.isInstanceOfType(n)){var t=n;t.bd();this.gP(t)}else if(_g.i.isInstanceOfType(n)||_g.bf.isInstanceOfType(n)){if(3===this.a()&&!this.i()){this.dO(n.bM());_j.e.a(_a.a.a,"Setting importance to {0} since we are forwarding item {1} with that importance",this.X(),_h.Z.a(n.bk.ItemId))}this.gQ(n)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(n).getName()));this.gu();_g.i.isInstanceOfType(n)&&n.bS?this.eZ(!1):this.eZ(!0)},fP:function(n){n.co()&&this.n(n.co().a())},gJ:function(n){var t=null;_dg.q.isInstanceOfType(n)||_dg.n.isInstanceOfType(n)?t=n.bk.From:n.t()?t=n.t():_j.e.c(_a.a.a,"ICalendaring doesnt have an organizer");return t},gu:function(){var n=new _j.q;this.br()&&n.h(_dg.j.a(this.p()));if(this.eR&&_a.p.a&&this.eR.bI()&&this.eR.dP()){var t=this.eR.S().a(0).bk.AttachmentId.Id;n.c(t)}this.hc(n.j())},gP:function(n){this.cA(this.cy(n));var u=this.gJ(n);var t;var r;if(_dg.q.isInstanceOfType(n)||_dg.n.isInstanceOfType(n)){t=n.m()?_g.m.f(n.m().e):null;r=n.o()?_g.m.f(n.o().e):null}else{t=n.q()?_g.m.f(_dg.f.d(n.q().e)):null;r=n.s()?_g.m.f(_dg.f.d(n.s().e)):null}if(_gg.b.isInstanceOfType(n)){var i=n;if(!_j.i.a(i.bk.CustomerEmail)&&_a.H.a(i.bk.CustomerEmail)){var f=new _g.f;f.EmailAddress=i.bk.CustomerEmail;f.Name=_j.i.b(i.bk.CustomerName)?i.bk.CustomerEmail:i.bk.CustomerName;t.a(f)}}switch(this.a()){case 1:case 2:this.eW(u,t,r,null,null);break;case 5:case 6:case 7:this.eW(u,t,r,null,null);this.fp(n);this.gl(!0);break;case 8:var e=n.q().t();e.i(n.E().f());t=_g.m.f(_dg.f.d(e.e));this.eW(u,t,r,null,null);this.fp(n);this.gl(!0);break;case 3:if(_dg.j.isInstanceOfType(n)||_dg.a.isInstanceOfType(n)){this.fI(!0);this.cD(u);this.fp(n)}break;default:this.gt();break}this.fH(!0);_j.e.a(_a.a.a,"Initialized context from original calendar item")},fp:function(n){this.gA(n);this.go(n.r());this.gj(!!this.fq()&&!_j.i.a(this.fq().bk.DisplayName))},hj:function(n){var t="";switch(this.a()){case 1:case 2:case 12:t=_u.n.Pl;break;case 3:t=_nbs.a.Zf;break;case 5:t=_nbs.a.WB;break;case 6:t=_nbs.a.ha;break;case 7:t=_nbs.a.fB;break;case 8:t=_nbs.a.TA;break;case 9:t=_nbs.a.ny;break;case 10:t=_nbs.a.OD;break}var i=String.format(_nbs.a.jS,t,n);_j.e.a(_a.a.a,"Formatted subject with Prefix = {0}; Operation = {1}",t,this.a());if(255<i.length){this.z(i.substr(0,255));_j.e.a(_a.a.a,"Truncated subject from {0} to {1} to meet the {2} characters rule.",i,this.G(),255)}else this.z(i)},fD:function(n){this.fE(n.bk.ConversationId);_g.i.isInstanceOfType(n)?this.fJ(n.bk.InternetMessageId):_g.bf.isInstanceOfType(n)&&this.fJ(n.bk.InternetMessageId)},gt:function(){var n=_j.t.d(_y.l,this.a());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",n));},fo:function(n){this.cb(n.dt());this.bX(n.ed());this.bV(n.eb());this.bW(n.ec());this.gh(n.hx())},fQ:function(n){return n?this.fR():this.cY()},fR:function(){var n=new _g.w(new _g.s("HTML",""));n.b("");if(4!==this.a()&&13!==this.a()||this.dq()){_j.e.a(_a.a.a,"Create new body for action email message, setting body type to context body type: {0}",this.l());n.c(this.l())}else{_j.e.a(_a.a.a,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");n.c("Text")}return n},fO:function(){if(_y.c.a.i()){var n=this.bQ();if(n){if(!this.gg(this.f(),n.EmailAddress)&&!this.gg(this.j(),n.EmailAddress)){this.j()||this.ba(new _j.l);this.j().a(n);_j.e.a(_a.a.a,"Adding self to CC")}}else _j.e.c(_a.a.a,"Could not add self to CC as the address was missing")}},gg:function(n,t){if(n)for(var i=0;i<n.b();i++){var r=n.c(i);if(t.toLowerCase()===r.EmailAddress.toLowerCase())return!0}return!1},hl:function(n){var t=null;if(n){this.Q()?t=_g.c.a(this.Q().d(),_g.c.c()):this.dL(new _j.l);if(!t){var i=new _g.U;i.ExtendedFieldURI=_g.c.c();t=new _g.be(i);this.Q().a(t)}t.b("True")}else{if(!this.Q())return;t=_g.c.a(this.Q().d(),_g.c.c());t&&t.b("False")}},gA:function(n){this.gr(n.c());this.gi(n.g());this.gp(n.A());this.gm(n.J())},hm:function(n){var t=null;if(_j.i.a(n)){if(!this.Q())return;t=_g.c.a(this.Q().d(),_g.c.b());if(t){t.b(undefined);this.Q().o(t,!0)}}else{this.Q()?t=_g.c.a(this.Q().d(),_g.c.b()):this.dL(new _j.l);if(!t){var i=new _g.U;i.ExtendedFieldURI=_g.c.b();t=new _g.be(i);this.Q().a(t)}t.b(n)}},hb:function(n){if(_a.g.b){var t=n.bG()?_g.c.a(n.bG().f(),_g.c.b()):null;t&&this.cK(_a.c.b(t.bk.Value))}}};_mcp.E=function(n){this.e={};this.f=n};_mcp.E.prototype={f:null,a:function(n){return n in this.e},d:function(n,t){if(n in this.e){var i=this.e[n];!i.a&&t&&(this.e[n]=new _mcp.bc(t))}else this.e[n]=new _mcp.bc(t)},g:function(n,t){var u=n.a;var r=u.ba;var i=r.b();var o=r.h();var f=!1;if(r.bG())_j.e.a(_a.a.a,"Not discarding a loaded draft for context {0}",i);else if(r.bD())_j.e.a(_a.a.a,"Not discarding an explicitly saved draft for context {0}",i);else if(u.bl().f())_j.e.a(_a.a.a,"Not discarding a draft currently being explicitly saved for context {0}",i);else if(u.bh().c())_j.e.a(_a.a.a,"Not discarding a draft currently being sent for context {0}",i);else{var e=!1;if(t)_j.e.a(_a.a.a,"Skipping dirty check for context {0}",i);else{_j.e.a(_a.a.a,"Checking dirty for determining whether to discard unused message on navigate away.");e=u.bS()}if(e)_j.e.a(_a.a.a,"Not discarding a dirty draft for context {0}",i);else if(r.eL)if(r.eL.s(r.eJ())){if(_g.k.b&&r.bl()&&!r.h()){_j.e.a(_a.a.a,"Calling main window to remember the pending discard for context {0}",i);_g.k.b.jx(i,!r.bD());f=!0}else if(!r.S()){_j.e.a(_a.a.a,"Discarding unused draft for context {0}",i);this.b(i,o,u.bp,r.bD());f=!0}}else _j.e.a(_a.a.a,"Not discarding a draft different from the initial baseline for context {0}",i);else _j.e.a(_a.a.a,"Not discarding without an initial baseline for context {0}",i)}return f},b:function(n,t,i,r){i||(i=new _mcp.Z(new _bc.b));var u;if(this.e[n]){var e=this.e[n];u=e.a}else u=!r;if(t){var f=this.f.a(t,u);i.a(f,null,null,null);delete this.e[n];_j.e.a(_a.a.a,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.e[n]=new _mcp.bc(u);_j.e.a(_a.a.a,"Discard pending because we do not have the draft ID yet. ContextId={0}; Hard={1}",n,u)}},c:function(n,t){this.b(n,t,new _mcp.Z(new _bc.b),!1)}};_mcp.c=function(){_mcp.c.initializeBase(this)};_mcp.c.$$cctor=function(){_mcp.c.h.b(_mcp.c.f);_mcp.c.e.b(_mcp.c.f);_mcp.c.d.b(_mcp.c.f);_mcp.c.c.b(new _a.bv(_g.Attachment));_mcp.c.g.b(new _a.bv(_g.be))};_mcp.c.b=function(n){var t=new _mcp.c;_mcp.c.z(t,n);return t};_mcp.c.z=function(n,t){n.K(t.s());n.r(t.C());if(t.f()){n.B(new _j.l);n.e().m(t.f().d())}else n.B(null);n.L(t.bn());if(t.j()){n.x(new _j.l);n.d().m(t.j().d())}else n.x(null);n.D(t.bg());if(t.c()){n.w(new _j.l);n.c().m(t.c().d())}else n.w(null);if(t.p()){n.p(new _j.l);n.b().m(t.p().d())}else n.p(null);if(t.Q()){n.y(new _j.l);n.q().m(t.Q().d())}else n.y(null);n.C(t.N());n.A(t.X());n.z(t.m());n.E(t.u());n.H(t.y());n.F(t.Y());n.G(t.Z());n.I(t.o());n.J(t.r())};_mcp.c.a=function(n,t,i,r){if(i!==r&&!(_j.i.a(i)&&_j.i.a(r))||!_mcp.c.x(n,t))return!1;if(!n||!t)return!0;for(var u=0;u<n.b();u++){var e=n.c(u);var f=t.c(u);if(!_mcp.c.i(e,f))return!1}return!0};_mcp.c.i=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:_g.m.a(n,t)};_mcp.c.x=function(n,t){var r=_mcp.c.y(n);var i=_mcp.c.y(t);return r===i};_mcp.c.y=function(n){return n?n.b():0};_mcp.c.w=function(n,t){if(!_mcp.c.x(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.b();i++){var u=n.c(i);var r=t.c(i);if(!_mcp.c.B(u,r))return!1}return!0};_mcp.c.A=function(n,t){return _db.bw.a(n,t)};_mcp.c.B=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.bk.AttachmentId&&t.bk.AttachmentId||!t.bk.AttachmentId&&n.bk.AttachmentId?!1:n.bk.AttachmentId&&n.bk.AttachmentId.Id!==t.bk.AttachmentId.Id?!1:n.bk.Name!==t.bk.Name?!1:n.bk.ContentType!==t.bk.ContentType?!1:n.bk.ContentId!==t.bk.ContentId?!1:n.bk.ContentLocation!==t.bk.ContentLocation?!1:n.b()!==t.b()?!1:!n.m()&&t.m()||!t.m()&&n.m()?!1:n.m()&&!n.m().C(t.m())?!1:n.a()!==t.a()?!1:!0};_mcp.c.prototype={f:function(){return this.ew(_mcp.c.u)},K:function(n){this.ev(_mcp.c.u,n);return n},a:function(){return this.ew(_mcp.c.m)},r:function(n){this.ev(_mcp.c.m,n);return n},e:function(){return this.ew(_mcp.c.h)},B:function(n){this.ev(_mcp.c.h,n);return n},j:function(){return this.ew(_mcp.c.v)},L:function(n){this.ev(_mcp.c.v,n);return n},d:function(){return this.ew(_mcp.c.e)},x:function(n){this.ev(_mcp.c.e,n);return n},h:function(){return this.ew(_mcp.c.k)},D:function(n){this.ev(_mcp.c.k,n);return n},c:function(){return this.ew(_mcp.c.d)},w:function(n){this.ev(_mcp.c.d,n);return n},g:function(){return this.ew(_mcp.c.j)},C:function(n){this.ev(_mcp.c.j,n);return n},i:function(){return this.ew(_mcp.c.o)},A:function(n){this.ev(_mcp.c.o,n);return n},l:function(){return this.ew(_mcp.c.n)},z:function(n){this.ev(_mcp.c.n,n);return n},k:function(){return this.ew(_mcp.c.l)},E:function(n){this.ev(_mcp.c.l,n);return n},o:function(){return this.ew(_mcp.c.r)},H:function(n){this.ev(_mcp.c.r,n);return n},m:function(){return this.ew(_mcp.c.p)},F:function(n){this.ev(_mcp.c.p,n);return n},n:function(){return this.ew(_mcp.c.q)},G:function(n){this.ev(_mcp.c.q,n);return n},u:function(){return this.ew(_mcp.c.s)},I:function(n){this.ev(_mcp.c.s,n);return n},v:function(){return this.ew(_mcp.c.t)},J:function(n){this.ev(_mcp.c.t,n);return n},b:function(){return this.ew(_mcp.c.c)},p:function(n){this.ev(_mcp.c.c,n);return n},q:function(){return this.ew(_mcp.c.g)},y:function(n){this.ev(_mcp.c.g,n);return n},t:function(n){if(this.i()!==n.X()){_j.e.a(_a.a.a,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.i(),n.X());return!1}if(this.f()!==n.s()){_j.e.a(_a.a.a,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",this.f()?this.f().length:0,n.s()?n.s().length:0);return!1}if(this.k()!==n.u()){_j.e.a(_a.a.a,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.k(),n.u());return!1}if(this.o()!==n.y()){_j.e.a(_a.a.a,"Dirty due to sensitivity: snapshot={0}, context={1}",this.o(),n.y());return!1}if(this.m()!==n.Y()){_j.e.a(_a.a.a,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.m(),n.Y());return!1}if(this.n()!==n.Z()){_j.e.a(_a.a.a,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.n(),n.Z());return!1}if(this.u()!==n.o()){_j.e.a(_a.a.a,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.u(),n.o());return!1}if(this.v()!==n.r()){_j.e.a(_a.a.a,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.v(),n.r());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.m()?n.m().Mailbox:null;if(!_mcp.c.i(i,t)){_j.e.a(_a.a.a,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.c.a(this.e(),n.f(),this.j(),n.bn())){_j.e.a(_a.a.a,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.e()?this.e().x.length:0,n.f()?n.f().b():0,this.j()?this.j().length:0,n.bn()?n.bn().length:0);return!1}if(!_mcp.c.a(this.d(),n.j(),this.h(),n.bg())){_j.e.a(_a.a.a,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.d()?this.d().x.length:0,n.j()?n.j().b():0,this.h()?this.h().length:0,n.bg()?n.bg().length:0);return!1}if(!_mcp.c.a(this.c(),n.c(),this.g(),n.N())){_j.e.a(_a.a.a,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",this.c()?this.c().x.length:0,n.c()?n.c().b():0,this.g()?this.g().length:0,n.N()?n.N().length:0);return!1}if(!_mcp.c.w(this.b(),n.p())){_j.e.a(_a.a.a,"snapshotAttachmentCount="+(this.b()?this.b().b():0)+", contextAttachmentCount="+(n.p()?n.p().b():0));return!1}if(!_mcp.c.A(this.q(),n.Q())){_j.e.a(_a.a.a,"snapshotExtendedPropertyCount="+(this.q()?this.q().x.length:0)+", contextExtendedPropertyCount="+(n.Q()?n.Q().x.length:0));return!1}if(this.a()!==n.C()){_j.e.a(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",this.a()?this.a().length:0,n.C()?n.C().length:0);return!1}_j.e.a(_a.a.a,"Context is clean");return!0},s:function(n){if(!n){_j.e.a(_a.a.a,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.i()!==n.i()){_j.e.a(_a.a.a,"sourceImportance={0}, targetImportance={1}",this.i(),n.i());return!1}if(this.f()!==n.f()){_j.e.a(_a.a.a,"sourceSubject={0}, targetSubject={1}",this.f(),n.f());return!1}if(this.k()!==n.k()){_j.e.a(_a.a.a,"sourceComplianceId={0}, targetComplianceId={1}",this.k(),n.k());return!1}if(this.o()!==n.o()){_j.e.a(_a.a.a,"sourceSensitivity={0}, targetSensitivity={1}",this.o(),n.o());return!1}if(this.m()!==n.m()){_j.e.a(_a.a.a,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.m(),n.m());return!1}if(this.n()!==n.n()){_j.e.a(_a.a.a,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.n(),n.n());return!1}var i=this.l()?this.l().Mailbox:null;var t=n.l()?n.l().Mailbox:null;if(!_mcp.c.i(i,t)){_j.e.a(_a.a.a,"sourceFrom={0}, targetFrom={1}",i?i.EmailAddress:"null",t?t.EmailAddress:"null");return!1}if(!_mcp.c.a(this.e(),n.e(),this.j(),n.j())){_j.e.a(_a.a.a,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.e()?this.e().x.length:0,n.e()?n.e().x.length:0,this.j(),n.j());return!1}if(!_mcp.c.a(this.d(),n.d(),this.h(),n.h())){_j.e.a(_a.a.a,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.d()?this.d().x.length:0,n.d()?n.d().x.length:0,this.h(),n.h());return!1}if(!_mcp.c.a(this.c(),n.c(),this.g(),n.g())){_j.e.a(_a.a.a,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.c()?this.c().x.length:0,n.c()?n.c().x.length:0,this.g(),n.g());return!1}if(!_mcp.c.w(this.b(),n.b())){_j.e.a(_a.a.a,"sourceAttachmentCount="+(this.b()?this.b().b():0)+", targetAttachmentCount="+(n.b()?n.b().b():0));return!1}if(this.a()!==n.a()){_j.e.a(_a.a.a,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.a()?this.a().length:0,n.a()?n.a().length:0);return!1}_j.e.a(_a.a.a,"snapshot is clean");return!0}};_mcp.bW=function(n,t){this.g=Function.createDelegate(this,this.i);if(!n)throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.f=t;this.d=n};_mcp.bW.prototype={f:0,d:null,a:null,b:!1,c:function(){!this.a&&this.b&&(this.a=_j.n.a().a(_a.a.a,"MailComposeTimer",this.g,this.f))},h:function(){_j.e.a(_a.a.a,"Disabling timer.");this.b=!1;this.e()},e:function(){if(this.a){_j.e.a(_a.a.a,"Clearing timer.");this.a=_j.n.a().b(this.a)}},i:function(){_j.e.a(_a.a.a,"Executing timer callback.");this.e();this.d()}};_mcp.v=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si){_mcp.v.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si])};_mcp.v.prototype={bD:function(){return this.ba.cw()?"MailUnifiedCompose_UpConverted":"MailUnifiedCompose"},dT:function(){return 15}};_mcp.e=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si){this.dg=Function.createDelegate(this,this.bf);this.dK=Function.createDelegate(this,this.fb);this.dM=Function.createDelegate(this,this.fm);this.dN=Function.createDelegate(this,this.fo);this.de=Function.createDelegate(this,this.fe);this.cQ=Function.createDelegate(this,this.es);this.cV=Function.createDelegate(this,this.fd);this.dJ=Function.createDelegate(this,this.dR);this.df=Function.createDelegate(this,this.ff);this.dL=Function.createDelegate(this,this.fc);this.cg=new _j.T;_mcp.e.resolveInheritance();this.U=this.dispose;_mcp.e.initializeBase(this);_a.b.b(k,"nativeBridge");this.cH=4;this.ba=n;this.bk=t||new _bc.b;this.bk.F(g);this.bb=this.bw();this.dm=i;this.bY=r;this.cY=u;this.bp=new _mcp.Z(this.bk);this.dx=f;this.cG=s;this.dd=e;this.bu=o;this.bP=h;this.bA=c;this.bg=l;this.bo=v;this.ct=p;this.cq=a;this.cA=w;this.bt=b;this.bB=y;this.cF=k;this.bO=d;this.bz=g;this.dw=nt;this.cl=tt;this.cm=it;this.cn=rt;this.di=ut;this.bT=ft;this.bZ=et;this.dn=ot;this.cM=st;this.cp=ht;this.en=ct;this.cE=lt;this.dy=at;this.cj=vt;this.ch=yt;this.ck=pt;this.cs=wt;this.ci=bt;this.dh=kt;this.dz=dt;this.bE=gt;this.bU=ni;this.bR=ti;this.dv=ii;this.cL=ri;this.cf=ui;this.co=fi;this.cr=ei;this.dl=oi;this.dc=si;if(this.ba.k()===3)this.bL=_mcp.e.d(o);else if(o){var hi=o;this.bL=hi.t||(hi.t=Function.createDelegate(hi,hi.d))}this.bz||(this.cD=!0);this.cc=!0;this.ce=!0;_j.e.a(_a.a.a,"ViewModel created")};_mcp.e.a=function(n,t){if(!n){_j.e.b(_a.a.a,"MailComposeViewModel.SafeGetComponent - map is null, cannot access component.");return null}return n.b(t)};_mcp.e.d=function(n){return function(t){if(n&&t){n.L(t,n.b());n.b().d(t)}else _j.e.b(_a.a.a,"GetDeepLinkPopUpHandler cannot invoke popup.")}};_mcp.e.c=function(){return+new Date+":"+Math.random()};_mcp.e.prototype={dm:null,ba:null,bY:null,cY:null,dx:null,dd:null,cG:null,bk:null,bu:null,bo:null,ct:null,dy:null,bP:null,bA:null,bB:null,cF:null,cA:null,en:null,bO:null,cl:null,cm:null,cn:null,di:null,bz:null,dw:null,bT:null,bZ:null,dn:null,bE:null,cq:null,cM:null,cp:null,bU:null,bR:null,dv:null,cL:null,cE:null,cj:null,ch:null,ck:null,cs:null,cf:null,co:null,cr:null,dl:null,dc:null,bb:null,bg:null,db:null,cC:!1,ca:!1,cN:null,cK:!1,bK:!1,cH:0,cD:!1,cJ:!1,bN:null,cX:null,ci:null,cI:!1,dh:null,dz:null,G:function(n){this.cg.b(n)},L:function(n){this.cg.c(n)},a:function(){return this.ba},fh:function(n){if(this.bb!==n){this.bb=n;this.eu("InfoBarViewModel")}return n},cy:function(){_a.b.d(this.cM.c(),"MailComposeViewModel: Smime override factory has not been created");return this.cM.b()},br:function(){return _mcp.e.a(this.be,0)},bJ:function(){return _mcp.e.a(this.be,10)},bn:function(){return _mcp.e.a(this.be,2)},bd:function(){return _mcp.e.a(this.be,5)},el:function(){return _mcp.e.a(this.be,11)},ec:function(){return _mcp.e.a(this.be,4)},bc:function(){return _mcp.e.a(this.be,1)},dV:function(){return _mcp.e.a(this.be,6)},bh:function(){return _mcp.e.a(this.be,7)},bl:function(){return _mcp.e.a(this.be,8)},bV:function(){return _mcp.e.a(this.be,9)},bW:function(){return _mcp.e.a(this.be,28)},bC:function(){return _mcp.e.a(this.be,16)},cx:function(){return _mcp.e.a(this.be,18)},cu:function(){return _mcp.e.a(this.be,3)},cZ:function(){return _mcp.e.a(this.be,17)},eg:function(){return _mcp.e.a(this.be,29)},da:function(){return _mcp.e.a(this.be,23)},bq:function(){return _mcp.e.a(this.be,19)},bv:function(){return _mcp.e.a(this.be,22)},dr:function(){return _mcp.e.a(this.be,24)},cv:function(){return _mcp.e.a(this.be,30)},bH:function(){return _mcp.e.a(this.be,25)},dS:function(){return _mcp.e.a(this.be,32)},fa:function(){return _mcp.e.a(this.be,35)},bQ:function(){return _mcp.e.a(this.be,12)},eb:function(){return _mcp.e.a(this.be,27)},ds:function(){return _mcp.e.a(this.be,31)},dU:function(){return _mcp.e.a(this.be,34)},bp:null,eY:function(){return!!this.bo&&this.bo.a().cA().Enabled},c:function(){return this.bz},bs:function(){return!this.bu.c()||!!this.bz},bm:function(){return!1},bD:function(){return"MailCompose"},dq:function(){return!1},dT:function(){return 5},bX:function(){var t=this.bs();var n=new _a.o;n.c("P",t);n.b("I",t?this.bM().toString():"NA");n.b("ET",this.ba.fu);this.bB.a().e()&&this.bB.a().e().Enabled&&n.b("S",this.bD());return n},eX:function(){return this.bs()||this.bu.i()},fi:function(n){if(this.cD!==n){this.cD=n;this.eu("IsReadyForViewInitialization")}return n},bM:function(){return!!this.bz},bx:function(){return this.cH},eL:function(n){if(this.cH!==n){this.cH=n;this.eu("PopupPanelSize")}return n},w:function(){if(this.bJ()){var n=this.bJ();return n.c||(n.c=Function.createDelegate(n,n.j))}else return this.dL},p:function(){return this.db},j:function(n){_j.e.a(_a.a.a,"Shell setting ClosePopupCommand from {0} to ",this.db?"non-null":"null",n?"non-null":"null");this.db=n;return n},cc:!1,by:function(){return this.cc},O:function(n){this.cc=n;return n},ce:!1,T:function(n){this.ce=n;return n},dW:function(){return this.bE.g()},eZ:function(){return this.bE.e()},ea:function(){return this.bE.i()},dY:function(){return this.bE.f()},dZ:function(){return this.bE.a()},m:function(){return this.cw()?0:1},eW:function(){return this.bE.D()},cW:!1,I:function(){return this.cW},Q:function(n){this.cW=n;return n},eJ:function(n){if(this.cC!==n){this.cC=n;this.eu("IsInView")}return n},bF:!1,v:function(n){this.bF=n;return n},eN:function(n){var t=this.ei();if(this.ca!==t){this.ca=t;this.eu("ShouldShowToolbarMessage")}return n},eP:function(n){if(this.cN!==n){this.cN=n;this.eu("ToolbarMessage")}return n},be:null,eM:function(n){var t=this.ei();if(t!==this.cK){this.cK=t;this.eu("ShouldBlockView")}return n},P:function(n){if(this.bK!==n){this.bK=n;this.eu("IsNavigatingAway")}return n},ei:function(){return this.bn()&&(this.bn().i()||this.bn().h())?!0:this.bh()&&this.bh().c()?!0:!1},dp:function(){return!this.bE.k()},bt:null,dO:null,f:function(n){this.dO=n;return n},bL:null,x:function(n){this.bL=n;return n},s:function(){var n=_mcp.e.a(this.be,27);if(n){n.d()||n.g();return n.a()}else{this.eG||this.eK||_j.e.b(_a.a.a,"MailComposeViewMode.ComposeCommandingBarViewModel -- CommandingBarComponent should not be null if the state is not disposed or disposing.");return null}},cz:function(){return this.ba.fz()},t:function(n){if(this.cJ!==n){this.cJ=n;this.eu("SharedCommandingBarShown")}return n},cw:function(){return this.bu.a()==="Mouse"},dt:function(){return this.bU.d()&&this.cw()},bi:function(){this.cX||(this.cX=new _cmc.bK);return this.cX},cd:null,J:function(){return this.bh().a()},S:function(n){this.bh().b(n);return n},R:function(n){if(n!==this.cI){this.cI=n;this.eu("ReadyToSetInitialFocus")}return n},ek:function(){return!1},ff:function(n,t){if(this.ba.I()){this.Z();this.be.q()}else{this.Y();this.be.l()}},eV:function(){this.ba.apcl(_mcp.b.c,this.df)},Z:function(){if(this.cz()&&!this.bN){_j.e.a(_a.a.a,"Setting mail compose viewmodel override");this.bN=this.cy().c();this.bN.b(this.bb)}},Y:function(){if(this.bN){this.bN.a();this.bN=null}},M:function(){!this.eK&&this.bd()&&this.bd().a()&&this.bd().a().e(this.bd().a().c(),this.ba.p(),this.ba.bf())},bf:function(){if(!this.eK){this.bH().e();this.bc().bg()}},du:function(n){this.cd=n;this.bd()&&this.bd().a()&&this.bd().a().cj(this.cd)},cB:function(){this.ba.b()&&(this.ba.eT()||this.ba.dj())||this.ba.fK(_mcp.e.c());_j.e.a(_a.a.a,"Init");this.bg.a(_cmc.br,new _mcp.bV);this.be||(this.be=this.dj());this.cI=!this.bR||!this.bR.q()||this.bR.b;if(this.cz()){_j.e.a(_a.a.a,"Creating Smime override factory");this.dk(this.dJ)}else this.dR()},dk:function(n){_j.e.a(_a.a.a,"Calling CreateSmimeOverrideFactoryAsync");var t=this;this.cM.a(function(i){_j.e.a(_a.a.a,"Smime override factory created");i.f(t.ba,t.bg);_j.e.a(_a.a.a,"Calling createFactoryCallback");n()})},dj:function(){return new _mcp.bA(this,this.cq,this.bo,this.bB,this.ct,this.cA,this.cF,this.bz,this.cl,this.cm,this.cn,this.cp,this.cE,this.cj,this.ch,this.ck,this.cs,this.ci,this.dh,this.dz,this.bE,this.bU,this.bR,this.cL,this.cf,this.co,this.cr,this.dl)},dR:function(){_j.e.a(_a.a.a,"Completing initialization");this.Z();this.eV();if(this.bb){this.bb.r();this.bg.a(_y.dI,new _y.dI);this.ba.dj()&&this.dP(this.ba.gF())}this.P(!1);this.bg.b(_a.dJ,this.cV);this.br().g();if(!this.bz){this.bu.k(this.cQ);this.bu.m(this.cQ);_j.e.a(_a.a.a,"Before unload handler has been hooked up")}this.bJ()&&(this.bJ().f()?this.cg.a():this.bJ().apcl("IsAppBarSetup",this.de))},fe:function(n,t){this.bJ().f()&&this.cg.a()},dP:function(n){switch(n){case 94:case 99:case 100:this.bb.c(n,null,_u.n.RU,this.dN);break;case 98:this.bb.c(n,null,_u.n.RU,this.dM);break;default:this.bb.a(n,null);break}},e:function(n){this.bn()?this.bn().c(n):this.eG||this.eK||_j.e.b(_a.a.a,"MailComposeViewMode.SetMailComposeConductor - NavigationComponent should not be null if the state is not disposed or disposing.")},d:function(){if(this.bn())return this.bn().l();else{this.eG||this.eK||_j.e.b(_a.a.a,"MailComposeViewMode.TryExitNow - NavigationComponent should not be null if the state is not disposed or disposing.");return!1}},l:function(n,t){this.bl().b(n,t)},fo:function(){window.open("/owa/owahipcontrol.aspx?compose=1");this.bb.b(100);this.bb.b(99);this.bb.b(94)},fm:function(){window.open(_mcp.e.b);this.bb.b(98)},fj:function(n){this.ee(n);_j.e.a(_a.a.a,"Set screen view model appbar. ContextId={0}",this.ba.b())},fl:function(n){this.eh(n);_j.e.a(_a.a.a,"Set screen view model top appbar. ContextId={0}",this.ba.b())},cR:function(){_y.hR.prototype.cR.call(this);var n=this.br();if(n.d()){_j.e.a(_a.a.a,"PostTransitionIn view model, begin secondary init now since primary init is already finished.");n.b()}else _j.e.a(_a.a.a,"PostTransitionIn view model, primary init not finished yet. Relying on primary init to fire secondary init...");this.eJ(!0);if(this.ba.dj()&&this.ba.cp()){var i=this.ba.b();this.bg.a(_y.dV,new _y.dV(i))}(this.ba.a()||this.bu.a()!=="TouchNarrow")&&this.ba.fb&&this.ba.fb();if(this.cw()){var t=this;_j.n.a().c(_a.a.c,"PreloadOwaFilePicker",function(){var n=t.bd();n&&n.v()})}if(this.ba.fc){this.ba.fc(this);this.ba.fc=null}this.bi().k(this.bD())},cS:function(){_j.e.a(_a.a.a,"Post transition out");if(this.bh().i()){var n=this.bh().i();n.j=this.ba.cp()?"SentViaNotification":"NotSentViaNotificationDueToOtherPendingFailedAsyncSend";_a.d.a(n)}this.eJ(!1);this.bi().c();if(!this.bh().h()){if(this.bF){this.bc().f();this.ba.eP.a()}IMailComposeAutoSaveComponent.isInstanceOfType(this.bh())&&this.bh().k()}this.bg.a(_a.cp,new _a.cp(!0,"NotLoadedByReadingPaneComposeHide"));this.bg.a(_a.bb,new _a.bb("MCompose"));_y.hR.prototype.cS.call(this)},bS:function(){if(this.bd().b()){_j.e.a(_a.a.a,"Dirty due to attachment in progress");return!0}this.bc().f();return this.ba.gf()},bw:function(){this.bb||this.fh(new _db.i);return this.bb},K:function(){_h.v.k()},N:function(){_h.v.g()},fn:function(){this.bN&&this.bN.c()},X:function(){this.fi(!0)},V:function(){var n=new _y.eO;this.es(n);return n.b},es:function(n){this.bn().e(n);this.bi().c()},n:function(){this.bi().c()},eS:function(){this.bs()&&this.ba&&!_j.i.a(this.ba.G())&&!this.bz&&(document.title=this.ba.G())},i:function(n){this.eb().c(n+this.dT())},ex:function(){_j.e.a(_a.a.a,"Disposing view model");this.Y();this.ba.rpcl(_mcp.b.c,this.df);if(!this.be){_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because the component map is null.");return}var n=this.bn();if(!n){_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because the navigation component is null.");return}if(!n.f()){_j.e.b(_a.a.a,"MailComposeViewModel.Reset - Skipping post-transition out processing because IsNavigatingAwayFromCompose is false.");return}this.bv()&&this.bv().a()&&this.bv().a().e(!1);this.bJ()&&this.bJ().rpcl("IsAppBarSetup",this.de);n.k(!1);this.be.dispose();this.be=null;this.ba&&!this.bF&&this.ba.dA();if(this.bb){this.bb.p.f();var t;_a.h.a(t={val:this.bb}),this.bb=t.val}this.bz||this.bu.k(this.cQ);this.bg.c(_a.dJ,this.cV);this.bL=null;this.cW=!1;_y.hR.prototype.ex.call(this)},fg:function(n,t){this.bd().u(n);this.cw()&&(!n.c||n.c===2)&&this.bd().r();if(this.bo&&this.bo.a().dV().Enabled&&t!==2)switch(n.c){case 0:this.ds().a(this.em(n.a),!0);break;case 2:this.ds().a(this.em(n.b),!1);break}this.dU()&&this.dU().a()},em:function(n){for(var i=[],t=0;t<n.length;t++)_rw.f.isInstanceOfType(n[t])&&Array.add(i,n[t].k);return i},eo:function(n){if(this.ba.bs()&&this.ba.E()&&this.ba.dd()===1){var t=this.ba.E().Id;if(this.eR(n)){_j.e.a(_a.a.a,"Original message {0} loaded from cache.",t);return}var r=new _h.I(200,[this.ba.E()],_h.b.a(),"ItemNormalizedBody",2,!1);var i=this,u=this;this.bp.a(r,function(r){_j.e.a(_a.a.a,"Original message {0} loaded from server.",t);i.eR(n)},function(n){_j.e.b(_a.a.a,"Fail to load original item with id "+t)},null)}},eR:function(n){var t=_h.d.a().a(this.ba.E().Id);if(t){this.ba.cL(t);n&&n();return!0}return!1},fc:function(n,t,i){return t===1?!this.ce:!1},eQ:function(n){if(this.bk.p)_j.e.b(_a.a.a,"ShowMessageBoxForSessionTimeout: A message is already being shown, pending timeout dialog was not shown");else{_j.e.b(_a.a.a,"ShowMessageBoxForSessionTimeout: Show pending timeout dialog");n?this.bk.g(0,_u.n.m,this.dK,!1,_u.n.NW,null,_u.n.DB,this.bk.z):this.bk.g(0,_u.n.Sf,null,!1,null,null,_u.n.DB,this.bk.z)}},fd:function(n){if(n.b()<120){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Timeout header recieved with less than 2 minutes until session expires");this.bg.c(_a.dJ,this.cV);var i=this,t=this;this.bl().a("Save",function(){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Save was successful");i.eQ(!0)},function(){_j.e.a(_a.a.a,"OnSessionTimeoutEvent: Save was unsuccessful");t.eQ(!1)},!1)}},fb:function(n,t){if(n){_j.e.a(_a.a.a,"HandleSessionTimeoutDialog: Logout for user");var r=new _a.bE;this.bg.a(_a.bE,r);var i=new _a.cn(this.dv.d());this.bg.a(_a.cn,i)}}};_mcp.j=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si){this.o=Function.createDelegate(this,this.A);this.b=Function.createDelegate(this,this.y);_mcp.j.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si]);this.ba.cq()&&this.bg.b(_mco.g,this.b)};_mcp.j.prototype={bm:function(){return!0},bD:function(){return"MailInlineCompose"},ek:function(){return!0},g:null,e:function(n){_mcp.e.prototype.e.call(this,n);IInlineComposeConductorViewModel.isInstanceOfType(n)&&(this.g=n.f())},ex:function(){this.ba.cq()&&this.bg.c(_mco.g,this.b);_mcp.e.prototype.ex.call(this)},y:function(n){if(this.ba.bh().Id===n.b.Id)if(this.C(n.a.f())){var i=this.ba.a();this.ba.d(14);this.ba.cd(n.a.a().bk.ItemId);var r=this.bO.h(this,0);var t=this;this.bp.a(r,function(i){t.bb.a(1003);t.bg.a(_mco.f,new _mco.f(n.a));t.h(!0,"")},this.o,null);this.ba.d(i)}else{this.bb.a(1004);this.h(!1,"Recipients differ")}},C:function(n){if(this.ba.c().b()>0)return!1;var r=n.m().f();var i=n.o().f();var t=new _j.q(this.bc().s());if(!this.q(r,t)||!this.q(i,t))return!1;this.r(r,this.bc().o());this.r(i,this.bc().l());return!0},q:function(n,t){for(var u=n.length,i=0;i<u;i++){var r=n[i].EmailAddress;if(!t.g(r))return!1}return!0},r:function(n,t){var r=!!t.b;var u=!!t.a;r&&t.b.C();u&&t.a.C();for(var f=n.length,i=0;i<f;i++){r&&t.b.l(n[i]);u&&t.a.bB(n[i])}},A:function(n){this.bb.a(1004);this.h(!1,n.J.toString())},h:function(n,t){var i=new _a.o;i.c("S",n);i.b("err",t);var r=_a.d.b(_a.a.a,"RPCountDraftReparent");r.j=i.toString();_a.d.a(r)}};_mcp.l=function(n,t,i){this.b=n;this.c=t;this.g=!!i&&i.a().F().Enabled};_mcp.l.b=function(n){return n.EmailAddress?n.EmailAddress.toLowerCase():n.ItemId.Id};_mcp.l.prototype={b:null,g:!1,d:null,c:!1,a:null,e:null,f:null,h:function(){!this.d&&this.b&&(this.d=_a.I.a(this.b.EmailAddress));return this.d},m:function(n){if(!this.c)return n.val.f();_j.e.a(_mcp.l.a,"begin calculating initial audience");var t=new _j.l;this.a={};if(this.b){_j.e.a(_mcp.l.a,"adding always keep address "+this.h()+" as the first To recipient");t.a(this.b);this.a[this.h()]=0}this.i(t,n.val.f(),0);this.i(t,n.val.j(),1);_j.e.a(_mcp.l.a,"end calculating initial audience");this.l(t,n);return t},o:function(n,t){if(_rw.d.isInstanceOfType(n)){this.e=n;if(this.g&&this.b)for(var u=this.e.E,i=0;i<u.b();i++){var r=u.c(i);if(_a.I.a(r.k.a().EmailAddress)===this.d){r.j.E(!0);break}}}this.f=t},l:function(n,t){if(!this.c||!n){t.val.q(n);return}for(var f=new _j.l,e=new _j.l,o=n.x.length,r=0;r<o;r++){var i=n.x[r];var u=_mcp.l.b(i);if(u in this.a)this.a[u]?e.a(i):f.a(i);else{_j.e.a(_mcp.l.a,"Email address "+u+" is not in the local bookkeeping, add it to To");f.a(i)}}t.val.q(f);t.val.ba(e);if(this.f){this.f.D(e);_j.e.a(_mcp.l.a,"Update Cc recipient well with the separated Cc recipients")}},n:function(n,t){if(this.c){var i=t.c;_j.e.a(_mcp.l.a,"user edited the To recipients, processing the "+i+" change");var u=t.b;var r=t.a;switch(i){case 0:this.j(r);break;case 2:this.k(u);break;case 3:this.k(u);this.j(r);break;default:throw Error.notImplemented("a new NotifyCollectionChangedAction "+i+" has been introduced and to recipient helper does not work with it");}}},k:function(n){if(n)for(var f=n.length,r=0;r<f;r++){var u=n[r].k.a();var t=_mcp.l.b(u);_j.e.a(_mcp.l.a,"recording removed recipient "+t);if(t in this.a)if(t===this.h()){var i=this;_j.n.a().a(_mcp.l.a,"ProcessAlwaysKeepRecipients",function(){if(i.e){_j.e.a(_mcp.l.a,"adding the always keep address "+t+" back in To well");var n=i.e.bB(i.b);i.g&&n.E(!0)}},0)}else{_j.e.a(_mcp.l.a,"removing removed recipient "+t+" from cc recipient well");delete this.a[t]}}},j:function(n){if(n)for(var r=n.length,t=0;t<r;t++){var u=n[t].k.a();var i=_mcp.l.b(u);_j.e.a(_mcp.l.a,"adding added recipient "+i+" to local copy");this.a[i]=0}},i:function(n,t,i){var e=t?t.b():0;_j.e.a(_mcp.l.a,"merging "+e+" "+i+" partial audience into audience");for(var r=0;r<e;r++){var f=t.c(r);var u=_mcp.l.b(f);if(!(u in this.a)){n.a(f);this.a[u]=i}}}};_mcp.bn=function(n,t,i,r,u,f,e,o){this.N=Function.createDelegate(this,this.R);this.A=Function.createDelegate(this,this.J);this.M=Function.createDelegate(this,this.P);_mcp.bn.initializeBase(this);this.I=o;this.l=o.b;this.n=n;this.v=t;this.m=o.a;this.y=i;this.D=r;this.G=u;this.F=f;this.E=e};_mcp.bn.prototype={v:null,n:null,l:null,m:null,I:null,y:null,D:null,G:null,F:null,E:null,r:null,o:0,x:!1,L:!1,z:null,p:null,s:null,w:!1,f:function(){this.r||(this.r=new _y.bm);return this.r},e:function(n){this.r=n;return n},q:function(){return this.m?this.m.cj():null},C:null,k:function(n){this.C=n;return n},c:function(n){_a.G.b(_a.a.w,"MailComposeReplyLoad",3);this.w=!0;this.p=_y.j.b(_a.a.w,"MailComposeReply",!0);this.s=_y.j.b(_a.a.w,"MailComposeReplyLoad",!0);this.l.bk.ConversationId?this.n.n("Inference.Reply",this.l.bk.ItemId,this.l.bk.ConversationId,this.m?this.m.O():null,this.q()):this.n.a("Inference.Reply",this.l.bk.ItemId,this.q());this.t(1,n)},d:function(n){_a.G.b(_a.a.w,"MailComposeReplyAllLoad",3);this.w=!0;this.p=_y.j.b(_a.a.w,"MailComposeReplyAll",!0);this.s=_y.j.b(_a.a.w,"MailComposeReplyAllLoad",!0);this.l.bk.ConversationId?this.n.n("Inference.ReplyAll",this.l.bk.ItemId,this.l.bk.ConversationId,this.m?this.m.O():null,this.q()):this.n.a("Inference.ReplyAll",this.l.bk.ItemId,this.q());this.t(2,n)},h:function(n){this.x=!0;this.d(n)},i:function(n){this.L=!0;this.d(n)},b:function(n){this.n.a("Inference.PostReply",this.l.bk.ItemId,this.q());this.t(12,n)},a:function(n){_a.G.b(_a.a.w,"MailComposeForwardLoad",3);this.w=!0;this.p=_y.j.b(_a.a.w,"MailComposeForward",!0);this.s=_y.j.b(_a.a.w,"MailComposeForwardLoad",!0);this.l.bk.ConversationId?this.n.n("Inference.Forward",this.l.bk.ItemId,this.l.bk.ConversationId,this.m?this.m.O():null,this.q()):this.n.a("Inference.Forward",this.l.bk.ItemId,this.q());this.t(3,n)},g:function(n){this.x=!0;this.a(n)},j:function(){if(!this.I.l())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.b.a.nameToId("drafts");var n=new _mcp.bs(this.l.bk.ItemId.Id,t.Id);n.d(this.M);n.e(this.A);_a.g.a.a(n)},P:function(n){var i=n.i;if(i.length>0){var t=this.D.i(_g.g.b(i));t.d(this.N);t.e(this.A);_a.g.a.a(t)}else this.J(n)},J:function(n){this.m.C().b(9500);this.m.C().a(9500)},R:function(n){var t=n;if(t.c){this.m.C().b(9500);var i=this.y.b(t.j[0],!1,t.c.du(),t.c.bB());_y.c.a.c()||i.t(0);this.f().a(i)}else this.J(n)},t:function(n,t){this.o=n;this.S(t)},S:function(n){var u=_dg.a.isInstanceOfType(this.l);n||(n=!_y.c.a.c());var t=this.y.a(n,!1);t.bc(this.w);n&&t.t(0);var f=null;switch(this.o){case 1:f=!t.k()||u?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:f=!t.k()||u?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:f=!t.k()||u?"MailComposeForwardPopOut":"MailComposeForward";break;default:break}if(f&&this.p){this.p.q=f;t.v(this.p);t.bb(this.s);t.bv()}t.eb(this.l.bk.ParentFolderId);this.m&&t.ec(this.m.cu());t.d(this.o);t.cI(!0);t.eN=this.x;t.fv=this.L;t.g(!t.eN||this.o===3);var i=new _g.O;i.Mailbox=new _g.f;i.Mailbox.EmailAddress=this.v.c().bk.UserEmailAddress;i.Mailbox.Name=this.v.c().bk.UserDisplayName;i.Mailbox.MailboxType="Mailbox";i.Mailbox.RoutingType="SMTP";t.ef(i);t.fb=this.C;if(u){var r=this.l;if(r.cj())t.K(r);else{t.dK(_dg.a.a(r));t.cA(t.cy(r));t.cd(this.l.bk.ItemId);t.cH(_dg.a.e(r))}}else t.K(this.l);if((this.o===1||this.o===2)&&_g.i.isInstanceOfType(this.l)){var o;var e=this.l;var l=this.K(e.v())+this.K(e.o())+this.K(e.m());o=this.o===1?"MailComposeBeforeReply":"MailComposeBeforeReplyAll";var c=_a.d.b(_a.a.w,o);c.j=l.toString();_a.d.a(c)}if((_g.i.isInstanceOfType(this.l)||u)&&t.fA(this.l)){var s=_a.p.d();s&&t.hn(this.l.dh());if(this.l.cn()||t.I()&&s){var h=this;this.Q(function(n){n.b(t,h.l,h.o)})}else this.f().a(t)}else this.f().a(t)},Q:function(n){_j.e.a(_a.a.k,"[MailResponseViewModel] Creating Smime command factory.");var t=this;this.G.a(function(i){t.F.a(function(r){t.E.a(function(u){t.z||(t.z=t.O(i,r,u));_j.e.a(_a.a.k,"[MailResponseViewModel] Executing smime operation.");n(t.z)})})})},O:function(n,t,i){_j.e.a(_a.a.k,"[MailResponseViewModel] Creating SmimeMailResponseViewModelCommand instance.");var r=null;r=n.f();var f=this,u=this;r.a(this,this.v,function(n,i){i.cA(i.cy(n));var u=t.a(n.bk.ItemId,i.cr(),i.cj(),_dg.a.a(n));var r=t.b(200,u,i.cj());r.X=i.b();return r},function(n,t,r){var u=new _mcp.bZ(n,t,r,i);return u.toString()});return r},K:function(n){return n?n.b():0}};_mcp.bo=function(n,t,i,r,u,f,e){this.e=n;this.h=t;this.f=i;this.b=r;this.g=u;this.d=f;this.c=e};_mcp.bo.prototype={e:null,h:null,f:null,b:null,g:null,d:null,c:null,a:function(n){return new _mcp.bn(this.e,this.h,this.f,this.b,this.g,this.d,this.c,n)}};_mcp.Q=function(){_mcp.Q.initializeBase(this)};_mcp.Q.prototype={a:null,d:"Normal",e:!1,f:!1,b:!1,c:!1,i:!1,j:!1,g:null,h:!1,k:!1,l:!1,r:function(){if(!this.a){this.a=new _j.l;this.a.a("Normal");this.a.a("Personal");this.a.a("Private");this.a.a("Confidential")}return this.a},o:function(n){if(this.d!==n){this.d=n;this.eu("Sensitivity")}return n},m:function(n){if(this.e!==n){this.e=n;this.eu("IsDeliveryReceiptRequested")}return n},n:function(n){if(this.f!==n){this.f=n;this.eu("IsReadReceiptRequested")}return n},v:function(n){if(this.h!==n){this.h=n;this.eu("ShowSmimeOptions")}return n},p:function(n){if(this.b!==n){this.b=n;this.eu("SmimeEncryptMessage")}return n},q:function(n){if(this.c!==n){this.c=n;this.eu("SmimeSignMessage")}return n},w:function(n){if(this.i!==n){this.i=n;this.eu("SmimeEncryptMessageIsEnabled")}return n},x:function(n){if(this.j!==n){this.j=n;this.eu("SmimeSignMessageIsEnabled")}return n},y:function(n){if(this.l!==n){this.l=n;this.eu("WaitingForPreviousAction")}return n},t:function(n){if(this.g!==n){this.g=n;this.eu("Conductor")}return n},s:function(n){this.k=n.I();this.v(_a.p.a&&_a.p.i()&&n.dy());this.y(!1);this.o(n.y());this.m(n.Y());this.n(n.Z());this.p(n.o());this.q(n.r());this.w(n.ds());this.x(n.dt())},ex:function(){this.g=null;this.a.f();var n;_a.h.a(n={val:this.a}),this.a=n.val;_a.jb.prototype.ex.call(this)}};_mcp.bb=function(n){_mcp.bb.initializeBase(this);this.h=n;var t=_a.c.cb();if(t.length>=3){this.c=new _mcp.ba(t[0]);this.e=new _mcp.ba(t[1]);this.f=new _mcp.ba(t[2])}};_mcp.bb.prototype={h:0,b:null,a:0,d:!1,g:"",c:null,e:null,f:null,l:function(){return(this.h&3)==3},j:function(n){if(this.d!==n){this.d=n;this.eu("IsTimeExpirationSelected")}return n},n:function(n){this.a=n;this.j(this.a===1?!0:!1);this.eu("SelectedOption");return n},i:function(n){this.g=n;this.eu("ErrorText");return n},k:function(){return[this.c,this.e,this.f]},m:function(n){if(this.b!==n){this.b=n;this.eu("Conductor")}return n}};_mcp.ba=function(n){this.b=n};_mcp.ba.prototype={b:0,a:null,c:!1,f:function(n){this.a!==n&&(this.a=n);return n},e:function(){var n="";switch(this.b){case 7:n=_nbs.a.Cg;break;case 6:n=_nbs.a.pw;break;case 5:this.c=!0;n=_nbs.a.hr;break}return n},d:function(){var n=0;switch(this.b){case 7:case 6:n=2;break;case 5:n=4;break}return n}};_mcp.bc=function(n){this.a=n};_mcp.bc.prototype={a:!1};_mcp.bY=function(n,t){this.a=n;this.b=t};_mcp.bY.prototype={a:null,b:null};_mcp.bZ=function(n,t,i,r){this.j=new RegExp("<","g");this.i=new RegExp(">","g");this.d=n;this.a=t;this.e=i};_mcp.bZ.prototype={e:0,a:null,d:!1,f:null,toString:function(){_j.e.a(_a.a.a,"Building message headers for reply/fwd. locally.");var a=this.n();var t=this.g(!0);var r=this.g(!1);r&&r.toLowerCase()!==t.toLowerCase()&&(t=String.format(_u.n.QJ,r,t));var o=this.a.cm()||this.a.cJ();var w=o?o.toString():this.a.hF();var h=this.h(!0);var e=this.h(!1);var i,n;var s,u;this.o(s={val:i},u={val:n}),i=s.val,n=u.val;var p=this.b(_nbs.a.fK,t);var k=this.b(_nbs.a.LK,w);var b=h?this.b(_u.n.Os,h.join("; ")):null;var y=e?this.b(_u.n.PT,e.join("; ")):null;var l=this.b(_u.P.b,a);var c=i?this.b(_u.P.P,i):null;var v=n?this.b(_u.P.I,n):null;var f=this.k(p,k,b,y,l,c,v);return this.d?'<p style="color:black;border-top:1pt solid #E1E1E1;padding-top:3pt;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+f.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",f.join("\r\n"))},k:function(){for(var u=[],n=0;n<arguments.length;++n)u[n]=arguments[n];for(var f=new _j.q,r=u,e=r.length,t=0;t<e;++t){var i=r[t];_j.i.a(i)||f.c(i)}return f.j()},n:function(){if(this.a.bk.Subject)return this.a.bk.Subject;else{var n;switch(this.e){case 1:case 2:case 12:n=_u.n.Pl;break;case 3:n=_nbs.a.Zf;break;case 8:n=_nbs.a.TA;break;case 9:n=_nbs.a.ny;break;case 10:n=_nbs.a.OD;break;case 5:case 6:case 7:n="";break;default:n="";break}return String.format(_nbs.a.jS,n,this.a.cF()||_u.R.TD)}},g:function(n){if(_g.i.isInstanceOfType(this.a)){var r=this.a;var i=n?r.bk.From:r.bk.Sender;return i?this.c(i.Mailbox):null}else if(_dg.a.isInstanceOfType(this.a)){var t=this.a;return t.bk.Organizer?this.c(t.bk.Organizer.Mailbox):null}else return null},h:function(n){if(_g.i.isInstanceOfType(this.a)){var i=this.a;return this.m(n?i.m():i.o())}else if(_dg.a.isInstanceOfType(this.a)){var t=this.a;return this.l(n?t.q():t.s(),n)}else return null},o:function(n,t){var i=null;var r=null;n.val=t.val=null;if(_dg.o.isInstanceOfType(this.a)){var f=this.a;i=f.y();r=f.dG()}else if(_dg.a.isInstanceOfType(this.a)){var u=this.a;i=u;r=u}if(r){var e=this.f.a();n.val=e.a(r,null)||" "}i&&(t.val=i.r()?i.r().bk.DisplayName||" ":" ")},m:function(n){if(!n||!n.b())return null;var t=new _j.q;var i=this;n.o(function(n){t.c(i.c(n))});return t.j()},l:function(n,t){if(!n||!n.b())return t?[this.c(this.a.bk.Organizer.Mailbox)]:null;var i=new _j.q;var r=this;n.o(function(n){i.c(r.c(n.bk.Mailbox))});return i.j()},c:function(n){return n?n.Name||n.OriginalDisplayName||n.EmailAddress||"":""},b:function(n,t){return this.d?"<b>"+n+"</b> "+this.p(t):n+" "+t},p:function(n){if(!n)return null;n=n.replace(this.j,"&lt;");n=n.replace(this.i,"&gt;");return n}};_mcp.bp=function(n,t){this.i=Function.createDelegate(this,this.l);this.k=Function.createDelegate(this,this.r);_mcp.bp.initializeBase(this);this.h=n;this.f=t};_mcp.bp.prototype={h:null,f:null,a:null,b:null,g:null,c:null,e:null,n:function(){this.c||(this.c=new _j.g(this.k,_a.a.a));return this.c},m:function(){this.e||(this.e=new _j.g(this.i,_a.a.a));return this.e},bI:function(){this.b||(this.b=new _y.B);return this.b},W:function(n){this.b=n;return n},o:function(n){if(this.a!==n){this.a=n;this.eu("ConsensusSchedulingViewModel")}return n},ex:function(){var t;_a.h.a(t={val:this.c}),this.c=t.val;var n;_a.h.a(n={val:this.a}),this.a=n.val;this.b=null;_a.jb.prototype.ex.call(this)},bx:function(){return 3},w:function(){return null},d:null,p:function(){return this.d},j:function(n){this.d=n;return n},by:function(){return!1},q:function(n){if(this.f){var t=this;this.f.a(function(n){t.o(n.a(_a.c.a().e(),null,0));t.a.p(30);t.a.e(3);t.h.E(t)})}this.g=n},r:function(){var n=this.a.a();this.g(n.d());this.g=null;this.d()},l:function(){this.d()}};_mcp.bf=function(){};_mcp.bf.prototype={setNoRestriciton:0,unknownClassification:1};_mcp.bf.registerEnum("_mcp.bf",!1);_mcp.bg=function(){};_mcp.bg.prototype={others:0,fullComposeCommandingBar:1,fullComposeBottomButton:2,inlineCompose:3};_mcp.bg.registerEnum("_mcp.bg",!1);var IMailComposeComponent=function(){};IMailComposeComponent.registerInterface("IMailComposeComponent");_mcp.ce=function(){};_mcp.ce.registerInterface("_mcp.ce");var IMailComposeAttachmentComponent=function(){};IMailComposeAttachmentComponent.registerInterface("IMailComposeAttachmentComponent");var IMailComposeAutoSaveComponent=function(){};IMailComposeAutoSaveComponent.registerInterface("IMailComposeAutoSaveComponent");var IMailComposeCalendaringInfobarComponent=function(){};IMailComposeCalendaringInfobarComponent.registerInterface("IMailComposeCalendaringInfobarComponent");var IMailComposeCommandingBarComponent=function(){};IMailComposeCommandingBarComponent.registerInterface("IMailComposeCommandingBarComponent");var IMailComposeComplianceComponent=function(){};IMailComposeComplianceComponent.registerInterface("IMailComposeComplianceComponent");var IMailComposeContentConversionComponent=function(){};IMailComposeContentConversionComponent.registerInterface("IMailComposeContentConversionComponent");var IMailComposeContextMenuProvider=function(){};IMailComposeContextMenuProvider.registerInterface("IMailComposeContextMenuProvider");var IMailComposeContextMenuComponent=function(){};IMailComposeContextMenuComponent.registerInterface("IMailComposeContextMenuComponent");var IMailComposeDiscardComponent=function(){};IMailComposeDiscardComponent.registerInterface("IMailComposeDiscardComponent");var IMailComposeEditorComponent=function(){};IMailComposeEditorComponent.registerInterface("IMailComposeEditorComponent");var IMailComposeExtensibilityComponent=function(){};IMailComposeExtensibilityComponent.registerInterface("IMailComposeExtensibilityComponent");_mcp.cf=function(){};_mcp.cf.registerInterface("_mcp.cf");var IMailComposeHashtagComponent=function(){};IMailComposeHashtagComponent.registerInterface("IMailComposeHashtagComponent");var IMailComposeImportanceComponent=function(){};IMailComposeImportanceComponent.registerInterface("IMailComposeImportanceComponent");var IMailComposeInitializerComponent=function(){};IMailComposeInitializerComponent.registerInterface("IMailComposeInitializerComponent");var IMailComposeLinkPreviewComponent=function(){};IMailComposeLinkPreviewComponent.registerInterface("IMailComposeLinkPreviewComponent");var IMailComposeMailTipsComponent=function(){};IMailComposeMailTipsComponent.registerInterface("IMailComposeMailTipsComponent");var IMailComposeMeetingComponent=function(){};IMailComposeMeetingComponent.registerInterface("IMailComposeMeetingComponent");var IMailComposeMessageOptionsComponent=function(){};IMailComposeMessageOptionsComponent.registerInterface("IMailComposeMessageOptionsComponent");var IMailComposePeopleRecommendationsComponent=function(){};IMailComposePeopleRecommendationsComponent.registerInterface("IMailComposePeopleRecommendationsComponent");var IMailComposeNavigationComponent=function(){};IMailComposeNavigationComponent.registerInterface("IMailComposeNavigationComponent");var IMailComposeOmeComponent=function(){};IMailComposeOmeComponent.registerInterface("IMailComposeOmeComponent");var IMailComposePALGenericAttachmentComponent=function(){};IMailComposePALGenericAttachmentComponent.registerInterface("IMailComposePALGenericAttachmentComponent");var IMailComposePhotoComponent=function(){};IMailComposePhotoComponent.registerInterface("IMailComposePhotoComponent");var IMailComposePolicyTipsComponent=function(){};IMailComposePolicyTipsComponent.registerInterface("IMailComposePolicyTipsComponent");var IMailComposeRecipientComponent=function(){};IMailComposeRecipientComponent.registerInterface("IMailComposeRecipientComponent");var IMailComposeRecipientSummarizationComponent=function(){};IMailComposeRecipientSummarizationComponent.registerInterface("IMailComposeRecipientSummarizationComponent");var IMailComposeSaveComponent=function(){};IMailComposeSaveComponent.registerInterface("IMailComposeSaveComponent");var IMailComposeSendAsContextMenuComponent=function(){};IMailComposeSendAsContextMenuComponent.registerInterface("IMailComposeSendAsContextMenuComponent");_mcp.cg=function(){};_mcp.cg.registerInterface("_mcp.cg");var IMailComposeSendComponent=function(){};IMailComposeSendComponent.registerInterface("IMailComposeSendComponent");var IMailComposeShareAttachmentComponent=function(){};IMailComposeShareAttachmentComponent.registerInterface("IMailComposeShareAttachmentComponent");var IMailComposeSignatureComponent=function(){};IMailComposeSignatureComponent.registerInterface("IMailComposeSignatureComponent");var IMailComposeTouchComponent=function(){};IMailComposeTouchComponent.registerInterface("IMailComposeTouchComponent");var IMailComposeUpgradeComponent=function(){};IMailComposeUpgradeComponent.registerInterface("IMailComposeUpgradeComponent");_mcp.by=function(n,t,i,r){this.p=Function.createDelegate(this,this.t);this.m=Function.createDelegate(this,this.u);this.o=Function.createDelegate(this,this.s);_mcp.by.initializeBase(this,[32,n]);this.k=i;this.e=t;this.j=r};_mcp.by.prototype={k:null,e:null,j:null,c:null,f:null,g:function(){if(this.d()){_j.e.b(_a.a.a,"MailComposeAtMentionComponent is already initialized, skipping redundant Initialize call.");return}if(this.e&&this.e.c()&&this.j){this.j.a(this.o);this.e.d()&&this.r()}_mcp.G.prototype.g.call(this)},bt:function(){this.c&&this.q();var n;_a.h.a(n={val:this.f}),this.f=n.val;_mcp.G.prototype.bt.call(this)},a:function(){return this.f},b:function(){return!this.e||!this.e.d()},n:function(){var n=this.bi.a.bb;n.a(10302,null);this.bh.bf()},v:function(){var n=this.bi.a.bb;n.b(10302);this.bh.bf()},i:function(n){if(this.bj)if(n.b()){this.c.a(n.a(),this.bj.eM);this.n()}else{var i=this.bh.bc().b(0);var t=this.bh.bc().b(1);this.c.b(n,this.bj.eM,i,t)}},l:function(n){if(n.a()&&this.bj){var t=this.bj.eM;if(n.b()){this.c.c(n.a(),t);_cmc.d.h(t)||this.v()}else{var i=this.bh.bc().b(0);this.c.d(n,t,i,_cmc.d.g)}}},h:function(){return this.bj?_cmc.d.f(this.bj.eM):null},s:function(n){this.c=n;this.k.b(_y.cw,this.m)},r:function(){this.f=new _j.g(this.p,_a.a.a);_cmc.d.h(this.bj.eM)&&this.n()},q:function(){this.k.c(_y.cw,this.m);this.c=null},u:function(n){var t=this.bh.bc().b(0);this.bj&&t&&n.b()===t.q()&&this.c.e(n.a(),this.bj.eM)},t:function(){var t=_j.i.c("{0}{1}","OWAALLAM",_cmc.h.a());var r=_cmc.d.k("@all",t);var n=new _cmc.l(0,r,!0,7);n.q=!1;n.n=!0;this.bj.cC(n);this.n();this.bj.eM[t]="at-all";var i=new _a.br(1,"AtAllMention_AddedUsingButton");_a.r.c.a(i)}};_mcp.n=function(n,t,i,r,u,f,e){this.bn=Function.createDelegate(this,this.bP);this.bd=Function.createDelegate(this,this.bZ);this.X=Function.createDelegate(this,this.bW);this.ba=Function.createDelegate(this,this.bX);this.bb=Function.createDelegate(this,this.bK);this.bc=Function.createDelegate(this,this.bY);this.bu=Function.createDelegate(this,this.bJ);this.bB=Function.createDelegate(this,this.bO);this.bz=Function.createDelegate(this,this.cc);this.bA=Function.createDelegate(this,this.ce);this.by=Function.createDelegate(this,this.cb);this.bx=Function.createDelegate(this,this.ca);this.bq=Function.createDelegate(this,this.bS);this.br=Function.createDelegate(this,this.bV);this.bp=Function.createDelegate(this,this.bQ);this.q=this.a;_mcp.n.initializeBase(this,[5,n]);this.P=i;this.L=u;this.be=t;this.D=new _j.g(this.bp,this.bk());this.K=r;this.T=f;this.S=e;this.bl=!!this.P&&this.P.a().b().Enabled&&this.P.a().O().Enabled};_mcp.n.prototype={G:null,P:null,K:null,L:null,be:null,T:null,bl:!1,D:null,N:null,bm:null,V:!1,F:null,E:null,R:!1,S:null,bg:!0,M:null,J:null,W:!1,Q:null,i:function(){this.G||this.bE();return this.G},ck:function(n){if(this.G!==n){this.G=n;this.bs("Menu")}return n},ch:function(n){if(this.M!==n){this.M=n;this.bs("InsertButtonCommand")}return n},cj:function(n){if(this.Q!==n){this.Q=n;this.bs("InsertButtonText")}return n},h:function(){if(!this.N){var n=this;this.N=new _j.v(this.br,this.bk(),this.bi.a.ba,"BodyType",function(){return n.bi.a.ba.l()==="HTML"})}return this.N},p:function(n){this.bw("AttachmentWellInitialized",n)},w:function(n){this.bH("AttachmentWellInitialized",n)},a:function(){return this.ew(_mcp.n.a)},x:function(n){this.ev(_mcp.n.a,n);return n},b:function(){return this.a()?this.a().k():!1},j:function(){return this.a()&&this.a().a()?this.a().a().x.length>0:!1},s:function(){return this.a()?this.a().o():0},y:function(n){this.bg=n;return n},k:function(){var n=_a.l.a();return n.c()&&this.K.b()},Z:function(){if(this.bh.cz()&&!this.E){_j.e.a(_a.a.a,"Setting attachment component override");this.E=this.bh.cy().a();this.E.c(this.bq)}},Y:function(){if(this.E){this.E.a();this.E=null}},g:function(){var n=this.bj;this.Z();this.bE();if(this.a()){var t=n.W();this.a().ca(n.h(),n.p(),t,n.b(),n.bf());this.bC(n,t)}else this.be.a(this.bx)},bS:function(){return this.a()},bZ:function(n,t){t==="EditorCallContext"&&this.bh.bH().a(this.a().bd())},o:function(n){this.bm&&this.bm.a(!n)},bW:function(n){if(_a.bq.a){var t=this.bh;_j.n.a().c(_a.a.F,"SafeTriggerPolicyTipsIfNeededForAttachmentAdded",this.by)}this.bi.a.du(this.bi.a.cd)},bX:function(){var t=this.bi.a;var n=t.ba;if(n.h()){this.bD(n);this.a()&&this.a().e(n.h(),n.p(),n.bf())}else t.bl().a("Attach",this.bA,this.bz,!1)},z:function(){if(!this.V&&this.a()){var n=this.bi.a.ba;if(_y.c.a.a()==="Mouse")this.a().e(n.h(),n.p(),n.bf());else{_j.e.a(_a.a.a,"Delaying attachment refresh because we're in not in mouse layout.");this.a().bE(n.h(),n.p(),n.bf(),this.bB)}this.bO();this.bi.a.bg.a(_y.dF,new _y.dF);this.V=!0}},r:function(){this.W||(this.bj.e()?this.bJ():this.bh.eo(this.bu))},u:function(n){this.a()&&this.a().K(n)},bO:function(){var n=this.bi.a.ba;if(n.eL)if(n.p()){var t=new _j.l;t.m(n.p().d());n.eL.p(t);n.eJ()&&n.eJ().p(t)}else{n.eL.p(null);n.eJ()&&n.eJ().p(null)}},t:function(){var n=[];var t=this.bi.b(13);var i=this.bi.b(20);if(t){t.a().b&&Array.add(n,new _y.h(_u.P.n,t.a()));t.b().b&&Array.add(n,new _y.h(_u.P.W,t.b()));this.O()&&Array.add(n,new _y.h(this.I(),this.D))}else i?Array.add(n,new _y.h(this.I(),i.a())):_a.l.a().B()&&Array.add(n,new _y.h(this.I(),this.D));return n},m:function(){var n=new _j.q;var t=this.bi.b(13);var i=this.bi.b(20);if(t){t.a().b&&n.c(new _fm.d(_u.P.n,null,t.a(),!1,null,_u.P.K));t.b().b&&n.c(new _fm.d(_u.P.W,null,t.b(),!1,null,_u.P.C));this.O()&&n.c(new _fm.d(this.I(),null,this.D,!1,null,this.U()))}else i?n.c(new _fm.d(this.I(),null,i.a(),!1,null,this.U())):_a.l.a().B()&&n.c(new _fm.d(this.I(),null,this.D,!1,null,this.U()));return n},A:function(){var n=this.bi.a.ba;if(!_j.i.a(n.bB())&&!this.R&&n.h()&&this.a()){this.R=!0;var t=!1;try{this.a().bA(n.bB(),this.bc,this.bb);t=!0}finally{t||(this.R=!1)}}},C:function(n){this.T&&this.a()&&this.T.a(this.a(),this.bk()).b(n)},l:function(){return this.a().a()},n:function(n,t){this.a().l(n,t)},c:function(n){var i=this.bi.a;var t=i.ba;if(!t||!t.i()){_j.e.a(_a.a.a,"Show not allowed to add attachment due to context={0}; Upgraded={1}",t?"non-null":"null",t.i());i.bk.g(0,this.bU(n),null);return!1}return!0},bQ:function(){var t=this.bi.a;var i=t.ba;_j.e.a(_a.a.a,"Insert attachment start");if(this.c(!1)&&this.a())if(this.E)this.E.b(!1);else if(this.O()){var n=_a.d.b(_a.a.c,"AttachmentsFilePickerPanelOpen");_j.e.a(_a.a.a,"Opening OWA's file picker");this.bM(n,0)}else{_j.e.a(_a.a.a,"Opening OS's file picker");this.a().f(!1,null,null)}this.bh.bi().a("AttachFile");_j.e.a(_a.a.a,"Insert attachment end")},bV:function(){var t=this.bi.a;var i=t.ba;_j.e.a(_a.a.a,"Insert picture start");if(this.c(!0)&&this.a()){if(this.E)this.E.b(!0);else if(this.bl){var n=_a.d.b(_a.a.c,"AttachmentsFilePickerPanelOpen");this.bM(n,1)}else this.a().f(!0,null,null);this.bh.bi().a("InsertPicture")}_j.e.a(_a.a.a,"Insert picture end")},bt:function(){var n=this.a();if(n){n.M(this.ba);n.z(this.X);n.rpcl("EditorCallContext",this.bd);this.a().bo(this.bh.dg);n.dispose();this.x(null)}this.F=null;var r;_a.h.a(r={val:this.N}),this.N=r.val;var i;_a.h.a(i={val:this.D}),this.D=i.val;this.M=null;var t;_a.h.a(t={val:this.G}),this.G=t.val;this.V=!1;this.Y();this.bf(0);_mcp.G.prototype.bt.call(this)},bE:function(){if(!this.G){var n=[];var t=new _fm.d(this.I(),null,this.D,!1,null,this.U());Array.add(n,t);this.ch(this.D);this.cj(_nbs.a.rS);this.bh.bm()||this.ck(new _fm.f(n))}},bC:function(n,t){this.a().cg(!n.i());_j.e.a(_a.a.a,"Attachment component initialized, ReadOnly={0}",t);n.i()&&this.z();this.cl(n);this.bR(n);_mcp.G.prototype.g.call(this)},ca:function(n){var t=this.bj;var i=this.bh;if(this.bo()){_j.e.a(_a.a.a,"InitializeAttachmentWell is exiting early due to null context and/or view model disposing.");return}var h=t.W();var o=!((t.a()===4||t.a()===13)&&!this.K.b());var r=i.bc();var e=!!r.o().a||!!r.l().a||!!r.p().a;if(_y.c.a.a()==="TouchNarrow")this.x(n.a(t.h(),t.p(),t.W(),o,t.bf(),!0,i.bb,t.b(),e));else{var u=n.b(t.h());u.f(t.P());u.j(1);var f=t.V();var s=f?f.EmailAddress:null;this.x(n.c(u,t.p(),t.W(),_y.c.a.a()==="Mouse"?3:0,o&&this.bg,t.bf(),!0,i.bb,t.b(),i.bz,i.dw,i.bL,s,e))}this.a().v(this.ba);this.a().t(this.X);this.a().apcl("EditorCallContext",this.bd);this.a().X(i.dg);this.bN("AttachmentWellInitialized",this);this.bC(t,h);i.du(this.bi.a.cd)},bR:function(n){if(n&&this.a()&&n.a()===3&&this.a().w()){var t=_a.d.b(_a.a.c,"IntentToForwardReferenceAttachment");_a.d.a(t)}},bD:function(n){n.p()||n.U(new _j.l)},ce:function(n){var i=this.bi.a;var t=i.ba;if(n.X===t.b()){this.bD(t);this.a()&&this.a().e(t.h(),t.p(),t.bf());this.A()}},cc:function(n){var t=this.bi.a;var i=t.ba;if(this.a()&&n.X===i.b()){this.a().N();t.bk.p||t.bk.g(0,_nbs.a.op,null);this.A()}},bM:function(n,t){if(this.L){var i=this;this.L.a(function(r){i.F=r;i.F&&i.F.a(i.a(),n,!1,i.bi.a.bL,i.bi.a.bz,i.bh.ba.l()==="Text",t)})}},v:function(){if(this.O()&&this.L){var n=this;this.L.a(function(t){n.F=t;n.F&&n.F.c()})}},O:function(){return!this.bj.S()&&!!this.K&&!!this.S&&this.K.j(this.S.AttachmentDataProviderAvailable)},bY:function(n){this.bi.a.ba.cB(null);this.bK(n)},bK:function(n){n.z(this.bc);n.bc(this.bb);this.R=!1},I:function(){return this.O()?_u.P.k:_u.P.A},U:function(){return this.O()?_u.P.X:_u.P.D},bJ:function(){if(this.bj){this.bh.bb.b(10301);var n=this.bj.e();if(_g.i.isInstanceOfType(n)&&!n.bI()&&n.bk.HasAttachments&&this.bj.fY()){var u=this.bh.ds().b(n);if(!u.length)return;for(var r=0,t=0;t<n.es().b();t++){var f=n.es().c(t);if(!f.a()){_j.e.a(_a.a.a,"Found attachments from original item to be added: {0}, show infobar.",f.bk.Name);r++}}if(r>0){this.J=new _cmc.g(_a.a.a,"AddOriginalAttachment",!1);var i=this;var e=new _mcp.N(u,r,this.bn,function(){i.W=!0;i.bh.bb.b(10301);i.bf(-1)});this.bh.bb.e(10301,e)}}}},bP:function(){this.W=!0;this.bh.bb.b(10301);var i=this.bj.e();if(i){for(var r=new _j.l,u=0;u<i.es().b();u++){var n=i.es().c(u);if(n.a()){_j.e.a(_a.a.a,"Skip adding original attachment: {0}. IsInline: {1}",n.bk.Name,n.a());continue}var t=new _g.B;t.z(n.bk.AttachmentId.Id);t.e(n.bk.Name||_u.n.Ou);t.g(!1);t.y(i.bk.ItemId.Id);_dg.i.isInstanceOfType(n)?t.c(!0):_dg.c.isInstanceOfType(n)?t.c(!1):_g.B.isInstanceOfType(n)&&t.c(n.bk.IsAttachmentItemAttachment);r.a(t);_j.e.a(_a.a.a,"Original attachment '{0}' added to the collection.",n.bk.Name)}if(r.x.length>0){var f=new _y.F;f.b(r);this.C(f);this.bf(r.x.length)}}},bf:function(n){if(this.J){this.J.a("A",n,!0,!0);this.J.b();this.J=null}},bU:function(n){return this.bh.bm()?n?_nbs.a.CC:_nbs.a.gS:n?_nbs.a.Wl:_nbs.a.qK},cb:function(){_mcp.G.a(this.bh,8)},cl:function(n){n.by()&&n.by().x.length>0&&this.a().R(new _h.bP(n.by().d()))}};_mcp.W=function(n,t,i,r,u){this.C=Function.createDelegate(this,this.bf);this.K=Function.createDelegate(this,this.bg);this.L=Function.createDelegate(this,this.bl);this.D=Function.createDelegate(this,this.bn);_mcp.W.initializeBase(this,[n,t,i,r,u])};_mcp.W.prototype={p:null,g:function(){var n=this.bh;var t=n.ba;_j.e.a(_a.a.a,"Enabling timer during initialization of auto save component");this.p=this.bm();this.p.b=!0;if(!t.bm()){this.bp();_j.e.a(_a.a.a,"Auto save timer started")}_mcp.y.prototype.g.call(this);n.bg.b(_a.cJ,this.D)},bf:function(){var r=this.bh;var n=r.ba;if(!this.cd&&!n.bm()){if(!n.bH()){_j.e.a(_a.a.a,"Auto Save not supported for the current operation {0}",n.a());return}var u=this.bh.bd();_j.e.a(_a.a.a,"Checking dirty before auto save");var t=r.bS();var i=u.b();if(t&&!i){_j.e.a(_a.a.a,"AutoSave");this.p.e();this.a("AutoSave",this.L,this.K,!1)}else{this.p.c();_j.e.a(_a.a.a,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",t,i)}}},bp:function(){var n=this.bi.a.ba;!n.bm()&&n.bH()&&this.p.c()},k:function(){this.p&&this.p.h()},bt:function(){this.k();this.bh.bg.c(_a.cJ,this.D);_mcp.y.prototype.bt.call(this)},bm:function(){return new _mcp.bW(this.C,this.E())},E:function(){return 6e4},J:function(n){_mcp.y.prototype.J.call(this,n);this.n&&n==="AutoSave"&&this.n.o(_mcp.W.a)},bn:function(n){_j.n.a().c(_a.a.a,"Autosave triggered for PAL OnPause event",this.C)},bl:function(n){var i=this.bi;var r=i.a;var t=r.ba;t.dN(!0);t.bm()||this.p.c()},bg:function(n){_j.e.a(_a.a.a,"AutoSaveActionFailed: Error: {0}",n.J.message);this.bi.a.ba.bm()||this.p.c()}};_mcp.z=function(n,t,i,r){this.z=Function.createDelegate(this,this.Y);this.r=Function.createDelegate(this,this.V);this.s=Function.createDelegate(this,this.W);this.t=Function.createDelegate(this,this.X);_mcp.z.initializeBase(this,[0,n]);this.y=t;this.u=i;this.v=r;this.i=new _a.j};_mcp.z.prototype={u:null,v:null,i:null,l:null,k:null,o:null,p:null,q:null,m:null,e:null,C:null,y:null,w:0,h:null,b:function(){return this.C},a:function(){return this.e},Z:function(n){if(this.e!==n){this.e=n;this.bs("ComposeCommandingBar")}return n},E:function(){return this.bj.S()?this.bh.bh().a():this.bh.bh().n()},I:function(){return this.bh.bq().a()},S:function(){return this.bh.bv().f()},N:function(){return this.bh.bn().b()},P:function(){return this.bh.bl().j()},n:function(){return this.bh.bd().i()},x:function(){this.q||(this.q=new _fm.g(this.S(),_u.P.M,_mcp.d.B(),0,null,_mcp.d.C(),!1,!1,!1,!1));return this.q},R:function(){this.l||(this.l=this.bj.S()?new _fm.g(this.E(),_u.P.e,_mcp.d.P(),0,null,null,!1,!1,!1,!1):new _fm.g(this.E(),_u.P.o,_mcp.d.S(),0,null,null,!1,!1,!1,!1));return this.l},J:function(){this.m||(this.m=new _fm.g(this.I(),_u.n.ON,null,0,null,null,!1,!1,!1,!1));return this.m},K:function(){if(!this.k)if(this.n().p.x.length>1){var n=this;this.k=new _fm.l(_nbs.a.fS,function(t){t(n.n())},0,_nbs.a.fS,!1,!1,_mcp.d.o(),null)}else this.n().p.x.length===1&&(this.k=new _fm.g(this.n().p.x[0].m,_nbs.a.rS,_mcp.d.o(),0,null,null,!1,!1,!1,!1));return this.k},O:function(){this.o||(this.o=new _fm.g(this.N(),null,_mcp.d.O(),0,_u.n.CE,null,!0,!1,!1,!1));return this.o},Q:function(){this.p||(this.p=new _fm.g(this.P(),null,_mcp.d.H(),0,_u.n.Rc,null,!0,!1,!1,!1));return this.p},M:function(){return this.u.i()},L:function(){if(!this.bh||!this.bh.bo)return!1;var i=!!this.bh.bo.a().l()&&this.bh.bo.a().l().Enabled;var t=!!this.bh.bo.a().f()&&this.bh.bo.a().f().Enabled;var n=!!this.bh.bo.a().j()&&this.bh.bo.a().j().Enabled;return i||t||n},D:function(){return!!this.bh&&!!this.bh.bo&&!!this.bh.bo.a()&&!!this.bh.bo.a().f()&&this.bh.bo.a().f().Enabled},g:function(){if(this.d()){_j.e.a(_mcp.z.a,"Commanding bar component is already initialized, skipping redundant Initialize call.");return}if(!this.bh.bm()){_j.e.a(_mcp.z.a,"Initializing compose commanding bar");this.Z(new _fm.j(_u.R.Ss));this.e.T=!0;this.e.F=!0;this.e.s=!0;this.j(this.R(),!0);this.j(this.K(),!0);this.bj.k()!==3&&(!this.L()||this.bh.bs())&&this.j(this.x(),!1);this.j(this.J(),!0);this.D()&&this.T();(this.y.b||this.bh.bs())&&!this.bj.dj()&&this.j(this.Q(),!0);this.bi.a.apcl("ShouldShowToolbarMessage",this.t);if(this.bh.br().d()){_j.e.a(this.bk(),"Primary init is complete; creating commanding bar affordance menu synchronously.");this.A()}else{_j.e.a(this.bk(),"Scheduling commanding bar affordance menu creation because primary initialization has not finished.");this.bh.br().apcl("IsInitialized",this.s)}this.bi.a.bs()||this.bi.a.ba.k()===3||this.j(this.O(),!0);this.e.V();this.F(this.bh.bv().k());this.c(0);_j.e.a(_mcp.z.a,"Completed initializing compose commanding bar")}_mcp.G.prototype.g.call(this)},c:function(n){if(this.e){var u=this.bh.bs();var r=this.M();var t;var i;if(u){t=0;i=0}else{t=r?20:n;i=r?n:20}this.e.bp(t);this.e.X(i)}},bt:function(){this.bi.a.rpcl("ShouldShowToolbarMessage",this.t);this.h&&this.h.rpcl("ComposeItems",this.r);var n;_a.h.a(n={val:this.e}),this.e=n.val;_mcp.G.prototype.bt.call(this)},A:function(){_j.e.a(_mcp.z.a,"Adding affordance items to compose commanding bar");var n=new _j.q;this.f(n,8);this.f(n,11);this.f(n,1);this.f(n,28);this.f(n,6);this.f(n,3);this.f(n,15);this.f(n,9);for(var t=0;t<n.d.length;t++)this.e.a(n.d[t]);var i=n.d[0];i?_j.e.a(_mcp.z.a,"Completed added affordance items to compose commanding bar"):_j.e.b(_mcp.z.a,"Affordance menu item at index 0 is null.")},f:function(n,t){var r=null;var i=this.bi.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting affordance menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.d());i.d()||i.g();r=i;n.h(r.P())}},j:function(n,t){if(!this.e.bn(n)){n.a(!0);n.b(t);this.e.a(n)}},U:function(n,t){if(this.e&&!this.e.bn(t)){t.a(!0);t.b(!0);this.e.W(n,t)}},X:function(n,t){var i=!this.bi.a.ca;this.ba(i)},ba:function(n){if(this.e)for(var r=this.e.b.x.length,t=0;t<r;t++){var i=this.e.b.x[t];i&&i.d!==1&&i.a(n)}},F:function(n){this.e&&!this.e.cd&&this.e.bn(this.x())&&this.x().b(n)},W:function(n,t){this.bh.br().rpcl("IsInitialized",this.s);_j.n.a().c(_a.a.a,"AddAffordanceMenuItemsToComposeCommandingBar",this.z)},Y:function(){if(!this.cd&&this.e&&!this.e.cd&&this.e.b){this.e.s=!0;this.A();this.e.V()}else _j.e.a(this.bk(),"OnInitializerComponentPrimaryInitCompleted - commanding bar or its item collection is null, skipping affordance async init.")},T:function(){if(this.D()&&this.bh&&!this.bh.bs()&&this.bj.k()!==3){this.w=this.e.b.x.length;var n=this;this.v.a(function(t){if(t.h()&&!n.bo()){n.h=t;n.G();t.apcl("ComposeItems",n.r)}})}},G:function(){if(this.h&&this.h.a()){for(var t=0;t<this.i.b();t++)this.e.bo(this.i.a(t));this.i.m();for(var i=this.h.a(),n=0;n<i.b();n++){this.U(this.w+n,i.a(n));this.i.c(i.a(n))}}},V:function(n,t){this.G()}};_mcp.D=function(n,t,i,r){this.x=Function.createDelegate(this,this.J);this.y=Function.createDelegate(this,this.K);this.s=Function.createDelegate(this,this.F);this.z=Function.createDelegate(this,this.w);_mcp.D.initializeBase(this,[3,n,i,r]);this.E=t;this.k=!1};_mcp.D.b=function(n,t){return new _y.h(n,t)};_mcp.D.c=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.D.prototype={E:null,p:null,j:null,o:null,m:null,n:!1,r:null,i:null,l:null,b:function(){return"IsIrmProtected"},h:null,f:null,a:function(){return this.n},q:function(n){if(this.n!==n){this.n=n;this.bs("IsIrmProtected")}return n},e:function(){return this.r},I:function(n){if(this.r!==n){this.r=n;this.bs("ShowIrmInformationCommand")}return n},c:function(){return this.i},G:function(n){if(this.i!==n){this.i=n;this.bs("DialogViewModel")}return n},k:!1,u:function(){var i=_g.a.a();if(i.e()&&!i.e().bk.Irm||this.bM.d()){_j.e.a(_a.a.a,"IRM segmentation flag has been turned off or user is consumer, cannot set compliance.");return!1}var n=this.bi.a.ba.F();var t=!n||!!n.a()||n.b()||n.l();_j.e.a(_a.a.a,"CanSetCompliance={0}",t);return t},v:function(){return!this.bj.S()&&this.u()&&!this.bh.bm()},g:function(){var n=this.bh;var u=n.ba;var o=n.dX;var r=n.bt;if(this.u())if(_g.k.b){_j.e.a(_a.a.a,"Checking main window for compliance configuration");this.f=_mcp.D.a;_g.k.b.jn(this.z)}else if(r.WasLoadedFromServer)this.w(r);else{_j.e.a(_a.a.a,"Adding the loading permissions menu item");this.f=_mcp.D.a;if(!r.IsLoadingFromServer){_j.e.a(_a.a.a,"Submitting GetComplianceConfigurationAction");var e=n.bg;e.b(_a.cC,this.s);var s=new _h.cb(r,n.bg);s.i()}}else if(this.f&&this.k&&o.a){n.dX.s(this.f);this.k=!1}var t=u.F();this.q(!!t&&!t.a());if(this.n&&"Mouse"===_y.c.a.a()){var i=n.bw();i.a.apply(i,[4499].concat([t.bk.TemplateName,t.bk.TemplateDescription]));i.a.apply(i,[4500].concat([t.bk.ContentOwner]))}else if(u.bo()){var f=n.bw();f.a.apply(f,[3800].concat([u.ck(),u.cl()]))}"Mouse"===_y.c.a.a()||this.r||this.I(new _j.g(this.y,this.bk()));_mcp.p.prototype.g.call(this)},bt:function(){this.bh.bg.c(_a.cC,this.s);var t;_a.h.a(t={val:this.i}),this.i=t.val;var n;_a.h.a(n={val:this.l}),this.l=n.val;this.q(!1);_mcp.p.prototype.bt.call(this)},bP:function(){if(this.v()){!this.h&&this.bh.bt.WasLoadedFromServer&&this.t();if(this.h){this.j=new _fm.k(_nbs.a.nz,null,this.h);return[this.j]}else if(this.u()&&this.bh.bt.IsLoadingFromServer){this.j=new _fm.k(_nbs.a.nz,null,null);this.j.a(!0);this.p=new _fm.d(_u.P.d,null,null);return[this.p,this.j]}else _j.e.b(_a.a.a,"Compliance sub-menu creation has been skipped.")}return null},bO:function(){if(this.v()){var n=this;this.m=new _fm.l(_nbs.a.nz,function(t){t(n.h)},1,null,!1,!1,null,null);if(this.h)return[this.m];else if(this.u()&&this.bh.bt.IsLoadingFromServer){this.m.a(!1);this.o=_mcp.p.a(null,_u.P.d);return[this.m,this.o]}}return null},bK:function(){if(this.v())return[this.f];else{this.k=!1;return null}},bY:function(){this.o&&this.o.a(!1);if(!this.h&&this.bh.bt.WasLoadedFromServer){this.t();this.h||(this.m=null)}this.m&&this.m.a(!0)},bZ:function(){this.p&&this.p.a(!0);if(!this.h&&this.bh.bt.WasLoadedFromServer){this.t();this.h||(this.j=null)}if(this.j){this.j.u(this.h);this.j.a(!1)}},cy:function(){this.f&&this.bh.dX&&this.bh.dX.s(this.f);this.f=null;this.k=!1;this.t()},D:function(n){var t=this.bi.a.bt;var e=t.RmsTemplates?t.RmsTemplates.length:0;var o=t.MessageClassifications?t.MessageClassifications.length:0;if(0===e&&0===o){_j.e.a(_a.a.a,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var i=new Array(1+e+o);var f=0;i[f++]=n(_nbs.a.r,new _j.g(this.x,this.bk()));for(var u=0,r=0;u<e||r<o;)if(u===e){var c=t.MessageClassifications[r++];i[f++]=n(c.Name,new _j.g(this.A(c.Id),this.bk()))}else if(r===o){var l=t.RmsTemplates[u++];i[f++]=n(l.Name,new _j.g(this.C(l.Id),this.bk()))}else{var s=t.MessageClassifications[r];var h=t.RmsTemplates[u];if(0<h.Name.localeCompare(s.Name)){i[f++]=n(s.Name,new _j.g(this.A(s.Id),this.bk()));r++}else{i[f++]=n(h.Name,new _j.g(this.C(h.Id),this.bk()));u++}}return i},t:function(){if("Mouse"===_y.c.a.a()||_y.c.a.a()==="TouchNarrow"){var i=this.D(_mcp.D.c);i&&(this.h=new _fm.f(i))}else if(!this.k){if(!this.f){var t=this.D(_mcp.D.b);t&&(this.f=new _y.h(_nbs.a.nz,null,t))}var n=this.bh.dX;if(this.f&&n){var r=n.a;if(r){this.ch=[this.f];this.bh.bJ().b();this.k=!0}}}},F:function(n){if(!this.bo()){var t=this.bi.a;this.w(t.bt);t.bg.c(_a.cC,this.s)}},w:function(n){var t=this.bh;t.bt=n;_j.e.a(_a.a.a,"Updating menu with complete compliance configuration.");n.WasLoadedFromServer&&this.br()},J:function(){var i=this.bi.a;var n=i.ba;i.bi().a(_mcp.bf.toString(0));_j.e.a(_a.a.a,"Set no restriction");n.bY("0");var t=i.bw();if(n.F()){if("Mouse"===_y.c.a.a()){t.b(4499);t.b(4500)}n.ce(null);this.q(!1)}else if(n.bo()){t.b(3800);n.cb(!1);n.bV(null);n.bW(null);n.bX(null)}},C:function(n){var t=this;return function(){var h=new _cmc.g(_a.a.a,"MailComposeSetIRM",!0);var e=t.bi.a;var r=e.ba;r.bY(n);if(r.bo()){e.bb.b(3800);t.bh.bf();r.cb(!1);r.bV(null);r.bW(null);r.bX(null)}for(var s=e.bt.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(n.toLowerCase()===u.Id.toLowerCase()){var c="Permission_"+u.Id.toLowerCase();e.bi().a(c);var i=new _g.cL;i.v(n);i.r(_g.a.a().c().bk.UserEmailAddress);i.s(!0);i.t(0);i.x(u.Name);i.w(u.Description);i.q(r.l());r.ce(i);if("Mouse"===_y.c.a.a()){var f=e.bw();f.b(4499);f.b(4500);f.a.apply(f,[4499].concat([u.Name,u.Description]));f.a.apply(f,[4500].concat([i.bk.ContentOwner]))}t.q(!0);_j.e.a(_a.a.a,"Set IRM {0}",u.Name);break}}h.b()}},A:function(n){var t=this;return function(){var u=t.bi.a;var r=u.ba;r.bY(n);if(r.F()&&"Mouse"===_y.c.a.a()){var s=u.bw();s.b(4499);s.b(4500);r.ce(null);t.q(!1)}for(var o=u.bt.MessageClassifications,f=0;f<o.length;f++){var i=o[f];if(n.toLowerCase()===i.Id.toLowerCase()){var h="Classification_"+i.Id.toLowerCase();u.bi().a(h);r.cb(!0);r.bV(i.Name);r.bW(i.Description);r.bX(i.Id);var e=u.bw();e.b(3800);e.a.apply(e,[3800].concat([i.Name,i.Description]));_j.e.a(_a.a.a,"Set class {0}",i.Name);break}}}},K:function(){var t=this.bi.a.ba;if(t.F()){var n=t.F();this.L(n.bk.TemplateName,n.bk.TemplateDescription,n.bk.ContentOwner)}else _j.e.c(_a.a.a,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")},L:function(n,t,i){if(!this.i){this.G(new _bc.k);this.i.n.a(new _ff.d(this.i.o,_nbs.a.EO,null,!0))}this.i.q(n);this.l||(this.l=new _mcp.bi);this.l.d(t);this.l.c(String.format(_nbs.a.cy,i));this.i.s(this.l);this.i.f(!0)}};_mcp.G=function(n,t){this.dE=Function.createDelegate(this,this.ej);this.cI=Function.createDelegate(this,this.ek);_mcp.G.initializeBase(this);this.dF=n;this.bi=t;if(t&&t.a){this.bh=t.a;this.bj=this.bh.ba;this.bL=this.bh.bb}};_mcp.G.a=function(n,t){n&&!n.eK&&n.da().a(t)};_mcp.G.prototype={dF:0,bi:null,bh:null,bj:null,bL:null,dg:!1,d:function(){return this.dg},cg:function(n){this.dg=n;return n},bk:function(){return _a.a.a},bo:function(){return this.cd||!this.bj||!this.bh||this.bh.eK},g:function(){this.cg(!0)},cJ:function(n){var i=this.cx(n);this.bh.dP(i);if(i===55||i===50){var t=this;this.bh.cG.a(function(n){if(!t.bo()){n.a(t.bL);t.bh.bf()}})}else this.bh.bf()},ek:function(n){this.bL.g(n);this.bh.bf()},ej:function(n,t){for(var u=[],i=2;i<arguments.length;++i)u[i-2]=arguments[i];var r;(r=this.bL).i.apply(r,[t,n].concat(u));this.bh.bf()},bt:function(){this.cg(!1);_j.Q.prototype.bt.call(this)},cf:function(){this.bL.n();this.bL.f(_mcp.y.a);this.bL.f(_mcp.u.a);this.bL.f(_mcp.r.b);var n=this;this.bh.cG.a(function(t){if(!n.bo()){t.b(n.bL);n.bh.bf()}})},cx:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));},dh:function(n,t,i,r){t.val=r;i.val="";if(n)if(_g.Q.a(n)){t.val=_g.Q.b(n);i.val=n.FaultMessage}else if(_g.H.isInstanceOfType(n)){t.val=n.responseCode;i.val=n.toString()}}};_mcp.bA=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et){this.f=Function.createDelegate(this,this.k);this.i=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.o);this.c=[];this.e=new _mcp.bz(this,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et);this.a=n};_mcp.bA.prototype={e:null,c:null,a:null,b:function(n){var t=n;this.c[t]||(this.c[t]=this.e.v(n,this.a.bu.a(),this.a.ba.k()));return this.c[t]},n:function(){this.d(this.h)},dispose:function(){this.d(this.g,!0);this.c.length=0;this.c=null;this.a=null},q:function(){_j.e.a(_a.a.a,"Component Map set override start.");this.d(this.i);_j.e.a(_a.a.a,"Component Map set override end.")},l:function(){_j.e.a(_a.a.a,"Component Map clear override start.");this.d(this.f);_j.e.a(_a.a.a,"Component Map clear override end.")},d:function(n,t){if(!!t===t&&t)for(var i=this.c.length-1;i>=0;i--)this.j(n,i);else for(var r=0;r<this.c.length;r++)this.j(n,r)},j:function(n,t){var i=this.c[t];i&&n(i,t)},o:function(n,t){IMailComposeInitializerComponent.isInstanceOfType(n)||n.d()||n.g()},m:function(n,t){var i=Object.getType(n).getName();if(n.cd)_j.e.b(_a.a.a,"Skip component '{0}' at index {1} because it is already disposing.",i,t);else{_j.e.a(_a.a.a,"Disposing component '{0}' at index {1}...",i,t);try{n.dispose()}catch(r){_j.e.d(_a.a.a,r,"Exception in MailComposeComponentMap trying to dispose component '{0}'",i)}}},p:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.Z()},k:function(n,t){IMailComposeOverridable.isInstanceOfType(n)&&n.Y()}};_mcp.bB=function(n,t,i,r){this.l=Function.createDelegate(this,this.q);this.j=Function.createDelegate(this,this.o);this.k=Function.createDelegate(this,this.p);_mcp.bB.initializeBase(this,[15,n,i,r]);this.i=t};_mcp.bB.prototype={a:null,b:null,e:null,c:null,h:null,f:null,i:null,g:function(){this.b||(this.b=new _j.g(this.k,this.bk()));this.a||(this.a=new _j.g(this.j,this.bk()));_mcp.p.prototype.g.call(this)},bt:function(){var t;_a.h.a(t={val:this.b}),this.b=t.val;var n;_a.h.a(n={val:this.a}),this.a=n.val;this.i=null;_mcp.p.prototype.bt.call(this)},bP:function(){if(this.bh.bm())return null;this.e=new _fm.d(_nbs.a.bf,null,this.b);this.c=new _fm.d(_nbs.a.dq,null,this.a,!0);this.br();return[this.e,this.c]},bO:function(){this.h=_mcp.p.a(this.b,_nbs.a.bf);this.f=_mcp.p.a(this.a,_nbs.a.dq);this.br();return[this.h,this.f]},bK:function(){return null},bZ:function(){if(this.c&&this.e){this.c.a(this.bj.l()==="HTML");this.e.a(this.bj.l()!=="HTML")}},bY:function(){this.f.a(this.bj.l()!=="HTML");this.h.a(this.bj.l()==="HTML")},p:function(){_j.e.a(this.bk(),"User chose to convert to plain text");this.bi.a.bi().a("SwitchToPlain");if(this.n(_nbs.a.QC)){this.bi.a.ba.bC().a();var r=this.bi.a.ba.C();var n;var i,t;var f=(t=_a.x.g(r,i={val:n}),n=i.val,t);if(!f){n=r;_j.e.a(this.bk(),"Using html due to failed conversion")}if(n.length>0){var u=this.bi.a.bk;u.h(1,[_nbs.a.XB],this.l,!1,null,null,null,this.i,null)}else this.m()}},q:function(n,t){n&&this.m()},m:function(){var n=this.bi.b(5);n.o(!1);n.a()&&n.a().cl();this.bi.a.ba.n("Text");this.br();_j.e.a(this.bk(),"MailComposeContentConversionComponent.ToPlainText succeeded.")},o:function(){_j.e.a(this.bk(),"User chose to convert to html");this.bi.a.bi().a("SwitchToHTML");if(this.n(_nbs.a.RV)){var t=this.bi;var r=t.a;var i=r.ba;i.n("HTML");this.br();var n=this.bi.b(5);n.o(!0);n.a()&&n.a().bS();_j.e.a(this.bk(),"MailComposeContentConversionComponent.ToHtml succeeded.")}},n:function(n){_j.e.a(this.bk(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!this.bi.a.ba.i()){this.bi.a.bk.g(0,n,null);_j.e.a(this.bk(),"Conversion is not available because the email has not yet been upgraded.");return!1}if(!this.bi.a.ba.bi()){this.bi.a.bk.g(0,n,null);_j.e.a(this.bk(),"Conversion is not available when content is being loaded in editor.");return!1}var t=this.bi.b(5);if(t.a()&&t.a().w()){this.bi.a.bk.g(0,_nbs.a.bG,null);_j.e.a(this.bk(),"Conversion is not available because the email has reference attachments.");return!1}return!0}};_mcp.H=function(n){_mcp.H.initializeBase(this,[16,n])};_mcp.H.prototype={a:function(){return this.ew(_mcp.H.a)},f:function(n){this.ev(_mcp.H.a,n);return n},g:function(){if(this.d()){_j.e.a(_a.a.a,"Context menu component is already initialized, skipping redundant Initialize call.");return}var n=this.e();if(n&&n.d.length>0){_j.e.a(_a.a.a,"Creating context menu items.");this.f(new _fm.f(n.j()))}_mcp.G.prototype.g.call(this)},e:function(){var n=new _j.q;if("Mouse"===_y.c.a.a()){this.b(n,8);this.b(n,11);this.b(n,1);this.b(n,28);this.b(n,6);this.b(n,3);this.b(n,15);this.b(n,9);this.b(n,2)}return n},bt:function(){if(this.a()){this.a().dispose();this.f(null)}_mcp.G.prototype.bt.call(this)},b:function(n,t){var r=null;var i=this.bi.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting context menu items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.d());i.d()||i.g();r=i;n.h(r.Q())}}};_mcp.bC=function(n){_mcp.bC.initializeBase(this,[n])};_mcp.bC.prototype={e:function(){var n=new _j.q;if("TouchNarrow"===_y.c.a.a()){var t;var f=this.bh.bd();var i=f.m();if(i)if(i.d.length>1){t=new _fm.k(_nbs.a.fS,null,new _fm.f(i.d));n.c(t)}else if(i.d.length===1){var u=i.d[0].m;t=new _fm.d(_nbs.a.fS,null,u);n.c(t)}var r=this.bh.bv();t=new _fm.d(_u.P.j,null,r.f());n.c(t);this.b(n,11);this.b(n,1);this.b(n,28);this.b(n,6);this.b(n,3);this.b(n,9)}return n}};_mcp.I=function(n,t,i,r,u){this.U=Function.createDelegate(this,this.bZ);_mcp.I.initializeBase(this,[n,t,i,r,u]);this.V=!!i&&i.a().bM().Enabled;this.bh.bu.k(_mcp.I.a)};_mcp.I.a=function(n){n.a(_nbs.a.CI)};_mcp.I.prototype={V:!1,M:!1,L:function(){return this.V&&this.P()&&!this.bj.eN},ba:function(){return this.L()&&this.u>0&&!this.bJ()},g:function(){if(this.L()){this.u=_j.B.a(_g.a.a().a().bk.MailSendUndoInterval)?0:_g.a.a().a().bk.MailSendUndoInterval;_g.a.a().a().apcl("MailSendUndoInterval",this.U)}_mcp.u.prototype.g.call(this)},bt:function(){this.L()&&_g.a.a().a().rpcl("MailSendUndoInterval",this.U);this.bh.bu.k(_mcp.I.a);_mcp.u.prototype.bt.call(this)},S:function(){this.M=!1;if(this.ba()){_j.e.a(_a.a.a,"Queueing delayed async send.");this.ca();this.M=!0}else{_j.e.a(_a.a.a,"Submitting send action with no delay.");_mcp.u.prototype.S.call(this)}},ca:function(){var n=this;_j.n.a().c(_a.a.a,"QueueAsyncSend",function(){n.bh.bu.m(_mcp.I.a);_j.e.a(_a.a.a,"Firing optimistic save for delayed send.");n.bh.bl().a("Save",function(){_j.e.a(_a.a.a,"Optimistic save for delayed send succeeded.");n.be()},function(){_j.e.b(_a.a.a,"Optimistic save for delayed send failed! Continuing with delayed send anyway...")},!0);n.be();var t=new _mcp.bU(n.u,n.bj,function(){n.bY();n.bh.bu.k(_mcp.I.a);_mcp.u.prototype.S.call(n);n.bh.bT.a(function(){n.s.a(ISendEvent,new _mcp.bq(n.bh))})});n.s.a(IDelayedSendEvent,t)})},be:function(){if(this.bj.P()&&_g.i.isInstanceOfType(this.bj.P())){var n=this.bj.P();if(!n.bf){_h.c.A(n,!0);_j.e.a(this.bk(),"TryFlagDraftAsQueuedForSubmission - draft was successfully updated as queued for submission.")}}else _j.e.b(this.bk(),"TryFlagDraftAsQueuedForSubmission - no draft to update as queued for submission.")},bW:function(){if(this.M)_j.e.a(_a.a.a,"Skipping firing send event for delayed async send.");else{_j.e.a(_a.a.a,"Firing send event for immediate async send.");this.bP()}},cb:function(){if(this.L()){var n=this.bh.bb;n.b(1002);this.u>0&&n.a(1002,this.u.toString())}},bZ:function(n,t){this.u=_g.a.a().a().bk.MailSendUndoInterval;this.cb()}};_mcp.w=function(n){this.w=Function.createDelegate(this,this.I);this.y=Function.createDelegate(this,this.u);this.x=Function.createDelegate(this,this.D);this.v=Function.createDelegate(this,this.C);this.z=Function.createDelegate(this,this.M);this.A=Function.createDelegate(this,this.N);_mcp.w.initializeBase(this,[19,n]);this.o=new _j.g(this.A,this.bk());this.n=new _j.g(this.z,this.bk());this.q=n.a.bP};_mcp.w.prototype={o:null,n:null,q:null,p:null,m:null,t:!1,r:!1,a:function(){return this.o},l:function(){return this.n},f:function(){return this.p},G:function(n){if(n!==this.p){this.p=n;this.bs("DiscardConfirmDialogButtonData")}return n},F:function(n){if(n!==this.m){this.m=n;this.bs("CloseConfirmDialogButtonData")}return n},h:function(){return this.t},i:function(n){if(n!==this.t){this.t=n;this.bs("IsDiscardConfirmDialogShown")}return n},s:function(n){if(n!==this.r){this.r=n;this.bs("IsCloseConfirmDialogShown")}return n},k:function(){var i=this.bi;var t=i.a;var n=t.ba;t.bi().a("Discard");if(n.a()||!n.a()&&(n.h()||t.bl().c())){_j.e.a(_a.a.a,"Discard");this.E(n.b(),n.h())}},e:function(n,t){if(this.q.a(n)){_j.e.a(_a.a.a,"Resuming discard of {0}",_h.Z.a(t));this.E(n,t)}else _j.e.a(_a.a.a,"User had already discarded.")},j:function(){if(!this.bj.eL)return!0;_j.e.a(_a.a.a,"Comparing initial baseline to baseline.");if(!this.bj.eL.s(this.bj.eJ()))return!0;_j.e.a(_a.a.a,"Checking dirty before showing discard confirmation.");return this.bh.bS()?!0:this.bj.bD()?!0:!1},b:function(n){this.bw("IsDiscardingCompose",n)},c:function(n){this.bH("IsDiscardingCompose",n)},bt:function(){this.i(!1);this.s(!1);this.G(null);this.F(null);var t;_a.h.a(t={val:this.o}),this.o=t.val;var n;_a.h.a(n={val:this.n}),this.n=n.val;this.q=null;_mcp.G.prototype.bt.call(this)},L:function(){_j.e.a(_a.a.a,"Checking dirty before showing discard confirmation.");return this.bh.bS()?!0:!1},E:function(n,t){this.D();var i=this.bi.a;var r=i.ba.bG()||i.ba.bD();this.q.b(n,t,i.bp,r)},N:function(){var n=this.bi.a;var t=n.ba;_j.e.a(_a.a.a,"User chose to discard");if(this.j()){this.K();_j.e.a(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. ");this.i(!0)}else{_j.e.a(_a.a.a,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. ");this.C()}},M:function(){var n=this.bi.a;var t=n.ba;_j.e.a(_a.a.a,"User chose to close");if(this.L()){this.J();_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.s(!0)}else{_j.e.a(_a.a.a,"User hit close, we determined there's no need to show confirmation dialog, navigating away.");this.u()}},D:function(){_j.e.a(_a.a.a,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog.");this.i(!1)},I:function(){_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to hide the dialog.");this.s(!1)},K:function(){if(!this.p){_j.e.a(_a.a.a,"Creating discard confirm dialog.");var n=new _j.l;n.a(new _ff.d(new _j.g(this.v,this.bk()),_u.n.Kv,_u.n.LT,!0));n.a(new _ff.d(new _j.g(this.x,this.bk()),_u.n.Ps,_u.n.LJ));this.G(n)}},J:function(){if(!this.m){_j.e.a(_a.a.a,"Creating close confirm dialog.");var n=new _j.l;n.a(new _ff.d(new _j.g(this.y,this.bk()),_u.n.Pu,_u.n.GK,!0));n.a(new _ff.d(new _j.g(this.w,this.bk()),_u.n.JU,_u.n.LJ));this.F(n)}},C:function(){_j.e.a(_a.a.a,"Discard and close");this.k();this.u();this.bh.bc().v("Discard")},u:function(){this.bj.fh(null);this.bh.bn().a(this.bh,!1);_j.e.a(_a.a.a,"Navigated away from compose");this.ci("IsDiscardingCompose")}};_mcp.bD=function(n,t,i,r){this.p=Function.createDelegate(this,this.e);this.h=Function.createDelegate(this,this.w);this.n=Function.createDelegate(this,this.x);this.o=Function.createDelegate(this,this.y);this.r=Function.createDelegate(this,this.v);_mcp.bD.initializeBase(this,[25,n]);this.f=t;this.i=new _j.g(this.r,_a.a.a);var u=n.a.ba;u.dM(this.i);this.k=r;this.l=!!i&&i.a().cz().Enabled;if(this.l){this.bj.gz(this.o);this.bj.gy(this.n)}};_mcp.bD.prototype={l:!1,i:null,f:null,m:!1,q:null,k:null,j:null,b:function(){return this.q},a:function(n){this.q=n;this.bs("EditorCallContext");return n},s:function(){if(this.k&&!this.j){var n=this;this.k.a(function(t){n.j=t})}return this.j},e:function(){this.a(new _cmc.V)},g:function(){if(!this.m){this.z();this.m=!0;_g.a.a().b().w(this.h);_g.a.a().b().J(this.h)}_mcp.G.prototype.g.call(this)},c:function(n,t){var i;if(n){var e=_g.a.a();var r=e.a().bT();var o=(r&1)>0;var u=(r&2)>0;var f=(r&4)>0;i=_j.i.b(t)?"<P><BR></P>":_a.x.e+t+_a.x.d;o&&(i='<strong id="OWAStrongID">'+i+"</strong>");u&&(i='<em id="OWAItalicID">'+i+"</em>");f&&(i='<span id="OWAUnderLineID" style="text-decoration:underline;">'+i+"</span>")}else i=_j.i.b(t)?"\r\n":t;return i},bt:function(){var n;_a.h.a(n={val:this.i}),this.i=n.val;this.A();this.m=!1;this.f=null;_g.a.a().b().D(this.h);_g.a.a().b().O(this.h);this.bj.ha(this.o);this.bj.gZ(this.n);_mcp.G.prototype.bt.call(this)},v:function(){this.a(new _cmc.j(!1))},w:function(n,t){this.e()},z:function(){if(this.f)try{var n=this.f;if(!n.closed){var r=_j.x.b(n);var i=this;r.c("resize",function(n){i.e()},"MCEditorComponent")}}catch(u){var t=this.u(this.f);_j.e.d(this.bk(),u,"Projection window dump: {0}",t)}else _y.c.a.n(this.p)},A:function(){if(this.f){var n=_j.x.b(this.f);n.d("resize","MCEditorComponent")}else _y.c.a.p(this.p)},u:function(n){var t="";for(var i in n)t=t+i+",";return t},y:function(){this.bj.l()==="HTML"&&this.bj.dp()&&this.bj.ff(this.t(this.bj.dp()))},x:function(){this.bj.l()==="HTML"&&this.bj.C()&&this.bj.w(this.t(this.bj.C()))},t:function(n){var t=n;this.l&&this.s()&&(t=this.s().b(n));return t}};_mcp.bE=function(n){_mcp.bE.initializeBase(this,[n,null,null,null])};_mcp.bE.prototype={e:function(){}};_mcp.bF=function(n,t,i){this.l=Function.createDelegate(this,this.w);this.m=Function.createDelegate(this,this.x);this.j=Function.createDelegate(this,this.u);this.k=Function.createDelegate(this,this.v);this.p=Function.createDelegate(this,this.s);_mcp.bF.initializeBase(this,[34,n]);this.n=t;this.f=i;this.c=this.bh.bg;this.e=this.bh.bb};_mcp.bF.prototype={n:null,f:null,e:null,c:null,b:null,h:!1,r:"",o:!1,a:function(){if(!this.o&&!(this.f.bk.GroupSuggestionDismissalCount>=10)){var n=this.bh.bc();if(n&&n.b(0)&&n.b(0).a()&&n.b(0).a().x.length>=2){var e=n.b(0).a();var s=!1;var h=e.x.length;var u=new _j.q;var t={};var c=_g.a.a().c();t[c.bk.LogonEmailAddress]=!0;for(var i=0;i<h;i++){var f=e.x[i];var r=f.k.a().EmailAddress;if(f.j.ba()){s=!0;this.bj.eN||_a.d.c(_a.a.bF,"GroupSuggestionOnCompose_ConversationAlreadyContainsGroup");break}if(!(r in t)){var o=new _g.f;o.EmailAddress=r;u.c(o);t[r]=!0}}if(u.d.length>=2&&!s)this.t(u.j());else if(!this.h){this.i();_a.d.c(_a.a.bF,"GroupSuggestionOnCompose_ContainsGroupToSkipRequest")}}else if(!this.h){this.i();_a.d.c(_a.a.bF,"GroupSuggestionOnCompose_NotEnoughRecipientsToSkipRequest")}}},q:function(n,t){if(this.e&&this.e.h(10307)&&this.b){this.b.c=t;this.b.v(n);this.b.K()}else{this.b=new _mcp.P(this.p,this.n,this.c,this.bh.bc(),this.bh.dd,n,t,this.bh.bk);this.e.e(10307,this.b);this.c.b(ICreateGroupInGroupSuggestionEvent,this.k);this.c.b(ICreateGroupCompleteInGroupSuggestionEvent,this.j)}},s:function(){var t=this.f.bk.GroupSuggestionDismissalCount;if(t>=9){var n=this;this.bh.bk.g(2,_nbs.a.aL,function(i,r){if(i){n.f.bh(t+1);_h.f.a(n.f.v,_a.g.a);n.i();_a.d.c(_a.a.bF,"GroupSuggestionOnCompose_DismissSuggesstionPermanently")}r},!1,"","",_nbs.a.mM)}else{this.f.bh(t+1);_h.f.a(this.f.v,_a.g.a);this.i();_a.d.c(_a.a.bF,"GroupSuggestionOnCompose_DismissSuggesstion")}this.o=!0},i:function(){if(this.e&&this.e.h(10307)){this.e.b(10307);var n;_a.h.a(n={val:this.b}),this.b=n.val;this.c.c(ICreateGroupInGroupSuggestionEvent,this.k);this.c.c(ICreateGroupCompleteInGroupSuggestionEvent,this.j)}},v:function(n){this.h=!0},u:function(n){var u=this.bh.bc();if(u){var t=u.b(0);t.i(this.r);if(n.a()&&t){var r=n.c();r.a().Name=r.c();var e=t.l(r.a());e.E(!0);for(var f=n.b(),i=0;i<f.length;i++)t.i(f[i])}}this.h=!1},t:function(n){var t=new _mcp.bv(n);t.d(this.m);t.e(this.l);this.bh.bp.a(t,null,null,null)},x:function(n){n.V(this.m);n.U(this.l);var i=n;var t=i.c;if(i.j){this.q(!1,null);_a.d.c(_a.a.bF,"GroupSuggestionOnCompose_ShowCreateGroupSuggestion")}else if(t&&t.length>0){this.q(!0,t[0]);_a.d.c(_a.a.bF,"GroupSuggestionOnCompose_ShowExistGroupSuggestion")}else this.h||this.i()},w:function(n){n.V(this.m);n.U(this.l);this.i()},g:function(){this.a();if(this.d()){_j.e.b(_a.a.a,"MailComposeAtMentionComponent is already initialized, skipping redundant Initialize call.");return}_mcp.G.prototype.g.call(this)},bt:function(){var n;_a.h.a(n={val:this.b}),this.b=n.val;this.c.c(ICreateGroupInGroupSuggestionEvent,this.k);this.c.c(ICreateGroupCompleteInGroupSuggestionEvent,this.j);_mcp.G.prototype.bt.call(this)}};_mcp.bH=function(n,t,i,r){this.k=Function.createDelegate(this,this.s);this.l=Function.createDelegate(this,this.t);this.j=Function.createDelegate(this,this.r);_mcp.bH.initializeBase(this,[6,n,i,r]);this.n=t};_mcp.bH.prototype={b:null,c:null,h:!1,e:!1,i:!1,n:null,o:function(n){if(n!==this.h){this.h=n;this.bs("IsHighImportance")}return n},a:function(){return this.e},q:function(n){if(n!==this.e){this.e=n;this.bs("IsNormalImportance")}return n},p:function(n){if(n!==this.i){this.i=n;this.bs("IsLowImportance")}return n},g:function(){var i=this.bj.X();this.f(i);_j.e.a(_a.a.a,"Importance component initialized and importance set to {0}",i);if("Mouse"===_y.c.a.a()||_y.c.a.a()==="TouchNarrow"){if(!this.b){var t=this.m(_mcp.p.b);t&&(this.b=new _fm.f(t))}}else if(!this.c){var n=this.m(_mcp.p.c);n&&(this.c=new _y.h(_nbs.a.hb,null,n))}_mcp.p.prototype.g.call(this)},bt:function(){this.b=null;_mcp.p.prototype.bt.call(this)},bP:function(){var n=new _fm.k(_nbs.a.hb,null,this.b);return[n]},bO:function(){var t=this;var n=new _fm.l(_nbs.a.hb,function(n){n(t.b)},1,null,!1,!1,null,null);return[n]},bK:function(){return[this.c]},r:function(){var n=new _cmc.g(_a.a.a,"MailComposeSetImp",!1);_j.e.a(_a.a.a,"User sets high importance");this.f("High");this.bi.a.bi().a("Importance:High");n.b()},t:function(){_j.e.a(_a.a.a,"User sets normal importance");this.f("Normal");this.bi.a.bi().a("Importance:Normal")},s:function(){var n=_a.d.b(_a.a.a,"MailComposeSetImp");_j.e.a(_a.a.a,"User sets low importance");this.f("Low");this.bi.a.bi().a("Importance:Low");_a.d.a(n)},f:function(n){this.bi.a.ba.dO(n);this.o("High"===n);this.q("Normal"===n);this.p("Low"===n)},m:function(n){return[n(new _j.g(this.j,this.bk()),_nbs.a.Yb),n(new _j.g(this.l,this.bk()),_nbs.a.Ni),n(new _j.g(this.k,this.bk()),_nbs.a.cE)]}};_mcp.x=function(n,t,i,r){this.S=Function.createDelegate(this,this.cl);this.Q=Function.createDelegate(this,this.bY);this.T=Function.createDelegate(this,this.cm);this.bl=Function.createDelegate(this,this.ck);this.bq=Function.createDelegate(this,this.cB);this.J=Function.createDelegate(this,this.W);this.bd=Function.createDelegate(this,this.U);this.bg=Function.createDelegate(this,this.bZ);this.y=Function.createDelegate(this,this.bc);this.P=Function.createDelegate(this,this.bX);this.L=Function.createDelegate(this,this.bS);this.K=Function.createDelegate(this,this.bR);this.M=Function.createDelegate(this,this.bU);this.N=Function.createDelegate(this,this.bV);this.O=Function.createDelegate(this,this.bW);this.R=Function.createDelegate(this,this.ce);this.be=Function.createDelegate(this,this.bx);this.bm=Function.createDelegate(this,this.cu);this.bf=Function.createDelegate(this,this.bP);this.bn=Function.createDelegate(this,this.cv);this.bp=Function.createDelegate(this,this.cw);this.bz=["bmp","gif","jpg","jpeg","png"];_mcp.x.initializeBase(this,[24,n]);this.n=_db.h.d(i);this.bb=r;this.G=_a.l.a();this.Y=t;this.z=i;_b.g.c()||this.bE(!1)};_mcp.x.prototype={o:null,A:null,n:!1,F:!1,E:!1,I:null,C:null,t:null,x:null,w:null,v:null,bb:null,l:null,m:null,p:null,r:null,s:null,G:null,q:null,Y:null,z:null,D:null,u:!1,bE:function(n){if(n!==this.n){this.n=n;this.bs("IsLinkPreviewEnabled")}return n},co:function(n){if(n!==this.u){this.u=n;this.bs("IsDocLinkPreviewActivated")}return n},cn:function(n){if(n!==this.o){this.o=n;this.cy()}return n},ca:function(){this.v||(this.v={});return this.v},cq:function(n){this.A=n;this.bs("LinkPreviewResponse");if(this.A&&_zz.d.f(this.l)){var t=this.l.bR();this.br(this.A,t&&t.length>0?t[0]:null)}return n},cs:function(n){if(n!==this.x){this.x=n;this.x&&_db.h.a(this.x,null,this.bp,null,null)}return n},cr:function(n){if(n!==this.w){this.w=n;this.w&&_db.h.a(this.w,null,this.bn,null,null)}return n},b:function(){return this.F},e:function(n){if(this.F!==n){this.F=n;this.bs("ShowYouTubePlayer")}return n},a:function(){return this.E},c:function(n){if(this.E!==n){this.E=n;this.bs("ShowOEmbedVideoPlayer")}return n},i:function(){return this.I},ct:function(n){this.I=n;this.bs("YouTubePlayerUrl");return n},h:function(){return this.C},bJ:function(n){this.C=n;this.bs("OEmbedVideoPlayerHtml");return n},f:function(){this.t||(this.t=new _j.g(this.bf,_a.a.f));return this.t},bt:function(){var n;_a.h.a(n={val:this.t}),this.t=n.val;this.l=null;this.cA();this.r=null;this.s=null;this.q=null;this.v=null;_mcp.G.prototype.bt.call(this)},cy:function(){if(_db.h.i()){_j.e.a(_a.a.f,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",this.o.Url);this.bx();return}if(this.o){var i=1;var r=_a.d.b(_a.a.f,"GetComposeLinkPreview");var n=[];Array.add(n,this.o);_j.e.a(_a.a.f,"Preparing GetLinkPreview action for {0}",this.o.Url);this.o.Autoplay=!0;var u=new _db.h(this.o);_j.e.a(_a.a.f,"Submitting GetLinkPreview action for {0}",this.o.Url);var t=this,f=this;this.bi.a.bp.a(u,function(u){_db.h.l(u,t.bm,t.be,i,r,"GetComposeLinkPreview",n)},function(t){_db.h.h(t,i,r,"GetComposeLinkPreview",n)},null)}},cu:function(n){this.cq(n)},bx:function(){this.bE(!1)},cw:function(n){this.ct(n);this.e(!!this.I)},cv:function(n){var t=this.p.g(n);t?this.bJ(t):this.bJ(n);this.c(!!this.C)},bP:function(){this.c(!1)},j:function(n){this.m=n;this.m.r(this.R);this.m.b(this.O);this.m.a(this.N);this.m.c(this.M);this.m.i(this.K);this.m.j(this.L);this.m.s(this.P)},cA:function(){if(this.m){this.m.v(this.R);this.m.e(this.O);this.m.d(this.N);this.m.f(this.M);this.m.t(this.K);this.m.u(this.L);this.m.w(this.P);this.m=null}},cj:function(n){if(!this.n){_j.e.a(_a.a.f,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t="LPNoLP";var r="a[id^='"+t+"']";var i=$(n);return _b.g.a(n.id,t)||i.find(r).length>0},ch:function(n){if(!this.n){_j.e.a(_a.a.f,"RTE: Skipping IsElementFromPreviewAnchor because previews are disabled");return!1}var t=!1;var r=$(n);var i="a[id^='LPlnk']";t=_b.g.a(n.id,"LPlnk")||r.find(i).length>0;!t&&n.nodeName==="#text"&&n.parentNode&&n.parentNode.nodeName==="A"&&(t=_b.g.a(n.parentNode.id,"LPlnk"));return t},ce:function(n){var i=n.c();var t=n.d();if(_zz.h.isInstanceOfType(t))this.l=t;else{_j.e.c(_a.a.f,"HandleLinkPreviewOnLinkAdded: event source was not an instance of HtmlEditorBase");return}this.bK(i)},bK:function(n){if(n&&this.n){var i=null;try{i=n.href}catch(u){var t=n.outerHTML;var r=t?" OuterHTML: "+t:"";_j.e.c(_a.a.f,"IsLinkPreviewProtocol exception: "+u.message+"."+r);return}if(this.cj(n)||this.ch(n))return;if(_b.g.e(n.id))return;if(this.k()&&!this.k().s(n))return;if(i.toLowerCase().startsWith("http")){n.id=_b.g.f();_j.e.a(_a.a.f,"FindAndInsertLinkInPreviousWord: Trigger link preview");this.cz(n.id,n.href)}}},bQ:function(n){if(n){var t=n.toLowerCase().split(".");if(t&&t.length>1)return Array.contains(this.bz,t[t.length-1])?!0:!1}return!1},bU:function(n){var t=n.d();if(_zz.h.isInstanceOfType(t))this.l=t;else{_j.e.c(_a.a.f,"EditorOnContentLoaded: event source was not an instance of HtmlEditorBase");return}this.Z(n.c())},bR:function(n){n.c()===1&&this.bM(n.e())},bS:function(n){this.Z(n.c())},bW:function(n){var t=n.c();this.bO(t)},bX:function(n){if(!this.n||!this.z||!this.z.q()){_j.e.a(_a.a.f,"RTE: Skipping getting doc links because doc link previews are disabled");return}if(this.p){var t=new _a.j;var i=this.k().h();var r=this;Array.forEach(i,function(n){var i=n;if(i.d()&&!i.h()){var r=new _g.eo;r.Url=i.j();r.ProviderType=_g.p.toString(i.f()==null?0:i.f());r.PermissionType=i.b()==null?0:i.b();t.c(r);i.n(!0)}});this.bj.hd(t)}},bV:function(n){var t=n.c();this.Z(t)},cz:function(n,t){if(!this.n){_j.e.a(_a.a.f,"RTE: Skipping link preview requests because previews are disabled");return}if(this.bQ(t)){var i=this;_j.n.a().a(this.bk(),"InsertInlineImageTimerCallback",function(){if(!i.cd&&i.l&&i.l.Y()&&i.l.bb){var r=i.l.be().querySelectorAll("#"+n);if(r&&r.length>0&&r[0]){var f=document.createElement("img");try{f.src=t}catch(e){_j.e.a(_a.a.f,"Exception encountered when inserting image for {0}. Exception: {1}",t,e.message);return}var u=document.createElement("p");u.appendChild(f);i.l.bC(!0);r[0].parentNode&&r[0].parentNode.appendChild(u);i.l.br(3);i.l.bY()}}},10)}else{_j.e.a(_a.a.f,"Trigger link preview request for {0}",t);var r=new _g.cS;r.Id=n;r.Url=t;r.RequestStartTimeMilliseconds=_a.c.a().h();if(this.G.a()){var u=this;_j.n.a().c(this.bk(),"QueueGenerateLinkPreviewForIE",function(){u.bc(r)})}else this.bc(r)}},br:function(n,t){_j.e.a(_a.a.f,"Adding link preview for {0}",n.Url);var i=!1;_h.bU.a(n)&&(i=!0);if(!this.k()){this.r=n;this.s=t;this.p&&this.bC();return}if(i){this.k().l(this.y);return}if(this.l&&this.l.Y()&&this.l.bb){this.l.bC(!0);this.k().f(n,this.y,t,this.bg,this.bd,this.J,null);this.l.br(3);this.l.bY()}else _j.e.a(_a.a.f,"Ignore AddLinkPreview since the editor isn't active or initialized")},k:function(){if(!this.p){_j.e.a(_a.a.f,"LinkPreviewBuilder: Create LinkPreviewBuilder");var n=this;this.bb.a(function(t){n.cp(t.a(n.bq,n.bl,!0,_y.c.a,n.Y,n.bh.bp));n.p.d(n.ca());n.bC()})}return this.p},cp:function(n){this.p=n;this.bs("LinkPreviewBuilder");return n},cB:function(n){this.cs(new _a.bV(new _db.m(n)))},ck:function(n){this.cr(new _a.bV(new _db.m(n)))},bC:function(){_j.e.a(_a.a.f,"LinkPreviewBuilder: LinkPreviewBuilderFactoryOnOnCreated");if(this.r&&this.s){_j.e.a(_a.a.f,"LinkPreviewBuilder: There was a deferred AddLinkPreview. Calling it now");this.br(this.r,this.s);this.r=null;this.s=null}if(this.q){_j.e.a(_a.a.f,"LinkPreviewBuilder: There was a deferred InitializeLinkPreviewFromAnchors. Calling it now");this.bA(this.q);this.q=null}},bA:function(n){this.q=n;var h=!1;var s=!1;if(this.k())this.q=null;else return;for(var f=0;f<n.length;f++){var i=n[f];if(_b.g.a(i.id,"LPUrlAnchor")){var t;var l,c;if(c=this.k().u(i,l={val:t}),t=l.val,c){var p=this.D+"[id^='LPRemovePreview']";var y=$(t).find(p);if(y.length>0){_j.e.a(_a.a.f,"Remove preview button already added. Skipping preview initialization.");continue}this.ba(t);var u=!1;var o;this.k().p(t,o={val:u}),u=o.val;this.k().n(t);if(u){this.k().o(i);h=!0}this.bu(t);this.U(t);this.W(t);this.V(t);t.id=this.k().m(t.id,i.href);var r=this.k().a(i.href);r&&r.d()&&r.a()&&!(r.a().b()!=null)&&this.k().t(r,t,this.J)}}else{if(!s){this.bK(i);s=!0}if(_b.g.a(i.id,"LPlnk")&&this.bB(i.href)){var e=i.id.indexOf("_");var a=e>-1?i.id.substring(0,e):i.id;var v=this.l.z.querySelectorAll("div[id*='"+a+"']");v.length||i.setAttribute("previewremoved",!0)}}}h&&this.k().l(this.y)},bc:function(n){this.cn(n)},bZ:function(n){this.bu(n);this.U(n);this.W(n);this.V(n);var t=n;if(this.G.a()){n.style.display="inline-block";t=window.document.createElement("p");t.appendChild(n)}this.ba(t);return t},bu:function(n){var t=this.k().e(n,"[id^='LPRemovePreviewContainer']");if(t){this.D=t.tagName;t.id="LPRemovePreview";t.style.marginLeft="10px";var i=$(t);i.click(this.T);i.addClass(_mcp.d.Q().a())}},W:function(n){var u=$(n);var f=u.find("a[id^='LPUrlAnchor']");if(f.length>0){var o=f[0].href;if(this.k().r(o)){var i=u.find("[id^='LPOptionsContainer']");if(i.length>0&&_j.i.a(i[0].innerHTML)){var t=this.k().e(n,"[id^='LPOptionsContainer']");if(t){t.id="LPOptions";var r=$(t);var e=_mcp.d.J().a();if(!r.hasClass(e)){r.addClass(e);this.V(n);this.co(!0)}}}}}},V:function(n){var o=$(n);var t=o.find("a[id^='LPUrlAnchor']");var r=o.find("[id^='LPMetadata']");if(r.length>0&&t.length>0){var e=t[0].href;if(this.bB(e)){var i;var u;var f;(i=this.k().a(e))&&!_j.i.a(u=this.k().b(i.b()==null?0:i.b()))?r.text(u):t.length>0&&!_j.i.a(f=this.cc(t[0].href))&&r.text(String.format(_nbs.a.NI,f))}}},U:function(n){var i;if((i=$(n).find("div[id^='LPDescription']")).length>0&&!_j.i.a(i.attr("altdesc"))){var t=this.k().e(n,"[id^='LPExpandDescriptionContainer']");if(t){t.id="LPExpandDescription";var r=$(t);var u=i[0].id.endsWith("_summary")?_mcp.d.j().a():_mcp.d.k().a();r.addClass(u);r.click(this.Q)}}},ba:function(n){_j.e.a(_a.a.f,"InitializePreviewForEditor: InitializePreviewForEditor.");n.setAttribute("contenteditable",!1);var t=$(n);t.bind("click",this.S)},by:function(n){var t=[];this.X(t,n,this.D,"LPRemovePreview");this.X(t,n,"a","LPExpandDescription");this.X(t,n,"a","LPOptions");return t},X:function(n,t,i,r){for(var f=t.getElementsByTagName(i),u=0;u<f.length;u++)f[u].id===r&&Array.add(n,f[u])},bY:function(n){var e=n.target;var s=_b.g.b(e);var t=$(s).find("div[id^='LPDescription']");if(t.length>0){var i=$(e);if(t[0].id.endsWith("_summary")){t[0].id=t[0].id.substring(0,t[0].id.length-8);i.removeClass(_mcp.d.j().a());i.addClass(_mcp.d.k().a());this.bD(t[0],!1)}else{t[0].id+="_summary";i.removeClass(_mcp.d.k().a());i.addClass(_mcp.d.j().a());this.bD(t[0],!0)}var f=t.attr("altdesc");if(!_j.i.a(f)){t.attr("altdesc",t.html());t.html(f)}var u="maxHeight";var r=t.attr("altmaxheight");var o=r?r:"100%";t.attr("altmaxheight",t.css(u));t.css(u,o)}},bD:function(n,t){var i=new _a.o;var r=_a.d.b(_a.a.f,"LinkPreviewExpandDescriptionAction");var u=$(_b.g.b(n)).find("a[id^='LPUrlAnchor']");i.b("U",_db.h.b(u,"href",100));i.c("Summary",t);r.j=i.toString();_a.d.a(r)},cm:function(n){var t=new _cmc.g(_a.a.f,"RemoveLinkPreviewClickEvent",!1);if(!this.l){_j.e.c(_a.a.f,"RemovePreviewClicked: editor was null");return}this.l.dM(n);var h=n.target;var i=_b.g.b(h);var w=this.l.cP();if(i){var v=20;var r=null;if(_b.g.a(i.id,"LPBorder"))r=i;else{var c=$(i).find("[id^='LPBorder']");c.length>0&&(r=c[0])}if(r){var u=r.getAttribute("id");_b.g.a(u,"LPBorder_YT")?t.a("T","Y",!0,!0):_b.g.a(u,"LPBorder_VT")?t.a("T","V",!0,!0):_b.g.a(u,"LPBorder_PT")?t.a("T","P",!0,!0):_b.g.a(u,"LPBorder_BVT")?t.a("T","BV",!0,!0):t.a("T","G",!0,!0);var e=$(r).find("a[id^='LPUrlAnchor']");if(e.length>0){var y=e[0].href;var p=this.k().a(y);var a=p.k(u);var s=$(document.body).find(String.format("[id^='{0}']",a));s.length>0&&s[0].setAttribute("previewremoved",!0)}}var o=_b.g.h(i);o&&t.a("U",_db.h.c(o.href,v),!0,!0);var f=$(i).find("div[id^='LPDescription']");var l=f.length>0&&!!f[0].id&&f[0].id.endsWith("_summary");t.a("S",l,!0,!0);t.j().length<1;_j.k.c(h,"click");this.l.lX(i);t.b()}else t&&t.d("NullPreview",null)},bO:function(n){if(!this.n){_j.e.a(_a.a.f,"RTE: Skipping link preview cleanup because previews are disabled");return!1}for(var r=this.by(n),u=0;u<r.length;u++){var h=r[u];var i=_b.g.b(h);if(i){i.removeAttribute("contenteditable");var s=$(i);s.unbind("click",this.S);var l=$(h);l.unbind("click mouseenter mouseleave");l.remove();this.k().q(s)}}for(var c=$(n).find(String.format("[id^='{0}']","LPBorder")),t=0;t<c.length;t++){var e=c[t];var o=$(e).find("a[id^='LPUrlAnchor']");if(o.length>0){var v=o[0].href;var f=this.k().a(v);f&&(e.id+=f.m())}}if(this.p){var a=this.k().h();var y=this;Array.forEach(a,function(t){t.q(n)})}return r.length>0},Z:function(n){if(!this.n){_j.e.a(_a.a.f,"RTE: Skipping link preview initialization because previews are disabled");return}if(!n){_j.e.a(_a.a.f,"RTE: Skipping link preview initialization because bodyElement is null");return}if(n.nodeType===3){_j.e.a(_a.a.f,"RTE: Skipping link preview initialization because bodyElement is text node");return}this.bA(this.cb(n))},bM:function(n){if(!this.n){_j.e.a(_a.a.f,"RTE: Skipping link preview bind because previews are disabled");return}if(n)for(var f=this.by(n),i=0;i<f.length;i++){var t=f[i];var u=_b.g.b(t);if(u){this.ba(u);var r=$(t);t.id==="LPRemovePreview"?r.click(this.T):t.id==="LPExpandDescription"&&r.click(this.Q)}}},cb:function(n){var r=[];if(!_j.C.a(n.children)&&n.children.length>0)for(var i=0;i<n.childNodes.length;i++){var t=n.childNodes[i];if(t.nodeType===1&&t.id!=="OwaReferenceAttachments"&&t.id!=="OwaReferenceAttachmentsEnd"){var u=this;_j.E.b(t.getElementsByTagName("A"),function(n,t){Array.add(r,t)})}}return r},cl:function(n){if(!this.l){_j.e.c(_a.a.f,"PreviewClicked: editor was null");return}if(this.l.cP()){var i=n.target.parentNode;var t=_b.g.b(i);if(t){this.l.me(t);this.bi.a.bg.a(_a.V,new _a.V(_nbs.a.Bv+t.textContent.replace(_nbs.a.Yp,""),!1))}}},bB:function(n){var t=this.k().a(n);return!!t&&t.d()},cc:function(n){var t=this.k().a(n);return t?t.g():null}};_mcp.X=function(n,t){_mcp.X.initializeBase(this,[14,n]);this.e=t};_mcp.X.prototype={e:null,b:null,c:0,a:null,bo:function(){return _mcp.G.prototype.bo.call(this)||!this.b},g:function(){_mcp.G.prototype.g.call(this);this.a=this.j();var n=this.bi.a;this.b=n.bw();this.c=n.ba.a();_mcp.h.g(n.ba)&&!n.ba.bs()&&this.n()},bt:function(){this.a=null;this.b=null;_mcp.G.prototype.bt.call(this)},n:function(){this.b.f(_mcp.X.a);this.f()},j:function(){var n=this.bi.a.ba;var t=n.e()||n.P();return t&&n.bq()?t:null},m:function(){if(_dg.a.isInstanceOfType(this.a))return this.a.w();else if(_dg.o.isInstanceOfType(this.a)){var n=this.a;return n.y().w()==="RecurringMaster"?n.J()?"RecurringMaster":"Occurrence":n.y().w()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(this.a).getName());},f:function(){if(this.a&&!_dg.q.isInstanceOfType(this.a)){this.b.a(6800);switch(this.m()){case"Occurrence":case"Exception":this.i();break;case"RecurringMaster":this.h();break}}},k:function(n){var t;switch(n){case 8:t=3200;break;case 3:t=3205;break;case 5:case 6:case 7:default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+n);}return t},l:function(n){var t;switch(n){case 8:t=3100;break;case 3:t=3105;break;case 5:case 6:case 7:default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+n);}return t},h:function(){var n=this.l(this.c);this.b.a(n)},i:function(){var n=this;this.e.a(function(t){if(!n.bo()){var u=t.a();var r=u.a(n.a,null);var i=n.k(n.c);n.b.a(i,r)}})}};_mcp.bI=function(n,t,i,r){this.p=Function.createDelegate(this,this.Z);this.q=Function.createDelegate(this,this.bb);this.I=Function.createDelegate(this,this.bn);this.D=Function.createDelegate(this,this.l);this.F=Function.createDelegate(this,this.O);this.t=Function.createDelegate(this,this.bu);this.E=Function.createDelegate(this,this.ba);this.K=Function.createDelegate(this,this.bq);this.J=Function.createDelegate(this,this.bp);this.i=Function.createDelegate(this,this.bd);this.G=Function.createDelegate(this,this.bg);this.r=Function.createDelegate(this,this.be);this.s=Function.createDelegate(this,this.bl);_mcp.bI.initializeBase(this,[0,n]);this.h=n.a.bP;this.e=t;this.v=i;this.C(!0);this.x=r};_mcp.bI.prototype={h:null,v:null,m:!1,k:!1,o:!1,z:null,A:null,n:null,e:null,x:!1,f:null,d:function(){return _mcp.G.prototype.d.call(this)},cg:function(n){if(n!==_mcp.G.prototype.d.call(this)){_mcp.G.prototype.cg.call(this,n);this.bs("IsInitialized")}this.bi.a.ba.dY(n);return n},c:function(){return this.m},T:function(n){if(n!==this.m){this.m=n;this.bs("IsSecondInitializationComplete")}return n},a:function(){return this.k},C:function(n){if(this.k!==n){this.k=n;this.bs("CanLoadPopoutSuccessfully")}return n},V:function(){if(this.f){this.f.a();this.f=null}},g:function(){this.z=_j.m.a(_a.a.a,517,"VM.MailCompose.FirstInit");var i=this.bi.a;var n=i.ba;n.apcl("IsEditorInitialized",this.s);n.apcl("IsUpgraded",this.r);if(!n.eL&&!n.h()){_j.e.a(_a.a.a,"Capture initial baseline for a non draft without existing initial baseline.");n.eL=_mcp.c.b(n);n.eT()||n.eV(!0)}if(n.fU()){_j.e.a(_a.a.a,"Finish 1st init for complete context");this.j();_j.e.a(_a.a.a,"Check begin upgrade for complete context");this.w()}else{var o=i.bp;var r=n.h();var t=n.E();var s=n.gH();if(!r&&s){var e;var u=_g.a.a().c();e=_j.i.a(u.bk.SharePointUrl)?u.bk.UserEmailAddress||"":u.bk.LogonEmailAddress||"";var l=new _gg.bi("StoreId",s,e);var a=new _mcp.be([l],"EwsId");var v=this;o.a(a,this.G,function(n){v.bf(n)},this.i);_j.e.a(_a.a.a,"Calling server to convert id, storeId={0}",s)}else if(r)if(n.cx()&&n.eT()){_j.e.a(_a.a.a,"The message was saving prior to popout, check for save result from main window");this.S()}else{_j.e.a(_a.a.a,"Load draft {0}",_h.Z.a(r));this.y(r)}else if((4===n.a()||13===n.a())&&n.eT()){_j.e.a(_a.a.a,"Loading draft without id for the popout from reading-pane case, check id from main window");this.S()}else if(t){i.bb.b(3400);i.bb.a(3400,null);if(n.gE()){var f=this;this.v.b(function(i){var u=i.a(t,n.cr(),n.cj(),n.df());var r=i.b(200,u,n.cj());r.X=n.b();o.a(r,f.J,function(n){f.R(n)},f.i);_j.e.a(_a.a.a,"Loading original calendar item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)})}else{var h=i.bO.i(t);h.X=n.b();var c=this;o.a(h,this.K,function(n){c.R(n)},this.i);_j.e.a(_a.a.a,"Loading original message item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}}else if(0===n.a()||11===n.a()){n.cJ(!0);n.eZ(!0);_j.e.a(_a.a.a,"Finish 1st init for new mail");this.j()}else{this.l("ErrorNoDraftOrOriginalItemId",null,null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_j.t.d(_y.l,n.a())));}}_j.i.a(_g.a.a().c().bk.SharePointUrl)||i.bb.a(110,null)},b:function(){this.X();this.A=_j.m.a(_a.a.a,517,"VM.MailCompose.SecondInit");var i=this.bi;var n=i.a;var u=n.ba;_j.e.a(_a.a.a,"Queue secondary init task.");_j.n.a().c(_a.a.a,"Delayed MailCompose Secondary Init",this.E);if(n.gU()&&!n.dX.a){var f=i.b(10);_j.e.a(_a.a.a,"Queue appbar setup task");var t=f;_j.n.a().c(_a.a.a,"SetupApplicationBarMenu",t.e||(t.e=Function.createDelegate(t,t.b)))}this.br();if(u.bB()){_j.e.a(_a.a.a,"Queue diagnostics save to trigger uploading of the diagnostics attachment");var e=this;_j.n.a().c(_a.a.a,"Diagnostics save:",function(){n.bl().a("Diagnostics",null,null,!1)})}if(_a.cA.a){_j.e.a(_a.a.a,"Queue GetMailTips if needed task");var r=this;_j.n.a().c(_a.a.a,"TriggerMailTipsIfNeeded",function(){r.bo()||n.cZ().a(32)})}},bt:function(){var n=this.bj;n.rpcl("IsEditorInitialized",this.s);n.rpcl("IsUpgraded",this.r);this.cg(!1);this.T(!1);this.C(!0);this.o=!1;this.V();_mcp.G.prototype.bt.call(this)},bn:function(n){var f=_j.m.a(_a.a.a,2,"VM.MailCompose.ProcessDraft");var e=this.bi.a.ba;var u=this.bh.bq();var t=n;var i=n.X;_j.e.a(_a.a.a,"Got draft, checking pending discards for {0}",i);if(this.h.a(i))u.e(i,t.j[0]);else if(i===this.bj.b()){var r=t.c;if(_g.bt.isInstanceOfType(r)){this.bj.dw(r);this.u(!0);this.Q(t)}else _a.p.a&&r.bI()?this.bc(r,t):this.O(r,t);_a.bq.a&&_j.n.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.t)}else _j.e.a(_a.a.a,"Skipping get draft processing since action context {0} doesn't match current context {1}",i,this.bj);_j.m.b(f);_j.m.b(this.n)},bc:function(n,t){var i=this;this.bh.dk(function(){i.W();i.f.c(n,t)})},W:function(){if(!this.f){_j.e.a(_a.a.a,"Setting initializer component override");this.f=this.bh.cy().b();this.f.b(this.F,this.cI,this.D,this.bh.bp)}},O:function(n,t){this.bj.dv(n);this.u(!1);this.Q(t)},Q:function(n){if(this.bj.eT()&&this.bj.du()){_j.e.a(_a.a.a,"Capture initial baseline for a loaded draft.");this.bj.eL=_mcp.c.b(this.bj)}_j.e.a(_a.a.a,"Finish 1st init for a loaded draft.");this.j();_j.n.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.t)},bp:function(n){var u=this.bi;var f=u.a;var t=f.ba;var i=n.X;if(i===t.b()&&!this.h.a(i)){var r=n;t.K(r.c());t.cH(!1);_j.e.a(_a.a.a,"Got original cal item, finish 1st init.");this.j();_j.e.a(_a.a.a,"Check begin upgrade on original cal item");this.w()}},bq:function(n){var u=this.bi;var f=u.a;var i=f.ba;var t=n.X;if(t===i.b()&&!this.h.a(t)){var r=n;i.K(r.c);_j.e.a(_a.a.a,"Got original message, finish 1st init.");this.j();_j.e.a(_a.a.a,"Check begin upgrade on original message item");this.w()}},Z:function(n,t){this.bh.bn().a(this.bi.a,!1);_j.e.a(_a.a.a,"Navigate away on action failure")},bd:function(n){if(!this.bo()&&n.X===this.bj.b()){this.bh.bb.b(3400);this.bh.bf()}},j:function(){var o=_j.m.a(_a.a.a,2,"VM.MailCompose.ComponentInit");var n=this.bi;var f=n.a;var e=f.ba;var s=e.a();n.b(7).g();n.b(8).g();n.b(1).g();e.bq()&&n.b(14).g();var i=n.b(11);i.g();if(this.bj.a()!==4&&!this.bj.C()||!this.bj.a()&&this.bj.C()){var t=this.bh.bH().c(this.e.b()&&this.bj.l()==="HTML",this.bj.C());if(i.a()){var u=i.b();u&&(t=t+u)}t=this.U(t,this.e.b()&&this.bj.l()==="HTML");this.bj.w(t)}var r=_y.c.a.a();if(r!=="Mouse"){if(r==="TouchNarrow"){n.b(5).g();n.b(6).g();n.b(3).g();n.b(9).g();n.b(22).g();n.b(16).g()}n.b(10).g()}else n.b(22).g();_j.m.b(o);_j.m.b(this.z);if(f.cC){_j.e.a(_a.a.a,"Finishing primary init, beginning secondary init because we are already in view.");this.b()}this.cg(!0)},U:function(n,t){var i='<div itemscope itemtype="http://schema.org/EmailMessageBody"><meta itemprop="id" content=""/><div>{0}</div></div>';return!this.bh.bo.a().bp()||!this.bh.bo.a().bp().Enabled?n:t?String.format(i,n):n},ba:function(){var n=this.bi;var i=n.a;var t=i.ba;n.b(2);n.b(15);n.b(25);n.b(27);n.b(32);n.b(34);n.n();t.eJ()||t.fS();this.T(!0);_j.e.a(_a.a.a,"Finished secondary init.");_j.m.b(this.A)},y:function(n){this.n=_j.m.a(_a.a.a,517,"VM.MailCompose.LoadDraft");var i=this.bi.a;var t=i.ba;var e=i.bp;if(t.eT()){if(t.du()){_j.e.a(_a.a.a,"Capture initial baseline since message was a clean new message before popout.");t.eL=_mcp.c.b(t)}t.bl()&&!t.i()&&this.u(!0)}else t.fG(!0);i.bb.b(3400);i.bb.a(3400,null);t.fW()&&i.bb.a(3480);var r=this.e.b()&&t.l()==="HTML"?_h.b.e():_h.b.q();var o="MailCompose";var u=i.bO.i(n,r,o);u.X=t.b();var f=this;e.a(u,this.I,function(n){f.bm(n)},this.i);_j.e.a(_a.a.a,"Loading draft with ID={0}; Shape={1}; Layout={2}; ContextBodyType={3}",_h.Z.a(n),r.BodyType,_y.c.a.a(),t.l())},u:function(n){if(n!==this.o){var t=this.bi.a.bb;t.b(3440);n&&t.a(3440,null);this.bh.bf();this.o=n}},bg:function(n){var i=n;var t=new _g.g(i.j().Id);this.bi.a.ba.L(t);this.y(t)},w:function(){var u=this.bi;var n=u.a.ba;var t=n.a();var i=1===t||2===t||3===t||12===t;if(!i||n.h()||n.i()){if(i&&n.h()&&n.i()&&_a.l.a().G){var r=this;_j.n.a().a(_a.a.a,"MailComposeInitializerComponent.BeginUpgradeIfNecessary",function(){r.cd||r.bh.bf()},1e3)}}else this.bh.bQ().h()},S:function(){var n=this.bi.a.ba.b();if(this.x){_j.e.a(_a.a.a,"Processing save result on main window for popout projection compose window {0}",n);var t=window.self.windowServiceEndPoint;t.getSaveResultForPopout(n,_a.U.b,this.q)}else{_j.e.a(_a.a.a,"Calling main window to process save result {0}",n);_g.k.b.getSaveResultForPopout(n,_a.U.b,this.q)}},bb:function(n){var t=this.bi.a.ba;if(n){var i=JsonParser.deserialize(n);_j.e.a(_a.a.a,"Resume loading draft after main window successfully saved item: {0}",i.Id);t.bl()&&!t.i()&&t.cJ(!0);this.y(i)}else{_j.e.a(_a.a.a,"Save failed on the main window for this popout, show failure message.");this.C(!1);this.l("ErrorSaveFailedOnMainWindow",null,null)}},bl:function(n,t){var r=this.bi.a;var i=r.ba;i.eY&&this.Y()},be:function(n,t){var r=this.bi.a;var f=r.ba;if(f.i()){var i=this.bh.bQ();if(i.e()){var u=r.bX()?r.bX().toString():"";_y.j.a(i.e(),null,null,null,u);i.k(null)}}},Y:function(){var t=this.bi.a;var n=t.ba;if(n.fe()){this.e.a().e()&&this.e.a().e().Enabled&&n.fe().o(new _a.ba("OneCompose"));this.e.a().r()&&this.e.a().r().Enabled&&n.fe().o(new _a.ba("PE"));var i=t.bX()?t.bX().toString():"";_y.j.a(n.fe(),null,"",null,i);n.bb(null)}this.L()},l:function(n,t,i){var f=this.bi.a;var r=f.ba;if(r.bA()){var u=new _a.o;_j.i.a(i)||u.b("E",i);_y.j.a(r.bA(),null,n,t,this.P(u.toString(),r.bA().j));r.v(null)}if(r.fe()){_y.j.a(r.fe(),null,n,t,i);r.bb(null)}this.L()},P:function(n,t){var i="";i=_j.i.a(n)?t:_j.i.a(t)?n:n+"|"+t;return i},X:function(){var i=this.bi.a;var n=i.ba;if(n.bA()){var t=n.bA().j;i.bX()&&(t=this.P(i.bX().toString(),t));_y.j.a(n.bA(),null,"",null,t);n.v(null)}},L:function(){var i=this.bi.a;var t=i.ba;if(t.gI()){var n=null;switch(t.a()){case 0:n="MailComposeNewLoad";break;case 1:n="MailComposeReplyLoad";break;case 2:n="MailComposeReplyAllLoad";break;case 3:n="MailComposeForwardLoad";break;case 4:n="MailComposeEditDraftLoad";break}if(n){_a.G.a(n);t.bc(!1)}}},bf:function(n){this.N(n,"ConvertIdAction")},bm:function(n){this.N(n,n.l)},N:function(n,t){var i=this;this.M(n,t,function(t){t.g(n,_nbs.a.MC,_nbs.a.DT,_nbs.a.MC,_bms.E.BC,i.p)})},R:function(n){var t=this;this.M(n,n.l,function(i){i.f(n,t.p)})},M:function(n,t,i){var r=t+"_UnknownError";if(this.bo()){_j.e.a(_a.a.a,"MailComposeInitializerComponent.HandleActionFailure: viewModel is null or disposing, aborting logic. ErrorCode = {0}",r);return}var s=this.bi;var e=s.a;var h=e.ba;var f=n.X;f!==h.b()||this.h.a(f)||i(e.bp);var u=r;u=_g.Q.a(n.J)?_g.Q.b(n.J)||r:n.J.ExceptionName||r;var o=n.J.FaultMessage||n.J.message;_j.m.b(this.n);this.l(u,n.O(),o)},bu:function(){_mcp.G.a(this.bh,32)},br:function(){if(this.bh&&this.bh.ba.k()===1&&!this.bh.bs()){this.bh.bm()||this.bh.bg.a(_a.cp,new _a.cp(!1,"NotLoadedByReadingPaneComposeHide"));this.bh.bg.a(_a.bb,new _a.bb("MCompose"))}}};_mcp.h=function(n,t,i){_mcp.h.initializeBase(this,[4,n]);this.k=t;this.i=i};_mcp.h.f=function(){_mcp.h.b||(_mcp.h.b=new _a.e("LocationViewModel",ILocationViewModel,_mcp.h));return _mcp.h.b};_mcp.h.e=function(){_mcp.h.a||(_mcp.h.a=new _a.e("IsMeetingForwardOnBehalfOf",Boolean,_mcp.h));return _mcp.h.a};_mcp.h.g=function(n){switch(n.a()){case 4:return n.bs();case 8:case 3:return!0;case 5:case 7:case 6:return!1;default:return!1}};_mcp.h.prototype={k:null,i:null,h:null,a:function(){return this.ew(_mcp.h.c)},n:function(n){this.ev(_mcp.h.c,n);return n},e:function(){return this.ew(_mcp.h.d)},f:function(n){this.ev(_mcp.h.d,n);return n},b:function(){return this.ew(_mcp.h.f())},l:function(n){this.ev(_mcp.h.f(),n);return n},j:function(){return this.ew(_mcp.h.e())},o:function(n){this.ev(_mcp.h.e(),n);return n},c:function(){return this.h},p:function(n){if(n!==this.h){this.h=n;this.bs("MeetingCalendarTimePeriod")}return n},g:function(){var n=this.bi.a.ba;var i=this.bi.a.dd;if(n.bE()){var e=this;this.k.a(function(t){e.l(t.a(n.fq(),null,!1))})}else this.l(null);if(n.bq()){if(n.bu()){var o=this;this.i.a(function(t){var i=t.a();o.p(i.a(n,null))})}if(n.br()){var t=2;var s=_pc.a.n(n.m());var r=i.e(s,_bc.e.a,!0,t,!1);this.n(r);this.o(!!n.bt()&&!!n.bt().Mailbox&&!!n.m()&&!!n.m().Mailbox&&!_g.m.a(n.m().Mailbox,n.bt().Mailbox));if(this.j()){var f=_pc.a.n(n.bt());var u=i.e(f,_bc.e.a,!0,t,!1);this.f(u)}else this.e()&&this.f(null)}}else this.m();_j.e.a(_a.a.a,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.bq(),n.br());_mcp.G.prototype.g.call(this)},bt:function(){this.m();if(this.b()){this.b().dispose();this.l(null)}_mcp.G.prototype.bt.call(this)},m:function(){if(this.a()){this.a().dispose();this.n(null)}if(this.e()){this.e().dispose();this.f(null)}}};_mcp.p=function(n,t,i,r){_mcp.p.initializeBase(this,[n,t]);this.bM=r;this.bq=i};_mcp.p.a=function(n,t){return new _fm.g(n,t,null,1,null,null,!1,!1,!1,!1)};_mcp.p.c=function(n,t){return new _y.h(t,n)};_mcp.p.b=function(n,t){return new _fm.d(t,null,n,!0)};_mcp.p.prototype={bM:null,bq:null,cN:null,cK:null,ch:null,Q:function(){return this.cN},P:function(){return this.cK},O:function(){return this.ch},cM:function(){return this.bM.a()==="Mouse"&&!!this.bq&&!this.bh.bm()},dG:function(){return!!this.bq&&this.bq.a().e().Enabled},g:function(){if(_y.c.a.a()==="Mouse"||_y.c.a.a()==="TouchNarrow"){this.cM()&&(this.cK=this.bO());(!this.cM()||this.dG())&&(this.cN=this.bP())}else this.ch=this.bK();_mcp.G.prototype.g.call(this)},bZ:function(){},bY:function(){},cy:function(){},bt:function(){this.cN=null;this.cK=null;this.ch=null;_mcp.G.prototype.bt.call(this)},br:function(){if(_y.c.a.a()==="Mouse"||_y.c.a.a()==="TouchNarrow"){this.cM()&&this.bY();(!this.cM()||this.dG())&&this.bZ()}else this.cy()}};_mcp.bK=function(n,t,i,r){this.h=Function.createDelegate(this,this.v);this.f=Function.createDelegate(this,this.u);this.n=Function.createDelegate(this,this.s);this.k=Function.createDelegate(this,this.w);this.m=Function.createDelegate(this,this.r);this.o=Function.createDelegate(this,this.x);this.p=Function.createDelegate(this,this.A);_mcp.bK.initializeBase(this,[9,n,i,r]);this.j=t};_mcp.bK.prototype={j:null,e:null,c:null,b:null,l:null,a:function(){return this.c},z:function(n){if(this.c!==n){this.c=n;this.bs("DialogViewModel")}return n},g:function(){this.e||(this.e=new _j.g(this.p,this.bk()));this.q();_mcp.p.prototype.g.call(this)},bt:function(){var t;_a.h.a(t={val:this.b}),this.b=t.val;var n;_a.h.a(n={val:this.e}),this.e=n.val;this.c=null;this.j=null;_mcp.p.prototype.bt.call(this)},bP:function(){if(!this.bj.S()&&!this.bM.d()&&!this.bh.bm()){var n=_mcp.p.b(this.e,_nbs.a.Op);return[n]}return null},bO:function(){if(!this.bj.S()&&!this.bM.d()){var n=_mcp.p.a(this.e,_nbs.a.Op);return[n]}return null},bK:function(){if(!this.bj.S()&&!this.bM.d()){var n=new _y.h(_nbs.a.Op,this.e);return[n]}return null},A:function(){_j.e.a(_a.a.a,"User chose to show message options");this.b||(this.b=new _mcp.Q);this.b.s(this.bj);if(!this.c){var t=new _bc.k;t.F(this.j);this.z(t);this.c.q(_nbs.a.UM);this.l=[new _ff.d(new _j.g(this.o,this.bk()),_u.P.V,null,!0),new _ff.d(new _j.g(this.m,this.bk()),_u.R.BC,null)];this.c.n.m(this.l)}this.c.s(this.b);if("TouchNarrow"===_y.c.a.a()){var n=this.bi.a.bI();this.b.t(n);n.a().e(this.k)}this.c.f(!0)},x:function(){if(this.c.C){_j.e.a(_a.a.a,"User tried to click OK button more than once.");return}var n=this.bh.ba;if(n.y()!==this.b.d){this.bi.a.bi().a("Sensitivity:"+this.b.d);"Normal"!==n.y()&&this.y();n.eg(this.b.d);"Normal"!==n.y()&&this.q()}n.Y()!==this.b.e&&this.bi.a.bi().a("RequestDeliveryReceipt");n.Z()!==this.b.f&&this.bi.a.bi().a("ReadReceiptRequested");n.dR(this.b.e);n.dW(this.b.f);if(this.b.b&&!n.o()||this.b.c&&!n.r()){this.c.y(!0);this.bh.dk(this.n)}else this.s();this.b.b!==n.o()&&this.bi.a.bi().a("EncryptMessage");this.b.c!==n.r()&&this.bi.a.bi().a("SignMessage")},s:function(){this.c.y(!1);var n=this.bh.ba;var u=this.bi.a;var t=this.bh.bd();var i=t.a();if(n.o()!==this.b.b){n.ej(this.b.b);this.bs("SmimeEncryptMessage");_j.e.a(_a.a.k,"SmimeEncryptMessage option is changed to {0} by user.",this.b.b)}if(n.r()!==this.b.c){n.el(this.b.c);this.bs("SmimeSignMessage");_j.e.a(_a.a.k,"SmimeSignMessage option is changed to {0} by user.",this.b.c)}var r=this.b.b||this.b.c;r&&u.fn();i&&i.br(n.I());if(this.b.k&&!r&&t.j())if(t.b()){_j.e.a(_a.a.k,"Waiting to move attachments because the attachment well is currently in progress.");this.c.y(!0);i.H(this.f)}else this.u(null,null);else if(!this.b.k&&r){this.bh.bm()&&this.bh.bQ().i()&&!n.bk()&&this.bh.bQ().a().a();if(t.j())if(t.b()){_j.e.a(_a.a.k,"Waiting to move attachments because the attachment well is currently in progress.");this.c.y(!0);i.H(this.h)}else this.v(null,null);else this.i()}else this.i()},u:function(n,t){if(this.t(n,t)){_j.e.a(_a.a.k,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.B(this.f);this.c.y(!1)}var i=this.bh.bd().a();if(this.bh.ba.h())i.bi();else{var r=this;this.bh.bl().a("Attach",function(){i.bi()},null,!1)}this.i()}},v:function(n,t){if(this.t(n,t)){_j.e.a(_a.a.k,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.B(this.h);this.c.y(!1)}this.bh.bd().a().bj();this.i()}},t:function(n,t){return!n&&!t?!0:t==="IsInProgress"&&!n.k()},i:function(){_j.e.a(_a.a.a,"User hit OK on message options dialog, setting Sensitivity="+this.bj.y()+"; DeliveryReceipt="+this.bj.Y()+"; ReadReceipt="+this.bj.Z()+"; SmimeEncryptMessage="+this.bj.o()+"; SmimeSignMessage="+this.bj.r());this.r()},r:function(){if(this.c.C){_j.e.a(_a.a.a,"User tried to close dialog when busy.");return}var t=this.bi.a.ba;var i=this.bh.bw();if(t.I()&&t.D()){_a.F.a(_u.R.Gg,1);i.a(750)}else i.b(750);this.bh.bc().bb().c(!t.I());var n=this.bh.bd();if(n.a()){n.a().B(this.f);n.a().B(this.h)}"TouchNarrow"===_y.c.a.a()&&this.b.g.a().g(this.k);_j.e.a(_a.a.a,"Close message options dialog");this.c.o.a()},w:function(n,t){_mcp.e.isInstanceOfType(this.bi.a.bI().b())?this.c.f(!0):this.c.f(!1)},y:function(){var t=this.bi.a;var n=t.bw();switch(t.ba.y()){case"Personal":n.b(8900);break;case"Confidential":n.b(8901);break;case"Private":n.b(8902);break}this.bh.bf()},q:function(){var t=this.bi.a;var n=t.bw();switch(t.ba.y()){case"Personal":n.a(8900,null);break;case"Confidential":n.a(8901,null);break;case"Private":n.a(8902,null);break}this.bh.bf()}};_mcp.r=function(n,t,i,r){this.L=Function.createDelegate(this,this.Z);this.V=Function.createDelegate(this,this.bp);this.R=Function.createDelegate(this,this.bg);this.T=Function.createDelegate(this,this.bc);this.U=Function.createDelegate(this,this.bn);this.M=Function.createDelegate(this,this.bd);this.S=Function.createDelegate(this,this.bm);this.C=Function.createDelegate(this,this.be);this.N=Function.createDelegate(this,this.bf);_mcp.r.initializeBase(this,[2,n,i,r]);this.q=new _j.g(this.N,this.bk());var e=this;this.G=new _j.g(function(){e.A("Upconvert")},this.bk());var s=this;this.r=new _j.g(function(){s.A("ShowOriginalMessage")},this.bk());var h=this,o=this;this.I=new _j.v(function(){h.A("UpconvertOnFormat")},this.bk(),this.bi.a.ba,"BodyType",function(){return o.bi.a.ba.l()==="HTML"});var f=this;this.z=new _j.g(function(){f.A("UpconvertOnMoreOptions")},this.bk());var u=this;this.y=new _j.g(function(){u.bi.a.ba.ed(function(n){n.bv().E()});u.A("UpconvertAndShowApps")},this.bk());this.p=n.a.bP;this.D=t};_mcp.r.prototype={p:null,D:null,q:null,G:null,I:null,r:null,y:null,z:null,u:!1,v:!1,n:!1,s:!1,E:!1,m:null,o:null,x:!1,b:function(){return this.q},w:function(n){this.u!==n&&(this.u=n);return n},i:function(){return this.v},F:function(n){if(this.v!==n){this.v=n;this.W(n)}return n},h:function(){return this.n},K:function(n){if(this.n!==n){this.n=n;this.W(n)}return n},j:function(){return this.s},f:function(){return this.t().q()},k:function(n){this.t().j(n);return n},t:function(){this.o||(this.o=this.Y());return this.o},g:function(){var n=_y.c.a;"Mouse"!==n.a()||n.c()||n.x(this.C);_mcp.p.prototype.g.call(this)},c:function(n){this.o=n},a:function(n,t){n.P(!0);var i=this.bj.k();if(i===3){this.bh.bg.a(_a.bE,new _a.bE);this.bl(t)}this.t().e(n,t);i===1&&this.bh.bg.a(_y.bL,new _y.bL);this.bh.bg.a(IExtensibilityShowHideEvent,_mcp.Y.a)},e:function(n){this.bi.a.bK&&(this.x=!0);if(!this.x){_j.e.a(_a.a.a,"Checking dirty before prompting user for before unload confirmation.");this.bi.a.bS()&&n.a(_nbs.a.KZ)}this.x=!0;_j.n.a().a(_a.a.a,"ResetSkipBeforeUnloadConfirmationFlag",this.S,100)},l:function(){var n=!0;var u=this.bi;var t=u.a;var i=t.ba;var r=t.bh();var o=t.bl();var e=i.b();var s=i.a();if(this.p.a(e))_j.e.a(_a.a.a,"User had chose to discard, simply navigate away.");else if(i.bl()&&this.p.g(u,!1))_j.e.a(_a.a.a,"User had navigated away on an unused response, the unused response was discarded.");else if(this.X())n=!1;else if(r.c()){_j.e.a(_a.a.a,"We're sending the message, can't exit yet.");n=!1}else if(r.m()){_j.e.a(_a.a.a,"We're resolving the recipients before sending, can't exit yet.");r.k();n=!1}else if(i.S()){var f=t.bq();f.a().a();n=!1}else{_j.e.a(_a.a.a,"Checking dirty before navigating away from compose.");if(t.bS()){this.E=!1;_j.n.a().a(_a.a.a,"NavigatingAwaySaveTimeout",this.M,1e4);this.cf();if(o.a("ReadingPaneExit",this.U,this.T,!1)){this.K(!0);_j.e.a(_a.a.a,"Save is in progress or failed, can't exit yet.");n=!1}}}return n},Y:function(){return new _y.bm},bt:function(){var r;_a.h.a(r={val:this.I}),this.I=r.val;var u;_a.h.a(u={val:this.q}),this.q=u.val;var f;_a.h.a(f={val:this.G}),this.G=f.val;var n;_a.h.a(n={val:this.r}),this.r=n.val;var t;_a.h.a(t={val:this.z}),this.z=t.val;var i;_a.h.a(i={val:this.y}),this.y=i.val;_y.c.a.F(this.C);this.o=null;_mcp.p.prototype.bt.call(this)},bP:function(){if(this.bh.bm()){var n=new _fm.d(_u.n.Kn,null,this.q);return[n]}return null},bO:function(){return null},bK:function(){return null},bm:function(){this.x=!1},be:function(){_y.c.a.F(this.C);this.p.g(this.bi,!0)},W:function(n){var t=this.bi.a;t.eP(_u.P.p);t.eN(n);t.eM(n)},bf:function(){var t=this.bh;var n=t.ba;var f=n.b();_j.n.a().j(_a.a.a,"MailComposePopOut");if(this.u){_j.e.a(_a.a.a,"Skipped pop out because another pop out is in progress.");return}if(this.ba()){t.bi().a("UpconvertOnPopOut");n.v(this.m=_y.j.b(_a.a.a,"MailComposeReadingPanePopOut",!0));this.w(!0);var e=!1;try{var s=this.bi.a.bb;s.f(_mcp.r.b);t.bf();var i=t.bl();_j.e.a(_a.a.a,"Checking dirty before popping out from reading pane.");var u=t.bS();var r=t.ba.dh();var o=t.el();if(!n.h()||u||o.a()||r){this.F(!0);(n.h()&&!r||u||i.f())&&n.eV(!1);_j.e.a(_a.a.a,"Set WasCleanNewMessageBeforePopout = {0}",n.du());this.s=!1;_j.n.a().a(_a.a.a,"PopoutSaveTimeout",this.R,1e4);n.fL(!0);this.cf();t.bA.get_saveForPopoutMap()[f]=new _y.fY;this.bb();i.a("Popout",this.V,this.L,!1)}else{if(n.bG())n.eV(!1);else if(n.bD())n.eV(!1);else if(i.f())n.eV(!1);else if(n.eL){_j.e.a(_a.a.a,"Comparing initial baseline with baseline.");n.eL.s(n.eJ())||n.eV(!1)}else n.eV(!1);n.fL(!1);_j.s.b(t.bA,"PopoutManager");_j.s.b(t.bA.get_saveForPopoutMap(),"PopoutManager.SaveForPopoutMap");delete t.bA.get_saveForPopoutMap()[f];this.bb()}_j.e.a(_a.a.a,"MailComposeNavigationComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromReadingPaneToPopoutCompose = true");this.t().r(!0);e=!0}finally{if(!e){this.w(!1);this.F(!1);_y.j.a(this.m,null,_mcp.r.a.toString(4));n.v(null);this.m=null}}}},ba:function(){var r=this.bi;var u=r.a;var i=u.ba;var n=i.b();var t=this.bh.bh();if(t.c()){_j.e.a(_a.a.a,"Skipped navigating away because send is in progress.");return!1}if(this.X()||this.p.a(n)){_j.e.a(_a.a.a,"Skipped navigating away because attachment is currently uploading or user had discarded");return!1}return!0},X:function(){var n=this.bi.a;var t=n.bd();if(t.b()){if(!n.bk.p){_j.e.a(_a.a.a,"Show attachment in progress error dialog");n.bk.g(0,_u.R.Dk,null)}return!0}return!1},bb:function(){var r=this.bi.a;var n=r.ba;var t=new _mcp.b;this.D&&t.ee(this.D.b());t.t(0);t.g(!1);if(n.a()===11||n.a()===12){t.d(13);t.ec(n.bL());t.eb(n.bK())}else t.d(4);t.L(n.h());t.n(n.l());var i=this.Y();t.he(!0);t.cJ(n.i());t.eo(n.J());t.cI(n.bl());t.fG(n.bG());t.fF(n.bD());t.dN(n.co());t.eV(n.du());t.fL(n.cx());t.fK(n.b());t.z(n.s());t.v(n.bA());t.fr(n.bF());t.ca(n.R());t.fd=n.cw();t.dQ(n.dg());n.bA()&&n.bA().e()==="MailComposeReadingPanePopOut"&&n.v(null);n.i()||n.a()!==3||n.dx()||!n.e().S()||t.U(n.e().S().e);i.a(t);if(!n.cx()){this.J();this.w(!1)}},bp:function(n){this.F(!1);if(this.s){_j.e.a(_a.a.a,"Popout was cancelled by timer, skipping save succeeded processing for popout.");_y.j.a(this.m,null,_mcp.r.a.toString(3));this.m=null}else{var i=n.X;var t=this.bi.a;if(i in t.bA.get_saveForPopoutMap()){var u=_mcp.bk.a(n);var r=t.bA.get_saveForPopoutMap()[i];if(r.a.length){var f=JsonParser.serialize(u);t.bA.pushSaveResultToPopout(f,r.a);delete t.bA.get_saveForPopoutMap()[i]}else r.b=u}if(t.ba.b()===i){_j.e.a(_a.a.a,"Save succeeded for popout, navigating away from the main window.");this.J();this.w(!1)}else _j.e.a(_a.a.a,"Skipped navigating away since contextId={0}; viewModelId={1}",i,t.ba.b())}},bn:function(n){this.n&&this.K(!1);if(this.E){_j.e.a(_a.a.a,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.J()},bc:function(n){if(this.n){_j.e.a(_a.a.a,"Save failed, reset IsSavingForNavigatingAway flag to false");this.K(!1)}},J:function(){var n=this.bi.a;this.a(n,!1);_j.e.a(_a.a.a,"Navigated away from reading-pane compose")},A:function(n){this.bh.bi().a(n);var o=this.bi;var f=o.a;var t=f.ba;if(!t.i()&&!t.h()&&!t.J()){_j.e.a(_a.a.a,"upgrade is still in progress, need to wait till it is completed. ContextId={0}",t.b());f.bk.g(0,_nbs.a.ix);return}if(this.ba()){var e=this.t();if(IInlineComposeConductorViewModel.isInstanceOfType(e)){var i=_a.d.b(_a.a.a,"MailComposeUpConvert");i.j=n;var u=new _a.o;u.b("O",n);i.j=u.toString();t.v(i);t.en(!0);var r=e;this.bh.bQ().a().a();r.g(!1);r.m(t)}}},Z:function(n){if(this.u){this.w(!1);this.F(!1);var f=this.bi;var i=f.a;var t;t=n?n.X:i.ba.b();if(t in i.bA.get_saveForPopoutMap()){var r=i.bA.get_saveForPopoutMap()[t];r.a.length>0&&i.bA.pushSaveResultToPopout(null,r.a);delete i.bA.get_saveForPopoutMap()[t]}}var u=this.s?2:1;_y.j.a(this.m,null,_mcp.r.a.toString(u));this.m=null},bg:function(){_j.e.a(_a.a.a,"Attempt to popout expired since save did not come back in time");if(this.v&&!this.cd){this.s=!0;this.Z(null);var t=this.bi;var n=t.a.bb;this.cf();n.a(84);this.bh.bf()}},bd:function(){_j.e.a(_a.a.a,"Attempt to navigate away expired since save did not come back in time");if(this.n&&!this.cd){this.E=!0;this.bc(null);var n=this.bh.bb;this.cf();n.a(86);this.bh.bf()}},bl:function(n){var t=new _mcp.bw;t.Name="MailComposeNavigation";t.Result=n;n&&!this.bo()&&(t.Recipients=this.bh.bc().s());window.parent.postMessage(t,"*")}};_mcp.r.a=function(){};_mcp.r.a.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3,popoutEncounteredException:4};_mcp.r.a.registerEnum("_mcp.r.a",!1);_mcp.bL=function(n,t,i,r){this.z=Function.createDelegate(this,this.F);this.D=Function.createDelegate(this,this.R);this.p=Function.createDelegate(this,this.I);this.q=Function.createDelegate(this,this.K);this.A=Function.createDelegate(this,this.L);this.E=Function.createDelegate(this,this.S);this.C=Function.createDelegate(this,this.N);_mcp.bL.initializeBase(this,[28,n,i,r]);this.i=new _j.g(this.C,this.bk());this.j=new _j.g(this.E,this.bk());this.h=new _j.g(this.A,this.bk());this.y=t;this.bh.ba.bj()&&this.G();if(_a.g.b){var u=this.bh.ba.bJ();if(u){var f=this.bh.bw();f.a(10213,u.a(9))}}};_mcp.bL.prototype={i:null,j:null,h:null,o:null,v:null,m:null,x:null,u:null,w:null,n:null,t:null,l:null,f:null,b:null,c:null,y:null,k:null,e:0,r:function(){return!!this.bh.bt.OmeSettings},s:function(){var n=this.bh.bt.OmeSettings;return(n&3)==3||(n&5)==5},a:function(){return this.b},M:function(n){if(this.b!==n){this.b=n;this.bs("DialogViewModel")}return n},g:function(){this.bh.bt.WasLoadedFromServer||this.bh.bg.b(_a.cC,this.q);_mcp.p.prototype.g.call(this)},bt:function(){this.bh.bg.c(_a.cC,this.q);var r;_a.h.a(r={val:this.b}),this.b=r.val;var u;_a.h.a(u={val:this.c}),this.c=u.val;this.k&&(this.k.length=0);this.bi.a.bI().a().g(this.p);var i;_a.h.a(i={val:this.i}),this.i=i.val;var n;_a.h.a(n={val:this.j}),this.j=n.val;var t;_a.h.a(t={val:this.h}),this.h=t.val;_mcp.p.prototype.bt.call(this)},bP:function(){if(!_y.c.a.i()&&!this.bh.bm()){this.v=new _fm.d(_nbs.a.pm,null,this.j);this.o=new _fm.d(_nbs.a.rT,null,this.i);this.m=new _fm.d(_nbs.a.bv,null,this.h);this.bZ();return[this.v,this.o,this.m]}return null},bO:function(){if(!_y.c.a.i()){this.u=new _fm.g(this.j,_nbs.a.pm,null,1,null,null,!1,!1,!1,!1);this.x=new _fm.g(this.i,_nbs.a.rT,null,1,null,null,!1,!1,!1,!1);this.w=new _fm.g(this.h,_nbs.a.bv,null,1,null,null,!1,!1,!1,!1);this.bY();return[this.u,this.x,this.w]}return null},bK:function(){if(!_y.c.a.i()&&this.r()){this.t=new _y.h(_nbs.a.pm,this.j);this.n=new _y.h(_nbs.a.rT,this.i);this.l=new _y.h(_nbs.a.bv,this.h);this.f=this.bh.ba.bj()?this.l:this.s()?this.t:this.n;return[this.f]}return null},bY:function(){var t=this.r();var n=this.bh.ba.bj();var i=this.s();this.u.a(t&&i&&!n);this.x.a(t&&!i&&!n);this.w.a(t&&n)},bZ:function(){if(this.o&&this.m){var t=this.r();var n=this.bh.ba.bj();var i=this.s();this.v.a(!t||!i||n);this.o.a(!t||i||n);this.m.a(!t||!n)}},cy:function(){if(this.r()){this.l||this.n||(this.ch=this.bK());var n=this.bj.bj()?this.l:this.s()?this.t:this.n;if(this.f&&this.f!==n){this.bh.dX.K(this.f,n);this.f=n}else this.bh.bJ().b()}},N:function(){this.bh.ba.cc(!0);this.br();var n=this.bh.bw();this.e=10206;n.a(this.e,null)},L:function(){this.bh.ba.cc(!1);this.bh.ba.bJ()&&this.bh.ba.cK(null);this.br();var n=this.bh.bw();n.b(this.e)},S:function(){_j.e.a(_a.a.a,"User chose to show message options");this.c||(this.c=new _mcp.bb(this.bh.bt.OmeSettings));if(!this.b){var t=new _bc.k;t.F(this.y);this.M(t);this.b.q(_nbs.a.Vl);this.k=[new _ff.d(new _j.g(this.D,this.bk()),_u.P.V,null),new _ff.d(new _j.g(this.z,this.bk()),_u.R.BC,null)];this.b.n.m(this.k)}this.b.s(this.c);if("TouchNarrow"===_y.c.a.a()){var n=this.bi.a.bI();this.c.m(n);n.a().e(this.p)}this.b.f(!0)},F:function(){if(this.b.C){_j.e.a(_a.a.a,"User tried to close dialog when busy.");return}"TouchNarrow"===_y.c.a.a()&&this.c.b.a().g(this.p);_j.e.a(_a.a.a,"Close message options dialog");this.b.o.a()},G:function(){var i=this.bh.bw();var u=this.bh.ba.bj();if(u){var n=this.bh.ba.bJ();var f=!!n;var t="";if(f){var r=_a.c.a().u;t=n.F(r).a(1);this.e=10214}else this.e=10206;i.a(this.e,t)}else i.b(this.e)},I:function(n,t){_mcp.e.isInstanceOfType(this.bi.a.bI().b())?this.b.f(!0):this.b.f(!1)},R:function(){if(this.b.C){_j.e.a(_a.a.a,"User tried to click OK button more than once.");return}var n=!0;switch(this.c.a){case 0:break;case 1:n=this.J();break}if(n){this.c.i("");this.bh.ba.cc(!0);this.G();this.br();this.F()}},J:function(){for(var n="",h=0,s=0,o=0,c,t=!0,l=this.c.k(),a=l.length,r=0;r<a;++r){var u=l[r];var i;if(_j.i.a(u.a)){n=_u.n.Gl;t=!1;break}else if(isNaN(i=Number.parseInvariant(u.a))){n=_u.n.OJ;t=!1;break}switch(u.b){case 7:h=i;break;case 6:s=i-1;break;case 5:o=i;break}}if(t){var f,e;c=(e=this.T(o,s,h,f={val:n}),n=f.val,e);_j.i.a(n)&&this.bh.ba.cK(c.s())}if(!_j.i.a(n)){this.c.i(n);t=!1}return t},T:function(n,t,i,r){var u=new _a.c(n,t,i,23,59,0,0,_a.c.a().u);r.val="";t<0||t>11||_a.c.q(t,n)<i?r.val=_u.n.i:u.k(_a.c.a())<0&&(r.val=_u.n.NX);return _j.i.a(r.val)?u:null},K:function(n){if(!this.bo()){var t=this.bi.a;this.br();t.bg.c(_a.cC,this.q)}}};_mcp.bM=function(n,t){this.c=Function.createDelegate(this,this.e);_mcp.bM.initializeBase(this,[13,n]);this.b=new _j.g(this.c,this.bk());this.b.c(t.f().a().a())};_mcp.bM.prototype={b:null,a:function(){return this.b},e:function(){_j.e.a(_a.a.a,"OpenFilePicker on PAL.");var n=this.bh.bd();if(!n){_j.e.c(_a.a.a,"Unable to open file picker, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open file picker, attachment well ViewModel is null.");return}if(!n.c(!1)){_j.e.c(_a.a.a,"Unable to open file picker, ViewModel is not upgraded.");return}n.a().bV();_j.e.a(_a.a.a,"OpenFilePicker on PAL end.")},bt:function(){var n;_a.h.a(n={val:this.b}),this.b=n.val;_mcp.G.prototype.bt.call(this)}};_mcp.bO=function(n,t){this.h=Function.createDelegate(this,this.j);this.f=Function.createDelegate(this,this.i);_mcp.bO.initializeBase(this,[13,n]);var i;i=t.b(t.f())?t.f().a():this;var u=this;this.c=new _j.v(this.f,this.bk(),i,"CameraAvailable",function(){return t.b(t.f())&&t.f().a().c()});var r=this;this.e=new _j.v(this.h,this.bk(),i,"GalleryAvailable",function(){return t.b(t.f())&&t.f().a().e()})};_mcp.bO.prototype={c:null,e:null,a:function(){return this.c},b:function(){return this.e},i:function(){_j.e.a(_a.a.a,"User chose to attach from camera");var n=this.bi.b(5);if(!n){_j.e.c(_a.a.a,"Unable to open camera, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open camera, attachment well ViewModel is null.");return}if(!n.c(!1)){_j.e.c(_a.a.a,"Unable to open camera, ViewModel is not upgraded.");return}n.a().bk(n.k());_j.e.a(_a.a.a,"Attach from camera end")},j:function(){_j.e.a(_a.a.a,"User chose to attach from gallery");var n=this.bi.b(5);if(!n){_j.e.c(_a.a.a,"Unable to open gallery, attachment component is null.");return}if(!n.a()){_j.e.c(_a.a.a,"Unable to open gallery, attachment well ViewModel is null.");return}if(!n.c(!1)){_j.e.a(_a.a.a,"Unable to open gallery, ViewModel is not upgraded.");return}n.a().L(n.k());_j.e.a(_a.a.a,"Attach from gallery end")},bt:function(){var t;_a.h.a(t={val:this.c}),this.c=t.val;var n;_a.h.a(n={val:this.e}),this.e=n.val;_mcp.G.prototype.bt.call(this)}};_mcp.f=function(n,t,i){this.dH=Function.createDelegate(this,this.ex);this.dI=Function.createDelegate(this,this.cR);this.dJ=Function.createDelegate(this,this.dT);this.dK=Function.createDelegate(this,this.dU);this.dm=Function.createDelegate(this,this.eL);this.dj=Function.createDelegate(this,this.eF);this.dk=Function.createDelegate(this,this.eI);this.dP=Function.createDelegate(this,this.eP);this.bA=Function.createDelegate(this,this.eG);this.dO=Function.createDelegate(this,this.eM);this.cz=Function.createDelegate(this,this.eE);this.dl=Function.createDelegate(this,this.eK);this.cO=Function.createDelegate(this,this.el);this.dN=Function.createDelegate(this,this.eJ);this.dQ=Function.createDelegate(this,this.eQ);this.di=Function.createDelegate(this,this.eu);this.dM=Function.createDelegate(this,this.eC);this.dS=Function.createDelegate(this,this.dC);this.dL=Function.createDelegate(this,this.eB);this.dR=Function.createDelegate(this,this.eS);_mcp.f.initializeBase(this,[1,n,t,i]);this.dp={};this.dZ()&&(this.ca=new _fp.h(_a.g.a,i.h()));this.bm=this.dt(0);this.bl=this.dt(1);this.bn=this.dt(2);this.bX=new _j.g(this.dR,this.bk());this.cb=new _j.g(this.dL,this.bk());this.bS=new _j.g(this.dS,this.bk());this.cc=new _j.g(this.dM,this.bk());this.cm=new _j.g(this.di,this.bk());this.cA=new _j.g(this.dQ,this.bk());this.bW=new _j.g(this.dN,this.bk());this.ce=new _j.q;this.eo()};_mcp.f.d=function(n,t){n.ba(t)};_mcp.f.b=function(n,t){n.bU(t)};_mcp.f.e=function(n,t){n.cP(t)};_mcp.f.c=function(n,t){n.dD(t)};_mcp.f.a=function(n,t){n.dC(t)};_mcp.f.prototype={bm:null,bl:null,bn:null,bX:null,cb:null,bS:null,cc:null,cm:null,cA:null,bW:null,cw:null,ck:null,cj:null,ct:null,by:null,cv:null,cq:null,cs:null,co:null,cr:null,cn:null,cu:null,cp:null,de:null,cT:null,dd:null,cS:null,bp:null,bJ:null,da:!1,bu:!1,bx:null,cl:null,cQ:null,cE:null,dz:!1,dB:!1,dc:!1,db:!1,ce:null,bU:null,bz:null,cV:null,cW:null,cF:null,cU:null,cH:!0,T:function(n){this.bw("ResolveOperationSucceeded",n)},J:function(n){this.bH("ResolveOperationSucceeded",n)},S:function(n){this.bw("ResolveOperationCanceled",n)},I:function(n){this.bH("ResolveOperationCanceled",n)},dp:null,ca:null,m:function(){return this.ca},cY:function(n){if(this.bp!==n){this.bp=n;this.bs("FromPersonaViewModel")}return n},N:function(){return this.bp&&this.bp.bR?this.bp.bR.a():null},dY:function(){return!!this.bq&&this.bq.a().br().Enabled},ez:function(){return!!this.bq&&this.bq.a().J().Enabled&&_y.c.a.a()==="Mouse"},dZ:function(){return!!this.bq&&this.bq.a().ct().Enabled},Y:function(){var n=(this.bm.E()+this.bl.E()+this.bn.E()).trim();return n===""?n:n.substring(0,n.length-1)},n:function(){if(!this.bJ){var n=this;this.bh.dn.a(function(t){if(n.bo()){_j.e.a(_a.a.a,"get_FromFindRecipientViewModel: viewModel is null or disposing, aborting logic.");return}var i=t.a(null,null,0,0,!0);i.z(!0);i.bI(!1);i.cM(100);i.bJ(0);i.cK("PersonaDetailedView");i.cm();i.M(!0);i.bM(new _j.g(n.cO,_a.a.a));n.bM.d()&&i.bL(new _j.g(n.cO,_a.a.a));_y.c.a.a()!=="Mouse"&&i.cD(new _j.g(n.cO,_a.a.a));i.S(n.dl);n.bJ=i;if(n.dc){n.dC();n.dc=!1}else if(n.db){n.dy();n.db=!1}})}return this.bJ},y:function(){return this.da},K:function(n){if(this.da!==n){this.da=n;this.bs("ShouldHighlightFromAsInvalid")}return n},o:function(){return this.bm},l:function(){return this.bl},p:function(){return this.bn},eH:function(){var n=this.bi.a.ba.D()&&(!!this.bp&&this.bp.eH()||!!this.bJ&&this.bJ.ct());return n||this.bm.eH()||this.bl.eH()||this.bn.eH()},w:function(){return this.bu},eR:function(n){this.bu=n;this.bs("IsReadWrite");return n},cP:!1,Z:function(){return this.cP},ba:function(){return this.dz},cZ:function(n){this.dz=n;this.bs("IsPeoplePickerShown");return n},x:function(){return this.bW},C:function(){return this.bX},bb:function(){return this.bS},r:function(){var n=this.bi.a.ba;return!!n.m()&&!!n.m().Mailbox&&!_a.H.a(n.m().Mailbox.EmailAddress)},dn:!1,bV:!1,cC:function(){this.de||(this.de=new _y.h(_nbs.a.oG,this.bS));return this.de},dw:function(){this.cT||(this.cT=new _y.h(_nbs.a.Ou,this.cc));return this.cT},dx:function(){this.dd||(this.dd=new _y.h(_nbs.a.Kp,this.bX));return this.dd},dv:function(){this.cS||(this.cS=new _y.h(_nbs.a.Ro,this.cb));return this.cS},eb:function(){return!this.bi.a.ba.S()},ea:function(){return this.bi.a.ba.S()},W:function(){return this.dr(this.bu?this.bm.a.G:this.bm.b.b())||this.dr(this.bu?this.bl.a.G:this.bl.b.b())||this.dr(this.bu?this.bn.a.G:this.bn.b.b())},q:function(){return this.bm.f()||this.bl.f()||this.bn.f()},X:function(){return this.bm.g()&&this.bl.g()&&this.bn.g()},dX:function(){return this.bi.a.ba.S()||this.bi.a.dq()},cB:function(){return _y.c.a.a()==="Mouse"&&!!this.bq&&this.bq.a().e().Enabled},bQ:null,z:function(){return this.bQ},bB:function(){if(this.dY()&&!this.by){var n=this.ep();this.by=this.bh.bY.b(1,_bc.e.a,n,2,!1,!0,!1,0,0,this.bq,null,!0,this.bh.bs());this.by.d(!1);this.bQ=new _j.l;this.bQ.m(this.by.a().d())}return this.by},bC:function(){if(this.by&&this.bQ){var t=this.by.a().x.length;var n=this.F()-t;if(n>0)return String.format(_u.n.FC,n)}return""},bE:function(){return null},A:function(){return this.cH},L:function(n){if(!this.bh.bm()&&!this.bj.eN)return n;if(this.cH!==n){if(n){if(this.F()<=0)return n;this.f();this.bm.d.k(this.bj.f());this.bl.d.k(this.bj.j());this.bn.d.k(this.bj.c())}this.cH=n;this.bs("ShowAggregatedHeader");!this.cH&&_g.a.a().a().bk.AlwaysShowFrom&&this.dC()}return n},bD:function(){return!1},G:function(n){return this.cD(n).a.E},U:function(n,t){this.cD(t).a.bB(n)},bd:function(n){this.cD(n).a.C()},c:function(n){this.cD(n).bh()},b:function(n){return this.cD(n).a},bg:function(){this.bm.J();this.bl.J();this.bn.J()},bf:function(n){this.cE=n},eq:function(n,t,i){if(this.bx){this.bx.c(this.cl);this.bx.a(i);this.cl=i;this.bx.d(t);this.bx.e(n);this.cZ(!0);this.bi.a.bL(this.bx)}else{var r=this;this.bh.dx.a(function(u){if(r.bo()){_j.e.a(_a.a.a,"BuildAndLaunchRichPeoplePickerViewModel: viewModel is null or disposing, aborting logic.");return}r.bx=u.a(n,t,r.bh.bs());r.bx.a(i);r.bx.b(r.cz);r.cl=i;r.cZ(!0);r.bi.a.bL(r.bx)})}},en:function(){this.dq(0);this.dq(1)},a:function(){return this.ce},er:function(n,t,i,r){var u=null;this.cV=n;this.cW=r;this.cF=t;this.cU=i;r&&(u=this.ee(this.cW));if(!this.bz&&u){var f=this;this.bh.dy.a(function(t){if(!f.bo()){f.bz=t.a();f.ef(n,u)}})}else if(u){this.bz.a(this.cQ);this.ef(n,u)}},ef:function(n,t){this.bz.d(this.cz);this.bz.c(this.cV);this.bz.b(this.cU);this.cQ=n;t.a.F().cL(this.bz);this.cZ(t.q=!0);t.a.F().cO()},ee:function(n){var t=null;n===_u.n.Os?t=this.bm:n===_u.n.PT?t=this.bl:n===_u.n.RH&&(t=this.bn);return t},g:function(){var n=this.bi.a.ba;var t=n.F();this.eR(!t||!!t.a()||t.o()||t.b());this.bU=new _mcp.l(n.V(),this.dX(),this.bq);if(n.bO()&&n.bO().b()>0){this.bm.V(n.bO(),this.bu,_u.n.Os);n.em(null)}else{var u,f;var e=(f=this.bU.m(u={val:n}),n=u.val,f);this.bm.F(e,n.bn(),this.bu,_u.n.Os)}this.bl.F(n.j(),n.bg(),this.bu,_u.n.PT);this.bj.fr(this.bj.bF()||!this.dX()&&(this.bh.dt()||this.bh.bm()?!!n.j()&&n.j().b()>0:!0));this.bU.o(this.bu?this.bm.a:this.bm.b,this.bu?this.bl.a:this.bl.b);_y.c.a.i()&&this.eh(!0);this.en();var i=_g.a.a().c();if(!_j.i.a(i.bk.SharePointUrl)&&!_j.i.a(i.bk.LogonEmailAddress)){var r=new _g.O;r.Mailbox=this.ds(i.bk.LogonEmailAddress);n.cD(r)}("Mouse"===_y.c.a.a()||n.m()||_g.a.a().a().bk.AlwaysShowFrom||n.c()&&n.c().b()>0||_g.a.a().a().bk.AlwaysShowBcc)&&this.bR();this.ei(n);if(this.bh.bm()||n.bp()){this.bm.y(this.bh.ba.f());this.bl.y(this.bh.ba.j());this.bn.y(this.bh.ba.c());this.L(this.F()>0)}_mcp.p.prototype.g.call(this);this.dZ()&&this.ca.e(this.s())},eO:function(){if(this.bQ){this.bQ.f();this.bQ=null}if(this.by){if(this.by.a()){this.by.h(!0);var n;_a.h.a(n={val:this.by}),this.by=n.val}this.by=null}},f:function(){this.bR();var n=this.bj;this.df();this.dA(n,this.bm,this.dO,_mcp.f.e);this.dA(n,this.bl,_mcp.f.d,_mcp.f.c);this.dA(n,this.bn,_mcp.f.b,_mcp.f.a)},R:function(n){var u=this.bB().a().x.length;var i=u-1;if(n<i)this.bB().a().s(n+1,i-n);else if(n>i)for(var t=u;t<=n;t++)this.bB().a().a(this.bQ.x[t]);var r=!1;this.bB().a().x.length<this.bQ.x.length&&(r=!0);this.bB().d(r);this.bs("RecipientsTruncatedString")},M:function(n,t){var r=_a.H.a(n);if(r){this.n().e("");var e=this.ds(n);var o=_pc.a.a(e);var f=this.bi.a.bY.c;var i=f.a(o,4,!0,2,this.bh.bs(),!1);i.R(this.cA);i.b(!0);i.cw=!0;this.cY(i);this.et()}else{this.n().e(n);this.cY(null)}if(t&&_a.cA.a){var u=this.bi.a.cZ();u.a(1)}this.K(!r);this.f()},F:function(){this.bR();return this.bm.h()+this.bl.h()+this.bn.h()},e:function(){this.bR();return this.bm.h()},E:function(){this.bR();return this.bl.h()},D:function(){this.bR();return this.bn.h()},be:function(n){this.L(!1);this.bR();this.df();this.es();this.dB=n;this.ey()},s:function(){var n=new _j.q;this.bm.a?n.h(this.bm.a.f()):this.bm.b&&n.h(this.bm.b.f());this.bl.a?n.h(this.bl.a.f()):this.bl.b&&n.h(this.bl.b.f());this.bn.a?n.h(this.bn.a.f()):this.bn.b&&n.h(this.bn.b.f());return n.j()},v:function(n){this.ca&&this.ca.c(n)},bt:function(){var c;_a.h.a(c={val:this.bp}),this.bp=c.val;if(this.bx){this.bx.c(this.cl);this.bx.f(this.cz);this.bx.dispose();this.bx=null;this.cl=null}if(this.ez()&&this.bz){this.bz.f(this.cz);this.bz.a(this.cV);this.bz.e(this.cU);this.bz.dispose();this.bz=null;this.cQ=null;this.cF=null}this.eg();if(this.bJ){this.bJ.U(this.dl);this.bJ.dispose();this.bJ=null}this.eO();this.eg();this.eN();this.ce.f();var h;_a.h.a(h={val:this.bm}),this.bm=h.val;var s;_a.h.a(s={val:this.bl}),this.bl=s.val;var l;_a.h.a(l={val:this.bn}),this.bn=l.val;var y;_a.h.a(y={val:this.bX}),this.bX=y.val;var v;_a.h.a(v={val:this.cb}),this.cb=v.val;var a;_a.h.a(a={val:this.bS}),this.bS=a.val;var o;_a.h.a(o={val:this.cc}),this.cc=o.val;var i;_a.h.a(i={val:this.cm}),this.cm=i.val;var t;_a.h.a(t={val:this.cA}),this.cA=t.val;var n;_a.h.a(n={val:this.bW}),this.bW=n.val;var r;_a.h.a(r={val:this.cw}),this.cw=r.val;var e;_a.h.a(e={val:this.ck}),this.ck=e.val;var f;_a.h.a(f={val:this.cj}),this.cj=f.val;var u;_a.h.a(u={val:this.ct}),this.ct=u.val;this.bU=null;this.cE=null;_mcp.p.prototype.bt.call(this)},bP:function(){var n=new _j.q;if(!this.bj.S()){this.cs=new _fm.d(_nbs.a.Kp,null,this.bX);(_g.a.a().a().bk.AlwaysShowBcc||this.cB())&&this.cs.a(!0);n.c(this.cs);this.co=new _fm.d(_nbs.a.Ro,null,this.cb);(!_g.a.a().a().bk.AlwaysShowBcc||this.cB())&&this.co.a(!0);n.c(this.co)}if(this.bj.bI()||this.bj.I()){var i=this.bi.b(1);this.cv=new _fm.d(_nbs.a.oG,null,this.bS);n.c(this.cv);this.bS.c(!this.bj.I());this.cq=new _fm.d(_nbs.a.Ou,null,this.cc);this.cv.a(this.bj.D());this.cq.a(!this.bj.D());n.c(this.cq)}if(!this.bj.S()&&!_y.c.a.i()&&!this.bh.bm()&&_y.c.a.a()!=="TouchNarrow"){var t=new _fm.d(_nbs.a.hA,null,this.bW);n.c(t)}return n.j()},bO:function(){var n=new _j.q;if(!(this.bj.S()||this.bh.dt()||this.cB())){this.cr=_mcp.p.a(this.bX,_nbs.a.Kp);n.c(this.cr);this.cn=_mcp.p.a(this.cb,_nbs.a.Ro);n.c(this.cn);this.cr.a(!_g.a.a().a().bk.AlwaysShowBcc);this.cn.a(_g.a.a().a().bk.AlwaysShowBcc)}if(this.bj.bI()||this.bj.I()){this.cu=_mcp.p.a(this.bS,_nbs.a.oG);n.c(this.cu);this.cp=_mcp.p.a(this.cc,_nbs.a.Ou);n.c(this.cp);this.bS.c(!this.bj.I());this.cu.a(!this.bj.D());this.cp.a(this.bj.D())}if(!this.bj.S()&&!_y.c.a.i()){var t=_mcp.p.a(this.bW,_nbs.a.hA);n.c(t)}return n.j()},bK:function(){var n=new _j.q;_g.a.a().a().bk.AlwaysShowBcc?n.c(this.dv()):n.c(this.dx());if(this.bj.bI())if(_g.a.a().a().bk.AlwaysShowFrom){n.c(this.dw());this.bV=!1}else{n.c(this.cC());this.bV=!0}else this.bV=!1;_a.g.b||n.c(new _y.h(_nbs.a.hA,this.bW));return n.j()},cy:function(){var n=this.bj;var t=this.bh.dX;if(t){var u=n.D()?this.dw():this.cC();var f=n.D()?this.cC():this.dw();t.K(f,u);var i=n.R()?this.dv():this.dx();var r=n.R()?this.dx():this.dv();t.K(r,i)}},bZ:function(){if(this.cv&&this.cq){this.cv.a(this.bj.D());this.cq.a(!this.bj.D())}if(this.cs&&this.co){this.cs.a(this.bj.R()||this.cB());this.co.a(!this.bj.R()||this.cB())}},bY:function(){if(this.cu&&this.cp){this.cu.a(!this.bj.D());this.cp.a(this.bj.D())}if(this.cr&&this.cn){this.cr.a(!this.bj.R());this.cn.a(this.bj.R())}},ey:function(){this.bm.c?this.bm.D():this.dU(!0)},dU:function(n){n?this.bl.c?this.bl.D():this.dT(!0):this.cR(!1)},dT:function(n){n?this.bn.c?this.bn.D():this.cR(!0):this.cR(!1)},cR:function(n){if(this.dB)if(n){_j.e.a(_a.a.a,"Force resolve completed");this.ci("ResolveOperationSucceeded")}else{_j.e.a(_a.a.a,"Force resolve cancelled");this.ci("ResolveOperationCanceled")}},V:function(){this.bR();this.df();this.bm.C();this.bl.C();this.bn.C()},bR:function(){if(!this.dn){this.dn=!0;var n=this.bi.a.ba;this.bn.F(n.c(),n.N(),this.bu,_u.n.RH);if(n.c()&&0<n.c().b()||!_j.i.a(n.N())||_g.a.a().a().bk.AlwaysShowBcc){n.ca(!0);_j.e.a(_a.a.a,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",n.c()?n.c().b():0,!_j.i.a(n.N()),_g.a.a().a().bk.AlwaysShowBcc)}this.dq(2);_j.e.a(_a.a.a,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.m()||!n.m().Mailbox?"<not set>":n.m().Mailbox.EmailAddress,n.f()?n.f().b():0,n.j()?n.j().b():0,n.c()?n.c().b():0);this.ei(n);if(n.bI()&&!this.bh.bm()&&(n.m()||_g.a.a().a().bk.AlwaysShowFrom||this.eD())){_j.e.a(_a.a.a,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.m()||!n.m().Mailbox?"<not set>":n.m().Mailbox.EmailAddress,_g.a.a().a().bk.AlwaysShowFrom);this.n()?this.dy():this.db=!0}else if(_g.a.a().a().bk.AlwaysShowFrom&&n.F()&&!n.F().b()){var t=this.bi.a.bb;t.b(4525);t.a(4525);this.bh.bf()}}},bc:function(){this.bm.G();this.bl.G();this.bn.G()},t:function(){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses");var e=this.bi.a.ba;var t=new _j.q;var u=this.bu?this.bm.a.G:this.bm.b.b();var f=this.bu?this.bl.a.G:this.bl.b.b();var r=this.bu?this.bn.a.G:this.bn.b.b();if(u){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding to addresses");t.h(u.d())}if(f){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding cc addresses");t.h(f.d())}if(r){_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding bcc addresses");t.h(r.d())}_j.e.a(_a.a.k,"MailComposeRecipientComponent.GetAllEmailAddresses: Adding from address");var n=e.bQ();if(!n){var i=_g.a.a().c();n=new _g.f;n.Name=i.bk.UserDisplayName;n.EmailAddress=i.bk.UserEmailAddress||i.bk.LogonEmailAddress;n.MailboxType="Mailbox";n.RoutingType="SMTP"}t.c(n);return t},eQ:function(){if(this.bp){_j.e.a(_a.a.a,"User selected from persona");this.bp.F(!0);this.cE&&this.cE()}else _j.e.a(_a.a.a,"User tries to select from persona, but it is null")},eJ:function(){this.bi.a.bi().a("ResolveRecipients");this.be(!1)},eu:function(){_j.e.a(_a.a.a,"User chose to delete from persona");this.cY(null);this.n().V(!0)},el:function(){this.M(this.n().c(),!0)},eK:function(n,t){this.em()},dt:function(n){return new _mcp.B(this.bi.a.bY,this,this.bq,this.bi,this.dp,this.ca,n,this.bh.ba.a(),this.bh.bs())},eM:function(n,t){if(this.bU){var i;this.bU.l(t,i={val:n}),n=i.val}else n.q(t)},eG:function(n,t){this.ce.f();this.dD(this.bm);this.dD(this.bl);this.dD(this.bn)},dD:function(n){n.a?this.ce.c(n.a):n.b&&this.ce.c(n.b)},eo:function(){this.bm.apcl("ReadWriteRecipientWellViewModel",this.bA);this.bl.apcl("ReadWriteRecipientWellViewModel",this.bA);this.bn.apcl("ReadWriteRecipientWellViewModel",this.bA);this.bm.apcl("ReadOnlyRecipientWellViewModel",this.bA);this.bl.apcl("ReadOnlyRecipientWellViewModel",this.bA);this.bn.apcl("ReadOnlyRecipientWellViewModel",this.bA)},eN:function(){this.bm.rpcl("ReadWriteRecipientWellViewModel",this.bA);this.bl.rpcl("ReadWriteRecipientWellViewModel",this.bA);this.bn.rpcl("ReadWriteRecipientWellViewModel",this.bA);this.bm.rpcl("ReadOnlyRecipientWellViewModel",this.bA);this.bl.rpcl("ReadOnlyRecipientWellViewModel",this.bA);this.bn.rpcl("ReadOnlyRecipientWellViewModel",this.bA)},eF:function(n,t){this.L(!1);this.bm.f()||this.bl.f()||this.bn.f()||(this.bM.d()?this.bi.a.bb.b(97):this.bi.a.bb.b(65));this.bm.g()&&this.bl.g()&&this.bn.g()||this.bi.a.bb.b(70);_y.c.a.i()&&this.eh(!1);if(t&&t.c===2){var i=this.bi.a.cZ();i.b();_a.bq.a&&_j.n.a().c(_a.a.F,"TriggerPolicyTipsIfNeeded",this.dP)}},eL:function(n,t){this.bU&&this.bU.n(n,t)},es:function(){this.bm.a&&this.bm.a.bj();this.bl.a&&this.bl.a.bj();this.bn.a&&this.bn.a.bj()},eE:function(){this.cZ(!1);var n=this.ee(this.cW);n&&(n.q=!1);this.cF&&this.cF()},eg:function(){this.cX(0);this.cX(1);this.cX(2)},dq:function(n){var t=this.cX(n);if(t){t.ch(this.ed(n));t.eg(this.dk);t.E.e(this.dj);n||t.E.e(this.dm)}return t},cX:function(n){var t=null;switch(n){case 0:t=this.bm.a;break;case 1:t=this.bl.a;break;case 2:t=this.bn.a;break}if(t){t.cr(this.ed(n));t.eJ(this.dk);t.E.g(this.dj);n||t.E.g(this.dm)}return t},ed:function(n){switch(n){case 0:return this.dK;case 1:return this.dJ;case 2:return this.dI;default:throw Error.notImplemented("a new recipient type has been introduced and mail compose recipient component does not work with it");}},eI:function(){this.bh.bf()},eS:function(){var t=_a.d.b(_a.a.a,"MailComposeShowBcc",!0);this.bi.a.bi().a("ShowBcc");_j.e.a(_a.a.a,"User chose to show bcc");this.bR();var n=this.bi.a.ba;if(!n.R()){n.ca(!0);this.bs("ShowBccButton");this.bh.bf();this.br()}_a.d.a(t)},eB:function(){var t=_a.d.b(_a.a.a,"MailComposeHideBcc",!0);this.bi.a.bi().a("HideBcc");_j.e.a(_a.a.a,"User chose to hide bcc");this.bR();var n=this.bi.a.ba;if(n.R()){n.ca(!1);this.bs("ShowBccButton");this.bh.bf();this.br()}_a.d.a(t)},ei:function(n){if("Mouse"!==_y.c.a.a()){var f=this.bi;var u=f.a;var r=u.dX;if(r){var i=r.a;if(i)if(n.bI()){if(!this.bV)for(var t=0;t<i.length;t++)if(_nbs.a.Kp===i[t].b){r.x(this.cC(),t+1);this.bV=!0}}else if(this.bV){u.dX.s(this.cC());this.bV=!1}}}},df:function(){var i=this.bi.a.ba;var n=null;if(i.D()){var t=null;this.bp?t=this.bp.bR.a():this.bJ&&!_j.i.a(this.bJ.c())&&(t=this.ds(this.bJ.c()));n=new _g.O;n.Mailbox=t;i.cD(n);this.r()||this.bi.a.bb.b(66)}return n},eD:function(){var t=!1;if(this.bM.d()){var n=_g.a.a().c();t=n.e().b()>0||!!n.a()&&n.a().b()>0||n.b().b()>1}return t},ep:function(){var n=new _j.l;if(this.bj){this.bj.f()&&n.m(this.bj.f().d());this.bj.j()&&n.m(this.bj.j().d());this.bj.c()&&n.m(this.bj.c().d())}return n},ds:function(n){var t=new _g.f;t.MailboxType="Mailbox";t.RoutingType="SMTP";t.EmailAddress=n;return t},et:function(){var t=_mcp.B.b;var n=[];(t&4)==4&&Array.add(n,new _fm.d(_u.n.NH,null,new _j.g(this.dH,_a.a.a)));(t&2)==2&&Array.add(n,new _fm.d(_u.n.Ls,null,new _j.g(this.di,_a.a.a)));this.bp.ci&&(t&1)==1&&Array.addRange(n,this.bp.ci);this.bp.bf(n)},dy:function(){var t=this.bi.a.ba;var n=null;var i=_g.a.a().c();n=_j.i.a(i.bk.SharePointUrl)||_j.i.a(i.bk.LogonEmailAddress)?null!==t.m()&&t.m().Mailbox?t.m().Mailbox.EmailAddress:_mco.a.g(null)||i.bk.UserEmailAddress:i.bk.LogonEmailAddress;var u=this.bh.cx();u.a()||u.g();var r;var e,f;(f=u.c(n,e={val:r}),r=e.val,f)&&(n=r);this.M(n,!1);t.dT(!0);var o=this.df();t.eJ()&&t.eJ().z(o);this.br()},ex:function(){var n=this.bp.bR.a().EmailAddress;this.cY(null);this.n().e(n);this.n().V(!0)},em:function(){var n=this.n().K();if(n&&n.a()&&n.a().a()){var t=n.a().a().EmailAddress;_j.e.a(_a.a.a,"User selected from={0}",t);this.M(t,!0)}else _j.e.b(_a.a.a,"User selected from but the SelectedResultItem persona is invalid")},dC:function(){if(!this.n()){this.dc=!0;return}var t=_a.d.b(_a.a.a,"MailComposeShowFrom",!0);this.bi.a.bi().a("ShowFrom");var n=this.bi.a.ba;if(n.D())_j.e.a(_a.a.a,"Skip show from since it is already shown");else{_j.e.a(_a.a.a,"User chose to show from");this.L(!1);this.cP=!0;this.dy();this.bh.bf();this.br()}_a.d.a(t)},eC:function(){this.L(!1);var t=_a.d.b(_a.a.a,"MailComposeHideFrom",!0);this.bi.a.bi().a("HideFrom");var n=this.bi.a.ba;if(n.D()){n.dT(!1);this.cP=!1;this.bh.bf()}else _j.e.a(_a.a.a,"Skip hide from since it is already hidden");this.br();this.bi.a.bb.b(750);_a.d.a(t)},dA:function(n,t,i,r){var u=this.bu?t.a:t.b;if(u){i(n,u.b());if(_rw.d.isInstanceOfType(u)){var f=u;f.F()&&r(n,f.F().c())}}},eh:function(n){var e=this.bi.a.ba;var i=!1;var u=e.bQ();if(u){var t=this.bl.a.G;if(t)for(var r=0;r<t.x.length;r++){var f=t.x[r];if(u.EmailAddress.toLowerCase()===f.EmailAddress.toLowerCase()){i=!0;break}}}if(n&&i){this.bi.a.bb.b(4450);this.bi.a.bb.a(4450)}else n||i||this.bi.a.bb.b(4450)},dr:function(n){if(!n||!n.x.length)return!1;for(var t=0;t<n.x.length;t++){var i=n.x[t];if(i&&i.MailboxType==="GroupMailbox")return!0}return!1},du:function(n){var t=this.bm.z(n)||this.bl.z(n)||this.bn.z(n);t&&n.a.dj(t)},ec:function(){if(!this.cw){var n=this;this.cw=new _j.g(function(){n.du(n.bm)},_a.a.a)}return this.cw},dW:function(){if(!this.ck){var n=this;this.ck=new _j.g(function(){n.du(n.bl)},_a.a.a)}return this.ck},dV:function(){if(!this.cj){var n=this;this.cj=new _j.g(function(){n.du(n.bn)},_a.a.a)}return this.cj},eA:function(){if(!this.ct){var n=this;this.ct=new _j.g(function(){n.bj.fr(!0);n.bh.bf();n.bi.a.bi().a("ShowCc")},_a.a.a)}return this.ct},cD:function(n){switch(n){case 0:return this.bm;case 1:return this.bl;case 2:return this.bn;default:throw Error.argument();}},eP:function(){_mcp.G.a(this.bh,1)}};_mcp.s=function(n){this.c=Function.createDelegate(this,this.h);_mcp.s.initializeBase(this,[31,n])};_mcp.s.f=function(n){for(var i=[],t=0;t<n.length;t++)_j.i.b(n[t])||Array.add(i,n[t].trim());return i};_mcp.s.d=function(n,t){for(var i=0;i<n.length;i++)if(n[i]===t||t&&n[i]&&n[i].toLowerCase()===t.toLowerCase())return!0;return!1};_mcp.s.c=function(n){var t=_g.a.a().c();t?Array.add(n,t.bk.UserEmailAddress):_j.e.b(_a.a.a,"SessionSettings is null.")};_mcp.s.b=function(n,t){t.bk.From&&t.bk.From.Mailbox&&t.bk.From.Mailbox.EmailAddress&&Array.add(n,t.bk.From.Mailbox.EmailAddress)};_mcp.s.a=function(n,t){if(t)for(var i=0;i<t.b();i++)Array.add(n,t.a(i).EmailAddress)};_mcp.s.e=function(n,t){for(var u=$("a[id^='OWAAM']",t),i=0;i<u.length;i++){var r=u[i];r.href.startsWith("mailto:")&&Array.add(n,r.href.substr(7))}};_mcp.s.prototype={a:function(n,t){if(this.bj.e())this.e(n,t);else{var i=this;this.bh.eo(function(){i.e(n,t)})}},b:function(n){if(!n)throw Error.argumentNull("originalMessage");var u=[];var t=[];_mcp.s.c(t);_mcp.s.b(t,n);_mcp.s.a(t,n.m());_mcp.s.a(t,n.o());for(var f=this.bh.bc().t(),r=0;r<f.d.length;r++){var i=f.d[r];if(i&&!_mcp.s.d(t,i.EmailAddress)){Array.add(u,i);Array.add(t,i.EmailAddress)}}return u},e:function(n,t){if(this.bj&&this.bj.e()&&this.bj.e().bx()===1&&this.bj.fY()&&this.bh.bu.a()==="Mouse"&&this.bj.l()!=="Text"){var r=this.bj.e();var i=new _cmc.bk;i.c=r;i.a=n;i.b=t;i.d=this.c;this.bh.bH().a(i)}},h:function(n,t,i,r,u){var e=[];_mcp.s.c(e);_mcp.s.b(e,t);this.f(e);_mcp.s.a(e,t.m());_mcp.s.a(e,t.o());_mcp.s.e(e,i);var f;if(_j.i.a(n))f=new Array(0);else{n.startsWith("+")&&(n=n.substr(1));f=_mcp.s.f(n.split(","))}for(var l=0;l<r.length;l++){var s=r[l];if(s&&s.a()&&!_mcp.s.d(e,s.a().EmailAddress)){var o=s.c()||"";var a=o.indexOf(" ");a>0&&s.b()===1&&(o=o.substr(0,a));for(var c=-1,h=0;h<f.length;h++)f[h].toLowerCase()===o.toLowerCase()&&(c=h);u?Array.add(f,o):c>-1&&Array.removeAt(f,c)}}return f.length>0?"+"+f.join(", ")+" ":null},f:function(n){if(this.bj.eM){var r=this.bj.eM;for(var i in r){var u={key:i,value:r[i]};var t=u.value;t&&t.Mentioned&&Array.add(n,t.Mentioned.EmailAddress)}}}};_mcp.B=function(n,t,i,r,u,f,e,o,s){this.M=Function.createDelegate(this,this.ba);this.L=Function.createDelegate(this,this.Z);this.O=Function.createDelegate(this,this.bc);this.N=Function.createDelegate(this,this.bb);this.w=Function.createDelegate(this,this.be);this.u=Function.createDelegate(this,this.X);this.v=Function.createDelegate(this,this.bd);this.p=Function.createDelegate(this,this.Y);this.K=Function.createDelegate(this,this.W);_mcp.B.initializeBase(this);this.o=n;this.n=t;this.m=i;this.e=r;this.I=u;this.A=f;this.r=e;this.x=o;this.s=s};_mcp.B.prototype={o:null,m:null,j:null,a:null,b:null,d:null,n:null,i:null,k:null,t:null,e:null,I:null,A:null,s:!1,U:function(){return!!this.m&&this.m.a().J().Enabled&&_y.c.a.a()==="Mouse"},S:function(n){if(this.a!==n){this.a=n;this.bs("ReadWriteRecipientWellViewModel")}return n},q:!1,Q:function(){this.j||(this.j=new _j.g(this.K,_a.a.Y));return this.j},l:0,bg:function(n){if(n!==this.b){this.b=n;this.bs("ReadOnlyRecipientWellViewModel")}return n},E:function(){return this.a?this.R(!0):""},bf:function(n){if(n!==this.d){this.d=n;this.bs("AggregatedRecipientWellViewModel")}return n},g:function(){return this.c&&_rw.b.h(this.a)},c:!1,f:function(){return this.c&&!!this.a&&this.a.Q},bh:function(){this.c&&this.a&&this.a.ed()},r:0,x:0,V:function(n,t,i){this.k=n;this.c=t;this.a?this.a.k(null):this.S(this.P(null));var r=this.a.F();if(r){r.e("");r.bE(this.k)}else this.a.apcl("FindRecipientViewModel",this.p);this.i=i},F:function(n,t,i,r){this.c=i;this.t=t;if(this.c){this.a?this.a.k(n):this.S(this.P(n));var u=this.a.F();if(u){!_j.i.a(u.c())&&_j.i.a(t)&&u.e(t);_j.i.a(t)||u.e(t)}else this.a.apcl("FindRecipientViewModel",this.p);this.i=r;this.a.E&&this.a.E.e(this.v)}else this.b?this.b.k(n):this.bg(this.T(n))},D:function(){this.a&&this.a.cl()},C:function(){this.a&&!this.q&&this.a.bs()},J:function(){if(this.a&&this.a.F().bB())if(this.a.F().cs()){this.a.dc(!0);this.a.dc(!1)}else{this.a.de(!0);this.a.de(!1)}},h:function(){var n;n=this.c?this.a?!this.a.F()||_j.i.a(this.a.F().c())?this.a.G.x.length:this.a.G.x.length+1:0:this.b?this.b.b().x.length:0;return n},G:function(){if(this.a){var n=this.R(!1);n!==""&&_j.e.a(_a.a.a,"{0} Well Invalid Recipients are: {1} \n",this.i,n)}},R:function(n){var e="";if(this.a)for(var o="",f="",u,t,i=0,s=this.a.E.x.length;i<s;i++){u=this.a.E.x[i];if(u&&!u.l){t=this.a.G.x[i];if(t){f=_j.i.b(t.Name)?"":t.Name;var r=null;if(n)r=String.format("{0}, ",f);else{o=_j.i.b(t.EmailAddress)?"":t.EmailAddress;r=String.format("( {0} , {1} ),",f,o)}e+=r}}}return e},bt:function(){if(this.a){this.a.E&&this.a.E.g(this.v);this.a.dZ(this.u);this.a.rpcl("SelectedRecipient",this.w);this.a.t(!1);this.a.h(!0);var i;_a.h.a(i={val:this.a}),this.a=i.val}if(this.b){this.b.h(!0);var r;_a.h.a(r={val:this.b}),this.b=r.val}if(this.d){this.d.h(!0);var n;_a.h.a(n={val:this.d}),this.d=n.val}var t;_a.h.a(t={val:this.j}),this.j=t.val;this.n=null;_j.Q.prototype.bt.call(this)},P:function(n){var t=this.o.a(_mcp.B.b,_pe.c.b,n,!0,!0,this.I,this.A,this.r,this.x,this.s,!0);t.dI(this.u);t.apcl("SelectedRecipient",this.w);return t},T:function(n){return this.o.b(_mcp.B.a,_bc.e.a,n,2)},y:function(n){this.bf(this.o.b(_mcp.B.a,_bc.e.a,n,2,!1,!0,!1,n?n.b():0,0,this.m,null,!1,this.s));return this.d},be:function(n,t){if(this.e){var i=n;var r=this.e.a;if(i.I!==i.bi){r.bb.f([10210,10211]);i.bi=null}}},X:function(n){if(this.e){var t=this.e.a;switch(n){case 1:t.bb.a(10210);break;case 0:t.bb.a(10211);break}}},Y:function(n,t){var r=n;var i=r.F();if(this.k&&this.k.x.length>0){i.e("");i.bE(this.k)}_j.i.b(this.t)||i.e(this.t);r.rpcl("FindRecipientViewModel",this.p)},W:function(){if(this.c&&!_a.g.b)if(this.U()){_j.e.a(_a.a.a,"User chose to launch the new people picker");_a.r.a.c("VM.PeoplePicker.Launched",_a.c.a());var t;_a.n.b(_a.a.Y,"LaunchV2PeoplePicker",!0,(t=new _a.Q,t.b=!0,t));this.l=0;this.n.er(this.N,this.O,this.L,this.i)}else{_j.e.a(_a.a.a,"User chose to launch rich people picker");this.a.bs();_a.r.a.c("VM.PeoplePicker.Launched",_a.c.a());var n;_a.n.b(_a.a.Y,"PeoplePicker",!0,(n=new _a.Q,n.b=!0,n));this.n.eq(this.a.E,this.i,this.M)}},Z:function(n){this.a&&this.a.F().N(n)},bb:function(n){var t=n;if(t.a()){_a.H.a(_g.m.c(t.a()))||t.a().RoutingType==="MAPIPDL"?this.a.v(t):this.a.ba(t);this.l++}},bc:function(){if(this.l>0){var n=new _cmc.g(_a.a.Y,"CloseV2ToPicker",!1);n.a("sc",this.l,!0,!0);n.b()}},ba:function(n){_y.c.a.a()!=="TouchNarrow"&&this.a.y();var t=this;n.n(function(n){var i=n;i.l?t.a.v(i.k):t.a.ba(i.k)})},z:function(n){var u=this.a.E;var r=null;if(this!==n)for(var t=0;t<u.x.length;t++){var i=u.x[t];if(i.x){r=i;this.a.bm(i);break}}return r},bd:function(n,t){this.e&&this.e.a&&this.e.a.fg(t,this.r)}};_mcp.y=function(n,t,i,r,u){this.M=Function.createDelegate(this,this.bx);this.N=Function.createDelegate(this,this.by);this.T=Function.createDelegate(this,this.bd);this.U=Function.createDelegate(this,this.be);this.S=Function.createDelegate(this,this.bA);this.R=Function.createDelegate(this,this.bz);this.m={};_mcp.y.initializeBase(this,[8,n,r,u]);this.G=t;this.t=new _j.g(this.R,this.bk());this.x=new _j.g(this.S,this.bk());this.A=n.a.bP;this.W=i};_mcp.y.prototype={W:null,n:null,A:null,G:null,t:null,x:null,r:!1,w:!1,z:null,y:null,v:null,o:null,e:function(){return this.t},j:function(){return this.x},c:function(){return this.r},I:function(n){if(n!==this.r){this.r=n;this.bs("IsSaving")}return n},bB:function(n){if(n!==this.v){this.v=n;this.bs("DraftSavedTime")}return n},s:!1,h:function(){return this.s},l:function(n){this.s=n;return n},q:!1,f:function(){return this.q},b:function(n,t){var i=this.bi;var f=i.b(5);var u=i.a.bk;var r=i.a.ba;_j.e.a(_a.a.a,"UserInitiatedSave - SaveStart");i.a.bi().a("Save");this.cf();if(!r.bH()){_j.e.a(_a.a.a,"Save not supported for the current operation {0}",r.a());return}if(f.b()){_j.e.a(_a.a.a,"Skip save and show attachment in progress dialog");u.p||u.g(0,_u.R.Dk,null);return}this.q=!0;this.a("Save",n,t,!1)},g:function(){this.Z();_mcp.p.prototype.g.call(this)},Z:function(){if(this.bh.cz()&&!this.o){_j.e.a(_a.a.a,"Setting save component override");this.o=this.bh.cy().d();var u=this.bh.bc();var o=this.bh.bd();var f=u,e=u,t=u,n=u,r=o,i=o;this.o.b(this.U,this.T,f.j||(f.j=Function.createDelegate(f,f.e)),e.i||(e.i=Function.createDelegate(e,e.E)),t.h||(t.h=Function.createDelegate(t,t.D)),n.k||(n.k=Function.createDelegate(n,n.f)),r.e||(r.e=Function.createDelegate(r,r.l)),i.f||(i.f=Function.createDelegate(i,i.n)),_cmc.h.b,this.cI)}},Y:function(){if(this.o){this.o.a();this.o=null}},a:function(n,t,i,r){if(this.o&&!this.o.c()){_j.e.a(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false.  Save ignored.");return!0}var h=this.bi;var o=h.a;var u=o.ba;var c=o.bb;var f=u.b();var a=this.bi.b(5);var s=this.bh.bh();if(s.c()&&!r){_j.e.a(_a.a.a,"Send is in progress, this {0} save is ignored. ContextId={1}",n,f);return!0}if(this.A.a(f)){_j.e.a(_a.a.a,"User already discarded, clearing all save processors to ignore save effects. ContextId={0}",f);this.m={};return!1}var e=this.bh.bc();e.V();if(_g.a.a().bk.MaxRecipientsPerMessage<e.F()){c.a(800,null);this.bh.bf();return!0}e.f();u.bC().a();this.m[n]=new _mcp.bY(t,i);if(!this.r||r){this.z=_mcp.c.b(u);this.I(!0)}else{this.w=!this.z.t(u);return!0}if(!u.i()&&!u.h()&&!u.J()){_j.e.a(_a.a.a,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId={0}",f);return!0}this.J(n);this.y=n;_j.n.a().j(_a.a.a,"MailComposeSave");_j.e.a(_a.a.a,"Started new task runner context before starting save.");try{this.o?this.o.d(n):this.be(n);return!0}catch(l){this.bd(l);throw l;}},J:function(n){_a.G.b(_a.a.a,"MailComposeSave",5);this.n=_y.j.b(_a.a.a,"MailComposeSave",!0);this.n&&this.bj.eN&&this.n.o(_mcp.y.b)},i:function(){this.r=!1;this.w=!1;_j.e.a(_a.a.a,"ResumeSave");var i=this.m;for(var r in i){var n={key:r,value:i[r]};var t=n.value;this.a(n.key,t.a,t.b,!0);break}},bt:function(){this.r=!1;this.w=!1;this.q=!1;this.s=!1;this.m=null;this.z=null;this.Y();var t;_a.h.a(t={val:this.t}),this.t=t.val;var n;_a.h.a(n={val:this.x}),this.x=n.val;_mcp.p.prototype.bt.call(this)},cx:function(n){return _db.i.c(n.J,40,50,60,700,88,89,43,57)},cJ:function(n){if("ReadingPaneExit"in this.m||"Popout"in this.m){var u=this.bi.a;var t=u.bb;var f=this.cx(n);var e=new _y.cH;var i=e.a(f,null);t.f(_mcp.r.b);"ReadingPaneExit"in this.m?t.a(87,i):t.a(85,i);if(f===50){var r=this;u.cG.a(function(n){if(!r.bo()){n.a(t);r.bh.bf()}})}else this.bh.bf()}else"Save"in this.m&&_mcp.G.prototype.cJ.call(this,n)},bP:function(){if(this.bj.a()!==8&&!this.bj.S()&&!_y.c.a.i()){var n=new _fm.d(_nbs.a.EM,null,this.bh.bl().e());return[n]}return null},bO:function(){if(this.bj.a()!==8&&!this.bj.S()&&!_y.c.a.i()){var n=_mcp.p.a(this.t,_nbs.a.EM);return[n]}return null},bK:function(){return null},be:function(n){_j.e.a(_a.a.be,"Setup save action, OriParentFolderId={0}",this.bj.e()&&this.bj.e().bk.ParentFolderId&&_g.b.a?_g.b.a.idToName(this.bj.e().bk.ParentFolderId):"null");var t=this.bh.bO.h(this.bh,0);if((_mco.a.isInstanceOfType(t)||_mco.b.isInstanceOfType(t))&&("Attach"===n||"Popout"===n)&&this.bj.S()){var i=t;i.bp=new _g.E(new _g.r("internalsubmission"))}this.bh.bp.a(t,this.N,this.M,null);_j.e.a(_a.a.a,"Save action submitted")},bz:function(){this.bi.a.bi().a("Save");this.b(null,null)},bA:function(){_j.e.a(_a.a.a,"User chose to close and save");if(this.bh.bS()){_j.e.a(_a.a.a,"User hit close, the form is dirty, attempt to save and navigate away.");var n=this;this.b(function(){n.bb()},null)}else this.bb()},bd:function(n){this.I(!1);this.q=!1;var t=n.toString();_y.j.a(this.n,null,t,null,this.F(this.y,n.message));this.n=null;_a.G.a("MailComposeSave");_j.e.b(_a.a.a,"Save failed due to an error before action was submitted: {0}",t)},bc:function(n){var s=this.bi;var u=s.a;var f=u.ba;var t=n.X;var r=!1;if(this.A.a(t)){f.b()===t&&(this.m={});this.u(n);var e=_mcp.bk.a(n);if(e){_j.e.a(_a.a.a,"Resume discard for context {0}",t);u.bq().e(t,e)}r=!0}else if(t===f.b()){if(this.s){this.s=!1;_j.e.a(_a.a.a,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId={0}",t);this.m={};this.u(n);var i=null;_db.f.isInstanceOfType(n)?i=n.F:_mco.b.isInstanceOfType(n)&&(i=n.bn);i&&f.L(i);var o=this.bh.bh();o.e();r=!0}else if(this.w){_j.e.a(_a.a.a,"Saving new content per user's request. ContextId={0}",t);this.i();r=!0}}else _j.e.a(_a.a.a,"Skipping default save processing due to ContextId={0}; viewModelId={1}",t,u.ba.b());return r},by:function(n){var e=this.bi;var r=e.a;var o=r.ba;var h=r.bq();var f=n.X;_j.e.a(_a.a.a,"Save action returned success, ContextId={0}",f);if(!this.bc(n)&&f===o.b()){this.bu(n);this.ba();var i=!1;var t=null;if("Attach"in this.m){if("AutoSave"in this.m){t=this.m.AutoSave;t&&t.a(n)}t=this.m.Attach}else if("Popout"in this.m){t=this.m.Popout;var u=r.bn();if(u&&u.j()&&"ReadingPaneExit"in this.m){t&&t.a(n);t=this.m.ReadingPaneExit}}else if("ReadingPaneExit"in this.m)t=this.m.ReadingPaneExit;else if("AutoSave"in this.m){t=this.m.AutoSave;i=!0}else if("Save"in this.m){t=this.m.Save;i=!0}else"Diagnostics"in this.m&&(i=!0);t&&t.a&&t.a(n);if(i){var s=e.b(5);s.A()}this.m={}}_y.j.a(this.n,null,"",this.X(n),this.F(this.y,""));this.n=null},ba:function(){var i="";var t=this.m;for(var n in t){var r={key:n,value:t[n]};i+=r.key+":"}_j.e.a(_a.a.a,"ProcessorKeys:{0}",i)},bx:function(n){var l=this.bi.a.ba;var s=n.X;_j.e.a(_a.a.a,"Save action returned a failure, ContextId={0}",s);if(!this.bc(n)&&s===l.b()){this.ba();var t=!1;var h=this.m;for(var c in h){var i={key:c,value:h[c]};var o=i.value;if(o.b){o.b(n);if((i.key==="ReadingPaneExit"||i.key==="Popout")&&!t){this.V(n);t=!0}}else if(!t){this.V(n);t=!0}}t||this.u(n);this.m={}}var r;var u;var f,e;this.dh(n.J,f={val:r},e={val:u},"SaveFailure_UnknownError"),r=f.val,u=e.val;_y.j.a(this.n,null,r,this.X(n),this.F(this.y,u));this.n=null},bu:function(n){var o=this.bi;var r=o.a;var t=r.ba;var f=n.X;var h=this.q;if(f===t.b()){this.bC(n);t.cG(!1);r.eS()}this.ci("MailSaveSucceeded");if(f===t.b()){var s=_a.c.a();var i=s.a(0);this.bB(t.bp()?String.format(_nbs.a.nq,i):String.format(_nbs.a.cC,i));var e=!!this.bq&&this.bq.a().e().Enabled;if(h&&!e){var u=r.bb;u.f(_mcp.y.a);u.a(1001,i);this.bh.bf()}}_a.bq.a&&this.bh.da().a(this.q?4:2);this.u(n)},V:function(n){_j.e.a(_a.a.a,"SaveActionFailed: Error: {0}",n.J.message);n.X===this.bi.a.ba.b()&&this.cJ(n);var t=this.bi.a;t.bK&&t.P(!1);this.u(n)},u:function(n){var i=this.bi;var t=i.a.ba;if(n.X===t.b()){this.I(!1);this.q=!1}_a.G.a("MailComposeSave")},X:function(n){var t=null;_db.f.isInstanceOfType(n)&&n.Q?t=n.Q.correlationId:_mco.b.isInstanceOfType(n)&&n.Q&&(t=n.Q.correlationId);return t},F:function(n,t){var i=new _a.o;i.b("Ctx",n||"");i.b("Err",t||"");return i.toString()},bC:function(n){var t=this.bi.a.ba;t.fh(this.z);if(this.q){t.fF(!0);this.q=!1;_j.e.a(_a.a.a,"Explicit save recorded. ContextId={0}",t.b())}if(_mco.a.isInstanceOfType(n)){var u=n;var r=u.F;u.j.bO(r);t.L(r);t.dI(u.j);_j.e.a(_a.a.a,"Updated context from create action.");this.G.H(r)}else if(_mco.b.isInstanceOfType(n)){var i=n;var o=i.bn;i.f.bO(o);t.L(o);t.dI(i.f);_j.e.a(_a.a.a,"Updated context from update action.")}else if(_mco.c.isInstanceOfType(n)){var a=n;var l=a.F;t.L(l);_j.e.a(_a.a.a,"Updated context from create response action. ")}else if(_mcp.C.isInstanceOfType(n)){var v=n;var p=v.c.f();t.L(p);_j.e.a(_a.a.a,"Updated context from create response from modern group action. ")}else if(_mcp.M.isInstanceOfType(n)){var y=n;var h=y.F;t.L(h);_j.e.a(_a.a.a,"Updated context from create approval response action. ")}if(_db.f.isInstanceOfType(n)&&t.P()){var c=n;var e=c.bW;var f=t.P().es();if(e&&f){var s=0;var w=this;f.n(function(n){var t=n;t.f(e[s]);s++});_j.e.a(_a.a.a,"Attachment IDs have been updated.")}}},bb:function(){this.bh.bn().a(this.bh,!1);_j.e.a(_a.a.a,"Navigated away from compose")}};_mcp.t=function(n,t){this.k=Function.createDelegate(this,this.q);this.j=Function.createDelegate(this,this.v);this.i=Function.createDelegate(this,this.u);_mcp.t.initializeBase(this,[18,n]);this.e=t.d()};_mcp.t.a=function(n,t){return new _fm.d(n,null,t,!0)};_mcp.t.prototype={e:!1,h:0,a:function(){return this.ew(_mcp.t.c)},p:function(n){this.ev(_mcp.t.c,n);return n},n:function(){var t=!1;if(this.e){var n=_g.a.a();var i=n.c().bk.UserEmailAddress;t=i.toLowerCase().startsWith("outlook_"+n.bk.HexCID)}return t},g:function(){if(!this.a()){var n=this.e?[_mcp.t.a(_u.R.NM,null)]:this.m(_fm.d,_mcp.t.a);if(n){this.p(new _fm.f(n));this.a().bM(new _j.g(this.i,this.bk()));this.a().u=this.j}}_mcp.G.prototype.g.call(this)},b:function(n){if(n&&n.Mailbox){var r=n.Mailbox.EmailAddress;if(r!==_g.a.a().c().bk.UserEmailAddress&&!_mco.a.f(n)){var t=_g.a.a().a().R();if(t){if(t.g(r))return;t.b()===1&&t.a(0)===""&&t.q(0)}var i=new _a.j;i.c(r);i.y(t);i.b()>_mcp.t.b&&i.q(i.b()-1);_g.a.a().a().bB(i);_h.f.a(_g.a.a().a().v,_a.g.a);this.s(r)}}},c:function(n,t){t.val=null;var r=_g.a.a().c().bk.UserEmailAddress;if(this.n()&&n===r){var i=this.o(r);t.val=i.length>0?i[0]:t.val}return!_j.i.a(t.val)},bt:function(){if(this.a()){this.a().dispose();this.p(null)}_mcp.G.prototype.bt.call(this)},v:function(){if(this.e&&!this.h){this.h=1;_j.n.a().a(this.bk(),"SendAsContextMenu",this.k,2e3);var n=new _mcp.bt;var i=this,r=this,t=this;this.bh.bp.a(n,function(t){_g.a.a().c().i(new _a.j(n.c));_g.a.a().c().h(new _a.j(n.f));_g.a.a().c().l(new _a.j(n.i))},function(n){_j.e.b(_a.a.a,"Fail to load alias list for consumer, use the alias list in userConfiguration instead.")},function(n){t.q()})}},s:function(n){if(!this.e&&this.a()){for(var r=_mcp.t.a(n,new _j.g(this.f(n),this.bk())),t=this.a().p,i=t.x.length-1;i>0;i--)if(_fm.i.isInstanceOfType(t.x[i])){t.t(i+1,r);var u=t.x.length-i-1;u>_mcp.t.b&&t.p(t.x.length-1);return}t.a(new _fm.i);t.a(r)}},u:function(){if(this.a()&&this.a().s){var f=this.a().s;var r=_g.a.a().a().R();var e=r.l(f.l);if(e){for(var n=this.a().p,t=n.x.length-1;t>0;t--)if(n.x[t].l===f.l){n.p(t);var u=n.x.length;_fm.i.isInstanceOfType(n.x[u-1])&&n.p(u-1);break}var i=new _a.j;r.b()>0?i.y(r):i.c("");_g.a.a().a().bB(i);_h.f.a(_g.a.a().a().v,_a.g.a)}}},m:function(n,t){var i=new _j.q;var r=_g.a.a().c().bk.UserEmailAddress;this.n()||i.c(t(r,new _j.g(this.f(r),this.bk())));if(this.e){var e;this.r(e={val:i},t,r),i=e.val;var o;this.l(o={val:i},t),i=o.val}else{var u;this.l(u={val:i},t),i=u.val;var f;this.t(f={val:i},t),i=f.val}return i.j()},l:function(n,t){for(var u,r=_g.a.a().c().e(),f=r?r.b():0,i=0;i<f;i++){u=r.a(i).EmailAddress;n.val.c(t(u,new _j.g(this.f(u),this.bk())))}},r:function(n,t,i){for(var e=this.o(i),u=e,o=u.length,r=0;r<o;++r){var f=u[r];n.val.c(t(f,new _j.g(this.f(f),this.bk())))}},o:function(n){var o=new _a.j;if(this.e){for(var f,e,u=_g.a.a().c().b(),s=u?u.b():0,t=_g.a.a().c().a(),h=t?t.b():0,i=0;i<s;i++){f=u.a(i);n!==f&&o.c(f)}for(var r=0;r<h;r++){e=t.a(r);n!==e&&o.c(e)}}return o.f()},t:function(n,t){var i=_g.a.a().a().R();var r=i?i.b():0;if(r===1&&i.a(0)===""){i.q(0);r=0}if(r>0){var f;n.val.c(new _fm.i);for(var u=0;u<r;u++){f=i.a(u);n.val.c(t(f,new _j.g(this.f(f),this.bk())))}}},f:function(n){var t=this;return function(){_j.e.a(_a.a.a,"User chose from={0}",n);t.bi.a.bc().M(n,!0)}},q:function(){if(this.h===1&&!this.bo()){this.h=2;var n=this.m(_fm.d,_mcp.t.a);if(n&&this.a()&&this.a().p){this.a().p.f();this.a().p.m(n)}}}};_mcp.g=function(n,t,i,r){this.i=Function.createDelegate(this,this.m);this.j=Function.createDelegate(this,this.n);_mcp.g.initializeBase(this,[35,n]);this.f=t;this.h=i;this.e=r};_mcp.g.a=function(n){return window.document.createElement(n)};_mcp.g.c=function(){return _mcp.g.a("table")};_mcp.g.b=function(){return _mcp.g.a("td")};_mcp.g.k=function(n){for(var u=_mcp.g.b(),r=0;r<n.length;){var f=n[r].a().e();_mcp.g.f(u,f);r=_mcp.g.g(u,n,f,r)}var t=_mcp.g.c();t.style.width="350px";t.style.marginLeft="auto";t.style.marginRight="auto";t.appendChild(u);var e=_mcp.g.h();e.appendChild(t);var i=_mcp.g.a("div");i.style.margin="5px 0px";i.appendChild(e);i.appendChild(_mcp.g.l());return"<br>"+i.outerHTML};_mcp.g.f=function(n,t){var r=_mcp.g.c();_j.k.a(r,"width","100%");r.style.paddingTop="8px";var i=_mcp.g.b();i.style.padding="0px 10px";i.style.textAlign="center";i.style.whiteSpace="nowrap";i.innerText=String.format("{0}, {1} {2}",_a.c.p(t.r()),_a.c.z(t.d()),t.K().j());r.appendChild(i);n.appendChild(r)};_mcp.g.g=function(n,t,i,r){for(var u=r;u<t.length&&!t[u].a().k(i);){var f;var c=t[u].a();var e,o;var h=(o=_mcp.g.m(t,u,e={val:f}),f=e.val,o);u=f;var s=String.format("{0} - {1} ({2})",c.a(0),h.a(0),_mcp.g.e);n.appendChild(_mcp.g.j(s))}return u};_mcp.g.m=function(n,t,i){var u=n[t].b();for(i.val=t+1;i.val<n.length;i.val++){var r=n[i.val].a();if(!r.k(n[i.val-1].b())&&r.L(n[i.val-1].b())<=0)u=n[i.val].b();else break}return u};_mcp.g.h=function(){var n=_mcp.g.a("div");_j.k.a(n,"width","100%");n.style.borderTopWidth="1px";n.style.borderTopStyle="dotted";n.style.borderTopColor="#c8c8c8";n.style.borderBottom=n.style.borderTop;n.style.paddingBottom="8px";return n};_mcp.g.j=function(n){var i=_mcp.g.i(n);var t=_mcp.g.c();t.style.backgroundColor="#f8f8f8";t.style.fontWeight="600";t.style.color="#000000";t.style.marginTop="6px";_j.k.a(t,"width","100%");t.appendChild(i);return t};_mcp.g.i=function(n){var t=_mcp.g.b();t.style.padding="8px 0px";t.style.marginTop="6px";_j.k.a(t,"text-align","center");t.innerText=n;return t};_mcp.g.l=function(){var n=_mcp.g.c();n.style.color="#0078d7";n.style.marginTop="6px";n.style.marginLeft="auto";n.style.marginRight="auto";_j.k.a(n,"text-align","center");_j.k.a(n,"width","100%");var t=_mcp.g.b();t.appendChild(_mcp.g.d);n.appendChild(t);return n};_mcp.g.prototype={f:null,h:null,e:null,c:null,b:null,a:function(){this.c||(this.c=new _j.g(this.j,_a.a.a));return this.c},g:function(){if(this.d()){_j.e.b(_a.a.a,"MailComposeSendAvailableTimeComponent is already initialized, skipping redundant Initialize call.");return}this.k();this.l();this.b=new _mcp.bp(_y.c.a,this.e);_mcp.G.prototype.g.call(this)},bt:function(){var t;_a.h.a(t={val:this.b}),this.b=t.val;var n;_a.h.a(n={val:this.c}),this.c=n.val;_mcp.G.prototype.bt.call(this)},k:function(){if(!_mcp.g.d){var t=this.f.a().b().Enabled?"http://outlook.live.com":"http://outlook.office.com";var n=_mcp.g.a("a");n.style.textDecoration="none";n.style.color="inherit";n.href=t;n.innerText=_nbs.a.Fg;_mcp.g.d=n}},l:function(){if(_j.i.a(_mcp.g.e))for(var i=this.h.bk.TimeZone.split(" "),r=i.length,n=0;n<r;++n){var t=i[n];t.length>0&&!_j.i.a(t)&&(_mcp.g.e+=t.charAt(0))}},n:function(){this.b&&this.b.q(this.i)},m:function(n){if(n&&n.length>0){var i=_mcp.g.k(n);this.bh.bH().a(new _cmc.G(!1));var t=new _cmc.l(0,i,!0,7);this.bh.bH().a(t)}}};_mcp.u=function(n,t,i,r,u){this.bm=Function.createDelegate(this,this.cl);this.br=Function.createDelegate(this,this.cr);this.bB=Function.createDelegate(this,this.cy);this.bq=Function.createDelegate(this,this.cq);this.E=Function.createDelegate(this,this.cp);this.N=Function.createDelegate(this,this.co);this.bf=Function.createDelegate(this,this.G);this.bg=Function.createDelegate(this,this.bR);this.bl=Function.createDelegate(this,this.bS);this.bC=Function.createDelegate(this,this.cA);this.bD=Function.createDelegate(this,this.cB);this.bp=Function.createDelegate(this,this.bX);this.D=Function.createDelegate(this,this.cc);this.bn=Function.createDelegate(this,this.bb);this.bz=Function.createDelegate(this,this.cv);this.by=Function.createDelegate(this,this.cu);this.bx=Function.createDelegate(this,this.ct);this.bu=Function.createDelegate(this,this.cs);this.bA=Function.createDelegate(this,this.cw);_mcp.u.initializeBase(this,[7,n]);this.o=new _j.g(this.bA,this.bk());this.J=new _j.g(this.bu,this.bk());this.K=new _j.g(this.bx,this.bk());this.C=new _j.g(this.by,this.bk());this.z=new _j.g(this.bz,this.bk());this.W=n.a.bP;this.bO=t;this.A=i;this.s=u};_mcp.u.prototype={W:null,bO:null,A:null,s:null,R:null,Q:null,y:!1,I:null,r:null,t:null,w:null,T:!1,bc:!1,p:null,o:null,z:null,K:null,J:null,C:null,v:0,f:function(){return this.p?this.p.c():null},a:function(){return this.o},b:function(n){this.o=n;return n},n:function(){return this.K},j:function(){return this.J},F:!1,m:function(){return this.F},c:function(){return this.y},x:function(n){if(n!==this.y){this.y=n;this.bs("IsSending");var t=this.bi.a;t.eM(this.y);t.eP(_u.P.O);t.eN(this.y)}return n},h:function(){return this.P()&&this.bc},u:0,l:function(){return this.u},P:function(){var n=this.bj.a()===2&&this.bj.eN;return(_g.a.a().bk.AsyncSendEnabled&&!this.bj.eN||n)&&this.bh.bu.a()==="Mouse"&&!this.bh.bs()&&!this.bj.I()&&!!this.bh.bT&&!!this.bh.bZ&&this.bj.k()!==3},ba:function(){return!1},cj:function(){return!!this.A&&this.A.a().b().Enabled},i:function(){return this.t},Z:function(){if(this.bh.cz()&&!this.p){_j.e.a(_a.a.a,"Setting send component override");this.p=this.bh.cy().e();var n=this.bh.bc();var s=this.bh.bd();var f=n,e=n,o=n,i=n,t=n,u=s,r=s;this.p.d(this.bh.u(),this.bn,this.D,this.bp,this.bD,this.bC,this.bl,this.bg,this.bh.bp,this.bi.a.bY,f.u||(f.u=Function.createDelegate(f,f.t)),this.dE,this.bf,e.j||(e.j=Function.createDelegate(e,e.e)),o.i||(o.i=Function.createDelegate(o,o.E)),i.h||(i.h=Function.createDelegate(i,i.D)),t.k||(t.k=Function.createDelegate(t,t.f)),u.e||(u.e=Function.createDelegate(u,u.l)),r.f||(r.f=Function.createDelegate(r,r.n)),_cmc.h.b,this.cI);this.bs("InvalidRecipientsDialogViewModel")}},Y:function(){if(this.p){this.p.a();this.p=null;this.bs("InvalidRecipientsDialogViewModel")}},g:function(){this.Z();var n=this.bh.bc();if(n){n.J(this.N);n.I(this.D);n.T(this.N);n.S(this.D)}_mcp.G.prototype.g.call(this)},e:function(){_j.e.a(_a.a.a,"ResumeSend() called by external mail-compose component.");this.bb()},bb:function(){var i=this.bh;var n=this.bj;var t=i.bl();i.da().e();i.eg().a();if(t.c()){t.l(!0);_j.e.a(_a.a.a,"Send deferred due to in progress save.")}if(n.i()||n.h()||n.J()){if(!t.h()){this.bh.bc().f();_j.e.a(_a.a.a,"Send without pending saves, OriParentFolderId={0}",n.e()&&n.e().bk.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.e().bk.ParentFolderId):"null");this.S()}}else{var r=n.b();_j.e.a(_a.a.a,"Send was attempted during upgrade for context {0}, keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.",r)}},S:function(){var t=this.bh;var r=this.bj;var n=t.bO.h(t,1);_j.e.a(_a.a.a,"Submitting send action");var i=_g.k.a;_bc.l.isInstanceOfType(i)?_mco.b.isInstanceOfType(n)?n.cb(this.E):_mco.a.isInstanceOfType(n)&&n.bC(this.E):this.bU();t.bp.a(n,this.bS(),this.bR(),this.bq);_j.e.a(_a.a.a,"Send action submitted")},bt:function(){this.bh.bc().J(this.N);this.bh.bc().I(this.D);var r;_a.h.a(r={val:this.o}),this.o=r.val;var u;_a.h.a(u={val:this.z}),this.z=u.val;var i;_a.h.a(i={val:this.J}),this.J=i.val;var n;_a.h.a(n={val:this.K}),this.K=n.val;var t;_a.h.a(t={val:this.C}),this.C=t.val;this.x(!1);this.Y();this.R=null;this.Q=null;_mcp.G.prototype.bt.call(this)},cc:function(){var i=this.bi.a.bb;var t=this.bh.bc();var n=null;this.x(!1);if(t.q()){this.O();n="InvalidRecipients";this.s.a(_a.V,new _a.V(_u.R.Tn,!1))}if(t.r()){this.O();n="InvalidSendAddress"}this.bh.bf();this.k();n=n||"CancelSend_UnknownError";this.q(n,null,null)},k:function(){var n=this;_j.n.a().a(_a.a.a,"ExitResolvingRecipientsMode",function(){n.F=!1},2e3)},cx:function(n){var t;var i=_a.b.l(n.J);if(i==="ErrorSendAsDenied")t=80;else{var u,r;i==="ErrorRightsManagementPermanentException"&&(r=this.cC(n.J,u={val:t}),t=u.val,r)||(t=i==="ErrorSubmissionQuotaExceeded"?47:i==="ErrorAccountSuspend"?90:i==="ErrorExceededMaxRecipientLimit"?91:i==="ErrorExceededMessageLimit"?92:i==="ErrorExceededHourlyMessageLimit"?101:i==="ErrorMessageBlocked"?93:i==="ErrorMessageSubmissionBlocked"?94:i==="ErrorAccountSuspendShowTierUpgrade"?98:i==="ErrorExceededMaxRecipientLimitShowTierUpgrade"?99:i==="ErrorExceededMessageLimitShowTierUpgrade"?100:_db.i.c(n.J,45,55,62,700,88,89,46,58))}return t},bY:function(){this.r=_y.j.b(_a.a.a,"MailComposeSend",!0)},bS:function(){return this.R||this.bB},bR:function(){return this.Q||this.br},cB:function(n){this.R=n},cA:function(n){this.Q=n},cC:function(n,t){var u=n.MessageXml;if(u)for(var f=Sys.Net.XMLDOM(u),r=0;r<f.firstChild.childNodes.length;r++){var i=f.firstChild.childNodes[r];if(i.nodeType===1&&_a.Y.b(i)==="Value"&&_a.Y.c(i,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.Y.a(i))){t.val=48;return!0}}t.val=-1;return!1},cs:function(){if(this.o.b){this.v=this.X()?2:0;this.o.a()}},ct:function(){if(this.o.b){this.v=this.X()?1:0;this.o.a()}},cu:function(){if(this.o.b){this.v=this.X()?3:0;this.o.a()}},X:function(){return _y.c.a.a()==="Mouse"&&!!this.A&&this.A.a().e().Enabled},cw:function(){if(this.p&&!this.p.e()){_j.e.a(_a.a.a,"saveComponentOverride.IsReadyForSmimeOperation() == false. Exiting SendStart().");return}_a.G.b(_a.a.a,"MailComposeSend",5);this.T=!0;this.ba()||this.bY();if(this.v){this.bh.bi().a(_mcp.bg.toString(this.v));this.v=0}(_mcp.j.isInstanceOfType(this.bh)||IGroupInlineComposeViewModel.isInstanceOfType(this.bh))&&this.bj.hg(!0);if(this.P()){this.t=_y.j.b(_a.a.a,"MailComposeSendAsync",!0);if(IGroupInlineComposeViewModel.isInstanceOfType(this.bh)){var n=this.bh;_g.i.isInstanceOfType(this.bj.e())&&n.b()&&(this.w=_y.j.b(_a.a.a,"MailComposeSendAsyncQuickQuickness",!0))}}_j.e.a(_a.a.a,"SendStart");this.cf();this.bj.r()?this.p.f():this.bX();this.bh.bi().a("Send")},bX:function(){_j.e.a(_a.a.a,"User chose to send, start force resolve recipients");this.F=!0;this.bh.bc().be(!0)},co:function(){if(this.y){_j.e.a(_a.a.a,"Skip send since another send is in progress");return}this.x(!0);this.F=!1;_j.n.a().j(_a.a.a,"MailComposeSend");_j.e.a(_a.a.a,"Started new task runner context before starting send.");var r=!0;try{var n;var i,t;(t=this.cn(i={val:n}),n=i.val,t)?n?_j.e.a(_a.a.a,"waiting for a pending validation decision, once decided, send will resume"):this.bd():this.x(!1);r=!1}finally{if(r){this.x(!1);_j.e.b(_a.a.a,"Send failed due to an unhandled exception thrown before the action was submitted");this.G("SendFailure_UnhandledException",null,null)}}},bd:function(){_mco.l.a(this.bh.bb,"compose");this.bj.gk(!1);if(this.bh.ba.bi()){this.bj.cC(new _cmc.M);this.bj.hi(_cmc.M.a(this.bj.de()))}if(this.p)this.p.b();else{this.bb();if(this.P()&&!this.bj.dj()){var n=this.bJ();if(!n){_j.e.a(_a.a.a,"Navigating away after submitting action for send via notification");this.bj.gk(!0);this.bc=!0;this.bV();this.bU();this.bW()}}}},bW:function(){this.bP()},bP:function(){var n=this;this.bh.bT.a(function(){n.s.a(ISendEvent,new _mcp.bq(n.bh))})},bJ:function(){var n=!1;if(this.bh.bZ.c()){var i=this;this.bh.bZ.a(function(t){t.a()>0&&(n=!0)})}if(!n&&this.bh.bT.c()){var t=this;this.bh.bT.a(function(t){t.a()>0&&(n=!0)})}return n},bU:function(){if(IGroupInlineComposeViewModel.isInstanceOfType(this.bh)&&_g.i.isInstanceOfType(this.bj.e())&&this.bj.cp()){var n=this.bh;if(n.b()&&n.g()){var u=this.bj.e();var r=_cmc.s.b(n.b().bk,n.g(),this.bj.m()||this.bj.bt(),this.bj.bt(),"sentitems");var f="MC:"+r.InternetMessageId;this.s.a(_a.bW,new _a.bW(f,this.bj));_h.c.B(r,u.bk.InternetMessageId,n.q()?u:null);var i="OMC:"+n.b().bk.ConversationId.Id;var t=n.A().c[i];if(t)t.d.c(n.g().bk.InternetMessageId);else{t=new _cmc.bH(n.g().bk.InternetMessageId);this.s.a(_a.bW,new _a.bW(i,t))}if(this.w){_y.j.a(this.w);this.w=null}}}},cn:function(n){n.val=!1;var h=this.bi;var i=h.a;var t=i.bc();var o=i.bd();var s=i.bb;var c=h.b(23);if(this.W.a(i.ba.b())){_j.e.a(_a.a.a,"User had already discarded, skipping send.");this.q("UserAlreadyDiscarded",null,"User has already discarded, skipping send");return!1}else if(t.r()){_j.e.a(_a.a.a,"Not valid to send since sender's address is invalid");s.a(66,null);this.bh.bf();this.q("InvalidSendAddress",null,"Sender's address is invalid, not valid to send");return!1}else if(!i.ba.S()&&t.X()){_j.e.a(_a.a.a,"Not valid to send since no recipients were specified");s.a(70,null);this.bh.bf();this.q("NoRecipients",null,"No recipients were specified, not valid to send");return!1}else if(t.q()){_j.e.a(_a.a.a,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, HasInvalidRecipients={1}",t.r(),t.q());t.bc();this.O();this.bh.bf();this.q("InvalidRecipients",null,"Invalid recipients are present, not valid to send");return!1}else if(o.b()){_j.e.a(_a.a.a,"Not valid to send since attachment is in progress");var f=i.bk;f.p||f.g(0,_u.R.Dk,null,!1,null,null,null,f.z);this.q("AttachmentInProgress",null,"Attachment is in progress, not valid to send");return!1}else if(_g.a.a().bk.MaxRecipientsPerMessage<t.F()){s.a(800,null);this.bh.bf();this.q("MaxRecipients",null,"Max recipients exceeded, not valid to send");return!1}else if(_a.bq.a&&c.c()){_j.e.a(_a.a.a,"Not valid to send since policy violation detected");var l=i.bk;l.g(0,c.b(),null,!1,null,null,null,l.z);this.q("PolicyTipViolation",null,"PolicyTip violation detected, not valid to send");return!1}else if(_j.i.a(this.bh.ba.s())&&!this.bj.eN){n.val=!0;var u=i.bk;u.p||u.h(2,[_nbs.a.Sf],this.bm,!1,_nbs.a.Tj,_nbs.a.Ih,_nbs.a.Kr,u.z,null);return!1}else if(o&&o.a()&&this.bh.cY)if(this.I)return this.bE();else{n.val=!0;var r=this;this.bh.cY.a(function(n){r.I=n.a(r.bh.bk,r.o);r.bE()?r.bd():r.x(!1)})}else if(this.bj.I())if(this.bj.D()){_a.F.a(_u.R.Gg,0);this.q("SmimeSendAs",null,"User attempted to send an S/MIME message using the SendAs (From) feature");return!1}else if(t.W()){_a.F.a(_u.n.Mm,0);this.q("SmimeModernGroups",null,"User attempted to send an S/MIME message to modern groups.");return!1}else if(this.bj.p()){var e=new _j.q;var a=this;this.bj.p().n(function(n){_dg.c.isInstanceOfType(n)||_dg.i.isInstanceOfType(n)||_g.B.isInstanceOfType(n)||e.c(n.bk.Name)});if(e.d.length>0){_a.F.a(String.format(_u.n.QH,e.d.join(", ")),0);this.q("SmimeCloudAttachment",null,"User attempted to send an S/MIME message with cloud attachments.");return!1}}return!0},bE:function(){var n=this.bh.bd();try{if(this.I.a(this.bh.ba,n.a().a())){this.q("ForgottenAttachment",null,"Forgotten attachment detected, not valid to send");return!1}}catch(t){_j.e.d(_a.a.a,t,"An exception has been caught for FAD check; keep sending",this.I,this.bh.ba,n.a().a())}return!0},cy:function(n){var u=this.bh;var t=this.bj;var i=n.X;_j.e.a(_a.a.a,"Send action succeeded, ContextId={0}",i);this.cz();var r=!1;var o=_g.k.a;_bc.l.isInstanceOfType(o)&&(r=!0);t.bI()&&!r&&this.bh.cx().b(t.m());this.bh.cv()&&this.bh.cv().b(t.eQ);if(t.eS&&t.eS.length>0){var s=this.bi.a.bb;s.a(742,t.eS);_j.e.a(_a.a.a,"Showing infobar message for Bcc forking failed");this.x(!1);u.bp.d(n);this.G(_j.t.d(_bc.E,742),null,null)}else{if(i===t.b()){t.fh(null);if(this.bj.cp()){_j.e.a(_a.a.a,"skip navigating away from compose for send via notification since the navigation was already done at send time, raise send succeeded event instead");var f=this;this.bh.bT.a(function(){f.s.a(ISendSucceededEvent,new _mcp.cb(u))});this.bj.gd()}else{_j.e.a(_a.a.a,"Context match, navigating away from compose at the end of send success. ContextId={0}",i);this.bV()}}else _j.e.a(_a.a.a,"Context does not match, skipping navigating away from compose.");this.ci("MailSendSucceeded");var e=this.bQ();this.ch(e)}this.s.a(_a.V,new _a.V(_nbs.a.Cj,!1))},bV:function(){this.bh.bn().a(this.bh,!0)},cr:function(n){var u=this.bi.a;var i=u.ba;var o=n.X;_j.e.a(_a.a.a,"Send action failed, ContextId={0}",o);var t;var r;var s,f;this.dh(n.J,s={val:t},f={val:r},"SendFailure_UnknownError"),t=s.val,r=f.val;if(o===i.b()){i.eS&&i.eS.length>0&&this.O();this.x(!1);_j.e.a(_a.a.a,"Context match. Showing infobar message for ResponseCode={0}",t);this.cJ(n);var e=this.cx(n);if(this.bj.cp()){_j.e.a(_a.a.a,"Raise send failed event for send via notification");i.hf(e);var h=this;this.bh.bZ.a(function(){h.s.a(ISendFailedEvent,new _mcp.ca(u))});i.gd()}this.cm(n,e)}else _j.e.a(_a.a.a,"Context does not match. Skip showing infobar message for ResponseCode={0}",t);this.G(t,this.ck(n),r);u.bp.d(n)},cm:function(n,t){switch(t){case 92:case 100:_j.e.b(_a.a.a,"Got Wascl verdict {0}, save a draft to prevent data loss.",t);this.bh.bl().a("AutoSave",null,null,!1);break;case 90:case 98:_mco.a.isInstanceOfType(n)?_mcp.e.b=n.N.Body.AccountRecoveryFlowUrl:_mco.b.isInstanceOfType(n)&&(_mcp.e.b=n.N.Body.AccountRecoveryFlowUrl);_j.e.b(_a.a.a,"Got Wascl verdict {0}, set account recovery flow url to {1}.",t,_mcp.e.b);break;case 91:case 99:case 93:case 94:_j.e.b(_a.a.a,"Got Wascl verdict {0}.",t);break}},O:function(){var n=this.bi.a.bb;var t=this.bi.a.bc();if(this.cj()){n.b(97);n.a(97,t.Y())}else n.a(65,null)},cq:function(n){this.bM();this.ce()},ck:function(n){var t=null;_db.f.isInstanceOfType(n)&&n.Q?t=n.Q.correlationId:_mco.b.isInstanceOfType(n)&&n.Q&&(t=n.Q.correlationId);return t},cv:function(){if(this.bi.a.dp()&&this.o.b){this.v=0;this.o.a()}},cz:function(){var t=this.bh.bc();var n=this.bh.bd();_j.e.a(_a.a.a,"Check to see if we have attachments to set permissions for");n.a()&&n.a().w()&&n.a().bt(t.s())},bQ:function(){var t;if(this.bj){var u=this.bj.l()==="HTML"?"html":"text";var i;i=this.bj.a()===1||this.bj.a()===2||this.bj.a()===3?this.bj.i()?"yes":"no":"na";var n=new _a.o;n.b("BT",u);n.b("U",i);this.bj.fa!==-1&&n.a("S",this.bj.fa);n.a("O",this.bj.a());n.a("M",this.bj.k());n.a("D",this.u);_j.i.a(this.bj.fg)||n.b("P",this.bj.fg);this.bh&&this.bj.eN&&n.b("CS",this.bh.bD());t=n.toString();if(this.bh&&this.bh.bd()&&this.bh.bd().a()){var r=this.bh.bd().a().bQ();_j.i.a(r)||(t+="|"+r)}}else t=null;return t},G:function(n,t,i){var r=this.bQ();if(this.r){_j.i.a(i)||(this.r.m=i);_y.j.a(this.r,null,n,t,r);this.r=null}if(this.t){_j.i.a(i)||(this.t.m=i);_y.j.a(this.t,null,n,t,r);this.t=null}this.bK(n,t,r);this.bM()},ch:function(n){if(this.r){_y.j.a(this.r,null,null,null,n);this.r=null}this.bK(null,null,n)},bM:function(){if(this.T){_a.G.a("MailComposeSend");this.T=!1}},q:function(n,t,i){if(this.r){this.r.q="MailComposeInvalidToSend";this.r.o(new _a.ba(this.bh.bD()))}if(this.t){this.t.q="MailComposeInvalidToSend";this.t.o(new _a.ba(this.bh.bD()))}this.G(n,t,i)},ce:function(){this.bh.bc().v("Send")},bK:function(n,t,i){if(this.w){if(this.bj.cp()){_j.e.c(this.bk(),"Quick quickness should have been enabled during async send.");i+="|ErrorNoQuickQuicknessForAsyncSend"}else i+="|NoQuickQuicknessForSyncSend";_y.j.a(this.w,null,n,t,i);this.w=null}},cl:function(n,t){n?this.bd():this.q("NoSubject",null,'No subject was specified, and user chose "Don\'t Send"')},cp:function(n){_mco.a.isInstanceOfType(n)&&n.by(this.E);_mco.b.isInstanceOfType(n)&&n.bY(this.E);if(this.bi&&this.bi.a){var t=this.bi.a.ba;t&&t.bI()&&this.bh.cx().b(t.m())}}};_mcp.bQ=function(n,t){_mcp.bQ.initializeBase(this,[21,n]);this.a=t};_mcp.bQ.prototype={a:null,g:function(){if(!this.d()&&this.a.a().a().e()===2&&this.a.m().a().a()){var n=this.bi.b(5);n&&n.a()&&n.c(!1)&&n.a().bB()}_mcp.G.prototype.g.call(this)}};_mcp.q=function(n,t,i,r,u){this.p=Function.createDelegate(this,this.C);this.s=Function.createDelegate(this,this.D);this.w=Function.createDelegate(this,this.z);_mcp.q.initializeBase(this,[11,n,i,r]);this.e=new _j.g(this.w,this.bk());this.u=t;this.o=_a.l.a();this.j=_a.bk.a();this.c=u};_mcp.q.a=function(n,t){return t?n.bk.SignatureHtml:n.bk.SignatureText};_mcp.q.prototype={u:null,c:null,e:null,k:null,f:null,v:!0,r:!0,o:null,j:null,i:null,n:null,m:null,h:!1,b:function(){return this.q()?this.f:this.k},a:function(){return this.bj.fZ()&&!this.bj.dj()&&this.A()&&!this.x()?!0:!1},x:function(){return this.q()?this.v:this.r},q:function(){return this.bj.l()==="HTML"&&this.u.b()},g:function(){var n=_g.a.a().a();n.apcl("SignatureText",this.s);if(!this.d()){this.t();!this.c||this.f||this.k||this.c.apcl("CurrentStatus",this.p);_mcp.p.prototype.g.call(this)}},t:function(){var u=_g.a.a().a();var i=this.y(u,!0);if(_j.i.a(i)){_j.e.a(_a.a.a,"No html signature.");this.f=null}else{var e=String.format('<{0} id="{1}">',"DIV","Signature");var f=String.format("</{0}>","DIV");var n=_mcp.q.f+e+i.replace(_mcp.q.e," ")+f;_j.e.a(_a.a.a,"Computed html signature. OriSig={0}, FormattedSig={1}",i,n);n=this.F(n);n=this.E(n);this.f=n}var t=this.y(u,!1);if(_j.i.a(t)){_j.e.a(_a.a.a,"No plain text signature.");this.k=null}else{var r="\n"+t;_j.e.a(_a.a.a,"Computed plain text signature. OriSig={0}, FormattedSig={1}",t,r);this.k=r}this.G()},bt:function(){var n;_a.h.a(n={val:this.e}),this.e=n.val;var t=_g.a.a().a();t.rpcl("SignatureText",this.s);this.c&&this.c.rpcl("CurrentStatus",this.p);_mcp.p.prototype.bt.call(this)},bP:function(){if(!this.bh.bm()){this.i=new _fm.d(_nbs.a.CA,null,this.e);this.i.w(_nbs.a.CA);this.i.a(!this.l());return[this.i]}return null},bO:function(){this.n=_mcp.p.a(this.e,_nbs.a.CA);this.n.a(this.l());return[this.n]},bK:function(){if(!_a.g.b){this.m=new _y.h(_nbs.a.CA,this.e);this.h=!1;if(this.l()){this.h=!0;return[this.m]}}return null},bZ:function(){this.i&&this.i.a(!this.l())},bY:function(){this.n&&this.n.a(this.l())},cy:function(){var n=this.bh.dX;if(n&&this.m)if(this.h&&!this.l()){n.s(this.m);this.h=!1}else if(!this.h&&this.l()){n.x(this.m);this.h=!0}},A:function(){var t=_g.a.a().a();if("Mouse"===_y.c.a.a()){var n=this.bj.a();var i=1===n||2===n||3===n||12===n;return i?t.bk.AutoAddSignatureOnReply:t.bk.AutoAddSignature}return this.o.c()?this.j.b("MOWA.IsSignatureChanged")==="true"?this.j.b("MOWA.AutoAddSignature")==="true":!0:t.bk.AutoAddSignatureOnMobile},y:function(n,t){if("Mouse"===_y.c.a.a())return _mcp.q.a(n,t);if(this.o.c()){if(this.j.b("MOWA.IsSignatureChanged")==="true")if(this.j.b("MOWA.UseDesktopSignature")==="true")return _mcp.q.a(n,t);else{var r=this.j.b("MOWA.SignatureText")||"";return t?_a.x.b(r):r}return t?_a.x.b(_mcp.T.a(this.o)):_mcp.T.a(this.o)}if(n.bk.UseDesktopSignature)return _mcp.q.a(n,t);else{var i=n.bk.SignatureTextOnMobile||"";return t?_a.x.b(i):i}},l:function(){var n="Mouse"===_y.c.a.a()||_g.a.a().a().bk.UseDesktopSignature;return n?!this.x():!_j.i.b(_g.a.a().a().bk.SignatureTextOnMobile)},z:function(){var i=this.bi.a.ba;var r=_g.a.a().a();i.cG(!0);var t=!_j.i.a(this.b());if(t){var n=new _cmc.l(0,this.b(),this.q(),7);n.q=!0;n.n=!1;this.bh.bH().a(n)}else _j.e.a(_a.a.a,"Skip insert signature due to HasSignature={0};",t)},C:function(n,t){this.c.rpcl("CurrentStatus",this.p);if(this.c.a===2){this.t();this.br();if(this.bj.eY&&this.a()){var i=new _cmc.l(2,this.b(),this.q(),7);i.q=!0;this.bj.cC(i)}}},F:function(n){return n.replace(_mcp.q.c,'<img class="'+_mcp.q.d+'" '+"$2"+"$3")},E:function(n){var e=n.match(_mcp.q.b);if(!e)return n;for(var u=$("<div>"),o=e,s=o.length,i=0;i<s;++i){var f=o[i];u.html(f+"</a>");var r=u.find("a");r&&r.length===1&&(r[0].id="LPNoLP");var t=u.html();t=t.substr(0,t.length-4);n=n.replace(f,t)}return n},D:function(n,t){this.t();this.br()},G:function(){var n=new RegExp("^\n{1,5}$");this.r=!this.k||!this.k.search(n);this.v=!this.f||this.r&&this.f.indexOf("<img")===-1}};_mcp.bR=function(n,t){this.u=Function.createDelegate(this,this.s);this.t=Function.createDelegate(this,this.r);this.v=Function.createDelegate(this,this.F);this.w=Function.createDelegate(this,this.z);_mcp.bR.initializeBase(this,[10,n]);this.m=new _j.g(this.w,this.bk());this.q=t};_mcp.bR.prototype={q:null,m:null,l:null,o:!1,p:!1,a:function(){return this.m},h:function(){return this.l},G:function(n){if(n!==this.l){this.l=n;this.bs("CloseConfirmDialogButtonData")}return n},i:function(){return this.o},k:function(n){if(n!==this.o){this.o=n;this.bs("IsCloseConfirmDialogShown")}return n},f:function(){return this.p},I:function(n){if(n!==this.p){this.p=n;this.bs("IsAppBarSetup")}return n},b:function(){_j.e.a(_a.a.a,"Setup appbar menu. Context: {0}",this.bj);if(!this.cd){var n=new _j.q;this.n(n,11);this.n(n,1);this.n(n,28);this.n(n,6);this.n(n,3);this.n(n,9);this.bh.dX.f(n.d);this.I(!0)}},g:function(){_j.e.a(_a.a.a,"InitTouchComponent:Context:{0}",this.bj);this.bh.bu.a()==="TouchNarrow"?this.E():this.bh.dX||this.A();this.bi.b(21);_mcp.G.prototype.g.call(this)},j:function(n,t,i){if(this.bh.bK)return!1;else if(this.bh.bq().j()){this.o||this.z();return!0}else if(this.bh.ba.bl()&&!this.x()){_j.e.a(_a.a.a,"Removing unedited reply forward draft if user clicks outside the form.");this.r();return!0}else{this.bh.P(!0);return!1}},bt:function(){var t;_a.h.a(t={val:this.m}),this.m=t.val;if(this.l){this.l.f();this.l=null}var n;_a.h.a(n={val:this.l}),this.l=n.val;_mcp.G.prototype.bt.call(this)},C:function(){return _a.g.b?null:new _y.f(_y.b.be(),_y.b.bf(),_u.P.j,this.bh.bv().f())},x:function(){return this.bh.bh().c()},A:function(){var e=new _y.f(_y.b.z(),_y.b.A(),_u.P.Y,this.bh.bh().a());var o=_y.f.a(_nbs.a.EO,this.m);var u=this.C();var r=this.D();var i=2;i+=u?1:0;i+=r?1:0;var n=new Array(i);var t=0;n[t++]=e;u&&(n[t++]=u);n[t++]=o;r&&(n[t++]=r);_j.e.a(_a.a.a,"Creating appbar. ContextId={0}",this.bj.b());var f=_y.k.a(this.bh,n,null);f.M("TouchNarrow"===_y.c.a.a());this.bh.fj(f)},E:function(){var t=this.q;if(t){var n=t.b();if(_a.l.a().b()){n.c(2);n.d(_nbs.a.ZV);n.a(t.a(_fm.a.b,_fm.a.b,this.m,_u.R.Mn));n.b(t.a(_fm.a.b,_fm.a.b,this.bh.bh().a(),_u.n.Rk));n.g().a(!0)}else{n.c(1);n.d(_nbs.a.Qd);n.a(t.a(_y.b.a(),_y.b.a(),this.m,""));n.i(t.a(_fm.a.h,_fm.a.h,null,""));n.h(this.bh.bC().a());var i=this.bh.bd().m();if(i&&i.d.length>0){if(i.d.length>1){n.b(t.a(_y.b.B(),_y.b.B(),null,""));n.l(new _fm.f(i.d))}else{var r=i.d[0].m;n.b(t.a(_y.b.B(),_y.b.B(),r,""))}n.f(t.a(_y.b.p(),_y.b.p(),this.bh.bh().a(),""))}else n.b(t.a(_y.b.p(),_y.b.p(),this.bh.bh().a(),""))}this.bh.fl(n)}},z:function(){_j.e.a(_a.a.a,"User hit close, decide whether to show the confirm dialog. Context:{0}",this.bj);if(this.x()){_j.e.a(_a.a.a,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if(this.bh.bq().j()){this.J();_j.e.a(_a.a.a,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.k(!0)}else if(this.bj.bl()){_j.e.a(_a.a.a,"Removing unedited reply forward draft on close.");this.r()}else{_j.e.a(_a.a.a,"Navigate away due to unmodified message.");this.y()}},s:function(){_j.e.a(_a.a.a,"Hide close confirm dialog");this.k(!1)},J:function(){if(!this.l){_j.e.a(_a.a.a,"Create close confirm dialog.");var n=new _j.l;_a.g.b||n.a(new _ff.d(new _j.g(this.v,this.bk()),_u.P.f,_nbs.a.qB,!0));n.a(new _ff.d(new _j.g(this.t,this.bk()),_u.n.Kv,_u.n.LT,_a.g.b));n.a(new _ff.d(new _j.g(this.u,this.bk()),_bcs.D.A,_u.n.LJ));this.G(n)}},F:function(){_j.e.a(_a.a.a,"User select save and close");this.s();this.bh.bl().j().a()},r:function(){_j.e.a(_a.a.a,"User select discard and close");this.s();this.bh.bq().k();this.y()},y:function(){this.bh.bn().a(this.bh,!1)},D:function(){if(this.bj.W())return null;var n=new _j.q;var o=this.bh.bd();var t=o.t();if(t&&t.length>0)for(var r=t,e=r.length,i=0;i<e;++i){var u=r[i];n.c(u)}if(n.d.length===1){var f=n.d[0];return new _y.f(_y.b.O(),_y.b.P(),_u.P.R,f.a())}else return new _y.f(_y.b.O(),_y.b.P(),_u.P.R,null,n.d)},n:function(n,t){var r=null;var i=this.bi.b(t);if(i&&IMailComposeContextMenuProvider.isInstanceOfType(i)){_j.e.a(_a.a.a,"Getting app-bar items for type '{0}', IsInitialized = {1}",Object.getType(i).getName(),i.d());i.d()||i.g();r=i;n.h(r.O())}}};_mcp.O=function(n,t,i){this.K=Function.createDelegate(this,this.V);this.I=Function.createDelegate(this,this.P);this.E=Function.createDelegate(this,this.L);this.J=Function.createDelegate(this,this.T);this.F=Function.createDelegate(this,this.Q);this.s=Function.createDelegate(this,this.M);this.G=Function.createDelegate(this,this.y);_mcp.O.initializeBase(this,[12,n]);this.t=this.bi.a.bP;this.n=t;this.O=i};_mcp.O.a=function(n){if(n&&!n.eK){n.bb.b(3440);n.bb.a(3440,null);n.bf()}};_mcp.O.prototype={t:null,n:null,O:null,x:null,m:null,o:null,C:null,A:null,D:null,q:null,l:null,a:function(){this.q||(this.q=new _j.g(this.G,_a.a.a));return this.q},f:function(){return this.j()&&!this.bj.bk()},c:function(){var n=this.bj;return this.j()&&n.bk()&&!this.l&&!n.J()},j:function(){return this.i()&&this.bh.bm()&&!this.bj.I()},i:function(){var n=this.bj.a();return n===1||n===2||n===3},b:function(){return this.f()||this.c()},p:null,e:function(){return this.p},k:function(n){this.p=n;return n},g:function(){if(this.j()){var n=this.bh.ba;if(n.bk()&&n.J()){_j.e.a(_a.a.be,"initializing upgrade component, user requested upgrade and upgrade failed, show the failure message");this.z();this.bh.bf()}}_mcp.G.prototype.g.call(this)},h:function(){_a.G.b(_a.a.a,"MailComposeUpgrade",3);this.m=_y.j.b(_a.a.a,"MailComposeUpgrade",!0);this.p=_y.j.b(_a.a.a,"MailComposeQuoteBody",!0);var r=this.bi.a;var n=r.ba;var u=n.b();this.x=u;if(!n.i()){if(!this.j()){var e=this;_j.n.a().a(_a.a.a,"ShowUpgradeMessage",function(){n.i()||n.J()||u!==e.x||_mcp.O.a(r)},5e3)}var t;t=this.n.b()||n.l()!=="HTML"?n.l()==="Text"?_h.b.q():_h.b.e():_h.b.K();if(t===_h.b.e()||t===_h.b.K()){t.BlockExternalImages=n.e().bk.HasBlockedImages;t.FilterHtmlContent=n.e().bk.HasBlockedImages}var i=r.bO.d(n,t);n.a()===12&&i.q(new _g.E(new _g.r("internalsubmission")));i.j(this.s);_j.e.a(_a.a.be,"Begin upgrade, OriParentFolderId={0}",n.e()&&n.e().bk.ParentFolderId&&_g.b.a?_g.b.a.idToName(n.e().bk.ParentFolderId):"null");i.l("MailComposeUpgrade");if(n.bp()){var f=new _mcp.C(i);r.bp.a(f,this.F,this.J,null)}else r.bp.a(i,this.E,this.I,null)}},bt:function(){var n;_a.h.a(n={val:this.q}),this.q=n.val;_mcp.G.prototype.bt.call(this)},Q:function(n){var t=n;this.L(t.c)},T:function(n){var i=n;var t=i.c;t.t(this.s);this.P(t)},L:function(n){if(this.bo()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.CheckSystemUpgrade: viewModel is null or disposing, aborting logic.");return}var f=this.bh;var e=f.ba;var t=n;var h=f.bq();var r=t.F;var i=n.h();var s=t.Q?t.Q.correlationId:null;var c=!!t.bl;if(this.t.a(i)){_j.e.a(_a.a.be,"Check upgrade callback, resume discard for context {0}",i);h.e(i,r)}else if(i===e.b()){e.L(r);_j.e.a(_a.a.be,"Context match, updated the draft id. ResponseMessageBodyType={0}",c&&t.bl.I()?t.bl.I().a():"null");var u=f.bl();var o=f.bh();if(!u.c()&&o.c()){_j.e.a(_a.a.be,"Skipping upgrade for contextId {0} since send was triggered during upgrade",i);this.r("SkipUpgrade",s,"Skip upgrade since send is in progress");o.e();return}if(u.c()&&u.h()){_j.e.a(_a.a.be,"Skipping upgrade for contextId {0} since save and then send was triggered during upgrade",i);this.r("SkipUpgrade",s,"SkipUpgrade since saving is in progress");u.i();return}}if(t.bl){_j.e.a(_a.a.be,"Check upgrade, action has response message, call complete upgrade. ActionItemId={0}",_h.Z.a(r));this.M(n)}else if(n.h()===e.b()){_j.e.a(_a.a.be,"Check upgrade: action has id only, updated draft id. ActionItemId={0}",_h.Z.a(r));this.w(!0)}},R:function(n){n.dx()&&this.bi.a.bb.a(3050)},M:function(n){if(this.bo()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.CompleteSystemUpgrade: viewModel is null or disposing, aborting logic.");return}var r=this.bh;var t=r.ba;var i=n;var o=i.Q?i.Q.correlationId:null;var f=n.h();i.t(this.s);if(f===t.b()){t.dI(i.bl);t.fl=i.bl.cd();this.l=i.bl;t.hk(i.bl.bM());try{if(this.j())if(t.bk()){_j.e.a(_a.a.be,"upgrade returned success, user already requested for upgrade, merge body and remove spinner");this.v();this.bv("IsWaitingForQuotedBody","IsOnDemandUpgradePending");r.bf()}else{t.cJ(!0);this.w(!1)}else this.v();i.bl.S()&&t.U(i.bl.S().e);var e=r.bd();e.z()}finally{t.i()&&r.bb.b(3440);_j.e.a(_a.a.be,"IsUpgraded for context is {0}",t.i())}this.R(t);r.bf();_j.e.a(_a.a.be,"Complete upgrade.");var u=r.bl();u.c()?u.i():_a.bq.a&&_j.n.a().c(_a.a.a,"SafeTriggerPolicyTipsIfNeededForOpenDraft",this.K);r.bg.a(_db.bD,new _mcp.bX(t.P().bk.ItemId.Id,r))}else _j.e.a(_a.a.be,"MailComposeUpgrade failed since user switched view model context. ContextId={0}; Context{1}=",f,t)},y:function(){this.o=_y.j.b(_a.a.a,"MailComposeOnDemandUpgrade",!0);var n=this.bi.a.ba;n.dV(!0);if(this.l||n.P()&&n.i()){this.l||(this.l=n.P());_j.e.a(_a.a.be,"user requests for quoted body, upgrade was successful, complete the body merge");this.v();this.bv("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending")}else if(n.J()){_j.e.a(_a.a.be,"user requests for quoted body, upgrade failed, show error message");this.bv("ShouldShowQuoteBodyButton","IsOnDemandUpgradePending");this.z();this.bh.bf();this.N()}else{_j.e.a(_a.a.be,"user requests for quoted body, upgrade has yet to come back, show spinner");this.bv("ShouldShowQuoteBodyButton","IsWaitingForQuotedBody")}},v:function(){var n=this.bi.a.ba;var e=!1;if(this.n.b()){if(n.eJ()){n.eP.a();n.C()===n.eJ().a()&&(e=!0)}else n.fn=!0;n.fm=!0}if(this.bh.bm()&&this.j()&&this.l.I()&&n.l()!==this.l.I().a()&&this.n.b()){var f=this.l.I().bk.Value;if(n.l()==="HTML")n.ff(_a.x.b(f));else{var i;var o,r;r=_a.x.a(f,o={val:i}),i=o.val,r;n.ff(i);var h=this;n.fc=function(n){n.bd().y(!1)}}}else if(this.n.b()||n.l()!=="HTML"){var u=this.l.I().bk.Value;n.ff(!this.n.b()&&n.l()==="Text"?_a.x.F(u):u)}else n.ff(this.l.bL().bk.Value);if(_y.c.a.a()==="Mouse"||this.n.b()){this.bj.gN();var t=new _cmc.l(2,n.dp(),n.l()==="HTML",7);t.r=!1;t.x=!0;var c=this;t.y=function(){n.cJ(!0)};this.bh.bH().a(t)}else n.cJ(!0);if(e){n.eP.a();n.eJ().r(n.C());var s=n.eL;s&&n.eL.r(n.C())}this.w(!0)},P:function(n){var r=n;var u=r.Q?r.Q.correlationId:null;r.t(this.s);if(this.bo()){_j.e.a(_a.a.a,"MailComposeUpgradeComponent.OnUpgradeFailure: viewModel is null or disposing, aborting logic.");this.r("SkipUpgrade",u,"Skip upgrade since view mode is disposed");return}var s=this.bi;var i=s.a;var f=i.ba;var h=i.bq();f.eo(!0);var t=n.h();if(this.t.a(t)){_j.e.a(_a.a.be,"Resume discard for context {0}",t);h.e(t,r.F)}else if(t===f.b()){_j.e.a(_a.a.be,"Recording on context upgrade failed");var e=i.bl();var o=i.bh();if(e.c()){if(e.h()){_j.e.a(_a.a.be,"Skipping upgrade for context {0} since save and then send was triggered during upgrade",t);this.r("SkipUpgrade",u,"Skip upgrade since saving is in progress");e.i();return}_mcp.O.a(i)}else if(o.c()){_j.e.a(_a.a.be,"Skipping upgrade for context {0} since send was triggered during upgrade",t);this.r("SkipUpgrade",u,"Skip upgrade since send is in progress");o.e();return}else _mcp.O.a(i);if(this.j()&&f.bk()){_j.e.a(_a.a.be,"upgrade failed and user requested for upgrade, show the failure and trigger property changes to hide the spinner");this.bv("IsWaitingForQuotedBody","IsOnDemandUpgradePending");this.z();this.bh.bf()}}n.g()&&this.U(n.g(),t,u,f)},U:function(n,t,i,r){var f;var u;var o,e;this.dh(n,o={val:f},e={val:u},"UpgradeFailure_UnknownError"),f=o.val,u=e.val;_j.e.b(_a.a.be,"Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r,u);this.r(f,i,u)},z:function(){var n=this.bi.a.bb;n.b(3450);n.a(3450,null)},r:function(n,t,i){this.C=n;this.A=t;this.D=i;if(this.m){_y.j.a(this.m,null,n,t,i);this.m=null;_a.G.a("MailComposeUpgrade")}if(this.p){_y.j.a(this.p,null,n,t,i);this.p=null}this.N()},w:function(n){if(this.m){n&&this.m.o(new _a.ba("UIUpdated"));_y.j.a(this.m);this.m=null;_a.G.a("MailComposeUpgrade")}this.S()},S:function(){if(this.o){_y.j.a(this.o);this.o=null}},N:function(){if(this.o){_y.j.a(this.o,null,this.C,this.A,this.D);this.o=null}},V:function(){_mcp.G.a(this.bh,32)}};_mcp.bJ=function(n,t){this.h=Function.createDelegate(this,this.j);_mcp.bJ.initializeBase(this,[17,n]);if(_a.cA.a){var i=this;t.a(function(n){if(i.bo()){_j.e.a(_a.a.a,"MailComposeMailTipsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var u=i.bh;var r=u.bc();var t=u.bb;if(r&&t){i.c=n.a(r,t);i.bj.V()&&i.c.f(i.bj.V().EmailAddress);if(i.e){i.i();i.e=!1}if(i.f){i.c.a();i.f=!1}}})}};_mcp.bJ.prototype={c:null,e:!1,f:!1,g:function(){if(!_a.cA.a){_mcp.G.prototype.g.call(this);return}this.c?this.i():this.e=!0;_mcp.G.prototype.g.call(this)},a:function(n){if(_a.cA.a||!this.cd){if(n===32){var r=this.bi;var i=r.a;var t=i.ba;if(t.di()){i.bb.b(4400);i.bb.a(4400);this.bh.bf()}if(!t.a()&&(!t.f()||!t.f().b())&&(!t.j()||!t.j().b())&&(!t.c()||!t.c().b())||t.a()===3||t.a()===11)return}this.d()||this.g();this.k()}},b:function(){if(_a.cA.a){this.d()||this.g();if(this.c){_j.e.a(_a.a.a,"Remove MailTips for deleted recipients");this.c.e()}else _j.e.a(_a.a.a,"MailTips for deleted recipients was called when MailTipsHandler hasn't been created, no operation needed")}},bt:function(){if(this.c){this.c.c(null);this.c=null}_mcp.G.prototype.bt.call(this)},i:function(){this.c.b();this.c.c(this.h)},k:function(){if(_a.cA.a)if(this.c){_j.e.a(_a.a.a,"Prepares to submit mailtips action");this.c.a()}else{_j.e.a(_a.a.a,"Remember to submit MailTips action once the MailTipsHandler is created");this.f=!0}},j:function(){if(_a.cA.a){this.bh.du(this.c.d());this.bh.bf()}}};_mcp.bN=function(n,t){this.h=Function.createDelegate(this,this.i);_mcp.bN.initializeBase(this,[29,n]);if(t){var i=this;t.a(function(n){if(i.bo()){_j.e.a(_a.a.a,"MailComposePeopleRecommendationsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var t=i.bh;i.c=n.a(i.bh.bc(),i.bh.bb);i.c.c(i.h);if(i.e){i.c.b();i.e=!1}if(i.f){i.c.a();i.f=!1}})}};_mcp.bN.prototype={c:null,e:!1,f:!1,g:function(){this.c?this.c.b():this.e=!0;_mcp.G.prototype.g.call(this)},b:function(n){this.d()||this.g();this.j()},a:function(){this.c&&this.c.e(!0)},bt:function(){if(this.c){this.c.c(null);this.c=null}_mcp.G.prototype.bt.call(this)},j:function(){if(this.c){_j.e.a(_a.a.a,"Prepares to submit PeopleRecommendations action");this.c.a()}else{_j.e.a(_a.a.a,"Remember to submit PeopleRecommendations action once the PeopleRecommendationsHandler is created");this.f=!0}},i:function(){this.bh.bf()}};_mcp.bP=function(n,t){this.p=Function.createDelegate(this,this.w);this.o=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.u);this.m=Function.createDelegate(this,this.t);this.l=Function.createDelegate(this,this.s);_mcp.bP.initializeBase(this,[23,n]);if(_a.bq.a){var i=this;t.a(function(n){if(i.bo()){_j.e.a(_a.a.a,"MailComposePolicyTipsComponent.ctor: viewModel is null or disposing, aborting logic.");return}var t=i.bh;var f=t.bc();var u=t.bd();var r=t.bb;if(f&&u&&r){i.f=n.a(f,u,r);i.f.h(i.l);i.f.d(i.m);i.f.c(i.n);i.f.e(i.o);i.f.f(i.p);if(i.i){i.f.b();i.i=!1}if(i.j){i.a(i.k);i.j=!1}}})}};_mcp.bP.prototype={h:null,f:null,i:!1,j:!1,k:0,g:function(){if(!_a.bq.a){_mcp.G.prototype.g.call(this);return}this.f?this.f.b():this.i=!0;_mcp.G.prototype.g.call(this)},bt:function(){this.h&&(this.h=_j.n.a().b(this.h));if(this.f){this.f.h(null);this.f.d(null);this.f.c(null);this.f.e(null);this.f.f(null);this.f=null}_mcp.G.prototype.bt.call(this)},c:function(){if(!_a.bq.a)return!1;switch(this.q()){case 1:return!1;case 2:case 3:return this.bi.a.ba.cn()===null&&this.bi.a.ba.cm()===null;case 4:case 5:return this.bi.a.ba.cm()===null;default:return!1}},b:function(){if(!_a.bq.a)return"";switch(this.q()){case 2:case 3:return _u.P.Q;case 4:case 5:return _u.P.F;default:return""}},e:function(){if(_a.bq.a){if(!this.f){_j.e.a(_a.a.F,"skip setting message sent flag since handler hasn't been created yet.");return}this.f.i(!0);if(this.bi.a.ba.cn()){var n=new _cmc.g(_a.a.F,"DlpPolicyTipOverridden",!1);n.b()}}},a:function(n){this.r(n,0)},x:function(n,t,i){_j.e.a(_a.a.a,"Prepares to submit policyTips action");var u;var r;if(n.eJ()){u=_a.I.b(n.eJ().f());r=_a.I.b(n.eJ().a())}else{u=_a.I.b(n.G());r=_a.I.b(n.C())}this.f.g(i,n.p(),u,r,t)},r:function(n,t){if(_a.bq.a&&!this.cd){if(!this.f){_j.e.a(_a.a.F,"Remember to resume triggering policy tips once the handler is created");this.k=n;this.j=!0;return}var f=this.bi;var e=f.a;var r=e.ba;this.d()||this.g();this.h&&(this.h=_j.n.a().b(this.h));var i=r.h();if(i){_bc.f.a(i)&&!_g.k.b&&(i=_g.k.a.q(i));if(_bc.f.a(i)){if(t<4){var u=this;this.h=_j.n.a().a(_a.a.F,"TriggerPolicyTipsIfNeeded",function(){u.r(n,t+1)},5e3)}}else this.x(r,n,i)}}},q:function(){this.d()||this.g();return this.f?this.f.a():0},s:function(){this.bh.bf()},t:function(n){var r=this.bi;var i=r.a;var t=i.ba;t.dH(n)},u:function(n){var r=this.bi;var i=r.a;var t=i.ba;t.dG(n)},v:function(){this.a(64)},w:function(n){var r=this.bi;var i=r.a;var t=i.ba;t.dF(n)}};_mcp.J=function(n,t){this.J=Function.createDelegate(this,this.br);this.S=Function.createDelegate(this,this.by);this.U=Function.createDelegate(this,this.bg);this.V=Function.createDelegate(this,this.bm);this.T=Function.createDelegate(this,this.bz);this.O=Function.createDelegate(this,this.be);this.Q=Function.createDelegate(this,this.bu);this.R=Function.createDelegate(this,this.bx);this.N=Function.createDelegate(this,this.bp);this.P=Function.createDelegate(this,this.bq);this.Z=Function.createDelegate(this,this.bn);this.ba=Function.createDelegate(this,this.bC);_mcp.J.initializeBase(this,[22,n]);this.I=!1;this.X=t;this.G=new _j.g(this.ba,_a.a.h);this.G.c(!1)};_mcp.J.a=function(n){switch(n){case 0:return 0;case 1:return 1;case 2:return 2;default:throw Error.argument();}};_mcp.J.prototype={K:null,L:0,I:!1,Y:!1,F:null,X:null,W:null,G:null,a:function(){return this.F},bA:function(n){if(this.F!==n){this.F=n;this.bv("ExtensibilityViewModel","ShouldShowAppsButton")}return n},f:function(){return this.G},k:function(){return!!this.F&&this.F.d()&&this.G.b&&(!this.F.w()||this.bh.bs())},j:function(){return this.F?this.F.b():!0},bB:function(n){if(n!==this.Y){this.Y=n;this.bs("RequestCloseComposeForm")}return n},g:function(){if(!_a.g.b&&!this.d()){var n=this;this.X.a(function(t){if(!n.F){if(n.bo()){_j.e.a(_a.a.a,"MailComposeExtensibilityComponent.Initialize: viewModel is null or disposing, aborting logic.");return}var r=n.bh;n.W=t;n.bA(t.d(n,n.Z));var i=r.cu();n.F.q(i.a());n.F.A(r.bs());var u=r.bg;u.b(_a.dk,n.P);n.F.f();i.apcl(i.b(),n.N);n.F.h(n.R);n.F.g(n.Q);n.F.a().j(n.O);n.be(null,null);n.F.apcl("ShowAppsButton",n.T);_mcp.G.prototype.g.call(n);if(n.bj.fy()&&n.bj.fy().length>0){n.bb(n.bj.fy());n.bj.cz(null)}n.bj.gx(n.V);n.bj.gw(n.U);n.bg(null)}})}},bg:function(n){this.bj.P()&&this.bj.P().bQ.n(this.S)},bm:function(n){this.bj.P()&&this.bj.P().bQ.p(this.S)},by:function(n,t){if(this.bh&&this.bh.dc){var i=this;this.bh.dc.a(function(n){i.bj&&i.bh&&n.a(i.bj.P(),i.bh.bb)})}},bb:function(n){if(!this.K){var s;var r=null;var o;if(this.bi.a.ba.i()){o=this.bi.b(5);r=o.a()}else _j.e.a(_a.a.h,"Attachment not added - well not upgraded.");if(!r&&this.L<10){var i=this;this.K=_j.n.a().a(this.bk(),"MailComposeExtensibilityComponent - add attachments from context on delay",function(){if(!i.cd){i.L++;i.K=null;i.bb(n)}},100*this.L)}else for(var t=0;t<n.length;t++)if(n[t][0]==="file"){var h=!1;_j.i.a(n[t][3])||(h=Boolean.parse(n[t][3]));this.bc(r,n[t][2],n[t][1],!0,h)}else if(n[t][0]==="item"){var u=new _g.B;u.q(new _g.g(n[t][2]));u.e(n[t][1]);var e,f;f=this.bd(r,u,e={val:s},!0),s=e.val,f}}},bf:function(){this.bs("ShouldShowAppsButton");if(this.bh.cw()){var n=this.bi.b(27);n.F(this.k())}},bz:function(n,t){this.bf()},bc:function(n,t,i,r,u){var e=this.W.b(t,i);var f=n.Y(e,u,u?i:null);f.C(r);return f},bd:function(n,t,i,r){i.val=0;var f=_y.F.b(t);var e=_a.d.b(_a.a.c,"AttachmentExtensibilityItemAttachments");var u=new _j.q;n.G(f,u,e);if(!u.d.length){_j.e.a(_a.a.h,"Attachment not added - max number exceeded.");i.val=9001;return null}u.d[0].C(r);return u.d[0]},c:function(){return _y.c.a.a()==="Mouse"?this.bi.a.ba.l():this.bi.a.ba.dq()?"HTML":"Text"},u:function(){return this.bi.a.ba.s()},z:function(n){this.bi.a.ba.z(n)},t:function(n,t,i){i.val=0;var r=new _cmc.u(n);this.bi.a.ba.cM(r);r.d&&(i.val=9016);t.val=r.e;return r.a},y:function(n,t,i){i.val=0;var r=new _cmc.B(n,!0,t,12);this.bi.a.ba.cM(r);r.u?i.val=2006:r.v&&(i.val=9016)},q:function(){this.bB(!0);this.bs("RequestCloseComposeForm")},s:function(n){return this.bh.bc().G(_mcp.J.a(n))},C:function(n,t){return this.bl(n,t,!1)},x:function(n,t){this.bl(n,t,!0)},o:function(n,t,i){t.val=0;if(!this.bi.a.ba.i()){_j.e.a(_a.a.h,"Attachment not added - well not upgraded.");t.val=9005;return null}var r=this.bi.b(5);if(r.a())return this.bd(r.a(),n,t,i);else{_j.e.a(_a.a.h,"ComposeFormNotReadyForAttachments in mail module");t.val=9015;return null}},n:function(n,t,i,r){i.val=0;if(!this.bi.a.ba.i()){_j.e.a(_a.a.h,"Attachment not added - well not upgraded.");i.val=9005;return null}var f=this.bi.b(5);var u=f.a();if(u)return this.bc(u,n,t,!1,r);_j.e.c(_a.a.h,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},D:function(){return this.bi.a.ba.bh()?this.bi.a.ba.bh().Id:null},l:function(n,t){var i=new _cmc.l(0,n,t,12);i.n=!0;i.o=!0;this.M(i)},m:function(n,t){var i=new _cmc.l(1,n,t,12);this.M(i)},i:function(n,t){var r=this,i=this;this.bi.a.bl().b(function(t){n()},function(n){_j.e.a(_a.a.h,"SaveActionFailed: Error: {0}",n.J.message);t()})},r:function(n){var t=new _cmc.ba(n);this.bi.a.ba.cC(t);return t.a},w:function(n,t,i){i.val=0;var r=new _cmc.bp(n,t,12);this.bi.a.ba.cC(r);r.c&&(i.val=2006)},h:function(){return this.bj.P()},bC:function(){this.F&&this.F.C()},be:function(n,t){this.G.c(this.F.a().b);this.bf()},bx:function(){if(_y.c.a.a()==="TouchWide"&&this.F.l()){var n=this.bi.a;n.eL(6)}},bu:function(){var n=this.bi.a;n.eL(4)},M:function(n){this.bh.bH().a(n)},b:function(){return this.bi.a.ba.h()?this.bi.a.ba.h().Id:null},e:function(){this.bi.a.ba.Q()||this.bi.a.ba.dL(new _j.l);return this.bi.a.ba.Q()},v:function(){},A:function(){var n=new _cmc.z(null);this.M(n)},p:function(n){var t=new _cmc.z(n);this.M(t)},bt:function(){var t=this.bi.a.cu();t.rpcl(t.b(),this.N);this.bh.bg.c(_a.dk,this.P);if(this.F){this.F.o(this.R);this.F.n(this.Q);this.F.a().i(this.O);this.F.rpcl("ShowAppsButton",this.T);this.F.k();this.F=null}if(this.G){this.G.c(!1);this.G.i(this.J);var n;_a.h.a(n={val:this.G}),this.G=n.val}if(this.bj){this.bm(null);this.bj.gY(this.V);this.bj.gX(this.U)}_mcp.G.prototype.bt.call(this)},bl:function(n,t,i){i&&this.bh.bc().bd(_mcp.J.a(n));var e=this.bh.bc().G(_mcp.J.a(n));var u=t.d.length;if(u+e.x.length>500)return!1;n===2&&this.bi.a.bc().C().a();for(var r=0;r<u;r++){var f=t.d[r];this.bh.bc().U(f,_mcp.J.a(n))}return!0},bq:function(n){if(this.I){this.I=!1;this.F.e(!1)}},E:function(){this.k()?this.G.a():this.G.j(this.J)},bn:function(n){if(n===1){var r=window.document.body.clientWidth;if(r<1367){var i=this.bi.a.bg;i.a(_a.dE,new _a.dE(!0));this.I=!0}}else if(n===2&&this.I){var t=this.bi.a.bg;t.a(_a.dE,new _a.dE(!1));this.I=!1}this.bh.bf()},bp:function(n,t){var i=this.bi.a.cu();t===i.b()&&this.bD(i)},bD:function(n){this.F.q(n.a());n.a()&&this.F.e(!1)},br:function(n,t){if(this.G.b){this.G.i(this.J);this.G.a()}}};_mcp.bG=function(n,t){this.j=Function.createDelegate(this,this.n);this.h=Function.createDelegate(this,this.l);this.i=Function.createDelegate(this,this.m);_mcp.bG.initializeBase(this,[30,n]);this.f=t};_mcp.bG.prototype={f:null,e:null,c:function(n){this.e=n;this.e.b(this.i);this.e.a(this.h);this.e.c(this.j)},b:function(n){if(this.f){var t=this;this.f.a(function(i){t.k(i,n)})}},a:function(n){var t=this.bj;if(t){var i=t.ct();i[n.b()]=n.a()}},bt:function(){this.o();_mcp.G.prototype.bt.call(this)},o:function(){if(this.e){this.e.e(this.i);this.e.d(this.h);this.e.f(this.j);this.e=null}},k:function(n,t){for(var r=Object.keys(t),f=r.length,u=new Array(f),i=0;i<f;i++)u[i]=t[r[i]];n.b(u)},n:function(n){var t=n.c();_cmc.E.b(t,this.bj.eQ)},m:function(n){var t=n.c();var i=_cmc.E.d(t);_cmc.E.e(i,this.bj.eQ);_cmc.E.c(t,this.bj.eQ)},l:function(n){var t=n.c();_cmc.E.b(t,this.bj.eQ)}};_mcp.bS=function(n){_mcp.bS.initializeBase(this,[22,n])};_mcp.bS.prototype={k:function(){return!1},f:function(){return null},j:function(){return!0},a:function(){return null},E:function(){}};_mcp.bz=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et){_a.b.b(e,"nativeBridge");this.a=n;this.b=i;this.c=r;this.y=u;this.t=t;this.h=f;this.e=e;this.f=o;this.n=s;this.p=h;this.q=c;this.s=l;this.A=a;this.l=v;this.g=y;this.m=p;this.x=w;this.k=b;this.o=k;this.i=d;this.C=g;this.d=nt;this.z=tt;this.B=it;this.j=rt;this.r=ut;this.u=ft;this.w=et};_mcp.bz.prototype={a:null,j:null,b:null,c:null,y:null,t:null,h:null,e:null,f:null,n:null,p:null,q:null,A:null,l:null,g:null,m:null,x:null,C:null,k:null,d:null,r:null,u:null,w:null,s:null,z:null,B:null,o:null,i:null,v:function(n,t,i){switch(n){case 0:return new _mcp.bI(this.a,this.c,this.l,!!this.f);case 1:return new _mcp.f(this.a,this.b,this.d);case 2:return new _mcp.r(this.a,this.c,this.b,this.d);case 3:return new _mcp.D(this.a,this.c,this.b,this.d);case 4:return new _mcp.h(this.a,this.m,this.g);case 5:return new _mcp.n(this.a,this.t,this.b,this.c,this.y,this.a.a.di,this.s);case 6:return new _mcp.bH(this.a,this.c,this.b,this.d);case 7:return this.b&&this.b.a().bM().Enabled?new _mcp.I(this.a,this.c,this.b,this.d,this.a.a.bg):new _mcp.u(this.a,this.c,this.b,this.d,this.a.a.bg);case 8:return new _mcp.W(this.a,this.h,this.c,this.b,this.d);case 9:return new _mcp.bK(this.a,this.f,this.b,this.d);case 10:if("Mouse"!==t)return new _mcp.bR(this.a,this.j);break;case 11:return new _mcp.q(this.a,this.c,this.b,this.d,this.B);case 12:return new _mcp.O(this.a,this.c,this.b);case 13:if(this.e.b(this.e.f())&&this.e.f().a().f())return new _mcp.bO(this.a,this.e);break;case 20:if(this.e.b(this.e.f())&&this.e.f().a().a())return new _mcp.bM(this.a,this.e);break;case 14:return new _mcp.X(this.a,this.g);case 15:if("Mouse"===t)return new _mcp.bB(this.a,this.f,this.b,this.d);break;case 16:if("Mouse"===t)return new _mcp.H(this.a);else if("TouchNarrow"===t)return new _mcp.bC(this.a);break;case 18:return new _mcp.t(this.a,this.d);case 17:return new _mcp.bJ(this.a,this.n);case 29:return new _mcp.bN(this.a,this.p);case 23:return new _mcp.bP(this.a,this.q);case 19:return new _mcp.w(this.a);case 21:if(this.e.b(this.e.m()))return new _mcp.bQ(this.a,this.e);break;case 22:return i===3?new _mcp.bS(this.a):new _mcp.J(this.a,this.a.a.dm);case 24:if(this.c.b())return new _mcp.x(this.a,this.b,this.c,this.A);break;case 30:if(this.c.b()&&this.c.e())return new _mcp.bG(this.a,this.k);break;case 25:return t!=="Mouse"?new _mcp.bE(this.a):new _mcp.bD(this.a,this.f,this.b,this.w);case 27:if(t==="Mouse")return new _mcp.z(this.a,this.z,this.d,this.x);break;case 28:return new _mcp.bL(this.a,this.f,this.b,this.d);case 31:return new _mcp.s(this.a);case 32:if(this.c.c())return new _mcp.by(this.a,this.c,this.a.a.bg,this.r);break;case 34:if(this.b&&this.b.a()&&this.b.a().ef().Enabled)return new _mcp.bF(this.a,this.o,this.i);break;case 35:if(this.c.a().bD().Enabled)return new _mcp.g(this.a,this.c,this.i,this.u);break}return null}};_mcp.Y=function(n,t){this.c=n;this.d=t};_mcp.Y.prototype={c:!1,d:!1,a:function(){return this.c},b:function(){return this.d}};_mcp.bh=function(){};_mcp.bT=function(){};_mcp.bT.prototype={a:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.a.gL;break;case"Personal":i=_nbs.a.VF;break;case"Private":i=_nbs.a.VP;break;case"Confidential":i=_nbs.a.w;break;default:i=_nbs.a.gL;break}return i},b:function(n,t){throw Error.notImplemented();}};_mcp.k=function(n){_mcp.k.initializeBase(this,[n])};_mcp.k.prototype={a:null,l:function(){},k:function(){},o:function(n){},m:function(n){},n:function(n){},q:function(n){},p:function(n,t){t.val=3;this.a.a();return!0}};_mcp.d=function(){};_mcp.d.R=function(){return _fm.b.a(_fm.a.B,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.d.S=function(){return _fm.b.a(_fm.a.B,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.d.T=function(){return _fm.b.a(_fm.a.B,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.d.P=function(){return _fm.b.a(_fm.a.bL,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.d.A=function(){return _fm.b.a(_fm.a.bL,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.d.F=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.d.o=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.d.B=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.b,"ms-fcl-tp-b")};_mcp.d.C=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.b,"ms-fcl-nt-b")};_mcp.d.l=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_mcp.d.m=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.f,"ms-fcl-nd-b")};_mcp.d.n=function(){return _fm.b.a(_fm.a.t,_fm.WebfontSizes.a.e,"ms-fcl-ns-b")};_mcp.d.G=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.d.y=function(){return _fm.b.a(_fm.a.D,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.d.O=function(){return _fm.b.a(_fm.a.D,_fm.WebfontSizes.a.e,"ms-fcl-tp-b")};_mcp.d.z=function(){return _fm.b.a(_fm.a.D,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.d.H=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.a,"ms-fcl-tp-b")};_mcp.d.I=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.q,"ms-fcl-nsa-b")};_mcp.d.K=function(){return _fm.b.a(_fm.a.C,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.d.M=function(){return _fm.b.a(_fm.a.C,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.d.b=function(){return _fm.b.a(_fm.a.A,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.d.h=function(){return _fm.b.a(_fm.a.A,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.d.L=function(){return _fm.b.a(_fm.a.C,_fm.WebfontSizes.a.g,"ms-fcl-nta-b")};_mcp.d.N=function(){return _fm.b.a(_fm.a.C,_fm.WebfontSizes.a.g,"ms-fcl-tp-b")};_mcp.d.f=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.d.g=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-nd-b")};_mcp.d.a=function(){return _fm.b.a(_fm.a.cc,_fm.WebfontSizes.a.a,"ms-fcl-ns-b")};_mcp.d.d=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-fcl-ns-b","ms-fcl-ns-b")};_mcp.d.e=function(){return _fm.b.a(_fm.a.c,_fm.WebfontSizes.a.a,"ms-bgc-ns","ms-fcl-ns-b","ms-fcl-w-b")};_mcp.d.p=function(){return _fm.b.a(_fm.a.cy,_fm.WebfontSizes.a.f,"ms-fcl-ns-b")};_mcp.d.c=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-ns-b")};_mcp.d.D=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nd-b")};_mcp.d.E=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-td-b")};_mcp.d.i=function(){return _fm.b.a(_fm.a.i,_fm.WebfontSizes.a.g,"ms-fcl-nta-b")};_mcp.d.u=function(){return _fm.b.a(_fm.a.bh,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.d.v=function(){return _fm.b.a(_fm.a.bh,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.d.w=function(){return _fm.b.a(_fm.a.bh,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.d.x=function(){return _fm.b.a(_fm.a.h,"ms-fcl-ns-b")};_mcp.d.t=function(){return _fm.e.a("insertpicture.png")};_mcp.d.q=function(){return _fm.b.a(_fm.a.be,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_mcp.d.r=function(){return _fm.b.a(_fm.a.be,_fm.WebfontSizes.a.b,"ms-fcl-nd-b")};_mcp.d.s=function(){return _fm.b.a(_fm.a.be,_fm.WebfontSizes.a.b,"ms-fcl-td-b")};_mcp.d.Q=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.c)};_mcp.d.k=function(){return _fm.b.a(_fm.a.be,_fm.WebfontSizes.a.c)};_mcp.d.j=function(){return _fm.b.a(_fm.a.dx,_fm.WebfontSizes.a.c)};_mcp.d.J=function(){return _fm.b.a(_fm.a.e,_fm.WebfontSizes.a.c)};_mcp.F=function(n){this.b=Function.createDelegate(this,this.e);this.c=Function.createDelegate(this,this.d);_mcp.F.initializeBase(this,[n]);this.a=!1;_y.c.a.n(this.c)};_mcp.F.prototype={a:!1,f:function(n){if(this.a!==n){this.a=n;this.bs("DisplayEllipsis")}return n},d:function(){var n=this;_j.n.a().c(_a.a.a,"MailComposeAggregatedRecipientWell.UpdateEllipsisState",function(){var t=n.z.childNodes&&n.z.childNodes.length>0?n.z.childNodes[0]:null;var i=t&&t.childNodes&&t.childNodes.length>1?t.childNodes[1]:null;n.f(t?t.offsetWidth<i.offsetWidth:!1)})},I:function(){_j.c.prototype.I.call(this);this.d();if(this.W()&&_mcp.j.isInstanceOfType(this.W())){var n=this.W();n.bc().apcl("ShowAggregatedHeader",this.b)}},bt:function(){if(this.W()&&_mcp.j.isInstanceOfType(this.W())){var n=this.W();n.bc().rpcl("ShowAggregatedHeader",this.b)}_y.c.a.p(this.c);_j.c.prototype.bt.call(this)},e:function(n,t){this.d()}};_mcp.ch=function(n,t,i,r,u,f,e,o,s){this.fn=Function.createDelegate(this,this.gC);this.fp=Function.createDelegate(this,this.gG);this.dy=Function.createDelegate(this,this.gE);this.fo=Function.createDelegate(this,this.gD);_mcp.ch.initializeBase(this,[n,t,i,r,u,f,e,o]);this.cz=f;this.bb=i;this.dz=u;this.ca=s};_mcp.ch.prototype={dz:null,bB:!1,cj:!1,bC:null,cD:null,ca:!1,gF:function(n){this.bB=n;this.bv("EnableRichTextOptions","ShowOneRibbon");this.cA();return n},ck:function(n){this.cj=n;this.bs("HighlightEditorBorder");return n},fq:function(){return this.bb.g()},fr:function(){return this.bb.h()},gA:function(){return this.bb.a()||this.bb.h()},fs:function(){return this.gB()},cz:null,bb:null,dB:function(){return this.ca&&this.bB},ft:function(){this.bC||(this.bC=new _zz.R(this.v(),this.cb(),"OneRibbon"));return this.bC},fM:function(){return!1},p:null,w:function(){_mcp.m.prototype.w.call(this);this.cB();if(this.p){this.p.h(this.i.InlineComposeBody,this.v(),this.i.InlineComposeHeaderWrapper,this.i.InlineComposeBottomEdge,this.i.OneRibbonFiller,this.i.AttachmentWellViewWrapper,this.dA());this.v()&&this.v().hk(this.p);this.i.EditorFocusHandler&&this.i.EditorFocusHandler.bc("focus",this.fo,"MailComposeDockableView");this.p.b(this.dy)}},I:function(){_mcp.m.prototype.I.call(this);if(this.C){this.i.InlineComposeBottomEdge=this.C.a("InlineComposeBottomEdge");this.i.InlineComposeBody=this.C.a("InlineComposeBody");this.i.InlineComposeHeaderWrapper=this.C.a("InlineComposeHeaderWrapper");this.i.OneRibbonFiller=this.C.a("OneRibbonFiller");this.i.OneRibbon=this.C.a("OneRibbon");this.i.Emoji=this.C.a("Emoji");this.i.EditorFocusHandler=this.C.a("EditorFocusHandler")}else{this.i.InlineComposeBottomEdge=null;this.i.InlineComposeBody=null;this.i.InlineComposeHeaderWrapper=null;this.i.OneRibbonFiller=null;this.i.OneRibbon=null;this.i.Emoji=null;this.i.EditorFocusHandler=null}},bX:function(){_mcp.m.prototype.bX.call(this);if(this.bC){this.bC.dispose();this.bC=null}if(this.p){this.p.a(this.dy);this.p.g()}this.i.EditorFocusHandler&&this.i.EditorFocusHandler.bi("focus","MailComposeDockableView")},eR:function(n,t){_mcp.m.prototype.eR.call(this,n,t);this.cB()},ct:function(n){_mcp.m.prototype.ct.call(this,n);this.ck(!0)},eL:function(n){switch(n.c()){case 7:this.k("SendButton");break;case 14:var t=this.i.Emoji;if(t&&!t.bo()&&_zz.p.isInstanceOfType(t)&&t.j){var i=t.z.querySelectorAll("button");i&&i.length>0&&i[0].click()}break;default:_mcp.m.prototype.eL.call(this,n);break}},cB:function(){this.gF(this.bJ)},cA:function(){if(this.i){var n=this.i.OneRibbon;var t=this.i.OneRibbonFiller;n&&t&&this.dB()&&n.w()}},fu:function(){this.cD||(this.cD=new _j.g(this.fp,this.F()));return this.cD},bW:function(n){_mcp.m.prototype.bW.call(this,n);this.cA()},gG:function(){if(this.bB){this.ca=!this.ca;this.p&&this.p.k(this.fn,this.i.InlineComposeBottomEdge.z);this.bs("ShowOneRibbon");this.cA()}},gC:function(){var n=this.ca?_zz.d.c(50):"0px";this.i.OneRibbonFiller.z.style.height=n},gE:function(){if(this.i){this.dC(this.i.ToReadWriteRecipientWellView);this.dC(this.i.CcReadWriteRecipientWellView);this.dC(this.i.BccReadWriteRecipientWellView)}},gD:function(n){n.b();n.c();this.k("EditorControl")},dC:function(n){if(_j.c.isInstanceOfType(n)){var t=n.W();t&&t.F().L(!1)}},gB:function(){var n=null;var t=this.dz.a();var u=t.ez().Enabled;var f=t.eA().Enabled;var i=t.eB().Enabled;var r=this.W();if((u||f||i)&&!r.el().a()&&!r.ba.a()){var e=Math.floor(Math.random()*1001);e<200&&(u?n=_u.n.BK:f?n=_u.n.Il:i&&(n=_u.n.QD))}_j.i.a(n)&&(n=this.bb.h()?_u.n.DE:_u.n.GQ);return n}};_mcp.i=function(n){_mcp.i.initializeBase(this,[n])};_mcp.i.prototype={a:null,b:function(){this.a&&_rw.c.a(this.a.z)},I:function(){_j.c.prototype.I.call(this);this.a=this.C?this.C.a("FromPersona"):null}};_mcp.S=function(n,t,i,r,u,f,e,o,s){_mcp.S.initializeBase(this,[n,t,i,r,u,f,e,o,s])};_mcp.S.prototype={bu:!1,cq:function(){return 2},fm:function(n){if(n!==this.bu){this.bu=n;this.bs("ReadyToScroll")}return n},bP:function(){return 250},dA:function(){return!1},I:function(){_mcp.ch.prototype.I.call(this);this.i.ComposeControlWrapper=this.C?this.C.a("ComposeControlWrapper"):null},w:function(){_mcp.ch.prototype.w.call(this);this.cA();this.fm(!0)},G:function(){this.p=new _cmc.i(this.C.a("scrollRegionId"),this.C.a("TopDockPanelId"),this.C.a("bottomDockPanelId"),this.cb(),1,this.bb);this.p.e(this.i.ComposeControlWrapper);_mcp.m.prototype.G.call(this)},M:function(){if(this.p){this.p.d();this.p=null}_mcp.m.prototype.M.call(this)},eK:function(n){_mcp.m.prototype.eK.call(this,n);this.ck(!1)}};_mcp.m=function(n,t,i,r,u,f,e,o){this.eA=Function.createDelegate(this,this.hQ);this.eB=Function.createDelegate(this,this.hR);this.cM=Function.createDelegate(this,this.hA);this.fC=Function.createDelegate(this,this.gH);this.dF=Function.createDelegate(this,this.eK);this.dL=Function.createDelegate(this,this.eL);this.dE=Function.createDelegate(this,this.gP);this.dI=Function.createDelegate(this,this.gR);this.dH=Function.createDelegate(this,this.gQ);this.dM=Function.createDelegate(this,this.gS);this.dK=Function.createDelegate(this,this.ct);this.et=Function.createDelegate(this,this.hK);this.eh=Function.createDelegate(this,this.hx);this.ep=Function.createDelegate(this,this.hB);this.eg=Function.createDelegate(this,this.hw);this.co=Function.createDelegate(this,this.fT);this.er=Function.createDelegate(this,this.hF);this.dN=Function.createDelegate(this,this.gV);this.fF=Function.createDelegate(this,this.fi);this.dP=Function.createDelegate(this,this.eQ);this.dO=Function.createDelegate(this,this.gW);this.es=Function.createDelegate(this,this.hI);this.cQ=Function.createDelegate(this,this.hH);this.cP=Function.createDelegate(this,this.hG);this.cO=Function.createDelegate(this,this.hE);this.cN=Function.createDelegate(this,this.hD);this.dZ=Function.createDelegate(this,this.ho);this.cR=Function.createDelegate(this,this.hJ);this.cF=Function.createDelegate(this,this.hp);this.cm=Function.createDelegate(this,this.hj);this.cE=Function.createDelegate(this,this.hm);this.ei=Function.createDelegate(this,this.fS);this.eu=Function.createDelegate(this,this.hL);this.dX=Function.createDelegate(this,this.hl);this.ee=Function.createDelegate(this,this.hu);this.ex=Function.createDelegate(this,this.hM);this.dR=Function.createDelegate(this,this.gY);this.ef=Function.createDelegate(this,this.hv);this.dQ=Function.createDelegate(this,this.gX);this.eo=Function.createDelegate(this,this.hz);this.ej=Function.createDelegate(this,this.hy);this.eq=Function.createDelegate(this,this.hC);this.dW=Function.createDelegate(this,this.hk);this.ec=Function.createDelegate(this,this.ht);this.ea=Function.createDelegate(this,this.hr);this.eb=Function.createDelegate(this,this.hs);this.ey=Function.createDelegate(this,this.hO);this.ez=Function.createDelegate(this,this.hP);this.cl=Function.createDelegate(this,this.gK);this.cT=Function.createDelegate(this,this.hS);this.x=Function.createDelegate(this,this.fI);this.dD=Function.createDelegate(this,this.gL);this.fE=Function.createDelegate(this,this.gT);this.cJ=Function.createDelegate(this,this.hq);this.dY=Function.createDelegate(this,this.hn);this.ed=Function.createDelegate(this,this.eR);this.fD=Function.createDelegate(this,this.eN);this.cS=Function.createDelegate(this,this.hN);this.fG=Function.createDelegate(this,this.fW);this.r={};_mcp.m.initializeBase(this,[n]);this.n=t;this.q=i;this.eG=r;this.bO=u;this.bd=f;this.bU=e;this.eO=o;if(this.bO){this.fP=this.bO.a().m().Enabled;this.fQ=this.bO.a().k().Enabled}this.i={};_j.e.a(_a.a.a,"View created with layout={0}",this.n)};_mcp.m.prototype={bJ:!1,q:null,eG:null,bO:null,o:null,s:null,m:null,cu:null,j:null,br:!1,di:!1,dc:!1,db:!1,ce:!1,cw:!1,cx:!1,bQ:!1,dt:!1,cv:!1,cc:!1,df:!1,bR:!1,dh:!1,bU:null,bd:null,eO:null,bp:!1,dg:!1,fP:!1,fQ:!1,bK:null,bk:null,cX:null,dm:null,eP:!1,v:function(){return this.i?this.i.EditorControl:null},bP:function(){var n;n=this.n==="TouchNarrow"?50:100;return n},cq:function(){var t=this.n==="Mouse"||this.eI()?1:3;var i=this.W();if(i)if(i.bm())t=2;else{var n=i.ba;this.n==="Mouse"||this.eI()||n.i()&&(n.a()===1||n.a()===2||n.a()===3)&&(t=2)}return t},t:function(n){if(this.m!==n){this.hZ(n,this.m);this.m=n;this.ia()}return n},eT:function(n){if(this.cX!==n){this.cX=n;this.bd.a(_y.bz,new _y.bz(this.cX))}return n},fN:function(){return this.q.z()?"":_nbs.a.oW},gN:function(){return _y.c.a.i()||this.n==="Mouse"?!1:this.di},ds:function(n){if(this.di!==n){this.di=n;this.bs("IsToRecipientWellPeoplePickerButtonShown")}return n},fK:function(){return _y.c.a.i()||this.n==="Mouse"?!1:this.dc},dp:function(n){if(this.dc!==n){this.dc=n;this.bs("IsCcRecipientWellPeoplePickerButtonShown")}return n},fJ:function(){return _y.c.a.i()||this.n==="Mouse"?!1:this.db},dn:function(n){if(this.db!==n){this.db=n;this.bs("IsBccRecipientWellPeoplePickerButtonShown")}return n},fL:function(){var n=this.W();return n&&n.ba&&n.br()?n.ba.bi()&&n.br().a():!0},i:null,n:0,cU:null,fx:function(){return!0},dq:function(n){if(this.cc!==n){this.cc=n;this.bs("IsReadyToShowContent")}return n},dr:function(n){if(this.bR!==n){this.bR=n;this.bs("IsReadyToShowEditor");this.bR&&this.fj()}return n},fh:function(n){if(this.df!==n){this.df=n;this.bs("IsReadyToShowAppBarContent")}return n},u:function(n){if(this.br!==n){this.br=n;this.bs("ShouldPreventShiftTabDefault")}return n},hT:function(n){this.dh=n;this.bs("IsTabAnchorNeeded");return n},eI:function(){return this.eG.b()},gO:function(){return this.W()?this.W().cJ:!1},gM:function(){return!this.q.b()||this.n!=="TouchNarrow"},F:function(){return _a.a.a},cb:function(){!this.dm&&this.W()&&this.W().bM()&&(this.dm=this.W().c());return this.dm},eV:function(n){if(this.bp!==n){this.bp=n;this.bY();this.bg()}return n},fM:function(){return!0},eJ:function(){return 500},cZ:function(){return 1500},fi:function(){this.cu?this.k(this.cu):this.hU()},hU:function(){if(!this.W()){_j.e.a(_a.a.a,"No data context yet, skipping set initial focus");return}var u=this.W();if(this.hW()){_j.e.a(_a.a.a,"Queue task to set initial focus to To well.");if(this.q.b()||this.q.e()){var r=this.i.ComposeViewContent;r.J(!1);this.eF();this.r&&this.r.ToRecipientWellControl&&this.r.ToRecipientWellControl.removeAttribute("disabled");this.k("ToRecipientWellControl")}else if(this.q.a()||this.q.h()){var i=this;this.bk=_j.n.a().a(_a.a.a,"SetFocusToRecipientWell",function(){i.k("ToRecipientWellControl")},this.cZ())}else{var t=this;this.bk=_j.n.a().a(_a.a.a,"SetFocusToRecipientWell",function(){t.k("ToRecipientWellControl")},this.eJ())}}else if(this.gs()){_j.e.a(_a.a.a,"Set initial focus to subject. ");this.k("SubjectTextBox");if(this.q.a()||this.q.h()){_j.e.a(_a.a.a,"Queue task to set initial focus to subject for IE. ");var n=this;this.bk=_j.n.a().a(_a.a.a,"SetFocusToSubject",function(){n.k("SubjectTextBox")},this.cZ())}}else{_j.e.a(_a.a.a,"Set initial focus to body. ");if(this.q.a()||this.q.h()){_j.e.a(_a.a.a,"Queue task to set initial focus to body for IE. ");this.bk=_j.n.a().a(_a.a.a,"SetFocusToEditor",this.fG,this.cZ())}else this.fW()}},hW:function(){var n=this.W();return n.bc().e()<1},gs:function(){return _j.i.a(this.i.SubjectTextBox.b)},f:function(n){},d:function(n){this.dt=!this.W();if(this.dt)_j.e.a(_a.a.a,"PostTransitionIn with null DataContext.");else{var t=this.W();var i=t.br();if(i.d()){this.cv=!!this.i.EditorControl;this.cv?this.Y()?t.bM()&&!t.cD?t.apcl("IsReadyForViewInitialization",this.cS):this.w():_j.e.a(_a.a.a,"PostTransitionIn view not active yet. "):_j.e.a(_a.a.a,"PostTransitionIn template not applied yet. ")}else this.gr(i,t.ba);this.n==="Mouse"&&t.eS()}this.bQ=!0},g:function(){this.bQ=!1;_j.e.a(_a.a.a,"PreTransitionOut view");var n=this.m;this.cu=n;if(n&&n in this.i)switch(n){case"FromFieldControl":case"ToRecipientWellControl":case"CcRecipientWellControl":case"BccRecipientWellControl":case"SubjectTextBox":this.eF();this.ce=!0;var t=this.r[n];if(t===document.activeElement){_j.e.a(_a.a.a,"Blur from {0}",n);t.blur()}this.m=null;this.ce=!1;break;case"EditorControl":this.ce=!0;this.i.EditorControl.dL();this.m=null;this.ce=!1;break}else _j.e.a(_a.a.a," Skip pre-transition out focus related processing for current focused control {0}, since it's not present in the controls dictionary",n)},e:function(){_j.e.a(_a.a.a,"PostTransitionOut view");this.ds(!0);this.dp(!1);this.dn(!1);this.fU();this.dq(!1);this.dr(!1);this.fh(!1)},P:function(){this.be();return!0},a:function(){var n=this.W();return n.be.b(5).h()},h:function(){var n=this.W();return n.be.b(35).a()},c:function(n){var t=this.W();if(t){_cmc.s.e(n.a(),JsonParser.serialize(n))&&n.b(_cmc.s.c(n.a(),t.ba.h()));t.bd().C(n)}},b:function(n){var i=this.W();if(i&&i.bd()&&i.bd().c(!0)&&i.bd().a()){var t=i.bd().a();t.P(n.d());t.Q(n.c());t.O(n.a());t.ce(n.f());t.cd(n.e());t.S(n.b());t.i().a()}},bt:function(){_j.e.a(_a.a.a,"Disposing view");this.hY();this.ib();this.bX();this.r=null;this.i=null;this.m=null;var n=this.W();if(n){var t=n.bh();t&&!t.h()&&n.dispose()}_j.c.prototype.bt.call(this)},I:function(){_j.c.prototype.I.call(this);var n=this.C;var t=null;this.W()&&(t=this.W());if(n){this.i.SubjectTextBox=n.a("SubjectTextBox");this.i.FromFieldControl=n.a("FromFieldControl");this.i.ToRecipientWellControl=n.a("ToRecipientWellControl");this.i.CcRecipientWellControl=n.a("CcRecipientWellControl");this.i.BccRecipientWellControl=n.a("BccRecipientWellControl");var i=n.a("EditorControl");this.i.EditorControl=i;this.i.ComposeViewContent=n.a("ComposeViewContent");i.fC=this.fM();i.gD=t.bm()?0:1;this.i.CancelConfirmDialog=n.a("CancelConfirmDialog");this.i.MessageBox=n.a("MessageBox");this.i.ComposeDockPanel=n.a("ComposeDockPanel");this.i.ToRecipientButton=n.a("ToRecipientButton");this.i.CcRecipientButton=n.a("CcRecipientButton");this.i.BccRecipientButton=n.a("BccRecipientButton");this.i.ToReadWriteRecipientWellView=n.a("ToReadWriteRecipientWellView");this.i.CcReadWriteRecipientWellView=n.a("CcReadWriteRecipientWellView");this.i.BccReadWriteRecipientWellView=n.a("BccReadWriteRecipientWellView");this.i.QuotedBodyHtmlLabel=n.a("QuotedBodyHtmlLabel");this.i.AttachmentWellViewWrapper=n.a("AttachmentWellViewWrapper");this.i.OnDemandUpgradeContainer=n.a("OnDemandUpgradeContainer");if(this.n==="Mouse"){this.i.SendButton=n.a("SendButton");this.i.DiscardButton=n.a("DiscardButton");this.i.InsertButton=n.a("InsertButton");t.bm()||(this.i.AppsButton=n.a("AppsButton"));this.i.AffordanceMenuButton=n.a("AffordanceMenuButton");this.i.OpenSeperateWindowButton=n.a("OpenSeperateWindowButton");this.i.ComposeAppsPane=n.a("ComposeAppsPane");this.i.MinAppBar=n.a("MinAppBar");this.bJ=t.ba.l()==="HTML"}this.cU=new _j.g(this.fD,this.F());this.hV();if(this.bQ&&!this.cv){_j.e.a(_a.a.a,"Applied template, already in view and template was not applied at PostTransitionIn, calling PostTransitionIn. ");this.d(null)}else _j.e.a(_a.a.a,"Applying template. ");this.i.EditorControl&&this.i.EditorControl.apcl("IsPlainTextContent",this.ed)}else{_j.e.a(_a.a.a,"Applying null template. ");this.i.SubjectTextBox=null;this.i.FromFieldControl=null;this.i.ToRecipientWellControl=null;this.i.CcRecipientWellControl=null;this.i.BccRecipientWellControl=null;this.i.EditorControl=null;this.i.CancelConfirmDialog=null;this.i.MessageBox=null;this.i.ComposeDockPanel=null;this.i.AttachmentWellViewWrapper=null;this.i.OnDemandUpgradeContainer=null}this.v()&&this.i.OnDemandUpgradeContainer&&(this.v().gE=this.i.OnDemandUpgradeContainer);this.gt()},bx:function(){var t=new _b.e(this.eO);t.i("ShowAddressBook");var r=this;t.k=new _j.g(function(){r.k("ToRecipientWellControl")},this.F());var n=new _fc.g;n.a([t]);var i=_j.h.prototype.bx.call(this);this.A(-1);return i?i.concat(n):[n]},Z:function(){_j.h.prototype.Z.call(this);if(this.W()){var t=this.W();var i=t.ba;var n=t.br();if(n){i.apcl("IsUpgraded",this.dY);this.bJ=i.l()==="HTML";if(this.dt)if(n.d()){_j.e.a(_a.a.a,"DataContext updated, PostTransitionIn with null DataContext and view model initialized, call PostTransitionIn");this.d(null)}else this.gr(n,i);n.c()||n.apcl("IsSecondInitializationComplete",this.cJ);t.bc().bf(this.fE)}else t.eK||_j.e.b(_a.a.a,"MailCompseView.OnDataContextUpdated -- InitializerComponent should not be null if the state is not disposing..")}else _j.e.a(_a.a.a,"Updated DataContext to null")},G:function(){_j.c.prototype.G.call(this);if(this.bQ&&this.W()&&this.cv){var t=this.W();var n=t.br();n.d()&&this.w()}this.W()&&!this.W().bM()&&(_fc.g.a=this)},M:function(){this.fU();this.W()&&!this.W().bM()&&(_fc.g.a=null);_j.c.prototype.M.call(this)},cp:function(){var n=this.W();if(this.cx){_j.e.a(_a.a.a,"Events already bound. ");return}if(this.q.b()){$(window.document.body).bind("mousedown",{uiComponent:"Body"},this.dD);var e=this;_j.n.a().a(_a.a.a,"RemoveBodyFocusHandler",function(){$(window.document.body).unbind("mousedown",e.dD)},1e3)}this.o=new _j.q;if(this.n==="Mouse"){this.o.c(new _mcp.m.a("DiscardButton",this.x));this.o.c(new _mcp.m.a("InsertButton",this.x));n.bm()||this.o.c(new _mcp.m.a("AppsButton",this.x));this.o.c(new _mcp.m.a("AffordanceMenuButton",this.x));this.o.c(new _mcp.m.a("OpenSeperateWindowButton",this.x));this.o.c(new _mcp.m.a("ToRecipientButton",this.x))}this.o.c(new _mcp.m.a("SubjectTextBox",this.x));this.o.c(new _mcp.m.a("FromFieldControl",this.x));this.o.c(new _mcp.m.a("ToRecipientWellControl",this.cT));this.o.c(new _mcp.m.a("CcRecipientWellControl",this.cT));this.o.c(new _mcp.m.a("BccRecipientWellControl",this.cT));this.o.c(new _mcp.m.a("AttachmentWellViewWrapper",this.x));this.s=new _j.q;this.s.c(new _mcp.m.a("FromFieldControl",this.cl));this.s.c(new _mcp.m.a("ToRecipientWellControl",this.cl));this.s.c(new _mcp.m.a("CcRecipientWellControl",this.cl));this.s.c(new _mcp.m.a("BccRecipientWellControl",this.cl));if(n.bM()){var t=this.cb();t.addEventListener("focus",this.ez,!0);t.addEventListener("blur",this.ey,!0);t.addEventListener("dragover",this.eb,!0);t.addEventListener("dragleave",this.ea,!0);t.addEventListener("drop",this.ec,!0)}else{for(var r=0;r<this.o.d.length;r++){var f=this.i[this.o.d[r].a];f&&_j.k.b(f.z,"focusin",this.o.d[r].c())}for(var i=0;i<this.s.d.length;i++)_j.k.b(this.i[this.s.d[i].a].z,"focusout",this.s.d[i].c())}this.fH();this.i.CancelConfirmDialog.apcl("IsHidden",this.dW);this.i.MessageBox.apcl("IsHidden",this.eq);n.bd().a()&&(this.bp=!n.bd().a().n());this.bg();n.bb.apcl("ActionPerformed",this.ej);n.bb.apcl("Count",this.eo);n.bd().p(this.dQ);if(this.bU.b(this.bU.d())&&this.n==="TouchWide"){var u=n.bv().a();if(u){u.i(this.ef);u.r(this.dR)}}n.ba.apcl("SelectedDataCallContext",this.ex);n.ba.apcl("EditorCallContext",this.ee);n.br().apcl("CanLoadPopoutSuccessfully",this.dX);n.bv().apcl("RequestCloseComposeForm",this.eu);this.i.FromFieldControl.apcl("IsHidden",this.ei);this.i.CcRecipientWellControl.apcl("IsHidden",this.cE);this.i.BccRecipientWellControl.apcl("IsHidden",this.cm);this.gJ();this.cx=!0},bX:function(){var n=this.W();var e=null;var i=null;if(n){i=n.br();if(i){i.rpcl("IsInitialized",this.cF);i.rpcl("IsSecondInitializationComplete",this.cJ)}else _j.e.b(_a.a.a,"MailComposeView.UnbindEvent - InitializerComponent was null.");e=n.ba;e?e.rpcl("IsUpgraded",this.dY):_j.e.b(_a.a.a,"MailComposeView.UnbindEvent - Context was null.");n.rpcl("ReadyToSetInitialFocus",this.cR)}if(!this.cx){_j.e.a(_a.a.a,"Events aren't bound. ");return}if(this.i){this.i.CancelConfirmDialog&&this.i.CancelConfirmDialog.rpcl("IsHidden",this.dW);this.i.MessageBox&&this.i.MessageBox.rpcl("IsHidden",this.eq);this.bY();this.i&&this.i.BccRecipientWellControl&&this.i.BccRecipientWellControl.rpcl("IsHidden",this.cm);this.i.CcRecipientWellControl&&this.i.CcRecipientWellControl.rpcl("IsHidden",this.cE);this.i.FromFieldControl&&this.i.FromFieldControl.rpcl("IsHidden",this.ei);if(n&&n.bM()){var t=this.cb();if(t&&!t.closed)try{t.removeEventListener("focus",this.ez,!0);t.removeEventListener("blur",this.ey,!0);t.removeEventListener("dragover",this.eb,!0);t.removeEventListener("dragleave",this.ea,!0);t.removeEventListener("drop",this.ec,!0)}catch(v){}}else{for(var o=0;o<this.o.d.length;o++)this.i[this.o.d[o].a]&&_j.k.c(this.i[this.o.d[o].a].z,"focusin");for(var f=0;f<this.s.d.length;f++)this.i[this.s.d[f].a]&&_j.k.c(this.i[this.s.d[f].a].z,"focusout")}this.i.EditorControl&&this.i.EditorControl.rpcl("IsPlainTextContent",this.ed)}if(n){_j.e.a(_a.a.a,"Unbind view events on view model. ");n.bC()&&n.bC().a()&&n.bC().a().rpcl("IsShown",this.dZ);var r=n.bV();if(r){r.rpcl("DialogViewModel",this.cN);r.a()&&r.a().rpcl("IsShown",this.cO)}var u=n.bW();if(u){u.rpcl("DialogViewModel",this.cP);u.a()&&u.a().rpcl("IsShown",this.cQ)}var l=n.bc();l&&l.rpcl("IsPeoplePickerShown",this.es);var a=n.bd();if(a){a.w(this.dQ);if(n.bd().a()){n.bd().a().z(this.dO);n.bd().a().cb(this.dP)}}if(this.bU.b(this.bU.d())&&this.n==="TouchWide"){var s=n.bv().a();if(s){s.p(this.ef);s.z(this.dR)}}var c=n.bv();c&&c.rpcl("RequestCloseComposeForm",this.eu);i&&n.br().rpcl("CanLoadPopoutSuccessfully",this.dX);if(e){n.ba.rpcl("SelectedDataCallContext",this.ex);n.ba.rpcl("EditorCallContext",this.ee)}var h=n.bb;if(h){h.rpcl("ActionPerformed",this.ej);h.rpcl("Count",this.eo)}n.rpcl("IsReadyForViewInitialization",this.cS)}this.ic();this.cx=!1},bW:function(n){if(n===1||n===2){var i=n===1?"ComposeAppsPane":"MinAppBar";var t=this.i[i];t&&t.bo()&&this.k("ToRecipientWellControl")}this.fj();this.eS()},ct:function(n){_j.e.a(_a.a.a,"Focused in the RTE");this.m!=="EditorControl"&&this.t("EditorControl");this.bk&&(this.bk=_j.n.a().b(this.bk))},fI:function(n,t){var i=t.uiComponent;this.cY(i)},hS:function(n,t){this.fI(n,t);this.eM()},gK:function(n,t){_j.e.a(_a.a.a,"User blured from {0}",this.m);if(this.W()&&_mcp.e.isInstanceOfType(this.W())&&!this.ce&&!this.W().bK){var i=this.W().bc();if(this.m==="FromFieldControl"&&i&&i.n()){var o=i.n().c();_j.i.a(o)||i.M(o,!0)}var r=null;var s=!0;switch(this.m){case"ToRecipientWellControl":r=this.i.ToReadWriteRecipientWellView;break;case"CcRecipientWellControl":r=this.i.CcReadWriteRecipientWellView;break;case"BccRecipientWellControl":r=this.i.BccReadWriteRecipientWellView;break;default:s=!1;break}if(s&&r&&i&&i.m()){var e=r.W();e&&!e.eK&&e.F()&&!e.F().cu()&&i.m().g()}if(_a.cA.a){var f=this;_j.n.a().a(this.F(),"Delayed MailTips retrieval",function(){if(f.W()&&!f.bI&&!f.cd){var n=f.W().cZ();n&&n.a(1)}},100)}if(_a.bq.a){var u=this;_j.n.a().a(this.F(),"Delayed PolicyTips retrieval",function(){if(u.W()&&!u.bI&&!u.cd){var n=u.W().da();n&&n.a(1)}},100)}}},be:function(){if(this.i&&this.Y()&&this.bQ&&this.m&&this.W()&&!this.W().bK){_j.e.a(_a.a.a,"Restore focus to {0}",this.m);this.k(this.m)}else _j.e.a(_a.a.a,"Skip restore focus, controls={0}; Active={1}; InView={2}; Name={3}; VM={4}",this.i?"non-null":"null",this.Y(),this.bQ,this.m,this.W()?"non-null":"null")},k:function(n){this.eF();switch(n){case"SubjectTextBox":case"BccRecipientWellControl":case"CcRecipientWellControl":case"ToRecipientWellControl":case"FromFieldControl":if(this.r&&this.r[n]){this.r[n].focus();this.t(n);this.eM()}break;case"EditorControl":if(this.i&&this.i[n]){var i=this.i.EditorControl;i.bO(new _cmc.G(!1));this.t(n)}break;case"ToRecipientButton":case"CcRecipientButton":case"BccRecipientButton":case"OpenSeperateWindowButton":case"SendButton":case"DiscardButton":case"AppsButton":case"AffordanceMenuButton":if(this.i&&this.l(n)){this.i[n].P();this.t(n)}break;case"AttachmentWellViewWrapper":var t=this.W().bd();if(this.i&&this.l(n)&&this.W()&&t&&t.s()>0){this.i[n].P();this.t(n)}break}},eF:function(){if(this.r&&!("SubjectTextBox"in this.r)){this.r.SubjectTextBox=this.i.SubjectTextBox.z;this.r.FromFieldControl=this.i.FromFieldControl.z.querySelector("input");this.r.ToRecipientWellControl=this.i.ToRecipientWellControl.z.querySelector("input");this.r.CcRecipientWellControl=this.i.CcRecipientWellControl.z.querySelector("input");this.r.BccRecipientWellControl=this.i.BccRecipientWellControl.z.querySelector("input")}},eR:function(n,t){this.fH();var i=this.W();this.bJ=i.ba.l()==="HTML";this.bJ||this.fO();if(this.q.a())this.fi();else{_j.e.a(_a.a.a,"Queue task to set initial focus after EditorBodyType changed for non-IE browsers.");_j.n.a().a(_a.a.a,"ResetInitialFocusOnEditorBodyTypeChanged",this.fF,this.eJ())}},hw:function(n){this.bW(5)},hB:function(n){this.bW(3)},gV:function(n,t){this.bW(1)},gJ:function(){var i=this.W();if(this.n==="Mouse"){this.i.ComposeAppsPane&&this.i.ComposeAppsPane.apcl("IsHidden",this.dN);this.i.MinAppBar&&this.i.MinAppBar.apcl("IsHidden",this.er);if(_y.c.a.c())if(i.bM()){var r=this.cb();var n=_j.x.b(r);var t=this;n.c("resize",function(n){t.fT()})}else{_y.c.a.n(this.co);this.bd.b(_a.cf,this.eg);this.bd.b(_a.cQ,this.ep);_g.a.a().b().w(this.eh)}else _y.c.a.n(this.co)}},ic:function(){var i=this.W();if(this.n==="Mouse"){this.i.ComposeAppsPane&&this.i.ComposeAppsPane.rpcl("IsHidden",this.dN);this.i.MinAppBar&&this.i.MinAppBar.rpcl("IsHidden",this.er);if(_y.c.a.c())if(i.bM()){var t=this.cb();var n=_j.x.b(t);n.d("resize",null)}else{_y.c.a.p(this.co);this.bd.c(_a.cf,this.eg);this.bd.c(_a.cQ,this.ep);_g.a.a().b().D(this.eh)}else _y.c.a.p(this.co)}},gL:function(n){var i=n.data;var t=i.uiComponent;if(t==="Body"){_j.e.a(_a.a.a,"MouseDown event on Body is being ignored to prevent hiding the keyboard.");n.preventDefault()}},hV:function(){this.i.FromFieldControl.dS(this.et);this.z.setAttribute("aria-label",_nbs.a.fi)},hF:function(n,t){this.bW(2)},hl:function(n,t){this.bs("ShouldHideSpinner")},hM:function(n,t){var i=this.W();var u=this.m||this.cu;if(u==="SubjectTextBox"){i.ba.x().c("subject");this.i.SubjectTextBox.x(i.ba.x())}else if(u==="EditorControl"){if("EditorControl"in this.i){var r=this.i.EditorControl;if(r.bb)r.bO(i.ba.x());else if(_cmc.u.isInstanceOfType(i.ba.x()))i.ba.x().a=r.fu;else if(_cmc.B.isInstanceOfType(i.ba.x())){r.fu=i.ba.x().p;r.bO(i.ba.x())}}i.ba.x().c("body")}else i.ba.x().g(!0)},hL:function(n,t){var r=this.W();if(r){var u=r.be;var i=null;if(this.n==="Mouse"){var e=u.b(19);i=e.l()}else{var f=u.b(10);i=f.a()}i&&i.b&&i.a();this.n==="TouchNarrow"&&r.bv().a()&&r.bv().a().j()}},hu:function(n,t){if("EditorControl"in this.i){var i=this.W();this.i.EditorControl.bO(i.ba.de())}},hY:function(){var n=this.i.FromFieldControl;var r=this.i.ToRecipientWellControl;var i=this.i.CcRecipientWellControl;var t=this.i.BccRecipientWellControl;n&&n.go(this.et)},hK:function(n){if(this.i.FromFieldControl===n)for(var i=n.z.querySelectorAll("input"),t=0;t<i.length;t++)i[t].setAttribute("aria-labelledby","MailCompose.FromRecipientWellButton")},gT:function(){var n=this.i.FromFieldControl;n&&n.b()},eM:function(){var t=!0;switch(this.m){case"ToRecipientWellControl":this.ds(!0);this.dp(!1);this.dn(!1);break;case"CcRecipientWellControl":this.dp(!0);this.ds(!1);this.dn(!1);break;case"BccRecipientWellControl":this.dn(!0);this.dp(!1);this.ds(!1);break;default:t=!1;break}if(t){var n=this.W().bc();n&&n.m()&&n.m().j()}},eN:function(){var n=!0;if(this.br){switch(this.m){case"DiscardButton":this.k("SendButton");break;case"InsertButton":this.k("DiscardButton");n=!1;break;case"AppsButton":this.k("InsertButton");n=!1;break;case"AffordanceMenuButton":var i=this.i.AppsButton;i&&!i.bo()?this.k("AppsButton"):this.k("InsertButton");n=!1;break;case"OpenSeperateWindowButton":this.k("AffordanceMenuButton");n=!1;break;case"ToRecipientButton":var t=this.W();if(t.bc().Z()||t.bb.p.x.length)this.u(!1);else{var u=this.i.ComposeAppsPane;if(u.bo()){this.k("OpenSeperateWindowButton");n=!1}else this.u(!1)}break;case"ToRecipientWellControl":if(this.n==="Mouse"){this.k("ToRecipientButton");n=!1;this.u(!1)}else this.u(!1);break;case"CcRecipientWellControl":this.k("CcRecipientButton");break;case"BccRecipientWellControl":this.k("BccRecipientButton");break;case"AttachmentWellViewWrapper":this.k("SubjectTextBox");break}if(n){var r=this;_j.n.a().a(this.F(),"MailComposeView.HandleShiftTabOnRecipientWell",function(){r.u(!1)},100)}}},ia:function(){if(this.hX()){var n=this.W();switch(this.m){case"ToRecipientWellControl":n.bc().c(1);n.bc().c(2);break;case"CcRecipientWellControl":n.bc().c(0);n.bc().c(2);break;case"BccRecipientWellControl":n.bc().c(0);n.bc().c(1);break;default:n.bc().c(0);n.bc().c(1);n.bc().c(2);break}}},hX:function(){return this.n==="Mouse"&&this.W()?!0:!1},hk:function(n,t){if(this.i.CancelConfirmDialog.bo()&&this.W()&&!this.W().bK){_j.e.a(_a.a.a,"Restore focus on hide of cancel confirm dialog.");this.be()}},hC:function(n,t){if(this.i.MessageBox.bo()){_j.e.a(_a.a.a,"Restore focus on hide of message box.");this.be()}},hp:function(n,t){var i=this.W();if(i.br().d()){this.dg&&i.br().rpcl("IsInitialized",this.cF);_j.e.a(_a.a.a,"Calling PostTransitionIn on initialize of Data Context.");this.d(null)}else _j.e.a(_a.a.a,"InitializerComponent.IsInitialized = false.")},hn:function(n,t){var i=this.W();i.ba.i()&&this.bs("EditorSizingMode")},hq:function(n,t){var i=this.W();i.br().rpcl("IsSecondInitializationComplete",this.cJ);this.n==="Mouse"&&i.bC()&&i.bC().a()&&i.bC().a().apcl("IsShown",this.dZ);var u=i.bV();u.a()?u.a().apcl("IsShown",this.cO):u.apcl("DialogViewModel",this.cN);var r=i.bW();r.a()?r.a().apcl("IsShown",this.cQ):r.apcl("DialogViewModel",this.cP);var f=i.bc();f&&f.apcl("IsPeoplePickerShown",this.es)},ho:function(n,t){var i=this.W();if(!i.bC().a().q()){var u=i.bV();var r=i.bW();var f=this;_j.n.a().a(this.F(),"MailComposeView.OnContextMenuShownChanged",function(){var e=!u.a()||!u.a().p;var t=!r.a()||!r.a().p;var n=!i.bk||!i.bk.p;if(e&&n&&t){_j.e.a(_a.a.a,"Restore focus on hide of context menu");f.be()}},100)}},hD:function(n,t){var r=this.W();var i=r.bV();i.rpcl("DialogViewModel",this.cN);i.a().apcl("IsShown",this.cO)},hE:function(n,t){var r=this.W();var i=this;_j.n.a().a(this.F(),"MailComposeView.OnMessageOptionsShownChanged",function(){if(!r.bV().a().p){_j.e.a(_a.a.a,"Restore focus on hide of message options dialog");i.be()}},100)},hG:function(n,t){var r=this.W();var i=r.bW();i.rpcl("DialogViewModel",this.cP);i.a().apcl("IsShown",this.cQ)},hH:function(n,t){var r=this.W();var i=this;_j.n.a().a(this.F(),"MailComposeView.OnOmeOptionsShownChanged",function(){if(!r.bW().a().p){_j.e.a(_a.a.a,"Restore focus on hide of ome options dialog");i.be()}},100)},hI:function(n,t){var i=this.W();if(!i.bc().ba()){_j.e.a(_a.a.a,"Restore focus on hide of people picker");this.be()}},hy:function(n,t){this.be()},hz:function(n,t){this.gt();this.fj()},gt:function(){var a=this.C.a("InfoBarControl");if(a){var f=this.W();if(f.bb.p.x.length>0){for(var l=new _y.cH,o=_nbs.a.Hs+". ",n,r=0;r<f.bb.p.x.length;r++){n="";var t=f.bb.p.x[r];if(_db.C.isInstanceOfType(t)){var h=t;h&&(n=h.h)}else if(_db.D.isInstanceOfType(t)){var e=t;e&&(n=e.h)}else if(_db.B.isInstanceOfType(t)){var i=t;if(i&&_y.fs.isInstanceOfType(i.h)){var u=i.h;u&&u.a()&&(n=u.a())}}if(n===""){var s=t;s&&(n=l.a(s.e,null))}o+=n+". "}var c=this.C.a("InfoBarControl").z;c.setAttribute("aria-label",o)}}},gX:function(n){n.a().t(this.dO);n.a().by(this.dP);this.eV(!n.a().n())},eQ:function(n){this.eV(!n.n());this.v().jB=_j.k.e(this.i.AttachmentWellViewWrapper.z)},gW:function(n){if(n.bL()){n.cf(!1);this.t("EditorControl")}this.eV(!n.n());this.be()},gr:function(n,t){if(this.dg)_j.e.a(_a.a.a,"PostTransitionIn before DataContext was initialized. DataContext initialization handler is already setup. ");else{_j.e.a(_a.a.a,"PostTransitionIn before DataContext was initialized. Adding handler to call PostTransitionIn after DataContext is initialized. ");n.apcl("IsInitialized",this.cF);this.dg=!0}},gI:function(){if(!this.cw){var i=this.W().dr();var r=this.W().cv();if("EditorControl"in this.i&&this.i.EditorControl){var n=this.i.EditorControl;n.gG(this.dK);n.cM(this.dM);n.jI(this.dH);n.hW(this.dI);n.b(this.dE);n.eO(this.dL);n.lA(this.dF);i&&i.j(n);r&&r.c(n)}if(this.q.a()){var t=this.C.a("TabAnchor");t&&_j.k.b(t.z,"focusin",this.fC)}this.cw=!0}},eK:function(n){},ib:function(){if(this.cw){if("EditorControl"in this.i&&this.i.EditorControl){var n=this.i.EditorControl;n.gX(this.dK);n.cF(this.dM);n.jV(this.dH);n.ik(this.dI);n.e(this.dE);n.eq(this.dL);n.lO(this.dF)}if(this.q.a()){var t=this.C.a("TabAnchor");t&&_j.k.c(t.z,"focusin")}this.cw=!1}},gH:function(n){this.k("EditorControl");n.b()},da:function(n){_j.i.a(this.j)||this.k(this.j);n.a(!0)},bg:function(){this.j=null;this.bp&&(this.j="AttachmentWellViewWrapper");var n=this.W();n.ba.bu()||_j.i.a(this.j)&&this.l("SubjectTextBox")&&(this.j="SubjectTextBox");_j.i.a(this.j)&&this.l("BccRecipientWellControl")&&(this.j="BccRecipientWellControl");if(_j.i.a(this.j)&&this.l("CcRecipientWellControl")){this.j="CcRecipientWellControl";this.i.BccRecipientWellControl.rpcl("IsHidden",this.cm);this.i.BccRecipientWellControl.apcl("IsHidden",this.cm)}_j.i.a(this.j)&&this.l("ToRecipientWellControl")&&(this.j="ToRecipientWellControl");!_j.i.a(this.j)&&this.i&&this.i[this.j]&&_j.k.b(this.i[this.j].z,"keydown",this.cM)},bY:function(){!_j.i.a(this.j)&&this.i&&this.i[this.j]&&_j.k.c(this.i[this.j].z,"keydown")},l:function(n){if(!this.i)return!1;var t=this.i[n];return!!t&&!t.bo()},hj:function(n,t){this.l("BccRecipientWellControl")&&this.m&&this.k("BccRecipientWellControl");this.bY();this.bg()},hm:function(n,t){this.i.CcRecipientWellControl.rpcl("IsHidden",this.cE);this.l("CcRecipientWellControl")&&this.m&&this.k("CcRecipientWellControl");this.bY();this.bg()},fS:function(n,t){},gS:function(n){var t=this.W();if(t){t.ba.eh(n.f());t.ba.dJ(n.e());t.ba.dS(n.c())}n.c()&&this.bs("ShouldHideSpinner")},gQ:function(n){var i=this.W();if(i){var t=i.bd().a().bf();t.b(n.c());t.a(n.c())}},gR:function(n){var t=this.W();if(t){var i=t.bd().a();i.U(n.c())}},gP:function(n){this.fO()},eL:function(n){var i=this.W();if(i){var f=i.be;switch(n.c()){case 1:var s=i.bh();var u=s.a();u&&u.b&&u.a();break;case 2:this.bd&&this.bd.a(_y.ew,new _y.ew);break;case 3:var r=i.bl().e();r&&r.b&&r.a();break;case 4:var t=null;if(this.n==="Mouse"){var o=f.b(19);t=o.a()}else{var e=f.b(10);t=e.a()}t&&t.b&&t.a();break;case 5:this.k("ToRecipientWellControl");break;case 8:this.da(n);break}}},fj:function(){var t=this.W();if(this.i&&t){var n;n=this.i.EditorControl;n&&n.bb&&t.cC&&this.cc&&this.bR&&n.eV()}},fU:function(){if(this.i&&this.i.EditorControl){var n=this.i.EditorControl;n.bb&&n.bO(new _cmc.j(!1))}},fO:function(){var t=this.W();if(this.bJ&&this.i&&this.i.EditorControl){var n=this.i.EditorControl;if(n.bb&&!n.cX()){n.bO(new _cmc.bF);t.ba.cQ(n.ce.b)}}else t.ba.cQ(0)},hx:function(n,t){},fT:function(){this.bW(0)},eS:function(){if(this.i){var i=this.i.ToReadWriteRecipientWellView;var t=this.i.CcReadWriteRecipientWellView;var n=this.i.BccReadWriteRecipientWellView;this.fk(i);this.fk(t);this.fk(n)}},fk:function(n){if(n&&_rw.d.isInstanceOfType(n.W())){var t=n.W();t.bJ(!0);t.bJ(!1)}},hv:function(){var n=this.i.QuotedBodyHtmlLabel;if(n){this.i.QuotedBodyHtmlLabel.cH().on("touchstart",null,null,this.eB);this.i.QuotedBodyHtmlLabel.cH().on("touchend",null,null,this.eA)}},gY:function(){var n=this.i.QuotedBodyHtmlLabel;if(n){this.i.QuotedBodyHtmlLabel.cH().off("touchstart",null,this.eB);this.i.QuotedBodyHtmlLabel.cH().off("touchend",null,this.eA)}},hQ:function(n){if(n.target.tagName==="A"){var t=n.target.getAttribute("href");this.bU.d().a(t);n.stopPropagation();n.preventDefault()}},hR:function(n){if(n.target.tagName==="A"){n.stopPropagation();n.preventDefault()}},w:function(){var n=this.W();var t=this.i.EditorControl;this.q.g()&&this.i&&this.i.SubjectTextBox&&_zz.F.c(this.i.SubjectTextBox.z,null);this.gI();this.n==="TouchNarrow"?this.fh(!1):this.fh(!0);this.v().hj(this);this.v().oc(this);this.dq(!0);this.dr(!0);_j.e.a(_a.a.a,"PostTransitionIn active view. ");n.ba.bG()||this.fV()||this.W().apcl("ReadyToSetInitialFocus",this.cR);this.cp()},hN:function(n,t){var i=n;i.rpcl("IsReadyForViewInitialization",this.cS);this.w()},fW:function(){if(this.i&&this.i.EditorControl){var n=this.i.EditorControl;n.bO(new _cmc.G(!0));this.t("EditorControl")}},hP:function(n){if(Node.isInstanceOfType(n.target))for(var i=0;i<this.o.d.length;i++){var r=this.o.d[i];var t=this.i[r.a];if(t&&(n.target===t.z||t.z.contains(n.target))){this.cY(r.a);this.eM();break}}return!0},hO:function(n){if(Node.isInstanceOfType(n.target))for(var t=0;t<this.s.d.length;t++){var r=this.s.d[t];var i=this.i[r.a];if(n.target===i.z||i.z.contains(n.target)){r.b(null,null);break}}return!0},hs:function(n){_b.r.b(n);var t=n.dataTransfer.types;this.eT(t);this.bK&&(this.bK=_j.n.a().b(this.bK));return!1},hr:function(n){if(!this.bK){var t=this;this.bK=_j.n.a().a(_a.a.e,"OnDragLeave",function(){t.eT(null);t.bK=null},50)}return!0},ht:function(n){_b.r.b(n);this.eT(null);return!1},fR:function(n){return n==="ToRecipientWellControl"||n==="BccRecipientWellControl"||n==="CcRecipientWellControl"},gU:function(){return!!this.bO&&this.bO.a().fl().Enabled},hZ:function(n,t){if(this.gU()&&!this.fR(n)&&this.fR(t)){var i=this;_j.n.a().a(this.F(),"Delayed PeopleRecommendations recipients retrieval",function(){if(i.W()){var t=i.W();if(t&&!t.eK){var n=i.W().eg();n&&n.b(1)}}},100)}},cY:function(n){_j.e.a(_a.a.a,"Focused in {0}",n);this.t(n);this.u(n==="CcRecipientWellControl"||n==="BccRecipientWellControl"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="OpenSeperateWindowButton"||n==="AffordanceMenuButton"||n==="InsertButton"||n==="DiscardButton"||n==="AppsButton");if(this.W()&&_mcp.e.isInstanceOfType(this.W())){var i=this.W();if(this.m==="FromFieldControl"){var t=i.bc();t&&t.K(!1)}}},fH:function(){var n=this.W();n&&this.hT(this.q.a()&&n.ba.l()==="Text"?!0:!1)},hA:function(n){var t=n.a();if(t===9&&!n.o()&&this.j!=="AttachmentWellViewWrapper"&&(this.j!=="SubjectTextBox"||!this.i.SubjectTextBox.q)){this.k("EditorControl");this.hd(n)}},hJ:function(n,t){this.fV()},fV:function(){var n=this.W();if(n&&!this.eP&&(n.cI||!(this.n==="Mouse"))){this.eP=!0;this.fi();n.rpcl("ReadyToSetInitialFocus",this.cR);return!0}return!1}};_mcp.m.a=function(n,t){this.a=n;this.b=t};_mcp.m.a.prototype={a:null,b:null,c:function(){var n=this;return function(t){n.b(t,{uiComponent:n.a})}}};_mcp.bd=function(n){this.h=Function.createDelegate(this,this.p);this.g=Function.createDelegate(this,this.o);this.b={};_mcp.bd.initializeBase(this,[n])};_mcp.bd.prototype={c:null,a:null,d:null,e:function(){this.b.UpconvertButton.P();this.c="UpconvertButton";_mcp.o.isInstanceOfType(this.a)&&(this.a.bu=!0)},I:function(){_j.c.prototype.I.call(this);this.b.ShowCcButton=this.C.a("ShowCcButton");this.b.ShowBccButton=this.C.a("ShowBccButton");this.b.UpconvertButton=this.C.a("UpconvertButton")},ek:function(){_j.h.prototype.ek.call(this);this.q()},M:function(){this.i();_j.c.prototype.M.call(this)},bt:function(){this.i();_j.c.prototype.bt.call(this)},j:function(n){if(this.b[n]){this.b[n].P();this.c=n}},q:function(){this.d=this.X;this.a=this.d.X;_mcp.i.isInstanceOfType(this.a)&&(this.a=this.a.X);_mcp.o.isInstanceOfType(this.a)&&this.a.ij(this);_j.k.b(this.d.z,"focusout",this.g);_j.k.b(this.d.z,"keydown",this.h)},f:function(n){var t=this.b?this.b[n]:null;return!!t&&!t.bo()},p:function(n){var t=n.a();if(t===9&&n.g())if(this.b.UpconvertButton.fw()){this.c="UpconvertButton";this.n()}else if(this.b.ShowBccButton.fw()){this.c="ShowBccButton";this.k()}else if(this.b.ShowCcButton.fw()){this.c="ShowCcButton";this.l()}},n:function(){if(this.f("ShowBccButton")){this.j("ShowBccButton");_mcp.o.isInstanceOfType(this.a)&&(this.a.bu=!0)}else this.f("ShowCcButton")&&this.k()},k:function(){if(this.f("ShowCcButton")){this.j("ShowCcButton");_mcp.o.isInstanceOfType(this.a)&&(this.a.bu=!0)}else this.l()},l:function(){this.c=null;if(_mcp.o.isInstanceOfType(this.a)){this.a.ik();this.a.bu=!1}},i:function(){this.m();_j.k.c(this.d.z,"focusout");_j.k.c(this.d.z,"keydown")},o:function(n){this.m()},m:function(){this.c=null;_mcp.o.isInstanceOfType(this.a)&&(this.a.bu=!1)}};_mcp.o=function(n,t,i,r,u,f,e,o){this.gv=Function.createDelegate(this,this.ig);this.gw=Function.createDelegate(this,this.ih);this.fl=Function.createDelegate(this,this.ie);this.gu=Function.createDelegate(this,this.id);this.gx=Function.createDelegate(this,this.ii);_mcp.o.initializeBase(this,[n,t,i,r,u,f,e,o,!1])};_mcp.o.prototype={dx:!1,bZ:null,bu:!1,eJ:function(){return 0},cZ:function(){return 0},dA:function(){return!0},ij:function(n){n&&(this.bZ=n)},ik:function(){if(this.l("FromFieldControl"))this.k("FromFieldControl");else{this.dx=!0;this.k("ToRecipientWellControl")}},I:function(){_mcp.ch.prototype.I.call(this);if(this.C){this.i.InsertPictureButton=this.C.a("InsertPictureButton");this.i.FormatButton=this.C.a("FormatButton");this.i.InsertAvailableTime=this.C.a("InsertAvailableTime");this.i.ShowOriginalMessage=this.C.a("ShowOriginalMessage");this.i.AggregatedReadOnlyHeader=this.C.a("AggregatedReadOnlyHeader");this.i.ReadWriteHeader=this.C.a("ReadWriteHeader");this.i.ComposeBodyContainer=this.C.a("ComposeBodyContainer")}else{this.i.InsertPictureButton=null;this.i.FormatButton=null;this.i.InsertAvailableTime=null;this.i.Emoji=null;this.i.ShowOriginalMessage=null;this.i.AggregatedReadOnlyHeader=null;this.i.ReadWriteHeader=null;this.i.ComposeBodyContainer=null}},w:function(){_mcp.j.isInstanceOfType(this.W())&&(this.p=this.W().g);_mcp.ch.prototype.w.call(this);var r=this.i.InlineComposeBody;var u=this.i.InlineComposeBottomEdge;var i=this.i.InlineComposeHeaderWrapper;var n=!!r&&!!this.v()&&!!i&&!!u;if(!n){var t="[MailInlineCompose: InitializeView] - One or more of inline compose control elements are null.";_j.e.c(this.F(),t);return}},id:function(n){this.cf(!1);this.k("ToRecipientWellControl")},cf:function(n){if(this.W()&&_mcp.e.isInstanceOfType(this.W())){var t=this.W();t.bi().a("ShowFullRecipient");this.ck(n);t.bc().L(n)}},k:function(n){if(this.i)switch(n){case"Emoji":if(this.i[n]){this.i[n].P();this.t(n)}break;case"FormatButton":case"InsertPictureButton":case"ShowOriginalMessage":case"InsertAvailableTime":if(this.l(n)){this.i[n].P();this.t(n)}break;case"EditorControl":var t=this.i.EditorControl;this.bb.a()&&t.dc()||t.bO(new _cmc.G(!1));this.t(n);break;default:_mcp.m.prototype.k.call(this,n);break}},ct:function(n){_mcp.ch.prototype.ct.call(this,n);this.cz.a(IMailInlineComposeFocusEvent,new _mcp.bh)},bg:function(){this.j=null;this.bp&&(this.j="AttachmentWellViewWrapper");!this.j&&this.l("BccRecipientWellControl")&&(this.j="BccRecipientWellControl");!this.j&&this.l("CcRecipientWellControl")&&(this.j="CcRecipientWellControl");!this.j&&this.l("ToRecipientWellControl")&&(this.j="ToRecipientWellControl");!_j.i.a(this.j)&&this.l(this.j)&&_j.k.b(this.i[this.j].z,"keydown",this.cM)},bY:function(){!_j.i.a(this.j)&&this.i&&this.i[this.j]&&_j.k.c(this.i[this.j].z,"keydown")},eN:function(){this.br&&this.gy()},da:function(n){if(!_j.i.a(this.j)){this.bp||this.cf(!1);this.k(this.j);this.j!=="ToRecipientWellControl"||this.l("FromFieldControl")||this.bZ.e()}n.a(!0)},cY:function(n){_j.e.a(_a.a.a,"Focused in {0}",n);this.t(n);var t=n==="CcRecipientWellControl"||n==="CcRecipientButton"||n==="BccRecipientWellControl"||n==="BccRecipientButton"||n==="ToRecipientWellControl"||n==="ToRecipientButton"||n==="FromFieldControl";this.u(t||n==="AttachmentWellViewWrapper");this.ck(!t);t&&this.cz.a(IMailInlineComposeFocusEvent,new _mcp.bh);if(this.W()&&_mcp.e.isInstanceOfType(this.W())){var r=this.W();if(this.m==="FromFieldControl"){var i=r.bc();i&&i.K(!1)}}},cp:function(){_mcp.m.prototype.cp.call(this);var i=this.i.ShowOriginalMessage;i&&_j.k.b(i.z,"keydown",this.gx);var t=this.i.AggregatedReadOnlyHeader;if(!t){var r="[MailInlineCompose: BindEvents] -  AggregatedReadOnlyHeader is null or undefined.";_j.e.c(this.F(),r);return}_j.k.b(t.z,"click",this.gu);t.apcl("IsHidden",this.fl);var n=this.i.ComposeBodyContainer;if(n){_j.k.b(n.z,"mouseover",this.gw);_j.k.b(n.z,"mouseout",this.gv)}},bX:function(){_mcp.ch.prototype.bX.call(this);var i=this.i.ShowOriginalMessage;i&&_j.k.c(i.z,"keydown");var t=this.i.AggregatedReadOnlyHeader;if(!t){var r="[MailInlineCompose: UnbindEvents] -  AggregatedReadOnlyHeader is null or undefined.";_j.e.b(this.F(),r);return}_j.k.c(t.z,"click");t.rpcl("IsHidden",this.fl);var n=this.i.ComposeBodyContainer;if(n){_j.k.c(n.z,"mouseover");_j.k.c(n.z,"mouseout")}},fS:function(n,t){this.bY();this.bg();this.cf(!1)},cB:function(){_mcp.ch.prototype.cB.call(this);this.il(!this.bB)},eQ:function(n){_mcp.m.prototype.eQ.call(this,n);this.p&&this.p.c(1)},il:function(n){this.l("FormatButton")&&this.i.FormatButton.ff(n);this.l("InsertPictureButton")&&this.i.InsertPictureButton.ff(n);this.l("Emoji")&&this.i.Emoji.ff(n);this.l("InsertAvailableTime")&&this.i.InsertAvailableTime.ff(n)},ii:function(n){var t=n.a();if(t===9&&!n.o()){this.k("SendButton");this.hd(n)}},gy:function(){if(!this.bu)switch(this.m){case"BccRecipientWellControl":this.k("BccRecipientButton");break;case"BccRecipientButton":this.l("CcRecipientWellControl")?this.k("CcRecipientWellControl"):this.l("FromFieldControl")?this.k("ToRecipientWellControl"):this.bZ.e();break;case"CcRecipientWellControl":this.k("CcRecipientButton");break;case"CcRecipientButton":this.l("FromFieldControl")?this.k("ToRecipientWellControl"):this.bZ.e();break;case"ToRecipientWellControl":this.dx?this.dx=!1:this.k("ToRecipientButton");break;case"ToRecipientButton":this.l("FromFieldControl")?this.bZ.e():this.u(!1);break;case"FromFieldControl":this.bu||this.u(!1);break;case"ShowOriginalMessage":this.k("EditorControl");break;case"SendButton":this.k("ShowOriginalMessage");break;case"AttachmentWellViewWrapper":this.cf(!1);this.l("FromFieldControl")?this.k("ToRecipientWellControl"):this.bZ.e();break;default:this.u(!1);break}},ig:function(n){this.fm(!1)},ih:function(n){this.fm(!0)},fm:function(n){var t=null;t=this.cj?"ms-border-color-themeTertiary":n?"ms-border-color-neutralTertiary":"ms-border-color-neutralTertiaryAlt";this.im(t)},im:function(n){if(!_j.i.a(n)){for(var i=this.i.InlineComposeBottomEdge,f=i.z.className.split(" "),u=f,e=u.length,t=0;t<e;++t){var r=u[t];r.startsWith("ms-border-color")&&i.by(r)}i.bm(n)}},ie:function(n,t){this.eS();this.fm(!1)}};_mcp.a=function(){};_mcp.a.$$cctor=function(){_mcp.a._I()};_mcp.a.gk=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <span></span> </div><div> <div class='ms-font-weight-regular ms-font-color-neutralSecondaryAlt InfobarImmediateTextContainer'> <span class='_mcp_2'></span> <a class='_mcp_3 ms-font-weight-regular ms-font-color-themeDark ms-font-s'></a> <span class='ms-font-weight-regular ms-font-color-themeDark ms-font-s'></span> <a class='_mcp_3 ms-font-weight-regular ms-font-color-themeDark ms-font-s'></a> </div> </div><div> <span class='_mcp_4'></span> <span class='_mcp_4'></span> </div><div> <div class='_mcp_t ms-font-weight-regular ms-font-color-neutralDark'></div> </div><div> <button type='button' class='_mcp_g'></button> <div class='_mcp_v'></div> <div class='_mcp_e'></div> <div class='_mcp_e'></div> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <span class='_mcp_l ms-font-weight-regular ms-font-color-black'></span> <button type='button' class='_mcp_x ms-font-m'></button> </div> </div><div> <span class='_mcp_r'></span> <span class='_mcp_r'></span> </div><div> <span class='_mcp_r'></span> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <span class='_mcp_o _mcp_p _mcp_q ms-font-weight-regular ms-font-color-neutralSecondary'></span> <div></div> </div> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <span class='_mcp_q ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div><div> <span class='_mcp_k ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_s'> <div class='_mcp_9'></div> </div> </div><div> <button autoid=\"_mcp_5\" type='button'></button> <div></div> </div><div> <div class='_mcp_X _mcp_Y'></div> </div><div> <span class='_mcp_i ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_h'></span> </div><div> <div class='_mcp_G'></div>  <div class='ms-bg-color-themePrimary'></div> <div class='_mcp_I'> <div class='_mcp_J ms-font-weight-regular ms-font-color-neutralPrimary'></div> <div>  <div class='_mcp_P'></div> <div class='_mcp_N'> <div class='_mcp_c'> <div class='_mcp_7 _mcp_O _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'></div> </div> <div class='_mcp_7 _mcp_S _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_j ms-font-weight-regular ms-font-color-black _mcp_F'></button> <div> <div class='_mcp_E'> <button type='button'></button> </div> <div autoid=\"_mcp_0\" class='_mcp_a _mcp_y'></div> </div> <div> <div class='_mcp_a _mcp_y'></div> </div> </div> <div class='_mcp_7 _mcp_S _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_j ms-font-weight-regular ms-font-color-black _mcp_F'></button> <div> <div class='_mcp_E'> <button type='button'></button> </div> <div autoid=\"_mcp_1\" class='_mcp_a _mcp_y'></div> </div> <div> <div class='_mcp_a _mcp_y'></div> </div> </div> <div class='_mcp_7 _mcp_S _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <button type='button' class='_mcp_j ms-font-weight-regular ms-font-color-black _mcp_F'></button> <div> <div class='_mcp_E'> <button type='button'></button> </div> <div autoid=\"_mcp_2\" class='_mcp_a _mcp_y'></div> </div> <div> <div class='_mcp_a _mcp_y'></div> </div> </div> <div class='_mcp_7 _mcp_b _mcp_d ms-border-color-neutralTertiary ms-bg-color-white'> <div class='_mcp_s'> <button type='button' class='_mcp_x _mcp_n'></button> <span class='_mcp_x _mcp_m'></span> <span class='_mcp_x _mcp_m'></span> <span class='_mcp_x _mcp_m'></span> <button type='button' class='_mcp_x ms-font-xl'></button> <div class='_mcp_y'> <input autoid=\"_mcp_3\" class='_mcp_t _mcp_u ms-font-weight-regular ms-font-color-neutralSecondary'/> </div> </div> </div> <div> <div class='_mcp_8 ms-bg-color-white'></div> <div class='_mcp_8 ms-bg-color-white'></div> <div class='_mcp_8 ms-bg-color-white'></div> <div class='_mcp_8 ms-bg-color-white'></div> </div> <div> <div class='_mcp_7 ms-bg-color-white'> <div></div> </div> </div> <span></span> </div> <div class='_mcp_N ms-bg-color-white'> <div autoid=\"_mcp_4\" class='_mcp_z'></div> <div class='_mcp_K ms-border-color-neutralTertiary'></div> </div> <div class='_mcp_N ms-bg-color-white'> <span class='_mcp_B ms-font-weight-regular'></span> </div> </div> </div> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> <div class='_mcp_H'></div>  </div><div>  <span></span> </div><div> <div class='_mcp_C1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_c\" type='button' class='_mcp_q1'></button> <div class='_mcp_F1'></div> <div class='_mcp_m1'></div> <div class='_mcp_m1'></div> <div></div> </div><div> <span class='_mcp_u1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_y1'> <span autoid=\"_mcp_k\" class='_mcp_v1 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_K1'></span> <span class='_mcp_K1'></span> </div><div> <span class='_mcp_K1'></span> </div><div> <span class='_mcp_u1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_y1'> <div> <span class='_mcp_K1 _mcp_J1 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_L1'></span> <div></div> </div> </div> </div><div> <span class='_mcp_u1 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_y1'> <span autoid=\"_mcp_l\" class='_mcp_J1 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_u1 ms-font-weight-semibold ms-font-color-black _mcp_w1'></span> <div class='_mcp_y1'> <div class='_mcp_i1'></div> </div> </div><div> <button autoid=\"_mcp_m\" type='button'></button> <div></div> </div><div> <span class='_mcp_s1 ms-font-weight-semibold ms-font-color-black'></span> <span class='_mcp_r1'></span> </div><div> <iframe autoid=\"_mcp_r\" class='_mcp_52'></iframe> </div><div> <div class='_mcp_62'> <button type='button' class='_mcp_72 _mcp_P1 ms-font-weight-regular'></button> <span></span> </div> </div><div> <button type='button' class='_mcp_t1 ms-font-weight-semibold'></button> <button type='button' class='_mcp_t1 ms-font-weight-semibold'></button> </div><div> <div class='_mcp_d1 _mcp_92'></div> </div><div> <div class='_mcp_Z1'></div> <span class='_mcp_Z1'></span> <div class='_mcp_81 ms-bg-color-white'> <div class='_mcp_42'></div> <div></div> <div class='_mcp_91'>  <span class='_mcp_c1'> <div class='_mcp_U1'> <button autoid=\"_mcp_6\" type='button' class='_mcp_P1 ms-font-weight-regular sendButton'></button> <button type='button' class='_mcp_P1 ms-font-weight-regular sendButton'></button> </div> <div class='_mcp_U1'> <button autoid=\"_mcp_7\" type='button' class='_mcp_P1 ms-font-weight-regular closeButton'></button> </div> <div class='_mcp_U1'> <button autoid=\"_mcp_8\" type='button' class='_mcp_P1 ms-font-weight-regular includeButton'></button> </div> <div class='_mcp_U1'> <button autoid=\"_mcp_9\" type='button' class='_mcp_P1 ms-font-weight-regular _mcp_S1'></button> </div> <button autoid=\"_mcp_a\" type='button' class='_mcp_P1 ms-font-weight-regular'></button> </span> <span class='_mcp_d1'> <button autoid=\"_mcp_b\" type='button' class='_mcp_P1 ms-font-weight-regular'></button> </span> </div> <div class='_mcp_a1 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_21'> <div class='_mcp_31 _mcp_61'></div> <div></div> <div class='_mcp_31 _mcp_51'> <div class='_mcp_71 ms-bg-color-white customScrollBar'>  <div class='_mcp_e1 ms-font-weight-regular'></div> <div class='_mcp_g1 _mcp_l1 ms-border-color-neutralTertiary _mcp_j1'></div> <div class='_mcp_g1 _mcp_j1 _mcp_l1 ms-border-color-neutralTertiary'> <button autoid=\"_mcp_d\" type='button' class='_mcp_t1 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_22'></button> <div class='_mcp_y1 _mcp_A1 _mcp_z1'> <div></div> <div autoid=\"_mcp_e\" class='_mcp_W1'></div> </div> <div class='_mcp_y1 _mcp_A1 _mcp_z1 _mcp_B1'> <div class='_mcp_W1'></div> </div>  </div> <div class='_mcp_g1 _mcp_j1 _mcp_l1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_t1 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_22'></button> <div class='_mcp_y1 _mcp_A1 _mcp_z1'> <div autoid=\"_mcp_f\" class='_mcp_W1'></div> </div> <div class='_mcp_y1 _mcp_A1 _mcp_z1 _mcp_B1'> <div class='_mcp_W1'></div> </div>  </div> <div class='_mcp_g1 _mcp_j1 _mcp_l1 ms-border-color-neutralTertiary'> <button type='button' class='_mcp_t1 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_22'></button> <div class='_mcp_y1 _mcp_A1 _mcp_z1'> <div autoid=\"_mcp_g\" class='_mcp_W1'></div> </div> <div class='_mcp_y1 _mcp_A1 _mcp_z1 _mcp_B1'> <div class='_mcp_W1'></div> </div>  </div> <div class='_mcp_g1'> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black _mcp_x1 '></span> <span class='_mcp_t1 ms-font-weight-semibold ms-font-color-black _mcp_x1 '></span> </div> <div class='_mcp_g1 _mcp_h1 _mcp_l1 ms-border-color-neutralTertiary'> <div class='_mcp_y1'> <span class='_mcp_Y1'></span> <span autoid=\"_mcp_h\" class='_mcp_X1'></span> <span autoid=\"_mcp_i\" class='_mcp_X1'></span> <span class='_mcp_X1'></span> <div class='_mcp_W1'> <input autoid=\"_mcp_j\" class='_mcp_C1 _mcp_D1 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div class='_mcp_b2'> <div class='_mcp_k1'></div> <div class='_mcp_k1'></div> <div class='_mcp_k1'></div> <div class='_mcp_k1'></div> </div> <div class='_mcp_H1 ms-font-weight-regular ms-font-color-neutralPrimary'></div> </div> <span></span> <span></span> <div class='_mcp_M1'></div> <div class='_mcp_82 ms-border-color-neutralTertiary'></div> </div> </div> <div></div> <div class='_mcp_02 ms-bg-color-white'></div> <div autoid=\"_mcp_n\"></div> <div autoid=\"_mcp_o\"></div> <div></div> <div></div> <div></div>  <div autoid=\"_mcp_p\"></div> <div autoid=\"_mcp_q\"></div>      </div><div> <div class='_mcp_R2 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_s\" type='button' class='ms-font-weight-semibold ms-font-s _mcp_E2'></button> <div class='_mcp_U2'></div> <div class='_mcp_B2'></div> <div class='_mcp_B2'></div> <div></div> </div><div> <span class='_mcp_I2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_M2'> <span autoid=\"_mcp_y\" class='_mcp_J2 ms-font-weight-regular ms-font-color-black'></span> </div> </div><div> <span class='_mcp_13'></span> <span class='_mcp_13'></span> </div><div> <span class='_mcp_13'></span> </div><div> <span class='_mcp_I2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_M2'> <div> <span class='_mcp_13 _mcp_03 ms-font-weight-regular ms-font-color-neutralSecondary _mcp_23'></span> <div></div> </div> </div> </div><div> <span class='_mcp_I2 ms-font-weight-semibold ms-font-color-black'></span> <div class='_mcp_M2'> <span autoid=\"_mcp_z\" class='_mcp_03 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div> </div><div> <span class='_mcp_I2 ms-font-weight-semibold ms-font-color-black _mcp_K2'></span> <div class='_mcp_M2'> <div class='_mcp_s2'></div> </div> </div><div> <div></div> </div><div> <span class='_mcp_n2'></span> <span class='_mcp_n2'></span> <button type='button' class='ms-font-s ms-font-weight-regular _mcp_n2'></button> <button type='button' class='ms-font-s ms-font-weight-regular _mcp_n2'></button> <button type='button' class='_mcp_n2 ms-border-color-neutralTertiary _mcp_o2'></button> </div><div> <div class='_mcp_m2'></div> </div><div> <div class='_mcp_d3'></div> <span class='_mcp_d3'></span> <div class='_mcp_d2 _mcp_x2 ms-border-color-neutralLight'> <div class='_mcp_e2 _mcp_i3'></div> <div class='_mcp_e2 _mcp_f2 ms-bg-color-white'> <div class='_mcp_h2'> <div class='_mcp_l2 ms-font-weight-regular'></div> </div> <div> <div class='_mcp_g2'> <div class='ms-bg-color-white customScrollBar _mcp_z2'>  <div class='_mcp_u2'> <div></div>  </div> <div> <div class='_mcp_p2 _mcp_q2 _mcp_x2 ms-border-color-neutralLight'></div> <div class='_mcp_p2 _mcp_t2'> <button autoid=\"_mcp_t\" type='button' class='_mcp_H2 ms-font-weight-semibold ms-font-s _mcp_g3'></button> <div class='_mcp_M2 _mcp_N2'> <div autoid=\"_mcp_u\" class='_mcp_a3'></div> </div> <div class='_mcp_M2 _mcp_N2 _mcp_O2'> <div class='_mcp_a3'></div> </div> <div></div>  </div> <div class='_mcp_p2 _mcp_t2 _mcp_y2 ms-border-color-neutralLight'> <button type='button' class='_mcp_H2 ms-font-weight-semibold ms-font-s _mcp_g3'></button> <div class='_mcp_M2 _mcp_N2'> <div autoid=\"_mcp_v\" class='_mcp_a3'></div> </div> <div class='_mcp_M2 _mcp_O2'> <div class='_mcp_a3'></div> </div>  </div> <div class='_mcp_p2 _mcp_t2 _mcp_y2 ms-border-color-neutralLight'> <button type='button' class='_mcp_H2 ms-font-weight-semibold ms-font-s _mcp_g3'></button> <div class='_mcp_M2 _mcp_N2'> <div autoid=\"_mcp_w\" class='_mcp_a3'></div> </div> <div class='_mcp_M2 _mcp_O2'> <div class='_mcp_a3'></div> </div>  </div> <div class='_mcp_p2'> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black _mcp_L2 '></span> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black _mcp_L2 '></span> </div> <div class='_mcp_p2 _mcp_r2 _mcp_x2 ms-border-color-neutralTertiary'> <span class='_mcp_H2 ms-font-weight-semibold ms-font-color-black _mcp_L2'></span> <div class='_mcp_M2'> <div class='_mcp_a3'> <input autoid=\"_mcp_x\" class='_mcp_R2 _mcp_S2 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> <div> <div class='_mcp_w2'></div> <div class='_mcp_w2'></div> <div class='_mcp_w2'></div> <div class='_mcp_w2'></div> </div> </div> </div> <div class='_mcp_x2 ms-border-color-themeTertiary'></div> </div> <span></span> <span></span> <div class='_mcp_A2'> <div>  <div class='_mcp_W2 ms-font-weight-regular ms-font-color-neutralPrimary _mcp_X2 ms-border-color-neutralLight'></div> </div> <div></div> <div class='_mcp_33'> <div></div> </div> <div class='_mcp_m3'> <button autoid=\"_mcp_A\" type='button' class='ms-font-s ms-font-weight-regular'></button> <div></div> </div> <div class='_mcp_n3'></div> </div> </div> <div class='_mcp_h2 _mcp_y2 ms-bg-color-white'> <div class='_mcp_o3 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_q3'></div> <div class='_mcp_p3'></div> <div class='_mcp_r3'></div> </div> <div class='_mcp_j2'>  <button type='button' class='_mcp_83'></button> <button type='button' class='_mcp_83'></button> <button type='button' class='_mcp_83'></button> <button type='button' class='_mcp_93'></button> <button type='button' class='_mcp_93 _mcp_t3'></button> <div></div> <button type='button' class='_mcp_93'></button> <button type='button' class='_mcp_93'></button> <button type='button' class='_mcp_93'></button> <button type='button' class='_mcp_93'></button> <span class='_mcp_v3 ms-font-weight-semilight ms-font-color-neutralSecondary'></span>  <div class='_mcp_w3'></div> <div class='_mcp_w3'></div> </div> <div class='_mcp_k2 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> </div> </div> <div></div> <div class='_mcp_e3 ms-bg-color-white'></div> <div autoid=\"_mcp_B\"></div> <div></div> <div></div> <div autoid=\"_mcp_C\"></div> <div autoid=\"_mcp_D\"></div>  </div><div> <span class='_mcp_F3 _mcp_G3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_I3'></div> </div><div> <span class='_mcp_L3'></span> <span class='_mcp_L3'></span> <button type='button' class='ms-font-s ms-font-weight-regular ms-font-color-neutralPrimary _mcp_L3 _mcp_M3'></button> </div><div> <span class='_mcp_F3 _mcp_G3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_B3'></div> </div><div> <span class='_mcp_F3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_C3'></div> </div><div> <span class='_mcp_F3 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_D3'></div> </div><div> <div class='_mcp_z3 _mcp_y3'> <div class='_mcp_A3'>  <div class='_mcp_B3'></div>  <div class='_mcp_C3'></div>  <div class='_mcp_D3'></div> </div> </div> <span>\n                ...\n            </span> </div><div> <div class='ms-font-color-neutralSecondary ms-font-s _mcp_H3'> <div class='_mcp_I3'></div> <div class='_mcp_I3'></div> <div class='_mcp_J3'></div> </div>  </div><div> <div class='_mcp_k4 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralSecondaryAlt'></div> </div><div> <button autoid=\"_mcp_E\" type='button' class='_mcp_74 ms-font-weight-semibold ms-font-s'></button> <div class='_mcp_n4'></div> <div class='_mcp_34'></div> <div class='_mcp_34'></div> <div></div> </div><div> <button autoid=\"_mcp_M\" type='button'></button> <div></div> </div><div> <span class='_mcp_94 ms-font-weight-regular'></span> <span class='_mcp_84'></span> </div><div> <iframe autoid=\"_mcp_R\" class='_mcp_L4'></iframe> </div><div> <div class='_mcp_M4'> <button type='button' class='_mcp_N4 _mcp_A4 ms-font-weight-regular'></button> <span></span> </div> </div><div> <button type='button' class='_mcp_a4 ms-font-s ms-font-weight-regular'></button> <button type='button' class='_mcp_a4 ms-font-s ms-font-weight-regular'></button> </div><div> <div class='_mcp_V4'></div> </div><div> <div class='_mcp_G4'></div> <span class='_mcp_G4'></span> <div class='_mcp_V3 ms-bg-color-white'> <div class='_mcp_J4'></div> <div></div> <div class='_mcp_W3 ms-font-weight-regular ms-font-color-neutralSecondary'></div> </div> <div class='_mcp_O3'> <div class='_mcp_P3 _mcp_K4'></div> <div></div> <div class='ms-border-color-neutralTertiary ms-bg-color-white _mcp_Q3'></div> <div class='_mcp_P3'> <div class='_mcp_T3'> <div class='_mcp_U3 ms-bg-color-white customScrollBar'>  <div class='_mcp_Y3 ms-font-weight-regular'></div> <div class='_mcp_Z3 _mcp_24 ms-border-color-neutralTertiaryAlt _mcp_14'></div> <div class='_mcp_Z3 _mcp_14 _mcp_24 ms-border-color-neutralTertiaryAlt'> <button autoid=\"_mcp_F\" type='button' class='_mcp_a4 ms-font-weight-semibold ms-font-s _mcp_I4'></button> <div class='_mcp_f4 _mcp_h4 _mcp_g4'> <div></div> <div autoid=\"_mcp_G\" class='_mcp_D4'></div> </div> <div class='_mcp_f4 _mcp_h4 _mcp_g4 _mcp_i4'> <div class='_mcp_D4'></div> </div>  </div> <div class='_mcp_Z3 _mcp_14 _mcp_24 ms-border-color-neutralTertiaryAlt'> <button type='button' class='_mcp_a4 ms-font-weight-semibold ms-font-s _mcp_I4'></button> <div class='_mcp_f4 _mcp_h4 _mcp_g4'> <div autoid=\"_mcp_H\" class='_mcp_D4'></div> </div> <div class='_mcp_f4 _mcp_h4 _mcp_g4 _mcp_i4'> <div class='_mcp_D4'></div> </div>  </div> <div class='_mcp_Z3 _mcp_14 _mcp_24 ms-border-color-neutralTertiaryAlt'> <button type='button' class='_mcp_a4 ms-font-weight-semibold ms-font-s _mcp_I4'></button> <div class='_mcp_f4 _mcp_h4 _mcp_g4'> <div autoid=\"_mcp_I\" class='_mcp_D4'></div> </div> <div class='_mcp_f4 _mcp_h4 _mcp_g4 _mcp_i4'> <div class='_mcp_D4'></div> </div>  </div> <div class='_mcp_Z3'> <span class='_mcp_a4 ms-font-weight-semibold ms-font-color-black _mcp_e4 '></span> <span class='_mcp_a4 ms-font-weight-semibold ms-font-color-black _mcp_e4 '></span> </div> <div class='_mcp_Z3 _mcp_04'> <div class='_mcp_f4'> <span class='_mcp_F4'></span> <span autoid=\"_mcp_J\" class='_mcp_E4'></span> <span autoid=\"_mcp_K\" class='_mcp_E4'></span> <span class='_mcp_E4'></span> <div class='_mcp_D4'> <input autoid=\"_mcp_L\" class='_mcp_j4 _mcp_l4 ms-font-weight-regular ms-bg-color-white-hover ms-font-color-neutralPrimary'/> </div> </div> </div> </div> <span></span> <span></span> <div> <div class='_mcp_Y4 _mcp_W4 ms-bg-color-white'></div> </div> <div class='_mcp_x4'> <div class='_mcp_v4 _mcp_05 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_p4 ms-font-weight-regular ms-font-color-neutralPrimary ms-border-color-neutralTertiaryAlt'></div> <div></div> <div></div> <div class='_mcp_P4'></div> </div> <div class='_mcp_O4 ms-border-color-neutralTertiary'></div> <div class='_mcp_Z4 _mcp_W4 ms-bg-color-white'> <div class='_mcp_R4 ms-border-color-neutralTertiaryAlt'> <div class='_mcp_T4'></div> <div class='_mcp_S4'></div> <div class='_mcp_U4'></div> </div> <div class='_mcp_X4'>  <button type='button' class='_mcp_45'></button> <button type='button' class='_mcp_45'></button> <button type='button' class='_mcp_45'></button> <button type='button' class='_mcp_55'></button> <button type='button' class='_mcp_55'></button> <div></div> <button type='button' class='_mcp_55'></button> <button type='button' class='_mcp_55'></button> <button type='button' class='_mcp_55'></button> <button type='button' class='_mcp_55'></button> <span class='_mcp_35 ms-font-weight-semilight ms-font-color-neutralSecondary'></span>  <div class='_mcp_65'></div> <div class='_mcp_65'></div> </div> </div> </div> </div> </div> <div class='ms-border-color-neutralTertiary ms-bg-color-white _mcp_15'></div> </div> <div></div> <div class='_mcp_H4 ms-bg-color-white'></div> <div autoid=\"_mcp_N\"></div> <div autoid=\"_mcp_O\"></div> <div></div> <div></div> <div></div>  <div autoid=\"_mcp_P\"></div> <div autoid=\"_mcp_Q\"></div>      </div><div> <button autoid=\"_mcp_V\" type='button' class='_mcp_a5'></button> <button autoid=\"_mcp_W\" type='button' class='_mcp_a5'></button> </div><div> <span class='_mcp_85 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div autoid=\"_mcp_S\" class='_mcp_95'></div> <button autoid=\"_mcp_T\" type='button' class='_mcp_a5'></button> <button autoid=\"_mcp_U\" type='button' class='_mcp_a5'></button>  <div></div> <div class='_mcp_b5'></div>  </div><div> <span class='_mcp_c5 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_d5'></div> <button type='button' class='_mcp_e5'></button> <button type='button' class='_mcp_e5'></button>  </div><div> <div class='_mcp_h5'> <label></label> </div> <div class='_mcp_h5'> <label class='_mcp_n5'></label> <div class='_mcp_l5'> <input class='_mcp_j5'/> <input class='_mcp_j5'/> <input class='_mcp_j5'/> </div> </div> </div><div> <span class='_mcp_f5 ms-font-weight-regular ms-font-color-neutralPrimary'></span> <div class='_mcp_i5'></div> <span class='_mcp_g5 ms-font-weight-regular ms-font-color-neutralPrimary'></span> </div><div> <div class='_mcp_u5'> <button type='button' class='_mcp_q5'></button> <span class='_mcp_t5 ms-font-xxl ms-font-color-neutralPrimary'></span> </div>  <div class='_mcp_r5'> <div class='ms-border-color-neutralTertiaryAlt _mcp_s5'></div> </div> <div class='_mcp_o5'> <button type='button' class='_mcp_p5'></button> <button type='button' class='_mcp_p5'></button> </div> </div><div> <span></span>  </div><div> <div class='_mcp_v5 ms-font-s ms-font-weight-regular ms-font-color-neutralSecondaryAlt InfobarImmediateTextContainer'> <div> <span class='_mcp_w5'></span> <a class='_mcp_x5 ms-font-weight-regular ms-font-color-themeDarkAlt ms-font-s'></a> <a class='_mcp_x5 ms-font-weight-regular ms-font-color-themeDarkAlt ms-font-s'></a> </div> <div> <div class='_mcp_z5'></div> <span class='_mcp_w5 ms-font-color-neutralDark'></span> </div> <div> <span class='_mcp_w5'></span> </div> <button type='button' class='_mcp_y5'></button> </div> </div><div>  <div class='_mcp_C5'>  <div class='_mcp_D5 ms-bg-color-themePrimary'> <div class='_mcp_H5'> <span class='segoeui-light ms-font-xxl ms-font-color-white'></span> </div> <div class='_mcp_J5'> <div class='_mcp_O5'> <div class='_mcp_P5'> <div class='_mcp_Q5'></div> </div> </div> <div class='_mcp_R5 ms-bg-color-themeLighter'> <span class='segoeui-semibold ms-font-m ms-font-color-themePrimary'></span> </div> </div> <div class='_mcp_I5'> <span class='segoeui-semilight ms-font-m ms-font-color-white'></span> <a class='_mcp_S5 segoeui-semilight ms-font-m ms-font-color-white'></a> </div> </div>  <div class='_mcp_E5'> <div class='_mcp_F5'></div> <div class='_mcp_G5'></div> </div> </div> </div><div> <div pictureSize=\"30\"> <span class='_mcp_N5'></span> </div> </div><div> <div class='_mcp_M5'></div> </div><div> <div> <div class='_mcp_A5 ms-bgc-w'></div> <span class='_mcp_B5 ms-bgc-tp'></span> </div>   </div>";_j.h.a().appendChild(n);return n};_mcp.a.gD=function(n){return n.e()};_mcp.a.gE=function(n){return n.f()};_mcp.a.gB=function(n){return n.b};_mcp.a.gC=function(n){return n.c};_mcp.a.hj=function(n){return n.b};_mcp.a.hi=function(n){return n.a};_mcp.a.d=function(n){return n.bc()};_mcp.a.G=function(n){return _mcp.f.isInstanceOfType(n)?n.bp:null};_mcp.a.dg=function(n){return n.n()};_mcp.a.bg=function(n){return n.cx()};_mcp.a.bf=function(n){return n.a()};_mcp.a.F=function(n){return n.q()};_mcp.a.bh=function(n){return n.k()};_mcp.a.dh=function(n){return n.y()};_mcp.a.e=function(n){return n.ba};_mcp.a.be=function(n){return n.s()};_mcp.a.gc=function(n){return _mcp.m.isInstanceOfType(n)?n.gM():null};_mcp.a.U=function(n){return n.bC()};_mcp.a.Q=function(n){return n.a()};_mcp.a.v=function(n){return n.ec()};_mcp.a.ej=function(n){return n.e()};_mcp.a.bS=function(n){return n.W()};_mcp.a.bY=function(n){return n.a()};_mcp.a.bZ=function(n){return _mcp.h.isInstanceOfType(n)?n.j():null};_mcp.a.ev=function(n){return _mcp.b.isInstanceOfType(n)?_u.P.P:null};_mcp.a.ei=function(n){return n.c()};_mcp.a.eh=function(n){return n.b()};_mcp.a.L=function(n){return n.bQ()};_mcp.a.eo=function(n){return n.a()};_mcp.a.dk=function(n){return n.f()};_mcp.a.dj=function(n){return n.c()};_mcp.a.gy=function(n){return n.c()};_mcp.a.dB=function(n){return n.bd};_mcp.a.dA=function(n){return n.u()};_mcp.a.x=function(n){return n.cc};_mcp.a.gd=function(n){return n.df};_mcp.a.fI=function(n){return _a.g.b};_mcp.a.w=function(n){return n.bv()};_mcp.a.N=function(n){return n.a()};_mcp.a.bW=function(n){return n.b()};_mcp.a.hl=function(n){return n.eW()};_mcp.a.dw=function(n){return n.cN};_mcp.a.bQ=function(n){return n.ca};_mcp.a.ez=function(n){return n.bJ()};_mcp.a.gK=function(n){return n.a()};_mcp.a.bo=function(n){return n.bl()};_mcp.a.cp=function(n){return n.e()};_mcp.a.y=function(n){return n.bh()};_mcp.a.cr=function(n){return _mcp.u.isInstanceOfType(n)?n.z:null};_mcp.a.cs=function(n){return n.dp()};_mcp.a.bm=function(n){return n.a()};_mcp.a.co=function(n){return n.x()};_mcp.a.m=function(n){return n.X};_mcp.a.bE=function(n){return _mcp.m.isInstanceOfType(n)?n.cU:null};_mcp.a.J=function(n){return _mcp.m.isInstanceOfType(n)?n.br:null};_mcp.a.bP=function(n){return n.bb};_mcp.a.q=function(n){return n.dY()};_mcp.a.bD=function(n){return n.dZ()};_mcp.a.ga=function(n){return n.eI()};_mcp.a.bk=function(n){return n.D()};_mcp.a.T=function(n){return n.o()};_mcp.a.K=function(n){return n.Q()};_mcp.a.j=function(n){return n.dW()};_mcp.a.s=function(n){return n.w()};_mcp.a.hJ=function(n){return n.gN()};_mcp.a.ew=function(n){return n.eZ()};_mcp.a.Z=function(n){return n.a};_mcp.a.bV=function(n){return _rw.b.isInstanceOfType(n)?n.el():null};_mcp.a.Y=function(n){return n.b};_mcp.a.S=function(n){return n.l()};_mcp.a.hI=function(n){return n.fK()};_mcp.a.bM=function(n){return n.R()};_mcp.a.R=function(n){return n.p()};_mcp.a.hH=function(n){return n.fJ()};_mcp.a.bl=function(n){return n.br()};_mcp.a.bO=function(n){return n.cu()};_mcp.a.gH=function(n){return n.e()};_mcp.a.cm=function(n){return n.a()};_mcp.a.dW=function(n){return n.r()};_mcp.a.dV=function(n){return n.o()};_mcp.a.cu=function(n){return n.dV()};_mcp.a.cn=function(n){return n.a()};_mcp.a.cl=function(n){return n.X()};_mcp.a.bH=function(n){return n.b};_mcp.a.dm=function(n){return _mcp.b.isInstanceOfType(n)?255:null};_mcp.a.dU=function(n){return n.bu()};_mcp.a.dR=function(n){return n.bE()};_mcp.a.C=function(n){return n.bd()};_mcp.a.bB=function(n){return n.a()};_mcp.a.gx=function(n){return n.n()};_mcp.a.H=function(n){return _mcp.b.isInstanceOfType(n)?n.fX():null};_mcp.a.cb=function(n){return _mcp.b.isInstanceOfType(n)?n.fV():null};_mcp.a.cY=function(n){return n.C()};_mcp.a.cL=function(n){return n.ck()};_mcp.a.cX=function(n){return n.l()};_mcp.a.cM=function(n){return n.cX()};_mcp.a.dp=function(n){return n.bH()};_mcp.a.dc=function(n){return n.b()};_mcp.a.cK=function(n){return n.ce};_mcp.a.eI=function(n){return n.cq()};_mcp.a.eH=function(n){return n.bP()};_mcp.a.dn=function(n){return n.dS()};_mcp.a.di=function(n){return n.b()};_mcp.a.fh=function(n){return n.dp()};_mcp.a.dt=function(n){return n.bk};_mcp.a.gL=function(n){return n.h()};_mcp.a.gM=function(n){return n.i()};_mcp.a.t=function(n){return n.c()};_mcp.a.gG=function(n){return n.c()};_mcp.a.by=function(n){return n.p};_mcp.a.bz=function(n){return n.w};_mcp.a.bv=function(n){return n.o};_mcp.a.bw=function(n){return n.x};_mcp.a.bx=function(n){return n.n};_mcp.a.du=function(n){return n.bV()};_mcp.a.df=function(n){return n.a()};_mcp.a.bK=function(n){return n.C};_mcp.a.bF=function(n){return n.bQ};_mcp.a.ex=function(n){return n.bW()};_mcp.a.el=function(n){return n.a()};_mcp.a.hn=function(n){return n.bK};_mcp.a.A=function(n){return n.ea()};_mcp.a.ca=function(n){return _mcp.f.isInstanceOfType(n)?n.cm:null};_mcp.a.I=function(n){return n.dr()};_mcp.a.fp=function(n){return n.i()};_mcp.a.fn=function(n){return n.f()};_mcp.a.fo=function(n){return n.h()};_mcp.a.bX=function(n){return n.bF()};_mcp.a.es=function(n){return _mcp.f.isInstanceOfType(n)?n.eA():null};_mcp.a.em=function(n){return n.C()};_mcp.a.hp=function(n){return n.dt()};_mcp.a.eN=function(n){return n.j};_mcp.a.gg=function(n){return n.fL()};_mcp.a.dq=function(n){return n.br()};_mcp.a.de=function(n){return n.a()};_mcp.a.P=function(n){return n.bo()};_mcp.a.ds=function(n){return n.eb()};_mcp.a.fm=function(n){return n.a()};_mcp.a.gf=function(n){return n.gO()};_mcp.a.fl=function(n){return n.b()};_mcp.a.bn=function(n){return _mcp.f.isInstanceOfType(n)?n.ea():null};_mcp.a.D=function(n){return n.bq()};_mcp.a.bN=function(n){return n.a()};_mcp.a.gO=function(n){return _mcp.n.isInstanceOfType(n)?n.M:null};_mcp.a.dS=function(n){return n.W()};_mcp.a.ft=function(n){return _mcp.n.isInstanceOfType(n)?n.Q:null};_mcp.a.fk=function(n){return n.i()};_mcp.a.gz=function(n){return n.a()};_mcp.a.ec=function(n){return n.k()};_mcp.a.hm=function(n){return n.eX()};_mcp.a.cv=function(n){return n.bn()};_mcp.a.gI=function(n){return n.b()};_mcp.a.cc=function(n){return n.cJ};_mcp.a.eb=function(n){return n.j()};_mcp.a.fg=function(n){return n.x()};_mcp.a.hk=function(n){return n.bU};_mcp.a.gw=function(n){return n.i()};_mcp.a.dX=function(n){return n.p};_mcp.a.ci=function(n){return n.x.length};_mcp.a.er=function(n){return _mcp.f.isInstanceOfType(n)?n.eb():null};_mcp.a.et=function(n){return _mcp.f.isInstanceOfType(n)?n.ec():null};_mcp.a.eq=function(n){return _mcp.f.isInstanceOfType(n)?n.dW():null};_mcp.a.ep=function(n){return _mcp.f.isInstanceOfType(n)?n.dV():null};_mcp.a.dT=function(n){return n.bL()};_mcp.a.gh=function(n){return n.fN()};_mcp.a.ct=function(n){return n.cv()};_mcp.a.eJ=function(n){return n.dh};_mcp.a.ge=function(n){return n.bR};_mcp.a.eu=function(n){return _mcp.b.isInstanceOfType(n)?n.fz():null};_mcp.a.dr=function(n){return n.bs()};_mcp.a.ey=function(n){return n.cK};_mcp.a.dY=function(n){return n.f()};_mcp.a.dZ=function(n){return n.h()};_mcp.a.fu=function(n){return _mcp.w.isInstanceOfType(n)?n.m:null};_mcp.a.fv=function(n){return _mcp.w.isInstanceOfType(n)?n.r:null};_mcp.a.ck=function(n){return n.z};_mcp.a.en=function(n){return n.f()};_mcp.a.dO=function(n){return n.i()};_mcp.a.dP=function(n){return n.j()};_mcp.a.dM=function(n){return n.g()};_mcp.a.dN=function(n){return n.h()};_mcp.a.ee=function(n){return n.b()};_mcp.a.ed=function(n){return n.a()};_mcp.a.fe=function(n){return n.t()};_mcp.a.fz=function(n){return _mcp.r.isInstanceOfType(n)?n.z:null};_mcp.a.ce=function(n){return n.cj};_mcp.a.fq=function(n){return n.A()};_mcp.a.fd=function(n){return n.o()};_mcp.a.fW=function(n){return n.gA()};_mcp.a.bC=function(n){return n.eY()};_mcp.a.fX=function(n){return n.fs()};_mcp.a.fx=function(n){return _mcp.x.isInstanceOfType(n)?n.u:null};_mcp.a.fy=function(n){return _mcp.x.isInstanceOfType(n)?n.k():null};_mcp.a.gP=function(n){return _mcp.r.isInstanceOfType(n)?n.r:null};_mcp.a.cw=function(n){return n.dB()};_mcp.a.fY=function(n){return n.ft()};_mcp.a.gS=function(n){return _mcp.u.isInstanceOfType(n)?n.C:null};_mcp.a.fs=function(n){return _mcp.n.isInstanceOfType(n)?n.D:null};_mcp.a.fj=function(n){return n.h()};_mcp.a.cd=function(n){return n.bB};_mcp.a.gb=function(n){return n.v()};_mcp.a.dv=function(n){return n.fa()};_mcp.a.fr=function(n){return n.a()};_mcp.a.fZ=function(n){return n.fu()};_mcp.a.gQ=function(n){return _mcp.r.isInstanceOfType(n)?n.y:null};_mcp.a.bu=function(n){return n.q()};_mcp.a.dl=function(n){return _mcp.y.isInstanceOfType(n)?n.v:null};_mcp.a.ff=function(n){return n.v()};_mcp.a.hq=function(n){return n.ek()};_mcp.a.gR=function(n){return n.bm};_mcp.a.cq=function(n){return n.d};_mcp.a.fB=function(n){return n.bl};_mcp.a.fA=function(n){return n.bn};_mcp.a.fi=function(n){return n.a()};_mcp.a.hD=function(n){return n.a};_mcp.a.fC=function(n){return _mcp.f.isInstanceOfType(n)?n.dY():null};_mcp.a.ho=function(n){return n.bm()};_mcp.a.fU=function(n){return n.fq()};_mcp.a.fV=function(n){return n.fr()};_mcp.a.hG=function(n){return n.bu};_mcp.a.hF=function(n){return n.cq()};_mcp.a.hE=function(n){return n.bP()};_mcp.a.gJ=function(n){return n.j()};_mcp.a.gA=function(n){return n.y()};_mcp.a.hs=function(n){return n.b};_mcp.a.ht=function(n){return n.i};_mcp.a.hu=function(n){return n.c};_mcp.a.hv=function(n){return n.j};_mcp.a.fM=function(n){return n.r()};_mcp.a.fL=function(n){return n.d};_mcp.a.eO=function(n){return n.b()};_mcp.a.fJ=function(n){return n.e};_mcp.a.fN=function(n){return!_a.g.b};_mcp.a.fK=function(n){return n.f};_mcp.a.fO=function(n){return!_a.g.b};_mcp.a.hr=function(n){return n.h};_mcp.a.fS=function(n){return n.l()};_mcp.a.dx=function(n){return n.c};_mcp.a.eB=function(n){return n.d()};_mcp.a.eD=function(n){return n.a};_mcp.a.eC=function(n){return n.e()};_mcp.a.eF=function(n){return n.d};_mcp.a.dC=function(n){return n.t()};_mcp.a.eA=function(n){return n.c};_mcp.a.dy=function(n){return n.e};_mcp.a.dz=function(n){return n.f};_mcp.a.hz=function(n){return n.a};_mcp.a.gn=function(n){return n.a()};_mcp.a.hy=function(n){return n.g};_mcp.a.fT=function(n){return n.m()};_mcp.a.hB=function(n){return n.a};_mcp.a.hC=function(n){return n.n()};_mcp.a.gV=function(n){return n.g};_mcp.a.gZ=function(n){return n.E()};_mcp.a.fF=function(n){return n.d};_mcp.a.fE=function(n){return n.C()};_mcp.a.hd=function(n){return n.f};_mcp.a.gt=function(n){return n.b()};_mcp.a.gq=function(n){return n.z};_mcp.a.ha=function(n){return n.l};_mcp.a.fG=function(n){return n.h};_mcp.a.gY=function(n){return n.A()};_mcp.a.gT=function(n){return n.f};_mcp.a.gU=function(n){return n.x()};_mcp.a.gX=function(n){return n.k};_mcp.a.gW=function(n){return n.y()};_mcp.a.fD=function(n){return n.z()};_mcp.a.hc=function(n){return n.t()};_mcp.a.hg=function(n){return n.x()};_mcp.a.hf=function(n){return n.w()};_mcp.a.he=function(n){return n.s};_mcp.a.hb=function(n){return n.d};_mcp.a.fH=function(n){return _mcp.K.isInstanceOfType(n)?n.v():null};_mcp.a.gv=function(n){return n.bd()};_mcp.a.h=function(n,t){n.a(t)};_mcp.a.i=function(n,t){n.T(t)};_mcp.a.f=function(n,t){n.ba(t)};_mcp.a.n=function(n,t){n.l(t)};_mcp.a.l=function(n,t){n.k(t)};_mcp.a.k=function(n,t){n.Q(t)};_mcp.a.bj=function(n,t){n.c(t)};_mcp.a.X=function(n,t){n.r(t)};_mcp.a.bi=function(n,t){n.j(t)};_mcp.a.b=function(n,t){n.J(t)};_mcp.a.ek=function(n,t){n.f(t)};_mcp.a.dK=function(n,t){n.a(t)};_mcp.a.E=function(n,t){n.m(t)};_mcp.a.W=function(n,t){n.s(t)};_mcp.a.M=function(n,t){n.b(t)};_mcp.a.br=function(n,t){n.d(t)};_mcp.a.z=function(n,t){n.a(t)};_mcp.a.cH=function(n,t){n.c(t)};_mcp.a.o=function(n,t){n.k=t};_mcp.a.O=function(n,t){n.m=t};_mcp.a.bt=function(n,t){n.l=t};_mcp.a.cJ=function(n,t){n.e(t)};_mcp.a.r=function(n,t){n.Q(t)};_mcp.a.bR=function(n,t){n.h(t)};_mcp.a.db=function(n,t){n.z(t)};_mcp.a.bJ=function(n,t){n.c(t)};_mcp.a.bI=function(n,t){n.a(t)};_mcp.a.gF=function(n,t){n.x(t)};_mcp.a.cj=function(n,t){n.gp(t)};_mcp.a.cR=function(n,t){n.il(t)};_mcp.a.da=function(n,t){n.w(t)};_mcp.a.cO=function(n,t){n.cJ(t)};_mcp.a.cZ=function(n,t){n.n(t)};_mcp.a.cQ=function(n,t){n.cY(t)};_mcp.a.dd=function(n,t){n.a(t)};_mcp.a.cN=function(n,t){n.bO(t)};_mcp.a.cP=function(n,t){n.cq=t};_mcp.a.cT=function(n,t){n.cf(t)};_mcp.a.cS=function(n,t){n.cS=t};_mcp.a.cU=function(n,t){n.Q=t};_mcp.a.cW=function(n,t){n.bM(t)};_mcp.a.cV=function(n,t){n.bL(t)};_mcp.a.cI=function(n,t){n.bV(t)};_mcp.a.dH=function(n,t){n.a(t)};_mcp.a.bU=function(n,t){n.d(t)};_mcp.a.bT=function(n,t){n.j(t)};_mcp.a.gN=function(n,t){n.k(t)};_mcp.a.u=function(n,t){n.a(t)};_mcp.a.bA=function(n,t){n.f(t)};_mcp.a.bb=function(n,t){n.l(t)};_mcp.a.bc=function(n,t){n.i(t)};_mcp.a.bs=function(n,t){n.n(t)};_mcp.a.ba=function(n,t){n.j(t)};_mcp.a.bL=function(n,t){n.y(t)};_mcp.a.bG=function(n,t){n.dF(t)};_mcp.a.eS=function(n,t){n.a(t)};_mcp.a.eU=function(n,t){n.E(t)};_mcp.a.p=function(n,t){n.bn(t)};_mcp.a.V=function(n,t){n.dq(t)};_mcp.a.bp=function(n,t){n.a=t};_mcp.a.eT=function(n,t){n.s(t)};_mcp.a.fb=function(n,t){n.i=t};_mcp.a.fc=function(n,t){n.g=t};_mcp.a.gi=function(n,t){n.dr(t)};_mcp.a.dJ=function(n,t){n.cS(t)};_mcp.a.dI=function(n,t){n.cn(t)};_mcp.a.dE=function(n,t){n.Q=t};_mcp.a.dG=function(n,t){n.R=t};_mcp.a.dF=function(n,t){n.bo=t};_mcp.a.ea=function(n,t){n.i(t)};_mcp.a.fw=function(n,t){n.s(t)};_mcp.a.ch=function(n,t){n.bC(t)};_mcp.a.dQ=function(n,t){n.k(t)};_mcp.a.eg=function(n,t){n.e(t)};_mcp.a.ef=function(n,t){n.c(t)};_mcp.a.eW=function(n,t){n.dI=t};_mcp.a.eX=function(n,t){n.bm(t)};_mcp.a.eV=function(n,t){n.e=t};_mcp.a.bq=function(n,t){n.p(t)};_mcp.a.fa=function(n,t){n.m=t};_mcp.a.eY=function(n,t){n.p=t};_mcp.a.eZ=function(n,t){n.br(t)};_mcp.a.bd=function(n,t){n.o(t)};_mcp.a.dL=function(n,t){n.Q(t)};_mcp.a.gl=function(n,t){n.x(t)};_mcp.a.hw=function(n,t){n.p(t)};_mcp.a.hx=function(n,t){n.q(t)};_mcp.a.eP=function(n,t){n.c(t)};_mcp.a.fR=function(n,t){n.o(t)};_mcp.a.eQ=function(n,t){n.d(t)};_mcp.a.fP=function(n,t){n.m(t)};_mcp.a.fQ=function(n,t){n.n(t)};_mcp.a.eR=function(n,t){n.a=t};_mcp.a.eE=function(n,t){n.f(t)};_mcp.a.eG=function(n,t){n.j(t)};_mcp.a.dD=function(n,t){n.l(t)};_mcp.a.hA=function(n,t){n.n(t)};_mcp.a.go=function(n,t){n.c(t)};_mcp.a.gs=function(n,t){n.g(t)};_mcp.a.hh=function(n,t){n.a(t)};_mcp.a.gu=function(n,t){n.a(t)};_mcp.a.gr=function(n,t){n.d(t)};_mcp.a.gm=function(n,t){n.bk(t)};_mcp.a.gp=function(n,t){n.b(t)};_mcp.a.B=function(){_mcp.a.cB||(_mcp.a.cB=new _fc.m);return _mcp.a.cB};_mcp.a.c=function(){_mcp.a.cx||(_mcp.a.cx=new _fc.k);return _mcp.a.cx};_mcp.a.cg=function(){_mcp.a.cE||(_mcp.a.cE=new _n.z);return _mcp.a.cE};_mcp.a.cG=function(){_mcp.a.cC||(_mcp.a.cC=new _b.bD);return _mcp.a.cC};_mcp.a.gj=function(){_mcp.a.cD||(_mcp.a.cD=new _n.bc);return _mcp.a.cD};_mcp.a.cf=function(){_mcp.a.cy||(_mcp.a.cy=new _fce.t);return _mcp.a.cy};_mcp.a.eK=function(){_mcp.a.cz||(_mcp.a.cz=new _fce.I);return _mcp.a.cz};_mcp.a.eL=function(){_mcp.a.cA||(_mcp.a.cA=new _fc.o);return _mcp.a.cA};_mcp.a.eM=function(){_mcp.a.cF||(_mcp.a.cF=new _mcp.bT);return _mcp.a.cF};_mcp.a._I=function(){var ut="AddOriginalAttachmentInfoBarView._tid1";new _j.d(ut,function(){_mcp.a.a[ut]===undefined&&(_mcp.a.a[ut]=[[[-1,0,["IncludeButtonText"],[_mcp.a.gD],null,"Text",null,_mcp.a.h,0,null,null,null]]]);var n=_mcp.a.g.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.N,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var rt="AddOriginalAttachmentInfoBarView._tid2";new _j.d(rt,function(){_mcp.a.a[rt]===undefined&&(_mcp.a.a[rt]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.LU]]]);var n=_mcp.a.g.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.N,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var et="AddOriginalAttachmentInfoBarView";new _j.d(et,function(){_mcp.a.a[et]===undefined&&(_mcp.a.a[et]=[[[-1,0,["InfoBarText"],[_mcp.a.gE],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["AddAttachmentCommand"],[_mcp.a.gB],null,"ClickCommand",null,_mcp.a.i,0,null,null,null]],null,[[-1,0,["DismissInfoBarCommand"],[_mcp.a.gC],null,"ClickCommand",null,_mcp.a.i,0,null,null,null]]]);var n=_mcp.a.g.childNodes[1].cloneNode(!0);var r=new _fc.e(_j.a.a(n,[0,3]));r.y("AddOriginalAttachmentInfoBarView._tid2");var i=new _fc.a(_j.a.a(n,[0,2]));i.a("|");var t=new _fc.e(_j.a.a(n,[0,1]));t.y("AddOriginalAttachmentInfoBarView._tid1");var u=new _fc.a(_j.a.a(n,[0,0]));return new _j.a(n,[u,t,i,r])},"",_mcp.N,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var ft="IrmDialogView";new _j.d(ft,function(){_mcp.a.a[ft]===undefined&&(_mcp.a.a[ft]=[[[-1,0,["Description"],[_mcp.a.hj],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["ConversationOwner"],[_mcp.a.hi],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.g.childNodes[2].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_mcp.bi,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var it="MailComposeView._tid3._tid5";new _j.d(it,function(){_mcp.a.a[it]===undefined&&(_mcp.a.a[it]=[[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.G],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var t=_mcp.a.g.childNodes[0].cloneNode(!0);var n=new _pe.d(t.children[0],_j.b.Instance.a(_a.q));n.j("_mcp_w ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.BasicDetailsPopup");n.S("MailCompose.FromRecipientWellButton");return new _j.a(t,[n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var g="MailComposeView._tid3._tid6";new _j.d(g,function(){_mcp.a.a[g]===undefined&&(_mcp.a.a[g]=[[[-1,0,["RecipientComponent","FromFindRecipientViewModel"],[_mcp.a.d,_mcp.a.dg],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var t=_mcp.a.g.childNodes[3].cloneNode(!0);var n=new _fp.f(t.children[0],_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.j));n.S("MailCompose.FromRecipientWellButton");return new _j.a(t,[n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var d="MailComposeView._tid3";new _j.d(d,function(){_mcp.a.a[d]===undefined&&(_mcp.a.a[d]=[[[-1,4,null,null,null,"ImageId",null,_mcp.a.n,0,null,null,null,_b.i.b()],[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_nbs.a.Om],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.no],[-1,5,["SendAsContextMenuComponent","Menu","IsShown"],[_mcp.a.bg,_mcp.a.bf,_mcp.a.F],null,"contextMenu",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.G],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.B(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.G],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.B(),null,!0]],[[-1,0,["RecipientComponent","FromPersonaViewModel"],[_mcp.a.d,_mcp.a.G],null,"IsHidden",null,_mcp.a.b,1,new _j.r([_mcp.a.B(),_mcp.a.c()],[null,null]),null,!0],[-1,5,["RecipientComponent","ShouldHighlightFromAsInvalid"],[_mcp.a.d,_mcp.a.dh],null,"_mcp_f",null,null,0,null,null,null]]]);var t=_mcp.a.g.childNodes[4].cloneNode(!0);var u=new _j.c(t.children[3]);u.y("MailComposeView._tid3._tid6");var f=new _j.c(t.children[2]);var r=new _j.c(t.children[1]);r.y("MailComposeView._tid3._tid5");var n=new _fc.b(t.children[0]);n.y("MailComposeView.FromButtonTemplate");n.f("ms-bg-color-neutralLighter");n.c("ms-bg-color-neutralLight");n.d("ms-font-color-white ms-bg-color-themePrimary");n.N("MailCompose.FromRecipientWellButton");n.A(0);var i=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.U(_j.f.a(["SendAsContextMenuComponent","Menu"],[_mcp.a.bg,_mcp.a.bf],null,"MenuDataContext",null,_mcp.a.bj,1)).U(_j.f.a(["SendAsContextMenuComponent","Menu","IsShown"],[_mcp.a.bg,_mcp.a.bf,_mcp.a.F],_mcp.a.X,"IsShown",_mcp.a.bh,_mcp.a.bi,2,null,null,!1));i.a=3;i.b=1;n.D([i]);return new _j.a(t,[n,r,f,u]).l({FromPersona:r})},"",_mcp.e,_mcp.i,function(n){return new _mcp.i(n)},!1,!0,!1,0,_mcp.a.a);var tt="MailComposeView._tidb";new _j.d(tt,function(){_mcp.a.a[tt]===undefined&&(_mcp.a.a[tt]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.P.b]],[[-1,0,["Context","Subject"],[_mcp.a.e,_mcp.a.be],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.n,0,null,null,null,_mcp.d.x()],[-1,1,["HideSubjectAffordanceButton"],[_mcp.a.gc],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]]]);var t=_mcp.a.g.childNodes[5].cloneNode(!0);var i=new _fc.b(_j.a.a(t,[1,1]));var n=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));n.U(_j.f.a(["ContextMenuComponent","Menu"],[_mcp.a.U,_mcp.a.Q],null,"MenuDataContext",null,_mcp.a.bj,1)).U(_j.f.a(["ContextMenuComponent","Menu","IsShown"],[_mcp.a.U,_mcp.a.Q,_mcp.a.F],_mcp.a.X,"IsShown",_mcp.a.bh,_mcp.a.bi,2,null,null,!1));n.a=3;n.b=5;i.D([n]);var u=new _fc.a(_j.a.a(t,[1,0]));var r=new _fc.a(t.children[0]);return new _j.a(t,[r,u,i])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var nt="MailComposeView._tidd._tide";new _j.d(nt,function(){_mcp.a.a[nt]===undefined&&(_mcp.a.a[nt]=[[[-1,0,["MeetingComponent","SenderDetailsViewModel"],[_mcp.a.v,_mcp.a.ej],_mcp.a.ek,"DataContext",_mcp.a.bS,_mcp.a.f,2,null,null,null]],[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp.a.v,_mcp.a.bY],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var i=_mcp.a.g.childNodes[6].cloneNode(!0);var t=new _pe.d(i.children[1],_j.b.Instance.a(_a.q));t.j("_mcp_l ms-font-weight-regular ms-font-color-black bidi");t.y("PersonaView.PresenceBasicDetailsPopup");var n=new _pe.d(i.children[0],_j.b.Instance.a(_a.q));n.j("_mcp_l ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _j.a(i,[n,t])},"",_mcp.e,_b.l,function(n){return new _b.l(n)},!1,!0,!1,0,_mcp.a.a);var ot="MailComposeView._tidd._tidf";new _j.d(ot,function(){_mcp.a.a[ot]===undefined&&(_mcp.a.a[ot]=[[[-1,0,["MeetingComponent","FromDetailsViewModel"],[_mcp.a.v,_mcp.a.bY],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var t=_mcp.a.g.childNodes[7].cloneNode(!0);var n=new _pe.d(t.children[0],_j.b.Instance.a(_a.q));n.j("_mcp_l ms-font-weight-regular ms-font-color-black bidi");n.y("PersonaView.PresenceBasicDetailsPopup");return new _j.a(t,[n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var yt="MailComposeView._tidd";new _j.d(yt,function(){_mcp.a.a[yt]===undefined&&(_mcp.a.a[yt]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.fK]],[[-1,4,null,null,null,"FormatString",null,_mcp.a.dK,0,null,null,null,_u.n.QJ],[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp.a.v,_mcp.a.bZ],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["MeetingComponent","IsMeetingForwardOnBehalfOf"],[_mcp.a.v,_mcp.a.bZ],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]]]);var n=_mcp.a.g.childNodes[8].cloneNode(!0);var i=new _j.c(_j.a.a(n,[1,1]));i.y("MailComposeView._tidd._tidf");var t=new _b.l(_j.a.a(n,[1,0]));t.y("MailComposeView._tidd._tide");var r=new _fc.a(n.children[0]);return new _j.a(n,[r,t,i])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var vt="MailComposeView._tidg";new _j.d(vt,function(){_mcp.a.a[vt]===undefined&&(_mcp.a.a[vt]=[[[-1,0,["Context","WhenLabel"],[_mcp.a.e,_mcp.a.ev],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["MeetingComponent","MeetingCalendarTimePeriod"],[_mcp.a.v,_mcp.a.ei],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.g.childNodes[9].cloneNode(!0);var i=new _fc.a(_j.a.a(n,[1,0]));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var wt="MailComposeView._tidh";new _j.d(wt,function(){_mcp.a.a[wt]===undefined&&(_mcp.a.a[wt]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.P.I]],[[-1,0,["MeetingComponent","LocationViewModel"],[_mcp.a.v,_mcp.a.eh],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var t=_mcp.a.g.childNodes[10].cloneNode(!0);var n=new _j.c(_j.a.a(t,[1,0]));n.y("LocationView");n.K(!0);var i=new _fc.a(t.children[0]);return new _j.a(t,[i,n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var pt="MailComposeView._tidj";new _j.d(pt,function(){_mcp.a.a[pt]===undefined&&(_mcp.a.a[pt]=[[[-1,4,null,null,null,"ImageId",null,_mcp.a.n,0,null,null,null,_b.i.a()],[-1,4,null,null,null,"HoveredImageId",null,_mcp.a.E,0,null,null,null,_n.b.f()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.W,0,null,null,null,_n.b.f()],[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_nbs.a.ly],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.ly],[-1,0,["UpgradeComponent","CompleteBodyUpgradeCommand"],[_mcp.a.L,_mcp.a.eo],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["UpgradeComponent","ShouldShowQuoteBodyButton"],[_mcp.a.L,_mcp.a.dk],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.M,0,null,null,0,0],[-1,4,null,null,null,"BusyText",null,_mcp.a.br,0,null,null,null,_nbs.a.ly],[-1,0,["UpgradeComponent","IsWaitingForQuotedBody"],[_mcp.a.L,_mcp.a.dj],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var t=_mcp.a.g.childNodes[11].cloneNode(!0);var n=new _fce.h(t.children[1],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));n.a=0;n.A(-1);var i=new _fc.b(t.children[0]);i.A(0);return new _j.a(t,[i,n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var at="MailComposeView._tidk";new _j.d(at,function(){_mcp.a.a[at]===undefined&&(_mcp.a.a[at]=[[[-1,0,["IsXOwaExtensibilityActive"],[_mcp.a.gy],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var t=_mcp.a.g.childNodes[12].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("XComposeExtensibilityView");return new _j.a(t,[n])},"",_y.ek,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var ht="MailComposeView.FromButtonTemplate";new _j.d(ht,function(){_mcp.a.a[ht]===undefined&&(_mcp.a.a[ht]=[[[-1,1,["Text"],[_mcp.a.dB],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,1,["CurrentImageId"],[_mcp.a.dA],null,"Id",null,_mcp.a.z,1,null,null,null]]]);var n=_mcp.a.g.childNodes[13].cloneNode(!0);var i=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i]).l({Label:t,Image:i})},"",Object,_fc.b,function(n){return new _fc.b(n)},!1,!1,!1,0,_mcp.a.a);var st="MailComposeView";new _j.d(st,function(){_mcp.a.a[st]===undefined&&(_mcp.a.a[st]=[[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.M,0,null,null,0,1],[-1,1,["IsReadyToShowContent"],[_mcp.a.x],null,"IsBusy",null,_mcp.a.cH,1,_mcp.a.c(),null,!1]],[[-1,1,["IsReadyToShowAppBarContent"],[_mcp.a.gd],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["GenericMailMode"],[_mcp.a.fI],null,"_mcp_R",null,null,0,_mcp.a.c(),null,null]],[[-1,5,["ExtensibilityComponent","ExtensibilityViewModel","AppPaneIsHidden"],[_mcp.a.w,_mcp.a.N,_mcp.a.bW],null,"_mcp_Z",null,null,0,_mcp.a.c(),null,null],[-1,5,["IsReadyToShowAppBarContent"],[_mcp.a.gd],null,"_mcp_Q",null,null,1,null,null,null],[-1,5,["GenericMailMode"],[_mcp.a.fI],null,"_mcp_U",null,null,0,null,null,null],[-1,5,["DisableMomemtumScrolling"],[_mcp.a.hl],null,"_mcp_M",null,null,0,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.M,0,null,null,0,0],[-1,0,["ToolbarMessage"],[_mcp.a.dw],null,"BusyText",null,_mcp.a.br,1,null,null,null],[-1,0,["ShouldShowToolbarMessage"],[_mcp.a.bQ],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,1,["IsReadyToShowContent"],[_mcp.a.x],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["InfoBarViewModel"],[_mcp.a.bP],null,"DataSource",null,_mcp.a.cJ,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.q],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsInternetExplorer"],[_mcp.a.bD],null,"_mcp_V",null,null,0,null,null,null]],[[-1,5,["DoesSupportRichText"],[_mcp.a.ga],null,"_mcp_6",null,null,1,null,null,null]],[[-1,0,["Context","IsFromShown"],[_mcp.a.e,_mcp.a.bk],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_u.n.Bo],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.UE],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.T,_mcp.a.K],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.q],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.j],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.n,0,null,null,null,_mcp.d.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.W,0,null,null,null,_mcp.d.e()],[-1,1,["IsToRecipientWellPeoplePickerButtonShown"],[_mcp.a.hJ],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","To","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.T,_mcp.a.K],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.ew],null,"_mcp_T",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.r,0,null,null,null,_nbs.a.cH],[-1,0,["RecipientComponent","To","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.T,_mcp.a.Z],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bV],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","To","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.T,_mcp.a.Y],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bV],null,"Android",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_u.n.MT],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.jq],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.S,_mcp.a.K],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.q],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.j],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.n,0,null,null,null,_mcp.d.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.W,0,null,null,null,_mcp.d.e()],[-1,1,["IsCcRecipientWellPeoplePickerButtonShown"],[_mcp.a.hI],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","Cc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.S,_mcp.a.K],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.ew],null,"_mcp_T",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.r,0,null,null,null,_nbs.a.YV],[-1,0,["RecipientComponent","Cc","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.S,_mcp.a.Z],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bV],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Cc","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.S,_mcp.a.Y],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bV],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["Context","IsBccShown"],[_mcp.a.e,_mcp.a.bM],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_u.n.JW],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.mz],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.R,_mcp.a.K],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsFirefox"],[_mcp.a.q],null,"_mcp_W",null,null,0,null,null,null],[-1,5,["IsChrome"],[_mcp.a.j],null,"chr",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,4,null,null,null,"ImageId",null,_mcp.a.n,0,null,null,null,_mcp.d.d()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.W,0,null,null,null,_mcp.d.e()],[-1,1,["IsBccRecipientWellPeoplePickerButtonShown"],[_mcp.a.hH],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["RecipientComponent","Bcc","RichPeoplePickerCommand"],[_mcp.a.d,_mcp.a.R,_mcp.a.K],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,5,["IsAndroid"],[_mcp.a.ew],null,"_mcp_T",null,null,0,null,null,null]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.r,0,null,null,null,_nbs.a.Rf],[-1,0,["RecipientComponent","Bcc","ReadWriteRecipientWellViewModel"],[_mcp.a.d,_mcp.a.R,_mcp.a.Z],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bV],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["RecipientComponent","IsReadWrite"],[_mcp.a.d,_mcp.a.s],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","Bcc","ReadOnlyRecipientWellViewModel"],[_mcp.a.d,_mcp.a.R,_mcp.a.Y],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,5,["IsAndroid"],[_mcp.a.bV],null,"_mcp_T",null,null,0,null,null,null]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.e,_mcp.a.bl],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.n,0,null,null,null,_mcp.d.a()],[-1,0,["ComplianceComponent","ShowIrmInformationCommand"],[_mcp.a.bO,_mcp.a.gH],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp.a.bO,_mcp.a.cm],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp.a.z,0,null,null,null,_n.b.T()],[-1,0,["Context","SmimeSignMessage"],[_mcp.a.e,_mcp.a.dW],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Id",null,_mcp.a.z,0,null,null,null,_n.b.Y()],[-1,0,["Context","SmimeEncryptMessage"],[_mcp.a.e,_mcp.a.dV],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp.a.cu,_mcp.a.cn],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp.a.e,_mcp.a.cl],null,"Id",null,_mcp.a.z,1,_mcp.a.cg(),!1,null]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.n,0,null,null,null,_mcp.d.x()],[-1,1,["HideSubjectAffordanceButton"],[_mcp.a.gc],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Placeholder",null,_mcp.a.bR,0,null,null,null,_nbs.a.oW],[-1,0,["Context","Subject"],[_mcp.a.e,_mcp.a.be],_mcp.a.db,"Text",_mcp.a.bH,_mcp.a.bJ,2,null,null,null],[-1,0,["Context","MaxSubjectLength"],[_mcp.a.e,_mcp.a.dm],null,"MaxLength",null,_mcp.a.bI,1,null,null,0]],[[-1,0,["Context","ShowMeetingReadonlyFields"],[_mcp.a.e,_mcp.a.dU],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.e,_mcp.a.bl],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["Context","IsMeetingForward"],[_mcp.a.e,_mcp.a.bl],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],null,[[-1,0,["Context","HasLocation"],[_mcp.a.e,_mcp.a.dR],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel","ShouldBeHidden"],[_mcp.a.C,_mcp.a.bB,_mcp.a.gx],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["AttachmentComponent","AttachmentWellViewModel"],[_mcp.a.C,_mcp.a.bB],_mcp.a.gF,"DataContext",_mcp.a.bS,_mcp.a.f,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.GX],[-1,0,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.H],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.H],null,"noScreen:hiddenMsg",null,null,0,null,null,null]],null,[[-1,4,null,null,null,"EditorAriaLabel",null,_mcp.a.cP,0,null,null,null,_nbs.a.PG],[-1,1,["EditorSizingMode"],[_mcp.a.eI],null,"SizingMode",null,_mcp.a.cT,1,null,null,0],[-1,1,["EditorMinHeight"],[_mcp.a.eH],null,"MinHeight",null,_mcp.a.cS,1,null,null,0],[-1,1,["IsReadyToShowContent"],[_mcp.a.x],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp.a.e,_mcp.a.cb],null,"IsCopyRestricted",null,_mcp.a.cj,1,null,null,!1],[-1,0,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.H],null,"IsPrintRestricted",null,_mcp.a.cR,1,null,null,!1],[-1,0,["Context","EditorContent"],[_mcp.a.e,_mcp.a.cY],_mcp.a.da,"Content",_mcp.a.cL,_mcp.a.cO,2,null,null,null],[-1,0,["Context","BodyType"],[_mcp.a.e,_mcp.a.cX],_mcp.a.cZ,"IsPlainTextContent",_mcp.a.cM,_mcp.a.cQ,2,_mcp.a.cG(),null,!1],[-1,0,["EditorComponent","EditorCallContext"],[_mcp.a.dp,_mcp.a.dc],_mcp.a.dd,"CallContext",_mcp.a.cK,_mcp.a.cN,2,null,null,null],[-1,5,["Context","IsPrintRestricted"],[_mcp.a.e,_mcp.a.H],null,"noPrint",null,null,0,null,null,null]],[[-1,1,["IsReadyToShowContent"],[_mcp.a.x],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["UpgradeComponent","IsOnDemandUpgradePending"],[_mcp.a.L,_mcp.a.di],null,"_mcp_L",null,null,0,_mcp.a.c(),null,null]],[[-1,1,["DoesSupportRichText"],[_mcp.a.ga],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","IsCopyRestricted"],[_mcp.a.e,_mcp.a.cb],null,"TextSelectionType",null,_mcp.a.cI,1,_mcp.a.gj(),null,0]],[[-1,0,["Context","IsCopyRestricted"],[_mcp.a.e,_mcp.a.cb],null,"IsCopyRestricted",null,_mcp.a.cj,1,null,null,!1],[-1,0,["Context","QuotedBody"],[_mcp.a.e,_mcp.a.fh],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.B(),null,!0],[-1,0,["Context","QuotedBody"],[_mcp.a.e,_mcp.a.fh],null,"Html",null,_mcp.a.dH,1,null,null,null]],[[-1,0,["ExtensibilityComponent","ExtensibilityViewModel"],[_mcp.a.w,_mcp.a.N],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["AppPaneIsHidden"],[_mcp.a.bW],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["MessageBoxViewModel"],[_mcp.a.dt],null,"DataContext",null,_mcp.a.f,1,null,null,null]],[[-1,4,null,null,null,"DialogTitle",null,_mcp.a.bU,0,null,null,null,_nbs.a.He],[-1,0,["TouchComponent","CloseConfirmDialogButtonData"],[_mcp.a.ez,_mcp.a.gL],null,"ButtonDataList",null,_mcp.a.bT,1,null,null,null],[-1,0,["TouchComponent","IsCloseConfirmDialogShown"],[_mcp.a.ez,_mcp.a.gM],_mcp.a.gN,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1]],[[-1,0,["ComplianceComponent","DialogViewModel"],[_mcp.a.bO,_mcp.a.gG],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["IsShown"],[_mcp.a.by],_mcp.a.bA,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1],[0,0,["Title"],[_mcp.a.bz],null,"DialogTitle",null,_mcp.a.bb,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bv],null,"CloseCommand",null,_mcp.a.bc,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.bw],null,"ContentDataContext",null,_mcp.a.bs,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bx],null,"ButtonDataList",null,_mcp.a.ba,1,null,null,null]],[[-1,0,["MessageOptionsComponent","DialogViewModel"],[_mcp.a.du,_mcp.a.df],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["IsBusy"],[_mcp.a.bK],_mcp.a.bL,"IsBusy",_mcp.a.bF,_mcp.a.bG,2,null,null,!1],[0,0,["IsShown"],[_mcp.a.by],_mcp.a.bA,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1],[0,0,["Title"],[_mcp.a.bz],null,"DialogTitle",null,_mcp.a.bb,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bv],null,"CloseCommand",null,_mcp.a.bc,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.bw],null,"ContentDataContext",null,_mcp.a.bs,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bx],null,"ButtonDataList",null,_mcp.a.ba,1,null,null,null]],[[-1,0,["OmeComponent","DialogViewModel"],[_mcp.a.ex,_mcp.a.el],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["IsBusy"],[_mcp.a.bK],_mcp.a.bL,"IsBusy",_mcp.a.bF,_mcp.a.bG,2,null,null,!1],[0,0,["IsShown"],[_mcp.a.by],_mcp.a.bA,"IsShown",_mcp.a.t,_mcp.a.u,2,null,null,!1],[0,0,["Title"],[_mcp.a.bz],null,"DialogTitle",null,_mcp.a.bb,1,null,null,null],[0,0,["CloseCommand"],[_mcp.a.bv],null,"CloseCommand",null,_mcp.a.bc,1,null,null,null],[0,0,["ContentDataContext"],[_mcp.a.bw],null,"ContentDataContext",null,_mcp.a.bs,1,null,null,null],[0,0,["FooterButtons"],[_mcp.a.bx],null,"ButtonDataList",null,_mcp.a.ba,1,null,null,null]],[[-1,0,["IsNavigatingAway"],[_mcp.a.hn],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var n=_mcp.a.g.childNodes[14].cloneNode(!0);var hi=new _j.h(n.children[9]);var kt=new _fce.o(n.children[8],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));kt.d("OmeExpirationView");var bt=new _fce.o(n.children[7],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));bt.d("MessageOptionsView");var pt=new _fce.o(n.children[6],_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));pt.d("IrmDialogView");var ht=new _b.n(n.children[5],_j.b.Instance.a(_y.a),_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.b));ht.g(!1);var rt=new _j.c(n.children[4]);rt.y("MessageBoxDefaultView");var at=new _j.c(n.children[3]);at.y("MailComposeView._tidk");var dt=new _b.p(_j.a.a(n,[2,1,3,0]),_j.b.Instance.a(_a.f));var fr=new _j.h(_j.a.a(n,[2,1,3]));var et=new _j.c(_j.a.a(n,[2,1,2,1]));et.y("MailComposeView._tidj");var t=_j.b.Instance.a(_j.bG.$$(_zz.n)).a(_j.a.a(n,[2,1,2,0]));t.bU("_mcp_A ms-font-weight-regular ms-font-color-neutralPrimary customScrollBar");t.K(!0);t.A(-1);t.ct="0";var yt=new _zz.x(_j.b.Instance.a(_b.a),_j.b.Instance.a(_zz.g),_j.b.Instance.a(_ff.b));yt.k="PasteFlyout";var tr=new _zz.u;var nr=new _zz.z(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_ff.b),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_a.f));var it=new _zz.m(_j.b.Instance.a(_b.a),_j.b.Instance.a(_zz.g),_j.b.Instance.a(_ff.b),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.cc.$$(IFindRecipientAtMentionSuggestionViewModelFactory)));it.U(_j.f.a(["AtMentionComponent"],[_mcp.a.dn],null,"MentionsHandler",null,_mcp.a.cU,1)).U(_j.f.a(["Context","Subject"],[_mcp.a.e,_mcp.a.be],null,"Topic",null,_mcp.a.cW,1)).U(_j.f.b(_cmc.b.c,null,null,null,"Scenario",null,_mcp.a.cV,0));it.k="MentionsPicker";t.D([yt,tr,nr,it]);var ur=new _j.h(_j.a.a(n,[2,1,2]));var ki=new _fc.a(_j.a.a(n,[2,1,1,7]));var o=new _j.c(_j.a.a(n,[2,1,1,6,0,0]));o.y("AttachmentWellViewWrapper");o.cr(!0);o.K(!0);var er=new _j.h(_j.a.a(n,[2,1,1,6]));var ri=new _j.c(_j.a.a(n,[2,1,1,5,3]));ri.y("MailComposeView._tidh");var ii=new _j.c(_j.a.a(n,[2,1,1,5,2]));ii.y("MailComposeView._tidg");var ni=new _j.c(_j.a.a(n,[2,1,1,5,1]));ni.y("MailComposeView._tidd");var vt=new _j.c(_j.a.a(n,[2,1,1,5,0]));vt.y("MailComposeView._tidb");var yi=new _j.h(_j.a.a(n,[2,1,1,5]));var c=new _cmc.q(_j.a.a(n,[2,1,1,4,0,5,0]));c.g("ms-font-color-neutralTertiary");c.A(0);var ti=new _fc.b(_j.a.a(n,[2,1,1,4,0,4]));var s=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));s.U(_j.f.a(["ContextMenuComponent","Menu"],[_mcp.a.U,_mcp.a.Q],null,"MenuDataContext",null,_mcp.a.bj,1)).U(_j.f.a(["ContextMenuComponent","Menu","IsShown"],[_mcp.a.U,_mcp.a.Q,_mcp.a.F],_mcp.a.X,"IsShown",_mcp.a.bh,_mcp.a.bi,2,null,null,!1));s.a=3;s.b=5;ti.D([s]);var ui=new _fc.d(_j.a.a(n,[2,1,1,4,0,3]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var ei=new _fc.d(_j.a.a(n,[2,1,1,4,0,2]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var si=new _fc.d(_j.a.a(n,[2,1,1,4,0,1]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var oi=new _fc.b(_j.a.a(n,[2,1,1,4,0,0]));var pi=new _j.h(_j.a.a(n,[2,1,1,4]));var v=new _j.c(_j.a.a(n,[2,1,1,3,2,0]));v.y("ReadOnlyRecipientWellView");v.cr(!0);v.K(!0);var sr=new _j.h(_j.a.a(n,[2,1,1,3,2]));var l=new _j.c(_j.a.a(n,[2,1,1,3,1,1]));l.y("ReadWriteRecipientWellView");l.E(26);l.cr(!0);var a=new _fc.b(_j.a.a(n,[2,1,1,3,1,0,0]));a.j=!0;a.A(-1);a.L(!0);var bi=new _j.h(_j.a.a(n,[2,1,1,3,1,0]));var wi=new _j.h(_j.a.a(n,[2,1,1,3,1]));var i=new _fc.b(_j.a.a(n,[2,1,1,3,0]));i.f("ms-bg-color-neutralLighter");i.c("ms-bg-color-neutralLight");i.d("ms-font-color-white ms-bg-color-themePrimary");i.A(-1);var gt=new _j.h(_j.a.a(n,[2,1,1,3]));var h=new _j.c(_j.a.a(n,[2,1,1,2,2,0]));h.y("ReadOnlyRecipientWellView");h.cr(!0);h.K(!0);var gi=new _j.h(_j.a.a(n,[2,1,1,2,2]));var f=new _j.c(_j.a.a(n,[2,1,1,2,1,1]));f.y("ReadWriteRecipientWellView");f.cr(!0);f.E(26);f.K(!0);var g=new _fc.b(_j.a.a(n,[2,1,1,2,1,0,0]));g.j=!0;g.A(-1);g.L(!0);var di=new _j.h(_j.a.a(n,[2,1,1,2,1,0]));var ai=new _j.h(_j.a.a(n,[2,1,1,2,1]));var u=new _fc.b(_j.a.a(n,[2,1,1,2,0]));u.f("ms-bg-color-neutralLighter");u.c("ms-bg-color-neutralLight");u.d("ms-font-color-white ms-bg-color-themePrimary");u.A(-1);var lt=new _j.h(_j.a.a(n,[2,1,1,2]));var ft=new _j.c(_j.a.a(n,[2,1,1,1,2,0]));ft.y("ReadOnlyRecipientWellView");ft.K(!0);var or=new _j.h(_j.a.a(n,[2,1,1,1,2]));var e=new _j.c(_j.a.a(n,[2,1,1,1,1,1]));e.y("ReadWriteRecipientWellView");e.E(26);e.K(!0);var nt=new _fc.b(_j.a.a(n,[2,1,1,1,1,0,0]));nt.j=!0;nt.A(-1);nt.L(!0);var ir=new _j.h(_j.a.a(n,[2,1,1,1,1,0]));var rr=new _j.h(_j.a.a(n,[2,1,1,1,1]));var r=new _fc.b(_j.a.a(n,[2,1,1,1,0]));r.f("ms-bg-color-neutralLighter");r.c("ms-bg-color-neutralLight");r.d("ms-font-color-white ms-bg-color-themePrimary");r.A(0);var ut=new _mcp.i(_j.a.a(n,[2,1,1,0,0]));ut.y("MailComposeView._tid3");var fi=new _j.h(_j.a.a(n,[2,1,1]));var k=_j.b.Instance.a(_j.bG.$$(_db.g)).a(_j.a.a(n,[2,1,0]));k.d="_mcp_D";k.A(0);var p=new _j.h(_j.a.a(n,[2,1]));p.A(-1);var wt=new _fc.g;var ot=new _fc.c;ot.U(_j.f.a(["TouchComponent","CloseCommand"],[_mcp.a.ez,_mcp.a.gK],null,"Command",null,_mcp.a.o,1));ot.i("ESC");var y=new _fc.c;y.U(_j.f.a(["SaveComponent","SaveCommand"],[_mcp.a.bo,_mcp.a.cp],null,"Command",null,_mcp.a.o,1));y.i("S");y.j=2;var b=new _fc.c;b.U(_j.f.a(["SendComponent","AltSSendCommand"],[_mcp.a.y,_mcp.a.cr],null,"Command",null,_mcp.a.o,1)).U(_j.f.a(["DoesSupportAltSForSend"],[_mcp.a.cs],null,"PreventDefault",null,_mcp.a.O,1,null,null,!1));b.i("S");b.j=4;var w=new _fc.c;w.U(_j.f.a(["SendComponent","SendCommand"],[_mcp.a.y,_mcp.a.bm],null,"Command",null,_mcp.a.o,1));w.i("ENTER");w.j=2;var d=new _fc.c;d.U(_j.f.a(["RecipientComponent","ResolveCommand"],[_mcp.a.d,_mcp.a.co],null,"Command",null,_mcp.a.o,1));d.i("K");d.j=2;var tt=new _fc.c;tt.V(_j.f.a(["ContextParent","ContextParent","ShiftTabCommand"],[_mcp.a.m,_mcp.a.m,_mcp.a.bE],null,"Command",null,_mcp.a.o,1)).V(_j.f.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp.a.m,_mcp.a.m,_mcp.a.J],null,"PreventDefault",null,_mcp.a.O,1,null,null,!1)).V(_j.f.a(["ContextParent","ContextParent","ShouldPreventShiftTabDefault"],[_mcp.a.m,_mcp.a.m,_mcp.a.J],null,"StopPropagation",null,_mcp.a.bt,1,null,null,!1));tt.i("TAB");tt.j=1;wt.a([ot,y,b,w,d,tt]);p.D([wt]);var ci=new _fce.h(_j.a.a(n,[2,0]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));var li=new _fce.g(n.children[2],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));var vi=new _j.h(n.children[1]);var ct=new _fce.h(n.children[0],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));ct.a=0;ct.d("");return new _j.a(n,[ct,vi,li,ci,p,k,fi,ut,r,rr,ir,nt,e,or,ft,lt,u,ai,di,g,f,gi,h,gt,i,wi,bi,a,l,sr,v,pi,oi,si,ei,ui,ti,c,yi,vt,ni,ii,ri,er,o,ki,ur,t,et,fr,dt,at,rt,ht,pt,bt,kt,hi]).l({ComposeViewContent:p,InfoBarControl:k,FromFieldControl:ut,ToRecipientButton:r,ToRecipientWellControl:e,CcRecipientWellControl:lt,CcRecipientButton:u,BccRecipientWellControl:gt,BccRecipientButton:i,SubjectTextBox:c,AttachmentWellViewWrapper:o,EditorControl:t,OnDemandUpgradeContainer:et,QuotedBodyHtmlLabel:dt,MessageBox:rt,CancelConfirmDialog:ht})},"",_mcp.e,_mcp.m,function(n){return new _mcp.m(n,_j.b.Instance.a(_j.bc),_j.b.Instance.a(_j.o),_j.b.Instance.a(_a.B),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_a.C),_j.b.Instance.a(_b.d))},!0,!1,!1,0,_mcp.a.a);var lt="MailComposeAggregatedRecipientWellView._tidu1";new _j.d(lt,function(){_mcp.a.a[lt]===undefined&&(_mcp.a.a[lt]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.Os]],[[-1,0,["RecipientComponent"],[_mcp.a.d],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var t=_mcp.a.g.childNodes[43].cloneNode(!0);var n=new _rw.n(t.children[1]);n.e=0;n.d="calc(100% - 150px)";var i=new _fc.a(t.children[0]);return new _j.a(t,[i,n])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var ct="MailComposeAggregatedRecipientWellView._tidv1";new _j.d(ct,function(){_mcp.a.a[ct]===undefined&&(_mcp.a.a[ct]=[[[-1,0,["ImportanceComponent","IsNormalImportance"],[_mcp.a.cu,_mcp.a.cn],null,"IsHidden",null,_mcp.a.b,1,null,null,!0],[-1,0,["Context","Importance"],[_mcp.a.e,_mcp.a.cl],null,"Id",null,_mcp.a.z,1,_mcp.a.cg(),!1,null]],[[-1,4,null,null,null,"Id",null,_mcp.a.z,0,null,null,null,_mcp.d.a()],[-1,0,["ComplianceComponent","IsIrmProtected"],[_mcp.a.bO,_mcp.a.cm],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"ImageId",null,_mcp.a.n,0,null,null,null,_mcp.d.q()],[-1,4,null,null,null,"HoveredImageId",null,_mcp.a.E,0,null,null,null,_mcp.d.r()],[-1,4,null,null,null,"PressedImageId",null,_mcp.a.W,0,null,null,null,_mcp.d.s()],[-1,4,null,null,null,"AriaLabel",null,_mcp.a.k,0,null,null,null,_nbs.a.Br],[-1,4,null,null,null,"Title",null,_mcp.a.p,0,null,null,null,_nbs.a.Br],[-1,0,["ShouldShowExpandButton"],[_mcp.a.hq],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["NavigationComponent","UpconvertOnMoreOptionsCommand"],[_mcp.a.cv,_mcp.a.fz],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]]]);var n=_mcp.a.g.childNodes[44].cloneNode(!0);var t=new _fc.b(n.children[2]);t.c("ms-font-color-black");t.A(-1);var r=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var i=new _fc.d(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[i,r,t])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var e="MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidw1";new _j.d(e,function(){_mcp.a.a[e]===undefined&&(_mcp.a.a[e]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.Os]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.dL,0,null,null,null,_u.n.Se],[-1,0,["To","AggregatedRecipientWellViewModel"],[_mcp.a.gR,_mcp.a.cq],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var n=_mcp.a.g.childNodes[45].cloneNode(!0);var t=new _rw.e(n.children[1]);t.y("ReadOnlyRecipientWellExpandCollapseView");var i=new _fc.a(n.children[0]);return new _j.a(n,[i,t])},"",_mcp.f,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var f="MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidx1";new _j.d(f,function(){_mcp.a.a[f]===undefined&&(_mcp.a.a[f]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.PT]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.dL,0,null,null,null,_u.n.Mt],[-1,0,["Cc","AggregatedRecipientWellViewModel"],[_mcp.a.fB,_mcp.a.cq],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var n=_mcp.a.g.childNodes[46].cloneNode(!0);var t=new _rw.e(n.children[1]);t.y("ReadOnlyRecipientWellExpandCollapseView");var i=new _fc.a(n.children[0]);return new _j.a(n,[i,t])},"",_mcp.f,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var s="MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidy1";new _j.d(s,function(){_mcp.a.a[s]===undefined&&(_mcp.a.a[s]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_u.n.RH]],[[-1,4,null,null,null,"AriaLabel",null,_mcp.a.dL,0,null,null,null,_u.n.BR],[-1,0,["Bcc","AggregatedRecipientWellViewModel"],[_mcp.a.fA,_mcp.a.cq],null,"DataContext",null,_mcp.a.f,1,null,null,null]]]);var n=_mcp.a.g.childNodes[47].cloneNode(!0);var t=new _rw.e(n.children[1]);t.y("ReadOnlyRecipientWellExpandCollapseView");var i=new _fc.a(n.children[0]);return new _j.a(n,[i,t])},"",_mcp.f,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var o="MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate";new _j.d(o,function(){_mcp.a.a[o]===undefined&&(_mcp.a.a[o]=[null,[[-1,0,["Cc","AggregatedRecipientWellViewModel","Recipients","Count"],[_mcp.a.fB,_mcp.a.cq,_mcp.a.fi,_mcp.a.ci],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.cf(),null,!0]],[[-1,0,["Bcc","AggregatedRecipientWellViewModel","Recipients","Count"],[_mcp.a.fA,_mcp.a.cq,_mcp.a.fi,_mcp.a.ci],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.cf(),null,!0]],[[-1,5,["DisplayEllipsis"],[_mcp.a.hD],null,"_mcp_E3:hidden",null,null,1,null,null,null]]]);var n=_mcp.a.g.childNodes[48].cloneNode(!0);var u=new _j.h(n.children[1]);var r=new _j.c(_j.a.a(n,[0,0,2]));r.A(-1);r.y("MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidy1");var t=new _j.c(_j.a.a(n,[0,0,1]));t.A(-1);t.y("MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidx1");var i=new _j.c(_j.a.a(n,[0,0,0]));i.A(-1);i.y("MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate._tidw1");return new _j.a(n,[i,t,r,u])},"",_mcp.f,_mcp.F,function(n){return new _mcp.F(n)},!1,!1,!1,0,_mcp.a.a);var u="MailComposeAggregatedRecipientWellView";new _j.d(u,function(){_mcp.a.a[u]===undefined&&(_mcp.a.a[u]=[[[-1,0,["RecipientComponent"],[_mcp.a.d],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["IsCompactRecipientWellEnabled"],[_mcp.a.fC],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["RecipientComponent","IsCompactRecipientWellEnabled"],[_mcp.a.d,_mcp.a.fC],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["ShouldApplyInlineCompose"],[_mcp.a.ho],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,5,["IsFirefox"],[_mcp.a.q],null,"_mcp_K3",null,null,0,null,null,null]]]);var n=_mcp.a.g.childNodes[49].cloneNode(!0);var r=new _j.c(_j.a.a(n,[0,2]));r.y("MailComposeAggregatedRecipientWellView._tidv1");var i=new _j.c(_j.a.a(n,[0,1]));i.y("MailComposeAggregatedRecipientWellView._tidu1");var t=new _mcp.F(_j.a.a(n,[0,0]));t.y("MailComposeAggregatedRecipientWellView.ReadOnlyAggregatedWellTemplate");return new _j.a(n,[t,i,r])},"",_mcp.e,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var t="MessageOptionsView._tidi2";new _j.d(t,function(){_mcp.a.a[t]===undefined&&(_mcp.a.a[t]=[[[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_nbs.a.NM],[-1,0,["SmimeEncryptMessage"],[_mcp.a.hs],_mcp.a.hw,"IsChecked",_mcp.a.bu,_mcp.a.bd,2,null,null,!1],[-1,0,["SmimeEncryptMessageIsEnabled"],[_mcp.a.ht],null,"IsEnabled",null,_mcp.a.bq,1,null,null,!1]],[[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_nbs.a.Nu],[-1,0,["SmimeSignMessage"],[_mcp.a.hu],_mcp.a.hx,"IsChecked",_mcp.a.bu,_mcp.a.bd,2,null,null,!1],[-1,0,["SmimeSignMessageIsEnabled"],[_mcp.a.hv],null,"IsEnabled",null,_mcp.a.bq,1,null,null,!1]]]);var n=_mcp.a.g.childNodes[59].cloneNode(!0);var r=new _fc.h(n.children[1],_j.b.Instance.a(_ff.a));var i=new _fc.h(n.children[0],_j.b.Instance.a(_ff.a));return new _j.a(n,[i,r])},"",_mcp.Q,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var n="MessageOptionsView.SensitivityTemplate";new _j.d(n,function(){_mcp.a.a[n]===undefined&&(_mcp.a.a[n]=[[[-1,1,["DataContext"],[_mcp.a.bS],null,"Text",null,_mcp.a.h,1,_mcp.a.eM(),null,null]]]);var t=_mcp.a.g.childNodes[0].cloneNode(!0);var i=new _fc.a(t.children[0]);return new _j.a(t,[i])},"",Object,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var r="MessageOptionsView";new _j.d(r,function(){_mcp.a.a[r]===undefined&&(_mcp.a.a[r]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.Vm]],[[-1,0,["SensitivityOptions"],[_mcp.a.fM],null,"Options",null,_mcp.a.eP,1,null,null,null],[-1,0,["Sensitivity"],[_mcp.a.fL],_mcp.a.fR,"SelectedValue",_mcp.a.eO,_mcp.a.eQ,2,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_nbs.a.Ye],[-1,0,["IsDeliveryReceiptRequested"],[_mcp.a.fJ],_mcp.a.fP,"IsChecked",_mcp.a.bu,_mcp.a.bd,2,null,null,!1],[-1,0,["ShowDeliveryReceiptRequest"],[_mcp.a.fN],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_nbs.a.bx],[-1,0,["IsReadReceiptRequested"],[_mcp.a.fK],_mcp.a.fQ,"IsChecked",_mcp.a.bu,_mcp.a.bd,2,null,null,!1],[-1,0,["ShowReadReceiptRequest"],[_mcp.a.fO],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["ShowSmimeOptions"],[_mcp.a.hr],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var n=_mcp.a.g.childNodes[60].cloneNode(!0);var i=new _j.c(n.children[4]);i.y("MessageOptionsView._tidi2");var f=new _fc.h(n.children[3],_j.b.Instance.a(_ff.a));var e=new _fc.h(n.children[2],_j.b.Instance.a(_ff.a));var t=new _fce.k(n.children[1]);t.a("MessageOptionsView.SensitivityTemplate");var u=new _fc.a(n.children[0]);return new _j.a(n,[u,t,e,f,i])},"",_mcp.Q,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var i="OmeExpirationView._tidj2";new _j.d(i,function(){_mcp.a.a[i]===undefined&&(_mcp.a.a[i]=[[[-1,4,null,null,null,"Title",null,_mcp.a.p,0,null,null,null,_nbs.a.ZN],[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_nbs.a.ZN],[-1,4,null,null,null,"Data",null,_mcp.a.eR,0,null,null,null,0]],[[-1,4,null,null,null,"Title",null,_mcp.a.p,0,null,null,null,_nbs.a.Kb],[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_nbs.a.Kb],[-1,4,null,null,null,"Data",null,_mcp.a.eR,0,null,null,null,1],[-1,0,["IsOmeTimeExpirationEnabled"],[_mcp.a.fS],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,5,["IsOmeTimeExpirationEnabled"],[_mcp.a.fS],null,"_mcp_m5",null,null,0,_mcp.a.c(),null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.cI,0,null,null,0,2],[-1,0,["FirstTextBox","MaxLength"],[_mcp.a.dx,_mcp.a.eB],null,"MaxLength",null,_mcp.a.bI,0,null,null,0],[-1,0,["FirstTextBox","TextInput"],[_mcp.a.dx,_mcp.a.eD],_mcp.a.eE,"Text",_mcp.a.bH,_mcp.a.bJ,2,null,null,null],[-1,0,["FirstTextBox","PlaceholderText"],[_mcp.a.dx,_mcp.a.eC],null,"Placeholder",null,_mcp.a.bR,0,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.eF],_mcp.a.eG,"IsEnabled",_mcp.a.dC,_mcp.a.dD,2,null,null,!1],[-1,5,["FirstTextBox","IsYear"],[_mcp.a.dx,_mcp.a.eA],null,"_mcp_k5",null,null,0,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.cI,0,null,null,0,2],[-1,0,["SecondTextBox","MaxLength"],[_mcp.a.dy,_mcp.a.eB],null,"MaxLength",null,_mcp.a.bI,0,null,null,0],[-1,0,["SecondTextBox","PlaceholderText"],[_mcp.a.dy,_mcp.a.eC],null,"Placeholder",null,_mcp.a.bR,0,null,null,null],[-1,0,["SecondTextBox","TextInput"],[_mcp.a.dy,_mcp.a.eD],_mcp.a.eE,"Text",_mcp.a.bH,_mcp.a.bJ,2,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.eF],_mcp.a.eG,"IsEnabled",_mcp.a.dC,_mcp.a.dD,2,null,null,!1],[-1,5,["SecondTextBox","IsYear"],[_mcp.a.dy,_mcp.a.eA],null,"_mcp_k5",null,null,0,null,null,null]],[[-1,4,null,null,null,"TextSelectionType",null,_mcp.a.cI,0,null,null,0,2],[-1,0,["ThirdTextBox","MaxLength"],[_mcp.a.dz,_mcp.a.eB],null,"MaxLength",null,_mcp.a.bI,0,null,null,0],[-1,0,["ThirdTextBox","PlaceholderText"],[_mcp.a.dz,_mcp.a.eC],null,"Placeholder",null,_mcp.a.bR,0,null,null,null],[-1,0,["ThirdTextBox","TextInput"],[_mcp.a.dz,_mcp.a.eD],_mcp.a.eE,"Text",_mcp.a.bH,_mcp.a.bJ,2,null,null,null],[-1,0,["IsTimeExpirationSelected"],[_mcp.a.eF],_mcp.a.eG,"IsEnabled",_mcp.a.dC,_mcp.a.dD,2,null,null,!1],[-1,5,["ThirdTextBox","IsYear"],[_mcp.a.dz,_mcp.a.eA],null,"_mcp_k5",null,null,0,null,null,null]]]);var n=_mcp.a.g.childNodes[62].cloneNode(!0);var f=new _fc.i(_j.a.a(n,[1,1,2]));var e=new _fc.i(_j.a.a(n,[1,1,1]));var o=new _fc.i(_j.a.a(n,[1,1,0]));var t=new _j.h(_j.a.a(n,[1,1]));var r=new _fce.j(_j.a.a(n,[1,0]));var u=new _fce.j(_j.a.a(n,[0,0]));return new _j.a(n,[u,r,t,o,e,f])},"",_mcp.bb,_fce.i,function(n){return new _fce.i(n)},!1,!0,!1,0,_mcp.a.a);var h="OmeExpirationView";new _j.d(h,function(){_mcp.a.a[h]===undefined&&(_mcp.a.a[h]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.pJ]],[[-1,0,["SelectedOption"],[_mcp.a.hz],_mcp.a.hA,"SelectedOptionData",_mcp.a.gn,_mcp.a.go,2,null,null,null]],[[-1,0,["ErrorText"],[_mcp.a.hy],null,"Text",null,_mcp.a.h,1,null,null,null]]]);var n=_mcp.a.g.childNodes[63].cloneNode(!0);var i=new _fc.a(n.children[2]);i.J(!1);var t=new _fce.i(n.children[1]);t.y("OmeExpirationView._tidj2");var r=new _fc.a(n.children[0]);return new _j.a(n,[r,t,i])},"",_mcp.bb,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var w="SendAvailabilityPopupView";new _j.d(w,function(){_mcp.a.a[w]===undefined&&(_mcp.a.a[w]=[[[-1,4,null,null,null,"ImageId",null,_mcp.a.n,0,null,null,null,_mcp.d.I()],[-1,0,["CancelCommand"],[_mcp.a.fT],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.Bz]],[[-1,0,["ConsensusSchedulingViewModel"],[_mcp.a.hB],null,"DataContext",null,_mcp.a.f,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_nbs.a.lD],[-1,0,["SubmitCommand"],[_mcp.a.hC],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_nbs.a.kg],[-1,0,["CancelCommand"],[_mcp.a.fT],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]]]);var n=_mcp.a.g.childNodes[64].cloneNode(!0);var r=new _fc.b(_j.a.a(n,[2,1]));r.e(1);var i=new _fc.b(_j.a.a(n,[2,0]));i.e(4);var t=new _j.c(_j.a.a(n,[1,0]));t.y("ConsensusSchedulingView.Wrapper");t.K(!0);var f=new _fc.a(_j.a.a(n,[0,1]));var u=new _fc.b(_j.a.a(n,[0,0]));return new _j.a(n,[u,f,t,i,r])},"",_mcp.bp,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_mcp.a.a);var p="GroupCreateSuggestionInfoBarView._tidk2";new _j.d(p,function(){_mcp.a.a[p]===undefined&&(_mcp.a.a[p]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.Fa]]]);var n=_mcp.a.g.childNodes[65].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.P,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var k="GroupCreateSuggestionInfoBarView._tidl2";new _j.d(k,function(){_mcp.a.a[k]===undefined&&(_mcp.a.a[k]=[[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.NH]]]);var n=_mcp.a.g.childNodes[0].cloneNode(!0);var t=new _fc.a(n.children[0]);return new _j.a(n,[t])},"",_mcp.P,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_mcp.a.a);var b="GroupCreateSuggestionInfoBarView";new _j.d(b,function(){_mcp.a.a[b]===undefined&&(_mcp.a.a[b]=[[[-1,0,["BeforeCreateGroupStatus"],[_mcp.a.gV],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["InfoBarText"],[_mcp.a.gZ],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["HasExistingGroup"],[_mcp.a.fF],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,0,["HasExistingGroup"],[_mcp.a.fF],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0],[-1,0,["ReplaceWithGroupClickCommand"],[_mcp.a.ha],null,"ClickCommand",null,_mcp.a.i,1,null,null,null]],[[-1,0,["IsCreatingGroupStatus"],[_mcp.a.fG],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.M,0,null,null,0,0],[-1,0,["IsCreatingGroupStatus"],[_mcp.a.fG],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["CreatingGroupText"],[_mcp.a.gY],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,0,["AfterCreateGroupStatus"],[_mcp.a.gT],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["AfterCreateGroupText"],[_mcp.a.gU],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,4,null,null,null,"Title",null,_mcp.a.p,0,null,null,null,_u.R.PJ],[-1,0,["CloseCommand"],[_mcp.a.gX],null,"ClickCommand",null,_mcp.a.i,1,null,null,null],[-1,0,["Close"],[_mcp.a.gW],null,"ImageId",null,_mcp.a.n,0,null,null,null],[-1,0,["CloseHover"],[_mcp.a.fD],null,"HoveredImageId",null,_mcp.a.E,0,null,null,null],[-1,0,["CloseHover"],[_mcp.a.fD],null,"PressedImageId",null,_mcp.a.W,0,null,null,null]]]);var n=_mcp.a.g.childNodes[66].cloneNode(!0);var f=new _fc.b(_j.a.a(n,[0,3]));var s=new _fc.a(_j.a.a(n,[0,2,0]));var l=new _j.h(_j.a.a(n,[0,2]));var h=new _fc.a(_j.a.a(n,[0,1,1]));var r=new _fce.h(_j.a.a(n,[0,1,0]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));r.a=0;var c=new _j.h(_j.a.a(n,[0,1]));var u=new _fc.e(_j.a.a(n,[0,0,2]));u.y("GroupCreateSuggestionInfoBarView._tidl2");var i=new _fc.e(_j.a.a(n,[0,0,1]));var t=new _b.F(_j.b.Instance.a(_b.o),_j.b.Instance.a(_b.a),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.b));t.U(_j.f.a(["GroupCreateSuggestionPeekViewModel"],[_mcp.a.fE],null,"PeekDataContext",null,_mcp.a.gs,1)).U(_j.f.a(["GroupCreateSuggestionPeekViewModel","IsShown"],[_mcp.a.fE,_mcp.a.hd],_mcp.a.hh,"IsShown",_mcp.a.gt,_mcp.a.gu,2,null,null,!1)).V(_j.f.a(["DOMElement"],[_mcp.a.gq],null,"AnchorElement",null,_mcp.a.gr,1));t.m("GroupCreateSuggestionPeekView");t.f("GroupCreateSuggestionPeekView.Content");t.i(1);i.D([t]);i.y("GroupCreateSuggestionInfoBarView._tidk2");var e=new _fc.a(_j.a.a(n,[0,0,0]));var o=new _j.h(_j.a.a(n,[0,0]));return new _j.a(n,[o,e,i,u,c,r,h,l,s,f])},"",_mcp.P,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var y="GroupCreateSuggestionPeekView.Content._tidm2";new _j.d(y,function(){_mcp.a.a[y]===undefined&&(_mcp.a.a[y]=[null]);var t=_mcp.a.g.childNodes[39].cloneNode(!0);var n=new _fce.d(t.children[0]);return new _j.a(t,[n]).l({ListPanel:n})},"",_mcp.K,_fce.a,function(n){return new _fce.a(n,_j.b.Instance.a(_ff.a))},!1,!0,!1,0,_mcp.a.a);var l="GroupCreateSuggestionPeekView.Content";new _j.d(l,function(){_mcp.a.a[l]===undefined&&(_mcp.a.a[l]=[null,[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.Dy]],null,[[-1,0,["GroupMemberPersonas"],[_mcp.a.hc],null,"DataSource",null,_mcp.a.gm,1,null,null,null]],[[-1,0,["ShowPersonasTotalNumber"],[_mcp.a.hg],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]],[[-1,0,["PersonasTotalNumber"],[_mcp.a.hf],null,"Text",null,_mcp.a.h,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_mcp.a.h,0,null,null,null,_nbs.a.bC]],[[-1,4,null,null,null,"Text",null,_mcp.a.l,0,null,null,null,_nbs.a.f],[-1,0,["LearnMoreLinkURL"],[_mcp.a.he],null,"Href",null,_mcp.a.gp,1,null,null,null]],[[-1,0,["GroupCreationViewModel"],[_mcp.a.hb],null,"DataContext",null,_mcp.a.f,1,null,null,null],[0,0,["IsCreateGroupPaneLoading"],[_mcp.a.fH],null,"IsHidden",null,_mcp.a.b,1,null,null,!0]],[[-1,4,null,null,null,"SpinnerSize",null,_mcp.a.M,0,null,null,0,0],[-1,0,["IsCreateGroupPaneLoading"],[_mcp.a.fH],null,"IsHidden",null,_mcp.a.b,1,_mcp.a.c(),null,!0]]]);var n=_mcp.a.g.childNodes[67].cloneNode(!0);var r=new _fce.h(_j.a.a(n,[0,1,1]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));r.a=0;var u=new _j.c(_j.a.a(n,[0,1,0]));u.y("CreateGroupSuggestionView");var t=new _fc.e(_j.a.a(n,[0,0,2,1]));t.o(!1);t.a("_blank");var s=new _fc.a(_j.a.a(n,[0,0,2,0]));var h=new _fc.a(_j.a.a(n,[0,0,1,1,0]));var c=new _j.h(_j.a.a(n,[0,0,1,1]));var i=new _fce.a(_j.a.a(n,[0,0,1,0,0,0]),_j.b.Instance.a(_ff.a));i.t("GroupCreateSuggestionPeekView.GroupMemberMemberPersonaTemplate");i.y("GroupCreateSuggestionPeekView.Content._tidm2");var e=new _j.h(_j.a.a(n,[0,0,1,0]));var f=new _fc.a(_j.a.a(n,[0,0,0,0]));var o=new _j.h(n.children[0]);return new _j.a(n,[o,f,e,i,c,h,s,t,u,r])},"",_mcp.K,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_mcp.a.a);var c="GroupCreateSuggestionPeekView.GroupMemberMemberPersonaTemplate._tidn2";new _j.d(c,function(){_mcp.a.a[c]===undefined&&(_mcp.a.a[c]=[null]);var t=_mcp.a.g.childNodes[68].cloneNode(!0);var n=new _pe.d(_j.a.a(t,[0,0]),_j.b.Instance.a(_a.q));n.y("PersonaView.DisplayPicturePopup");return new _j.a(t,[n])},"",_bc.n,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_mcp.a.a);var v="GroupCreateSuggestionPeekView.GroupMemberMemberPersonaTemplate";new _j.d(v,function(){_mcp.a.a[v]===undefined&&(_mcp.a.a[v]=[null]);var t=_mcp.a.g.childNodes[69].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("GroupCreateSuggestionPeekView.GroupMemberMemberPersonaTemplate._tidn2");return new _j.a(t,[n])},"",_bc.n,_fce.e,function(n){return new _fce.e(n)},!1,!1,!1,0,_mcp.a.a);var a="GroupCreateSuggestionPeekView";new _j.d(a,function(){_mcp.a.a[a]===undefined&&(_mcp.a.a[a]=[null,[[-1,1,["ContentDataContext"],[_mcp.a.gv],null,"DataContext",null,_mcp.a.f,1,null,null,null]],null]);var n=_mcp.a.g.childNodes[70].cloneNode(!0);var r=new _j.h(_j.a.a(n,[0,1]));var i=new _j.c(_j.a.a(n,[0,0]));var t=new _j.h(n.children[0]);return new _j.a(n,[t,i,r]).l({PopupContent:t,PeekContent:i,Notch:r})},"",_y.el,_b.Y,function(n){return new _b.Y(n,_j.b.Instance.a(_b.a),_j.b.Instance.a(_j.j),_j.b.Instance.a(_y.a),_j.b.Instance.a(_ff.b))},!1,!1,!1,0,_mcp.a.a)};_mcp.M.registerClass("_mcp.M",_db.f);_mcp.bs.registerClass("_mcp.bs",_h.fa);_mcp.T.registerClass("_mcp.T",_a.cU);_mcp.be.registerClass("_mcp.be",_h.cO.$$(_gg.rI,_gg.rK));MailComposeComponent.registerClass("MailComposeComponent",null,_a.ic,_j.ce);_mcp.U.registerClass("_mcp.U");_mcp.V.registerClass("_mcp.V");_mcp.A.registerClass("_mcp.A",_a.jb);_mcp.bw.registerClass("_mcp.bw");_mcp.bv.registerClass("_mcp.bv",_h.fa);_mcp.bx.registerClass("_mcp.bx",null,_h.bT,_h.en);_mcp.C.registerClass("_mcp.C",_h.cO.$$(_gg.sx,_g.dA));_mcp.bt.registerClass("_mcp.bt",_h.fa);_mcp.bu.registerClass("_mcp.bu",_h.fa,_a.fs);_mcp.N.registerClass("_mcp.N",_y.hy);_mcp.L.registerClass("_mcp.L",null,IMailComposeActionFactory);_mcp.bj.registerClass("_mcp.bj",null,IMailComposeContextFactory);_mcp.bl.registerClass("_mcp.bl",null,IMailComposeViewModelFactory,_bc.Y);_mcp.bm.registerClass("_mcp.bm",_mcp.bl,IMailInlineComposeViewModelFactory,IMailComposeViewModelFactory,_bc.Y);_mcp.P.registerClass("_mcp.P",_y.hy);_mcp.K.registerClass("_mcp.K",_a.bB,_y.el,_a.iP,_j.bp,Sys.IDisposable);_mcp.bi.registerClass("_mcp.bi",_a.bB);_mcp.Z.registerClass("_mcp.Z",_j.Q,_y.hs);_mcp.b.registerClass("_mcp.b",_a.jb,_g.kq,_y.cN,_bc.bH,IContext,_j.bp,Sys.IDisposable,_dg.ICalendarTimePeriod);_mcp.E.registerClass("_mcp.E",null,IMailComposeDiscardManager);_mcp.c.registerClass("_mcp.c",_a.dT);_mcp.bW.registerClass("_mcp.bW");_mcp.e.registerClass("_mcp.e",_y.hR,_y.i,_y.A,_bc.r,_a.iP,_j.bp,Sys.IDisposable,_y.dy,_y.cK,_bc.i,_bc.o,_y.E,IMailComposeOverridable);_mcp.v.registerClass("_mcp.v",_mcp.e);_mcp.j.registerClass("_mcp.j",_mcp.e);_mcp.l.registerClass("_mcp.l");_mcp.bn.registerClass("_mcp.bn",_a.bB,_y.ht);_mcp.bo.registerClass("_mcp.bo",null,IMailResponseViewModelFactory);_mcp.Q.registerClass("_mcp.Q",_a.bB);_mcp.bb.registerClass("_mcp.bb",_a.bB);_mcp.ba.registerClass("_mcp.ba");_mcp.bc.registerClass("_mcp.bc");_mcp.bY.registerClass("_mcp.bY");_mcp.bp.registerClass("_mcp.bp",_a.bB,_bc.i,_bc.o,_bc.r,_a.iP,_j.bp,Sys.IDisposable);_mcp.G.registerClass("_mcp.G",_j.Q,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.by.registerClass("_mcp.by",_mcp.G,_mcp.ce,IMailComposeComponent,_j.bp,Sys.IDisposable,_y.gr);_mcp.n.registerClass("_mcp.n",_mcp.G,IMailComposeAttachmentComponent,IMailComposeComponent,_j.bp,Sys.IDisposable,_y.gB,IMailComposeOverridable);_mcp.p.registerClass("_mcp.p",_mcp.G,IMailComposeContextMenuProvider);_mcp.y.registerClass("_mcp.y",_mcp.p,IMailComposeSaveComponent,IMailComposeComponent,_j.bp,Sys.IDisposable,IMailComposeContextMenuProvider,IMailComposeOverridable);_mcp.W.registerClass("_mcp.W",_mcp.y,IMailComposeAutoSaveComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.z.registerClass("_mcp.z",_mcp.G,IMailComposeCommandingBarComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.D.registerClass("_mcp.D",_mcp.p,IMailComposeComplianceComponent,IMailComposeComponent,_j.bp,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bA.registerClass("_mcp.bA",null,Sys.IDisposable);_mcp.bB.registerClass("_mcp.bB",_mcp.p,IMailComposeContentConversionComponent,IMailComposeComponent,_j.bp,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.H.registerClass("_mcp.H",_mcp.G,IMailComposeContextMenuComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bC.registerClass("_mcp.bC",_mcp.H,IMailComposeContextMenuComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.u.registerClass("_mcp.u",_mcp.G,IMailComposeSendComponent,IMailComposeOverridable);_mcp.I.registerClass("_mcp.I",_mcp.u);_mcp.w.registerClass("_mcp.w",_mcp.G,IMailComposeDiscardComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bD.registerClass("_mcp.bD",_mcp.G,IMailComposeEditorComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bE.registerClass("_mcp.bE",_mcp.bD);_mcp.bF.registerClass("_mcp.bF",_mcp.G,_mcp.cf,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bH.registerClass("_mcp.bH",_mcp.p,IMailComposeImportanceComponent,IMailComposeComponent,_j.bp,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.x.registerClass("_mcp.x",_mcp.G,IMailComposeLinkPreviewComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.X.registerClass("_mcp.X",_mcp.G,IMailComposeCalendaringInfobarComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bI.registerClass("_mcp.bI",_mcp.G,IMailComposeInitializerComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.h.registerClass("_mcp.h",_mcp.G,IMailComposeMeetingComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bK.registerClass("_mcp.bK",_mcp.p,IMailComposeMessageOptionsComponent,IMailComposeComponent,_j.bp,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.r.registerClass("_mcp.r",_mcp.p,IMailComposeNavigationComponent);_mcp.bL.registerClass("_mcp.bL",_mcp.p,IMailComposeOmeComponent,IMailComposeComponent,_j.bp,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bM.registerClass("_mcp.bM",_mcp.G,IMailComposePALGenericAttachmentComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bO.registerClass("_mcp.bO",_mcp.G,IMailComposePhotoComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.f.registerClass("_mcp.f",_mcp.p,_y.hV,IMailComposeRecipientComponent,IMailComposeComponent,_j.bp,Sys.IDisposable,_rw.q);_mcp.s.registerClass("_mcp.s",_mcp.G,IMailComposeRecipientSummarizationComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.B.registerClass("_mcp.B",_j.Q);_mcp.t.registerClass("_mcp.t",_mcp.G,IMailComposeSendAsContextMenuComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.g.registerClass("_mcp.g",_mcp.G,_mcp.cg,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bQ.registerClass("_mcp.bQ",_mcp.G,IMailComposeShareAttachmentComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.q.registerClass("_mcp.q",_mcp.p,IMailComposeSignatureComponent,IMailComposeComponent,_j.bp,Sys.IDisposable,IMailComposeContextMenuProvider);_mcp.bR.registerClass("_mcp.bR",_mcp.G,IMailComposeTouchComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.O.registerClass("_mcp.O",_mcp.G,IMailComposeUpgradeComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bJ.registerClass("_mcp.bJ",_mcp.G,IMailComposeMailTipsComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bN.registerClass("_mcp.bN",_mcp.G,IMailComposePeopleRecommendationsComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bP.registerClass("_mcp.bP",_mcp.G,IMailComposePolicyTipsComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.J.registerClass("_mcp.J",_mcp.G,_y.eX,_y.eW,_y.hd,IMailComposeExtensibilityComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bG.registerClass("_mcp.bG",_mcp.G,IMailComposeHashtagComponent,IMailComposeComponent,_j.bp,Sys.IDisposable,_y.go);_mcp.bS.registerClass("_mcp.bS",_mcp.G,IMailComposeExtensibilityComponent,IMailComposeComponent,_j.bp,Sys.IDisposable);_mcp.bz.registerClass("_mcp.bz");_mcp.bT.registerClass("_mcp.bT",null,_j.bQ);_mcp.k.registerClass("_mcp.k",_j.h,_b.bB);_mcp.F.registerClass("_mcp.F",_j.c);_mcp.m.registerClass("_mcp.m",_j.c,_ff.k,_y.gl,_cmc.bW);_mcp.ch.registerClass("_mcp.ch",_mcp.m);_mcp.i.registerClass("_mcp.i",_j.c);_mcp.S.registerClass("_mcp.S",_mcp.ch);_mcp.bd.registerClass("_mcp.bd",_j.c);_mcp.o.registerClass("_mcp.o",_mcp.ch);MailComposeComponent.$$cctor();_mcp.b.bT=new _a.e("ViewModelId",String,_mcp.b);_mcp.b.b=new _a.e("Operation",_y.l,_mcp.b);_mcp.b.j=new _a.e("Mode",_y.dG,_mcp.b);_mcp.b.bp=new _a.e("OriginalId",_g.g,_mcp.b);_mcp.b.bo=new _a.e("OriginalDocumentId",Number,_mcp.b);_mcp.b.bq=new _a.e("OriginalItem",_g.h,_mcp.b);_mcp.b.F=new _a.e("DraftId",_g.g,_mcp.b);_mcp.b.bN=new _a.e("StoreId",String,_mcp.b);_mcp.b.bO=new _a.e("Subject",String,_mcp.b,"");_mcp.b.bB=new _a.e("SelectedDataCallContext",_h.cU,_mcp.b);_mcp.b.H=new _a.e("EditorCallContext",_h.cU,_mcp.b);_mcp.b.I=new _a.e("EditorContent",String,_mcp.b,"");_mcp.b.r=new _a.e("BodyType",String,_mcp.b);_mcp.b.m=new _a.e("ToRecipients",_j.P,_mcp.b);_mcp.b.l=new _a.e("SpeechResultRecipients",_j.P,_mcp.b);_mcp.b.bP=new _a.e("ToQueryString",String,_mcp.b);_mcp.b.g=new _a.e("CcRecipients",_j.P,_mcp.b);_mcp.b.t=new _a.e("CcQueryString",String,_mcp.b);_mcp.b.f=new _a.e("BccRecipients",_j.P,_mcp.b);_mcp.b.q=new _a.e("BccQueryString",String,_mcp.b);_mcp.b.k=new _a.e("AutoAddSignature",Boolean,_mcp.b,!0);_mcp.b.S=new _a.e("Importance",String,_mcp.b,"Normal");_mcp.b.bx=new _a.e("QuotedBody",String,_mcp.b);_mcp.b.bG=new _a.e("SmimeContent",String,_mcp.b);_mcp.b.bI=new _a.e("SmimeErrorCode",Number,_mcp.b);_mcp.b.bJ=new _a.e("SmimeRecipientCerts",Array,_mcp.b);_mcp.b.bK=new _a.e("SmimeSigningCert",String,_mcp.b);_mcp.b.n=new _a.e("AttachmentsToAdd",Array,_mcp.b);_mcp.b.Y=new _a.e("IsComplete",Boolean,_mcp.b);_mcp.b.i=new _a.e("IsMeeting",Boolean,_mcp.b);_mcp.b.bc=new _a.e("IsMeetingForward",Boolean,_mcp.b);_mcp.b.bj=new _a.e("IsReplyAllOnBcc",Boolean,_mcp.b);_mcp.b.bn=new _a.e("Location",_dg.d,_mcp.b);_mcp.b.P=new _a.e("HasLocation",Boolean,_mcp.b);_mcp.b.U=new _a.e("InternetMessageId",String,_mcp.b);_mcp.b.by=new _a.e("Recurrence",_dg.r,_mcp.b);_mcp.b.bi=new _a.e("IsRecurringMaster",Boolean,_mcp.b);_mcp.b.bM=new _a.e("Start",_a.c,_mcp.b);_mcp.b.J=new _a.e("End",_a.c,_mcp.b);_mcp.b.cb=new _a.e("IsAllDayEventProperty",Boolean,_mcp.b);_mcp.b.L=new _a.e("From",_g.O,_mcp.b);_mcp.b.bC=new _a.e("Sender",_g.O,_mcp.b);_mcp.b.bm=new _a.e("IsUpgraded",Boolean,_mcp.b);_mcp.b.ba=new _a.e("IsFromShown",Boolean,_mcp.b);_mcp.b.W=new _a.e("IsCcShown",Boolean,_mcp.b);_mcp.b.V=new _a.e("IsBccShown",Boolean,_mcp.b);_mcp.b.bt=new _a.e("ParentFolderNameToPost",String,_mcp.b);_mcp.b.bs=new _a.e("ParentFolderIdToPost",_g.l,_mcp.b);_mcp.b.d=new _a.e("AttachmentCollection",_j.l,_mcp.b);_mcp.b.e=new _a.e("AttachmentProviderFiles",_j.l,_mcp.b);_mcp.b.o=new _a.e("AttachmentsToHide",Array,_mcp.b);_mcp.b.E=new _a.e("DocLinks",_a.j,_mcp.b);_mcp.b.bS=new _a.e("UpgradeFailed",Boolean,_mcp.b);_mcp.b.p=new _a.e("Baseline",_mcp.c,_mcp.b);_mcp.b.O=new _a.e("HasBeenSavedByUser",Boolean,_mcp.b);_mcp.b.N=new _a.e("HasBeenAutoSaved",Boolean,_mcp.b);_mcp.b.bQ=new _a.e("UnpromotedEmojiCountProperty",Number,_mcp.b);_mcp.b.bR=new _a.e("UnpromotedInlineImageCountProperty",Number,_mcp.b);_mcp.b.bk=new _a.e("IsReplyForward",Boolean,_mcp.b);_mcp.b.G=new _a.e("Draft",_g.h,_mcp.b);_mcp.b.M=new _a.e("GroupEmailAddress",_g.f,_mcp.b);_mcp.b.bA=new _a.e("RightsManagementLicenseData",_g.cL,_mcp.b);_mcp.b.y=new _a.e("ComplianceId",String,_mcp.b);_mcp.b.X=new _a.e("IsClassified",Boolean,_mcp.b);_mcp.b.v=new _a.e("ClassificationGuid",String,_mcp.b);_mcp.b.x=new _a.e("Classification",String,_mcp.b);_mcp.b.u=new _a.e("ClassificationDescription",String,_mcp.b);_mcp.b.w=new _a.e("ClassificationKeep",Boolean,_mcp.b);_mcp.b.bE=new _a.e("Sensitivity",String,_mcp.b,"Normal");_mcp.b.Z=new _a.e("IsDeliveryReceiptRequested",Boolean,_mcp.b);_mcp.b.bh=new _a.e("IsReadReceiptRequested",Boolean,_mcp.b);_mcp.b.bH=new _a.e("SmimeEncryptMessage",Boolean,_mcp.b);_mcp.b.bL=new _a.e("SmimeSignMessage",Boolean,_mcp.b);_mcp.b.z=new _a.e("ConversationId",_g.g,_mcp.b);_mcp.b.br=new _a.e("ParentConversationNodeId",String,_mcp.b);_mcp.b.s=new _a.e("CalendarItemModelType",_h.dv,_mcp.b);_mcp.b.be=new _a.e("IsOccurrenceReferencingMaster",Boolean,_mcp.b);_mcp.b.bg=new _a.e("IsPoppedOutFromReadingPane",Boolean,_mcp.b);_mcp.b.bb=new _a.e("IsLoadedDraft",Boolean,_mcp.b);_mcp.b.bU=new _a.e("WasCleanNewMessageBeforePopout",Boolean,_mcp.b);_mcp.b.R=new _a.e("HideIncludeEntrypoint",Boolean,_mcp.b,!1);_mcp.b.bV=new _a.e("WasSavingBeforePopout",Boolean,_mcp.b,!1);_mcp.b.bd=new _a.e("IsMovedToDraftFromOutbox",Boolean,_mcp.b,!1);_mcp.b.bv=new _a.e("PerfContext",_a.bI,_mcp.b,null);_mcp.b.bu=new _a.e("PerfContextE2E",_a.bI,_mcp.b,null);_mcp.b.bW=new _a.e("WaterfallTraceStarted",Boolean,_mcp.b,null);_mcp.b.bz=new _a.e("RichTextEditorSupported",Boolean,_mcp.b,null);_mcp.b.D=new _a.e("DlpSenderOverride",String,_mcp.b,null);_mcp.b.C=new _a.e("DlpFalsePositive",String,_mcp.b,null);_mcp.b.B=new _a.e("DlpDetectedClassification",String,_mcp.b,null);_mcp.b.K=new _a.e("ExplicitLogonUser",String,_mcp.b,null);_mcp.b.T=new _a.e("IncludeOriginalFromInToRecipients",Boolean,_mcp.b,!1);_mcp.b.h=new _a.e("ExtendedPropertyCollection",_j.l,_mcp.b,null);_mcp.b.bf=new _a.e("IsOnDemandUpgradeRequested",Boolean,_mcp.b,!1);_mcp.b.bl=new _a.e("IsResumingSendFailure",Boolean,_mcp.b,!1);_mcp.b.Q=new _a.e("HasSentViaNotification",Boolean,_mcp.b,!1);_mcp.b.bD=new _a.e("SendFailureInfobarMessageId",_bc.E,_mcp.b,45);_mcp.b.bF=new _a.e("SentFromMailComposeInlineReply",Boolean,_mcp.b);_mcp.b.bw=new _a.e("PopoutPerfContext",_a.bI,_mcp.b);_mcp.b.A=new _a.e("DiagnosticContent",String,_mcp.b);_mcp.b.c="UseOverride";_mcp.b.ca=new RegExp("(\r)?\n","gi");_mcp.b.a=null;_mcp.b.$$cctor();_mcp.c.u=new _a.e("Subject",String,_mcp.c,"");_mcp.c.m=new _a.e("EditorContent",String,_mcp.c,"");_mcp.c.h=new _a.e("ToRecipients",_j.l,_mcp.c);_mcp.c.v=new _a.e("ToQueryString",String,_mcp.c);_mcp.c.e=new _a.e("CcRecipients",_j.l,_mcp.c);_mcp.c.k=new _a.e("CcQueryString",String,_mcp.c);_mcp.c.d=new _a.e("BccRecipients",_j.l,_mcp.c);_mcp.c.j=new _a.e("BccQueryString",String,_mcp.c);_mcp.c.o=new _a.e("Importance",String,_mcp.c,"Normal");_mcp.c.n=new _a.e("From",_g.f,_mcp.c);_mcp.c.l=new _a.e("ComplianceId",String,_mcp.c);_mcp.c.r=new _a.e("Sensitivity",String,_mcp.c,"Normal");_mcp.c.p=new _a.e("IsDeliveryReceiptRequested",Boolean,_mcp.c);_mcp.c.q=new _a.e("IsReadReceiptRequested",Boolean,_mcp.c);_mcp.c.s=new _a.e("SmimeEncryptMessage",Boolean,_mcp.c);_mcp.c.t=new _a.e("SmimeSignMessage",Boolean,_mcp.c);_mcp.c.c=new _a.e("AttachmentCollection",_j.l,_mcp.c);_mcp.c.g=new _a.e("ExtendedPropertyCollection",_j.l,_mcp.c,null);_mcp.c.f=new _a.bv(_g.f);_mcp.c.$$cctor();_mcp.e.b=null;_mcp.l.a=_a.a.a;_mcp.bn.a=_a.a.a;_mcp.n.a=new _a.e("AttachmentWellViewModel",_y.bj,_mcp.n);_mcp.W.a=new _a.ba("Auto");_mcp.z.a=_a.a.eK;_mcp.D.a=new _y.h(_u.P.d,null,null);_mcp.H.a=new _a.e("Menu",_fm.f,_mcp.H);_mcp.X.a=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_mcp.h.c=new _a.e("FromDetailsViewModel",_bc.n,_mcp.h);_mcp.h.d=new _a.e("SenderDetailsViewModel",_bc.n,_mcp.h);_mcp.h.b=null;_mcp.h.a=null;_mcp.r.b=[84,85,86,87];_mcp.B.b=7;_mcp.B.a=1;_mcp.y.b=new _a.ba("Group");_mcp.y.a=[60,40,43,1001,700,50,800,88,89];_mcp.t.b=10;_mcp.t.c=new _a.e("Menu",_fm.f,_mcp.t);_mcp.g.e="";_mcp.g.d=null;_mcp.u.a=[62,45,46,47,700,55,70,65,97,66,75,800,88,80,48,89,90,91,92,101,93,94,98,99,100];_mcp.q.f="<P><BR></P>";_mcp.q.e=new RegExp("[\n\r]+","g");_mcp.q.c=new RegExp("(<img )([^>]*src=[\"']?data:image/[^<]+;base64,[a-zA-Z0-9+/=&#;]+[\"']?)([^>]*>)","gi");_mcp.q.b=new RegExp("(<[aA] [^>]*>)","gi");_mcp.q.d="EmojiInsert";_mcp.Y.a=new _mcp.Y(!0,!1);_mcp.a.g=_mcp.a.gk();_mcp.a.cB=null;_mcp.a.cx=null;_mcp.a.cE=null;_mcp.a.cC=null;_mcp.a.cD=null;_mcp.a.cy=null;_mcp.a.cz=null;_mcp.a.cA=null;_mcp.a.cF=null;_mcp.a.a={};_mcp.a.$$cctor();
window.scriptsLoaded['microsoft.owa.mail.compose.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.mail.compose.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
