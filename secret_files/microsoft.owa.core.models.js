try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.models.js'] = (new Date()).getTime();
Type.registerNamespace("_c");_c.f=function(n,t,i){_a.b.b(n,"activityManager");_a.b.b(t,"chatManagerFactory");_a.b.b(i,"owaLayout");if(i!=="Mouse")this.a=new _c.n(n);else{var r=this;t.a(function(t){var i=t.a();r.a=i.e()?new _c.C(n,i):new _c.n(n)})}};_c.f.prototype={a:null};_c.S=function(){};_c.S.prototype={success:0,warning:1,error:2};_c.S.registerEnum("_c.S",!1);_c.U=function(){};_c.U.prototype={Id:0,Dictionary:1,XmlData:2,BinaryData:3,All:4};_c.U.registerEnum("_c.U",!1);_c.p=function(n,t){_c.p.initializeBase(this);this.c=n;this.f=t};_c.p.prototype={c:null,f:null,K:function(n){n.dk(this.c,this.f,null,this.I,this.G)},cT:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.u=function(n,t){_c.u.initializeBase(this);_a.b.b(n,"folderId");_a.b.b(t,"conversationCount");this.i=n;this.f=t};_c.u.prototype={i:null,f:0,c:null,K:function(n){n.eY(this.i,this.f,null,this.I,this.G)},cT:function(n,t,i){this.c=n.Conversations;t()}};_c.v=function(){_c.v.initializeBase(this)};_c.v.prototype={f:null,c:null,K:function(n){var t=new _gg.oN(this.L);t.actionName="GetRegionalConfiguration";this.c=_a.d.b(_a.a.ek,"GetRegionalConfiguration",!0);var i=new _gg.fb;n.B(i,t,this.I,this.G)},cT:function(n,t,i){if(this.c){this.c.l=this.O();_a.d.a(this.c);this.c=null}if(n.SupportedCultures&&n.SupportedCultures.length>0){this.f=n.SupportedCultures;t();return}i(Error.create("Get regional information failed to retrieve at least one valid language."))},ba:function(n){_h.fa.prototype.ba.call(this,Error.create(n.message));if(this.c){this.c.l=this.O();this.c.k=n.name.toString();_a.d.a(this.c);this.c=null}}};_c.x=function(){_c.x.initializeBase(this)};_c.x.prototype={c:null,K:function(n){var t=new _gg.oQ(this.L);n.cm(t,this.I,this.G)},cT:function(n,t,i){try{_a.b.b(n,"themeSelectionInfo");this.c=n;t()}catch(r){i(r)}}};_c.L=function(n,t){_c.L.initializeBase(this);this.c=n;this.f=t};_c.L.prototype={c:null,f:!1,K:function(n){var r=new _gg.oZ(this.L);var t;var i=(t=new _gg.df,t.ThemeId=this.c,t.SkipO365Call=this.f,t);n.cV(i,r,this.I,this.G)},cT:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.n=function(n){_c.n.initializeBase(this,[n])};_c.n.prototype={c:function(){return"KeepAliveActivityMonitor"},a:function(){return 24e4},d:function(){return 3e5},h:function(n){var t=new Sys.Net.WebRequest;t.set_url(_j.i.a(_a.g.n)?"ping.owa":_a.g.n);t.set_timeout(6e4);t.invoke()}};function CoreModelsComponent(){}CoreModelsComponent.$$cctor=function(){_a.u.a().a(CoreModelsComponent)};CoreModelsComponent.prototype={a:function(n,t,i){n.e(_c.B).b(IPopOutMailboxDataContextFactory).a();var r=this;n.b(_c.f,function(){return new _c.f(n.a(_a.bn),n.c(IChatManagerFactory),i.a())}).a();n.e(_c.F).a().b(IAddEventToMyCalendarResponseProcessorFactory);n.e(_c.G).a().b(ICreateAttachmentResponseProcessorFactory);n.e(_c.H).a().b(IDeleteAttachmentResponseProcessorFactory);n.e(_c.I).a().b(IDeletePlaceResponseProcessorFactory);n.e(_c.J).a().b(IPerformReminderActionResponseProcessorFactory)},b:function(){return[new _j.w(_c.f,2,1)]}};_c.s=function(n,t,i){_c.s.initializeBase(this,[t,i]);this.f=n};_c.s.prototype={f:null,i:function(){return!0},o:function(n){n.ActionType=0},n:function(n,t){for(var i=0;i<this.f.x.length;i++){var r=this.f.x[i];if(_ff.e.b(n.c(),r.c())){this.f.p(i);break}}}};_c.t=function(){this.c=-1;_c.t.initializeBase(this)};_c.t.prototype={cT:function(n,t,i){this.c=n;t()},K:function(n){n.bL(null,this.I,this.G)}};_c.M=function(n,t,i){_c.M.initializeBase(this,[n,i]);this.f=t};_c.M.prototype={f:null,i:function(){return!0},o:function(n){var t=_a.c.l(this.f);n.ActionType=1;n.NewReminderTime=t},n:function(n,t){n.k(this.f)}};_c.z=function(n,t){_c.z.initializeBase(this);this.f=n;this.c=t};_c.z.prototype={f:null,c:null,i:null,K:function(n){var r=new _g.g(this.f);var u=new _gg.lv(r,this.c);var t=new _gg.lu(this.M(),u);var i=new _gg.CP(this.L);n.gH(t,i,this.I,this.G)},cJ:function(n){this.i=n}};_c.A=function(n){_c.A.initializeBase(this);this.c=n};_c.A.prototype={c:null,K:function(n){var r=new _gg.lt(this.c);var u=new _gg.ik(r);var t=new _gg.ij(this.M(),u);var i=new _gg.tx(this.L);n.ef(t,i,this.I,this.G)},cJ:function(n){}};_c.y=function(n){_c.y.initializeBase(this);this.c=n};_c.y.prototype={c:null,K:function(n){var t=new _gg.yp(0);t.timeZone=this.bg();n.cb(t,this.I,this.G)},cT:function(n,t,i){try{if(!n){i(Error.create(_nbs.a.US));return}this.c.d(n.ExternalAudience);this.c.e(n.ExternalReply);this.c.f(n.InternalReply);this.c.b(n.IsOofOn);this.c.g(n.IsScheduled);this.c.c(_a.c.b(n.EndTime));t()}catch(r){i(r)}}};_c.K=function(n){_c.K.initializeBase(this);this.c=n};_c.K.prototype={c:null,K:function(n){var t=new _gg.nI;t.ExternalAudience=this.c.h();t.ExternalReply=this.c.i();t.InternalReply=this.c.j();t.IsOofOn=this.c.a();n.hK(t,null,this.I,this.G)},cT:function(n,t,i){if(!n){i(Error.create(_bms.E.BA));return}t()}};_c.D=function(n){_c.D.initializeBase(this);this.c=n};_c.D.prototype={c:null,K:function(n){n.gU(this.c,null,this.I,this.G)},cT:function(n,t,i){try{if(!n){i(Error.create(_bms.E.BA));return}t()}catch(r){i(r)}}};_c.Q=function(n,t){_c.Q.initializeBase(this);_a.b.b(n,"remindersToPerformAction");_a.b.b(t,"nativeBridge");this.c=n;this.l=t};_c.Q.prototype={c:null,l:null,K:function(n){var i=this.q();var t=new _gg.CI(this.L);t.shouldPrecedeOfflineSyncActions=this.i();n.cz(i,t,this.k,this.j)},R:function(){_a.cU.prototype.R.call(this);for(var n=0;n<this.c.length;n++)this.n(this.c[n],this.l)},q:function(){var t=new _gg.fK;t.ReminderItemActions=this.p();var n=new _gg.lq(this.M());n.Body=t;return n},p:function(){for(var i=new Array(this.c.length),n=0;n<this.c.length;n++){var u=this.c[n];var r=new _g.g(u.c().Id);r.ChangeKey=u.c().ChangeKey;var t=new _gg.lD;t.ItemId=r;this.o(t);i[n]=t}return i}};_c.g=function(n,t){_c.g.initializeBase(this,[0]);this.i=n;var i=_g.b.a.nameToId("todosearch");t&&t!==i||(t=_g.b.a.nameToId("tasks"));this.bp=_g.n.c(t);this.bf="CreateTask"};_c.g.prototype={i:null,f:null,bn:function(){return[this.j()]},cJ:function(n){this.f=n.Items[0].ItemId},j:function(){for(var t=new _g.bO,f=this.i.d,o=this.i.f(),r=o,e=r.length,n=0;n<e;++n){var u=r[n];var i=_c.a.b(u);i&&i(t,f)}t.Owner=_g.a.a().c().bk.UserDisplayName;return t}};_c.q=function(n,t){_c.q.initializeBase(this);_a.b.b(n,"ParentGroup");this.i=n;var i=new _gg.bJ;i.c(n.bk.GroupId);this.c=i;this.f=new _gg.gT;this.k=t};_c.q.prototype={c:null,f:null,i:null,k:null,l:function(n){if(!_j.i.b(n)){this.c.a(n);this.f.f(n)}},K:function(n){n.dN(this.c.bk.FolderName,this.c.bk.ParentGroupId,null,this.I,this.G)},n:function(n){var t=new _g.l(n.NewFolderId.Id);t.ChangeKey=n.NewFolderId.ChangeKey;this.f.h(t);this.f.v(_g.b.a.nameToId("tasks"));this.c.e(t);this.c.f(n.NewTaskFolderEntryId);var i=_h.a.b("msgfolderroot");i.bu.a(this.f);this.k.n(this.i,this.c,this.f)}};_c.r=function(n,t,i){_c.r.initializeBase(this);_a.b.b(n,"taskFolderToDelete");_a.b.b(t,"parentGroup");_a.b.b(i,"taskGroupsCache");this.c=n;this.f=t;this.i=i};_c.r.prototype={c:null,f:null,i:null,K:function(n){var t=new _g.g(this.c.bk.ItemId.Id);t.ChangeKey=this.c.bk.ItemId.ChangeKey;n.dZ(t,null,this.I,this.G)},n:function(n){this.i.t(this.f,this.c)}};_c.l=function(n,t,i){_c.l.initializeBase(this,[n,t])};_c.l.prototype={bn:function(){this.bh&&(this.F=new _g.E(_g.n.a(this.bh)));var t=[];var r=this.bk(this.c);var n=new _g.v(new _g.d("TaskStatus"));n.Item=new _g.bO;n.Item.Status=r;Array.add(t,n);if(r==="InProgress"){var i=null;if(this.c.c()){n=new _g.v(new _g.d("TaskStartDate"));n.Item=new _g.bO;n.Item.StartDate=this.c.c().i();Array.add(t,n)}else{i=new _g.bh(new _g.d("TaskStartDate"));Array.add(t,i)}if(this.c.b()){n=new _g.v(new _g.d("TaskDueDate"));n.Item=new _g.bO;n.Item.DueDate=this.c.b().i();Array.add(t,n)}else{i=new _g.bh(new _g.d("TaskDueDate"));Array.add(t,i)}}if(r==="InProgress"||r==="Completed")if(this.c.e()){n=new _g.v(new _g.d("TaskCompleteDate"));n.Item=new _g.bO;n.Item.CompleteDate=this.c.e().i();Array.add(t,n)}else{var u=new _g.bh(new _g.d("TaskCompleteDate"));Array.add(t,u)}return t},t:function(){for(var r=this.bn(),t=new Array(this.o.length),n=0;n<this.o.length;n++){var i=new _g.g(this.o[n].bk.ItemId.Id);i.ChangeKey=this.o[n].bk.ItemId.ChangeKey;t[n]=new _g.bq;t[n].ItemId=i;t[n].Updates=r}return t},R:function(){var t=this.bk(this.c);var n=this.o;var l=this,c=this;_h.c.c(_dg.k,String,n,"Status",function(n){return n.b()},t,function(n,t){n.t(t)});var h=this,a=this;_h.c.c(_dg.k,Boolean,n,"IsComplete",function(n){return n.l()},t==="Completed",function(n,t){n.J(t)});if(t==="InProgress"){if(this.c.c()){var p=this,y=this;_h.c.c(_dg.k,_a.c,n,"StartDate",function(n){return n.i()},this.c.c(),function(n,t){n.M(t)})}if(this.c.b()){var v=this,u=this;_h.c.c(_dg.k,_a.c,n,"DueDate",function(n){return n.f()},this.c.b(),function(n,t){n.G(t)})}if(this.c.e()){var r=this,i=this;_h.c.c(_dg.k,_a.c,n,"CompleteDate",function(n){return n.h()},this.c.e(),function(n,t){n.z(t)})}}else if(t==="Completed"){var f=this,s=this;_h.c.c(_dg.k,String,n,"PercentComplete",function(n){return n.bk.PercentComplete},"100",function(n,t){n.L(t)});var o=this,e=this;_h.c.c(_dg.k,_a.c,n,"CompleteDate",function(n){return n.h()},this.c.e().e(),function(n,t){n.z(t)})}},bk:function(n){var t="NotStarted";switch(n.a()){case"NotFlagged":throw Error.invalidOperation("ClearFlag cannot be called to a Task object.");case"Complete":t="Completed";break;case"Flagged":t="InProgress";break}return t}};_c.w=function(){_c.w.initializeBase(this)};_c.w.prototype={c:null,K:function(n){var t=new _gg.zj(this.L);n.fS(t,this.I,this.G)},cT:function(n,t,i){try{this.f(n)}catch(r){i(r);return}t()},f:function(n){n&&(this.c=n.TaskGroups)}};_c.m=function(n,t,i,r,u,f){_c.m.initializeBase(this,[n,t,null,"TaskListItem",i,r,u,f,!1,null,null,0,null,-1,null,!1])};_c.m.prototype={bB:function(){return _h.ck.a(this.u.a,this.u.b,this.t)}};_c.E=function(n,t,i){_c.E.initializeBase(this);_a.b.b(n,"taskFolderToRename");_a.b.c(t,"newTaskFolderName");_a.b.b(i,"taskGroupsCache");this.c=n;this.f=t;this.i=i};_c.E.prototype={c:null,f:null,i:null,K:function(n){var t=new _g.g(this.c.bk.ItemId.Id);t.ChangeKey=this.c.bk.ItemId.ChangeKey;n.hb(t,this.f,null,this.I,this.G)},n:function(n){this.c.bk.ItemId.ChangeKey=n.NewTaskFolderEntryId.ChangeKey;this.c.a(this.f);if(this.i.b){var t=this.i.j(this.c.bk.TaskFolderId);if(t){t.bk.FolderId.ChangeKey=n.NewFolderId.ChangeKey;t.f(this.f)}}}};_c.T=function(){this.j=String.format(_nbs.a.mi,-1);_c.T.initializeBase(this)};_c.T.prototype={cT:function(n,t,i){if(!n.WasSuccessful){this.j=_c.N.a(n.ErrorCode);i(Error.create(this.j));return}try{this.n(n)}catch(r){i(r);return}t()}};_c.N=function(){};_c.N.a=function(n){switch(n){case 11:return _nbs.a.dW;case 13:return _nbs.a.hQ;case 7:return _nbs.a.Ii;default:return String.format(_nbs.a.mi,n)}};_c.b=function(n,t){this.b=n;this.a=t};_c.b.prototype={b:"FolderId",a:!1};_c.a=function(){};_c.a.b=function(n){_c.a.c();return _c.a.a[n]};_c.a.c=function(){if(!_c.a.a){_c.a.a={};_c.a.a.Subject=function(n,t){n.Subject=t.bk.Subject;return new _c.b("Subject",!1)};_c.a.a.DueDate=function(n,t){var i=!t.f();i||(n.DueDate=t.f().i());return new _c.b("TaskDueDate",i)};_c.a.a.Body=function(n,t){n.Body=new _g.s(t.I().a()==="HTML"?"HTML":"Text",t.I().bk.Value);return new _c.b("Body",!1)};_c.a.a.StartDate=function(n,t){var i=!t.i();i||(n.StartDate=t.i().i());return new _c.b("TaskStartDate",i)};_c.a.a.Importance=function(n,t){n.Importance=t.bM();return new _c.b("Importance",!1)};_c.a.a.Status=function(n,t){n.Status=t.b();return new _c.b("TaskStatus",!1)};_c.a.a.CompleteDate=function(n,t){var i=!t.h();i||(n.CompleteDate=t.h().i());return new _c.b("TaskCompleteDate",i)};_c.a.a.PercentComplete=function(n,t){n.PercentComplete=t.bk.PercentComplete;return new _c.b("TaskPercentComplete",!1)};_c.a.a.Sensitivity=function(n,t){n.Sensitivity=t.bR();return new _c.b("Sensitivity",!1)};_c.a.a.TotalWork=function(n,t){n.TotalWork=t.s();return new _c.b("TaskTotalWork",!1)};_c.a.a.ActualWork=function(n,t){n.ActualWork=t.n();return new _c.b("TaskActualWork",!1)};_c.a.a.Mileage=function(n,t){n.Mileage=t.bk.Mileage;return new _c.b("TaskMileage",!1)};_c.a.a.BillingInformation=function(n,t){n.BillingInformation=t.bk.BillingInformation;return new _c.b("TaskBillingInformation",!1)};_c.a.a.Companies=function(n,t){var r=!t.g()&&t.g().b()>0;if(!r){for(var u=new Array(t.g().b()),i=0;i<t.g().b();i++)u[i]=t.g().a(i);n.Companies=u}return new _c.b("TaskCompanies",r)};_c.a.a.ReminderIsSet=function(n,t){n.ReminderIsSet=t.bk.ReminderIsSet;return new _c.b("ReminderIsSet",!1)};_c.a.a.ReminderDueBy=function(n,t){var i=!t.eh();i||(n.ReminderDueBy=t.eh().i());return new _c.b("ReminderDueBy",i)};_c.a.a.Recurrence=function(n,t){var i=!t.w();i||(n.Recurrence=t.w().bk);return new _c.b("TaskRecurrence",i)};_c.a.a.ModernReminders=function(n,t){var i=!t.v();i||(n.ModernReminders=t.v().h.p);return new _c.b("ModernReminders",i)};_c.a.a.Charm=function(n,t){n.Charm=t.o();return new _c.b("TaskCharm",!1)}}};_c.e=function(n){_c.e.initializeBase(this,[0]);this.c=n;var t=n.d;t.bk.ParentFolderId&&(this.bl=_g.n.c(t.bk.ParentFolderId));this.r="UpdateTask"};_c.e.a=function(n,t,i){if(i){var f=new _g.bO;var e=i(f,t);var r=new _g.d(e.b);if(e.a){var o=new _g.bh(r);Array.add(n,o)}else{var u=new _g.v(r);u.Item=f;Array.add(n,u)}}};_c.e.prototype={c:null,t:function(){for(var i=[],u=this.c.d,o=this.c.f(),r=o,f=r.length,n=0;n<f;++n){var e=r[n];_c.e.a(i,u,_c.a.b(e))}var t=new _g.bq;t.ItemId=_g.g.a(u.bk.ItemId);t.Updates=i;return[t]}};_c.CalendarTimePeriodSchema=function(){};_c.C=function(n,t){_c.C.initializeBase(this,[n]);this.f=t};_c.C.prototype={f:null,c:function(){return"PresenceActivityMonitor"},a:function(){return 24e4},d:function(){return 3e5},h:function(n){this.f.x()}};_c.d=function(n,t){this.b=n;this.a=t};_c.d.prototype={b:0,a:null};_c.k=function(){_c.k.initializeBase(this)};_c.k.prototype={k:0,l:null,m:null,n:!1,p:!1,o:null,h:function(){return this.k},d:function(n){if(n===this.k)return n;this.k=n;this.eu("ExternalAudience");return n},i:function(){return this.l},e:function(n){if(n===this.l)return n;this.l=n;this.eu("ExternalReply");return n},j:function(){return this.m},f:function(n){if(n===this.m)return n;this.m=n;this.eu("InternalReply");return n},a:function(){return this.n},b:function(n){if(n===this.n)return n;this.n=n;this.eu("IsOofOn");return n},g:function(n){if(n===this.p)return n;this.p=n;this.eu("IsScheduled");return n},c:function(n){if(n===this.o)return n;this.o=n;this.eu("EndTime");return n}};_c.B=function(){};_c.B.prototype={a:function(n,t,i,r){return new _c.h(n,t,new _g.ea(r),i,_g.k.b)}};_c.h=function(n,t,i,r,u){_c.h.initializeBase(this,[null,n,t,i,r]);this.a=u};_c.h.prototype={a:null,A:function(){return this.a},z:function(n,t,i){},u:function(n,t,i){},q:function(n){return n},E:function(n,t,i,r,u){_j.e.a(_c.h.a,"ExecuteWithActionQueue {0}",n);this.a.iF(n,t,i,r,u);return}};_c.R=function(){_c.R.initializeBase(this)};_c.R.prototype={callState:null};_c.P=function(n,t,i){_c.P.initializeBase(this,[n]);this.h=_j.C.a(t)?"All":t;this.e=i?i:new _h.p("TaskDueDate","Ascending");this.f=this.f+"_item_"+this.h+"_"+this.e.a.toString()+"_"+this.e.b.toString()+"_"};_c.P.prototype={h:"All",e:null,c:function(){return this.h},d:function(){return _h.ck.a(this.e.a,this.e.b,this.g)}};_c.o=function(n,t){_c.o.initializeBase(this,[n,null,t?t:_c.o.a(n)])};_c.o.a=function(n){return[new _h.v(n,!1,n.d(),n.c())]};_c.o.prototype={by:function(){return _a.a.fu},Q:function(){return this.bx.h},bC:function(){return this.bx.e},q:function(){return null},y:function(){return!1},C:function(n,t){var i=this;n.k(function(){i.cm==="ErrorConnectionFailed"&&n.i()&&n.f()?t(6):t(1)})},cB:function(n){},bP:function(n){var t=Math.max(this.cW(),this.bu.x.length);this.bY(4);this.bJ(this.cA(t,this.f()))},bE:function(n,t){if(!_h.n.isInstanceOfType(n))throw Error.argumentType("range",n?Object.getType(n):null,_h.n,"range needs to be an IndexedRange object");return this.cA(n.b,n.a)},J:function(n){return!1},cY:function(n,t){var i=n;i.dj(t)},cH:function(n,t){return!0},cq:function(n,t){return-2},cz:function(n,t,i){return new _c.m(this.d(),this.q(),n,!1,this.Q(),this.bC())},cA:function(n,t){return new _c.m(this.d(),this.q(),_h.t.a(t,n),!1,this.Q(),this.bC())}};_c.O=function(){this.g=Function.createDelegate(this,this.q);this.h=Function.createDelegate(this,this.r);this.i=Function.createDelegate(this,this.s);this.a={};this.e=[];_c.O.initializeBase(this)};_c.O.prototype={c:null,b:!1,d:!1,f:0,m:function(n){this.bw("CachePopulated",n)},u:function(n){if(n!==this.b){this.b=n;this.bs("IsLoaded")}return n},p:function(){return _nbs.a.bu},j:function(n){return this.a?n.Id in this.a?this.a[n.Id]:null:null},k:function(n){if(this.b){n&&n();return!0}n&&Array.add(this.e,n);this.o();return!1},n:function(n,t,i){_a.b.a(n,"parentGroup");_a.b.a(t,"taskFolderEntry");_a.b.a(i,"folder");t.c(n.bk.GroupId);n.a().c(t);this.a[t.bk.TaskFolderId.Id]=i},t:function(n,t){_a.b.a(n,"parentGroup");_a.b.a(t,"taskFolder");delete this.a[t.bk.TaskFolderId.Id];n.a().l(t)},o:function(){if(!this.d){this.d=!0;this.l()}},l:function(){var n=new _c.w;n.d(this.i);n.e(this.h);n.b(this.g);_a.g.a.a(n)},s:function(n){var c=n;this.c=new _j.l;this.a={};for(var l=!1,s=0;s<c.c.length;s++){var i=new _gg.gS(c.c[s]);i.b()||i.c(_nbs.a.ND);for(var f=i.a().b()-1;f>=0;f--){var t=i.a().a(f);var u=null;if(t.b()===1){u=_g.j.a("todosearch");l=!0;t.a(_nbs.a.cI);u.f(_nbs.a.cI)}else{u=_h.a.a(t.bk.TaskFolderId);t.b()===2&&t.a(u.f(this.p()))}u?this.a[t.bk.TaskFolderId.Id]=u:i.a().q(f)}this.c.a(i)}if(!l&&this.c.x.length>0){var h=this.c.x[0];var o=_g.j.a("todosearch");o.f(_nbs.a.cI);var r=new _gg.bJ;r.a(_nbs.a.cI);r.g(1);r.e(o.bk.FolderId);r.c(h.bk.GroupId);h.a().r(0,r);this.a[r.bk.TaskFolderId.Id]=o}this.u(!0);this.d=!1;this.bG("CachePopulated",this,null);for(var e=0;e<this.e.length;e++)this.e[e]();this.e=[]},r:function(n){if(this.f<3){var t=this;_j.n.a().a(_a.a.bH,"GetTaskFoldersActionRetry",function(){t.l()},2e3);this.f++}else{this.f=0;this.d=!1}},q:function(n){n.V(this.i);n.U(this.h);n.m(this.g)}};_c.c=function(n,t,i,r){_c.c.initializeBase(this,[n,t,_c.c.b(),"None",i,r,!0])};_c.c.b=function(){if(!_c.c.a){_c.c.a=new _g.ba("IdOnly");_c.c.a.AddBlankTargetToLinks=!0;_c.c.a.ClientSupportsIrm=!0;_c.c.a.FilterHtmlContent=!0;_c.c.a.InlineImageUrlTemplate=_g.x.d();_c.c.a.MaximumBodySize=0;_c.c.a.AdditionalProperties=[new _g.d("UID"),new _g.d("ItemParentId"),new _g.d("InstanceKey"),new _g.d("Subject"),new _g.d("TaskDueDate"),new _g.d("Body"),new _g.d("NormalizedBody"),new _g.d("HasAttachments"),new _g.d("Attachments"),new _g.d("TaskStartDate"),new _g.d("Importance"),new _g.d("TaskStatus"),new _g.d("TaskCompleteDate"),new _g.d("TaskPercentComplete"),new _g.d("Sensitivity"),new _g.d("TaskOwner"),new _g.d("Categories"),new _g.d("TaskTotalWork"),new _g.d("TaskActualWork"),new _g.d("TaskMileage"),new _g.d("TaskBillingInformation"),new _g.d("TaskCompanies"),new _g.d("TaskRecurrence"),new _g.d("ReminderDueBy"),new _g.d("ReminderIsSet"),new _g.d("ReminderNextTime"),new _g.d("ReminderMinutesBeforeStart"),new _g.d("ItemLastModifiedTime"),new _g.d("TaskIsComplete"),new _g.d("TaskIsTaskRecurring"),new _g.d("ItemClass"),new _g.d("TaskDelegationState"),new _g.d("TaskDoItTime"),new _g.d("TaskCharm")]}return _c.c.a};_c.c.prototype={cJ:function(n){try{_h.bV.prototype.cJ.call(this,n)}catch(t){this.bN("ProcessResponseMessageFailed",this);throw t;}}};_c.i=function(n,t){_c.i.initializeBase(this,[n,t,_c.i.a])};_c.F=function(){};_c.F.prototype={a:function(n,t,i){return new _c.i(n,t)}};_c.CreateAttachmentResponseProcessor=function(n,t,i){_c.CreateAttachmentResponseProcessor.initializeBase(this,[n,t,_c.CreateAttachmentResponseProcessor.a]);_a.b.b(i,"nativeBridge");this.i=i};_c.CreateAttachmentResponseProcessor.prototype={i:null,j:function(n,t){var r=null;var i=null;if(t.ResponseClass==="Success"){r=t.Attachments[0].AttachmentId;i=new _g.g(r.RootItemId);i.ChangeKey=r.RootItemChangeKey;var f=this.g().Body.ParentItemId;this.e.u(this.b,f,i)}if(this.a()){var e=this.a().attachmentIds[n];this.t(t.ResponseClass,e,r,i);if(this.a().palContext&&this.a().palContext.palActionNeeded&&this.i.b(this.i.i())){var u=this.i.i().b();u.e(this.a().dataFile);this.i.i().a(u.c())}}_h.dh.prototype.j.call(this,n,t)},t:function(n,t,i,r){n==="Success"?this.y(t,i,r):this.u(t)},y:function(n,t,i){var u=new _g.bm(t.Id);this.e.z(this.b,n,u);if(this.l()&&this.a().clientStoreItem===2){this.b.b().b(!1);var r=this;this.d().a().d(this.b,this.d().h().b(i.Id),function(t){if(_j.C.a(t)){_j.e.b(r.f,"Message with id {0} not found in local store",i.Id);return}r.z(t,n,u)})}},u:function(n){if(this.l()&&this.a().clientStoreItem===2){this.b.b().b(!1);var r=this.c.request.parameters;var t=new _g.g(r.Body.Attachments[0].AttachmentId.RootItemId);var i=this;this.d().a().d(this.b,this.d().h().b(t.Id),function(r){if(!r){_j.e.b(i.f,"Message with id {0} not found in local store",t.Id);return}i.m(r,n)})}},z:function(n,t,i){var u=n;if(!u.HasAttachments){_j.e.c(this.f,"UpdateItemAttachmentId invoked with item that has no attachments.");return}if(!u.Attachments){_j.e.c(this.f,"UpdateItemAttachmentId invoked with item that has null attachment collection.");return}for(var e=u.Attachments,o=e.length,r=0;r<o;++r){var f=e[r];if(f.AttachmentId.Id===t.Id){f.AttachmentId.Id=i.Id;return}}_j.e.b(this.f,"Attachment with id {0} not found in local store",t.Id)},m:function(n,t){var i=n;if(i.HasAttachments&&i.Attachments){for(var r=0;r<i.Attachments.length;r++)if(i.Attachments[r].AttachmentId.Id===t.Id){Array.removeAt(i.Attachments,r);break}_j.e.b(this.f,"Attachment with id {0} not found in local store",t.Id)}}};_c.G=function(){};_c.G.prototype={a:function(n,t,i){return new _c.CreateAttachmentResponseProcessor(n,t,i)}};_c.DeleteAttachmentResponseProcessor=function(n,t){_c.DeleteAttachmentResponseProcessor.initializeBase(this,[n,t,_c.DeleteAttachmentResponseProcessor.a])};_c.DeleteAttachmentResponseProcessor.prototype={j:function(n,t){var i=this.a().itemContexts[n];if(t.ResponseClass==="Success"){var f=this.e.q(i.parentItemId);var r=new _g.g(t.RootItemId.RootItemId);r.ChangeKey=t.RootItemId.RootItemChangeKey;this.e.u(this.b,f,r)}else if(this.l()&&i.clientStoreItem===2){this.b.b().b(!1);var u=this.e.q(i.parentItemId);this.d().a().g(this.b,this.d().h().b(u.Id),i.deletedAttachment)}_h.dh.prototype.j.call(this,n,t)}};_c.H=function(){};_c.H.prototype={a:function(n,t,i){return new _c.DeleteAttachmentResponseProcessor(n,t)}};_c.j=function(n,t){_c.j.initializeBase(this,[n,t,_c.j.a])};_c.I=function(){};_c.I.prototype={a:function(n,t,i){return new _c.j(n,t)}};_c.PerformReminderActionResponseProcessor=function(n,t){_c.PerformReminderActionResponseProcessor.initializeBase(this,[n,t,_c.PerformReminderActionResponseProcessor.a])};_c.J=function(){};_c.J.prototype={a:function(n,t,i){return new _c.PerformReminderActionResponseProcessor(n,t)}};_c.f.registerClass("_c.f");_c.p.registerClass("_c.p",_h.fa,_a.fs);_c.u.registerClass("_c.u",_h.fa);_c.v.registerClass("_c.v",_h.fa);_c.x.registerClass("_c.x",_h.fa,_a.fs);_c.L.registerClass("_c.L",_h.fa);_c.n.registerClass("_c.n",_a.hJ);CoreModelsComponent.registerClass("CoreModelsComponent",null,_a.ic,_j.ce);_c.Q.registerClass("_c.Q",_h.fb);_c.s.registerClass("_c.s",_c.Q);_c.t.registerClass("_c.t",_h.fa);_c.M.registerClass("_c.M",_c.Q);_c.z.registerClass("_c.z",_h.cO.$$(_gg.CQ,_gg.CR));_c.A.registerClass("_c.A",_h.cO.$$(_gg.ty,_gg.tz));_c.y.registerClass("_c.y",_h.fa);_c.K.registerClass("_c.K",_h.fa);_c.D.registerClass("_c.D",_h.fa,_a.fs);_c.g.registerClass("_c.g",_h.ez);_c.T.registerClass("_c.T",_h.fa);_c.q.registerClass("_c.q",_c.T);_c.r.registerClass("_c.r",_c.T);_c.l.registerClass("_c.l",_h.bp);_c.w.registerClass("_c.w",_h.fa);_c.m.registerClass("_c.m",_h.bd);_c.E.registerClass("_c.E",_c.T);_c.e.registerClass("_c.e",_h.cL);_c.C.registerClass("_c.C",_a.hJ);_c.d.registerClass("_c.d");_c.k.registerClass("_c.k",_a.cl);_c.B.registerClass("_c.B",null,IPopOutMailboxDataContextFactory);_c.h.registerClass("_c.h",_g.k);_c.R.registerClass("_c.R",_no.k);_c.R.prototype.toString=_no.k.prototype.toString;_c.P.registerClass("_c.P",_h.ds.$$(_c.o),_h.eN);_c.o.registerClass("_c.o",_lm.d);_c.O.registerClass("_c.O",_j.Q);_c.c.registerClass("_c.c",_h.bV);_c.i.registerClass("_c.i",_h.di.$$(_gg.pz,Boolean));_c.F.registerClass("_c.F",null,IAddEventToMyCalendarResponseProcessorFactory,_h.eq);_c.CreateAttachmentResponseProcessor.registerClass("_c.CreateAttachmentResponseProcessor",_h.dh.$$(_gg.oq,_gg.ek,_gg.hy,_gg.hh));_c.G.registerClass("_c.G",null,ICreateAttachmentResponseProcessorFactory,_h.eq);_c.DeleteAttachmentResponseProcessor.registerClass("_c.DeleteAttachmentResponseProcessor",_h.dh.$$(_gg.sJ,_gg.hO,_gg.hP,_gg.hR));_c.H.registerClass("_c.H",null,IDeleteAttachmentResponseProcessorFactory,_h.eq);_c.j.registerClass("_c.j",_h.di.$$(_gg.tc,_pc.a));_c.I.registerClass("_c.I",null,IDeletePlaceResponseProcessorFactory,_h.eq);_c.PerformReminderActionResponseProcessor.registerClass("_c.PerformReminderActionResponseProcessor",_h.dh.$$(_gg.CI,_gg.lq,_gg.lr,_g.gi));_c.J.registerClass("_c.J",null,IPerformReminderActionResponseProcessorFactory,_h.eq);CoreModelsComponent.$$cctor();_c.a.a=null;_c.CalendarTimePeriodSchema.c=new _a.e("Start",_a.c,_dg.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.a=new _a.e("End",_a.c,_dg.ICalendarTimePeriod);_c.CalendarTimePeriodSchema.b=new _a.e("Recurrence",_dg.r,_dg.ICalendarTimePeriod);_c.h.a=_a.a.eY;_c.c.a=null;_c.i.a=_a.a.du;_c.CreateAttachmentResponseProcessor.a=_a.a.c;_c.DeleteAttachmentResponseProcessor.a=_a.a.c;_c.j.a=_a.a.ep;_c.PerformReminderActionResponseProcessor.a=_a.a.eV;
window.scriptsLoaded['microsoft.owa.core.models.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.models.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
