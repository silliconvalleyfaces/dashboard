try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.o365.shellg2.metile.owa.js'] = (new Date()).getTime();
function MeTileComponent(){}MeTileComponent.$$cctor=function(){_a.u.a().a(MeTileComponent)};MeTileComponent.prototype={a:function(n,t,i){var r=this;n.b(IMeTileViewModel,function(){return new _o365sg2pmetile.b}).b(IMeTileViewModel).a()},b:function(){return null}};Type.registerNamespace("_o365sg2pmetile");_o365sg2pmetile.b=function(){this.bg=Function.createDelegate(this,this.bA);_o365sg2pmetile.b.resolveInheritance();this.i=this.Q;this.a=this.cm;_o365sg2pmetile.b.initializeBase(this)};_o365sg2pmetile.b.prototype={be:null,W:null,X:0,S:null,O:0,K:null,j:function(){return this.K},s:function(n){this.K=n;return n},M:null,b:function(){return this.M},C:null,c:function(){return this.C},r:function(n){if(this.be!==n){this.be=n;this.bs("MenuTemplateId")}return n},U:!1,n:function(){return this.U},N:null,e:function(){return this.N},Y:null,o:function(){return this.Y},V:null,g:function(){return this.V},k:function(){return this.X},f:function(n){if(this.X!==n){this.X=n;this.bs("UserPresence")}return n},m:function(){return this.S},h:function(n){if(this.S!==n){this.S=n;this.bs("OnMeTileClicked")}return n},l:function(){return this.O},d:function(n){if(this.O!==n){this.O=n;this.bs("MenuState");this.w().c()||this.bh()}return n},p:function(n,t){var r;try{r=n}catch(f){throw _o365cl.a.a(415006,"userPhotoViewModels",6,1);}var i;try{i=t}catch(u){throw _o365cl.a.a(415007,"rightMenusViewModel",6,1);}this.bq(r,i)},bq:function(n,t){if(!t)throw _o365cl.a.a(300443,"rightMenusViewModel",6,1);this.d(0);this.K=new Array(0);this.W=t;if(n.length>0){this.M=n[0];var i=this;this.M.k=function(){i.C&&i.C.e()};n.length>1&&(this.C=n[1])}if(this.w().b())try{this.bi(this.w().b())}catch(r){O365.Log.a(402026,6,1,0,r);throw r;}else O365.Log.a(175143,6,1,0)},bA:function(n,t){this.w().c()||this.bh()},bh:function(){if(this.u&&this.u.p)for(var i=this.bB(),t=0;t<this.u.p.x.length;t++)if(_fm.s.isInstanceOfType(this.u.p.x[t])){var n=this.u.p.x[t];n&&(i?_fm.d.isInstanceOfType(n)&&n.m?n.a(!n.m.b):n.a(!1):n.a(!0))}},bB:function(){var n=!0;this.w().c()||(n=this.O===3||this.O===4);return n},bi:function(n){this.br();this.bz();this.by(n.UserDisplayName,n.TruncatedUserDisplayName);this.bp(n.AboutMeLink,n.SignOutLink,n.CurrentWorkloadUserSubLinks);if(!_o365sg2pmetile.b.a){_o365sg2pmetile.b.a=!0;O365.PM.rle("M1")}},bz:function(){this.U=!this.w().e()&&!this.w().a().IsConsumerShell;if(!this.U){if(this.M)try{this.M.j()}catch(t){O365.Log.a(402027,6,1,0,t);throw t;}if(this.C)try{this.C.j()}catch(n){O365.Log.a(402028,6,1,0,n);throw n;}}},br:function(){this.w().a()&&this.w().a().LyncIntegrationDisabled?this.f(1):this.f(0)},by:function(n,t){if(n){this.N=t?t:n;this.V=n;this.w().a()?this.Y=this.w().a().IsConsumerShell&&this.w().a().NotManagedEmailAddress?this.w().a().NotManagedEmailAddress:this.w().a().UPN:O365.Log.a(175145,6,1,0)}else if(this.w().a()&&this.w().a().UPN){this.N=this.w().a().UPN;this.V=this.w().a().UPN}else O365.Log.a(175144,1,1,0)},bp:function(n,t,i){var r=new Array(0);var h=!1;if(n){var a=this;this.W.b(r,n,function(){O365.Log.a(300934,1,1,0);return!0});h=!0}var u=!1;if(i&&i.length>0){r.push(new _fm.i);u=!0;for(var c=i,l=c.length,e=0;e<l;++e){var o=c[e];if(o){this.W.b(r,o,null);u=!1}else if(!u){r.push(new _fm.i);u=!0}}}if(t){(h||i&&!u)&&r.push(new _fm.i);var f=this;this.W.b(r,t,function(){if(f.K)for(var n=0;n<f.K.length;n++)if(f.K[n])try{f.K[n]()}catch(t){O365.Log.a(300442,6,1,0,n,t)}return!0})}this.q(_s1.ShellG2Strings.l_ShellCore_MeTile_Title_Text);this.bc(new _fm.f(null));this.u.p.e(this.bg);this.u.p.m(r);this.r("ContextMenuView");_o365sg2c.i.b(this);_o365sg2c.i.a(this.u);this.u.O(_j.i.a(this.u.L)?"o365cs-me-contextMenu":this.u.L+" "+"o365cs-me-contextMenu");var s=this;this.x(new _j.g(function(){O365.Log.a(300937,1,1,0);if(s.S)try{s.S.a()}catch(n){O365.Log.a(403599,6,1,0,n)}},_ff.c.a))}};_o365sg2pmetile.a=function(){};_o365sg2pmetile.a.$$cctor=function(){_o365sg2pmetile.a._I()};_o365sg2pmetile.a.A=function(){var n=window.document.createElement("DIV");n.innerHTML="<div>  <div class='o365cs-me-tileview-container'></div> <div></div> </div><div> <button autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_0\" type='button' class='o365cs-nav-item o365cs-nav-button ms-fcl-w o365cs-me-nav-item'></button> </div><div> <img autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_4\" class='o365cs-me-personaimg'/> </div><div> <div class='o365cs-me-tileimg'></div> </div><div> <img autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_5\" class='o365cs-me-personaimg'/> </div><div>  <div autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_2\" class='o365cs-me-presence5x50'></div>  <span autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_3\" class='ms-bgc-nt ms-fcl-w o365cs-me-tileimg o365cs-me-tileimg-doughboy'></span>  <div></div>  <div class='o365cs-me-tileimg'></div> </div><div> <div autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_1\" class='o365cs-me-tileview'></div> </div><div> <div autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_7\" class='o365cs-me-presenceOffline5x50'></div> <div class='o365cs-me-tile-nophoto-username-container'> <span autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_8\" class='o365cs-me-tile-nophoto-username o365cs-me-bidi'></span> </div> <div class='o365cs-me-tile-nophoto-down'> <span class='ms-fcl-nt'></span> </div> </div><div> <div autoid=\"__Microsoft_O365_ShellG2_MeTile_Owa_templates_cs_6\" class='o365cs-me-tile-nophoto'></div> </div>";_j.h.a().appendChild(n);return n};_o365sg2pmetile.a.p=function(n){return n.U};_o365sg2pmetile.a.Q=function(n){return n.J};_o365sg2pmetile.a.O=function(n){return n.v};_o365sg2pmetile.a.P=function(n){return n.bk()};_o365sg2pmetile.a.L=function(n){return n.i()};_o365sg2pmetile.a.l=function(n){return n.a()};_o365sg2pmetile.a.n=function(n){return n.q()};_o365sg2pmetile.a.R=function(n){return n.bb};_o365sg2pmetile.a.M=function(n){return n.be};_o365sg2pmetile.a.D=function(n){return n.k()};_o365sg2pmetile.a.f=function(n){return n.C};_o365sg2pmetile.a.t=function(n){return n.g};_o365sg2pmetile.a.u=function(n){return n.h};_o365sg2pmetile.a.s=function(n){return n.a};_o365sg2pmetile.a.q=function(n){return n.V};_o365sg2pmetile.a.r=function(n){return n.b};_o365sg2pmetile.a.j=function(n){return n.M};_o365sg2pmetile.a.d=function(n){return n.X};_o365sg2pmetile.a.N=function(n){return n.N};_o365sg2pmetile.a.e=function(n,t){n.J(t)};_o365sg2pmetile.a.C=function(n,t){n.T(t)};_o365sg2pmetile.a.K=function(n,t){n.N(t)};_o365sg2pmetile.a.B=function(n,t){n.Q(t)};_o365sg2pmetile.a.H=function(n,t){n.k=t};_o365sg2pmetile.a.F=function(n,t){n.m(t)};_o365sg2pmetile.a.G=function(n,t){n.c(t)};_o365sg2pmetile.a.J=function(n,t){n.r(t)};_o365sg2pmetile.a.E=function(n,t){n.j(t)};_o365sg2pmetile.a.v=function(n,t){n.g(t)};_o365sg2pmetile.a.w=function(n,t){n.i(t)};_o365sg2pmetile.a.y=function(n,t){n.a(t)};_o365sg2pmetile.a.x=function(n,t){n.b=t};_o365sg2pmetile.a.o=function(n,t){n.bn(t)};_o365sg2pmetile.a.m=function(n,t){n.a(t)};_o365sg2pmetile.a.I=function(n,t){n.a(t)};_o365sg2pmetile.a.k=function(){_o365sg2pmetile.a.g||(_o365sg2pmetile.a.g=new _fc.k);return _o365sg2pmetile.a.g};_o365sg2pmetile.a.c=function(){_o365sg2pmetile.a.i||(_o365sg2pmetile.a.i=new _o365sg2c.u);return _o365sg2pmetile.a.i};_o365sg2pmetile.a.z=function(){_o365sg2pmetile.a.h||(_o365sg2pmetile.a.h=new _fc.m);return _o365sg2pmetile.a.h};_o365sg2pmetile.a._I=function(){var e="MeTileMouseView.MeTileMenu._tid1";new _j.d(e,function(){_o365sg2pmetile.a.a[e]===undefined&&(_o365sg2pmetile.a.a[e]=[[[-1,0,["ShowUserNameInsteadOfPhoto"],[_o365sg2pmetile.a.p],null,"IsHidden",null,_o365sg2pmetile.a.e,1,null,null,!0]],[[-1,0,["ShowUserNameInsteadOfPhoto"],[_o365sg2pmetile.a.p],null,"IsHidden",null,_o365sg2pmetile.a.e,1,_o365sg2pmetile.a.k(),null,!0]]]);var n=_o365sg2pmetile.a.b.childNodes[0].cloneNode(!0);var i=new _j.c(n.children[1]);i.y("MeTileMouseView.MeTileNoPhoto");var t=new _j.c(n.children[0]);t.y("MeTileMouseView.MeTilePhoto");return new _j.a(n,[t,i])},"",_o365sg2pmetile.b,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var f="MeTileMouseView.MeTileMenu";new _j.d(f,function(){_o365sg2pmetile.a.a[f]===undefined&&(_o365sg2pmetile.a.a[f]=[[[-1,0,["IsHidden"],[_o365sg2pmetile.a.Q],null,"IsHidden",null,_o365sg2pmetile.a.e,1,null,null,!0],[-1,0,["Command"],[_o365sg2pmetile.a.O],null,"ClickCommand",null,_o365sg2pmetile.a.C,1,null,null,null],[-1,0,["AriaId"],[_o365sg2pmetile.a.P],null,"AriaId",null,_o365sg2pmetile.a.K,1,null,null,null],[-1,0,["AriaLabel"],[_o365sg2pmetile.a.L],null,"AriaLabel",null,_o365sg2pmetile.a.B,1,null,null,null],[-1,5,["MenuViewModel","IsShown"],[_o365sg2pmetile.a.l,_o365sg2pmetile.a.n],null,"o365cs-spo-topbarMenuOpen ms-fcl-b ms-bgc-w:ms-fcl-w ms-bgc-tdr-h",null,null,0,null,null,null]]]);var r=_o365sg2pmetile.a.b.childNodes[1].cloneNode(!0);var t=new _fc.b(r.children[0]);t.E(10);var u=new _fc.g;var i=new _fc.c;i.U(_j.f.a(["MenuCommand"],[_o365sg2pmetile.a.R],null,"Command",null,_o365sg2pmetile.a.H,1));i.i("DOWNARROW");u.a([i]);var n=new _fce.f(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));n.U(_j.f.a(["MenuTemplateId"],[_o365sg2pmetile.a.M],null,"TemplateId",null,_o365sg2pmetile.a.F,1)).U(_j.f.a(["MenuViewModel"],[_o365sg2pmetile.a.l],null,"MenuDataContext",null,_o365sg2pmetile.a.G,1)).U(_j.f.a(["MenuViewModel","IsShown"],[_o365sg2pmetile.a.l,_o365sg2pmetile.a.n],_o365sg2pmetile.a.J,"IsShown",_o365sg2pmetile.a.D,_o365sg2pmetile.a.E,2,null,null,!1));n.e=!0;n.a=1;n.b=5;n.g="o365cs-nav-contextMenu o365spo";n.i=1;t.D([u,n]);t.y("MeTileMouseView.MeTileMenu._tid1");return new _j.a(r,[t]).b(t)},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_o365sg2pmetile.a.a);var s="MeTileMouseView.MeTilePhoto._tid2._tid3._tid4";new _j.d(s,function(){_o365sg2pmetile.a.a[s]===undefined&&(_o365sg2pmetile.a.a[s]=[[[-1,4,null,null,null,"ImageSize",null,_o365sg2pmetile.a.x,0,null,null,0,1],[-1,0,["SecondaryUserPhotoViewModel","UserImageLoadCommand"],[_o365sg2pmetile.a.f,_o365sg2pmetile.a.t],null,"LoadCommand",null,_o365sg2pmetile.a.v,1,null,null,null],[-1,0,["SecondaryUserPhotoViewModel","UserImageLoadErrorCommand"],[_o365sg2pmetile.a.f,_o365sg2pmetile.a.u],null,"LoadErrorCommand",null,_o365sg2pmetile.a.w,1,null,null,null],[-1,0,["SecondaryUserPhotoViewModel","PhotoUrl"],[_o365sg2pmetile.a.f,_o365sg2pmetile.a.s],null,"Source",null,_o365sg2pmetile.a.y,1,null,null,null],[-1,0,["UserNameTooltip"],[_o365sg2pmetile.a.q],null,"Title",null,_o365sg2pmetile.a.o,1,null,null,null]]]);var n=_o365sg2pmetile.a.b.childNodes[2].cloneNode(!0);var t=new _o365sg2c.f(n.children[0]);return new _j.a(n,[t])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var o="MeTileMouseView.MeTilePhoto._tid2._tid3";new _j.d(o,function(){_o365sg2pmetile.a.a[o]===undefined&&(_o365sg2pmetile.a.a[o]=[[[-1,0,["SecondaryUserPhotoViewModel","IsPhotoEnabled"],[_o365sg2pmetile.a.f,_o365sg2pmetile.a.r],null,"IsHidden",null,_o365sg2pmetile.a.e,1,_o365sg2pmetile.a.k(),null,!0]]]);var t=_o365sg2pmetile.a.b.childNodes[3].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("MeTileMouseView.MeTilePhoto._tid2._tid3._tid4");return new _j.a(t,[n])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var u="MeTileMouseView.MeTilePhoto._tid2._tid5";new _j.d(u,function(){_o365sg2pmetile.a.a[u]===undefined&&(_o365sg2pmetile.a.a[u]=[[[-1,4,null,null,null,"ImageSize",null,_o365sg2pmetile.a.x,0,null,null,0,1],[-1,0,["PrimaryUserPhotoViewModel","UserImageLoadCommand"],[_o365sg2pmetile.a.j,_o365sg2pmetile.a.t],null,"LoadCommand",null,_o365sg2pmetile.a.v,1,null,null,null],[-1,0,["PrimaryUserPhotoViewModel","UserImageLoadErrorCommand"],[_o365sg2pmetile.a.j,_o365sg2pmetile.a.u],null,"LoadErrorCommand",null,_o365sg2pmetile.a.w,1,null,null,null],[-1,0,["PrimaryUserPhotoViewModel","PhotoUrl"],[_o365sg2pmetile.a.j,_o365sg2pmetile.a.s],null,"Source",null,_o365sg2pmetile.a.y,1,null,null,null],[-1,0,["UserNameTooltip"],[_o365sg2pmetile.a.q],null,"Title",null,_o365sg2pmetile.a.o,1,null,null,null]]]);var n=_o365sg2pmetile.a.b.childNodes[4].cloneNode(!0);var t=new _o365sg2c.f(n.children[0]);return new _j.a(n,[t])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var t="MeTileMouseView.MeTilePhoto._tid2";new _j.d(t,function(){_o365sg2pmetile.a.a[t]===undefined&&(_o365sg2pmetile.a.a[t]=[[[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Unknown",null,null,0,_o365sg2pmetile.a.c(),0,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Offline",null,null,0,_o365sg2pmetile.a.c(),1,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Available",null,null,0,_o365sg2pmetile.a.c(),2,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Away",null,null,0,_o365sg2pmetile.a.c(),3,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Busy",null,null,0,_o365sg2pmetile.a.c(),4,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-Blocked",null,null,0,_o365sg2pmetile.a.c(),5,null],[-1,5,["UserPresence"],[_o365sg2pmetile.a.d],null,"o365cs-me-presenceColor-DND",null,null,0,_o365sg2pmetile.a.c(),6,null]],[[-1,4,null,null,null,"Id",null,_o365sg2pmetile.a.m,0,null,null,null,_o365sg2c.b.b]],[[-1,0,["SecondaryUserPhotoViewModel"],[_o365sg2pmetile.a.f],null,"IsHidden",null,_o365sg2pmetile.a.e,1,_o365sg2pmetile.a.z(),null,!0]],[[-1,0,["PrimaryUserPhotoViewModel","IsPhotoEnabled"],[_o365sg2pmetile.a.j,_o365sg2pmetile.a.r],null,"IsHidden",null,_o365sg2pmetile.a.e,1,_o365sg2pmetile.a.k(),null,!0]]]);var n=_o365sg2pmetile.a.b.childNodes[5].cloneNode(!0);var r=new _j.c(n.children[3]);r.y("MeTileMouseView.MeTilePhoto._tid2._tid5");var i=new _j.c(n.children[2]);i.y("MeTileMouseView.MeTilePhoto._tid2._tid3");var f=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var u=new _j.c(n.children[0]);return new _j.a(n,[u,f,i,r])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var n="MeTileMouseView.MeTilePhoto";new _j.d(n,function(){_o365sg2pmetile.a.a[n]===undefined&&(_o365sg2pmetile.a.a[n]=[null]);var i=_o365sg2pmetile.a.b.childNodes[6].cloneNode(!0);var t=new _j.c(i.children[0]);t.y("MeTileMouseView.MeTilePhoto._tid2");return new _j.a(i,[t])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_o365sg2pmetile.a.a);var r="MeTileMouseView.MeTileNoPhoto._tid6";new _j.d(r,function(){_o365sg2pmetile.a.a[r]===undefined&&(_o365sg2pmetile.a.a[r]=[null,[[-1,0,["UserDisplayName"],[_o365sg2pmetile.a.N],null,"Text",null,_o365sg2pmetile.a.I,1,null,null,null]],[[-1,4,null,null,null,"Id",null,_o365sg2pmetile.a.m,0,null,null,null,_o365sg2c.b.i]]]);var n=_o365sg2pmetile.a.b.childNodes[7].cloneNode(!0);var u=new _fc.d(_j.a.a(n,[2,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var i=new _fc.a(_j.a.a(n,[1,0]));var t=new _j.c(n.children[0]);return new _j.a(n,[t,i,u])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_o365sg2pmetile.a.a);var i="MeTileMouseView.MeTileNoPhoto";new _j.d(i,function(){_o365sg2pmetile.a.a[i]===undefined&&(_o365sg2pmetile.a.a[i]=[null]);var t=_o365sg2pmetile.a.b.childNodes[8].cloneNode(!0);var n=new _j.c(t.children[0]);n.y("MeTileMouseView.MeTileNoPhoto._tid6");return new _j.a(t,[n])},"",_o365sg2pmetile.b,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_o365sg2pmetile.a.a)};MeTileComponent.registerClass("MeTileComponent",null,_a.ic,_j.ce);_o365sg2pmetile.b.registerClass("_o365sg2pmetile.b",_o365sg2c.A,IMeTileViewModel);MeTileComponent.$$cctor();_o365sg2pmetile.b.a=!1;_o365sg2pmetile.a.b=_o365sg2pmetile.a.A();_o365sg2pmetile.a.g=null;_o365sg2pmetile.a.i=null;_o365sg2pmetile.a.h=null;_o365sg2pmetile.a.a={};_o365sg2pmetile.a.$$cctor();
window.scriptsLoaded['microsoft.o365.shellg2.metile.owa.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.o365.shellg2.metile.owa.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
