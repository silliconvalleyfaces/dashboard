try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.core.im.js'] = (new Date()).getTime();
Type.registerNamespace("_im");_im.i=function(n,t,i,r){if(n==="Mouse"&&t){var u=this;i.q().e(function(n,t){if(!t.c)for(var i=0;i<t.a.length;i++){var u=t.a[i];r.f(u)}})}};_im.d=function(n,t,i,r){this.k=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.l);this.e=Function.createDelegate(this,this.n);this.i=Function.createDelegate(this,this.o);_im.d.initializeBase(this);this.d=r;this.a=n;this.g=new _j.g(this.i,_a.a.l);this.p(i.b(1,_bc.e.a,this.a.a(),2));this.a.a().e(this.e);t.m(this.h);if(r.get_mainWindowInstance()&&!r.get_mainWindowInstance().closed){var u=this;_a.U.a(r.get_mainWindowInstance(),function(n){n.chatWindowReady(u.a.p())})}};_im.d.prototype={d:null,a:null,g:null,f:null,b:function(){return this.ew(_im.d.a)},p:function(n){this.ev(_im.d.a,n);return n},j:function(n){this.f=n;this.eu("EditorCallContext");return n},c:function(){return this.ew(_im.d.b)},q:function(n){this.ev(_im.d.b,n);return n},n:function(n,t){switch(t.c){case 0:for(var r=0;r<t.a.length;r++){var f=t.a[r];this.b().v(f)}return;case 2:for(var i=t.b.length-1;i>=0;i--){var e=t.b[i];var o=this;var u=this.b().a().i(function(n){var t=n;return t.k.g()===e.g()});u<this.b().a().x.length&&this.b().a().p(u)}return}},o:function(){if(!_j.i.a(this.c())){this.a.bc(this.c());var n=this;_a.U.a(this.d.get_mainWindowInstance(),function(t){t.sendChatMessage(n.a.c().Id,n.c())})}},l:function(n){_j.e.a(_a.a.l,"ChatViewModel.BeforeUnload invoked.");this.a.a().g(this.e);var t=this;_a.U.a(this.d.get_mainWindowInstance(),function(n){_j.e.a(_a.a.l,"ChatViewModel.BeforeUnload calling into main window.");n.endChat(t.a.p())})},m:function(){this.j(new _cmc.j(!1))}};_im.j=function(n,t,i){this.c=n;this.e=t;this.d=i};_im.j.prototype={c:null,e:null,d:null,f:function(n){var r={};r.ItemID=n.J();var i=new _db.A;i.b(n);var t=_bc.d.e();if(n.D!==-1&&n.E!==-1){t.c=n.D;t.d=n.E}_j.e.a(_a.a.l,"ChatViewModelFactory: Chat.BodyText: {0}",n.l());var u=this;this.c.g(IChatViewModelFactory,function(){return u},r,t,i,!1)},b:function(n,t,i){return null},a:function(n,t,i){var u=n.a();return new _im.d(u,this.c,this.e,this.d)}};_im.G=function(n){this.b=n};_im.G.prototype={b:null,a:function(n,t,i){for(var f=new Array(n.x.length),e=new Array(n.x.length),r=0;r<n.x.length;r++){var u=n.x[r];f[r]=u.c();e[r]=u.g()}var o=t?t.p():null;var s=this;_a.U.a(this.b.get_mainWindowInstance(),function(n){n.startChat(f,e,o,i)})}};_im.m=function(n){_im.m.initializeBase(this);this.c=n};_im.m.prototype={c:null,K:function(n){this.c.d(1);n.dg(this.c.b(),null,this.I,this.G)},cT:function(n,t,i){if(n===-9){_j.e.a(_a.a.l,"AcceptChatAction.ProcessResult: Suppressing 'ConversationEnded' error.");n=this.c.b()}if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}this.c.d(3);_j.e.a(_a.a.l,"AcceptChatSession web service call succeeded for chat {0}.",this.c.b());t()},T:function(){_a.cU.prototype.T.call(this)}};_im.n=function(n,t){this.j=n;this.k=t};_im.n.prototype={k:null,j:null,a:function(n,t){return this.j.d(n,t)},b:function(n,t){return this.j.c(n,t)},g:function(n,t){return null},h:function(n,t){return null},i:function(n,t){return new _im.C(n,t)},f:function(n){return this.k.b(n)}};_im.s=function(n,t){_im.s.initializeBase(this);this.c=n;this.f=t};_im.s.prototype={c:null,f:null,R:function(){_a.cU.prototype.R.call(this);this.f.w(this.c)},K:function(n){if(this.c.b()===-1){this.c.d(4);return}n.ij(this.c.b(),null,this.I,this.G)},cT:function(n,t,i){this.c.d(4);if(!n){i(Error.create("EndChatAction returned false."));return}t()}};_im.t=function(n){this.a=n};_im.t.prototype={a:null,b:function(n){return new _im.s(n,this.a)}};_im.u=function(n){_im.u.initializeBase(this);_a.b.j(n,"sipUris");this.c=n};_im.u.prototype={c:null,K:function(n){n.fJ(this.c,null,this.I,this.G)},cT:function(n,t,i){if(n<0){i(Error.create("GetPresenceAction failed with InstantMessageOperationError: "+n));return}t()}};_im.v=function(n){_im.v.initializeBase(this);this.c=n};_im.v.prototype={c:!1,K:function(n){var t;var i=(t=new _gg.AF(this.L),t.isAutomated=!this.c,t);n.gk(this.c,i,this.I,this.G)},cT:function(n,t,i){if(n<0){n!==-2&&_j.e.a(_a.a.l,"Sign in failed with code {0}, will retry.",n);i(Error.create("InstantMessageOperationError: "+n));return}t()}};_im.w=function(n){_im.w.initializeBase(this);this.c=n};_im.w.prototype={c:!1,K:function(n){n.gl(this.c,null,this.I,this.G)},cT:function(n,t,i){if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}t()}};_im.B=function(){_im.B.initializeBase(this)};_im.B.prototype={K:function(n){n.cE(null,this.I,this.G)},cT:function(n,t,i){if(n<0){i(Error.create("ResetPresenceAction failed with InstantMessageOperationError: "+n));return}t()}};_im.C=function(n,t){_im.C.initializeBase(this);this.c=n;this.f=t};_im.C.prototype={f:null,c:null,R:function(){_a.cU.prototype.R.call(this)},K:function(n){this.c.I()||this.c.d(1);var t=new _g.eh(this.f);t.ChatSessionId=this.c.b();t.Recipients=this.c.V();t.Subject=this.c.m();n.cJ(t,null,this.I,this.G)},cT:function(n,t,i){if(n<0){i(Error.create("InstantMessageOperationError: "+n));return}this.c.o(n);this.c.d(3);t()},T:function(){this.c.q(_nbs.a.Qa);_a.cU.prototype.T.call(this)}};_im.D=function(n,t){_im.D.initializeBase(this);_a.b.c(n,"sipUri");this.f=n;this.c=t};_im.D.prototype={f:null,c:"None",K:function(n){var t=new _gg.kM;t.Presence=this.c;n.cQ(t,null,this.I,this.G)},cT:function(n,t,i){var r=n;if(r){i(Error.create("SetPresenceAction failed with InstantMessageOperationError: "+r));return}t()}};_im.k=function(n,t,i,r,u){_im.k.initializeBase(this);_a.b.a(i,"participants");_a.b.g(i.x.length,0,"participants.Count");if(u){if(i.x.length!==1)throw Error.invalidOperation("imAddress can only be used in conjunction with a single participant.");if(r)throw Error.invalidOperation("imAddress and itemOrConversation are mutually exclusive.");}this.c=n;this.a=this.k(i);_a.b.g(this.a.x.length,0,"No valid participants.");this.j=t;this.i=r;this.f=u};_im.k.prototype={c:null,j:null,a:null,i:null,f:null,R:function(){_a.cU.prototype.R.call(this);if(this.j){this.j.a(this.a,this.i,this.f);return}this.c.z(this.a,this.i,this.f)},bb:function(){return 0},k:function(n){for(var u=new _j.l,f={},e=n.x.length,i=0;i<e;i++){var t=n.x[i];if(t&&this.c.a(t.g())){var r=t.g();if(!(r in f)){u.a(t);f[r]=t}}}return u}};_im.l=function(n,t){this.a=n;this.b=t};_im.l.prototype={a:null,b:null,d:function(n,t){return new _im.k(this.a,this.b,n,t,null)},c:function(n,t){var i=new _j.l;i.a(n);return new _im.k(this.a,this.b,i,null,t)}};_im.E=function(n){_im.E.initializeBase(this);_a.b.j(n,"sipUris");this.c=n};_im.E.prototype={c:null,K:function(n){n.hY(this.c,null,this.I,this.G)},cT:function(n,t,i){if(n<0){i(Error.create("SubscribeForPresenceUpdatesAction failed with InstantMessageOperationError: "+n));return}t()}};_im.F=function(n){_im.F.initializeBase(this);_a.b.c(n,"sipUri");this.c=n};_im.F.prototype={c:null,K:function(n){n.il(this.c,null,this.I,this.G)},cT:function(n,t,i){if(n<0){i(Error.create("UnsubscribeFromPresenceUpdatesAction failed with InstantMessageOperationError: "+n));return}t()}};_im.o=function(n){this.b=n.a/1e3;this.a={}};_im.o.prototype={b:0,a:null,e:function(n){this.c();this.a[n.toString()]=this.d()},f:function(n){this.c();return n.toString()in this.a},d:function(){return _a.c.a()},c:function(){var s=this.d();var u=new _j.q;var f=this.a;for(var r in f){var i={key:r,value:f[r]};var h=i.value;var c=h.B(this.b);c.b(s)<0&&u.c(i.key)}for(var t=u.j(),o=t.length,n=0;n<o;++n){var e=t[n];delete this.a[e]}}};_im.c=function(n,t,i,r,u,f,e){this.V=Function.createDelegate(this,this.bK);this.bj=Function.createDelegate(this,this.ch);this.bk=Function.createDelegate(this,this.cj);this.be=Function.createDelegate(this,this.ca);this.bn=Function.createDelegate(this,this.co);this.bb=Function.createDelegate(this,this.Z);this.W=Function.createDelegate(this,this.bZ);this.bf=Function.createDelegate(this,this.cb);this.bg=Function.createDelegate(this,this.cc);this.bh=Function.createDelegate(this,this.ce);this.bi=Function.createDelegate(this,this.cf);this.bl=Function.createDelegate(this,this.ck);this.bm=Function.createDelegate(this,this.cl);this.bc=Function.createDelegate(this,this.bX);this.bd=Function.createDelegate(this,this.bY);this.bo=Function.createDelegate(this,this.cp);this.E=new _j.l;this.G=new _j.l;this.K=new _j.l;_im.c.initializeBase(this);this.n("Initialization","unknown");this.D=t;this.j(this.D.c);if(!n){this.n("Initialization","Disabled");return}this.F=i;this.I=!0;this.L=!1;this.R=new _im.o(_a.bX.b(30));var s=new _g.M;s.NotificationType="InstantMessageNotification";this.U=new _h.D(s,this.F,r);this.U.B(this.bo);if(u&&e){this.ba=!0;_j.e.a(_a.a.l,"ChatManager: Waiting for the pending-get activation event.");var o=this;u.b(_no.e,function(n){_j.e.a(_a.a.l,"ChatManager: Pending-get activated.");o.S=!0;o.bJ()});var h=this;u.b(_a.ei,function(){h.bp()});u.b(_a.cO,this.bd);f?this.bV(f):this.C="Disabled"}this.E.e(this.bc);this.M=this.bM(this.F)};_im.c.d=function(n,t,i){var r;var f,u;if(u=n.M(function(n){return n.b()===t},f={val:r}),r=f.val,u){i.val=r;return!0}i.val=null;return!1};_im.c.e=function(n,t,i){var r;var f,u;var e=(u=n.M(function(n){var i=n;if(i.a().x.length!==1)return!1;var r=i.a().x[0];return r.g()===t?!0:!1},f={val:r}),r=f.val,u);i.val=r;return e};_im.c.prototype={D:null,ba:!1,X:null,O:null,S:!1,Q:!1,bB:!1,R:null,F:null,P:!1,I:!1,T:!1,C:"unknown",J:null,L:!1,U:null,M:null,j:function(n){this.bw(_im.c.a,n)},bD:function(n){this.bH(_im.c.a,n)},d:function(){return this.C},b:function(){return this.C==="SignedIn"},e:function(){this.bu("IsEnabled");return this.C!=="Disabled"},q:function(){return this.E},s:function(){return this.G},r:function(){return this.K},c:function(){this.bu("CurrentUserSipUri");return this.O},t:function(){return!1},k:function(n){if(!this.S){_j.e.a(_a.a.l,"Ignoring a SignIn attempt because the pending-get connection is not yet started.");return}this.I=!0;this.L=n;this.Z()},l:function(n){_j.e.a(_a.a.l,"Signing out.");var t=new _im.w(n);t.d(this.bm);t.e(this.bl);this.n("SignOut:Manual="+n,"AttemptingSignOut");this.F.a(t)},h:function(n,t,i){var f=_im.b.a(t);var e;var r,u;var o=(u=this.D.f(f,r={val:e}),e=r.val,u);this.bR(n,f,_im.b.b(i),o)},m:function(n,t){var i=new _im.D(_im.b.a(n),t);i.d(this.bi);i.e(this.bh);this.F.a(i)},n:function(n,t){t==="Error";_j.e.a(_a.a.l,"SignInState: {0} Requesting change from {1} to {2}",n,this.C,t);var i=this.b();if(this.C!==t){this.C=t;this.bs(_im.c.b);this.b()!==i&&this.bs(_im.c.c)}},A:function(n,t){_j.e.a(_a.a.l,"Setting current user SIP URI to {0}",t);this.O=t},x:function(){if(this.C==="SignedIn"){_j.e.a(_a.a.l,"ResetPresence");var n=new _im.B;n.d(this.bg);n.e(this.bf);this.F.a(n)}},z:function(n,t,i){_j.e.a(_a.a.l,"Starting chat.");_a.b.b(n,"basePersonaParticipants");_a.b.g(n.x.length,0,"basePersonaParticipants.Count");i&&_a.b.f(n.x.length,1,"When imAddress is specified, participant count must be 1.");for(var u=new _j.l,w=n.x.length,o=0;o<w;o++){var y=n.x[o];var p=_pc.a.d(y);u.a(p)}var r=null;if(u.x.length===1){var e=u.x[0];var f=null;i?f=i:e.g()&&(f=e.g());if(f){var h,s;s=_im.c.e(this.E,f,h={val:r}),r=h.val,s}var c=e.c();if(!_j.i.b(f)&&!_j.i.b(c)){var v=_im.b.a(f);this.D.d("StartChat (single participant)",v,c,e.dw,!0)}}else{var l=this;u.n(function(n){var t=n;var r=t.g();var i=t.c();if(!_j.i.b(r)&&!_j.i.b(i)){var u=_im.b.a(r);l.D.d("StartChat (multiple participants)",u,i,t.dw,!0)}})}if(!r){r=this.bx(u,t);this.bq(r);if(i){var a=u.x[0];r.bb(a,i)}}_g.h.isInstanceOfType(t)?r.P(t):_g.q.isInstanceOfType(t)&&r.O(t);return r},o:function(n){_j.e.a(_a.a.l,"Accepting invitation.");this.G.o(n,!0);this.bq(n);var t=new _im.m(n);this.F.a(t)},p:function(n){},v:function(n){_j.e.a(_a.a.l,"Ignoring invitation.");this.G.o(n,!0);this.R.e(n.b())},w:function(n){_j.e.a(_a.a.l,"Removing chat {0}",n.b());n.d(4);n.a().g(this.W);var i=this.E.o(n,!0);var t=this.G.o(n,!0);n.c()&&_h.d.a().c(n.c().Id)},ca:function(n){if(n.EventType==="Reload"){_j.e.b(_a.a.l,"ChatManager.OnIMNotification: Received a 'Reload' notification from the OWA server, assuming server has rebooted or connection re-established");this.I=!0;this.N(!1);return}var t=n;var i=t.PayloadType;if(_j.t.a(i)){_j.e.b(_a.a.l,"ChatManager.OnIMNotification: Unexpected notification payload: {0}, {1}",n.EventType,n.toString());return}if(i==="ServiceUnavailable"){if(t.ServiceError==="ClientSignOut"){_j.e.b(_a.a.l,"ChatManager.OnIMNotification: Service unavailable, client signed out.  {0}",t.ErrorMessage);this.n("IMNotification","SignedOut");return}_j.e.b(_a.a.l,"ChatManager.OnIMNotification: Received a 'ServiceUnavailable' notification: {0}, {1}.",t.ServiceError,t.ErrorMessage);this.N(!1);return}if(i==="SignOn")if(t.SignOnStarted){_j.e.a(_a.a.l,"ChatManager.OnIMNotification: Sign-on started.");return}else{_j.e.a(_a.a.l,"ChatManager.OnIMNotification: Sign-on succeeded.");this.N(!0);this.cg();this.bB=t.IsUserInUcsMode;return}if(i==="UpdateUserPresence"||i==="UserPresenceChange"||i==="QueryUserPresenceChange"){this.bQ(t);return}this.D.l(t);t.Persona&&!t.Persona.ImAddress&&(t.Persona.ImAddress=t.SipUri);if(t.PayloadType==="PendingContactList"){if(!t.PendingContacts){_j.e.b(_a.a.cb,"The payload for PendingContacts is empty");return}this.bL(t.PendingContacts);return}if(t.PayloadType==="AddToBuddyList"){if(!t.AddedContacts){_j.e.b(_a.a.cb,"The payload for AddedContacts is empty");return}this.cn(t.AddedContacts)&&_j.e.a(_a.a.cb,"Removed already added contact from pending buddyRequests");return}if(t.PayloadType==="EmptySubscribers"){this.bP();_j.e.a(_a.a.cb,"Removed already added contact from pending buddyRequests after receiving emptysubscribers");return}if(!("ChatSessionId"in t)){_j.e.a(_a.a.l,"Notification {0} not supported, no session id.",i);return}if(this.R.f(t.ChatSessionId)){_j.e.a(_a.a.l,"ChatManager.OnIMNotification: {0} for conversation {1} was ignored.",t.PayloadType,t.ChatSessionId);return}_j.e.a(_a.a.l,"ChatManager.OnIMNotification: {0}, Session={1}, SipUri={2}",i,t.ChatSessionId,t.SipUri);var r;var e,o,u,f;if((o=_im.c.d(this.E,t.ChatSessionId,e={val:r}),r=e.val,o)||(f=_im.c.d(this.G,t.ChatSessionId,u={val:r}),r=u.val,f)){var s=this.D.b(t.SipUri,t.DisplayName);this.cm(t,r,s);return}_j.e.a(_a.a.l,"No matching chat found for session {0}",t.ChatSessionId);this.cq(t)},f:function(n){for(var r=n.b(),t=0;t<r;t++){var i=n.a(t);if(i&&this.a(i.SipUri))return!0}return!1},a:function(n){return _j.i.b(n)?!1:_j.i.b(this.c())?!1:n.toLowerCase()===this.c().toLowerCase()?!1:!0},u:function(n){return _im.b.b(n)},g:function(n){return _im.b.d(n)},y:function(){},bM:function(n){return new _im.A(n)},bO:function(){this.n("DelayInternalSignIn","AttemptingSignIn");_j.n.a().a(_a.a.l,"ChatManager.InternalSignIn",this.bb,3e4)},bt:function(){this.bD(this.D.c);_j.Q.prototype.bt.call(this)},cj:function(n){_j.e.a(_a.a.l,"Sign-in action succeeded.  Awaiting notification.");this.J=_j.n.a().a(_a.a.l,"ChatManager.SignInNotificationTimeout",this.bn,1e4)},ch:function(n){_j.e.a(_a.a.l,"Sign-in action failed.");var t=n;if(t.N===-11){_j.e.a(_a.a.l,"Automatic sign-in rejected because the user was explicitly signed out.");this.n("Automatic Sign-In Rejected","SignedOut");return}_j.e.b(_a.a.l,"Sign-in failed: {0}",t.J.message);this.N(!1)},co:function(){_j.e.b(_a.a.l,"Sign-in timeout expired.  Current sign-in state: {0}, ServiceAvailable: {1}.",this.C,this.P);this.C!=="SignedIn"&&this.N(!1)},cl:function(n){_j.e.a(_a.a.l,"Sign-out succeeded.");this.n("SignOutSucceeded","SignedOut")},cp:function(n,t){if(!this.T){_j.e.a(_a.a.l,"Subscribed to notifications.");this.T=!0;this.Z()}},bW:function(n,t,i){if(this.C!=="Disabled"){var r=n?"SignedOut":"Disabled";if(_j.i.a(i)){_j.e.a(_a.a.l,"The currentUserSipUri is null/empty -> Marking SignInState as disabled.");r="Disabled"}else i=_im.b.a(i);this.n("Configuration Updated",r)}this.X=t;this.A("InternalSetConfiguration",i);this.Q=!0},Z:function(){if(!this.T){_j.e.a(_a.a.l,"Subscribing to notifications.");this.U.l(_a.a.l,"OnIMNotification",this.be,1);return}_j.e.a(_a.a.l,"Signing in. Manual: {0}, will retry: {1}",this.L,this.I);var n=new _im.v(this.L);n.d(this.bk);n.e(this.bj);this.n("InternalSignIn","AttemptingSignIn");this.F.a(n);this.J&&(this.J=_j.n.a().b(this.J))},bx:function(n,t){_j.e.a(_a.a.l,"Creating new Chat.");var i=new _h.g(!0);i.a().e(this.W);i.a().z(n);i.N(new _g.g("IM:"+Math.random().toString()));if(!t)return i;if(_g.h.isInstanceOfType(t)){i.P(t);return i}if(_g.q.isInstanceOfType(t)){i.O(t);return i}var r=_j.i.c("CreateChat: itemOrConversation type {0} is not supported.",Object.getType(t).getName());_j.e.c(_a.a.l,r);throw Error.invalidOperation(r);},bq:function(n){_j.e.a(_a.a.l,"Activating chat.");n.c()&&_h.d.a().b(n.c().Id,n);var t=this.bS(n);this.E.t(t,n)},cm:function(n,t,i){var u=n.PayloadType;switch(u){case"NewChatMessageToast":_j.e.a(_a.a.l,"NewChatMessageToast received and mapped to chat {0}.",t.b());return;case"ParticipantJoined":this.D.e(n);var r;if(n.Persona){r=new _pc.a(null,!0,null);r.eq(n.Persona)}else r=_pc.a.l(i,n.SipUri);t.X(n.SipUri,r,i);return;case"ParticipantLeft":t.Y(n.SipUri,i);return;case"EndChatSession":t.u||this.G.o(t,!0);return;case"NewChatMessage":t.L(i,n.MessageContent);return;case"UserActivity":switch(n.UserActivity){case"FailedDelivery":t.q(_nbs.a.Qa);return;case"Typing":t.bf(i);return;case"StoppedTyping":t.e("");return;case"TwoOrMoreTyping":t.e(_nbs.a.Qs);return;case"DeliveryTimeout":t.q(_nbs.a.Ff);return;default:return}}},cq:function(n){if(n.PayloadType==="NewChatMessageToast"){this.D.e(n);var r=this.D.b(n.SipUri,n.DisplayName);var u=this.by(n.Persona,r,n.SipUri,n.ToastMessage,n.MessageSubject,n.ChatSessionId);_j.e.a(_a.a.l,"ChatManager.TryProcessInvitation: Created invitation for conversation {0} (NewChatMessageToast).",n.ChatSessionId);return!0}if(n.PayloadType==="NewChatMessage"){var t=this.D.b(n.SipUri,n.DisplayName);var i=this.by(n.Persona,t,n.SipUri,n.MessageContent,"",n.ChatSessionId);i.L(t,n.MessageContent);_j.e.a(_a.a.l,"ChatManager.TryProcessInvitation: Created invitation for conversation {0} (NewChatMessage).",n.ChatSessionId);return!0}return!1},by:function(n,t,i,r,u,f){var o;if(n){o=new _pc.a(null,!0,null);o.eq(n)}else o=_pc.a.l(t,i);r||(r="");var s=new _j.l;s.a(o);var e=this.bx(s,null);e.o(f);e.j=o;e.r=r;_j.i.b(u)||e.y(u);this.G.a(e);return e},bL:function(n){_a.b.b(n,"senderInfo");for(var u=n,e=u.length,r=0;r<e;++r){var t=u[r];var i=t.SipUri;_j.e.a(_a.a.cb,"Adding pending contact to buddy requests list",i);var f=this.bU(t.DisplayName,t.Title,i);this.bC(i,!1)||this.K.a(f)}},cn:function(n){_a.b.b(n,"senderInfo");for(var r=!1,u=n,f=u.length,t=0;t<f;++t){var e=u[t];var i=e.SipUri;_j.e.a(_a.a.cb,"Examining the AddToBuddyList payload for existing buddy requests",i);r=this.bC(i,!0)}return r},bP:function(){_j.e.a(_a.a.cb,"Received empty subscribers notification, we need to hide the pending buddy dialogue");this.K.f()},bU:function(n,t,i){_a.b.b(n,"displayName");_a.b.b(i,"buddyImAddress");var r=_pc.a.l(n,i);_j.i.a(t)||r.cP(t);return r},bC:function(n,t){for(var i=0;i<this.K.x.length;i++){var r=this.K.x[i];if(!r.g().localeCompare(n)){if(t){_j.e.a(_a.a.cb,"Removing already added contact from pending buddyRequests",r.g());this.K.p(i)}return!0}}return!1},bS:function(n){var t=this;return this.E.i(function(t){return n.g.b(t.g)>=0})},N:function(n){this.J&&(this.J=_j.n.a().b(this.J));var t=this.P;this.P=n;if(n&&t){_j.e.a(_a.a.l,"Service confirmed available.");return}else if(n&&!t){_j.e.a(_a.a.l,"Service resumed.");return}else if(!n&&t){_j.e.a(_a.a.l,"Service interrupted.");this.bp();this.bE();return}else if(!n&&!t){_j.e.a(_a.a.l,"Service confirmed unavailable.");this.bE();return}_j.e.c(_a.a.l,"Unexpected condition in ChatManager.SetServiceAvailability.")},cg:function(){this.n("SignedOn Succeeded","SignedIn");this.I=!0;this.L=!1},bp:function(){this.E.n(this.V);this.G.n(this.V);var n=this;this.E.n(function(t){t.bd(n.P)})},bE:function(){if(this.C==="AttemptingSignIn"||this.C==="SignedIn"||this.C==="Error"){if(this.I){this.I=!1;this.bO();return}this.L=!1;this.n("SignIn-GiveUp","Error")}},ck:function(n){_j.e.b(_a.a.l,"Sign-out failed: {0}",n.J.message);this.n("SignOutFailed","SignedOut")},cc:function(n){_j.e.a(_a.a.l,"Reset presence succeeded.")},cb:function(n){_j.e.b(_a.a.l,"Reset presence failed: {1}",n.J.message)},cf:function(n){var t=n;_j.e.a(_a.a.l,"Set presence to {0} succeeded.",t.c)},ce:function(n){var t=n;_j.e.b(_a.a.l,"Set presence to {0} failed: {1}",t.c,n.J.message)},bK:function(n){var t=n;t.o(-2);t.be()},bR:function(n,t,i,r){var f=this.D.b(t,null);var e=new _im.h(n,t,f,i,r);var u=this.hc(_im.c.a);u&&u(e)},bQ:function(n){var u=this.hc(_im.c.a);if(u){var e=n.PayloadType;if(n.PayloadType==="UpdateUserPresence"){var r=n.DisplayName;_j.i.b(r)&&(r=this.X);var s=new _im.h(e,this.O,r,_im.b.b(n.NewUserPresence),!0);u(s);return}if(n.UserPresenceChanges)for(var h=n.PayloadType!=="QueryUserPresenceChange",f=n.UserPresenceChanges,c=f.length,i=0;i<c;++i){var t=f[i];var o=new _im.h(e,t.SipUri,t.UserName,_im.b.b(t.Presence),h);u(o)}}},bZ:function(n,t){switch(t.c){case 0:var f=t.a;var e=this.bA(f);this.M.i(e);break;case 2:var u=t.b;var i=this.bA(u);var r=this.bz(i);this.M.j(r);break;case 1:case 3:default:_a.b.d(!1,"Unexpected notification received: "+t.c);break}},bA:function(n){var r=new _j.q;if(n)for(var i=n,f=i.length,t=0;t<f;++t){var u=i[t];this.br(r,u)}return r},bz:function(n){for(var f=this.Y(this.E.d()),u=new _j.q,r=n.d,e=r.length,t=0;t<e;++t){var i=r[t];f.g(i)||u.c(i)}return u},bX:function(n,t){switch(t.c){case 0:var f=t.a;var e=this.Y(f);this.M.i(e);break;case 2:var u=t.b;var i=this.Y(u);var r=this.bz(i);this.M.j(r);break;case 1:case 3:default:_a.b.d(!1,"Unexpected notification received: "+t.c);break}},Y:function(n){var r=new _j.q;if(n)for(var u=n,e=u.length,t=0;t<e;++t){var o=u[t];var i=o;if(i.a()){var f=this;i.a().n(function(n){f.br(r,n)})}}return r},br:function(n,t){var r=t;var i=_im.b.a(r.g());i.localeCompare(this.O)&&(n.g(i)||n.c(i))},bu:function(n){this.ba&&(this.C==="unknown"||!this.Q)&&_j.e.c(_a.a.l,"ChatManager: Do not access {0} until configuration has loaded.",n)},bJ:function(){if(this.e()&&this.S&&this.Q){var n=this;_j.n.a().a(_a.a.l,"ChatManager.SignIn",function(){n.k(!1)},5e3)}},bV:function(n){var r=n.e().bk.InstantMessage;var i=n.c().bk.UserDisplayName;var t=n.c().bk.UserSipUri;this.bW(r,i,t);this.bJ()},bY:function(n){if(!n.a){this.I=!1;this.N(!1)}}};_im.f=function(){this.c=Function.createDelegate(this,this.m);_im.f.initializeBase(this);this.a={}};_im.f.prototype={a:null,k:function(){var t=this.a;for(var n in t){var r={key:n,value:t[n]};var i=r.value;i.d(0)}},l:function(n){this.h(n,!1)},e:function(n){this.h(n,!0)},m:function(n){this.d(n.e(),n.b(),n.d(),n.a(),n.c())},d:function(n,t,i,r,u){this.g(n,t,i,u);this.j(n,t,r,u)},b:function(n,t){var i=t;if(_j.i.b(i)&&!_j.i.b(n)){n=_im.b.a(n);var r=this.a[n];r&&(i=r.a);_j.i.b(i)&&(i=_im.b.c(n))}return i},f:function(n,t){t.val=0;n=_im.b.a(n);var i=this.a[n];if(!i)return!1;t.val=i.b;return!0},h:function(n,t){if(!_j.i.b(n.SipUri)){this.g(n.PayloadType,n.SipUri,n.DisplayName,t);if(!_j.t.a(n.NewUserPresence)){var i=_im.b.b(n.NewUserPresence);this.j(n.PayloadType,n.SipUri,i,t)}}},g:function(n,t,i,r){var u=this;this.i(n,t,r,function(n){_j.i.b(i)||n.e(i)})},j:function(n,t,i,r){var u=this;this.i(n,t,r,function(n){_j.t.a(i)||n.d(i)})},i:function(n,t,i,r){t=_im.b.a(t);var u=this.a[t];if(!u){if(!i)return;u=new _im.p(t);this.a[t]=u}r(u)}};_im.p=function(n){_im.p.initializeBase(this);_a.b.c(n,"sipUri");this.c=n};_im.p.prototype={c:null,a:null,b:0,e:function(n){if(this.a===n)return n;this.a=n;this.bs("DisplayName");return n},d:function(n){if(this.b===n)return n;this.b=n;this.bs("Presence");return n},toString:function(){return String.format("SipUri: {0}, DisplayName: {1}, Presence: {2}",this.c,this.a,this.b)}};_im.q=function(n,t,i,r){this.l=Function.createDelegate(this,this.o);this.f=n;this.m=t;this.i=i;this.h=r;this.i.e(this.l);this.h.e(this.l)};_im.q.prototype={m:null,i:null,h:null,f:!1,g:null,k:!1,n:0,b:function(n){if(n&&this.f){if(this.j()){n();return}this.g||(this.g=new Sys.EventHandlerList);this.g.addHandler("chatInitialized",n)}},a:function(){return this.j()&&this.f?this.m:null},e:function(){return this.j()&&this.f?this.i.b():null},d:function(){return this.j()&&this.f?this.h.b():null},c:function(){return this.f},j:function(){if(!this.k&&this.f){this.i.a(null);this.h.a(null)}return this.k||!this.f},o:function(){this.n++;if(this.n===2){this.k=!0;if(this.g){this.g.getHandler("chatInitialized")();this.g=null}}}};_im.r=function(n,t,i,r,u){this.e=n;this.d=t;this.g=i;this.c=r;this.f=u};_im.r.prototype={e:!1,d:null,g:null,c:null,f:0,b:null,a:function(){_a.b.f(this.f,"Mouse","ChatProviderFactory.Create - Layout");this.b||(this.b=new _im.q(this.e,this.d,this.g,this.c));return this.b}};_im.x=function(n,t,i){_im.x.initializeBase(this,[n,t,i]);_j.e.a(_a.a.l,"PopOutPresenceManager.Ctor.")};_im.x.prototype={p:function(){return new _im.y(this.h)},q:function(n){this.o(n.b(),n.a())},k:function(n){this.f.c(n)},s:function(){}};_im.y=function(n){_im.y.initializeBase(this,[n]);_j.e.a(_a.a.l,"PopOutPresenceRequestsManager.Ctor")};_im.y.prototype={c:function(n){_a.b.c(n,"sipUri");this.d.queryPresenceInMainWindow(n)},j:function(n){_a.b.c(n,"sipUri");return!0},i:function(){}};_im.z=function(n,t,i){this.l=Function.createDelegate(this,this.t);this.m=Function.createDelegate(this,this.q);this.n=Function.createDelegate(this,this.u);this.d={};_im.z.initializeBase(this);_a.b.a(n,"chatManager");_a.b.a(t,"chatParticipantCache");_a.b.a(i,"presenceCrossWindowNotifier");this.e=n;this.i=t;this.e.apcl(_im.c.b,this.n);this.e.j(this.m);this.h=i;this.f=this.p();this.g=this.e.C;_j.e.a(_a.a.bm,"PresenceManager.Ctor.")};_im.z.prototype={e:null,i:null,h:null,f:null,g:"unknown",j:function(){return this.e.C==="SignedIn"},c:function(n){_a.b.a(n,"persona");if(!this.e.e())return!1;_j.e.a(_a.a.bm,"PresenceManager.TryRegisterForPresenceUpdates: Registering persona for presence updates: {0}, SIP:{1}",n.d(),n.g()||"");n.apcl("ImAddress",this.l);if(_j.i.b(n.g()))return!0;var t=_im.b.a(n.g());this.v(t,n);this.k(t);return!0},a:function(n){_a.b.a(n,"persona");_j.e.a(_a.a.bm,"PresenceManager.TryUnregisterForPresenceUpdates: Unregistering persona for presence updates: {0}, SIP:{1}",n.d(),n.g()||"");return this.r(n,n.g())},b:function(n,t){_a.b.c(n,"sipUri");this.k(n);t.val=0;if(n in this.d){var i=this.d[n];if(i.b()>0){t.val=i.a(0).X();return!0}}return!1},p:function(){return new _im.g(this.h)},k:function(n){if(this.j()){var t;var r,i;(i=this.i.f(n,r={val:t}),t=r.val,i)&&this.o(n,t);n!==_im.b.a(this.e.c())&&this.f.c(n)}},q:function(n){if(this.j()){this.o(n.b(),n.a());this.h.updatePresenceInAllPopOutWindows(n.b(),n.a())}},o:function(n,t){n=_im.b.a(n);if(!(n in this.d))return!1;for(var r=this.d[n],i=0;i<r.b();i++){var u=r.a(i);u.x(t)}return!0},s:function(){this.h.updateSignInStateInAllPopOutWindows(this.g)},D:function(){_j.e.a(_a.a.bm,"PresenceManager.InternalDispose.");this.e.rpcl(_im.c.b,this.n);this.e.bD(this.m);this.f.dispose();this.f=null},r:function(n,t){if(!this.e.e())return!1;n.rpcl("ImAddress",this.l);if(_j.i.b(t))return!1;var i=_im.b.a(t);if(!(i in this.d))return!1;var r=this.d[i];var u=r.l(n);if(!r.b()){delete this.d[i];this.f.j(i)}return u},u:function(n,t){var a=n;var r=this.g;var y=r==="SignedIn";this.g=a.C;var s=this.j();if(y!==s)if(s){_j.e.a(_a.a.bm,"PresenceManager.OnSignInStateChanged: OldSignInState: {0} to NewSignInState: {1}. Requesting presence for every persona active.",r,this.g);var e=this.d;for(var f in e){var c={key:f,value:e[f]};var l=c.key;this.k(l)}}else{_j.e.a(_a.a.bm,"PresenceManager.OnSignInStateChanged: OldSignInState: {0} to NewSignInState: {1}. Resetting presence to Unknown everywhere.",r,this.g);var h=this.d;for(var o in h)for(var v={key:o,value:h[o]},u=v.value,i=0;i<u.b();i++)u.a(i).x(0);this.f.i();this.i.k()}this.s()},t:function(n,t){var i=n;var r=null;var e=this.d;for(var f in e){var u={key:f,value:e[f]};var s=u.key;var o=u.value;if(o.g(i)){r=s;break}}_j.e.a(_a.a.bm,"PresenceManager.OnImAddressChangedForAPersona: Unregistering persona {0} for old IM Address {1}",i.d(),r);this.r(i,r);_j.e.a(_a.a.bm,"PresenceManager.OnImAddressChangedForAPersona: Re-registering persona {0} for new IM Address {1}",i.d(),i.g());this.c(i)},v:function(n,t){n in this.d||(this.d[n]=new _a.j);var i=this.d[n];if(!i.g(t)){i.c(t);i.b()>1?t.x(i.a(0).X()):this.j()||t.x(0)}}};_im.g=function(n){this.g=Function.createDelegate(this,this.m);this.e=Function.createDelegate(this,this.k);this.f=Function.createDelegate(this,this.l);this.a=new _a.j;_im.g.initializeBase(this);_a.b.b(n,"presenceCrossWindowNotifier");this.d=n;this.a.n(this.f);_j.e.a(_a.a.bm,"PresenceRequestsManager.Ctor")};_im.g.prototype={d:null,b:null,c:function(n){_a.b.c(n,"sipUri");if(!this.a.g(n)){_j.e.a(_a.a.bm,"PresenceRequestsManager.AddOrUpdatePendingGetRequests: Queuing a presence retrieval request for sip {0}",n);this.a.c(n)}},j:function(n){_a.b.c(n,"sipUri");return this.a.l(n)},i:function(){_j.e.a(_a.a.bm,"PresenceRequestsManager.ClearAll: Clearing all pending get presence requests: {0}",this.a.b());this.a.m()},D:function(){_j.e.a(_a.a.bm,"PresenceRequestsManager.InternalDispose.");this.h()},h:function(){if(this.b){_j.e.a(_a.a.bm,"PresenceRequestsManager.CancelBatchGetPresenceRequestsTimer.");this.b=_j.n.a().b(this.b)}},m:function(){this.b=null;var t=this.a.f();var i=t.join("; ");this.a.m();var n=new _im.u(t);n.b(this.e);_a.g.a.a(n)},l:function(n,t){if(this.a.b()>0){if(!this.b){_j.e.a(_a.a.bm,"PresenceRequestsManager.OnPendingGetPresenceRequestsCollectionChanged: Activating timer to run after {0}ms. Current count of pending requests = {1}",_im.g.a,this.a.b());this.b=_j.n.a().a(_a.a.bm,"GetPresence",this.g,_im.g.a)}}else{_j.e.a(_a.a.bm,"PresenceRequestsManager.OnPendingGetPresenceRequestsCollectionChanged: Cancelling timer. Current count of pending requests = {0}",this.a.b());this.h()}},k:function(n){var t=n;var i=t.c.join("; ");if(t.J){_j.e.b(_a.a.bm,"PresenceRequestsManager.OnGetPresenceActionCompleted: Failed with {0} for {1} SipUris: '{2}'",t.J,this.a.b(),i);return}}};_im.A=function(n){this.h=Function.createDelegate(this,this.n);this.f=Function.createDelegate(this,this.l);this.g=Function.createDelegate(this,this.m);this.d=n;this.b=new _j.q;this.c=new _j.q;this.a=new _j.q};_im.A.prototype={d:null,b:null,c:null,a:null,e:!1,i:function(n){for(var i=new _j.q,f=n.d,e=f.length,r=0;r<e;++r){var t=f[r];if(this.a.g(t)){this.a.n(t);continue}this.c.g(t)||this.b.g(t)||i.g(t)||i.c(t)}if(i.d.length>0){this.b.h(i.d);var u=new _im.E(i.d);u.d(this.g);u.e(this.f);this.d.a(u)}},j:function(n){for(var i=0;i<n.d.length;i++){var t=n.d[i];if(this.b.g(t)){this.b.n(t);continue}this.a.g(t)||this.c.g(t)&&this.a.c(t)}this.k()},k:function(){if(this.a.d.length&&!this.e){this.e=!0;var t=this.a.d[0];this.a.i(0);this.c.n(t);var n=new _im.F(t);n.b(this.h);this.d.a(n)}},n:function(n){this.e=!1;this.k()},m:function(n){for(var f=n,r=f.c,u=r.length,t=0;t<u;++t){var i=r[t];this.c.g(i)||this.c.c(i);this.b.n(i)}_j.e.a(_a.a.l,"SubscribeForPresenceUpdates: succeeded.")},l:function(n){for(var r=n,i=r.c,e=i.length,t=0;t<e;++t){var f=i[t];this.b.n(f)}var u=r.c.join(";");_j.e.a(_a.a.l,"SubscribeForPresenceUpdates: failed to subscribe for: {0}.",u)}};_im.h=function(n,t,i,r,u){_a.b.c(n,"source");_a.b.c(t,"sipUri");this.j=n;this.i=t;this.f=i;this.h=r;this.g=u};_im.h.prototype={j:null,i:null,f:null,h:0,g:!1,e:function(){return this.j},b:function(){return this.i},d:function(){return this.f},a:function(){return this.h},c:function(){return this.g},toString:function(){return String.format("Source: {0}, Sip: {1}, DisplayName: {2}, Presence: {3}, IsAboutMeOrMyBuddy: {4}",this.j,this.i,this.f,this.h,this.g)}};_im.b=function(){};_im.b.b=function(n){switch(n){case"Away":return 3;case"BeRightBack":return 3;case"Busy":return 4;case"DoNotDisturb":return 6;case"IdleBusy":return 4;case"IdleOnline":return 2;case"None":return 0;case"Offline":return 1;case"Online":return 2;default:return 0}};_im.b.d=function(n){switch(n){case 2:return"Online";case 3:return"Away";case 5:return"IdleBusy";case 4:return"Busy";case 6:return"DoNotDisturb";case 1:return"Offline";case 0:default:return"None"}};_im.b.a=function(n){_a.b.c(n,"imAddress");var t=n.toLowerCase();t.startsWith("sip:")||(t="sip:"+t);return t};_im.b.c=function(n){_a.b.c(n,"imAddress");var t=n.toLowerCase();t.startsWith("sip:")&&(t=t.substr(4));return t};_im.e=function(n){this.j=Function.createDelegate(this,this.l);this.g=Function.createDelegate(this,this.o);this.k=Function.createDelegate(this,this.q);this.f=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.p);_im.e.initializeBase(this,[n]);_im.e.a++;this.e=".ChatMouseView#Handler."+_im.e.a};_im.e.prototype={e:null,b:null,c:null,d:null,a:null,n:function(){if(!this.a)return null;if(!_j.i.a(this.a.m()))return this.a.m();var t=this.a.a();var n=t.x.length;if(n)if(n===1){var i=t.x[0];return String.format(_nbs.a.p,i.c())}else return String.format(_nbs.a.MX,n);else return null},G:function(){_j.c.prototype.G.call(this);this.d.bJ(!1);this.b.d(100);this.l(null)},Z:function(){_j.h.prototype.Z.call(this);if(!this.W()){if(this.a){this.a.a().g(this.h);this.a.rpcl(_h.g.c.a,this.f)}this.a=null;return}var n=this.W();this.a=n.a;this.a.a().e(this.h);this.a.apcl(_h.g.c.a,this.f);this.a.apcl(_h.g.e.a,this.k)},I:function(){_j.c.prototype.I.call(this);if(!this.C){this.c.rpcl(_b.p.a.a,this.g);$(window).unbind(this.e);this.c=null;this.b=null;this.d=null;return}this.b=this.C.a("TranscriptScrollRegion");this.c=this.C.a("TranscriptLabel");this.d=this.C.a("Editor");this.c.apcl(_b.p.a.a,this.g);$(window).bind("resize"+this.e,this.j);this.i()},i:function(){var n=this.n();_j.i.a(n)||(window.document.title=n)},p:function(n,t){this.i()},m:function(n,t){this.i()},q:function(n,t){if(this.a.s()){var i=_j.E.d(this.d.z.children,"textarea");i.length>0&&i[0].setAttribute("disabled","true")}},o:function(n,t){var i=this.b.z;var r=i.scrollHeight;i.scrollTop=r-_j.k.e(i)},l:function(n){var t=$(window).height();t>=425&&(this.b.z.style.height=String.format("{0}px",251+t-425))}};_im.a=function(){};_im.a.$$cctor=function(){_im.a._I()};_im.a.f=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <div class='_im_2'> <div class='_im_3 ms-bg-color-neutralLighter'> <div class='_im_4'> <div></div> </div> </div> <div class='_im_5'> <span></span> <div></div> </div> <div class='_im_6 ms-font-weight-regular ms-font-color-neutralSecondary ms-bg-color-neutralLighter ms-border-color-neutralTertiaryAlt'> <span></span> </div> <div class='_im_7 border-color-transparent ms-border-color-neutralTertiaryAlt-hover'></div> </div> </div>";_j.h.a().appendChild(n);return n};_im.a.t=function(n){return n.b()};_im.a.b=function(n){return n.a};_im.a.q=function(n){return n.l()};_im.a.e=function(n){return n.S()};_im.a.r=function(n){return n.t()};_im.a.u=function(n){return n.g};_im.a.s=function(n){return n.f};_im.a.i=function(n){return n.ce};_im.a.v=function(n){return n.c()};_im.a.j=function(n){return n.ck()};_im.a.g=function(n,t){n.ba(t)};_im.a.d=function(n,t){n.a(t)};_im.a.n=function(n,t){n.a(t)};_im.a.h=function(n,t){n.Q(t)};_im.a.o=function(n,t){n.eF(t)};_im.a.w=function(n,t){n.j(t)};_im.a.k=function(n,t){n.bO(t)};_im.a.x=function(n,t){n.q(t)};_im.a.l=function(n,t){n.cJ(t)};_im.a.p=function(n,t){n.cf(t)};_im.a.m=function(n,t){n.cq=t};_im.a._I=function(){var n="ChatMouseView";new _j.d(n,function(){_im.a.a[n]===undefined&&(_im.a.a[n]=[null,[[-1,0,["ParticipantsViewModel"],[_im.a.t],null,"DataContext",null,_im.a.g,1,null,null,null]],null,[[-1,0,["Chat","BodyText"],[_im.a.b,_im.a.q],null,"Html",null,_im.a.d,1,null,null,null]],[[-1,0,["Chat","LastMessageAriaLabel"],[_im.a.b,_im.a.e],null,"Text",null,_im.a.n,1,null,null,null],[-1,0,["Chat","LastMessageAriaLabel"],[_im.a.b,_im.a.e],null,"AriaLabel",null,_im.a.h,1,null,null,null]],[[-1,0,["Chat","Status"],[_im.a.b,_im.a.r],null,"Html",null,_im.a.d,1,null,null,null]],[[-1,4,null,null,null,"SizingMode",null,_im.a.p,0,null,null,0,1],[-1,4,null,null,null,"EditorAriaLabel",null,_im.a.m,0,null,null,null,_u.n.PB],[-1,0,["SendCommand"],[_im.a.u],null,"EnterCommand",null,_im.a.o,1,null,null,null],[-1,0,["EditorCallContext"],[_im.a.s],_im.a.w,"CallContext",_im.a.i,_im.a.k,2,null,null,null],[-1,0,["SendText"],[_im.a.v],_im.a.x,"Content",_im.a.j,_im.a.l,2,null,null,null]]]);var t=_im.a.c.childNodes[0].cloneNode(!0);var i=new _zz.i(_j.a.a(t,[0,3]),_j.b.Instance.a(_y.a),_j.b.Instance.a(_j.o),_j.b.Instance.a(_j.j),_j.b.Instance.a(_b.d),_j.b.Instance.a(_a.f));i.bU("_im_8 ms-font-weight-regular ms-font-color-black");i.eG(!0);var o=new _b.p(_j.a.a(t,[0,2,0]),_j.b.Instance.a(_a.f));var s=new _b.S(_j.a.a(t,[0,1,1]),_j.b.Instance.a(_j.j));var r=new _b.p(_j.a.a(t,[0,1,0]),_j.b.Instance.a(_a.f));var f=new _fce.g(_j.a.a(t,[0,1]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));var u=new _j.c(_j.a.a(t,[0,0,0,0]));u.y("ReadOnlyRecipientWellView");var e=new _fce.g(_j.a.a(t,[0,0,0]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));return new _j.a(t,[e,u,f,r,s,o,i]).l({TranscriptScrollRegion:f,TranscriptLabel:r,Editor:i})},"",_im.d,_im.e,function(n){return new _im.e(n)},!1,!1,!1,0,_im.a.a)};_im.i.registerClass("_im.i");_im.d.registerClass("_im.d",_a.bB);_im.j.registerClass("_im.j",null,IChatViewModelFactory,_bc.Y);_im.m.registerClass("_im.m",_h.fa);_im.s.registerClass("_im.s",_h.fa);_im.u.registerClass("_im.u",_h.fa);_im.v.registerClass("_im.v",_h.fa);_im.w.registerClass("_im.w",_h.fa);_im.B.registerClass("_im.B",_h.fa);_im.C.registerClass("_im.C",_h.fa);_im.D.registerClass("_im.D",_h.fa);_im.k.registerClass("_im.k",_a.cU);_im.E.registerClass("_im.E",_h.fa);_im.F.registerClass("_im.F",_h.fa);_im.c.registerClass("_im.c",_j.Q,IChatManager,_j.bp,Sys.IDisposable);_im.f.registerClass("_im.f",_j.Q);_im.p.registerClass("_im.p",_j.Q);_im.z.registerClass("_im.z",_j.bZ,IPresenceManager);_im.x.registerClass("_im.x",_im.z);_im.g.registerClass("_im.g",_j.bZ);_im.y.registerClass("_im.y",_im.g);_im.e.registerClass("_im.e",_j.c);_im.d.b=new _a.e("SendText",String,_im.d,"");_im.d.a=new _a.e("ParticipantsViewModel",_rw.b,_im.d);_im.c.b="SignInState";_im.c.c="IsSignedIn";_im.c.a="Presence";_im.g.a=5e3;_im.e.a=0;_im.a.c=_im.a.f();_im.a.a={};_im.a.$$cctor();
window.scriptsLoaded['microsoft.owa.core.im.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.core.im.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
