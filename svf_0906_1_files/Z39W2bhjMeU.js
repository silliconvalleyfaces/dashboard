if (self.CavalryLogger) { CavalryLogger.start_js(["EkPhv"]); }

__d("ComposedEntityMutability",[],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={MUTABLE:0,IMMUTABLE:1,SEGMENTED:2};}),null);
__d('NotificationJewelReminder',['cx','fbt','Arbiter','DOMQuery','Image.react','ImageBlock.react','LayerFadeOnHide','LayerFadeOnShow','NotificationStore','NotificationUpdates','React','ReactDOM','Toggler','WorkFocusModeController','XUIContextualDialog.react','ge','ifRequired','injectSubscriptionsHandler.react','intlList','setTimeoutAcrossTransitions'],(function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('WorkFocusModeController').WorkFocusMode,m=2,n='fbRequestsJewel',o='fbNotificationsJewel';j=babelHelpers.inherits(p,c('React').Component);k=j&&j.prototype;function p(s){'use strict';k.constructor.call(this,s);this.$JewelReminderDialogImpl2=function(){this.setState({shown:false},function(){this.props.onHide&&this.props.onHide();}.bind(this));}.bind(this);this.$JewelReminderDialogImpl3=function(){clearTimeout(this.$JewelReminderDialogImpl1);}.bind(this);this.$JewelReminderDialogImpl4=function(){this.$JewelReminderDialogImpl3();}.bind(this);this.$JewelReminderDialogImpl5=function(){this.$JewelReminderDialogImpl2();}.bind(this);this.$JewelReminderDialogImpl6=function(t){this.$JewelReminderDialogImpl2();this.props.onClick&&this.props.onClick(t);}.bind(this);this.state={shown:true};}p.prototype.componentWillMount=function(){'use strict';this.$JewelReminderDialogImpl1=c('setTimeoutAcrossTransitions')(this.$JewelReminderDialogImpl2,this.props.showTime);this.props.subscriptionsHandler.addSubscriptions(c('Arbiter').subscribe('layer_shown',function(s,t){if(t&&t.type==='Jewel')this.$JewelReminderDialogImpl2();}.bind(this)));};p.prototype.componentWillUnmount=function(){'use strict';this.$JewelReminderDialogImpl3();};p.prototype.$JewelReminderDialogImpl7=function(){'use strict';var s=this.props,t=s.names,u=s.jewelType,v=s.unreadCount,w=t.map(function(x){return c('React').createElement('b',null,x);});if(u==='notification')return i._({"*":{"notifications":"{notification senders}\u7684{number}\u5247\u901a\u77e5","notification":"\u4f86\u81ea{notification senders}\u7684{number}\u5247\u901a\u77e5"}},[i.param('number',v,[0]),i['enum'](v>1?'notifications':'notification',{notifications:'notifications',notification:'notification'}),i.param('notification senders',c('intlList')(w))]);return i._({"*":{"requests":"{number}\u500b\u4f86\u81ea{request senders}\u7684\u4ea4\u53cb\u9080\u8acb","request":"{number}\u500b\u4f86\u81ea{request senders}\u7684\u4ea4\u53cb\u9080\u8acb"}},[i.param('number',v,[0]),i['enum'](v>1?'requests':'request',{requests:'requests',request:'request'}),i.param('request senders',c('intlList')(w))]);};p.prototype.render=function(){'use strict';var s=this.props,t=s.context,u=s.photoURI;return (c('React').createElement(c('XUIContextualDialog.react'),{context:t,shown:this.state.shown,offsetY:-10,position:'below',alignment:'right',behaviors:{LayerFadeOnShow:c('LayerFadeOnShow'),LayerFadeOnHide:c('LayerFadeOnHide')},width:210},c('React').createElement('div',{onMouseEnter:this.$JewelReminderDialogImpl4,onMouseLeave:this.$JewelReminderDialogImpl5,onClick:this.$JewelReminderDialogImpl6,className:"_5bov"},c('React').createElement(c('ImageBlock.react'),null,c('React').createElement(c('Image.react'),{className:"_5bow",src:u}),c('React').createElement('div',null,this.$JewelReminderDialogImpl7())))));};var q=c('injectSubscriptionsHandler.react')(p);function r(s){'use strict';if(s.request.count>0&&s.show_request){this.$NotificationJewelReminder2(s.request,s.show_notif,s.show_time);}else this.$NotificationJewelReminder3(s.show_notif,s.show_time);}r.prototype.$NotificationJewelReminder4=function(s){'use strict';return s!=null&&!c('Toggler').getInstance(s).isShown();};r.prototype.$NotificationJewelReminder2=function(s,t,u){'use strict';this.$NotificationJewelReminder5(s.pics[0],s.names,s.count,n,u,function(){return this.$NotificationJewelReminder3(t,u);}.bind(this));};r.prototype.$NotificationJewelReminder3=function(s,t){'use strict';var u=l&&l.currentViewerInFocusMode();if(u||!s)return;this.$NotificationJewelReminder1=c('NotificationUpdates').subscribe('update-notifications',function(v,w){var x=w.nodes;if(x)this.$NotificationJewelReminder6(x,t);}.bind(this));c('NotificationStore').getNotifications(Number.isInteger(s)?s:0,function(v){return this.$NotificationJewelReminder6(v,t);}.bind(this));};r.prototype.$NotificationJewelReminder6=function(s,t){'use strict';if(this.$NotificationJewelReminder1){this.$NotificationJewelReminder1.unsubscribe();this.$NotificationJewelReminder1=null;}var u=[],v=void 0;s=s.filter(function(z){return z.seen_state==='UNSEEN_AND_UNREAD';});for(var w=0;w<s.length;w++){if(!s[w].showBeep)continue;var x=s[w].actors;if(x.length===0)continue;for(var y=0;y<x.length;y++){v=v||x[y].profile_picture.uri;if(u.length<m&&x[y].name&&u.indexOf(x[y].name)===-1)u.push(x[y].name);}if(u.length===m)break;}if(u.length===0||!v)return;this.$NotificationJewelReminder5(v,u,s.length,o,t);};r.prototype.$NotificationJewelReminder5=function(s,t,u,v,w,x){'use strict';var y=c('ge')(v);if(!this.$NotificationJewelReminder4(y))return;c('ReactDOM').render(c('React').createElement(q,{showTime:w,context:c('DOMQuery').scry(y,'.jewelButton')[0],names:t,photoURI:s,unreadCount:u,jewelType:v===o?'notification':'request',onClick:function z(){c('Toggler').show(y);c('ifRequired')('ClientChromeStore',function(aa){aa.dispatch({type:'UPDATE_ACTIVE_FLYOUT',data:v===o?'notification':'request'});});},onHide:x}),document.createElement('div'));};f.exports=r;}),null);