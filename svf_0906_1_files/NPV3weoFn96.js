if (self.CavalryLogger) { CavalryLogger.start_js(["4B3Yi"]); }

__d("MNCommerceCallToActionType",[],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports={OPEN_NATIVE:1,OPEN_URL:2,OPEN_CANCEL_RIDE_MUTATION:3,POSTBACK:4,ACCOUNT_LINK:5,MANAGE_MESSAGES:6,SHARE:7,PAYMENT:8,FACEBOOK_REPORT_A_PROBLEM:9};}),null);
__d('relativeTimeString.atlas',['fbt'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();function i(j,k){var l=Date.now(),m='',n=null,o=Math.floor((j-l)/1000),p=o<0;o=Math.abs(o);if(o<60){if(k){m=p?h._("\u525b\u525b"):h._("\u73fe\u5728");}else m=p?h._("\u525b\u525b"):h._("\u73fe\u5728");}else if(o<60*2){m=p?h._("1 \u5206\u9418\u524d"):h._("1 \u5206\u9418");}else if(o<3600){n=Math.floor(o/60);m=p?h._("{number}\u5206\u9418\u524d",[h.param('number',n)]):h._("{number}\u5206\u9418",[h.param('number',n)]);}else if(o<3600*2){if(k){m=p?h._("\u7d04 1 \u5c0f\u6642\u524d"):h._("about an hour");}else m=p?h._("\u7d04 1 \u5c0f\u6642\u524d"):h._("About an hour");}else if(o<3600*24){n=Math.floor(o/3600);m=p?h._("{number}\u5c0f\u6642\u524d",[h.param('number',n)]):h._("{number}\u5c0f\u6642",[h.param('number',n)]);}else if(o<3600*24*2){if(k){m=p?h._("\u7d04\u4e00\u5929\u524d"):h._("about a day");}else m=p?h._("\u7d04\u4e00\u5929\u524d"):h._("About a day");}else if(o<3600*24*30){n=Math.floor(o/3600/24);m=p?h._("{number}\u5929\u524d",[h.param('number',n)]):h._("{number}\u5929",[h.param('number',n)]);}else if(o<3600*24*30*2){if(k){m=p?h._("\u7d04 1 \u500b\u6708\u524d"):h._("about a month");}else m=p?h._("\u7d04 1 \u500b\u6708\u524d"):h._("About a month");}else if(o<3600*24*30*12){n=Math.floor(o/3600/24/30);m=p?h._("{number}\u500b\u6708\u524d",[h.param('number',n)]):h._("{number}\u500b\u6708",[h.param('number',n)]);}else if(o<3600*24*30*24){if(k){m=p?h._("1 \u5e74\u524d"):h._("over a year");}else m=p?h._("1 \u5e74\u524d"):h._("Over a year");}else{n=Math.floor(o/3600/24/365);m=p?h._("{number}\u5e74\u524d",[h.param('number',n)]):h._("{number}\u5e74",[h.param('number',n)]);}return m;}f.exports=i;}),null);
__d("XOmnipickerPhotoUploadController",["XController"],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/omnipicker\/upload\/file\/photo\/",{source:{type:"Enum",required:true,enumType:0},waterfall_id:{type:"String"},vault_fbid:{type:"String"}});}),null);
__d('CommerceContactMerchantManualPaymentSection.react',['cx','fbt','FileInput.react','FileInputUploader','Image.react','React','ReactDOM','XOmnipickerPhotoUploadController','XUIButton.react','XUIGrayText.react','XUISpinner.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes,m=29,n=120;j=babelHelpers.inherits(o,c('React').Component);k=j&&j.prototype;function o(p){k.constructor.call(this,p);this.$CommerceContactMerchantManualPaymentSection6=function(event,q){var r=q.response.getPayload()[0];this.setState({photoUploading:false,receiptPhotoID:r.fbid,receiptPhotoURL:r.src});this.props.onReceiptUpdated(r.fbid,r.src);}.bind(this);this.$CommerceContactMerchantManualPaymentSection2=function(q){var r=c('XOmnipickerPhotoUploadController').getURIBuilder().setEnum('source',m).getURI(),s=this.refs.fileInput,t=new (c('FileInputUploader'))(c('ReactDOM').findDOMNode(s)).setURI(r);t.subscribe('failure',this.$CommerceContactMerchantManualPaymentSection5);t.subscribe('success',this.$CommerceContactMerchantManualPaymentSection6);t.send();s.getFileInput().clear();this.setState({photoUploading:true});}.bind(this);this.state={receiptPhotoID:null,receiptPhotoURL:null,photoUploading:false};}o.prototype.render=function(){return c('React').createElement('div',{className:"_2ph-"},c('React').createElement(c('XUIGrayText.react'),{display:'block',shade:'light',size:'small'},this.$CommerceContactMerchantManualPaymentSection1()),c('React').createElement(c('XUIGrayText.react'),{display:'block',shade:'dark',size:'small',className:"_3-8m"},this.props.bankAccountDetails),c('React').createElement(c('XUIGrayText.react'),{className:"_3-97",display:'block',size:'small'},i._("\u8a02\u55ae\u865f\u78bc{order_number}",[i.param('order_number',this.props.invoiceID)])),c('React').createElement('div',null,c('React').createElement(c('XUISpinner.react'),{className:"_3-9c"+(!this.state.photoUploading?' '+"hidden_elem":'')}),c('React').createElement('div',{className:(this.state.photoUploading?"hidden_elem":'')+(' '+"_3-96")},c('React').createElement(c('FileInput.react'),{name:'file',multiple:false,ref:'fileInput',accept:'image/*',onChange:this.$CommerceContactMerchantManualPaymentSection2},c('React').createElement(c('XUIButton.react'),{href:{url:'#'},label:this.$CommerceContactMerchantManualPaymentSection3()})))),this.$CommerceContactMerchantManualPaymentSection4());};o.prototype.$CommerceContactMerchantManualPaymentSection4=function(){if(!this.state.receiptPhotoURL)return null;return c('React').createElement(c('Image.react'),{src:this.state.receiptPhotoURL,height:n,width:n});};o.prototype.$CommerceContactMerchantManualPaymentSection3=function(){return this.state.receiptPhotoID?i._("\u9644\u4e0a\u5176\u4ed6\u6536\u64da"):i._("\u9644\u4e0a\u6536\u64da");};o.prototype.$CommerceContactMerchantManualPaymentSection1=function(){return i._("\u8ce3\u5bb6\u7684\u4ed8\u6b3e\u6307\u793a");};o.prototype.$CommerceContactMerchantManualPaymentSection5=function(p){};o.propTypes={bankAccountDetails:l.string.isRequired,invoiceID:l.string.isRequired,onReceiptUpdated:l.func.isRequired};f.exports=o;}),null);
__d('FBAccordion.react',['cx','invariant','React','joinClasses'],(function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();j=babelHelpers.inherits(l,c('React').Component);k=j&&j.prototype;function l(){var m,n;'use strict';for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return m=(n=k.constructor).call.apply(n,[this].concat(p)),this.$FBAccordion1=function(r){var s=0,t=this.state&&this.state.expandedSectionKey,u=null;c('React').Children.forEach(r.children,function(v,w){var x=v.props.expanded;u=t===w?t:u;if(x&&t===null){!(s===0)?i(0):void 0;s++;u=w;}else if(u===null)u=w;});return u;}.bind(this),this.$FBAccordion2=function(r){if(this.state.expandedSectionKey!==r)this.setState({expandedSectionKey:r});}.bind(this),this.state={expandedSectionKey:this.$FBAccordion1(this.props)},m;}l.prototype.componentWillReceiveProps=function(m){'use strict';var n=this.$FBAccordion1(m);if(this.state.expandedSectionKey!==n)this.setState({expandedSectionKey:n});};l.prototype.render=function(){'use strict';var m=c('React').Children.map(this.props.children,function(n,o){return c('React').cloneElement(n,{isExpanded:this.state.expandedSectionKey===o,onSectionClick:this.$FBAccordion2,sectionKey:o});}.bind(this));return c('React').createElement('div',babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_5ygd")}),m);};f.exports=l;}),null);
__d('FBAccordionSection.react',['cx','React','emptyFunction'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;'use strict';for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return m=(n=j.constructor).call.apply(n,[this].concat(p)),this.onClick=function(){this.props.onSectionClick(this.props.sectionKey);this.props.onClick(this.props.sectionKey);}.bind(this),m;}l.prototype.render=function(){'use strict';var m=this.props.maxHeight||'100%';return c('React').createElement('div',{className:"_4r-a"+(this.props.isExpanded?' '+"_3uxn":'')},c('React').createElement('div',{className:"_5yg8",onClick:this.onClick},this.props.header),c('React').createElement('div',{className:"_1flr",style:{maxHeight:this.props.isExpanded?m:0}},this.props.children));};l.propTypes={expanded:k.bool,header:k.node.isRequired,maxHeight:k.number,onClick:k.func};l.defaultProps={expanded:false,onClick:c('emptyFunction')};f.exports=l;}),null);
__d('FBActionSelector.react',['cx','ContextualLayer.react','LayerHideOnBlur','Link.react','React','XUIPopoverButton.react','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=c('React').createClass({displayName:'FBActionSelector',statics:{getButtonSize:function m(n){return c('XUIPopoverButton.react').getButtonSize(n);}},propTypes:{alignment:k.oneOf(['left','right','center']),disabled:k.bool,maxHeight:k.number,onAction:k.func.isRequired,position:k.oneOf(['above','below','left','right']),size:k.oneOf(['small','medium','large','xlarge','xxlarge'])},getInitialState:function m(){return {showMenu:false};},render:function m(){var n=this.props,o=n.className,p=n.disabled,q=n.use,r=babelHelpers.objectWithoutProperties(n,['className','disabled','use']);o=c('joinClasses')("_hbk","_hbl",o);q=q||'default';return (c('React').createElement('span',null,c('React').createElement(c('XUIPopoverButton.react'),babelHelpers['extends']({},r,{className:o,depressed:q=='default'&&this.state.showMenu,disabled:p,onClick:p?null:this._showMenu,ref:'menuOpener',use:q})),this.renderLayers()));},renderLayers:function m(){if(this.state.showMenu&&!this.props.disabled){var n=c('React').Children.map(this.props.children,function(p,q){return c('React').cloneElement(p,{optionName:'option_'+q,onOptionSelect:this._onOptionSelect});}.bind(this)),o=this.props.maxHeight?{maxHeight:this.props.maxHeight,overflow:'auto'}:undefined;return (c('React').createElement(c('ContextualLayer.react'),{alignment:this.props.alignment,key:'menu',behaviors:{LayerHideOnBlur:c('LayerHideOnBlur')},contextRef:function(){return this.refs.menuOpener;}.bind(this),position:this.props.position?this.props.position:'below',onToggle:this._onMenuToggle,shown:true},c('React').createElement('div',{className:"_hbm",style:o,role:'menu'},n)));}else return null;},_showMenu:function m(){if(!this.state.showMenu)this.setState({showMenu:true});},_removeMenu:function m(){if(this.state.showMenu&&this.isMounted())this.setState({showMenu:false});},_onMenuToggle:function m(n){if(!n)setTimeout(this._removeMenu,16);},_onOptionSelect:function m(n){this.setState({showMenu:false});this.props.onAction(n);}});l.Option=(j=i=function(){var m,n;m=babelHelpers.inherits(o,c('React').Component);n=m&&m.prototype;function o(){var p,q;'use strict';for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=n.constructor).call.apply(q,[this].concat(s)),this.$_class1=function(event){event.preventDefault();this.props.onOptionSelect(this.props.value);}.bind(this),p;}o.prototype.render=function(){'use strict';if(this.props.disabled)return c('React').createElement('div',babelHelpers['extends']({},this.props,{className:"_hbn"}),this.props.children);return c('React').createElement(c('Link.react'),babelHelpers['extends']({},this.props,{className:"_hbo",onClick:this.$_class1}),this.props.children);};return o;}(),i.propTypes={value:k.string.isRequired,disabled:k.bool},j);l.Separator=function(){var m,n;m=babelHelpers.inherits(o,c('React').Component);n=m&&m.prototype;o.prototype.render=function(){'use strict';return c('React').createElement('div',{className:"_hbp"});};function o(){'use strict';m.apply(this,arguments);}return o;}();f.exports=l;}),null);
__d('FBButtonMenuCombo.react',['invariant','FBActionSelector.react','React','Tooltip','XUIButton.react','XUIButtonGroup.react'],(function a(b,c,d,e,f,g,h){'use strict';var i,j,k,l;if(c.__markCompiled)c.__markCompiled();var m=c('FBActionSelector.react').Option,n=c('React').PropTypes;i=babelHelpers.inherits(o,c('React').PureComponent);j=i&&i.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=j.constructor).call.apply(q,[this].concat(s)),this.$FBButtonMenuCombo1=function(){var u=[],v=[];c('React').Children.forEach(this.props.children,function(w,x){!w.type.__FBButtonMenuComboItem__?h(0):void 0;if(x<this.props.numberOfButtons){var y=this.props.useImageOnlyButtons?null:w.props.label;u.push(c('React').createElement(c('XUIButton.react'),babelHelpers['extends']({},c('Tooltip').propsFor(w.props.tooltip),{'data-tooltip-alignh':this.props.tooltipAlignH,'data-tooltip-position':this.props.tooltipPosition,disabled:this.props.disabled||w.props.disabled,image:w.props.image,key:w.props.value,label:y,onClick:function(){return this.props.onClick(w.props.value);}.bind(this),size:this.props.size})));}else v.push(c('React').createElement(m,babelHelpers['extends']({},c('Tooltip').propsFor(w.props.tooltip),{'data-tooltip-alignh':this.props.tooltipAlignH,'data-tooltip-position':this.props.tooltipPosition,disabled:this.props.disabled||w.props.disabled,key:w.props.value,value:w.props.value}),w.props.label));}.bind(this));return {buttons:u,menuItems:v};}.bind(this),p;}o.prototype.render=function(){var p=this.$FBButtonMenuCombo1(),q=p.buttons,r=p.menuItems,s=null;if(r.length>0)s=c('React').createElement(c('FBActionSelector.react'),{alignment:'right',disabled:this.props.disabled,onAction:this.props.onClick,size:this.props.size},r);return c('React').createElement(c('XUIButtonGroup.react'),{className:'uiContextualLayerParent'},q,s);};o.__FBButtonMenuCombo__=true;o.propTypes={disabled:n.bool,numberOfButtons:n.number,onClick:n.func.isRequired,size:n.oneOf(['small','medium','large','xlarge','xxlarge']),tooltipPosition:n.oneOf(['above','below','left','right']),tooltipAlignH:n.oneOf(['left','right','center']),useImageOnlyButtons:n.bool};o.defaultProps={numberOfButtons:1,size:'medium'};o.Item=(l=k=function(){var p,q;p=babelHelpers.inherits(r,c('React').PureComponent);q=p&&p.prototype;r.prototype.render=function(){'use strict';return null;};function r(){'use strict';p.apply(this,arguments);}return r;}(),k.__FBButtonMenuComboItem__=true,k.propTypes={disabled:n.bool,image:n.element,label:n.string.isRequired,tooltip:n.string,value:n.string.isRequired},l);f.exports=o;}),null);
__d("XPayTermsAndPoliciesController",["XController"],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/pay\/payments\/terms_and_policies\/",{payment_type:{type:"String",required:true}});}),null);
__d('FBPaymentsLinkHelper_DEPRECATED',['URI','XPayTermsAndPoliciesController'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h='www.facebook.com',i='https',j={getPayTermsAndPoliciesURI:function k(l){var m=c('XPayTermsAndPoliciesController').getURIBuilder().setString('payment_type',l).getURI().setDomain(h).setProtocol(i);return m;}};f.exports=j;}),null);
__d('FBPaymentsAddressCountrySelectorFormField_DEPRECATED.react',['cx','fbt','ix','CreditCardCountries','Image.react','React','XUIError.react','XUISingleSelector.react','XUISingleSelectorButton.react','joinClasses'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l;if(c.__markCompiled)c.__markCompiled();var m=c('XUISingleSelector.react').Option,n=c('React').PropTypes,o='country_selector_label';k=babelHelpers.inherits(p,c('React').Component);l=k&&k.prototype;function p(){var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return q=(r=l.constructor).call.apply(r,[this].concat(t)),this.state={errorMessage:null,focused:false,value:this.props.value||o},this.$FBPaymentsAddressCountrySelectorFormField_DEPRECATED1=false,this.handleChange=function(v){var w=v.value;this.setState({value:w});this.triggerChange(w);}.bind(this),this.handleFocus=function(){this.setState({focused:true});this.$FBPaymentsAddressCountrySelectorFormField_DEPRECATED1=true;}.bind(this),this.handleBlur=function(){this.setState({focused:false});}.bind(this),this.triggerChange=function(v){var w=v!==o;if(!w&&this.props.required){this.setState({errorMessage:i._("\u8acb\u9078\u64c7\u570b\u5bb6\uff0f\u5730\u5340")});}else this.setState({errorMessage:null});this.props.onChange&&this.props.onChange(this.props.name,v,w,false);}.bind(this),this.shouldShowError=function(){return !!this.state.errorMessage&&this.$FBPaymentsAddressCountrySelectorFormField_DEPRECATED1&&!this.state.focused;}.bind(this),this.renderSelectorLabel=function(){return (c('React').createElement(m,{disabled:'true',value:o},i._("\u9078\u64c7\u570b\u5bb6\uff0f\u5730\u5340")));},this.renderSelectorOptions=function(){return Object.keys(c('CreditCardCountries')).map(function(v){var w=c('CreditCardCountries')[v];return (c('React').createElement(m,{key:v,value:v},w));});},this.renderCustomButton=function(){var v=this.props.width?{maxwidth:0}:{},w=this.shouldShowError()?c('React').createElement(c('Image.react'),{className:"_3-8s",src:j('/images/p2p/error-solid-red_s.png')}):null,x=c('React').createElement('span',{className:"_11qs"},w,c('React').createElement(c('Image.react'),{src:j('/images/ui/x/selector/chevron.png')}));return (c('React').createElement(c('XUISingleSelectorButton.react'),babelHelpers['extends']({className:"_11qt"+(' '+"_11qu"),haschevron:false,imageRight:x,onBlur:this.handleBlur,onFocus:this.handleFocus,size:this.props.size},v)));}.bind(this),q;}p.prototype.componentDidMount=function(){this.triggerChange(this.state.value);};p.prototype.render=function(){var q=void 0;if(this.props.width)q={width:this.props.width+'%'};var r=this.shouldShowError()?this.state.errorMessage:null;return (c('React').createElement('div',{className:"_11qv",style:q},c('React').createElement('div',{className:this.props.useGutter?"_11qw":''},c('React').createElement(c('XUIError.react'),{xuiError:r},c('React').createElement(c('XUISingleSelector.react'),{className:c('joinClasses')(this.props.className,!!this.props.width?"_11qx":''),customButton:this.renderCustomButton(),maxheight:240,name:this.props.name,onChange:this.handleChange,value:this.state.value},this.renderSelectorLabel(),this.renderSelectorOptions())))));};p.propTypes={name:n.string.isRequired,onChange:n.func,required:n.bool,size:n.oneOf(['large','xlarge']),useGutter:n.bool,value:n.string,width:n.number};p.defaultProps={required:false,size:'large'};f.exports=p;}),null);
__d('FBPaymentsAddressLabelFormField_DEPRECATED.react',['cx','fbt','React','XUISelector.react','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('XUISelector.react').Option,m=c('React').PropTypes,n=[i._("\u4f4f\u5bb6"),i._("\u516c\u53f8"),i._("\u5176\u4ed6")];j=babelHelpers.inherits(o,c('React').Component);k=j&&j.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=k.constructor).call.apply(q,[this].concat(s)),this.state={value:n[0].toString()},this.handleChange=function(u){var v=u.value;this.setState({value:v});this.triggerChange(v);}.bind(this),this.triggerChange=function(u){var v=this.props.onChange;if(typeof v==='function')v(this.props.name,u,true,false);}.bind(this),this.renderSelectorOptions=function(){return n.map(function(u,v){return (c('React').createElement(l,{key:v,value:u.toString()},u));});},p;}o.prototype.componentDidMount=function(){this.triggerChange(this.state.value);};o.prototype.render=function(){return (c('React').createElement(c('XUISelector.react'),{className:c('joinClasses')(this.props.className,"_e-n"),onChange:this.handleChange,name:this.props.name,value:this.state.value},this.renderSelectorOptions()));};o.propTypes={onChange:m.func,name:m.string.isRequired};f.exports=o;}),null);
__d('FBPaymentsAddressForm_DEPRECATED.react',['cx','fbt','FBPaymentsAddressCountrySelectorFormField_DEPRECATED.react','FBPaymentsAddressLabelFormField_DEPRECATED.react','FBPaymentsForm_DEPRECATED.react','FBPaymentsFormField_DEPRECATED.react','React','emptyFunction'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=k.constructor).call.apply(o,[this].concat(q)),this.state={formData:{},isValid:false},this.handleValidation=function(s,t){this.setState({formData:t,isValid:s});this.props.onValidation(s,t);}.bind(this),n;}m.prototype.render=function(){var n=!!(this.props.prefilledFormData&&this.props.prefilledFormData.care_of),o=this.props.showAddressLabelSelector?c('React').createElement(c('FBPaymentsAddressLabelFormField_DEPRECATED.react'),{className:"_3-96",name:'label',ignoreStyling:true,required:true}):null;return (c('React').createElement(c('FBPaymentsForm_DEPRECATED.react'),{errorTitle:i._("\u5132\u5b58\u5730\u5740\u6642\u767c\u751f\u554f\u984c"),prefilledFormData:this.props.prefilledFormData,onValidation:this.handleValidation,saveErrors:this.props.saveErrors,useGutters:true},o,c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{initiallyFocused:!n,name:'care_of',onChange:c('emptyFunction'),placeholder:i._("\u540d\u7a31"),required:true,width:100}),c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{initiallyFocused:n,name:'street1',onChange:c('emptyFunction'),placeholder:i._("\u8857\u9053\u5730\u5740"),required:true,width:100}),c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{name:'street2',onChange:c('emptyFunction'),placeholder:i._("\u8857\u9053\u5730\u5740\uff08\u7e8c\uff09\uff08\u9078\u586b\uff09"),width:100}),c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{name:'city',onChange:c('emptyFunction'),placeholder:i._("\u57ce\u5e02\uff0f\u5730\u5340"),required:true,width:50}),c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{name:'state',onChange:c('emptyFunction'),placeholder:i._("\u5dde\uff0f\u7701\uff0f\u5730\u5340"),required:true,width:50}),c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{name:'zip',onChange:c('emptyFunction'),placeholder:i._("\u90f5\u905e\u5340\u865f"),width:50}),c('React').createElement(c('FBPaymentsAddressCountrySelectorFormField_DEPRECATED.react'),{name:'country',onChange:c('emptyFunction'),required:true,size:'xlarge',width:50})));};m.propTypes={onValidation:l.func.isRequired,prefilledFormData:l.object,saveErrors:l.object,showAddressLabelSelector:l.bool};m.defaultProps={onValidation:c('emptyFunction'),prefilledFormData:{},saveErrors:null,showAddressLabelSelector:true};f.exports=m;}),null);
__d('FBPaymentsBankDetailsShape_DEPRECATED',['React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=h.shape({code:h.string.isRequired,image:h.string,name:h.string.isRequired});f.exports=i;}),null);
__d('FBPaymentsBankSelector_DEPRECATED.react',['cx','fbt','FBPaymentsBankDetailsShape_DEPRECATED','React','SearchableEntry','StaticSearchSource','XUITypeahead.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes,m='data:image/png;base64,';j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(o){k.constructor.call(this,o);this.handleChange=function(event){this.setState({query:event.target.value});}.bind(this);this.handleClear=function(){this.setState({query:''});this.props.onBankSelected(null);}.bind(this);this.handleSelectAttempt=function(q){this.setState({query:q.getTitle()});var r=this.props.banks.filter(function(s){return s.code===q.getUniqueID();})[0];this.props.onBankSelected(r);}.bind(this);this.state={query:''};var p=this.props.banks.map(function(q){return new (c('SearchableEntry'))({photo:m+q.image,title:q.name,uniqueID:q.code});});this.$FBPaymentsBankSelector_DEPRECATED1=new (c('StaticSearchSource'))(p);}n.prototype.render=function(){var o=this.props.maxAllEntries?this.props.banks.length:this.props.maxEntries,p=i._("\u641c\u5c0b\u4f60\u7684\u9280\u884c");return (c('React').createElement(c('XUITypeahead.react'),{className:"_f_b",clearable:true,maxEntries:o,onChange:this.handleChange,onClear:this.handleClear,onSelectAttempt:this.handleSelectAttempt,placeholder:p,queryString:this.state.query,searchSource:this.$FBPaymentsBankSelector_DEPRECATED1,showEntriesOnFocus:true,tallInput:true}));};n.propTypes={banks:l.arrayOf(c('FBPaymentsBankDetailsShape_DEPRECATED')).isRequired,maxAllEntries:l.bool,maxEntries:l.number,onBankSelected:l.func.isRequired,showAllEntries:l.bool};n.defaultProps={maxAllEntries:false,maxEntries:10};f.exports=n;}),null);
__d('FBPaymentsPaymentMethodShape_DEPRECATED',['FBPaymentsMethodType','React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=h.shape({title:h.string,type:h.oneOf(Object.values(c('FBPaymentsMethodType'))).isRequired});f.exports=i;}),null);
__d('FBPaymentsChoosePaymentMethodForm_DEPRECATED.react',['cx','fbt','FBAccordion.react','FBAccordionSection.react','FBPaymentsBankSelector_DEPRECATED.react','FBPaymentsCreditCardForm_DEPRECATED.react','FBPaymentsMethodType','FBPaymentsPaymentMethodShape_DEPRECATED','Link.react','P2PCreditCardDetails.react','P2PLinkConstants','P2PText.react','React','XUIRadioList.react','emptyFunction'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('XUIRadioList.react').Item,m=c('React').PropTypes;j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(o){k.constructor.call(this,o);this.handleBankSelected=function(p){this.props.onPaymentMethodConfigured({bank:p,isValid:!!p,type:c('FBPaymentsMethodType').NET_BANKING});}.bind(this);this.handleCreditCardFormValidation=function(p,q){this.props.onPaymentMethodConfigured({isValid:p,formData:q,type:c('FBPaymentsMethodType').NEW_CREDIT_CARD});}.bind(this);this.state={selectedKey:0};}n.prototype.componentWillMount=function(){var o=this.props.paymentMethods[this.state.selectedKey];this.props.onPaymentMethodSelected(o);};n.prototype.onSectionClick=function(o){this.setState({selectedKey:o});var p=this.props.paymentMethods[o];this.props.onPaymentMethodSelected(p);switch(p.type){case c('FBPaymentsMethodType').PAY_OVER_COUNTER:this.props.onPaymentMethodConfigured({isValid:true,type:p.type});break;case c('FBPaymentsMethodType').MANUAL_TRANSFER:var q=p.manual_transfer_info&&p.manual_transfer_info.id;this.props.onPaymentMethodConfigured({isValid:true,type:p.type,optionId:q});break;case c('FBPaymentsMethodType').GENERIC_CARD:this.props.onPaymentMethodConfigured({isValid:true,creditCard:p.creditCard,type:p.type});break;}};n.prototype.getSections=function(){return this.props.paymentMethods.map(this.renderPaymentMethodItem,this);};n.prototype.renderCreditCardFormSection=function(o){if(o!==this.state.selectedKey)return null;return (c('React').createElement('div',null,c('React').createElement(c('FBPaymentsCreditCardForm_DEPRECATED.react'),{onValidation:this.handleCreditCardFormValidation,saveErrors:this.props.saveErrors,showIcons:false,showSecondaryIcons:true,showZipCodeField:false,useGutters:true}),c('React').createElement(c('P2PText.react'),{className:"_3-8y",type:'secondary'},i._("\u4f60\u7684\u4ed8\u6b3e\u8cc7\u6599\u5df2\u5b89\u5168\u5132\u5b58\u3002{Link with text that goes to learn more page}",[i.param('Link with text that goes to learn more page',c('React').createElement(c('Link.react'),{href:c('P2PLinkConstants').securePayInfoLearnMoreURI,target:'_blank'},i._("\u77ad\u89e3\u8a73\u60c5")))]))));};n.prototype.renderBankSelectorSection=function(o){return (c('React').createElement(c('FBPaymentsBankSelector_DEPRECATED.react'),{banks:o.banks,onBankSelected:this.handleBankSelected}));};n.prototype.renderManualTransferSection=function(o){return (c('React').createElement(c('P2PText.react'),{type:'secondary'},i._("\u4f60\u5fc5\u9808\u76f4\u63a5\u532f\u6b3e\u5230\u8ce3\u5bb6\u63d0\u4f9b\u7684\u9280\u884c\u5e33\u865f\u3002")));};n.prototype.renderPaymentMethodItem=function(o,p){var q=null,r=null;switch(o.type){case c('FBPaymentsMethodType').GENERIC_CARD:q=c('React').createElement(c('P2PCreditCardDetails.react'),{creditCard:o.creditCard});break;case c('FBPaymentsMethodType').NEW_CREDIT_CARD:q=i._("\u4fe1\u7528\u5361\u6216\u91d1\u878d\u7c3d\u5e33\u5361");r=this.renderCreditCardFormSection(p);break;case c('FBPaymentsMethodType').NET_BANKING:q=i._("\u7db2\u8def\u9280\u884c");r=this.renderBankSelectorSection(o);break;case c('FBPaymentsMethodType').PAY_OVER_COUNTER:q=i._("\u5230\u5546\u5e97\u6ac3\u53f0\u4ed8\u6b3e");break;case c('FBPaymentsMethodType').MANUAL_TRANSFER:q=i._("\u5230 ATM \u6216\u9280\u884c\u8f49\u5e33");r=this.renderManualTransferSection(o);break;default:q=o.title?o.title:o.type;r=c('React').createElement(c('P2PText.react'),{type:'primary'},'Expanded content for ',q);break;}r=r?c('React').createElement('div',{className:"_51c-"},r):null;var s=c('React').createElement(l,{className:"_51c_",selectedValue:this.state.selectedKey,value:p},c('React').createElement(c('P2PText.react'),{type:'primary'},q));return (c('React').createElement(c('FBAccordionSection.react'),{header:s,key:p,onClick:this.onSectionClick.bind(this)},r));};n.prototype.render=function(){return (c('React').createElement('ul',{className:"_51d0"},c('React').createElement(c('FBAccordion.react'),null,this.getSections())));};n.propTypes={onPaymentMethodConfigured:m.func.isRequired,onPaymentMethodSelected:m.func.isRequired,paymentMethods:m.arrayOf(c('FBPaymentsPaymentMethodShape_DEPRECATED')).isRequired,saveErrors:m.object};n.defaultProps={onPaymentMethodConfigured:c('emptyFunction')};f.exports=n;}),null);
__d('FBPaymentsLegalDisclaimer_DEPRECATED.react',['fbt','FBPaymentsLinkHelper_DEPRECATED','FBPaymentsMethodType','Link.react','P2PText.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(m){j.constructor.call(this,m);}l.prototype.getLegalDisclaimerText=function(){var m=c('FBPaymentsLinkHelper_DEPRECATED').getPayTermsAndPoliciesURI(this.props.paymentType),n=h._("\u4e00\u65e6\u9ede\u64ca\u300c\u5b8c\u6210\u8cfc\u8cb7\u300d\uff0c\u5c31\u4ee3\u8868\u4f60\u540c\u610f Facebook \u7684{=terms and policies}",[h.param('=terms and policies',c('React').createElement(c('Link.react'),{href:m,target:'_blank'},'terms and policies'))]),o=h._("\u4e00\u65e6\u9ede\u64ca\u300c\u4ed8\u6b3e\u300d\uff0c\u5c31\u4ee3\u8868\u4f60\u540c\u610f Facebook \u548c 2C2P \u7684{=terms and policies}",[h.param('=terms and policies',c('React').createElement(c('Link.react'),{href:m,target:'_blank'},'terms and policies'))]),p=h._("\u4e00\u65e6\u9ede\u64ca\u300c\u767b\u5165\u4e26\u4ed8\u6b3e\u300d\uff0c\u5c31\u4ee3\u8868\u4f60\u540c\u610f Facebook \u548c 2C2P \u7684{=terms and policies}",[h.param('=terms and policies',c('React').createElement(c('Link.react'),{href:m,target:'_blank'},'terms and policies'))]),q=h._("\u4e00\u65e6\u9ede\u64ca\u300c\u7e7c\u7e8c\u4ed8\u6b3e\u300d\uff0c\u5c31\u4ee3\u8868\u4f60\u540c\u610f Facebook \u548c 2C2P \u7684{=terms and policies}",[h.param('=terms and policies',c('React').createElement(c('Link.react'),{href:m,target:'_blank'},'terms and policies'))]);switch(this.props.paymentMethodType){case c('FBPaymentsMethodType').GENERIC_CARD:return o;case c('FBPaymentsMethodType').NET_BANKING:return p;case c('FBPaymentsMethodType').PAY_OVER_COUNTER:return q;case c('FBPaymentsMethodType').MANUAL_TRANSFER:return n;default:return null;}};l.prototype.render=function(){return (c('React').createElement(c('P2PText.react'),{type:'secondary'},this.getLegalDisclaimerText()));};l.propTypes={paymentMethodType:k.string.isRequired,paymentType:k.string.isRequired};l.defaultProps={paymentType:''};f.exports=l;}),null);
__d('FBPaymentsCreditCardVerificationForm_DEPRECATED.react',['FBPaymentsCreditCardForm_DEPRECATED.react','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;k.prototype.render=function(){return (c('React').createElement(c('FBPaymentsCreditCardForm_DEPRECATED.react'),{cscMaxLength:this.props.cscMaxLength,onValidation:this.props.onValidation,prefilledFormData:this.props.prefilledFormData,saveErrors:this.props.saveErrors,showIcons:false,showZipCodeField:false,useGutters:this.props.useGutters,verifyCVVMode:true}));};function k(){h.apply(this,arguments);}k.propTypes={cscMaxLength:j.number,onValidation:j.func.isRequired,prefilledFormData:j.object.isRequired,saveErrors:j.object,useGutters:j.bool};k.defaultProps={cscMaxLength:null,saveErrors:null,useGutters:true};f.exports=k;}),null);
__d('FBPaymentsCreditCardVerificationDialog_DEPRECATED.react',['cx','fbt','CreditCardFormParam','FBPaymentsCreditCardVerificationForm_DEPRECATED.react','P2PButton.react','P2PCreditCard','P2PDialog.react','P2PDialogBody.react','P2PDialogFooter.react','P2PDialogTitle.react','P2PLoadingMask.react','P2PText.react','PaymentMethodUtils','React','emptyFunction'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=k.constructor).call.apply(o,[this].concat(q)),this.state={cscInput:null,isValid:false},this.handleValidation=function(s,t){this.setState({cscInput:t[c('CreditCardFormParam').CSC],isValid:s});}.bind(this),this.handleConfirmClick=function(){this.props.onConfirm(this.state.cscInput);}.bind(this),this.getMaxCSCLength=function(){var s=this.props.creditCard.getCardType();return c('PaymentMethodUtils').getCardTypeFromCode(s).cscDigits;}.bind(this),this.getMessage=function(){if(this.getMaxCSCLength()===3){return i._("\u8acb\u91cd\u65b0\u8f38\u5165\u4fe1\u7528\u5361\u7684\u4e09\u4f4d\u6578\u5b89\u5168\u9a57\u8b49\u78bc\u3002");}else return i._("\u8acb\u91cd\u65b0\u8f38\u5165\u4fe1\u7528\u5361\u7684\u56db\u4f4d\u6578\u5b89\u5168\u9a57\u8b49\u78bc\u3002");}.bind(this),this.renderFooter=function(){var s=i._("\u53d6\u6d88"),t=this.props.showCancelButton?c('React').createElement(c('P2PButton.react'),{label:s,onClick:this.props.onCancel,use:'default'}):null;return (c('React').createElement(c('P2PDialogFooter.react'),{className:"_3-8-",leftContent:this.props.leftContent},t,c('React').createElement(c('P2PButton.react'),{disabled:!this.state.isValid,label:this.props.primaryButtonText,onClick:this.handleConfirmClick,use:'confirm'})));}.bind(this),n;}m.prototype.render=function(){var n={};n[c('CreditCardFormParam').CARD_NUMBER]=this.props.creditCard.getCreditCardNumberMask();n[c('CreditCardFormParam').CARD_EXPIRATION]=this.props.creditCard.getExpFormattedShort();return (c('React').createElement(c('P2PDialog.react'),{layerHideOnBlur:false,repositionOnUpdate:true,shown:true},c('React').createElement(c('P2PDialogTitle.react'),null,i._("\u8f38\u5165\u5b89\u5168\u9a57\u8b49\u78bc")),c('React').createElement(c('P2PDialogBody.react'),null,c('React').createElement(c('FBPaymentsCreditCardVerificationForm_DEPRECATED.react'),{cscMaxLength:this.getMaxCSCLength(),onValidation:this.handleValidation,prefilledFormData:n}),c('React').createElement(c('P2PText.react'),{className:"_3-8y",type:'secondary'},this.getMessage())),this.renderFooter(),c('React').createElement(c('P2PLoadingMask.react'),{visible:this.props.loading})));};m.propTypes={creditCard:l.instanceOf(c('P2PCreditCard')).isRequired,leftContent:l.node,loading:l.bool,onCancel:l.func,onConfirm:l.func.isRequired,primaryButtonText:l.node,showCancelButton:l.bool};m.defaultProps={loading:false,onCancel:c('emptyFunction'),onConfirm:c('emptyFunction'),primaryButtonText:i._("\u78ba\u8a8d"),showCancelButton:true};f.exports=m;}),null);
__d('MNContentSubscriptionMessageUserEngagementTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(){this.clear();}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:MNContentSubscriptionMessageUserEngagementLoggerConfig',this.$MNContentSubscriptionMessageUserEngagementTypedLogger1,c('Banzai').BASIC);};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:MNContentSubscriptionMessageUserEngagementLoggerConfig',this.$MNContentSubscriptionMessageUserEngagementTypedLogger1,c('Banzai').VITAL);};h.prototype.clear=function(){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1={};return this;};h.prototype.updateData=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1=babelHelpers['extends']({},this.$MNContentSubscriptionMessageUserEngagementTypedLogger1,j);return this;};h.prototype.setAppID=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.appid=j;return this;};h.prototype.setAppversion=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.appversion=j;return this;};h.prototype.setClientUserID=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.client_userid=j;return this;};h.prototype.setClienttime=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.clienttime=j;return this;};h.prototype.setCommerceItemID=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.commerce_item_id=j;return this;};h.prototype.setCommerceMessageType=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.commerce_message_type=j;return this;};h.prototype.setCountry=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.country=j;return this;};h.prototype.setDeviceid=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.deviceid=j;return this;};h.prototype.setInterface=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1['interface']=j;return this;};h.prototype.setMessageID=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.message_id=j;return this;};h.prototype.setMessageTs=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.message_ts=j;return this;};h.prototype.setName=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.name=j;return this;};h.prototype.setPageID=function(j){this.$MNContentSubscriptionMessageUserEngagementTypedLogger1.page_id=j;return this;};var i={appid:true,appversion:true,client_userid:true,clienttime:true,commerce_item_id:true,commerce_message_type:true,country:true,deviceid:true,'interface':true,message_id:true,message_ts:true,name:true,page_id:true};f.exports=h;}),null);
__d('MNPlatformMessageUserEngagementTypedLogger',['Banzai','GeneratedLoggerUtils','nullthrows'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();function h(){this.clear();}h.prototype.log=function(){c('GeneratedLoggerUtils').log('logger:MNPlatformMessageUserEngagementLoggerConfig',this.$MNPlatformMessageUserEngagementTypedLogger1,c('Banzai').BASIC);};h.prototype.logVital=function(){c('GeneratedLoggerUtils').log('logger:MNPlatformMessageUserEngagementLoggerConfig',this.$MNPlatformMessageUserEngagementTypedLogger1,c('Banzai').VITAL);};h.prototype.clear=function(){this.$MNPlatformMessageUserEngagementTypedLogger1={};return this;};h.prototype.updateData=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1=babelHelpers['extends']({},this.$MNPlatformMessageUserEngagementTypedLogger1,j);return this;};h.prototype.setAppID=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.appid=j;return this;};h.prototype.setAppversion=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.appversion=j;return this;};h.prototype.setClientUserID=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.client_userid=j;return this;};h.prototype.setClienttime=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.clienttime=j;return this;};h.prototype.setCommerceItemID=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.commerce_item_id=j;return this;};h.prototype.setCommerceMessageType=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.commerce_message_type=j;return this;};h.prototype.setCountry=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.country=j;return this;};h.prototype.setDeviceid=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.deviceid=j;return this;};h.prototype.setInterface=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1['interface']=j;return this;};h.prototype.setMessageID=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.message_id=j;return this;};h.prototype.setMessageTs=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.message_ts=j;return this;};h.prototype.setName=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.name=j;return this;};h.prototype.setPageID=function(j){this.$MNPlatformMessageUserEngagementTypedLogger1.page_id=j;return this;};var i={appid:true,appversion:true,client_userid:true,clienttime:true,commerce_item_id:true,commerce_message_type:true,country:true,deviceid:true,'interface':true,message_id:true,message_ts:true,name:true,page_id:true};f.exports=h;}),null);
__d('MNCommerceOrderConfigActions',['MessengerDispatcher','MNCommerceActionTypes'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={itemLoaded:function i(j){c('MessengerDispatcher').dispatch({type:c('MNCommerceActionTypes').RETAIL_ITEM.LOADED,item:j});},itemLoadError:function i(j){c('MessengerDispatcher').dispatch({type:c('MNCommerceActionTypes').RETAIL_ITEM.LOAD_ERROR,itemID:j});},itemReload:function i(j){c('MessengerDispatcher').dispatch({type:c('MNCommerceActionTypes').RETAIL_ITEM.RELOAD,itemID:j});}};f.exports=h;}),null);
__d('MessengerAttachmentImageBlock.react',['cx','React','URI','isFacebookURI','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=j.constructor).call.apply(o,[this].concat(q)),this.$MessengerAttachmentImageBlock2=function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return null;var s=this.$MessengerAttachmentImageBlock3(),t=s.height,u=s.width,v=t>u,w=new (c('URI'))(this.props.attachment.uri),x=m(t,u)||c('isFacebookURI')(w)&&!w.isLinkshimURI(),y=t&&u?t/u*100:100,z=v||x?.2:1,aa=v||x?y:52,ba={backgroundImage:'url('+this.props.attachment.media.image+')',minHeight:'0px',paddingBottom:v&&y>150?'136px':aa*z+'%'};if(this.props.attachment.description&&this.props.attachment.source)ba.minHeight='112px';return (c('React').createElement('div',{className:"_3xn1",style:ba}));}.bind(this),this.$MessengerAttachmentImageBlock1=function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return "_3xn3 _5swn";var s=this.$MessengerAttachmentImageBlock3(),t=s.height,u=s.width,v=t>u,w=new (c('URI'))(this.props.attachment.uri),x=m(t,u)||c('isFacebookURI')(w)&&!w.isLinkshimURI();return "_3xn3"+(x&&!v?' '+"_3xn5":'')+(v?' '+"_3xn6":'')+(u>=t&&!x?' '+"_3xn7":'');}.bind(this),this.$MessengerAttachmentImageBlock3=function(){var s=this.props.attachment.properties||this.props.attachment.media.image_size||{},t=s.height,u=s.width;if(t&&u){t=parseInt(t,10);u=parseInt(u,10);return {height:t,width:u};}return {height:0,width:0};}.bind(this),n;}l.prototype.render=function(){return c('React').createElement('div',{className:c('joinClasses')(this.props.className,this.$MessengerAttachmentImageBlock1())},this.$MessengerAttachmentImageBlock2(),c('React').createElement('div',{className:"_5swm"},this.props.children));};l.propTypes={attachment:k.object.isRequired};function m(n,o){return n<=300&&o<=300;}f.exports=l;}),null);
__d('MNCommerceBubbleImage.react',['cx','React','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.render=function(){return (c('React').createElement('div',{className:c('joinClasses')("_4y9n",this.props.className),style:{backgroundImage:'url(\''+this.props.source+'\')'}}));};function l(){i.apply(this,arguments);}l.propTypes={location:k.string,source:k.string.isRequired,width:k.number};f.exports=l;}),null);
__d('MNCommerceAgentItemSuggestionMercuryAttachment.react',['ix','cx','fbt','Image.react','LeftRight.react','Link.react','LineClamp.react','MercuryShareAttachmentRenderLocations','MNCommerceAgenItemSuggestionReactShape','MNCommerceBubbleImage.react','React'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l;if(c.__markCompiled)c.__markCompiled();var m=c('React').PropTypes,n=3;k=babelHelpers.inherits(o,c('React').PureComponent);l=k&&k.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=l.constructor).call.apply(q,[this].concat(s)),this.$MNCommerceAgentItemSuggestionMercuryAttachment1=function(){var u=this.props.itemSuggestion.total_cost;if(!u||u.amount<=0)return null;var v=void 0;if(!this.props.isPurchased){v=c('React').createElement('div',{className:"_522s",onClick:this.$MNCommerceAgentItemSuggestionMercuryAttachment2},j._("\u53d6\u5f97"));}else v=c('React').createElement('div',{className:"_1x98"},c('React').createElement(c('Image.react'),{className:"_1x99",src:h('/images/messaging/commerce/paid_check.png')}),j._("\u5df2\u4ed8\u6b3e"));return (c('React').createElement(c('LeftRight.react'),{className:"_522r"},j._("\u7e3d\u8a08\uff1a{total cost}",[j.param('total cost',this.props.itemSuggestion.display_total_cost)]),v));}.bind(this),this.$MNCommerceAgentItemSuggestionMercuryAttachment2=function(u){u.preventDefault();this.props.onBuyClick&&this.props.onBuyClick();}.bind(this),p;}o.prototype.render=function(){var p=this.props.itemSuggestion,q=p.thumb_url?c('React').createElement('div',{className:"_522n"},c('React').createElement(c('MNCommerceBubbleImage.react'),{location:this.props.location,source:p.thumb_url,width:this.props.width})):null,r=null;if(p.desc)r=c('React').createElement(c('LineClamp.react'),{lines:n},p.desc);var s={};if(this.props.location===c('MercuryShareAttachmentRenderLocations').CHAT&&this.props.width)s.width=this.props.width;var t=c('React').createElement('div',{className:(!p.target_url?"_522-":'')+(this.props.location===c('MercuryShareAttachmentRenderLocations').WEB_INBOX?' '+"_1hf9":''),style:s},q,c('React').createElement('div',{className:"_522o"},c('React').createElement('div',{className:"_522p"},p.name),r,c('React').createElement('div',{className:"_522q"},p.merchant_name)),this.$MNCommerceAgentItemSuggestionMercuryAttachment1());if(p.target_url)return c('React').createElement(c('Link.react'),{className:"_522-",target:'_blank',href:{url:p.target_url,shimhash:p.shimhash}},t);return t;};o.propTypes={isPurchased:m.bool,itemSuggestion:c('MNCommerceAgenItemSuggestionReactShape').isRequired,location:m.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()),onBuyClick:m.func,width:m.number};f.exports=o;}),null);
__d('MercuryFallbackShareAttachmentTextBlock.react',['cx','LineClamp.react','MercuryShareAttachmentRenderLocations','MercuryShareAttachmentReactShape','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.render=function(){if(!this.props||!this.props.attachment)return c('React').createElement('div',{className:"__6j"});if(c('MercuryShareAttachmentRenderLocations').MESSENGER===this.props.location)return (c('React').createElement('div',{className:"__6j"},this.renderMessengerTitle(),this.renderMessengerDescription(),this.renderMessengerSource()));return (c('React').createElement('div',{className:"__6j"},this.renderTitle(),this.renderDescription(),this.renderSource()));};l.prototype.renderMessengerTitle=function(){if(!this.props.attachment.title)return null;return (c('React').createElement('div',{className:"__6k"},c('React').createElement(c('LineClamp.react'),{customEllipsis:" ",lines:2,lineHeight:18},this.props.attachment.title)));};l.prototype.renderMessengerDescription=function(){if(!this.props.attachment.description)return null;return (c('React').createElement('div',{className:"__6l"},c('React').createElement(c('LineClamp.react'),{customEllipsis:" ",lines:2,lineHeight:16},this.props.attachment.description)));};l.prototype.renderMessengerSource=function(){if(!this.props.attachment.source)return null;return (c('React').createElement('div',{className:"__6m"},this.props.attachment.source));};l.prototype.renderTitle=function(){if(!this.props.attachment.title)return null;return (c('React').createElement('div',{className:"__6k"+(!this.props.attachment.uri&&!this.props.attachment.description?' '+"_2xsq":'')},this.props.attachment.title));};l.prototype.renderDescription=function(){if(!this.props.attachment.description)return null;return (c('React').createElement('div',{className:"__6l"},this.props.attachment.description));};l.prototype.renderSource=function(){if(!this.props.attachment.source)return null;return (c('React').createElement('div',{className:"__6m"},this.props.attachment.source));};function l(){i.apply(this,arguments);}l.propTypes={attachment:c('MercuryShareAttachmentReactShape'),location:k.oneOf(c('MercuryShareAttachmentRenderLocations').getValues())};f.exports=l;}),null);
__d('MercuryShareImage.react',['cx','ChatImageArrowDirection','ChatImageWithArrow.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.render=function(){return (c('React').createElement('div',{className:"_4hsl"},c('React').createElement(c('ChatImageWithArrow.react'),{arrowDirection:c('ChatImageArrowDirection').BOTH,height:this.props.height,round:!!this.props.round,source:this.props.source,width:this.props.width})));};function l(){i.apply(this,arguments);}l.propTypes={height:k.number.isRequired,round:k.bool,source:k.string.isRequired,width:k.number.isRequired};f.exports=l;}),null);
__d('MercuryFallbackShareAttachmentContent.react',['cx','Image.react','ImageBlock.react','MercuryFallbackShareAttachmentTextBlock.react','MercuryShareAttachmentRenderLocations','MercuryShareAttachmentReactShape','MercuryShareImage.react','MessengerAttachmentImageBlock.react','React','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=72;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.prototype.renderTextBlock=function(){return (c('React').createElement(c('MercuryFallbackShareAttachmentTextBlock.react'),this.props));};m.prototype.renderChatImage=function(n){return (c('React').createElement(c('ImageBlock.react'),{className:n,spacing:'medium'},c('React').createElement(c('MercuryShareImage.react'),{height:l,source:this.props.attachment.media.image,width:l}),c('React').createElement('div',{style:{display:'flex',justifyContent:'center',flexDirection:'column',height:l}},this.renderTextBlock())));};m.prototype.renderMessengerImage=function(n){return (c('React').createElement(c('MessengerAttachmentImageBlock.react'),{className:n,attachment:this.props.attachment},this.renderTextBlock(),this.props.children));};m.prototype.renderDefaultImage=function(n){return (c('React').createElement(c('ImageBlock.react'),{className:c('joinClasses')(this.props.className,n)},c('React').createElement(c('Image.react'),{className:"__6n",src:this.props.attachment.media.image,width:l}),this.renderTextBlock(),this.props.children));};m.prototype.getCSSClasses=function(){var n=this.props.attachment,o=this.props.location;return (c('MercuryShareAttachmentRenderLocations').CHAT===o?"_49or":'')+(c('MercuryShareAttachmentRenderLocations').WEB_INBOX===o?' '+"__nm":'')+(c('MercuryShareAttachmentRenderLocations').CHAT_PREVIEW===o?' '+"_324d":'')+(c('MercuryShareAttachmentRenderLocations').CHAT!==o?' '+"_tih":'')+(!(n&&n.media.image)?' '+"_49ou":'')+(' '+"_310t");};m.prototype.render=function(){var n=this.props.attachment,o=this.props.location,p=this.getCSSClasses();if(n.media&&n.media.image){if(c('MercuryShareAttachmentRenderLocations').CHAT===o||c('MercuryShareAttachmentRenderLocations').CHAT_PREVIEW===o){return this.renderChatImage(p);}else if(c('MercuryShareAttachmentRenderLocations').MESSENGER===o)return this.renderMessengerImage(p);return this.renderDefaultImage(p);}return (c('React').createElement('div',{className:c('joinClasses')(this.props.className,p)},this.renderTextBlock(),this.props.children));};function m(){i.apply(this,arguments);}m.propType={attachment:c('MercuryShareAttachmentReactShape'),location:k.oneOf(c('MercuryShareAttachmentRenderLocations').getValues())};f.exports=m;}),null);
__d("XMessengerDotComSavedForLaterNuxSeenController",["XController"],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/save\/savemessagenux\/",{});}),null);
__d('MercuryFallbackShareAttachment.react',['cx','fbt','AsyncRequest','CollectionsDisplaySurface','CollectionCurationMechanisms','Link.react','MercuryFallbackShareAttachmentContent.react','MercuryShareAttachmentRenderLocations','MercuryShareAttachmentReactShape','MessengerAdsWebTypedLogger','MessengerDotComSaveModule','MNAdsLoggerEventEnum','React','ReactFragment','SaveMessageUtils','XMessengerDotComSavedForLaterNuxSeenController','XUIAmbientNUX.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes,m='focus',n='click',o='scroll',p=10000,q=30000;j=babelHelpers.inherits(r,c('React').Component);k=j&&j.prototype;function r(){k.constructor.call(this);this.state={showNux:false,nuxDisabled:false};}r.prototype.renderLink=function(s){if(c('MercuryShareAttachmentRenderLocations').isPreview(this.props.location)||!this.props.attachment.uri)return s;return (c('React').createElement(c('Link.react'),{className:"_5rw4",href:this.props.attachment.uri,onClick:this.$MercuryFallbackShareAttachment1.bind(this),target:'_blank'},s,this.renderLayers()));};r.prototype.render=function(){return this.renderLink(c('React').createElement(c('MercuryFallbackShareAttachmentContent.react'),babelHelpers['extends']({ref:'mercury_fallback_share_attachment'},this.props)));};r.prototype.$MercuryFallbackShareAttachment1=function(event){if(this.props.isSponsored){var s=this.props.attachment&&this.props.attachment.subattachments;if(!s)return;for(var t=s,u=Array.isArray(t),v=0,t=u?t:t[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var w;if(u){if(v>=t.length)break;w=t[v++];}else{v=t.next();if(v.done)break;w=v.value;}var x=w;new (c('MessengerAdsWebTypedLogger'))().setEvent(c('MNAdsLoggerEventEnum').LINK_CLICK).setIsSponsored(this.props.isSponsored).setItemID(x&&x.id).setMessageID(this.props.messageID).setPageID(this.props.pageID).log();}}if(this.state.nuxDisabled||!this.$MercuryFallbackShareAttachment2())return;this.$MercuryFallbackShareAttachment3();this.interactionTime=0;this.cancelMinConsumeTimeout=setTimeout(function(){if(!this.$MercuryFallbackShareAttachment4())this.setState({showNux:true,nuxDisabled:true});}.bind(this),p);this.cancelMaxConsumeTimeout=setTimeout(function(){if(!this.$MercuryFallbackShareAttachment4()){this.setState({showNux:false,nuxDisabled:false});this.clearTimeouts();}}.bind(this),q);var y=Date.now();this.cancelWindowInteractionTimeout=setTimeout(function(){this.$MercuryFallbackShareAttachment5(function(){if(!this.interactionTime)this.interactionTime=Date.now()-y;}.bind(this));}.bind(this),0);};r.prototype.clearTimeouts=function(){if(this.cancelWindowInteractionTimeout){clearTimeout(this.cancelWindowInteractionTimeout);this.cancelWindowInteractionTimeout=null;}if(this.cancelMaxConsumeTimeout){clearTimeout(this.cancelMaxConsumeTimeout);this.cancelMaxConsumeTimeout=null;}if(this.cancelMinConsumeTimeout){clearTimeout(this.cancelMinConsumeTimeout);this.cancelMinConsumeTimeout=null;}};r.prototype.onNUXCloseButtonClick=function(){this.setState({showNux:false});this.$MercuryFallbackShareAttachment6();this.$MercuryFallbackShareAttachment7();this.clearTimeouts();};r.prototype.renderLayers=function(){return this.$MercuryFallbackShareAttachment2()?c('ReactFragment').create(c('React').createElement(c('XUIAmbientNUX.react'),{contextRef:function(){return this.refs.mercury_fallback_share_attachment;}.bind(this),shown:this.state.showNux,onCloseButtonClick:this.onNUXCloseButtonClick.bind(this),position:'below',width:'custom',customwidth:300},i._("\u4f60\u73fe\u5728\u53ef\u4ee5\u5728\u8a0a\u606f\u4e0a\u9ede\u64ca\u53f3\u9375\uff0c\u5c07\u9023\u7d50\u548c\u5f71\u7247\u5132\u5b58\u5230 Facebook\u3002"))):null;};r.prototype.$MercuryFallbackShareAttachment3=function(){if(!this.$MercuryFallbackShareAttachment8){this.$MercuryFallbackShareAttachment9=[];this.$MercuryFallbackShareAttachment8=[Event.listen(window,'click',this.$MercuryFallbackShareAttachment10.bind(this,n)),Event.listen(window,'focus',this.$MercuryFallbackShareAttachment10.bind(this,m)),Event.listen(window,'scroll',this.$MercuryFallbackShareAttachment10.bind(this,o))];}};r.prototype.$MercuryFallbackShareAttachment10=function(s){this.$MercuryFallbackShareAttachment9.forEach(function(t){t.call(this,s);},this);};r.prototype.$MercuryFallbackShareAttachment5=function(s){this.$MercuryFallbackShareAttachment9.push(s);};r.prototype.$MercuryFallbackShareAttachment4=function(){return this.interactionTime&&this.interactionTime>0;};r.prototype.$MercuryFallbackShareAttachment7=function(){if(this.$MercuryFallbackShareAttachment8){while(this.$MercuryFallbackShareAttachment8.length)this.$MercuryFallbackShareAttachment8.pop().remove();this.$MercuryFallbackShareAttachment8=null;this.$MercuryFallbackShareAttachment9=null;}};r.prototype.$MercuryFallbackShareAttachment2=function(){return c('MessengerDotComSaveModule').eligible_for_nux&&this.$MercuryFallbackShareAttachment11();};r.prototype.$MercuryFallbackShareAttachment11=function(){var s=this.props.attachment;if(!s)return false;var t=s.style_list;return c('SaveMessageUtils').isSavableMessageAttachment(t);};r.prototype.$MercuryFallbackShareAttachment6=function(){new (c('AsyncRequest'))().setURI(c('XMessengerDotComSavedForLaterNuxSeenController').getURIBuilder().getURI()).setData({action:'impression',surface:c('CollectionsDisplaySurface').MESSENGER_DOT_COM_MESSAGE,mechanism:c('CollectionCurationMechanisms').SAVE_MESSAGE_NUX,object_id:this.props.message_id,collection_id:98}).send();};r.propTypes={attachment:c('MercuryShareAttachmentReactShape'),isSponsored:l.bool,location:l.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()),messageID:l.string,pageID:l.string};f.exports=r;}),null);
__d('P2PCreditCardForm.react',['CreditCardFormParam','FBPaymentsCreditCardForm_DEPRECATED.react','MessengerPaymentProductType','P2PAPIUtils','P2PAPI','React','getObjectValues'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes;h=babelHelpers.inherits(k,c('React').Component);i=h&&h.prototype;function k(){var l,m;for(var n=arguments.length,o=Array(n),p=0;p<n;p++)o[p]=arguments[p];return l=(m=i.constructor).call.apply(m,[this].concat(o)),this.state={binError:'',previousBINNumber:'',validateBINRequestID:''},this.handleValidateBINNumberSuccess=function(){this.setState({binError:''});}.bind(this),this.handleValidateBINNumberError=function(q){var r=q.message;this.setState({binError:r});}.bind(this),this.validateBIN=function(q){var r=void 0,s=void 0;q=q.replace(/ /g,'');r=q.substr(0,6);if(r!==this.state.previousBINNumber&&r.length>=6){s=c('P2PAPIUtils').genRequestID();this.setState({validateBINRequestID:s});c('P2PAPI').validateBINNumber({binNumber:r,requestID:s});}else if(r.length<6)this.setState({binError:'',validateBINRequestID:''});this.setState({previousBINNumber:r});}.bind(this),this.handleValidation=function(q,r){var s=r[c('CreditCardFormParam').CARD_NUMBER];if(!this.props.editMode&&this.props.productType===c('MessengerPaymentProductType').P2P&&s)this.validateBIN(s);this.props.onValidation(q,r);}.bind(this),l;}k.prototype.componentWillReceiveProps=function(l){var m=l.asyncRequestState,n=m?m[this.state.validateBINRequestID]:null;if(n){this.setState({validateBINRequestID:''});if(n.error){this.handleValidateBINNumberError(n.error);}else this.handleValidateBINNumberSuccess();}};k.prototype.render=function(){return (c('React').createElement(c('FBPaymentsCreditCardForm_DEPRECATED.react'),babelHelpers['extends']({},this.props,{allowCredit:this.props.productType===c('MessengerPaymentProductType').MESSENGER_COMMERCE,binError:this.state.binError,onValidation:this.handleValidation})));};k.propTypes={asyncRequestState:j.object,onValidation:j.func.isRequired,productType:j.oneOf(c('getObjectValues')(c('MessengerPaymentProductType')))};k.defaultProps={asyncRequestState:{},productType:c('MessengerPaymentProductType').P2P};f.exports=k;}),null);
__d('P2PAddCreditCardDialog.react',['cx','fbt','CurrentEnvironment','Link.react','MessengerPaymentProductType','P2PAPI','P2PAPIUtils','P2PCreditCardStore','P2PCreditCardForm.react','P2PLoadingMask.react','P2PLogger','P2PPaymentLoggerEvent','P2PLinkConstants','React','P2PButton.react','P2PDialog.react','P2PDialogTitle.react','P2PDialogBody.react','P2PDialogFooter.react','P2PText.react','emptyFunction','getObjectValues'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes,m='fbP2PAddCreditCardDialog_learnMoreSentenceID';j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return o=(p=k.constructor).call.apply(p,[this].concat(r)),this.state={isValid:false,formData:{},loading:false,requestID:'',saveErrors:null},this.onCreditCardStoreChange=function(){var t=c('P2PCreditCardStore').getAsyncRequestState(),u=t[this.state.requestID];this.setState({asyncRequestState:t});if(u){this.setState({requestID:''});if(u.error){this.handleOnSaveError(u.error);}else this.handleOnSaveSuccess(u);}}.bind(this),this.log=function(t,u){c('P2PLogger').log(t,babelHelpers['extends']({www_event_flow:this.props.eventFlow,object_id:this.props.loggingObjectID},this.props.loggingData,u));}.bind(this),this.onSaveClick=function(){var t=c('P2PAPIUtils').genRequestID();this.setState({loading:true,requestID:t,saveErrors:null});this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CONFIRM_CARD_DETAILS);c('P2PAPI').addCreditCard(babelHelpers['extends']({requestID:t,product_type:this.props.productType},this.state.formData));}.bind(this),this.handleOnSaveSuccess=function(t){this.props.onSuccess(t);this.log(c('P2PPaymentLoggerEvent').UI_ACTN_ADD_CARD_SUCCESS);}.bind(this),this.handleOnSaveError=function(t){this.setState({loading:false,saveErrors:t});this.log(c('P2PPaymentLoggerEvent').UI_ACTN_ADD_CARD_FAIL,{message:t&&t.general?t.general.message:''});}.bind(this),this.handleValidation=function(t,u){this.setState({isValid:t,formData:u});}.bind(this),this.isSaveButtonDisabled=function(){return this.state.loading||!this.state.isValid;}.bind(this),this.onToggle=function(t){if(!t){this.props.onCancel();this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CANCEL_ADD_CARD);}}.bind(this),this.onCancelClicked=function(){this.onToggle(false);}.bind(this),this.renderAddCardForm=function(){var t=void 0,u=this.props.title;if(this.props.showCancelButton)t=c('React').createElement(c('P2PButton.react'),{use:'default',size:'medium',label:this.props.cancelButtonText,disabled:this.state.loading,onClick:this.onCancelClicked});return (c('React').createElement('div',null,c('React').createElement(c('P2PDialogTitle.react'),null,u),c('React').createElement(c('P2PDialogBody.react'),null,c('React').createElement(c('P2PText.react'),{type:'primary',className:"_3-96"},this.props.text),c('React').createElement(c('P2PCreditCardForm.react'),{asyncRequestState:this.state.asyncRequestState,compactMode:true,onValidation:this.handleValidation,productType:this.props.productType,saveErrors:this.state.saveErrors,showIcons:false,showLabels:true,showPlaceholderOnFocus:true,showSecondaryIcons:true,useGutters:true}),c('React').createElement(c('P2PText.react'),{className:"_3-8y",id:m,type:'secondary'},i._("\u4f60\u7684\u4ed8\u6b3e\u8cc7\u6599\u5df2\u5b89\u5168\u5132\u5b58\u3002"),c('React').createElement('div',null,c('React').createElement(c('Link.react'),{'aria-describedby':m,href:c('P2PLinkConstants').addDebitCardHelpURI,target:'_blank'},i._("\u77ad\u89e3\u8a73\u60c5"))))),c('React').createElement(c('P2PDialogFooter.react'),{leftContent:this.props.leftContent},t,c('React').createElement(c('P2PButton.react'),{use:'confirm',size:'medium',label:this.props.saveButtonText,disabled:this.isSaveButtonDisabled(),onClick:this.onSaveClick}))));}.bind(this),o;}n.prototype.componentDidMount=function(){this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_ADD_CARD);this.creditCardStoreSub=c('P2PCreditCardStore').addListener('change',this.onCreditCardStoreChange);};n.prototype.componentWillUnmount=function(){if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null;}};n.prototype.render=function(){return (c('React').createElement(c('P2PDialog.react'),{behaviors:this.props.behaviors,layerHideOnBlur:false,ref:'dialog',onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:this.props.width},this.renderAddCardForm(),c('React').createElement(c('P2PLoadingMask.react'),{visible:this.state.loading})));};n.propTypes={cancelButtonText:l.string,eventFlow:l.string.isRequired,loggingData:l.object,loggingObjectID:l.string,onCancel:l.func,onSuccess:l.func,productType:l.oneOf(c('getObjectValues')(c('MessengerPaymentProductType'))),saveButtonText:l.string,showCancelButton:l.bool,text:l.string,title:l.string};n.defaultProps=function(){var o=void 0;if(c('CurrentEnvironment').messengerdotcom){o=480;}else o=430;return {cancelButtonText:i._("\u53d6\u6d88"),loggingData:{},onCancel:c('emptyFunction'),onSuccess:c('emptyFunction'),productType:c('MessengerPaymentProductType').P2P,saveButtonText:i._("\u5132\u5b58"),showCancelButton:true,text:i._("\u8acb\u8f38\u5165 Visa \u6216\u842c\u4e8b\u9054\u7c3d\u5e33\u91d1\u878d\u5361\u3002\u4e0d\u80fd\u4f7f\u7528\u4fe1\u7528\u5361\u3002"),title:i._("\u65b0\u589e\u7c3d\u5e33\u91d1\u878d\u5361"),width:o};}();f.exports=n;}),null);
__d('P2PChooseCreditCardDialog.react',['cx','fbt','CurrentEnvironment','P2PButton.react','P2PChooseCreditCardForm.react','P2PCreditCard','P2PDialog.react','P2PDialogBody.react','P2PDialogFooter.react','P2PDialogTitle.react','P2PLoadingMask.react','P2PText.react','React'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('CurrentEnvironment').messengerdotcom,m=c('React').PropTypes;j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return o=(p=k.constructor).call.apply(p,[this].concat(r)),this.state={loading:false,selectedCreditCard:this.props.selectedCreditCard},this.handleAddDebitCardOptionClicked=function(){this.props.onAddDebitCardOptionSelected();}.bind(this),this.handleCreditCardSelected=function(t){this.setState({selectedCreditCard:t});}.bind(this),this.handleSelected=function(){this.setState({loading:true});this.props.onSelected(this.state.selectedCreditCard);}.bind(this),this.handleToggle=function(t){if(!t)this.props.onClose();}.bind(this),o;}n.prototype.render=function(){var o=void 0;if(this.props.showCancelButton)o=c('React').createElement(c('P2PButton.react'),{disabled:this.props.showLoading,label:this.props.cancelButtonText,onClick:this.props.onClose,size:'medium',use:'default'});return (c('React').createElement(c('P2PDialog.react'),{behaviors:this.props.behaviors,className:l?"_auz":'',onToggle:this.handleToggle,width:this.props.width},c('React').createElement(c('P2PDialogTitle.react'),null,this.props.title),c('React').createElement(c('P2PDialogBody.react'),{className:"_383d"},c('React').createElement(c('P2PText.react'),{type:'primary',className:"_au_"},this.props.text),c('React').createElement(c('P2PChooseCreditCardForm.react'),{addCardOptionText:this.props.addCardOptionText,className:"_2pi4",creditCards:this.props.creditCards,onAddDebitCardOptionSelected:this.handleAddDebitCardOptionClicked,onChange:this.handleCreditCardSelected,selectedCard:this.props.selectedCreditCard,showAddDebitCardOption:true})),c('React').createElement(c('P2PDialogFooter.react'),null,o,c('React').createElement(c('P2PButton.react'),{disabled:this.props.showLoading,label:this.props.saveButtonText,onClick:this.handleSelected,size:'medium',use:'confirm'})),c('React').createElement(c('P2PLoadingMask.react'),{visible:this.props.showLoading})));};n.propTypes={addCardOptionText:m.string,cancelButtonText:m.string,creditCards:m.arrayOf(m.instanceOf(c('P2PCreditCard'))).isRequired,onAddDebitCardOptionSelected:m.func.isRequired,onClose:m.func.isRequired,onSelected:m.func.isRequired,saveButtonText:m.string.isRequired,selectedCreditCard:m.instanceOf(c('P2PCreditCard')).isRequired,showCancelButton:m.bool,showLoading:m.bool,text:m.string,title:m.string,width:m.number};n.defaultProps={cancelButtonText:i._("\u53d6\u6d88"),showCancelButton:false,text:i._("\u4f60\u53ef\u4ee5\u4f7f\u7528\u5df2\u65b0\u589e\u81f3 Facebook \u7684\u7c3d\u5e33\u91d1\u878d\u5361\uff0c\u4e5f\u53ef\u4ee5\u65b0\u589e\u5176\u4ed6\u5361\u7247\u3002"),title:i._("\u9078\u64c7\u7c3d\u5e33\u91d1\u878d\u5361")};f.exports=n;}),null);
__d('P2PEditCreditCardDialog.react',['cx','fbt','CreditCardFormParam','CurrentEnvironment','Link.react','React','P2PAPI','P2PAPIUtils','P2PCreditCard','P2PCreditCardForm.react','P2PLoadingMask.react','P2PLinkConstants','P2PDialog.react','P2PDialogTitle.react','P2PDialogBody.react','P2PDialogFooter.react','P2PButton.react','P2PText.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l='fbP2PEditCreditCardDialog_learnMoreSentenceID',m=c('React').PropTypes;j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return o=(p=k.constructor).call.apply(p,[this].concat(r)),this.state={formData:{},isValid:false,loading:false,requestID:'',saveErrors:null},this.clearSaveErrors=function(){this.setState({saveErrors:null});}.bind(this),this.onSaveClick=function(t){var u={},v=c('P2PAPIUtils').genRequestID();u[c('CreditCardFormParam').CREDENTIAL_ID]=this.props.creditCard.getCredentialId();this.clearSaveErrors();this.setState({loading:true,requestID:v});c('P2PAPI').updateCreditCard(babelHelpers['extends']({requestID:v},u,this.state.formData));}.bind(this),this.handleOnSaveSuccess=function(t){this.props.onSuccess(t);}.bind(this),this.onCancelClick=function(t){this.props.onCancel();}.bind(this),this.handleOnSaveError=function(t){this.setState({loading:false,saveErrors:t});}.bind(this),this.isSaveDisabled=function(){return !this.state.isValid||this.state.loading;}.bind(this),this.isCancelDisabled=function(){return this.state.loading;}.bind(this),this.handleValidation=function(t,u){this.setState({isValid:t,formData:u});}.bind(this),this.getPrefilledFormData=function(){var t={};t[c('CreditCardFormParam').CARD_NUMBER]=this.props.creditCard.getCreditCardNumberMask();t[c('CreditCardFormParam').CARD_EXPIRATION]=this.props.creditCard.getExpFormattedShort();t[c('CreditCardFormParam').ZIP]=this.props.creditCard.getZipCode();return t;}.bind(this),this.handleErrorDialogOKClick=function(){this.clearSaveErrors();}.bind(this),this.onToggle=function(t){if(!t)this.props.onCancel();}.bind(this),o;}n.prototype.componentWillReceiveProps=function(o){var p=o.asyncRequestState?o.asyncRequestState[this.state.requestID]:null;if(p){this.setState({requestID:''});if(p.error){this.handleOnSaveError(p.error);}else this.handleOnSaveSuccess(p);}};n.prototype.render=function(){var o=void 0,p=this.props.text;if(!p)p=i._("\u8acb\u66f4\u65b0\u5361\u7247\uff08\u672b\u4f4d\u6578\u70ba{card numbers}\uff09\u7684\u5230\u671f\u65e5\u3002",[i.param('card numbers',this.props.creditCard.getCreditCardNumber())]);if(this.props.showCancelButton)o=c('React').createElement(c('P2PButton.react'),{use:'default',size:'medium',label:i._("\u53d6\u6d88"),disabled:this.isCancelDisabled(),onClick:this.onCancelClick});return (c('React').createElement(c('P2PDialog.react'),{behaviors:this.props.behaviors,layerHideOnBlur:false,onToggle:this.onToggle,repositionOnUpdate:true,shown:true,width:this.props.width},c('React').createElement(c('P2PDialogTitle.react'),null,i._("\u66f4\u65b0\u7c3d\u5e33\u91d1\u878d\u5361")),c('React').createElement(c('P2PDialogBody.react'),null,c('React').createElement(c('P2PText.react'),{className:"_3-96",type:'primary'},p),c('React').createElement(c('P2PCreditCardForm.react'),{onValidation:this.handleValidation,saveErrors:this.state.saveErrors,editMode:true,prefilledFormData:this.getPrefilledFormData(),cscMaxLength:this.props.creditCard.getMaxCSCLength()}),c('React').createElement(c('P2PText.react'),{className:"_3-8y",id:l,type:'secondary'},i._("\u4f60\u7684\u4ed8\u6b3e\u8cc7\u6599\u5df2\u5b89\u5168\u5132\u5b58\u3002{Learn more about p2p link}",[i.param('Learn more about p2p link',c('React').createElement(c('Link.react'),{'aria-describedby':l,href:c('P2PLinkConstants').addDebitCardHelpURI,target:'_blank'},i._("\u66b8\u89e3\u8a73\u60c5\u3002")))]))),c('React').createElement(c('P2PDialogFooter.react'),null,o,c('React').createElement(c('P2PButton.react'),{use:'confirm',size:'medium',label:this.props.saveButtonText,disabled:this.isSaveDisabled(),onClick:this.onSaveClick})),c('React').createElement(c('P2PLoadingMask.react'),{visible:this.state.loading})));};n.propTypes={asyncRequestState:m.object.isRequired,creditCard:m.instanceOf(c('P2PCreditCard')).isRequired,onCancel:m.func.isRequired,onSuccess:m.func.isRequired,saveButtonText:m.string,showCancelButton:m.bool};n.defaultProps={saveButtonText:i._("\u5132\u5b58"),showCancelButton:true,width:c('CurrentEnvironment').messengerdotcom?350:300};f.exports=n;}),null);
__d('P2PMoneypennyCheckoutDialog.react',['cx','fbt','ix','CurrentEnvironment','Link.react','MNCommerceAgenItemSuggestionReactShape','P2PBigAmount.react','P2PButton.react','P2PCreditCard','P2PDialog.react','P2PDialogBody.react','P2PDialogFooter.react','P2PDialogTitle.react','P2PLoadingMask.react','P2PMoneypennyProductItemDetails.react','P2PText.react','React'],(function a(b,c,d,e,f,g,h,i,j){'use strict';var k,l;if(c.__markCompiled)c.__markCompiled();var m=c('React').PropTypes;k=babelHelpers.inherits(n,c('React').PureComponent);l=k&&k.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return o=(p=l.constructor).call.apply(p,[this].concat(r)),this.handleToggle=function(t){if(!t)this.props.onClose();}.bind(this),this.renderPaymentDetails=function(){var t=this.props.selectedCreditCard;if(!t)return null;return (c('React').createElement(c('P2PText.react'),{className:"_1t0k",shade:'light',size:'small',type:'secondary'},t.getDetailsFormatted()+' \u00b7 ',c('React').createElement(c('Link.react'),{className:"_1t0l",onClick:this.props.onChangeCreditCard,href:'#'},i._("\u8b8a\u66f4"))));}.bind(this),this.renderFooter=function(){var t=void 0,u=void 0,v=void 0;if(!this.props.selectedCreditCard){t=c('React').createElement(c('P2PText.react'),{className:"_1t0n",type:'secondary'},this.props.leftContentText);u=c('React').createElement(c('P2PButton.react'),{label:i._("\u4e0b\u4e00\u6b65"),onClick:this.props.onNextClicked,size:'medium',type:'primary',use:'default'});}else u=c('React').createElement(c('P2PButton.react'),{label:i._("\u4ed8\u6b3e"),onClick:this.props.onPurchaseClicked,size:'medium',type:'primary',use:'confirm'});if(this.props.showCancelButton)v=c('React').createElement(c('P2PButton.react'),{use:'default',size:'medium',label:this.props.cancelButtonText,disabled:this.props.showLoading,onClick:this.props.onClose});return (c('React').createElement(c('P2PDialogFooter.react'),{leftContent:t},v,u));}.bind(this),this.renderAmountSection=function(){return (c('React').createElement('div',{className:"_1t0o"},c('React').createElement('div',{className:"_4qbr"},c('React').createElement(c('P2PBigAmount.react'),{amount:this.props.item.raw_amount,size:'large'})),this.renderPaymentDetails(),c('React').createElement(c('P2PText.react'),{className:"_1wb1",shade:'light',size:'small',type:'secondary'},'We',"'",'ll place your order with the business when we receive your payment.')));}.bind(this),o;}n.prototype.render=function(){var o=void 0;if(!c('CurrentEnvironment').messengerdotcom)o=c('React').createElement(c('P2PDialogTitle.react'),null,i._("\u652f\u4ed8\u6b3e\u9805"));return (c('React').createElement(c('P2PDialog.react'),{layerHideOnBlur:false,onToggle:this.handleToggle,shown:true,width:this.props.width},o,c('React').createElement(c('P2PDialogBody.react'),null,c('React').createElement('div',{className:"_b0z"},c('React').createElement(c('P2PMoneypennyProductItemDetails.react'),{item:this.props.item})),this.renderAmountSection()),this.renderFooter(),c('React').createElement(c('P2PLoadingMask.react'),{visible:this.props.showLoading})));};n.propTypes={cancelButtonText:m.string,item:c('MNCommerceAgenItemSuggestionReactShape').isRequired,leftContentText:m.string,onClose:m.func.isRequired,onChangeCreditCard:m.func.isRequired,onNextClicked:m.func.isRequired,onPurchaseClicked:m.func.isRequired,selectedCreditCard:m.instanceOf(c('P2PCreditCard')),showCancelButton:m.bool,showLoading:m.bool};n.defaultProps={cancelButtonText:i._("\u53d6\u6d88"),leftContentText:i._("\u4e0b\u4e00\u6b65\u662f\u65b0\u589e\u7c3d\u5e33\u91d1\u878d\u5361\u3002"),showCancelButton:false,width:360};f.exports=n;}),null);
__d('P2PMoneypennyStore',['P2PActionConstants','EventEmitter','ImmutableObject','P2PDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=void 0,k=void 0,l=void 0;function m(p,q){if(p)l[p]=new (c('ImmutableObject'))(q);}function n(p,q){if(p)l[p]={error:q};}h=babelHelpers.inherits(o,c('EventEmitter'));i=h&&h.prototype;function o(){i.constructor.call(this);l={};k=[];j=c('P2PDispatcher').register(this.onEventDispatched.bind(this));}o.prototype.onEventDispatched=function(p){var q=p.data,r=p.type;switch(r){case c('P2PActionConstants').MONEYPENNY_TRANSFER_CREATED:this.handleMoneypennyTransferCreated(q);this.emit('change');break;case c('P2PActionConstants').MONEYPENNY_TRANSFER_CREATED_ERROR:this.handleMoneypennyTransferCreatedError(q);this.emit('change');break;}};o.prototype.getAsyncRequestState=function(){return l;};o.prototype.handleMoneypennyTransferCreated=function(p){var q=void 0;m(p.requestID,p);q=k.filter(function(r){return (r.payment_id===p.payment_id);})[0];if(!q)k.push(new (c('ImmutableObject'))(p));};o.prototype.handleMoneypennyTransferCreatedError=function(p){n(p.requestID,p.error);};o.prototype.getTransferByID=function(p){return k.filter(function(q){return q.item_id===p;})[0];};f.exports=new o();}),null);
__d('P2PPasswordProtectionNUXDialog.react',['cx','fbt','CurrentEnvironment','Link.react','P2PAPI','P2PErrorDialog.react','P2PLinkConstants','P2PLoadingMask.react','P2PLogger','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','P2PPasswordProtectionParam','P2PPasswordProtectionStatusTypes','React','P2PButton.react','P2PDialog.react','P2PDialogTitle.react','P2PDialogBody.react','P2PDialogFooter.react','P2PText.react','emptyFunction'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=k.constructor).call.apply(o,[this].concat(q)),this.state={saveErrorObject:null,loading:false},this.log=function(s,t){c('P2PLogger').log(s,babelHelpers['extends']({www_event_flow:c('P2PPaymentLoggerEventFlow').UI_FLOW_P2P_SETTINGS},t));},this.onSaveClick=function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(c('P2PPasswordProtectionStatusTypes').ENABLED);this.log(c('P2PPaymentLoggerEvent').UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX);}.bind(this),this.setPasswordProtection=function(s){var t={};t[c('P2PPasswordProtectionParam').STATUS]=s;c('P2PAPI').setPasswordProtectionSetting({formData:t,success:this.handleOnSaveSuccess,error:this.handleOnSaveError});}.bind(this),this.handleOnSaveSuccess=function(){this.setState({loading:false});this.props.onComplete();}.bind(this),this.handleOnSaveError=function(s){this.setState({loading:false,saveErrorObject:s});}.bind(this),this.isSaveButtonDisabled=function(){return this.state.loading;}.bind(this),this.isCancelButtonDisabled=function(){return this.state.loading;}.bind(this),this.onCancelClick=function(){this.setState({loading:true,saveErrorObject:null});this.setPasswordProtection(c('P2PPasswordProtectionStatusTypes').DISABLED);this.log(c('P2PPaymentLoggerEvent').UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX);}.bind(this),this.handleErrorBackClick=function(){this.setState({saveErrorObject:null});}.bind(this),this.handleErrorOKClick=function(){this.setState({saveErrorObject:null});this.props.onComplete();}.bind(this),n;}m.prototype.componentWillMount=function(){this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX);};m.prototype.render=function(){if(this.state.saveErrorObject)return (c('React').createElement(c('P2PErrorDialog.react'),{allowBack:true,title:i._("\u5132\u5b58\u6642\u767c\u751f\u932f\u8aa4"),onBackClick:this.handleErrorBackClick,onOKClick:this.handleErrorOKClick,error:this.state.saveErrorObject}));return (c('React').createElement(c('P2PDialog.react'),{className:c('CurrentEnvironment').messengerdotcom?"_-el":'',behaviors:{LayerFadeOnShow:false},layerHideOnBlur:false,shown:true,width:this.props.width},c('React').createElement(c('P2PDialogTitle.react'),{showCloseButton:false},i._("\u4f7f\u7528\u5bc6\u78bc\uff1f")),c('React').createElement(c('P2PDialogBody.react'),null,c('React').createElement(c('P2PText.react'),{className:"_5sor",type:'primary'},i._("\u70ba\u4e86\u52a0\u5f37\u5b89\u5168\uff0c\u4f60\u53ef\u4ee5\u8f38\u5165 Facebook \u5bc6\u78bc\u4ee5\u9032\u884c\u4ed8\u6b3e\u3002\u4f60\u96a8\u6642\u90fd\u53ef\u4ee5\u5230{link}\u66f4\u65b0\u6b64\u8a2d\u5b9a\u3002",[i.param('link',c('React').createElement(c('Link.react'),{href:c('P2PLinkConstants').settingsWWWURI,target:'_blank'},i._("\u8a2d\u5b9a")))]))),c('React').createElement(c('P2PDialogFooter.react'),null,c('React').createElement(c('P2PButton.react'),{className:"_5sov",disabled:this.isCancelButtonDisabled(),label:i._("\u7a0d\u5f8c\u518d\u8aaa"),onClick:this.onCancelClick,size:'medium',use:'default'}),c('React').createElement(c('P2PButton.react'),{className:"_5sox",disabled:this.isSaveButtonDisabled(),label:i._("\u4f7f\u7528\u5bc6\u78bc"),onClick:this.onSaveClick,size:'medium',use:'confirm'})),c('React').createElement(c('P2PLoadingMask.react'),{visible:this.state.loading})));};m.propTypes={onComplete:l.func};m.defaultProps={onComplete:c('emptyFunction'),width:c('CurrentEnvironment').messengerdotcom?320:300};f.exports=m;}),null);
__d('P2PMoneypennyCheckoutDialogContainer.react',['cx','fbt','Arbiter','CreditCardFormParam','CurrentEnvironment','MessengerPaymentProductType','MNCommerceAgenItemSuggestionReactShape','P2PAPI','P2PAPIUtils','P2PAddCreditCardDialog.react','P2PChooseCreditCardDialog.react','P2PCreditCardStore','P2PEditCreditCardDialog.react','P2PErrorDialog.react','P2PGKValues','P2PLogger','P2PMoneypennyCheckoutDialog.react','P2PMoneypennyStore','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','P2PPasswordProtectionNUXDialog.react','P2PPasswordProtectionStatusTypes','P2PSuccessDialog.react','P2PText.react','P2PVerifyCreditCardDialog.react','React','setImmediate'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=i._("\u4ed8\u6b3e"),m={LayerFadeOnShow:false},n=360,o=c('P2PPaymentLoggerEventFlow').UI_FLOW_MONEYPENNY_CHECKOUT,p=c('React').PropTypes;j=babelHelpers.inherits(q,c('React').Component);k=j&&j.prototype;function q(s,t){k.constructor.call(this,s,t);r.call(this);var u=this.getCards();this.state={addCreditCardDialogShown:false,editCreditCardDialogShown:false,creditCards:u,creditCardAsyncRequestState:c('P2PCreditCardStore').getAsyncRequestState(),chooseCreditCardDialogShown:false,loading:false,moneypennyAsyncRequestState:c('P2PMoneypennyStore').getAsyncRequestState(),p2pPasswordProtectionNUXDialogShown:false,transferErrors:null,transferRequestID:'',selectedCreditCard:u[0],successDialogPending:false,successDialogShown:false,verifyCreditCardDialogShown:false};}q.prototype.componentWillMount=function(){this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_MONEYPENNY_ORDER,{});this.creditCardStoreSub=c('P2PCreditCardStore').addListener('change',this.onCreditCardStoreChange);this.moneypennyTransferStoreSub=c('P2PMoneypennyStore').addListener('change',this.onMoneypennyStoreChange);};q.prototype.componentWillUnmount=function(){if(this.creditCardStoreSub){this.creditCardStoreSub.remove();this.creditCardStoreSub=null;}if(this.moneypennyTransferStoreSub){this.moneypennyTransferStoreSub.remove();this.moneypennyTransferStoreSub=null;}if(this.passwordCancelSubscribeToken!==null){c('Arbiter').unsubscribe(this.passwordCancelSubscribeToken);this.passwordCancelSubscribeToken=null;}};q.prototype.render=function(){var s=this.props.item,t=c('CurrentEnvironment').messengerdotcom,u=void 0,v=void 0,w=void 0,x=void 0,y=void 0,z=void 0;if(this.getProductType()===c('MessengerPaymentProductType').MESSENGER_COMMERCE){u=i._("\u8acb\u8f38\u5165\u7c3d\u5e33\u91d1\u878d\u5361\u6216\u4fe1\u7528\u5361\u4ee5\u8cfc\u8cb7{Product name}\u3002",[i.param('Product name',s.name)]);v=i._("\u65b0\u589e\u5361\u7247");x=i._("\u9078\u64c7\u5361\u7247");w=i._("\u4f60\u53ef\u4ee5\u4f7f\u7528\u5df2\u65b0\u589e\u5230 Facebook \u7684\u5361\u7247\uff0c\u4e5f\u53ef\u4ee5\u65b0\u589e\u5361\u7247\u4ee5\u8cfc\u8cb7{Product name}\u3002",[i.param('Product name',this.props.item.name)]);y=i._("\u65b0\u589e\u5361\u7247");z=i._("\u63a5\u4e0b\u4f86\uff0c\u4f60\u5fc5\u9808\u65b0\u589e\u5361\u7247\u3002");}else{u=i._("\u8acb\u8f38\u5165\u7c3d\u5e33\u91d1\u878d\u5361\u4ee5\u8cfc\u8cb7{Product name}\u3002\u6211\u5011\u5c1a\u7121\u6cd5\u63a5\u53d7\u4fe1\u7528\u5361\u3002",[i.param('Product name',s.name)]);w=i._("\u4f60\u53ef\u4ee5\u4f7f\u7528\u5df2\u65b0\u589e\u5230 Facebook \u7684\u7c3d\u5e33\u91d1\u878d\u5361\uff0c\u6216\u662f\u65b0\u589e\u7c3d\u5e33\u91d1\u878d\u5361\u4ee5\u8cfc\u8cb7{Product name}\u3002",[i.param('Product name',this.props.item.name)]);}if(this.state.p2pPasswordProtectionNUXDialogShown){return (c('React').createElement(c('P2PPasswordProtectionNUXDialog.react'),{onComplete:this.props.onClose,width:n}));}else if(this.state.transferErrors){return (c('React').createElement(c('P2PErrorDialog.react'),{behaviors:m,error:this.state.transferErrors,onOKClick:this.handleCheckoutCancel,title:i._("\u4ed8\u6b3e\u767c\u751f\u554f\u984c"),width:n}));}else if(this.state.verifyCreditCardDialogShown){return (c('React').createElement(c('P2PVerifyCreditCardDialog.react'),{asyncRequestState:this.state.creditCardAsyncRequestState,behaviors:m,creditCard:this.state.selectedCreditCard,isPurchasing:true,purchaseName:this.props.item.name,onCancel:this.handleCheckoutCancel,onSuccess:this.purchase,saveButtonText:l,showCancelButton:t,width:n}));}else if(this.state.editCreditCardDialogShown){return (c('React').createElement(c('P2PEditCreditCardDialog.react'),{asyncRequestState:this.state.creditCardAsyncRequestState,behaviors:m,creditCard:this.state.selectedCreditCard,onCancel:this.handleCheckoutCancel,onSuccess:this.purchase,saveButtonText:l,showCancelButton:t,text:i._("\u8acb\u66f4\u65b0\u5361\u7247\uff08\u672b\u4f4d\u6578\u70ba{card numbers}\uff09\u7684\u5230\u671f\u65e5\u4ee5\u8cfc\u8cb7{Product name}\u3002",[i.param('card numbers',this.state.selectedCreditCard.getCreditCardNumber()),i.param('Product name',this.props.item.name)]),width:n}));}else if(this.state.successDialogShown){return (c('React').createElement(c('P2PSuccessDialog.react'),{behaviors:babelHelpers['extends']({LayerSlowlyFadeOnShow:false},m),onOKClick:this.handleCheckoutSuccess,title:i._("\u5df2\u4ed8\u6b3e"),width:n},c('React').createElement(c('P2PText.react'),{className:"_3-97",type:'primary'},i._("\u6211\u5011\u5df2\u6536\u5230\u4f60\u7684\u4ed8\u6b3e\uff0c\u6b63\u5728\u5411\u5546\u5bb6\u4e0b\u8a02\u55ae\u3002")),c('React').createElement(c('P2PText.react'),{type:'primary'},i._("{Bold text that says, Tip:}\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528{Credit card name and number}\u4ed8\u6b3e\u7d66\u5c0d\u8a71\u4e2d\u7684\u670b\u53cb\u3002",[i.param('Bold text that says, Tip:',c('React').createElement(c('P2PText.react'),{display:'inline',type:'primary',weight:'bold'},i._("\u63d0\u793a\uff1a"))),i.param('Credit card name and number',this.state.selectedCreditCard.getDetailsFormatted())]))));}else if(this.state.chooseCreditCardDialogShown){return (c('React').createElement(c('P2PChooseCreditCardDialog.react'),{addCardOptionText:y,behaviors:m,creditCards:this.state.creditCards,onAddDebitCardOptionSelected:this.handleAddDebitCardClicked,onClose:this.handleCheckoutCancel,onSelected:this.handleCreditCardSelected,saveButtonText:l,selectedCreditCard:this.state.selectedCreditCard,showCancelButton:t,showLoading:this.state.loading,text:w,title:x,width:n}));}else if(this.state.addCreditCardDialogShown){return (c('React').createElement(c('P2PAddCreditCardDialog.react'),{behaviors:m,eventFlow:o,loggingData:{amount:s.raw_amount,object_id:s.id},onCancel:this.handleCheckoutCancel,onSuccess:this.handleAddCreditCardSuccess,productType:this.getProductType(),saveButtonText:l,showCancelButton:t,text:u,title:v,width:n}));}else return (c('React').createElement(c('P2PMoneypennyCheckoutDialog.react'),{item:this.props.item,leftContentText:z,onChangeCreditCard:this.handleChangeCreditCardClicked,onClose:this.handleCheckoutCancel,onNextClicked:this.handleAddDebitCardClicked,onPurchaseClicked:this.purchase,selectedCreditCard:this.state.selectedCreditCard,showCancelButton:t,showLoading:this.state.loading,width:n}));};q.propTypes={item:c('MNCommerceAgenItemSuggestionReactShape').isRequired,onClose:p.func.isRequired};var r=function s(){this.creditCardStoreSub=null;this.moneypennyTransferStoreSub=null;this.passwordCancelSubscribeToken=null;this.passwordNUXPending=false;this.successDialogPending=false;this.getProductType=function(){return c('MessengerPaymentProductType').MESSENGER_COMMERCE;};this.getCards=function(){return c('P2PCreditCardStore').getAll(this.getProductType());}.bind(this);this.log=function(t,u){c('P2PLogger').log(t,babelHelpers['extends']({raw_amount:this.props.item.raw_amount,currency:this.props.item.total_cost.currency,object_id:this.props.item.id,www_event_flow:o},u));}.bind(this);this.onCreditCardStoreChange=function(){var t=this.getCards(),u=void 0;if(this.state.selectedCreditCard)u=c('P2PCreditCardStore').getCreditCardByCredentialID(this.state.selectedCreditCard.getCredentialId());if(!u)u=t[0];this.setState({creditCards:t,creditCardAsyncRequestState:c('P2PCreditCardStore').getAsyncRequestState(),selectedCreditCard:u});}.bind(this);this.onMoneypennyStoreChange=function(){var t=c('P2PMoneypennyStore').getAsyncRequestState(),u=t[this.state.transferRequestID];this.setState({moneypennyAsyncRequestState:t});if(u){this.setState({transferRequestID:''});if(u.error){this.handleMoneypennyTransferError(u.error);}else this.handleMoneypennyTransferSuccess(u);}}.bind(this);this.handleChangeCreditCardClicked=function(){this.hideAllDialogs();if(this.state.creditCards.length>1){this.setState({chooseCreditCardDialogShown:true});this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_CHOOSE_CARD,{});}else this.setState({addCreditCardDialogShown:true});}.bind(this);this.handleAddDebitCardClicked=function(){this.hideAllDialogs();this.setState({addCreditCardDialogShown:true});}.bind(this);this.handleCreditCardSelected=function(t){this.setState({selectedCreditCard:t},function(){this.purchase();}.bind(this));}.bind(this);this.purchase=function(){var t=void 0;if(!this.state.selectedCreditCard.getIsVerified()){this.log(c('P2PPaymentLoggerEvent').UI_ACTN_VERIFY_CSC,{});this.hideAllDialogs();this.setState({verifyCreditCardDialogShown:true});return;}else if(this.state.selectedCreditCard.isExpired()){this.log(c('P2PPaymentLoggerEvent').UI_ACTN_EDIT_CARD,{});this.hideAllDialogs();this.setState({editCreditCardDialogShown:true});return;}this.passwordCancelSubscribeToken=c('Arbiter').subscribeOnce('PasswordReauthDialogCancelClick',this.handlePasswordReauthDialogCancelClick);t=c('P2PAPIUtils').genRequestID();this.setState({loading:true,transferRequestID:t,transferErrors:null});c('P2PAPI').createMoneypennyTransfer({amount:this.props.item.raw_amount,credential_id:this.state.selectedCreditCard.getCredentialId(),item_id:this.props.item.id,external_request_id:c('P2PAPIUtils').genRequestID(),requestID:t});this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CONFIRM_MONEYPENNY_ORDER,{});}.bind(this);this.handleMoneypennyTransferSuccess=function(t){this.hideAllDialogs();this.log(c('P2PPaymentLoggerEvent').UI_ACTN_MONEYPENNY_ORDER_SUCCESS,{});if(t.passwordProtection===c('P2PPasswordProtectionStatusTypes').NOT_SET)this.passwordNUXPending=true;if(this.successDialogPending){this.successDialogPending=false;this.setState({successDialogShown:true});}else this.handleCheckoutSuccess();}.bind(this);this.handleMoneypennyTransferError=function(t){this.hideAllDialogs();this.log(c('P2PPaymentLoggerEvent').UI_ACTN_MONEYPENNY_ORDER_FAIL,{});this.setState({loading:false,transferErrors:t});}.bind(this);this.handlePasswordReauthDialogCancelClick=function(){this.passwordCancelSubscribeToken=null;this.setState({loading:false});this.hideAllDialogs();}.bind(this);this.handleCheckoutSuccess=function(){this.hideAllDialogs();if(this.passwordNUXPending){this.passwordNUXPending=false;this.setState({p2pPasswordProtectionNUXDialogShown:true});}else c('setImmediate')(this.props.onClose);}.bind(this);this.handleAddCreditCardSuccess=function(t){this.successDialogPending=this.getCards().length===1;this.setState({selectedCreditCard:c('P2PCreditCardStore').getCreditCardByCredentialID(t[c('CreditCardFormParam').CREDENTIAL_ID])},function(){this.purchase();}.bind(this));}.bind(this);this.handleCheckoutCancel=function(){this.log(c('P2PPaymentLoggerEvent').UI_ACTN_MONEYPENNY_ORDER_CANCEL,{});this.props.onClose();}.bind(this);this.hideAllDialogs=function(){this.setState({addCreditCardDialogShown:false,editCreditCardDialogShown:false,chooseCreditCardDialogShown:false,successDialogShown:false,transferErrors:null,verifyCreditCardDialogShown:false,p2pPasswordProtectionNUXDialogShown:false});}.bind(this);};f.exports=q;}),null);
__d('MNCommerceAgentItemSuggestionMercuryShareAttachment.react',['MercuryFallbackShareAttachment.react','MercuryShareAttachmentReactShape','MercuryShareAttachmentRenderLocations','MNCommerceAgentItemSuggestionMercuryAttachment.react','P2PActions','P2PMoneypennyCheckoutDialogContainer.react','P2PMoneypennyStore','React','ReactComponentWithPureRenderMixin','StoreAndPropBasedStateMixin'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=c('React').createClass({displayName:'MNCommerceAgentItemSuggestionMercuryShareAttachment',mixins:[c('ReactComponentWithPureRenderMixin'),c('StoreAndPropBasedStateMixin')(c('P2PMoneypennyStore'))],propTypes:{attachment:c('MercuryShareAttachmentReactShape'),maxWidth:h.number,location:h.oneOf(c('MercuryShareAttachmentRenderLocations').getValues())},statics:{calculateState:function j(k){var l=k.attachment&&k.attachment.target,m=!!(l&&l.payment_id);if(!m){var n=c('P2PMoneypennyStore').getTransferByID(l.id);m=!!(n&&n.payment_id);}return {isItemPurchased:m};}},_handleBuyClick:function j(){c('P2PActions').showDialog(c('P2PMoneypennyCheckoutDialogContainer.react'),{item:this._getItem(),onClose:c('P2PActions').hideDialog});},_getItem:function j(){var k=this.props.attachment;return k&&k.target;},render:function j(){var k=this._getItem();if(!k)return c('React').createElement(c('MercuryFallbackShareAttachment.react'),this.props);return (c('React').createElement(c('MNCommerceAgentItemSuggestionMercuryAttachment.react'),{itemSuggestion:k,isPurchased:this.state.isItemPurchased,location:this.props.location,onBuyClick:this._handleBuyClick,width:this.props.maxWidth}));}});f.exports=i;}),null);
__d('MNCommerceCheckoutButton.react',['cx','React','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l='medium';i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.getButtonSize=function(n){return l;};m.prototype.render=function(){var n="_48a0"+(this.props.disabled?' '+"_48a1":'')+(this.props.use==='default'?' '+"_48a2":'')+(this.props.use==='confirm'&&!this.props.disabled?' '+"_48a3":'');return (c('React').createElement('span',{className:c('joinClasses')(this.props.className,n),use:'default'},this.props.children));};function m(){i.apply(this,arguments);}m.propTypes={disabled:k.bool,use:k.oneOf(['default','confirm'])};f.exports=m;}),null);
__d('MNCommerceCheckoutOrderConfigReactShape',['React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=h.shape({allVariantOptions:h.object,id:h.string,initialVariantOptions:h.object,itemIDToItem:h.object,logo:h.string,name:h.string,optionToItems:h.object,ordered_product_items:h.array,product_item_id:h.string,variant_labels:h.array});f.exports=i;}),null);
__d('MNCommerceCheckoutOrderConfigUtils',['Map','Set'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={DELIMITER:'!@*',addVariantOptions:function i(j){var k=j,l=this._buildItemMaps(k),m=l.optionToItems,n=l.itemIDToItem,o=l.variantToItemID,p=this._getVariantOptionsAndEligibleItems(k,m,n),q=p.allVariantOptions,r=p.initialVariantOptions;k.itemIDToItem=n;k.optionToItems=m;k.variantToItemID=o;k.allVariantOptions=q;k.initialVariantOptions=r;return k;},_buildItemMaps:function i(j){var k=new (c('Map'))(),l=new (c('Map'))(),m=new (c('Map'))();j.ordered_product_items.forEach(function(n){var o=n.variant_values,p=[];Object.keys(o).forEach(function(u){p.push(o[u]);});var q=p.join(h.DELIMITER);m.set(q,n.item_id);k.set(n.item_id,n);for(var r=0;r<p.length;r++){if(!l.has(r))l.set(r,new (c('Map'))());var s=p[r],t=l.get(r);if(!t.has(s)){t.set(s,new (c('Set'))([n.item_id]));}else t.get(s).add(n.item_id);}});return {itemIDToItem:k,optionToItems:l,variantToItemID:m};},_getVariantOptionsAndEligibleItems:function i(j,k,l){var m={},n={};for(var o=0;o<j.variant_labels.length;o++){m[o]={};var p=[];k.get(o).forEach(function(q,r){var s=new (c('Map'))();p.push({label:r,available:true});for(var t=0;t<j.variant_labels.length;t++){if(o===t)continue;var u=[];k.get(t).forEach(function(v,w){var x=this._getIntersection(v,k.get(o).get(r)),y=false;if(x.size>0)y=this._isInStock(x,l);u.push({label:w,available:y});}.bind(this),this);s.set(t,u);}m[o][r]=s;n[o]=p;}.bind(this),this);}return {allVariantOptions:m,initialVariantOptions:n};},_getIntersection:function i(j,k){var l=new (c('Set'))([]);j.forEach(function(m){if(k.has(m))l.add(m);});return l;},_isInStock:function i(j,k){var l=false;j.forEach(function(m){var n=k.get(m);if(n.commerce_inventory>0)l=true;});return l;}};f.exports=h;}),null);
__d('MNCommerceLogoHeader.react',['cx','Image.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l={width:72,height:24},m={width:36,height:12},n=3,o=.75;i=babelHelpers.inherits(p,c('React').Component);j=i&&i.prototype;function p(){var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return q=(r=j.constructor).call.apply(r,[this].concat(t)),this.$MNCommerceLogoHeader1=function(){var v=this.props.logo;if(!v||!v.src)return null;var w=l.width,x=l.height,y=v.width/v.height;if(Math.abs(n-y)<=o){w=m.width;x=m.height;}var z={float:this.props.children?this.props.logoPosition:'none'};z.maxWidth=w;return (c('React').createElement('div',{className:"_b0-",key:'logo'},c('React').createElement('div',{className:"_fz0"},c('React').createElement(c('Image.react'),{className:"_56rs",height:v.height,src:v.src,width:v.width,style:{maxHeight:x}}))));}.bind(this),q;}p.prototype.render=function(){var q=this.$MNCommerceLogoHeader1();if(this.props.children){var r=c('React').createElement('div',{className:"_fy-"+(this.props.logoPosition==='left'?' '+"_fy_":''),key:'children'},c('React').createElement('div',{className:"_56rv"},this.props.children)),s=[r];if(q)if(this.props.logoPosition==='right'){s.push(q);}else s.unshift(q);return c('React').createElement('div',{className:(!q&&this.props.childPosition==='right'?"_fy_":'')+(' '+"_56rt")},s);}else return q;};p.propTypes={logo:k.object,logoPosition:k.oneOf(['left','right']),childPosition:k.oneOf(['left','right'])};f.exports=p;}),null);
__d('MNCommerceItemText.react',['cx','fbt','MNCommerceOrderItemsStatus','React','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=k.constructor).call.apply(o,[this].concat(q)),this.$MNCommerceItemText1=function(){if(this.props.metalines)return (c('React').createElement('div',null,this.$MNCommerceItemText2(this.props.metalines.metaline_1),this.$MNCommerceItemText2(this.props.metalines.metaline_2),this.$MNCommerceItemText3()));return null;}.bind(this),this.$MNCommerceItemText2=function(s){if(s)return (c('React').createElement('div',null,s));return null;},this.$MNCommerceItemText3=function(){if(this.props.size!=='large')return null;if(this.props.statusType===c('MNCommerceOrderItemsStatus').CANCELED)return (c('React').createElement('div',null,c('React').createElement('span',{className:"__hz"},i._("\u5df2\u53d6\u6d88"),' \u00b7 '),this.props.metalines.metaline_3));return (c('React').createElement('div',null,this.props.metalines.metaline_3));}.bind(this),n;}m.prototype.render=function(){var n=this.props,o=n.className,p=babelHelpers.objectWithoutProperties(n,['className']),q="_swr"+(p.size==='small'?' '+"_sws":'');return c('React').createElement('div',babelHelpers['extends']({className:c('joinClasses')(o,q)},p),c('React').createElement('div',{className:"_51fw"},this.props.title),c('React').createElement('div',{className:"_2y0f"},this.$MNCommerceItemText1()));};m.propTypes={metalines:l.shape({metaline_1:l.string,metaline_2:l.string,metaline_3:l.string}),title:l.string,size:l.oneOf(['large','small']),statusType:l.number};m.defaultProps={size:'small'};f.exports=m;}),null);
__d('MNCommerceSingleListItem.react',['cx','Image.react','MNCommerceItemText.react','React','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return m=(n=j.constructor).call.apply(n,[this].concat(p)),this.$MNCommerceSingleListItem1=function(){var r=this.props.imageDimension;if(this.props.thumbURL){return (c('React').createElement(c('Image.react'),{className:"_1fle",height:r,src:this.props.thumbURL,width:r}));}else return (c('React').createElement('div',{className:"_1prr",style:{height:r,width:r}}));}.bind(this),m;}l.prototype.render=function(){return c('React').createElement('div',{className:c('joinClasses')(this.props.className,"_39q_"),style:{height:this.props.imageDimension,width:this.props.width}},c('React').createElement('div',{className:"_1fld"},this.$MNCommerceSingleListItem1()),c('React').createElement(c('MNCommerceItemText.react'),babelHelpers['extends']({className:"_1flf",style:{left:this.props.imageDimension},size:this.props.size,statusType:this.props.statusType},this.props)));};l.propTypes={description:k.string,thumbURL:k.string,imageDimension:k.number.isRequired,statusType:k.number};f.exports=l;}),null);
__d('MNCommerceCheckoutOrderConfigDialog.react',['cx','fbt','CurrentEnvironment','MNCommerceButton.react','MNCommerceCheckoutButton.react','MNCommerceCheckoutOrderConfigReactShape','MNCommerceCheckoutOrderConfigUtils','MNCommerceDetailsDialog.react','MNCommerceDialogFooter.react','MNCommerceDialogBody.react','MNCommerceLogoHeader.react','MNCommerceSingleListItem.react','React','Set','XUIRadioButtonGroup.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes,m=18,n='\u00B7';j=babelHelpers.inherits(o,c('React').Component);k=j&&j.prototype;function o(q,r){k.constructor.call(this,q,r);p.call(this);this.state=this.$MNCommerceCheckoutOrderConfigDialog1();}o.prototype.componentWillReceiveProps=function(q){this.setState(this.$MNCommerceCheckoutOrderConfigDialog1(q));};o.prototype.render=function(){var q=i._("\u7121\u6cd5\u986f\u793a\u8ca8\u4ef6\u8cc7\u6599\u3002");return (c('React').createElement(c('MNCommerceDetailsDialog.react'),babelHelpers['extends']({errorMessage:q},this.props),this.$MNCommerceCheckoutOrderConfigDialog2()));};o.propTypes={error:l.object,checkoutOrderConfig:c('MNCommerceCheckoutOrderConfigReactShape'),loading:l.bool.isRequired,onContinue:l.func.isRequired,onTryAgain:l.func,shown:l.bool.isRequired,statusType:l.number};o.defaultProps={shown:false};var p=function q(){this.$MNCommerceCheckoutOrderConfigDialog1=function(r){var s=r||this.props,t=s.checkoutOrderConfig;if(!t)return {};return {variantOptions:t.initialVariantOptions,variants:[]};}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog2=function(){if(this.props.error||this.props.loading)return null;var r=i._("\u7e7c\u7e8c"),s=i._("\u53d6\u6d88"),t=this.props.checkoutOrderConfig,u=null,v=this.$MNCommerceCheckoutOrderConfigDialog3(),w=t&&t.ordered_product_items;if(v&&v.size){var x=v.values().next().value,y=t&&t.itemIDToItem.get(x);u=y&&y.images;}else if(w&&w.length)u=w[0].images;var z=this.state.variants.filter(function(ha){return ha;}).join(' '+n+' '),aa=z?{metaline_1:z}:null,ba=this.state.variants,ca=t&&t.variant_labels,da=t&&(!ca||ca.length===0||ba.length>0&&ba.every(function(ha){return ha;})),ea={src:t?t.logo:'',width:m,height:m},fa=c('React').createElement(c('MNCommerceButton.react'),{className:"_23qd",label:s,onClick:this.$MNCommerceCheckoutOrderConfigDialog4,use:'default'});fa=!c('CurrentEnvironment').messengerdotcom?fa:null;var ga=t&&ca&&ca.length>0;return (c('React').createElement('div',{className:"_vg4"},c('React').createElement(c('MNCommerceDialogBody.react'),null,c('React').createElement('div',{className:ga?"_vg5":''},c('React').createElement(c('MNCommerceLogoHeader.react'),{className:"_vg6",logo:ea,logoPosition:'left'}),c('React').createElement('div',{className:"_vg7"},c('React').createElement(c('MNCommerceSingleListItem.react'),{imageDimension:60,metalines:aa,size:'large',thumbURL:u,title:t&&t.name}))),this.$MNCommerceCheckoutOrderConfigDialog5()),c('React').createElement(c('MNCommerceDialogFooter.react'),null,fa,c('React').createElement(c('MNCommerceButton.react'),{className:"_23qe",disabled:!da,label:r,onClick:this.$MNCommerceCheckoutOrderConfigDialog6,use:'default'}))));}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog3=function(r){var s=this.props.checkoutOrderConfig;if(!s)return null;var t=r||this.state.variants,u=s.optionToItems,v=null;for(var w=0;w<t.length;w++){var x=t[w];if(x){var y=u.get(w),z=y&&y.get(x);if(!v){v=z;}else v=c('MNCommerceCheckoutOrderConfigUtils').$MNCommerceCheckoutOrderConfigDialog7(v,z);}}return v;}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog8=function(r,s){this.setState(this.$MNCommerceCheckoutOrderConfigDialog9(r,s));}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog10=function(r,s,t){var u=this.props.checkoutOrderConfig;if(!u)return null;var v=this.state.variants.slice();if(this.state.variants[r]!==s){v[r]=s;v[t]=null;}var w=this.$MNCommerceCheckoutOrderConfigDialog3(v),x=[],y=u.optionToItems,z=u.itemIDToItem;y.get(t).forEach(function(aa,ba){var ca=c('MNCommerceCheckoutOrderConfigUtils').$MNCommerceCheckoutOrderConfigDialog7(aa,w?w:new (c('Set'))()),da=false;if(ca.size>0)da=c('MNCommerceCheckoutOrderConfigUtils').$MNCommerceCheckoutOrderConfigDialog11(ca,z);x.push({label:ba,available:da});},this);return x;}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog9=function(r,s){var t=this.props.checkoutOrderConfig;if(!t)return null;var u=[],v=[],w=t.allVariantOptions[r][s];for(var x=0;x<t.variant_labels.length;x++)if(x===r){u.push(s);v.push(this.state.variantOptions[x]);}else{var y=this.state.variants.filter(function(aa){return aa;}),z=null;if(t.variant_labels.length<=2||y.length<2){z=w.get(x);}else z=this.$MNCommerceCheckoutOrderConfigDialog10(r,s,x);v.push(z);u.push(this.state.variants[x]);}return {variants:u,variantOptions:v};}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog6=function(r){var s=this.props.checkoutOrderConfig;if(!s||this.state.variants.some(function(w){return !w;}))return;var t=s.seller_id,u=this.state.variants.join(c('MNCommerceCheckoutOrderConfigUtils').DELIMITER),v=s.variantToItemID.get(u);this.props.onContinue(v,t,this.state.variants.join(' '+n+' '));this.props.onToggle(false);}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog4=function(r){this.props.onToggle(false);}.bind(this);this.$MNCommerceCheckoutOrderConfigDialog12=function(r,s,t){var u=r.map(function(v,w){return (c('React').createElement(c('MNCommerceCheckoutButton.react'),{key:w,disabled:v.available===false,use:'default',value:v.label},v.label));});return (c('React').createElement(c('XUIRadioButtonGroup.react'),{onValueChange:s,selectedValue:t,selectedUse:'confirm'},u));};this.$MNCommerceCheckoutOrderConfigDialog5=function(){var r=this.props.checkoutOrderConfig;if(!r)return null;var s=i._("\u9078\u64c7"),t=r.variant_labels.map(function(u,v){return (c('React').createElement('div',{key:v},c('React').createElement('div',{className:"_vg8"},s+' '+u),c('React').createElement('div',{className:"_vg9"},this.$MNCommerceCheckoutOrderConfigDialog12(this.state.variantOptions[v],this.$MNCommerceCheckoutOrderConfigDialog8.bind(this,v),this.state.variants[v]))));}.bind(this));return t;}.bind(this);};f.exports=o;}),null);
__d("XMNCommerceCheckoutOrderConfigController",["XController"],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/messages\/commerce\/checkout_order_config\/",{item_id:{type:"String",required:true},owner_id:{type:"String",required:true}});}),null);
__d('MNCommerceOrderConfigDataManager',['AsyncRequest','MNCommerceOrderConfigActions','XMNCommerceCheckoutOrderConfigController'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();h.prototype.fetchItem=function(i,j){var k=c('XMNCommerceCheckoutOrderConfigController').getURIBuilder().setString('item_id',i).setString('owner_id',j).getURI();new (c('AsyncRequest'))().setURI(k).setHandler(this.$MNCommerceOrderConfigDataManager1).setErrorHandler(this.$MNCommerceOrderConfigDataManager2).send();};h.prototype.$MNCommerceOrderConfigDataManager1=function(i){c('MNCommerceOrderConfigActions').itemLoaded(i.payload);};h.prototype.$MNCommerceOrderConfigDataManager2=function(i){var j=i.getRequest().uri.getQueryData(),k=j.item_id;c('MNCommerceOrderConfigActions').itemLoadError(k);};function h(){}f.exports=new h();}),null);
__d('MNCommerceOrderConfigStore',['Cache','FluxStore','LoadObject','MessengerDispatcher','MNCommerceActionTypes','MNCommerceCacheTimeoutLimits','MNCommerceCheckoutOrderConfigUtils','MNCommerceOrderConfigDataManager'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('FluxStore'));i=h&&h.prototype;function j(){i.constructor.call(this,c('MessengerDispatcher'));this.$MNCommerceOrderConfigStore1=new (c('Cache'))();}j.prototype.__onDispatch=function(k){var l=k.type,m=k.item?k.item.id:k.itemID;switch(l){case c('MNCommerceActionTypes').RETAIL_ITEM.LOADED:var n=k.item;n=c('MNCommerceCheckoutOrderConfigUtils').addVariantOptions(n);this.$MNCommerceOrderConfigStore1.set(m,c('LoadObject').empty().setValue(n),null,c('MNCommerceCacheTimeoutLimits').SUCCESS_TIMEOUT);this.__emitChange();break;case c('MNCommerceActionTypes').RETAIL_ITEM.LOAD_ERROR:this.$MNCommerceOrderConfigStore1.set(m,c('LoadObject').empty().setError(new Error('Unable to load item: '+m)),null,c('MNCommerceCacheTimeoutLimits').ERROR_TIMEOUT);this.__emitChange();break;case c('MNCommerceActionTypes').RETAIL_ITEM.RELOAD:if(m){this.$MNCommerceOrderConfigStore1.set(m,c('LoadObject').loading());c('MNCommerceOrderConfigDataManager').fetchItem(m);}this.__emitChange();break;}};j.prototype.getItem=function(k,l){if(k&&!this.$MNCommerceOrderConfigStore1.has(k)){this.$MNCommerceOrderConfigStore1.set(k,c('LoadObject').loading().setValue({itemID:k}));c('MNCommerceOrderConfigDataManager').fetchItem(k,l);}return this.$MNCommerceOrderConfigStore1.get(k)||c('LoadObject').empty();};f.exports=new j();}),null);
__d('MNCommerceCheckoutOrderConfigDialogContainer.react',['BanzaiLogger','MNCommerceDialogStateActions','MNCommerceDialogStateStore','MNCommerceLoggingConstants','MNCommerceLoggerEvents','MNCommerceCheckoutOrderConfigDialog.react','MNCommerceOrderConfigActions','MNCommerceOrderConfigStore','PureStoreBasedStateMixin','React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').createClass({displayName:'MNCommerceCheckoutOrderConfigDialogContainer',mixins:[c('PureStoreBasedStateMixin')(c('MNCommerceOrderConfigStore'))],statics:{calculateState:function i(){var j=c('MNCommerceDialogStateStore').getState(),k=null,l=null,m=null;if(j){k=j.itemID;l=j.ownerID;m=j.onContinue;}var n=c('MNCommerceOrderConfigStore').getItem(k,l);if(!n.isLoading())c('BanzaiLogger').log('MessengerCommerceLoggerConfig',{event:n.hasError()?c('MNCommerceLoggerEvents').DIALOG_LOAD_ERROR:c('MNCommerceLoggerEvents').DIALOG_LOAD_SUCCESS,debug_data:JSON.stringify({dialog_surface:c('MNCommerceLoggingConstants').DIALOG_SURFACE.CHECKOUT_ORDER_CONFIG,item_id:k})});return {shown:!!j,loading:n.isLoading(),itemID:k,checkoutOrderConfig:n.getValue(),onContinue:m,error:n.getError()};}},render:function i(){return (c('React').createElement(c('MNCommerceCheckoutOrderConfigDialog.react'),{error:this.state.error,checkoutOrderConfig:this.state.loading?null:this.state.checkoutOrderConfig,loading:this.state.loading,onContinue:this.state.onContinue,onToggle:this._onToggle,onTryAgain:this._onTryAgainClick,shown:this.state.shown}));},_onToggle:function i(j){if(!j){c('BanzaiLogger').log('MessengerCommerceLoggerConfig',{event:c('MNCommerceLoggerEvents').DIALOG_CLOSED,debug_data:JSON.stringify({dialog_surface:c('MNCommerceLoggingConstants').DIALOG_SURFACE.CHECKOUT_ORDER_CONFIG,item_id:this.state.itemID})});c('MNCommerceDialogStateActions').hideDialog();}},_onTryAgainClick:function i(){c('MNCommerceOrderConfigActions').itemReload(this.state.itemID);}});f.exports=h;}),null);
__d("XMNCommerceCTAPostProcessController",["XController"],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/messages\/commerce\/cta\/postprocess\/",{cta_id:{type:"String",required:true}});}),null);
__d('MNCommerceCTAProcessor',['AsyncRequest','PopupWindow','XMNCommerceCTAPostProcessController'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();h.prototype.process=function(i){var j=c('PopupWindow').open('',500,1024),k=c('XMNCommerceCTAPostProcessController').getURIBuilder().setString('cta_id',i).getURI();new (c('AsyncRequest'))().setURI(k).setMethod('post').setHandler(function(l){return j.location=l.payload;}).send();};function h(){}f.exports=new h();}),null);
__d('MNCommercePromotionReactShapes',['React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=h.arrayOf(h.shape({action_link:h.string,title:h.string})),j={CallToActions:i,RetailItem:h.shape({call_to_actions:i,id:h.string,metalines:h.shape({metaline_1:h.string,metaline_2:h.string,metaline_3:h.string}),name:h.string,url:h.string,source:h.string})};f.exports=j;}),null);
__d('MessengerPlatformGenericItemMercuryAttachment.react',['cx','fbt','AsyncDialog','AsyncRequest','Banzai','CurrentEnvironment','FBConfirmDialog.react','Link.react','MessageShareType','MessengerAdsWebTypedLogger','MessagingForwardAttachmentDialog.react','MessengerForwardAttachmentDialog.react','MNAdsLoggerEventEnum','MNCommerceCallToActionType','MNCommerceCTAProcessor','MNCommerceBubbleImage.react','MNCommerceMessageType','MNCommercePostbackCTADataManager','MNCommercePromotionReactShapes','MNContentSubscriptionMessageUserEngagementTypedLogger','React','MercuryShareAttachmentRenderLocations','Tooltip','joinClasses'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes;function m(p){if(p!==undefined){var q=p.match(/\d+/);if(q!==undefined&&q!==null)return q[0];}return null;}function n(p,q){return (c('React').createElement(c('Link.react'),{className:q,key:p.title+p.id,onClick:p.onClick},p.translated_title||p.title));}j=babelHelpers.inherits(o,c('React').PureComponent);k=j&&j.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=k.constructor).call.apply(q,[this].concat(s)),this.state={showDialog:false,showShare:false},this.$MessengerPlatformGenericItemMercuryAttachment1=function(){var u=this.props,v=u.isSubattachment,w=u.retailItem;if(!w||!w.thumb_url)return null;var x=c('React').createElement(c('MNCommerceBubbleImage.react'),{className:(!v?"_3_om":'')+(!v?' '+"_4j39":''),location:this.props.location,source:w.thumb_url,width:this.props.width}),y=null;if(w.item_url){y=c('React').createElement(c('Link.react'),{href:w.item_url,onClick:function(){this.$MessengerPlatformGenericItemMercuryAttachment4();}.bind(this),target:'_blank'},x);}else y=x;var z=c('React').createElement('div',{className:"_3cn2",key:'image'},y);return z;}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment4=function(){if(this.props.mnMessageType==c('MNCommerceMessageType').CONTENT_SUBSCRIPTION){var u=m(this.props.pageID),v=this.props.retailItem&&this.props.retailItem.id;new (c('MNContentSubscriptionMessageUserEngagementTypedLogger'))().setPageID(u).setMessageID(this.props.messageID).setCommerceItemID(v).setName('mn_platform_msg_click').log();c('Banzai').post('mn_platform_message_click_setsuna',{page_id:u,item_id:v});}}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment2=function(){var u=this.props.retailItem;if(!u)return null;return (c('React').createElement('div',{className:"_3cne"},c('React').createElement('div',{className:"_3cnf"},c('React').createElement('div',{className:"_3cng"},c('React').createElement('div',{className:"_3cnh"},this.props.longestName),c('React').createElement('div',{className:this.props.longestName?"_3cni":''},u.name)),this.$MessengerPlatformGenericItemMercuryAttachment5(),this.$MessengerPlatformGenericItemMercuryAttachment6())));}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment7=function(){if(this.props.isSponsored)return null;return (c('React').createElement('div',{className:"_3cnj"},c('React').createElement('span',{className:"_3cnk"}),this.$MessengerPlatformGenericItemMercuryAttachment8()));}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment8=function(){var u=this.props.label;if(u===0){return i._("\u5df2\u63a8\u5ee3");}else if(u===1)return i._("\u8d0a\u52a9");return null;}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment5=function(){var u=this.props.retailItem&&this.props.retailItem.metalines;if(!u)return null;u=Object.keys(u).filter(function(v){return u&&u[v];}).map(function(v,w){var x=u&&u[v];return (c('React').createElement('div',{className:"_3cnl",key:v},c('React').createElement('div',{className:"_3cnh"},this.props.longestMetaline),c('React').createElement('div',{className:this.props.longestMetaline?"_3cni":''},x)));}.bind(this));return u;}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment6=function(){var u=this.props.retailItem&&this.props.retailItem.item_url;if(!this.props.isSponsored&&u){var v=document.createElement('a');v.href=u;var w=v.hostname;if(this.props.mnMessageType==c('MNCommerceMessageType').CONTENT_SUBSCRIPTION&&this.props.retailItem)w=this.props.retailItem.source;return (c('React').createElement('div',{className:"_3cnn"},c('React').createElement('a',{href:u},w)));}else return null;}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment3=function(){var u=this.props.retailItem,v=this.props.callToActions,w=this.props.threadID;if(!v||!v.length)return null;var x=function(da,ea){return (c('React').createElement(c('Link.react'),{className:ea,href:da.onClick?null:da.action_link,key:da.title+da.id,onClick:da.onClick||this.$MessengerPlatformGenericItemMercuryAttachment9,target:'_blank'},da.translated_title||da.title));}.bind(this),y=function da(ea,fa){var ga=i._("\u8acb\u900f\u904e Messenger \u61c9\u7528\u7a0b\u5f0f\u4f7f\u7528\u9019\u9805\u529f\u80fd\u3002");return (c('React').createElement('div',babelHelpers['extends']({className:c('joinClasses')(fa,"_3cno"),'data-tooltip-alignh':'center','data-tooltip-position':'above',key:ea.title},c('Tooltip').propsFor(ga)),ea.translated_title||ea.title));};v=v.filter(function(da){return da.action_link;}).map(function(da,ea){var fa="_3cnp"+(ea===0&&!u?' '+"_3cnq":''),ga=da.action_link.startsWith('fb-messenger://payments/buy/mc?')||da.action_link.startsWith('fb-messenger://business/commerce/');switch(da.action_type){case c('MNCommerceCallToActionType').POSTBACK:var ha=function(pa){this.onCancel();if(this.props.pageID&&m(this.props.pageID)!==m(w))return;if(da.is_mutable_by_server){c('MNCommercePostbackCTADataManager').send(da.id);}else c('MNCommercePostbackCTADataManager').sendAndConfirm(da.id,da.title,w);}.bind(this),ia=null;if(this.state.showDialog&&da.should_show_user_confirmation)ia=c('React').createElement(c('FBConfirmDialog.react'),{title:da.confirmation_title,shown:true,onConfirm:ha,onCancel:this.onCancel,confirmButtonText:da.confirmation_continue_label,cancelButtonText:da.confirmation_cancel_label,content:da.confirmation_message});var ja=da.should_show_user_confirmation?this.onConfirm:ha;return (c('React').createElement('div',{key:ea},c('React').createElement(c('Link.react'),{className:fa,onClick:ja},da.translated_title||da.title),ia));case c('MNCommerceCallToActionType').OPEN_URL:if(ga){return n(da,fa);}else return x(da,fa);case c('MNCommerceCallToActionType').OPEN_CANCEL_RIDE_MUTATION:return y(da,fa);case c('MNCommerceCallToActionType').OPEN_NATIVE:if(ga){return n(da,fa);}else return y(da,fa);case c('MNCommerceCallToActionType').SHARE:var ka=c('CurrentEnvironment').messengerdotcom?c('MessengerForwardAttachmentDialog.react'):c('MessagingForwardAttachmentDialog.react'),la=i._("\u5206\u4eab\u5230\u4e0d\u540c\u8a0a\u606f"),ma=c('React').createElement(ka,{attachmentID:da.id,onClose:this.$MessengerPlatformGenericItemMercuryAttachment10,shown:this.state.showShare,title:la,shareType:c('MessageShareType').PLATFORM_SHARE_CTA});return (c('React').createElement('div',{key:ea},c('React').createElement(c('Link.react'),{className:fa,onClick:this.$MessengerPlatformGenericItemMercuryAttachment11},da.title),ma));case c('MNCommerceCallToActionType').ACCOUNT_LINK:var na=function pa(qa){c('MNCommerceCTAProcessor').process(da.id);};return (c('React').createElement(c('Link.react'),{className:fa,key:ea,onClick:na},da.translated_title||da.title));case c('MNCommerceCallToActionType').FACEBOOK_REPORT_A_PROBLEM:var oa=function pa(qa){c('AsyncDialog').send(new (c('AsyncRequest'))('/ajax/bugs/report'));};return (c('React').createElement(c('Link.react'),{className:fa,key:ea,onClick:oa},da.translated_title||da.title));}}.bind(this));var z=this.props.longestCTAs,aa=[];if(z&&z>v.length){for(var ba=0;ba<z-v.length;ba++)aa.push(c('React').createElement('div',{className:"_3cnh _3cnp",key:'placeholder'+ba},'CTA placeHolder'));var ca=aa.concat(v);return (c('React').createElement('div',{className:"_3cnr"},ca));}return (c('React').createElement('div',{className:"_3cnr"},v));}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment9=function(event){if(this.props.isSponsored)new (c('MessengerAdsWebTypedLogger'))().setEvent(c('MNAdsLoggerEventEnum').LINK_CLICK_CTA).setIsSponsored(this.props.isSponsored).setItemID(this.props.retailItem&&this.props.retailItem.id).setMessageID(this.props.messageID).setPageID(this.props.pageID).log();}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment11=function(){this.setState({showShare:true});}.bind(this),this.$MessengerPlatformGenericItemMercuryAttachment10=function(){this.setState({showShare:false});}.bind(this),this.onConfirm=function(){this.setState({showDialog:true});}.bind(this),this.onCancel=function(){this.setState({showDialog:false});}.bind(this),p;}o.prototype.componentDidMount=function(){if(this.props.isSponsored)new (c('MessengerAdsWebTypedLogger'))().setEvent(c('MNAdsLoggerEventEnum').MESSAGE_SEEN_THREAD).setIsSponsored(this.props.isSponsored).setItemID(this.props.retailItem&&this.props.retailItem.id).setMessageID(this.props.messageID).setPageID(this.props.pageID).log();};o.prototype.render=function(){var p={};if(this.props.location===c('MercuryShareAttachmentRenderLocations').CHAT&&this.props.width)p.width=this.props.width;return c('React').createElement('div',{className:"_3cn0"+(this.props.location===c('MercuryShareAttachmentRenderLocations').WEB_INBOX?' '+"_1hf9":''),style:p},this.$MessengerPlatformGenericItemMercuryAttachment1(),c('React').createElement('div',{className:"_3cn1"},this.$MessengerPlatformGenericItemMercuryAttachment2(),this.$MessengerPlatformGenericItemMercuryAttachment3()));};o.propTypes={callToActions:c('MNCommercePromotionReactShapes').CallToActions,isSponsored:l.bool,isSubattachment:l.bool,label:l.number,logo:l.object,location:l.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()),longestCTAs:l.number,longestMetaline:l.string,longestName:l.string,messageID:l.string,mnMessageType:l.string,pageID:l.string,retailItem:c('MNCommercePromotionReactShapes').RetailItem,url:l.string,width:l.number,threadID:l.string};f.exports=o;}),null);
__d('P2PAddressStore',['P2PActionConstants','EventEmitter','ImmutableObject','P2PAPI','P2PDispatcher','immutable'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('immutable').List,k=new j(),l=false,m=false,n={},o=void 0,p=null,q=false;function r(u,v){if(u)n[u]=new (c('ImmutableObject'))(v);}function s(u,v){p=v;if(u)n[u]={error:v};}h=babelHelpers.inherits(t,c('EventEmitter'));i=h&&h.prototype;function t(){i.constructor.call(this);l=false;m=false;k=new j();n={};o=c('P2PDispatcher').register(this.onEventDispatched.bind(this));}t.prototype.onEventDispatched=function(u){var v=u.data,w=u.type;switch(w){case c('P2PActionConstants').ADDRESS_SAVING:this.handleAddressSaving(v);this.emit('change');break;case c('P2PActionConstants').ADDRESSES_UPDATED:this.handleAddressesUpdated(v);this.emit('change');break;case c('P2PActionConstants').ADDRESS_ADDED:this.handleAddressAdded(v);this.emit('change');break;case c('P2PActionConstants').ADDRESS_ADDED_ERROR:this.handleAddressAddedError(v);this.emit('change');break;case c('P2PActionConstants').ADDRESS_ADDED_ERROR_CLEARED:this.handleAddressAddedErrorCleared();this.emit('change');break;}};t.prototype.getAsyncRequestState=function(){return n;};t.prototype.isAddressesFetchComplete=function(){return l;};t.prototype.handleAddressSaving=function(){q=true;p=null;};t.prototype.handleAddressesUpdated=function(u){l=true;u=u.map(function(v){return new (c('ImmutableObject'))(v);});k=new j(u);};t.prototype.handleAddressAdded=function(u){q=false;r(u.requestID,u);if(!this.getAddressByID(u.id))k=k.push(new (c('ImmutableObject'))(u));};t.prototype.handleAddressAddedError=function(u){q=false;s(u.requestID,u.errors);};t.prototype.handleAddressAddedErrorCleared=function(){p=null;};t.prototype.getAll=function(u){if(!m){m=true;c('P2PAPI').getAddresses();}if(u)return k.filter(function(v){return v.isVerified;});return k;};t.prototype.getAddressByID=function(u){return k.find(function(v){return v.id===u;});};t.prototype.getDispatchToken=function(){return o;};t.prototype.getSaveErrors=function(){return p;};t.prototype.isSaving=function(){return q;};f.exports=new t();}),null);
__d('P2PAddressShape',['React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=h.shape({label:h.string,care_of:h.string,city:h.string,id:h.string,state:h.string,street1:h.string,street2:h.string,zip:h.string});f.exports=i;}),null);
__d('P2PAddressDetails.react',['P2PAddressShape','P2PText.react','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('React').Component);i=h&&h.prototype;j.prototype.render=function(){var k=this.props.address,l=[k.city,k.state],m=void 0,n=void 0,o=void 0,p={display:'block',type:'primary'},q=k.zip?' '+k.zip:'',r=k.country?' '+k.country:'';l=l.join(', ')+q+r;if(k.streeet2)m=c('React').createElement(c('P2PText.react'),p,k.street2);if(k.label)n=c('React').createElement(c('P2PText.react'),p,k.label);if(k.care_of)o=c('React').createElement(c('P2PText.react'),p,k.care_of);return (c('React').createElement('div',null,n,o,c('React').createElement(c('P2PText.react'),p,k.street1),m,c('React').createElement(c('P2PText.react'),p,l)));};function j(){h.apply(this,arguments);}j.propTypes={address:c('P2PAddressShape').isRequired};f.exports=j;}),null);
__d('P2PAddressForm.react',['cx','fbt','FBPaymentsAddressLabelFormField_DEPRECATED.react','FBPaymentsForm_DEPRECATED.react','FBPaymentsFormField_DEPRECATED.react','FBPaymentsFormFieldUtils_DEPRECATED','React'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=k.constructor).call.apply(o,[this].concat(q)),this.state={formData:{},isValid:false},this.handleValidation=function(s,t){this.setState({formData:t,isValid:s});this.props.onValidation(s,t);}.bind(this),n;}m.prototype.render=function(){var n=!!(this.props.prefilledFormData&&this.props.prefilledFormData.care_of);return (c('React').createElement(c('FBPaymentsForm_DEPRECATED.react'),{errorTitle:i._("\u5132\u5b58\u5730\u5740\u6642\u767c\u751f\u554f\u984c"),prefilledFormData:this.props.prefilledFormData,onValidation:this.handleValidation,saveErrors:this.props.saveErrors},c('React').createElement(c('FBPaymentsAddressLabelFormField_DEPRECATED.react'),{className:"_3-96",name:'label',ignoreStyling:true,required:true}),c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{name:'care_of',initiallyFocused:!n,placeholder:i._("\u59d3\u540d"),required:true,width:100}),c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{name:'street1',initiallyFocused:n,placeholder:i._("\u5730\u5740"),required:true,width:100}),c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{name:'street2',placeholder:i._("\u5730\u5740 2"),width:100}),c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{name:'city',placeholder:i._("\u57ce\u5e02"),required:true,width:50}),c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{formatValue:function o(p){p=c('FBPaymentsFormFieldUtils_DEPRECATED').stripNonAlpha(p);return p.toUpperCase();},limit:2,name:'state',placeholder:i._("\u5dde\uff0f\u7701"),required:true,width:25}),c('React').createElement(c('FBPaymentsFormField_DEPRECATED.react'),{formatValue:c('FBPaymentsFormFieldUtils_DEPRECATED').stripNonDigits,limit:5,name:'zip',placeholder:i._("\u90f5\u905e\u5340\u865f"),required:true,width:25})));};m.propTypes={onValidation:l.func.isRequired,prefilledFormData:l.object,saveErrors:l.object};m.defaultProps={editMode:false,prefilledFormData:{},saveErrors:null};f.exports=m;}),null);
__d('P2PCheckoutConfigSection.react',['cx','fbt','LeftRight.react','Link.react','React','emptyFunction'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=k.constructor).call.apply(o,[this].concat(q)),this.renderChangeLink=function(){if(this.props.showEditOptions||!this.props.hasOptions)return null;return (c('React').createElement(c('Link.react'),{className:"_nb2",href:'#',onClick:this.props.onChangeClicked},i._("\u8b8a\u66f4")));}.bind(this),this.renderContent=function(){var s=this.props,t=void 0,u=void 0;if(s.showEditOptions){t=this.renderSelector();}else if(s.hasOptions)t=this.renderCurrentItem();if(s.showForm)u=this.renderForm();return (c('React').createElement('div',null,t,u));}.bind(this),this.renderForm=function(){var s=void 0;if(!this.props.renderFormComponent)return null;if(this.props.renderFormFooterMessage)s=c('React').createElement('div',{className:"_nb4"},this.props.renderFormFooterMessage());return (c('React').createElement('div',{className:"_nb3",key:'form'},this.props.renderFormComponent(),s));}.bind(this),this.renderSelector=function(){return (c('React').createElement('div',{className:"_nb5",key:'selector'},this.props.renderSelectorComponent()));}.bind(this),this.renderCurrentItem=function(){if(!this.props.renderSelectedRow)return null;return (c('React').createElement('div',{className:"_nb6",key:'currentItem'},this.props.renderSelectedRow()));}.bind(this),n;}m.prototype.render=function(){return (c('React').createElement('div',{className:"_nb7"},c('React').createElement(c('LeftRight.react'),{className:"_nb8"},c('React').createElement('div',{className:"_nb9"},this.props.title),this.renderChangeLink()),c('React').createElement('div',{className:"_nba"},this.renderContent())));};m.propTypes={onChangeClicked:l.func,hasOptions:l.bool,showEditOptions:l.bool,showForm:l.bool,renderFormComponent:l.func,renderFormFooterMessage:l.func,renderSelectedRow:l.func,renderSelectorComponent:l.func.isRequired,title:l.string.isRequired};m.defaultProps={onChangeClicked:c('emptyFunction'),renderFormFooterMessage:c('emptyFunction'),renderFormComponent:c('emptyFunction'),renderSelectedRow:c('emptyFunction')};f.exports=m;}),null);
__d('P2PChooseAddressForm.react',['cx','fbt','immutable','P2PAddressShape','P2PAddressDetails.react','P2PText.react','React','XUIRadioList.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('immutable').List,m=c('XUIRadioList.react').Item,n=c('React').PropTypes,o='add_address';j=babelHelpers.inherits(p,c('React').Component);k=j&&j.prototype;function p(){var q,r;for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return q=(r=k.constructor).call.apply(r,[this].concat(t)),this.state={selectedValue:this.props.selectedAddress.id},this.getselectedAddress=function(){return this.props.addresses.filter(function(v){return v.id===this.state.selectedValue;}.bind(this)).first();}.bind(this),this.handleChange=function(v){var w=void 0;if(v===o){this.props.onNewAddressOptionSelected();this.setState({selectedValue:v});}else{w=this.props.addresses.filter(function(x){return x.id===v;}).first();this.setState({selectedValue:w.id});this.props.onChange(w);}}.bind(this),this.renderAddressItem=function(v){return (c('React').createElement(m,{className:"_54sy",key:v.id,value:v.id},c('React').createElement(c('P2PAddressDetails.react'),{address:v})));},this.renderAddNewAddressItem=function(){return (c('React').createElement(m,{className:"_54sy",key:o,value:o},c('React').createElement(c('P2PText.react'),{type:'primary'},i._("\u52a0\u65b0\u5730\u5740"))));},this.getRadioListItems=function(){var v=this.props.addresses,w=v.map(this.renderAddressItem).concat(this.renderAddNewAddressItem());return w;}.bind(this),q;}p.prototype.render=function(){return (c('React').createElement(c('XUIRadioList.react'),{className:"_1ck2",onValueChange:this.handleChange,selectedValue:this.state.selectedValue},this.getRadioListItems()));};p.propTypes={addresses:n.instanceOf(l),onChange:n.func.isRequired,onNewAddressOptionSelected:n.func.isRequired,selectedAddress:c('P2PAddressShape')};f.exports=p;}),null);
__d('P2PAddressConfigSection.react',['fbt','CurrentEnvironment','FBPaymentsAddressForm_DEPRECATED.react','P2PAddressDetails.react','P2PAddressForm.react','P2PAddressShape','P2PCheckoutConfigSection.react','P2PChooseAddressForm.react','P2PText.react','React','immutable'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l='P2PAddressConfigSection_learnMoreSentenceID';i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=j.constructor).call.apply(o,[this].concat(q)),this.renderFormComponent=function(){var s=this.props;if(s.acceptInternational)return (c('React').createElement(c('FBPaymentsAddressForm_DEPRECATED.react'),{onValidation:s.onValidation,prefilledFormData:{care_of:this.props.buyerName},saveErrors:s.saveErrors}));return (c('React').createElement(c('P2PAddressForm.react'),{onValidation:s.onValidation,prefilledFormData:{care_of:this.props.buyerName},saveErrors:s.saveErrors}));}.bind(this),this.renderSelectedRow=function(){var s=this.props.selectedAddress;if(!s)return null;return (c('React').createElement(c('P2PAddressDetails.react'),{address:s}));}.bind(this),this.renderSelectorComponent=function(){var s=this.props;return (c('React').createElement(c('P2PChooseAddressForm.react'),{addresses:s.addresses,onChange:this.props.onAddressSelected,onNewAddressOptionSelected:this.props.onNewAddressSelected,selectedAddress:s.selectedAddress}));}.bind(this),this.renderFormFooterMessage=function(){return (c('React').createElement(c('P2PText.react'),{id:l,type:'secondary'},h._("\u4f60\u7684\u9001\u8ca8\u5730\u5740\u5c07\u5b89\u5168\u5132\u5b58\uff0c\u4ee5\u4fbf\u672a\u4f86\u5728 Facebook \u4e0a\u8cfc\u8cb7\u6642\u4f7f\u7528\u3002")));},this.getTitle=function(){if(c('CurrentEnvironment').messengerdotcom)return h._("\u9001\u8ca8\u5730\u5740");return h._("\u9001\u8ca8\u5730\u5740");},n;}m.prototype.render=function(){var n=this.props;return (c('React').createElement(c('P2PCheckoutConfigSection.react'),{hasOptions:n.addresses.count()!==0,showEditOptions:n.showEditOptions,showForm:n.showForm,onChangeClicked:n.onChangeClicked,renderFormComponent:this.renderFormComponent,renderFormFooterMessage:this.renderFormFooterMessage,renderSelectedRow:this.renderSelectedRow,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()}));};m.propTypes={acceptInternational:k.bool,addresses:k.instanceOf(c('immutable').List).isRequired,buyerName:k.string,showEditOptions:k.bool,showForm:k.bool,onAddressSelected:k.func.isRequired,onChangeClicked:k.func.isRequired,onNewAddressSelected:k.func.isRequired,onValidation:k.func.isRequired,selectedAddress:c('P2PAddressShape'),saveErrors:k.object};f.exports=m;}),null);
__d('P2PCheckoutPriceDetails.react',['cx','fbt','LeftRight.react','P2PText.react','React'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes,m=i._("\u9700\u8981\u5730\u5740");j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return o=(p=k.constructor).call.apply(p,[this].concat(r)),this.renderLineItemRow=function(t,u,v){return (c('React').createElement('div',{className:"_46ld"},c('React').createElement(c('LeftRight.react'),null,c('React').createElement(c('P2PText.react'),{display:'inline',type:v?'primary':'secondary'},c('React').createElement('span',{className:"_10ba"+(v?' '+"_3a06":'')},t)),c('React').createElement(c('P2PText.react'),{className:"_10ba"+(' '+"_46lf")+(!u?' '+"_46lg":''),display:'inline',type:v?'primary':'secondary'},c('React').createElement('span',{className:v?"_3a06":''},u?u:m)))));},o;}n.prototype.render=function(){return (c('React').createElement('div',{className:"_46lh"},this.props.showSubtotalField?this.renderLineItemRow(i._("\u5c0f\u8a08"),this.props.subtotal):null,this.props.showTaxField?this.renderLineItemRow(i._("\u7a05\u91d1"),this.props.tax):null,this.props.showShippingField?this.renderLineItemRow(i._("\u904b\u8cbb"),this.props.shipping):null,this.renderLineItemRow(i._("\u7e3d\u8a08"),this.props.total,true)));};n.propTypes={shipping:l.string,subtotal:l.string,tax:l.string,total:l.string,showShippingField:l.bool,showSubtotalField:l.bool,showTaxField:l.bool};n.defaultProps={showShippingField:true,showSubtotalField:true,showTaxField:true};f.exports=n;}),null);
__d('P2PCreditCardConfigSection.react',['fbt','CurrentEnvironment','Link.react','MessengerPaymentProductType','P2PChooseCreditCardForm.react','P2PCreditCard','P2PCreditCardDetails.react','P2PCreditCardForm.react','P2PCheckoutConfigSection.react','P2PLinkConstants','P2PText.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l='P2PCreditCardConfigSection_learnMoreSentenceID';i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=j.constructor).call.apply(o,[this].concat(q)),this.renderFormComponent=function(){var s=this.props;return (c('React').createElement(c('P2PCreditCardForm.react'),{onValidation:s.onValidation,saveErrors:s.saveErrors,productType:c('MessengerPaymentProductType').MESSENGER_COMMERCE}));}.bind(this),this.renderSelectedRow=function(){var s=this.props.selectedCreditCard;if(!s)return null;return (c('React').createElement(c('P2PCreditCardDetails.react'),{creditCard:s}));}.bind(this),this.renderSelectorComponent=function(){var s=this.props;return (c('React').createElement(c('P2PChooseCreditCardForm.react'),{addCardOptionText:h._("\u65b0\u589e\u5361\u7247"),creditCards:s.creditCards,onAddDebitCardOptionSelected:this.props.onNewCreditCardSelected,onChange:this.props.onCreditCardSelected,selectedCard:s.selectedCreditCard,showAddDebitCardOption:true}));}.bind(this),this.renderFormFooterMessage=function(){return (c('React').createElement(c('P2PText.react'),{id:l,type:'secondary'},h._("\u4f60\u7684\u4ed8\u6b3e\u8cc7\u6599\u5df2\u5b89\u5168\u5132\u5b58\u3002"),c('React').createElement('div',null,c('React').createElement(c('Link.react'),{'aria-describedby':l,href:c('P2PLinkConstants').addDebitCardHelpURI,target:'_blank'},h._("\u77ad\u89e3\u8a73\u60c5")))));},this.getTitle=function(){if(c('CurrentEnvironment').messengerdotcom)return h._("\u4ed8\u6b3e\u8cc7\u8a0a");return h._("\u4ed8\u6b3e\u8cc7\u8a0a");},n;}m.prototype.render=function(){var n=this.props;return (c('React').createElement(c('P2PCheckoutConfigSection.react'),{hasOptions:n.creditCards.length!==0,showEditOptions:n.showEditOptions,showForm:n.showForm,onChangeClicked:n.onChangeClicked,renderFormComponent:this.renderFormComponent,renderFormFooterMessage:this.renderFormFooterMessage,renderSelectedRow:this.renderSelectedRow,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()}));};m.propTypes={creditCards:k.arrayOf(k.instanceOf(c('P2PCreditCard'))).isRequired,showEditOptions:k.bool,showForm:k.bool,onCreditCardSelected:k.func.isRequired,onChangeClicked:k.func.isRequired,onNewCreditCardSelected:k.func.isRequired,onValidation:k.func.isRequired,selectedCreditCard:k.instanceOf(c('P2PCreditCard')),saveErrors:k.object};f.exports=m;}),null);
__d('P2PPaymentMethodConfigSection.react',['fbt','CurrentEnvironment','P2PCheckoutConfigSection.react','P2PCreditCardDetails.react','P2PText.react','FBPaymentsChoosePaymentMethodForm_DEPRECATED.react','FBPaymentsPaymentMethodShape_DEPRECATED','FBPaymentsMethodType','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return m=(n=j.constructor).call.apply(n,[this].concat(p)),this.renderFormComponent=function(){return (c('React').createElement(c('FBPaymentsChoosePaymentMethodForm_DEPRECATED.react'),{onPaymentMethodConfigured:this.props.onPaymentMethodConfigured,onPaymentMethodSelected:this.props.onPaymentMethodSelected,paymentMethods:this.props.paymentMethods}));}.bind(this),this.renderSelectedRow=function(){var r=this.props.confirmedPaymentMethod;if(!r)return null;switch(r.type){case c('FBPaymentsMethodType').GENERIC_CARD:return c('React').createElement(c('P2PCreditCardDetails.react'),{creditCard:r.creditCard});case c('FBPaymentsMethodType').MANUAL_TRANSFER:return (c('React').createElement(c('P2PText.react'),{type:'primary'},h._("\u5230 ATM \u6216\u9280\u884c\u8f49\u5e33")));case c('FBPaymentsMethodType').NET_BANKING:var s=r.bank.name;return (c('React').createElement(c('P2PText.react'),{type:'primary'},h._("{bank_name}\uff08\u7db2\u8def\u9280\u884c\uff09",[h.param('bank_name',s)])));case c('FBPaymentsMethodType').PAY_OVER_COUNTER:return (c('React').createElement(c('P2PText.react'),{type:'primary'},h._("\u5230\u5546\u5e97\u6ac3\u53f0\u4ed8\u6b3e")));default:return (c('React').createElement('div',null,r?r.toString():''));}}.bind(this),this.renderSelectorComponent=function(){return this.renderFormComponent();}.bind(this),m;}l.prototype.getTitle=function(){if(c('CurrentEnvironment').messengerdotcom)return h._("\u4ed8\u6b3e\u65b9\u5f0f");return h._("\u4ed8\u6b3e\u65b9\u5f0f");};l.prototype.render=function(){var m=this.props;return (c('React').createElement(c('P2PCheckoutConfigSection.react'),{hasOptions:!!m.confirmedPaymentMethod,showEditOptions:m.showEditOptions,showForm:m.showForm,onChangeClicked:m.onChangeClicked,renderFormComponent:this.renderFormComponent,renderSelectedRow:this.renderSelectedRow,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()}));};l.propTypes={confirmedPaymentMethod:k.shape(c('FBPaymentsPaymentMethodShape_DEPRECATED')),onChangeClicked:k.func.isRequired,onPaymentMethodConfigured:k.func.isRequired,onPaymentMethodSelected:k.func.isRequired,paymentMethods:k.arrayOf(c('FBPaymentsPaymentMethodShape_DEPRECATED')).isRequired,showEditOptions:k.bool,showForm:k.bool};f.exports=l;}),null);
__d('P2PPlatformContextBannerShape',['React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=h.shape({shouldShowToBuyer:h.bool,shouldShowToSeller:h.bool,shouldShowPayNux:h.bool});f.exports=i;}),null);
__d('P2PPlatformContextShippingOptionShape',['React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=h.shape({formattedShippingPrice:h.string,formattedSubtotal:h.string,formattedTax:h.string,formattedTotal:h.string,id:h.string,rawTotal:h.string,title:h.string});f.exports=i;}),null);
__d('P2PPlatformContextShape',['P2PPlatformContextBannerShape','P2PPlatformContextProductItemShape','P2PPlatformContextShippingOptionShape','React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=h.shape({id:h.string,banner:c('P2PPlatformContextBannerShape'),buyerID:h.string,product:c('P2PPlatformContextProductItemShape'),sellerID:h.string,shippingOptions:h.arrayOf(c('P2PPlatformContextShippingOptionShape'))});f.exports=i;}),null);
__d('P2PChooseShippingOptionForm.react',['cx','P2PPlatformContextShippingOptionShape','React','P2PText.react','XUIRadioList.react'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('XUIRadioList.react').Item,l=c('React').PropTypes;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=j.constructor).call.apply(o,[this].concat(q)),this.state={selectedValue:this.props.selectedShippingOption.id},this.handleChange=function(s){var t=this.props.shippingOptions.filter(function(u){return u.id===s;})[0];this.setState({selectedValue:t.id});this.props.onChange(t);}.bind(this),this.renderShippingOptionItem=function(s){return (c('React').createElement(k,{className:"_2i8o",key:s.id,value:s.id},c('React').createElement(c('P2PText.react'),{type:'primary'},s.title)));},this.getRadioListItems=function(){return this.props.shippingOptions.map(this.renderShippingOptionItem);}.bind(this),n;}m.prototype.render=function(){return (c('React').createElement(c('XUIRadioList.react'),{className:"_2i8p",onValueChange:this.handleChange,selectedValue:this.state.selectedValue},this.getRadioListItems()));};m.propTypes={shippingOptions:l.arrayOf(c('P2PPlatformContextShippingOptionShape')).isRequired,onChange:l.func.isRequired,selectedShippingOption:c('P2PPlatformContextShippingOptionShape')};f.exports=m;}),null);
__d('P2PShippingOptionsConfigSection.react',['fbt','CurrentEnvironment','P2PChooseShippingOptionForm.react','P2PPlatformContextShippingOptionShape','P2PCheckoutConfigSection.react','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return m=(n=j.constructor).call.apply(n,[this].concat(p)),this.renderSelectorComponent=function(){var r=this.props;return (c('React').createElement(c('P2PChooseShippingOptionForm.react'),{shippingOptions:r.shippingOptions,onChange:this.props.onShippingOptionSelected,selectedShippingOption:r.selectedShippingOption}));}.bind(this),this.getTitle=function(){if(c('CurrentEnvironment').messengerdotcom)return h._("\u51fa\u8ca8\u65b9\u5f0f\u9078\u9805");return h._("\u51fa\u8ca8\u65b9\u5f0f\u9078\u9805");},m;}l.prototype.render=function(){return (c('React').createElement(c('P2PCheckoutConfigSection.react'),{hasOptions:true,showEditOptions:true,showForm:false,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()}));};l.propTypes={onShippingOptionSelected:k.func.isRequired,selectedShippingOption:c('P2PPlatformContextShippingOptionShape'),shippingOptions:k.arrayOf(c('P2PPlatformContextShippingOptionShape'))};f.exports=l;}),null);
__d('P2PCheckoutDialog.react',['cx','csx','fbt','CommerceContactMerchantManualPaymentSection.react','CurrentEnvironment','CSS','DOMQuery','FBPaymentsLegalDisclaimer_DEPRECATED.react','FBPaymentsMethodType','P2PActions','P2PAddressConfigSection.react','P2PAddressShape','P2PButton.react','P2PCheckoutPriceDetails.react','P2PCreditCardConfigSection.react','P2PCreditCard','P2PDialog.react','P2PDialogBody.react','P2PDialogFooter.react','P2PDialogTitle.react','P2PLoadingMask.react','P2PPaymentMethodConfigSection.react','P2PPlatformContextShape','P2PPlatformContextShippingOptionShape','P2PPlatformProductItemDetails.react','P2PShippingOptionsConfigSection.react','React','immutable'],(function a(b,c,d,e,f,g,h,i,j){'use strict';if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=c('React').createClass({displayName:'P2PCheckoutDialog',propTypes:{acceptInternationalAddresses:k.bool,addresses:k.instanceOf(c('immutable').List).isRequired,addressFormData:k.object,addressFormValid:k.bool,addressSaveErrors:k.object,asyncPaymentDetails:k.object,buyer:k.object,configuredPaymentMethod:k.object,confirmedPaymentMethod:k.object,creditCardFormData:k.object,creditCardFormValid:k.bool,creditCardSaveErrors:k.object,creditCards:k.arrayOf(k.instanceOf(c('P2PCreditCard'))).isRequired,customCheckoutDetails:k.node,editingPaymentMethod:k.bool,paymentMethods:k.array,paymentProductType:k.string,initialDataLoaded:k.bool,onClose:k.func.isRequired,onCompleteManualPayment:k.func.isRequired,onConfirmSelectedPaymentMethod:k.func.isRequired,onPlaceOrder:k.func.isRequired,onSaveAddress:k.func.isRequired,onSaveCreditCard:k.func.isRequired,onSetAddress:k.func.isRequired,orderID:k.string,platformContext:c('P2PPlatformContextShape'),receiptAttached:k.bool,saving:k.bool,selectedAddress:c('P2PAddressShape'),selectedCreditCard:k.instanceOf(c('P2PCreditCard')),selectedPaymentMethod:k.object,selectedShippingOption:c('P2PPlatformContextShippingOptionShape'),showAddressEditOptions:k.bool,showAsyncPaymentDetails:k.bool,showCreditCardEditOptions:k.bool,showPaymentMethodEditOptions:k.bool,showAddressForm:k.bool,showCreditCardForm:k.bool,showPaymentMethodForm:k.bool,showTaxField:k.bool,shippingOptions:k.arrayOf(c('P2PPlatformContextShippingOptionShape')),usePaymentMethods:k.bool},_toggledCreditCard:null,_toggledAddress:null,handleToggle:function m(n){if(!n)this.props.onClose();this.cleanup();},handleCloseDialog:function m(){this.props.onClose();this.cleanup();},componentDidMount:function m(){setTimeout(function(){if(this.isMounted()){var n=c('DOMQuery').find(document,"div._ugr");if(n)c('CSS').addClass(n,"_225w");}}.bind(this),200);},getProductFromPlatformContext:function m(){var n=this.props.platformContext;return n?n.product:null;},renderPriceDetails:function m(){var n=this.getProductFromPlatformContext(),o=this.props.selectedShippingOption,p=void 0,q=void 0,r=void 0,s=void 0;if(n){p=n.formattedAmount;s=p;}if(o){p=o.formattedSubtotal;r=o.formattedShippingPrice;q=o.formattedTax;s=o.formattedTotal;}return (c('React').createElement(c('P2PCheckoutPriceDetails.react'),{shipping:r,subtotal:p,tax:q,total:s,showShippingField:!this.props.showAsyncPaymentDetails,showSubtotalField:!this.props.showAsyncPaymentDetails,showTaxField:this.props.showTaxField&&!this.props.showAsyncPaymentDetails}));},renderItemSection:function m(){var n=this.getProductFromPlatformContext();if(!n)return null;var o=void 0;if(this.props.customCheckoutDetails)o=c('React').createElement('div',{className:"_145w"},this.props.customCheckoutDetails);return (c('React').createElement('div',null,c('React').createElement('div',{className:"_4oyy"},c('React').createElement(c('P2PPlatformProductItemDetails.react'),{configSelections:this.props.configSelections,item:n,size:'medium'})),o,c('React').createElement('div',{className:"_4oz5"},this.renderPriceDetails())));},renderRightPanel:function m(){var n=!this.props.showAsyncPaymentDetails;return (c('React').createElement('div',{className:(n?"_4oz9":'')+(!n?' '+"_334":'')},n?this.renderConfigSection():this.renderAsyncPaymentDetailsSection(),this.renderDialogFooter()));},renderConfigSection:function m(){if(!this.props.initialDataLoaded)return null;var n=void 0,o=c('React').createElement('div',{className:"_4gf2",key:'addressConigSection'},c('React').createElement(c('P2PAddressConfigSection.react'),{acceptInternational:this.props.acceptInternationalAddresses,addresses:this.props.addresses,buyerName:this.props.buyer&&this.props.buyer.name,onAddressSelected:this.handleAddressSelected,onChangeClicked:this.handleAddressChangeClicked,onNewAddressSelected:this.handleNewAddressSelected,onValidation:this.handleAddressFormValidation,saveErrors:this.props.addressSaveErrors,selectedAddress:this.props.selectedAddress,showEditOptions:this.props.showAddressEditOptions,showForm:this.props.showAddressForm})),p=this.props.usePaymentMethods?c('React').createElement('div',{className:"_4gf2",key:'paymentMethodConfigSection'},c('React').createElement(c('P2PPaymentMethodConfigSection.react'),{confirmedPaymentMethod:this.props.confirmedPaymentMethod,onPaymentMethodConfigured:this.handlePaymentMethodConfigured,onPaymentMethodSelected:this.handlePaymentMethodSelected,onChangeClicked:this.handlePaymentMethodChangeClicked,paymentMethods:this.props.paymentMethods,showEditOptions:this.props.showPaymentMethodEditOptions,showForm:this.props.showPaymentMethodForm})):c('React').createElement('div',{className:"_4gf2",key:'creditCardConfigSection'},c('React').createElement(c('P2PCreditCardConfigSection.react'),{creditCards:this.props.creditCards,onCreditCardSelected:this.handleCreditCardSelected,onChangeClicked:this.handleCreditCardChangeClicked,onNewCreditCardSelected:this.handleNewCreditCardSelected,onValidation:this.handleCreditCardFormValidation,saveErrors:this.props.creditCardSaveErrors,selectedCreditCard:this.props.selectedCreditCard,showEditOptions:this.props.showCreditCardEditOptions,showForm:this.props.showCreditCardForm}));if(this.props.shippingOptions&&this.props.shippingOptions.length&&this.props.selectedShippingOption)n=c('React').createElement('div',{className:"_4gf2",key:'shippingConfigSection'},c('React').createElement(c('P2PShippingOptionsConfigSection.react'),{onShippingOptionSelected:this.handleShippingOptionSelected,shippingOptions:this.props.shippingOptions,selectedShippingOption:this.props.selectedShippingOption}));if(this.props.showAddressEditOptions||this.props.showAddressForm){p=null;n=null;}if(this.props.showPaymentMethodEditOptions||this.props.showCreditCardEditOptions){o=null;n=null;}return (c('React').createElement('div',null,o,n,p));},renderAsyncPaymentDetailsSection:function m(){var n=this.props.asyncPaymentDetails,o=this.props.orderID;if(!n||!o)return null;return (c('React').createElement(c('CommerceContactMerchantManualPaymentSection.react'),{bankAccountDetails:n.description,invoiceID:o,onReceiptUpdated:function p(q,r){c('P2PActions').checkoutManualPaymentReceiptUpdated({receiptFbid:q});}}));},renderDialogFooter:function m(){if(!this.props.initialDataLoaded)return null;var n=void 0,o=void 0,p=j._("\u53d6\u6d88"),q=j._("\u7e7c\u7e8c"),r=void 0;if(c('CurrentEnvironment').messengerdotcom)r=c('React').createElement(c('P2PButton.react'),{label:p,onClick:this.props.onClose});var s=this.props.editingPaymentMethod;if(s&&this.props.selectedPaymentMethod)switch(this.props.selectedPaymentMethod.type){case c('FBPaymentsMethodType').NEW_CREDIT_CARD:q=j._("\u65b0\u589e\u5361\u7247");break;case c('FBPaymentsMethodType').NET_BANKING:q=j._("\u78ba\u8a8d\u9280\u884c");break;}var t=this.props.showCreditCardEditOptions||s||this.props.showAddressEditOptions||this.props.showAddressForm;if(t){n=c('React').createElement('div',null,c('React').createElement(c('P2PButton.react'),{label:p,onClick:this.handleEditCancelClicked}),c('React').createElement(c('P2PButton.react'),{disabled:this.isSaveDisabled(),label:q,onClick:this.handleContinueClicked,use:'confirm'}));}else if(this.props.showAsyncPaymentDetails){n=c('React').createElement('div',null,c('React').createElement(c('P2PButton.react'),{disabled:!this.props.receiptAttached,label:j._("\u5b8c\u6210\u8cfc\u8cb7"),onClick:this.handleCompleteManualPaymentClicked,use:'confirm'}));}else{o=this.getLegalDisclaimerSection();n=c('React').createElement('div',{className:"_35cu"},r,c('React').createElement(c('P2PButton.react'),{className:this.props.usePaymentMethods?"_35cv":'',disabled:this.isSaveDisabled(),label:this.getCheckoutButtonLabel(),onClick:this.handlePlaceOrderClicked,use:'confirm'}));}return (c('React').createElement('div',{className:"_35cw"},c('React').createElement(c('P2PDialogFooter.react'),{className:"_ugq"+(t?' '+"_35cx":'')},o,n)));},isSaveDisabled:function m(){var n=this.props.configuredPaymentMethod&&this.props.configuredPaymentMethod.isValid&&this.isConfiguredPaymentMethodSelected();return (!!this.props.showCreditCardForm&&!this.props.creditCardFormValid||!!this.props.editingPaymentMethod&&!n||!!this.props.showAddressForm&&!this.props.addressFormValid);},isConfiguredPaymentMethodSelected:function m(){return (!!this.props.configuredPaymentMethod&&!!this.props.selectedPaymentMethod&&this.props.configuredPaymentMethod.type===this.props.selectedPaymentMethod.type);},getCheckoutButtonLabel:function m(){if(!this.props.usePaymentMethods)return j._("\u4e0b\u8a02\u55ae");var n=this.props.confirmedPaymentMethod,o=j._("\u5b8c\u6210\u8cfc\u8cb7");if(!n)return o;switch(n.type){case c('FBPaymentsMethodType').NET_BANKING:return j._("\u767b\u5165\u4e26\u4ed8\u6b3e");case c('FBPaymentsMethodType').GENERIC_CARD:return j._("\u4ed8\u6b3e");case c('FBPaymentsMethodType').PAY_OVER_COUNTER:return j._("\u7e7c\u7e8c\u4ed8\u6b3e");default:return o;}},getLegalDisclaimerSection:function m(){if(!this.props.usePaymentMethods||!this.props.confirmedPaymentMethod)return null;return (c('React').createElement('div',{className:"_35d1"},c('React').createElement(c('FBPaymentsLegalDisclaimer_DEPRECATED.react'),{paymentMethodType:this.props.confirmedPaymentMethod.type,paymentType:this.props.paymentProductType})));},handleShippingOptionSelected:function m(n){c('P2PActions').checkoutShippingOptionSelected(n.id);},handleCreditCardFormValidation:function m(n,o){c('P2PActions').checkoutCreditCardFormValidated(n,o);},handleCreditCardChangeClicked:function m(){c('P2PActions').checkoutCreditCardEditOptionsToggled(true);},handlePaymentMethodChangeClicked:function m(){c('P2PActions').checkoutPaymentMethodEditOptionsToggled(true);},handleCreditCardSelected:function m(n){this._toggledCreditCard=n;c('P2PActions').checkoutCreditCardFormToggled(false);},handleNewCreditCardSelected:function m(){c('P2PActions').addCreditCardErrorCleared();c('P2PActions').checkoutCreditCardFormToggled(true);},saveCreditCard:function m(){this.props.onSaveCreditCard();},handlePaymentMethodSelected:function m(n){c('P2PActions').checkoutPaymentMethodSelected(n);},handlePaymentMethodConfigured:function m(n){c('P2PActions').checkoutPaymentMethodConfigured(n);},handleAddressFormValidation:function m(n,o){c('P2PActions').checkoutAddressFormValidated(n,o);},handleAddressChangeClicked:function m(){c('P2PActions').checkoutAddressEditOptionsToggled(true);},handleAddressSelected:function m(n){this._toggledAddress=n;c('P2PActions').checkoutAddressFormToggled(false);},handleNewAddressSelected:function m(){c('P2PActions').addAddressErrorCleared();c('P2PActions').checkoutAddressFormToggled(true);},saveAddress:function m(){this.props.onSaveAddress();},handleEditCancelClicked:function m(){if(!this.props.addresses.count()||this.props.showPaymentMethodForm)this.props.onClose();this.cleanup();},cleanup:function m(){c('P2PActions').addCreditCardErrorCleared();c('P2PActions').addAddressErrorCleared();c('P2PActions').checkoutEditCompleted();},handleContinueClicked:function m(){var n=this._toggledAddress;if(this.props.showCreditCardForm){this.saveCreditCard();}else if(this.props.showAddressForm){this.saveAddress();}else if(this.props.showCreditCardEditOptions){if(this._toggledCreditCard){c('P2PActions').checkoutCreditCardSelected(this._toggledCreditCard.getCredentialId());this._toggledCreditCard=null;}else this.handleEditCancelClicked();}else if(this.props.editingPaymentMethod){if(this.isConfiguredPaymentMethodSelected())this.props.onConfirmSelectedPaymentMethod();}else if(this.props.showAddressEditOptions)if(n){c('P2PActions').checkoutAddressSelected(n.id);if(this.props.platformContext)this.props.onSetAddress(n.id);this._toggledAddress=null;}else this.handleEditCancelClicked();},handleCompleteManualPaymentClicked:function m(){this.props.onCompleteManualPayment();},handlePlaceOrderClicked:function m(){this.props.onPlaceOrder();},render:function m(){var n=void 0,o=c('CurrentEnvironment').messengerdotcom,p=o?720:680;if(!o)n=c('React').createElement(c('P2PDialogTitle.react'),null,j._("\u7d50\u5e33"));return (c('React').createElement(c('P2PDialog.react'),{className:"_ugr",hideOnEscape:true,layerHideOnBlur:o,onToggle:this.handleToggle,repositionOnUpdate:true,shown:true,width:p},n,c('React').createElement(c('P2PDialogBody.react'),{className:"_4oz6"+(this.props.initialDataLoaded?' '+"_3t72":'')},c('React').createElement('div',{className:"_4oz7"},c('React').createElement('div',{className:"_4oz8"},this.renderItemSection()),this.renderRightPanel()),c('React').createElement(c('P2PLoadingMask.react'),{visible:!this.props.initialDataLoaded||this.props.saving}))));}});f.exports=l;}),null);
__d('P2PPaymentMethodStore',['P2PActionConstants','CreditCardFormParam','EventEmitter','FBPaymentsMethodType','Map','P2PAPI','P2PCreditCard','P2PDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('EventEmitter'));i=h&&h.prototype;function j(){i.constructor.call(this);this.$P2PPaymentMethodStore1=c('P2PDispatcher').register(this.onEventDispatched.bind(this));this.$P2PPaymentMethodStore2=new (c('Map'))();this.$P2PPaymentMethodStore3=new (c('Map'))();this.$P2PPaymentMethodStore4=new (c('Map'))();}j.prototype.onEventDispatched=function(k){var l=k.data,m=k.type;switch(m){case c('P2PActionConstants').PAYMENT_METHODS_UPDATED:this.handlePaymentMethodsUpdated(l);this.emit('change');break;case c('P2PActionConstants').PAYMENT_METHODS_UPDATED_ERROR:this.handlePaymentMethodsUpdatedError(l);this.emit('change');}};j.prototype.handlePaymentMethodsUpdated=function(k){var l=k.id,m=k.paymentMethodsData,n=m.available_payment_methods_details,o=m.existing_payment_methods;if(o){o=o.map(function(p){var q=p.data;q[c('CreditCardFormParam').CARD_NUMBER]=p.data.ccNumber;q[c('CreditCardFormParam').CREDENTIAL_ID]=p.id;return {creditCard:new (c('P2PCreditCard'))(q),type:c('FBPaymentsMethodType').GENERIC_CARD};});n=o.concat(n);}this.$P2PPaymentMethodStore3['delete'](l);this.$P2PPaymentMethodStore2.set(l,n);this.$P2PPaymentMethodStore4.set(l,o[0]);};j.prototype.handlePaymentMethodsUpdatedError=function(k){this.$P2PPaymentMethodStore3.set(k.id,k.error);};j.prototype.getPaymentMethodsForInvoice=function(k,l){if(!this.$P2PPaymentMethodStore2.has(l)){c('P2PAPI').getPaymentMethods({id:l,payment_type:k,extra_data:{invoice_id:l}});this.$P2PPaymentMethodStore2.set(l,null);}return this.$P2PPaymentMethodStore2.get(l);};j.prototype.getPreviousPaymentMethod=function(k){if(k&&this.$P2PPaymentMethodStore4.has(k))return this.$P2PPaymentMethodStore4.get(k);return null;};j.prototype.getDispatchToken=function(){return this.$P2PPaymentMethodStore1;};j.prototype.failedPaymentMethodsFetch=function(k){return this.$P2PPaymentMethodStore3.has(k);};j.prototype.getPaymentMethodsFetchError=function(k){return this.$P2PPaymentMethodStore3.get(k);};f.exports=new j();}),null);
__d('P2PPlatformContextStore',['Arbiter','ChannelConstants','CurrentUser','EventEmitter','ImmutableObject','Map','MercuryIDs','P2PActions','P2PActionConstants','P2PAPI','P2PChannelType','P2PDispatcher'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=new (c('Map'))(),k=new (c('Map'))(),l=void 0;h=babelHelpers.inherits(m,c('EventEmitter'));i=h&&h.prototype;function m(){i.constructor.call(this);l=c('P2PDispatcher').register(this.onEventDispatched.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType(c('P2PChannelType').PLATFORM_CONTEXT_NEW),this.handleChannelUpdated.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType(c('P2PChannelType').PLATFORM_CONTEXT_ELIGIBLE_ITEM_UPDATED),this.handleChannelChanged.bind(this));c('Arbiter').subscribe(c('ChannelConstants').getArbiterType(c('P2PChannelType').PLATFORM_CONTEXT_DISMISSED),this.handleChannelChanged.bind(this));}m.prototype.onEventDispatched=function(n){var o=n.type,p=n.data;switch(o){case c('P2PActionConstants').PLATFORM_CONTEXT_ADDED:this.handlePlatformContextAdded(p);this.emit('change');break;case c('P2PActionConstants').PLATFORM_CONTEXT_ADDED_ERROR:this.handlePlatformContextAddedError(p);this.emit('change');break;case c('P2PActionConstants').PLATFORM_CONTEXT_SAVE_ERRORS_CLEARED:this.handlePlatformContextSaveErrorsCleared(p);this.emit('change');break;case c('P2PActionConstants').PLATFORM_CONTEXT_BANNER_DISMISSED:this.handlePlatformContextBannerDisimssed(p);this.emit('change');break;case c('P2PActionConstants').PLATFORM_CONTEXT_PRODUCT_ITEM_SOLD:this.handlePlatformContextProductItemSold(p);this.emit('change');break;case c('P2PActionConstants').PLATFORM_CONTEXT_CHANGED:this.handlePlatformContextChanged(p);this.emit('change');break;}};m.prototype.handleChannelUpdated=function(n,o){var p=o.obj;c('P2PActions').addPlatformContext(p);};m.prototype.handleChannelChanged=function(n,o){var p=o.obj;c('P2PActions').platformContextChanged(p);};m.prototype.handlePlatformContextAdded=function(n){this.setPlatformContext(n);};m.prototype.handlePlatformContextAddedError=function(n){k.set(n.itemID,n.error);};m.prototype.handlePlatformContextSaveErrorsCleared=function(n){k['delete'](n);};m.prototype.handlePlatformContextChanged=function(n){j.forEach(function(o,p){if(o.id===n.id)this.setPlatformContext(n);}.bind(this));};m.prototype.handlePlatformContextBannerDisimssed=function(n){j.forEach(function(o,p){if(o.id===n){if(this.isViewerSellerForPlatformContext(o)){o=c('ImmutableObject').set(o,{banner:c('ImmutableObject').set(o.banner,{shouldShowToSeller:false})});}else if(this.isViewerBuyerForPlatformContext(o))o=c('ImmutableObject').set(o,{banner:c('ImmutableObject').set(o.banner,{shouldShowToBuyer:false})});j.set(p,o);}}.bind(this));};m.prototype.handlePlatformContextProductItemSold=function(n){j.forEach(function(o,p){if(o.id===n){o=c('ImmutableObject').set(o,{product:c('ImmutableObject').set(o.product,{isAvailable:false})});j.set(p,o);}});};m.prototype.setPlatformContext=function(n){var o=new (c('ImmutableObject'))(n);o=c('ImmutableObject').set(o,{product:new (c('ImmutableObject'))(n.product)});o=c('ImmutableObject').set(o,{banner:new (c('ImmutableObject'))(n.banner)});j.set(this.getOtherUserIDForPlatformContext(n),o);};m.prototype.shouldShowBanner=function(n){var o=void 0,p=void 0;if(!n)return false;o=this.getPlatformContextByOtherUserID(n);if(!o){j.set(n,new (c('ImmutableObject'))({}));c('P2PAPI').getPlatformContextByOtherUserID({otherUserID:n});return false;}p=o.banner;return !!(this.isViewerSellerForPlatformContext(o)&&p.shouldShowToSeller||this.isViewerBuyerForPlatformContext(o)&&p.shouldShowToBuyer);};m.prototype.isViewerSellerForPlatformContext=function(n){return n.sellerID===c('CurrentUser').getID();};m.prototype.isViewerBuyerForPlatformContext=function(n){return n.buyerID===c('CurrentUser').getID();};m.prototype.getOtherUserIDForPlatformContext=function(n){return (this.isViewerSellerForPlatformContext(n)?n.buyerID:n.sellerID);};m.prototype.getPlatformContextByOtherUserID=function(n){return j.get(n);};m.prototype.getPlatformContextByID=function(n){for(var o=j.values(),p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var r;if(p){if(q>=o.length)break;r=o[q++];}else{q=o.next();if(q.done)break;r=q.value;}var s=r;if(s.id===n)return s;}return null;};m.prototype.getThreadIDFromPlatformContext=function(n){var o=this.getOtherUserIDForPlatformContext(n);return c('MercuryIDs').getThreadIDFromUserID(o);};m.prototype.getSaveError=function(n){return k.get(n);};m.prototype.getDispatchToken=function(){return l;};f.exports=new m();}),null);
__d('P2PCheckoutStore',['P2PActionConstants','CreditCardFormParam','EventEmitter','ImmutableObject','MessengerPaymentProductType','P2PAddressStore','P2PAPI','P2PCreditCard','P2PCreditCardStore','P2PDispatcher','P2PPaymentMethodStore','P2PPlatformContextStore'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=null,k=null,l=false,m=false,n=false,o=false,p=false,q=false,r=false,s=null,t=false,u=null,v=false,w=null,x=null,y=false,z=null,aa=null,ba=null,ca=null,da=null,ea=false,fa=null;h=babelHelpers.inherits(ga,c('EventEmitter'));i=h&&h.prototype;function ga(){i.constructor.call(this);this.$P2PCheckoutStore1=c('P2PDispatcher').register(this.onEventDispatched.bind(this));}ga.prototype.getDispatchToken=function(){return this.$P2PCheckoutStore1;};ga.prototype.onEventDispatched=function(ha){var ia=ha.data,ja=ha.type;c('P2PDispatcher').waitFor([c('P2PAddressStore').getDispatchToken(),c('P2PCreditCardStore').getDispatchToken(),c('P2PPlatformContextStore').getDispatchToken()]);switch(ja){case c('P2PActionConstants').CREDIT_CARD_UPDATED:case c('P2PActionConstants').CREDIT_CARD_VERIFIED:this.handleCreditCardUpdated(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_CART_INITIATED:this.handleCheckoutCartInitiated();this.emit('change');break;case c('P2PActionConstants').CHECKOUT_CART_CREATED:this.handleCheckoutCartCreated(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_ADDRESS_SELECTED:this.handleAddressSelected(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_SHIPPING_OPTION_SELECTED:this.handleShippingOptionSelected(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_CREDIT_CARD_SELECTED:this.handleCreditCardSelected(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_ADDRESS_FORM_TOGGLED:this.handleAddressFormToggled(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_CREDIT_CARD_FORM_TOGGLED:this.handleCreditCardFormToggled(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_ADDRESS_EDIT_OPTIONS_TOGGLED:this.handleAddressEditOptionsToggled(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_CREDIT_CARD_EDIT_OPTIONS_TOGGLED:this.handleCreditCardEditOptionsToggled(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_PAYMENT_METHOD_EDIT_OPTIONS_TOGGLED:this.handlePaymentMethodEditOptionsToggled(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_PAYMENT_METHOD_CONFIGURED:this.handlePaymentMethodConfigured(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_PAYMENT_METHOD_CONFIRMED:this.handlePaymentMethodConfirmed(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_PAYMENT_METHOD_SELECTED:this.handlePaymentMethodSelected(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_ADDRESS_FORM_VALIDATED:this.handleAddressFormValidated(ia.isValid,ia.formData);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_CREDIT_CARD_FORM_VALIDATED:this.handleCreditCardFormValidated(ia.isValid,ia.formData);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_EDIT_COMPLETED:this.handleCheckoutEditCompleted();this.emit('change');break;case c('P2PActionConstants').CHECKOUT_PROCESSING:this.handleCheckoutProcessing(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_BUYER_PROFILE_UPDATED:this.handleCheckoutBuyerProfileUpdated(ia);this.emit('change');break;case c('P2PActionConstants').CHECKOUT_MANUAL_PAYMENT_RECEIPT_UPDATED:this.handleManualPaymentReceiptUpdated(ia);this.emit('change');break;}};ga.prototype.handleCreditCardUpdated=function(ha){var ia=this.getSelectedCreditCard();if(ia&&ia.getCredentialId()===ha[c('CreditCardFormParam').CREDENTIAL_ID])k=c('P2PCreditCardStore').getCreditCardByCredentialID(ia.getCredentialId());};ga.prototype.handleCheckoutCartInitiated=function(){w=null;da=null;ba=null;j=null;x=null;fa=null;ea=false;};ga.prototype.handleCheckoutCartCreated=function(ha){w=ha.sellerID;da=ha.invoiceID;ea=!!ha.acceptInternationalAddresses;};ga.prototype.handleCheckoutProcessing=function(ha){v=ha;};ga.prototype.handleAddressSelected=function(ha){var ia=c('P2PAddressStore').getAll(!ea),ja=ia.find(function(ka){return ka.id===ha;});j=ja;x=null;this.handleCheckoutEditCompleted();};ga.prototype.handleShippingOptionSelected=function(ha){var ia=this.getPlatformContext(),ja=ia&&ia.shipping&&ia.shipping.shippingOptions,ka=void 0;if(ja)ka=ja.filter(function(la){return la.id===ha;})[0];x=ka;};ga.prototype.handleCreditCardSelected=function(ha){var ia=c('P2PCreditCardStore').getAll(c('MessengerPaymentProductType').MESSENGER_COMMERCE),ja=ia.filter(function(ka){return ka.getCredentialId()===ha;})[0];k=ja;this.handleCheckoutEditCompleted();};ga.prototype.handleAddressFormToggled=function(ha){l=ha;this.handleAddressFormValidated(false,null);};ga.prototype.handleCreditCardFormToggled=function(ha){m=ha;this.handleCreditCardFormValidated(false,null);};ga.prototype.handlePaymentMethodFormToggled=function(ha){n=ha;};ga.prototype.handleAddressEditOptionsToggled=function(ha){o=ha;};ga.prototype.handleAddressFormValidated=function(ha,ia){r=ha;s=ia;};ga.prototype.handleCreditCardFormValidated=function(ha,ia){t=ha;u=ia;};ga.prototype.handleCheckoutEditCompleted=function(){this.handleAddressFormValidated(false,null);this.handleAddressEditOptionsToggled(false);this.handleAddressFormToggled(false);this.handleCreditCardFormValidated(false,null);this.handleCreditCardEditOptionsToggled(false);this.handleCreditCardFormToggled(false);this.handlePaymentMethodSelected(null);this.handlePaymentMethodConfigured(null);this.handlePaymentMethodFormToggled(false);this.handlePaymentMethodEditOptionsToggled(false);};ga.prototype.handleCreditCardEditOptionsToggled=function(ha){p=ha;};ga.prototype.handlePaymentMethodEditOptionsToggled=function(ha){q=ha;};ga.prototype.handleCheckoutBuyerProfileUpdated=function(ha){z=ha;y=true;};ga.prototype.handleManualPaymentReceiptUpdated=function(ha){fa=ha.receiptFbid;};ga.prototype.handlePaymentMethodConfigured=function(ha){aa=ha;};ga.prototype.handlePaymentMethodConfirmed=function(ha){ba=ha;this.handleCheckoutEditCompleted();};ga.prototype.handlePaymentMethodSelected=function(ha){ca=ha;};ga.prototype.isAddressFormShown=function(){return !c('P2PAddressStore').getAll(!ea).count()||l;};ga.prototype.isCreditCardFormShown=function(){var ha=c('P2PCreditCardStore').getAll(c('MessengerPaymentProductType').MESSENGER_COMMERCE);return (!this.isAddressFormShown()&&(!ha.length||m));};ga.prototype.isPaymentMethodFormShown=function(){var ha=!this.isAddressFormShown()&&(!this.getConfirmedPaymentMethod()||n);return ha;};ga.prototype.isAddressEditOptionsShown=function(){return o;};ga.prototype.isCreditCardEditOptionsShown=function(){return p;};ga.prototype.isPaymentMethodEditOptionsShown=function(){return q;};ga.prototype.isEditingPaymentMethod=function(){return this.isPaymentMethodFormShown()||this.isPaymentMethodEditOptionsShown();};ga.prototype.getConfirmedPaymentMethod=function(){return ba||c('P2PPaymentMethodStore').getPreviousPaymentMethod(this.getInvoiceID());};ga.prototype.getConfiguredPaymentMethod=function(){return aa;};ga.prototype.getSelectedPaymentMethod=function(){return ca;};ga.prototype.getAttachedReceiptFbid=function(){return fa;};ga.prototype.getSelectedAddress=function(){var ha=this.getPlatformContext(),ia=c('P2PAddressStore').getAll(!ea),ja=void 0;if(j)return j;if(ha&&ha.shipping&&ha.shipping.selectedShippingAddressID){ja=ia.find(function(ka){return (ha&&ka.id===ha.shipping.selectedShippingAddressID);});if(ja)return ja;}return ia.first();};ga.prototype.getSelectedShippingOption=function(){var ha=this.getPlatformContext(),ia=ha&&ha.shipping,ja=ia&&ia.selectedShippingOptionID,ka=ia&&ia.shippingOptions,la=void 0;if(x)return x;if(ka&&ka.length){la=ka.filter(function(ma){return ma.id===ja;})[0];if(la)return la;}return ka&&ka[0];};ga.prototype.getSelectedCreditCard=function(){var ha=c('P2PCreditCardStore').getAll(c('MessengerPaymentProductType').MESSENGER_COMMERCE);return k||ha[0];};ga.prototype.isAddressFormValid=function(){return r;};ga.prototype.getAddressFormData=function(){return s;};ga.prototype.isCreditCardFormValid=function(){return t;};ga.prototype.getCreditCardFormData=function(){return u;};ga.prototype.isProcessing=function(){return v;};ga.prototype.isBuyerProfileFetchComplete=function(){return y;};ga.prototype.getPlatformContext=function(){if(w)return c('P2PPlatformContextStore').getPlatformContextByOtherUserID(w);};ga.prototype.getInvoiceID=function(){return da;};ga.prototype.getPlaceOrderFormData=function(){var ha=this.getPlatformContext(),ia=this.getSelectedShippingOption(),ja=this.getSelectedAddress(),ka=this.getSelectedCreditCard(),la=c('CreditCardFormParam').CREDENTIAL_ID,ma={};ma[la]=ka&&ka.getCredentialId();ma=babelHelpers['extends']({},ma,{amount:ia&&ia.rawTotal,platform_context_id:ha&&ha.id,receiverId:ha&&ha.sellerID,shippingAddressID:ja&&ja.id,shippingOptionID:ia&&ia.id});return ma;};ga.prototype.getBuyerProfileData=function(){if(z)return z;z={};c('P2PAPI').getCurrentUserProfileData();};f.exports=new ga();}),null);
__d('P2PCheckoutDialogContainer.react',['fbt','invariant','Arbiter','FBPaymentsCreditCardVerificationDialog_DEPRECATED.react','FBPaymentsMethodType','Link.react','P2PActions','P2PAPI','P2PAPIUtils','P2PAddressStore','P2PCreditCardStore','P2PCheckoutDialog.react','P2PCheckoutStore','P2PDispatcher','P2PEditCreditCardDialog.react','P2PErrorDialog.react','P2PLogger','P2PPasswordProtectionNUXDialog.react','P2PPasswordProtectionStatusTypes','P2PPaymentLoggerEvent','P2PPaymentLoggerEventFlow','P2PPlatformContextShape','P2PSuccessDialog.react','P2PText.react','P2PVerifyCreditCardDialog.react','React','ReactLayeredComponentMixin_DEPRECATED','StoreAndPropBasedStateMixin'],(function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes,k='fbpay_login_and_pay',l='about:blank',m=c('React').createClass({displayName:'P2PCheckoutDialogContainer',mixins:[c('ReactLayeredComponentMixin_DEPRECATED'),c('StoreAndPropBasedStateMixin')(c('P2PAddressStore'),c('P2PCheckoutStore'),c('P2PCreditCardStore'))],propTypes:{acceptInternationalAddresses:j.bool,asyncPaymentDetails:j.object,onClose:j.func.isRequired,onSeeReceiptClick:j.func,configSelections:j.string,customCheckoutDetails:j.node,paymentMethods:j.array,paymentMethodsFetchError:j.object,paymentProductType:j.string,platformContext:c('P2PPlatformContextShape'),platformContextSaveError:j.object,productItemID:j.string,showAsyncPaymentDetails:j.bool,showTaxField:j.bool,usePaymentMethods:j.bool},getInitialState:function n(){return {creditCardVerificationDialogShown:false,editCreditCardDialogShown:false,openedWindow:null,passwordProtectionNUXShown:false,successDialogShown:false,transferError:null,verifyCreditCardDialogShown:false};},statics:{calculateState:function n(o){return {addresses:c('P2PAddressStore').getAll(!o.acceptInternationalAddresses),addressFormData:c('P2PCheckoutStore').getAddressFormData(),addressFormValid:c('P2PCheckoutStore').isAddressFormValid(),addressSaveErrors:c('P2PAddressStore').getSaveErrors(),buyer:c('P2PCheckoutStore').getBuyerProfileData(),configuredPaymentMethod:c('P2PCheckoutStore').getConfiguredPaymentMethod(),confirmedPaymentMethod:c('P2PCheckoutStore').getConfirmedPaymentMethod(),creditCardAsyncRequestState:c('P2PCreditCardStore').getAsyncRequestState(),creditCardFormData:c('P2PCheckoutStore').getCreditCardFormData(),creditCardFormValid:c('P2PCheckoutStore').isCreditCardFormValid(),creditCards:c('P2PCreditCardStore').getAll(o.paymentProductType),creditCardSaveErrors:c('P2PCreditCardStore').getSaveErrors(),editingPaymentMethod:c('P2PCheckoutStore').isEditingPaymentMethod()&&o.usePaymentMethods,initialDataLoaded:o.platformContext&&(!!o.asyncPaymentDetails||c('P2PAddressStore').isAddressesFetchComplete()&&c('P2PCreditCardStore').isCreditCardsFetchComplete()&&c('P2PCheckoutStore').isBuyerProfileFetchComplete()&&(!o.usePaymentMethods||!!o.paymentMethods)),orderID:c('P2PCheckoutStore').getInvoiceID(),receiptAttached:!!c('P2PCheckoutStore').getAttachedReceiptFbid(),saving:c('P2PCheckoutStore').isProcessing()||c('P2PCreditCardStore').isSaving()||c('P2PAddressStore').isSaving(),selectedAddress:c('P2PCheckoutStore').getSelectedAddress(),selectedCreditCard:c('P2PCheckoutStore').getSelectedCreditCard(),selectedPaymentMethod:c('P2PCheckoutStore').getSelectedPaymentMethod(),selectedShippingOption:c('P2PCheckoutStore').getSelectedShippingOption(),shippingOptions:o.platformContext&&o.platformContext.shipping?o.platformContext.shipping.shippingOptions:null,showAddressForm:c('P2PCheckoutStore').isAddressFormShown(),showCreditCardForm:c('P2PCheckoutStore').isCreditCardFormShown()&&!o.usePaymentMethods,showAddressEditOptions:c('P2PCheckoutStore').isAddressEditOptionsShown(),showCreditCardEditOptions:c('P2PCheckoutStore').isCreditCardEditOptionsShown()&&!o.usePaymentMethods,showPaymentMethodEditOptions:c('P2PCheckoutStore').isPaymentMethodEditOptionsShown()&&o.usePaymentMethods,showPaymentMethodForm:c('P2PCheckoutStore').isPaymentMethodFormShown()&&o.usePaymentMethods};}},_paymentMethodAddCardRequestId:'',componentWillMount:function n(){this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_CHECKOUT);c('P2PDispatcher').explicitlyRegisterStores([c('P2PCheckoutStore')]);},componentWillUnmount:function n(){if(this._passwordCancelSubscribeToken!==null){c('Arbiter').unsubscribe(this._passwordCancelSubscribeToken);this._passwordCancelSubscribeToken=null;}},componentDidUpdate:function n(o,p){this._trackEvents(o,p);},log:function n(o,p){var q=this.props.platformContext,r={};if(q)r=q.product.rawAmount;c('P2PLogger').log(o,babelHelpers['extends']({www_event_flow:c('P2PPaymentLoggerEventFlow').UI_FLOW_CHECKOUT,raw_amount:r.amount,currency:r.currency,object_id:this.props.productItemID},p));},_placeOrderPending:false,_passwordCancelSubscribeToken:null,_passwordProtectionNUXPending:false,handleCancel:function n(){this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CHECKOUT_CANCEL);this.props.onClose();},handleSuccess:function n(){this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CHECKOUT_SUCCESS);this.props.onClose();},handleSaveAddress:function n(){this.saveAddress();},closeOpenedWindow:function n(){this.state.openedWindow&&this.state.openedWindow.close();},saveAddress:function n(){c('P2PAPI').addAddress(babelHelpers['extends']({},this.state.addressFormData,{platformContext:this.props.platformContext,onSuccess:this.handleSaveAddressSuccess,onError:this.handleSaveAddressError}));this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CONFIRM_ADDRESS_DETAILS);},handleSaveAddressSuccess:function n(){this.log(c('P2PPaymentLoggerEvent').UI_ACTN_ADD_ADDRESS_SUCCESS);},handleSaveAddressError:function n(o){o=o.errors;this.log(c('P2PPaymentLoggerEvent').UI_ACTN_ADD_ADDRESS_FAIL,{message:o&&o.general?o.general.message:''});},handleSaveCreditCard:function n(){this.saveCreditCard();},saveCreditCard:function n(){c('P2PAPI').addCreditCard(babelHelpers['extends']({product_type:this.props.paymentProductType},this.state.creditCardFormData,{hasPlatformContext:!!this.props.platformContext,onSuccess:this.handleSaveCreditCardSuccess,onError:this.handleSaveCreditCardError}));this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CONFIRM_CARD_DETAILS);},handleSaveCreditCardSuccess:function n(){if(this._placeOrderPending){this._placeOrderPending=false;this.placeOrder();}this.log(c('P2PPaymentLoggerEvent').UI_ACTN_ADD_CARD_SUCCESS);},handleSaveCreditCardError:function n(o){o=o.errors;this.log(c('P2PPaymentLoggerEvent').UI_ACTN_ADD_CARD_FAIL,{message:o&&o.general?o.general.message:''});},handleConfirmPaymentMethod:function n(){var o=this.state.configuredPaymentMethod;switch(o.type){case c('FBPaymentsMethodType').NEW_CREDIT_CARD:var p=c('P2PAPIUtils').genRequestID();this._paymentMethodAddCardRequestId=p;c('P2PAPI').addCreditCard(babelHelpers['extends']({product_type:this.props.paymentProductType,requestID:p},o.formData,{hasPlatformContext:!!this.props.platformContext,onSuccess:this.handleConfirmPaymentMethodSuccess}));break;case c('FBPaymentsMethodType').GENERIC_CARD:case c('FBPaymentsMethodType').PAY_OVER_COUNTER:case c('FBPaymentsMethodType').MANUAL_TRANSFER:case c('FBPaymentsMethodType').NET_BANKING:this.handleConfirmPaymentMethodSuccess();break;}},handleConfirmPaymentMethodSuccess:function n(){var o=this.state.configuredPaymentMethod;switch(o.type){case c('FBPaymentsMethodType').NEW_CREDIT_CARD:this.handleConfirmPaymentMethodAddCardSuccess();break;default:c('P2PActions').checkoutPaymentMethodConfirmed(o);}},handleConfirmPaymentMethodAddCardSuccess:function n(){var o=c('P2PCreditCardStore').getAsyncRequestState(),p=o[this._paymentMethodAddCardRequestId];if(!p)return;var q=c('P2PCreditCardStore').getCreditCardByCredentialID(p.credential_id),r={creditCard:q,type:c('FBPaymentsMethodType').GENERIC_CARD};this._paymentMethodAddCardRequestId='';c('P2PActions').checkoutPaymentMethodConfirmed(r);},handlePlaceOrder:function n(){if(this.props.usePaymentMethods){this.completePaymentMethodCheckout();return;}if(this.state.showCreditCardForm){this._placeOrderPending=true;this.saveCreditCard();}else this.placeOrderWithExistingCard();},handleCompleteManualPayment:function n(){var o=this.state.orderID,p=this.props.asyncPaymentDetails&&this.props.asyncPaymentDetails.id;!(o&&p)?i(0):void 0;c('P2PAPI').completeReceiptUploadCheckout({onSuccess:function(){this.setState({successDialogShown:true});}.bind(this),onError:function(q){this.setState({transferError:q});}.bind(this),receiptImageID:c('P2PCheckoutStore').getAttachedReceiptFbid(),invoiceID:o,selectedPaymentOptionID:p});},placeOrderWithExistingCard:function n(){var o=c('P2PCheckoutStore').getSelectedCreditCard();!o?i(0):void 0;if(!o.getIsVerified()){this.setState({verifyCreditCardDialogShown:true});return;}else if(o.isExpired()){this.setState({editCreditCardDialogShown:true});return;}this.placeOrder();},placeOrder:function n(){c('P2PActions').checkoutProcessing(true);this.setState({transferError:null});this._passwordCancelSubscribeToken=c('Arbiter').subscribeOnce('PasswordReauthDialogCancelClick',function(){this._passwordCancelSubscribeToken=null;c('P2PActions').checkoutProcessing(false);}.bind(this));c('P2PAPI').createTransaction({error:this.handlePlaceOrderError,formData:c('P2PCheckoutStore').getPlaceOrderFormData(),success:this.handlePlaceOrderSuccess});this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CHECKOUT_CONFIRM);},handlePlaceOrderError:function n(o){c('P2PActions').checkoutProcessing(false);this.setState({transferError:o});},handlePlaceOrderSuccess:function n(o){c('P2PActions').checkoutProcessing(false);var p=o.passwordProtection===c('P2PPasswordProtectionStatusTypes').NOT_SET;if(p){this.setState({passwordProtectionNUXShown:true});}else this.handleSuccess();},completePaymentMethodCheckout:function n(){var o=this.state.confirmedPaymentMethod;switch(o.type){case c('FBPaymentsMethodType').NET_BANKING:case c('FBPaymentsMethodType').PAY_OVER_COUNTER:var p=window.open(l,k);this.setState({openedWindow:p});break;case c('FBPaymentsMethodType').GENERIC_CARD:if(o.creditCard.getCSC()){this.completeNMORCheckout({securityCode:o.creditCard.getCSC()});}else this.setState({creditCardVerificationDialogShown:true});return;}this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CHECKOUT_CONFIRM);this.completeNMORCheckout();},completeNMORCheckout:function n(o){var p=this.props.platformContext;!p?i(0):void 0;var q=this.state.confirmedPaymentMethod;!q?i(0):void 0;var r=q.type,s=null,t=null;switch(r){case c('FBPaymentsMethodType').GENERIC_CARD:r='cc';t=q.creditCard.getCredentialId();!(o&&o.securityCode)?i(0):void 0;break;case c('FBPaymentsMethodType').NET_BANKING:s={bank_code:q.bank.code};break;case c('FBPaymentsMethodType').MANUAL_TRANSFER:s={receipt_image_id:q.receiptFbid,transfer_option_id:q.optionId};break;}var u=babelHelpers['extends']({amount:this.state.selectedShippingOption.rawTotal,currency:p.product.rawAmount.currency,nmorOrderType:this.props.paymentProductType,receiverID:p.sellerID,orderID:this.state.orderID,paymentMethodType:r,paymentMethodData:s,credentialId:t,shippingAddressID:this.state.selectedAddress.id,shippingOptionID:this.state.selectedShippingOption.id,error:this.handleCompletePaymentMethodCheckoutError,success:this.handleCompletePaymentMethodCheckoutSuccess},o);c('P2PActions').checkoutProcessing(true);c('P2PAPI').completeNMORCheckout(u);},handleCreditCardVerificationCancel:function n(){this.setState({creditCardVerificationDialogShown:false});},handleVerifyCreditCardAndCompleteCheckout:function n(o){this.completeNMORCheckout({securityCode:o});},handleCompletePaymentMethodCheckoutError:function n(o){c('P2PActions').checkoutProcessing(false);this.setState({transferError:o});this.closeOpenedWindow();},handleCompletePaymentMethodCheckoutSuccess:function n(o,p){c('P2PActions').checkoutProcessing(false);this.setState({creditCardVerificationDialogShown:false});var q=this.state.confirmedPaymentMethod;switch(q.type){case c('FBPaymentsMethodType').NET_BANKING:!(p&&p.net_banking_info)?i(0):void 0;var r=p.net_banking_info.redirect_url;window.open(r,k);this.handleSuccess();break;case c('FBPaymentsMethodType').PAY_OVER_COUNTER:!(p&&p.pay_over_counter_info)?i(0):void 0;var s=p.pay_over_counter_info.instructions_url;window.open(s,k);this.handleSuccess();break;case c('FBPaymentsMethodType').MANUAL_TRANSFER:this.handleSuccess();break;default:this.setState({successDialogShown:true});}},handleSetAddress:function n(o){var p=this.props.platformContext;!p?i(0):void 0;c('P2PAPI').setPlatformContextShippingAddress({platformContextID:p.id,shippingAddressID:o});},renderLayers:function n(){var o={};if(this.props.platformContextSaveError){o.error=c('React').createElement(c('P2PErrorDialog.react'),{title:h._("\u8cfc\u8cb7\u767c\u751f\u554f\u984c"),onOKClick:this.handleCancel,error:this.props.platformContextSaveError});}else if(this.props.paymentMethodsFetchError){o.error=c('React').createElement(c('P2PErrorDialog.react'),{title:h._("\u5f88\u62b1\u6b49\uff0c\u6709\u4e9b\u5730\u65b9\u51fa\u932f\u4e86"),onOKClick:this.handleCancel,error:h._("\u6211\u5011\u76ee\u524d\u7121\u6cd5\u8f09\u5165\u53ef\u7528\u7684\u4ed8\u6b3e\u65b9\u5f0f\uff0c\u8acb\u7a0d\u5f8c\u518d\u8a66\u3002")});}else if(this.state.transferError){o.error=c('React').createElement(c('P2PErrorDialog.react'),{title:h._("\u8cfc\u8cb7\u767c\u751f\u554f\u984c"),onOKClick:this.handleCancel,error:this.state.transferError});}else if(this.state.verifyCreditCardDialogShown){o.verificationDialog=c('React').createElement(c('P2PVerifyCreditCardDialog.react'),{creditCard:this.state.selectedCreditCard,asyncRequestState:this.state.creditCardAsyncRequestState,isSending:true,onCancel:function(){this.setState({verifyCreditCardDialogShown:false});c('P2PActions').checkoutProcessing(false);}.bind(this),onSuccess:function(){this.setState({verifyCreditCardDialogShown:false});this.placeOrderWithExistingCard();}.bind(this)});}else if(this.state.editCreditCardDialogShown)o.editCreditCardDialog=c('React').createElement(c('P2PEditCreditCardDialog.react'),{asyncRequestState:this.state.creditCardAsyncRequestState,creditCard:this.state.selectedCreditCard,onCancel:function(){this.setState({editCreditCardDialogShown:false});c('P2PActions').checkoutProcessing(false);}.bind(this),onSuccess:function(){this.setState({editCreditCardDialogShown:false});this.placeOrderWithExistingCard();}.bind(this)});return o;},render:function n(){if(this.state.passwordProtectionNUXShown){return (c('React').createElement(c('P2PPasswordProtectionNUXDialog.react'),{onComplete:this.handleSuccess}));}else if(this.state.creditCardVerificationDialogShown){var o=this.state.confirmedPaymentMethod.creditCard,p=c('React').createElement(c('P2PText.react'),{size:'small',type:'secondary'},c('React').createElement(c('Link.react'),{onClick:this.handleCreditCardVerificationCancel,size:'small'},h._("\u4f7f\u7528\u5176\u4ed6\u4ed8\u6b3e\u65b9\u5f0f"))),q=h._("\u4ed8\u6b3e");return (c('React').createElement(c('FBPaymentsCreditCardVerificationDialog_DEPRECATED.react'),{creditCard:o,leftContent:p,loading:this.state.saving,onConfirm:this.handleVerifyCreditCardAndCompleteCheckout,primaryButtonText:q,showCancelButton:false}));}else if(this.state.successDialogShown){var r=h._("\u4f60\u7684\u8cfc\u8cb7\u5df2\u5b8c\u6210\u3002\u4f60\u5f88\u5feb\u5c31\u6703\u6536\u5230\u78ba\u8a8d\u96fb\u5b50\u90f5\u4ef6\u3002");if(this.props.asyncPaymentDetails)r=h._("\u5df2\u50b3\u9001\u4f60\u7684\u4ed8\u6b3e\u8b49\u660e\u3002\u8ce3\u5bb6\u5c07\u7acb\u5373\u9a57\u8b49\u4f60\u7684\u4ed8\u6b3e\u3002");return (c('React').createElement(c('P2PSuccessDialog.react'),{buttonLabel:h._("\u67e5\u770b\u6536\u64da"),buttonUse:'confirm',onOKClick:this.props.onSeeReceiptClick||this.handleSuccess,showCloseButton:true,title:h._("\u78ba\u8a8d")},c('React').createElement(c('P2PText.react'),{type:'secondary',style:{textAlign:'center'}},r)));}return (c('React').createElement(c('P2PCheckoutDialog.react'),babelHelpers['extends']({},this.props,this.state,{onClose:this.handleCancel,onCompleteManualPayment:this.handleCompleteManualPayment,onConfirmSelectedPaymentMethod:this.handleConfirmPaymentMethod,onPlaceOrder:this.handlePlaceOrder,onSaveAddress:this.handleSaveAddress,onSaveCreditCard:this.handleSaveCreditCard,onSetAddress:this.handleSetAddress})));},_trackEvents:function n(o,p){if(!o.platformContextSaveError&&this.props.platformContextSaveError)this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CHECKOUT_CART_CREATION_FAIL);if(!this.state.initialDataLoaded)return;if(!p.initialDataLoaded&&this.state.initialDataLoaded)this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CHECKOUT_CART_CREATION_SUCCESS);if(!p.showCreditCardForm&&this.state.showCreditCardForm)this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_ADD_CARD);if(p.showCreditCardForm&&!this.state.showCreditCardForm)this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CANCEL_ADD_CARD);if(!p.showCreditCardEditOptions&&this.state.showCreditCardEditOptions)this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_CHOOSE_CARD);if(!p.showAddressForm&&this.state.showAddressForm)this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_ADD_ADDRESS);if(p.showAddressForm&&!this.state.showAddressForm)this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CANCEL_ADD_ADDRESS);if(!p.showAddressEditOptions&&this.state.showAddressEditOptions)this.log(c('P2PPaymentLoggerEvent').UI_ACTN_INITIATE_CHOOSE_ADDRESS);if(!p.verifyCreditCardDialogShown&&this.state.verifyCreditCardDialogShown)this.log(c('P2PPaymentLoggerEvent').UI_ACTN_VERIFY_CSC);if(!p.editCreditCardDialogShown&&this.state.editCreditCardDialogShown)this.log(c('P2PPaymentLoggerEvent').UI_ACTN_EDIT_CARD);if(!p.transferError&&this.state.transferError)this.log(c('P2PPaymentLoggerEvent').UI_ACTN_CHECKOUT_FAIL);}});f.exports=m;}),null);
__d('P2PMCCartCreationDialogContainer.react',['MessengerPaymentProductType','P2PActions','P2PAPI','P2PCheckoutDialogContainer.react','P2PCheckoutStore','P2PPlatformContextStore','React','StoreAndPropBasedStateMixin'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=c('React').createClass({displayName:'P2PMCCartCreationDialogContainer',mixins:[c('StoreAndPropBasedStateMixin')(c('P2PCheckoutStore'),c('P2PPlatformContextStore'))],propTypes:{configSelections:h.string,productItemID:h.string.isRequired,sellerID:h.string.isRequired},statics:{calculateState:function j(k){return {platformContext:c('P2PCheckoutStore').getPlatformContext(),platformContextSaveError:c('P2PPlatformContextStore').getSaveError(k.productItemID)};}},componentWillMount:function j(){c('P2PAPI').createMCCart({productItemID:this.props.productItemID,sellerID:this.props.sellerID});},handleClose:function j(){c('P2PActions').clearPlatformContextSaveErrors(this.props.productItemID);c('P2PActions').hideDialog();},render:function j(){return (c('React').createElement(c('P2PCheckoutDialogContainer.react'),{onClose:this.handleClose,configSelections:this.props.configSelections,paymentProductType:c('MessengerPaymentProductType').MESSENGER_COMMERCE,platformContext:this.state.platformContext,platformContextSaveError:this.state.platformContextSaveError,productItemID:this.props.productItemID}));}});f.exports=i;}),null);
__d('MNCommercePromotionMercuryShareAttachment.react',['Banzai','MercuryConfig','MercuryFallbackShareAttachment.react','MercuryShareAttachmentReactShape','MercuryShareAttachmentRenderLocations','MessengerAdsWebTypedLogger','MNAdsLoggerEventEnum','MNCommerceCheckoutOrderConfigDialogContainer.react','MNCommerceDialogStateActions','MNCommerceMessageType','MessengerPlatformGenericItemMercuryAttachment.react','MNContentSubscriptionMessageUserEngagementTypedLogger','MNPlatformMessageUserEngagementTypedLogger','P2PActions','P2PMCCartCreationDialogContainer.react','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('React').PropTypes;function k(n){if(n!==undefined){var o=n.match(/\d+/);if(o!==undefined&&o!==null)return o[0];}return null;}function l(n,event){var o=k(n.props.pageID),p=n.getRetailItem(n.props.attachment.target),q=p&&p.id;if(n.props.mnMessageType==c('MNCommerceMessageType').CONTENT_SUBSCRIPTION){new (c('MNContentSubscriptionMessageUserEngagementTypedLogger'))().setPageID(o).setMessageID(n.props.messageID).setCommerceItemID(q).setName(event).log();switch(event){case 'mn_platform_msg_imp':c('Banzai').post('mn_platform_message_imp_setsuna',{page_id:o,item_id:q});break;case 'mn_platform_msg_click':c('Banzai').post('mn_platform_message_click_setsuna',{page_id:o,item_id:q});break;default:break;}}new (c('MNPlatformMessageUserEngagementTypedLogger'))().setPageID(o).setMessageID(n.props.messageID).setCommerceItemID(q).setName(event).log();}h=babelHelpers.inherits(m,c('React').Component);i=h&&h.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=i.constructor).call.apply(o,[this].concat(q)),this.$MNCommercePromotionMercuryShareAttachment1=function(s){var t=s.map(function(u){var v=u.action_link.startsWith('fb-messenger://payments/buy/mc?')||u.action_link.startsWith('fb-messenger://business/commerce/');if(v){if(c('MercuryConfig').WWWMessengerCheckout)return babelHelpers['extends']({onClick:this.$MNCommercePromotionMercuryShareAttachment2},u);return null;}else return u;}.bind(this));return t.filter(function(u){return u;});}.bind(this),this.$MNCommercePromotionMercuryShareAttachment2=function(){var s=this.props.attachment&&this.props.attachment.target;if(!s)return;var t=this.getRetailItem(s),u=t&&t.id;if(this.props.isSponsored)new (c('MessengerAdsWebTypedLogger'))().setEvent(c('MNAdsLoggerEventEnum').LINK_CLICK_CTA).setIsSponsored(this.props.isSponsored).setItemID(u).setMessageID(this.props.messageID).setPageID(this.props.pageID).log();l(this,'mn_platform_msg_click');var v=this.props.pageID,w=function x(y,z,aa){return c('P2PActions').showDialog(c('P2PMCCartCreationDialogContainer.react'),{productItemID:y,sellerID:z,configSelections:aa});};c('MNCommerceDialogStateActions').showDialog(c('MNCommerceCheckoutOrderConfigDialogContainer.react'),{onContinue:w,itemID:u,ownerID:v});}.bind(this),this.getRetailItem=function(s){if(s.items)if(s.items.length){return s.items[0];}else return null;return s;},n;}m.prototype.componentDidMount=function(){l(this,'mn_platform_msg_imp');};m.prototype.render=function(){var n=this.props.attachment&&this.props.attachment.target;if(!n)return c('React').createElement(c('MercuryFallbackShareAttachment.react'),this.props);var o=this.props.attachment&&this.props.attachment.uri,p=this.props.attachment&&this.props.attachment.label,q=this.getRetailItem(n),r=q&&q.call_to_actions||n.call_to_actions;return c('React').createElement(c('MessengerPlatformGenericItemMercuryAttachment.react'),{callToActions:this.$MNCommercePromotionMercuryShareAttachment1(r),isSponsored:this.props.isSponsored,isSubattachment:this.props.isSubattachment,itemID:q&&q.id,label:p,location:this.props.location,longestCTAs:this.props.longestCTAs,longestMetaline:this.props.longestMetaline,longestName:this.props.longestName,messageID:this.props.messageID,mnMessageType:this.props.mnMessageType,pageID:this.props.pageID,threadID:this.props.threadID,retailItem:q,url:o,width:this.props.maxWidth});};m.propTypes={attachment:c('MercuryShareAttachmentReactShape'),isSponsored:j.bool,isSubattachment:j.bool,location:j.oneOf(c('MercuryShareAttachmentRenderLocations').getValues()),maxWidth:j.number,messageID:j.string,mnMessageType:j.string,pageID:j.string,threadID:j.string,longestCTAs:j.number,longestMetaline:j.string,longestName:j.string};f.exports=m;}),null);
__d('OzActions',['Reflux'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={};h.activateThread=c('Reflux').createAction();h.scrollThreadToTimestamp=c('Reflux').createAction();h.doneScrollingToTimestamp=c('Reflux').createAction();h.updateThreads=c('Reflux').createAction();h.maybeUpdateThreads=c('Reflux').createAction();h.clearReassignState=c('Reflux').createAction();h.deleteTask=c('Reflux').createAction();h.updateMerchants=c('Reflux').createAction();h.deleteMerchants=c('Reflux').createAction();h.updateWitIntents=c('Reflux').createAction();h.updateReps=c('Reflux').createAction();h.replaceReps=c('Reflux').createAction();h.replaceHumans=c('Reflux').createAction();h.updateRequirements=c('Reflux').createAction();h.showDialog=c('Reflux').createAction();h.hideDialog=c('Reflux').createAction();h.updateComposer=c('Reflux').createAction();h.addBubble=c('Reflux').createAction();h.addAutopilot=c('Reflux').createAction();h.isActive=c('Reflux').createAction();h.isInactive=c('Reflux').createAction();h.sendPulse=c('Reflux').createAction();h.updateQueueFilters=c('Reflux').createAction();h.intentCreator=c('Reflux').createActions(['toggle','select','clear']);h.emailComposer=c('Reflux').createActions(['delete','add']);h.emailComposer.update=c('Reflux').createAction({sync:true});h.inviteComposer=c('Reflux').createActions(['delete','add','create']);h.inviteComposer.update=c('Reflux').createAction({sync:true});h.twilio=c('Reflux').createActions(['connect','endCall','hangUp','incoming','incomingAccept','incomingReject','mute','ready','setup','startCall','unmute','updateIncomingInfo','useIntent','updateRating','dialAgain']);h.twilio.changeTo=c('Reflux').createAction({sync:true});h.twilio.sendDigits=c('Reflux').createAction({sync:true});h.sendMessageStart=c('Reflux').createAction();h.sendMessageFinish=c('Reflux').createAction();h.addHandledEvents=c('Reflux').createAction();h.updateServerOffset=c('Reflux').createAction();h.updateLoadingState=c('Reflux').createAction();h.updateCalendarEvents=c('Reflux').createAction();h.skywalkerMessage=c('Reflux').createAction();h.skywalkerStalled=c('Reflux').createAction();h.selectAIPick=c('Reflux').createAction();f.exports=h;}),null);
__d('OzConfig',['immutable','Reflux'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('immutable').Map,i=c('Reflux').createAction({sync:true}),j=c('Reflux').createAction({sync:true}),k=c('Reflux').createStore({init:function n(){this.data=h();this.listenTo(i,this._onSetConfig);this.listenTo(j,this._onUpdateConfig);},getInitialState:function n(){return this.data;},_onSetConfig:function n(o){this.data=o;this.trigger(this.data);},_onUpdateConfig:function n(o){this.data=this.data.mergeDeep(o);this.trigger(this.data);}});function l(n){return k.data.get(n);}function m(n){return k.data.getIn(n);}f.exports={ConfigStore:k,getInStaticConfig:m,getStaticConfig:l,setConfig:i,updateConfig:j};}),null);
__d('OzNotify',['cx','immutable','OzImmutablePureRenderMixin','React','ReactCSSTransitionGroup','Reflux','joinClasses'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').OrderedMap,j=c('immutable').Map,k={addNotif:c('Reflux').createAction({sync:true}),removeNotif:c('Reflux').createAction({sync:true})},l=c('Reflux').createStore({init:function s(){this.data=i();this.listenTo(k.addNotif,this._onAddNotif);this.listenTo(k.removeNotif,this._onRemoveNotif);},getInitialState:function s(){return this.data;},_onAddNotif:function s(t){this.data=this.data.set(t.get('id'),t);this.trigger(this.data);},_onRemoveNotif:function s(t){this.data=this.data['delete'](t);this.trigger(this.data);}}),m=j({info:"_4nqo",warn:"_4nqp",error:"_4nqq"}),n=c('React').createClass({displayName:'OzNotify',mixins:[c('Reflux').connect(l,'notifs'),c('OzImmutablePureRenderMixin')],render:function s(){return (c('React').createElement(c('ReactCSSTransitionGroup'),{component:'div',transitionName:'oz-fade-in-out',className:"_4nqr",transitionEnterTimeout:500,transitionLeaveTimeout:500},this.state.notifs.reverse().map(function(t,u){return (c('React').createElement('div',{key:u,className:c('joinClasses')("_4nqs",m.get(t.get('level')))},t.get('msg'),c('React').createElement('span',{className:"_ok9",onClick:function v(){return k.removeNotif(u);}},'×')));}).valueSeq()));}}),o=7000,p=0;function q(s){return function(t){p+=1;k.addNotif(j({id:p,level:s,msg:t}));(function(u){window.setTimeout(function(v){return k.removeNotif(u);},o);})(p);};}var r={Component:n,info:q('info'),warn:q('warn'),error:q('error')};f.exports=r;}),null);
__d('OzAPI',['invariant','OzHelpers','OzNotify','Arbiter','ChannelConstants','ChannelManager','immutable','OzActions','OzAJAX','OzConfig','OzStores','promiseFinally','RTISubscriptionManager'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').List,j=c('immutable').Map,k=c('OzAJAX').ajax,l=c('OzAJAX').beacon,m=c('OzAJAX').buildURI,n=c('OzStores').ActiveThreadStore,o=c('OzStores').ThreadStore;c('ChannelManager').getConfig;function p(aa){if(aa.attachment&&!aa.attachments)aa.attachments=[aa.attachment];var ba=c('immutable').fromJS(aa);return ba;}function q(aa){return i(aa.map(function(ba){ba=p(ba);return [c('OzHelpers').msgID(ba),ba];})).fromEntrySeq().toMap();}function r(aa){if(!aa.messages)aa.messages=(aa['last-events']||[]).map(function(ca){ca.sender=ca.from;return ca;});aa.messages=q(aa.messages);var ba=c('immutable').fromJS(aa);return ba;}function s(aa){return i(aa.map(r));}function t(aa){var ba=s([aa]);c('OzActions').updateThreads(ba);c('OzActions').addHandledEvents(ba.first().get('handled-events',i()));!(ba.count()===1)?h(0):void 0;return ba.first();}function u(aa){!Number.isSafeInteger(aa.offset)?h(0):void 0;!Number.isSafeInteger(aa.limit)?h(0):void 0;return k({type:'GET',url:m('threads',c('OzConfig').getStaticConfig('PAGE_ID')),params:aa}).then(function(ba){var ca=ba.threads,da=s(ca);c('OzActions').updateThreads(da);return da;});}function v(aa){var ba=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],ca=arguments.length<=2||arguments[2]===undefined?null:arguments[2];!(typeof aa==='string')?h(0):void 0;!(typeof ba==='object')?h(0):void 0;var da,ea=false;if(ba instanceof FormData){da=ba;}else{da=JSON.stringify(ba);ea=true;}var fa=function ha(){var ia=n.data.get('activeIntent'),ja=n.data.get('threadID'),ka=ia&&ja&&o.data.getIn([ja,'intents'],i()).findLast(function(la){return la.get('id')===ia;},null,j()).get('state');return ka==='open'&&ia;},ga={type:'PUT',url:m('sync'),params:{t:aa,'intent-id':ca||fa(),page:c('OzConfig').getStaticConfig('PAGE_ID')},body:da};if(ea){ga.headers=ga.headers||{};ga.headers['content-type']='application/json';}c('OzHelpers').info('[sync] '+aa,ba);return k(ga);}function w(aa){return function(ba){return v(aa,{tid:ba}).then(function(ca){var da=r(ca);c('OzActions').updateThreads(i([da]));return da;});};}function x(aa){var ba=aa['user-id'],ca=aa['owner-id'],da=aa['last-owner-id'],ea=c('OzConfig').getStaticConfig('uid');return o.data.get(ba)||ca===ea||da===ea;}var y={metrics:j({}),bumpMetric:function aa(ba){y.metrics=y.metrics.updateIn(ba,function(ca){return (ca||0)+1;});},setMetric:function aa(ba,ca){y.metrics=y.metrics.setIn(ba,ca);},_witIntentCSV:function aa(){y.witIntents().done(function(ba){var ca='data:text/csv;charset=utf-8,';ba.forEach(function(da){return ca+='"'+da.get('name')+'","'+da.get('id')+'","'+da.get('doc')+'"\n';});window.open(window.encodeURI(ca));});},grab:w('grab'),release:w('release'),ready:w('ready'),notready:w('notready'),ack:w('ack'),lockThread:w('lock-thread'),markRead:w('mark-read'),unlockThread:function aa(ba,ca){return v('unlock-thread',{tid:ba,'locked-at':ca}).then(t);},assignTo:function aa(ba,ca){return v('assign-to',{tid:ba,id:ca});},escalate:function aa(ba){return y.createTag(ba,'escalated');},escalateTo:function aa(ba,ca){return y.escalate(ba).then(function(){return y.assignTo(ba,ca);});},typing:function aa(ba){return v('rep-typing',{tid:ba});},notTyping:function aa(ba){return v('rep-not-typing',{tid:ba});},createReminder:function aa(ba,ca){return v('create-reminder',babelHelpers['extends']({tid:ba},ca.toJS()));},createTask:function aa(ba,ca){return v('create-task',{tid:ba,task:ca.toJS()});},completeTask:function aa(ba,ca){return v('complete-task',{tid:ba,task:ca.toJS()}).then(t);},editTask:function aa(ba,ca){return v('edit-task',{tid:ba,task:ca.toJS()}).then(t);},cancelTask:function aa(ba,ca){var da=arguments.length<=2||arguments[2]===undefined?false:arguments[2];c('OzActions').deleteTask(ba,ca.get('id'));return v('cancel-task',{tid:ba,task:ca.toJS(),'cancel-future':da}).then(t);},openTask:function aa(ba,ca){return v('open-task',{tid:ba,task:ca.toJS()}).then(t);},closeReminder:function aa(ba,ca,da){return v('close-reminder',{tid:ba,id:ca,all:da}).then(t);},editReminder:function aa(ba,ca){return v('edit-reminder',{tid:ba,reminder:ca.toJS()}).then(t);},snoozeReminder:function aa(ba,ca){return v('snooze-reminder',{tid:ba,id:ca}).then(t);},deleteIntentRequirement:function aa(ba,ca,da){return v('delete-intent-requirement',{tid:ba,'intent-id':ca,'requirement-id':da},ca).then(t);},deleteThreadRequirement:function aa(ba,ca){return v('delete-thread-requirement',{tid:ba,'requirement-id':ca}).then(t);},createIntentRequirement:function aa(ba,ca,da){return v('create-intent-requirement',{tid:ba,'intent-id':ca,'requirement-name':da},ca).then(t);},createThreadRequirement:function aa(ba,ca){return v('create-thread-requirement',{tid:ba,'requirement-name':ca}).then(t);},createIntent:function aa(ba,ca){return v('create-intent',babelHelpers['extends']({tid:ba},ca.toJS())).then(t);},openIntent:function aa(ba,ca){return v('open-intent',{tid:ba,id:ca},ca).then(t);},triggerAIForIntent:function aa(ba,ca){return v('trigger-ai-for-intent',{tid:ba,id:ca},ca);},closeIntent:function aa(ba,ca,da,ea,fa){var ga={tid:ba,id:ca,'close-state':da,feedback:ea,'send-survey':fa};return v('close-intent',ga,ca).then(t);},blockIntent:function aa(ba,ca){return v('block-intent',{tid:ba,id:ca},ca).then(t);},unblockIntent:function aa(ba,ca){return v('unblock-intent',{tid:ba,id:ca},ca).then(t);},addPhoneNumber:function aa(ba,ca){return v('add-phone-number',{tid:ba,'intent-id':ca},ca);},editIntent:function aa(ba,ca){return v('edit-intent',babelHelpers['extends']({tid:ba},ca.toJS()),ca.get('id')).then(t);},createTag:function aa(ba,ca){return v('add-thread-tag',{tid:ba,tag:ca}).then(t);},deleteTag:function aa(ba,ca){return v('remove-thread-tag',{tid:ba,tag:ca}).then(t);},view:w('create-subscription'),unview:function aa(ba){return v('delete-subscription',{tid:ba});},updateMessage:function aa(ba,ca){return v('update-message',{tid:ba,message:ca.toJS()}).then(t);},everstoreUpload:function aa(ba){var ca=new FormData();ba.forEach(function(da,ea){return ca.append(ea,da);});return v('everstore-upload',ca);},upload:function aa(ba){var ca=new FormData();ba.forEach(function(da,ea){return ca.append(ea,da);});return v('upload',ca).then(function(da){return c('immutable').fromJS(da);});},sendMessage:function aa(ba){var ca=v('send',ba).then(function(da){return t({'user-id':ba.tid,'last-events':da});});c('promiseFinally')(ca,function(da){return c('OzActions').sendMessageFinish(ba.tid);});window.setTimeout(function(){return c('OzActions').sendMessageStart(ba.tid);},200);return ca;},scheduleMessage:function aa(ba){return v('schedule-send',ba);},suggest:function aa(ba){return v('suggest',ba).then(t);},scheduleSuggest:function aa(ba){return v('schedule-suggest',ba);},deleteScheduled:function aa(ba,ca){return v('delete-scheduled',{tid:ba,id:ca}).then(t);},saveNote:function aa(ba,ca){var da={tid:ba,infos:{notes:ca}};return v('update-infos',da).then(t);},saveMeta:function aa(ba,ca){var da={tid:ba,infos:{'metadata-json':ca.toJS()}};return v('update-infos',da).then(t);},saveMuted:function aa(ba,ca){var da={tid:ba,infos:{muted:ca}};return v('update-infos',da).then(t);},createMerchant:function aa(ba){return v('create-merchant',ba.toJS()).then(function(ca){var da=i([j(ca)]);c('OzActions').updateMerchants(da);return da;});},editMerchant:function aa(ba){return v('edit-merchant',ba.toJS()).then(function(ca){var da=i([j(ca)]);c('OzActions').updateMerchants(da);return da;});},deleteMerchant:function aa(ba){return v('delete-merchant',ba.toJS()).then(function(ca){if(ca&&ca.id){var da=i([ca.id]);c('OzActions').deleteMerchants(da);return da;}else c('OzHelpers').warn('[api] unexpected delete-merchant response',ca);});},sendEmail:function aa(ba,ca){var da=n.data.get('threadID');return v('send-email',babelHelpers['extends']({tid:da},ba.toJS()),ca);},sendInvite:function aa(ba,ca){var da=n.data.get('threadID');return v('send-calendar',babelHelpers['extends']({tid:da},ba.toJS()),ca);},fetchCalendar:function aa(ba){return k({type:'GET',url:m('threads',c('OzConfig').getStaticConfig('PAGE_ID'),ba,'calendar')}).then(function(ca){c('OzActions').updateCalendarEvents({tid:ba,calendarEvents:ca});return ca;});},bookOpenTable:function aa(ba,ca,da,ea,fa){return v('book-reservation',{tid:ba,rid:da,ts:ea,covers:fa},ca);},everstoreURI:function aa(ba){return v('everstore-uri',{handle:ba});},witIntents:function aa(){return k({type:'GET',url:m('wit-intents',c('OzConfig').getStaticConfig('PAGE_ID'))}).then(function(ba){var ca=c('immutable').fromJS(ba);c('OzActions').updateWitIntents(ca);return ca;});},merchants:function aa(){return k({type:'GET',url:m('merchants')}).then(function(ba){c('OzActions').updateMerchants(i(ba).map(function(ca){return j(ca);}));});},repsSync:function aa(){return k({type:'GET',url:m('reps-sync')});},requirements:function aa(){return k({type:'GET',url:m('requirements')}).then(function(ba){c('OzActions').updateRequirements(c('immutable').fromJS(ba));});},AIModules:function aa(){return k({type:'GET',url:m('ai-modules')}).then(function(ba){return i(ba);});},authorFeedback:function aa(ba){return k({type:'GET',url:m('author-feedback'),params:{author_id:ba}}).then(function(ca){return j(ca.map(function(da){da=c('immutable').fromJS(da);return [c('OzHelpers').msgID(da),da];}));});},myThreads:function aa(){var ba=c('OzConfig').getStaticConfig('PAGE_ID');return k({type:'GET',params:{page:ba},url:m('mythreads')}).then(function(ca){var da=ca.mythreads;c('OzActions').updateThreads(s(da));});},allThreads:function aa(ba,ca,da,ea){var fa={all:true,first_tags:ba.toJS(),last_tags:ca.toJS(),offset:da,limit:ea};if(ba.has('ready')){ba=ba['delete']('ready');fa.ready=true;}else if(ca.has('ready')){ca=ca['delete']('ready');fa.ready=false;}return u(fa);},thread:function aa(ba){return k({type:'GET',url:m('threads',c('OzConfig').getStaticConfig('PAGE_ID'),ba)}).then(t);},handledEvents:function aa(ba){return k({type:'GET',params:{'intent-id':ba},url:m('handled-events')}).then(function(ca){c('OzActions').addHandledEvents(c('immutable').fromJS(ca['handled-events']));});},tasksForIntent:function aa(ba,ca){var da=c('OzConfig').getStaticConfig('PAGE_ID');return k({type:'GET',params:{page:da},url:m('tasks',ba)}).then(function(ea){t({'user-id':ca,tasks:ea});});},history:function aa(ba,ca,da){return k({type:'GET',params:{timestamp:ca,limit:da},url:m('threads',c('OzConfig').getStaticConfig('PAGE_ID'),ba,'history')}).then(function(ea){var fa=t({'user-id':ba,messages:ea});return fa.get('messages');});},topIntents:function aa(){return k({type:'GET',url:m('top-intents')}).then(function(ba){return c('immutable').fromJS(ba);});},intentsDashboard:function aa(ba){return k({type:'GET',params:ba,url:m('dashboard','intent',c('OzConfig').getStaticConfig('PAGE_ID'))}).then(function(ca){return c('immutable').fromJS(ca);});},aiDashboard:function aa(ba){return k({type:'GET',params:ba,url:m('dashboard','ai',c('OzConfig').getStaticConfig('PAGE_ID'))}).then(function(ca){return c('immutable').fromJS(ca);});},statsDashboard:function aa(ba){return k({type:'GET',params:ba,url:m('dashboard','trainer',ba['trainer-id'])}).then(function(ca){return c('immutable').fromJS(ca);});},teamStatsDashboard:function aa(ba){return k({type:'GET',params:ba,url:m('dashboard','trainer-team-stats')}).then(function(ca){return c('immutable').fromJS(ca);});},humans:function aa(){return k({type:'GET',url:m('humans')}).then(function(ba){return c('OzActions').replaceHumans(c('immutable').fromJS(ba));});},search:function aa(ba){return k({params:ba,type:'GET',url:m('search')}).then(function(ca){return c('immutable').fromJS(ca).flatten(true);});},requestAutopilot:function aa(ba){window.postMessage(ba,'*');},notifyExtension:function aa(ba){c('OzHelpers').debug('[oz-ext] notifying toto',ba);window.postMessage(babelHelpers['extends']({type:'notification'},{data:ba}),'*');},recordActivity:function aa(ba,ca){return v('activity',babelHelpers['extends']({tid:ba},{activity:ca}));},sendPulse:function aa(ba,ca){return k({type:'POST',url:m('pulse'),headers:{'content-type':'application/json'},params:{page:c('OzConfig').getStaticConfig('PAGE_ID'),duration:ba},body:JSON.stringify(ca)});},sendDisconnectPulse:function aa(ba,ca){return l({url:m('pulse'),params:{page:c('OzConfig').getStaticConfig('PAGE_ID'),duration:ba},body:JSON.stringify(ca)});},threadFocus:function aa(ba,ca){return v('thread-focus',{tid:ba,intentID:ca},ca);},away:function aa(ba){return v('away',{away:ba});},coachMode:function aa(ba){return v('coach-mode',{'coach-mode':ba});},timestamp:function aa(){var ba=Date.now();return k({type:'POST',url:m('timestamp')}).then(function(ca){var da=ca.timestamp,ea=Date.now();if(ea-ba>1000){c('OzHelpers').warn('[oz-api] timestamp took over 1 second, not updating offset');}else{var fa=ea-(da+(ea-ba)/2);c('OzActions').updateServerOffset({offsetMs:fa});}});},init:function aa(){return k({type:'GET',url:m('init')}).then(function(ba){ba['twilio-token']&&c('OzActions').twilio.setup(ba['twilio-token']);c('OzConfig').updateConfig(c('immutable').fromJS(ba));});},realTime:function aa(ba,ca){var da,ea=60000,fa=function la(){var ma=Date.now();clearInterval(da);da=setInterval(function(na){var oa=Math.round((Date.now()-ma)/1000);c('OzActions').skywalkerStalled();c('OzHelpers').warn('[rti] no payload in '+oa+'seconds');},ea);},ga={repsVersion:-1},ha=function la(ma,na){var oa=na.payload,pa=na.topic;!(ma==='sky'||ma==='msg')?h(0):void 0;fa();var qa=ma==='sky'?ma+' '+pa+' ->':ma,ra=oa.type,sa=ra||'';c('OzHelpers').debug('[rti] '+qa+' '+sa,oa);if(!oa.data){c('OzHelpers').error('[sky] got sky event without data',oa,pa);return;}var ta=oa.data['page-id'];if(ta&&ta!==c('OzConfig').getStaticConfig('PAGE_ID')){c('OzHelpers').debug('[sky] junk event on '+pa,oa);return;}var ua;y.bumpMetric(['realtime',ra]);c('OzActions').skywalkerMessage({payload:oa,timestamp:c('OzHelpers').serverNow()});switch(ra){case 'thread':ua=oa.data;t(ua);break;case 'thread-metrics':ua=oa.data;if(o.data.get(ua['user-id'])){y.bumpMetric(['realtime','thread-metrics-update-thread']);t(ua);}break;case 'maybe-thread':ua=oa.data;c('OzActions').maybeUpdateThreads(s([ua]));break;case 'delivered':case 'seen':ua=oa.data;t({'user-id':ua['user-id'],'last-seen':ua['last-seen']});break;case 'presence':ua=oa.data;t({'user-id':ua['user-id'],'last-presence':ua['last-presence']});break;case 'carebear':(function(){var bb=oa.data,cb=bb.type,db=bb.tid,eb={'user-id':db};eb['ui-'+cb]=true;t(eb);})();break;case 'inactive':c('OzActions').isInactive();break;case 'updated-merchant':c('OzActions').updateMerchants(i([j(oa.data)]));break;case 'deleted-merchant':c('OzActions').deleteMerchants(i([oa.data.id]));break;case 'phone-call':c('OzActions').twilio.updateIncomingInfo(c('immutable').fromJS(oa.data));break;case 'humans':c('OzActions').replaceHumans(c('immutable').fromJS(oa.data));break;case 'reps-sync':ga=babelHelpers['extends']({},ga,{repsVersion:oa.version});c('OzActions').replaceReps(c('immutable').fromJS(oa.data));break;case 'reps-diff':if(ga.repsVersion!==oa.version-1){c('OzHelpers').warn('[api] reps version out of sync',{'our-version':ga.repsVersion,'next-version':oa.version});ga=babelHelpers['extends']({},ga,{repsVersion:-1});y.repsSync();}else{ga.repsVersion=oa.version;c('OzActions').updateReps(c('immutable').fromJS(oa.data));}break;case 'handled-events':c('OzActions').addHandledEvents(c('immutable').fromJS(oa.data));break;case 'config':c('OzConfig').updateConfig(c('immutable').fromJS(oa.data));break;case 'notify':var va=oa.data,wa=va.level,xa=va.message;c('OzNotify')[wa](xa);break;case 'updated-thread':var ya=oa.data['user-id'];if(x(oa.data)){y.bumpMetric(['realtime','updated-thread-fetch-thread']);c('OzHelpers').info('[api] fetching thread after update',ya);y.thread(ya);}break;case 'ping':var za=oa.data.timestamp,ab=c('OzHelpers').serverNow()-za;y.setMetric(['realtime','pingLatency'],ab);break;default:c('OzHelpers').debug('[sky] unk type',ra,oa);}},ia=function la(){for(var ma=arguments.length,na=Array(ma),oa=0;oa<ma;oa++)na[oa]=arguments[oa];try{ha.apply(undefined,na);}catch(pa){try{c('OzHelpers').error.apply(c('OzHelpers'),['[sky] error handling message'].concat(na));}catch(qa){}}},ja=c('Arbiter').subscribe(c('ChannelConstants').getArbiterType('msg'),function(la,ma){ia('msg',ma.obj);}),ka=z(function(){c('Arbiter').unsubscribe(ja);c('RTISubscriptionManager').unsubscribeAll();});c('RTISubscriptionManager').subscribe(ba,ia.bind(this,'sky'),null,z(function(la){var ma=la.data,na=la.error;if(na){ka();ca(na,ma);}else{fa();ca(null,ma,ja);}}));return ka;}};function z(aa){var ba,ca,da=this;return function(){if(!ba){ca=aa.apply(da,arguments);ba=true;}return ca;};}f.exports=y;}),null);
__d('ozMakeColor',['randomShuffle','immutable'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('immutable').Map,i=c('immutable').List,j=c('immutable').Range,k=function n(o,p){return 'hsla('+o+', 85%, 30%, '+p+')';};function l(){var n=arguments.length<=0||arguments[0]===undefined?25:arguments[0],o=arguments.length<=1||arguments[1]===undefined?.9:arguments[1],p=i(c('randomShuffle')(j(10,360,n).toJS())),q=0,r=h();return function(s){if(r.has(s)){return k(r.get(s),o);}else{var t=p.get(q);r=r.set(s,t);q=(q+1)%p.count();return k(t);}};}function m(){var n=arguments.length<=0||arguments[0]===undefined?77:arguments[0];return function(o){return k(o*n%360,.9);};}f.exports={makeColorShuffle:l,makeColor:m};}),null);
__d('OzHelpers',['ozMakeColor','BanzaiScuba','DatePickerRestraints','ErrorUtils','getURLRanges','immutable','LogHistory','OzConfig','OzConstants','OzServerTime','OzImmutablePureRenderMixin','React','URI'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('ozMakeColor').makeColor,i=c('immutable').List,j=c('immutable').Map,k=c('immutable').Set,l=c('immutable').OrderedMap,m=c('OzConstants').AUTHOR_TYPES,n=c('OzConstants').REMINDERS,o=/^image\//,p={color:h(),blobURI:function ba(ca){return window.URL.createObjectURL(ca);},blobFromDataURI:function ba(ca){var da=ca.split(','),ea=atob(da[1]),fa=da[0].split(':')[1].split(';')[0],ga=new ArrayBuffer(ea.length),ha=new Uint8Array(ga);for(var ia=0;ia<ea.length;ia++)ha[ia]=ea.charCodeAt(ia);return new Blob([ga],{type:fa});},toLocaleDate:function ba(ca){return new Date(ca).toLocaleDateString();},toLocaleTime:function ba(ca){return new Date(ca).toLocaleTimeString();},hasCmdOrCtrl:function ba(ca){return ca.getModifierState('Meta')||ca.getModifierState('Control');},keysIn:function ba(){var ca=k(arguments);return function(da,ea){return ca.has(ea);};},safeParse:function ba(ca){var da={};try{da=JSON.parse(ca);}catch(ea){p.info('invalid json',ca);}return da;},safeURI:function ba(ca){var da=null;try{da=c('URI').isValidURI(ca)&&new (c('URI'))(ca)||null;}catch(ea){p.info('invalid uri',ca);}return da;},pure:s,memoize:t,values:function ba(ca){return Object.keys(ca).map(function(da){return ca[da];});},nonempty:function ba(ca){return ca&&!ca.isEmpty()?ca:null;},uniqId:v,debug:x('debug',false),info:x('info',true),warn:x('warn',true),error:x('error',true),isImageType:function ba(ca){return o.test(ca);},isStickerType:function ba(ca){return ca==='image/sticker';},dateRestraints:w,moveCursorToInputEnd:function ba(ca){if(ca.setSelectionRange){var da=ca.value.length;ca.setSelectionRange(da,da);}},toTitleCase:function ba(ca){var da=k(['a','an','the','at','by','for','in','of','on','to','up','and','as','but','or','nor']),ea=function ga(ha,ia,ja){return (ia===0||ia+ha.length===ja.length);},fa=function ga(ha,ia,ja){return (ea(ha,ia,ja)||!da.has(ha)?ha.charAt(0).toUpperCase()+ha.substr(1):ha);};return ca.toLowerCase().replace(/\w\S*/g,fa);},scrollToBottom:function ba(ca){ca.scrollTop=ca.scrollHeight;},threadID:function ba(ca){return ca.get('user-id');},isNew:function ba(ca){return !p.intents(ca).find(p.isClosedIntent);},hasOwner:function ba(ca){return ca.getIn(['owner','id']);},hasAllTags:function ba(ca,da){return da.every(function(ea){return p.hasTag(ca,ea);});},hasSomeTag:function ba(ca,da){return da.some(function(ea){return p.hasTag(ca,ea);});},hasTag:function ba(ca,da){return ca.get('tags')&&ca.get('tags').contains(da);},isEscalated:function ba(ca){return p.hasTag(ca,'escalated');},hasEngage:function ba(ca){return !!ca.get('engagement-type');},photo:function ba(ca){return ca.getIn(['user-vcard','photo'])||ca.getIn(['user-vcard','picture']);},compareNums:function ba(ca,da){if(ca&&da){return da-ca;}else if(ca){return -1;}else if(da){return 1;}else return 0;},compareBools:function ba(ca,da){if(ca&&da){return 0;}else if(ca){return -1;}else if(da)return 1;},getIncomingThreads:function ba(ca){return ca.filter(function(da){return da.get('ready')&&!p.hasOwner(da);}).sort(p.threadComparator);},threadComparator:function ba(ca,da){var ea=p.compareBools(p.hasTag(ca,'vip'),p.hasTag(da,'vip')),fa=p.compareBools(p.hasTag(ca,'urgent'),p.hasTag(da,'urgent')),ga=p.compareNums(p.urgentReminders(ca).getIn([0,'scheduled-time']),p.urgentReminders(da).getIn([0,'scheduled-time'])),ha=p.compareNums(ca.get('last-event-at'),da.get('last-event-at'));return (ea||fa||ga||ha);},lastEvents:function ba(ca){return ca.get('last-events',i()).sortBy(function(da){return da.get('timestamp');});},lastUserMessage:function ba(ca){return p.lastEvents(ca).findLast(function(da){return p.authorType(da)===m.USER;});},shortDesc:function ba(){var ca=arguments.length<=0||arguments[0]===undefined?j():arguments[0],da=ca.getIn(['attachments',0,'mime_type']),ea=ca.getIn(['attachments',0,'sticker_id']);return ca.get('text')||ea&&'sent a sticker.'||da&&(da.match(/video/i)&&'sent a video.'||da.match(/audio/i)&&'sent an audio clip.'||da.match(/image/i)&&'sent an image');},preferredName:function ba(ca){return (ca.getIn(['metadata-json','preferred-name'])||ca.getIn(['user-vcard','first-name']));},userEmail:function ba(ca){return (ca.getIn(['metadata-json','email']));},intents:function ba(ca){return ca.get('intents',i()).sortBy(function(da){return da.get('created-at');});},isOwner:function ba(ca,da){var ea=ca.getIn(['owner','id']);return ea&&da&&ea==da;},wasOwner:function ba(ca,da){var ea=ca.getIn(['last-owner','id']);return ea&&da&&ea==da;},isLocker:function ba(ca,da){return ca.get('locked')&&ca.get('locker-id')===da;},nameOrId:function ba(ca){return ca&&(ca.get('name')||ca.get('id'))||'';},isSubscriber:function ba(ca,da){return !!ca.get('subscriptions',i()).find(function(ea){return ea===da;});},hasUnblockedIntents:function ba(ca){return ca.get('intents',i()).some(function(da){return !p.isBlockedIntent(da);});},hasOpenIntents:function ba(ca){return ca.get('intents',i()).some(function(da){return p.isOpenIntent(da);});},openIntents:function ba(ca){return p.intents(ca).filter(p.isOpenIntent);},closedIntents:function ba(ca){return p.intents(ca).filter(p.isClosedIntent);},intentById:function ba(ca,da){return p.intents(ca).findLast(function(ea){return ea.get('id')===da;});},isBlockedIntent:function ba(ca){return ca.get('blocked');},intentName:function ba(ca){return ca.get('name')||'Unknown intent';},intentAlias:function ba(ca){return ca.get('alias')||ca.get('name')||'Unknown intent';},isOpenIntent:function ba(ca){return ca.get('state')==='open';},isClosedIntent:function ba(ca){return !p.isOpenIntent(ca);},isDeleted:function ba(ca){return ca.get('state')==='deleted';},getName:function ba(ca){return ca.getIn(['user-vcard','name'],'Unknown user');},lastPresence:function ba(ca){return Math.max(ca.get('last-seen')||0,ca.get('last-presence')||0);},timeSpent:function ba(ca){if(ca.get('ready')&&ca.get('last-ready-at'))return p.serverNow()-ca.get('last-ready-at');},locationLastSeen:function ba(ca){if(ca.getIn(['location','last-seen']))return new Date(ca.getIn(['location','last-seen']));},timezone:function ba(ca){return ca.getIn(['location','timezone']);},durationStr:function ba(ca){if(ca==null){p.warn('[durationStr] strange duration '+ca);return '[invalid duration]';}else if(ca<-1000){p.warn('[durationStr] strange duration '+ca);return '-'+p.durationStr(-ca);}else if(ca<0){p.warn('[durationStr] strange duration '+ca);return '< 0s';}else if(ca===0){return '0s';}else if(ca<1000){return '< 1s';}else if(ca<60*1000){return Math.floor(ca/1000)+'s';}else if(ca<60*60*1000){return Math.floor(ca/(60*1000))+'m';}else if(ca<24*60*60*1000){return Math.floor(ca/(60*60*1000))+'h';}else return Math.floor(ca/(24*60*60*1000))+'d';},serverNow:function ba(){return c('OzServerTime').serverNow();},repName:function ba(ca,da){var ea=da.get(ca);return ea&&ea.get('name')||ca||null;},authorType:function ba(ca){var da=m.BOT,ea=m.USER,fa=m.TRAINER,ga=ca.get('sender')||ca.get('from'),ha=ca.get('author-type');return (ha===da&&da||(ha===fa||ga===c('OzConfig').getStaticConfig('PAGE_ID'))&&fa||ea);},msgID:function ba(){var ca=arguments.length<=0||arguments[0]===undefined?j():arguments[0];return ca.get('offline-threading-id')||ca.get('mid')||p.warn('[msgID] had to resort to timestamp',ca)&&null||ca.get('timestamp');},isActivePulse:function ba(ca){var da=ca&&ca.get('pulse-data');if(!da)return false;return !da.get('away?')&&da.get('inactive-ms',Infinity)<30000;},EMPTY_BODY:c('immutable').fromJS([{'content-type':'text/plain; charset=UTF-8',body:{contents:''}}]),eventToEmail:function ba(ca){return {email:ca.get('data'),intentId:ca.get('intent-id'),id:ca.get('id')};},reEmail:function ba(ca){var da=ca.getIn(['data','subject']),ea=da.toUpperCase().startsWith('RE:')?da:'Re: '+da;return ca.setIn(['data','subject'],ea).setIn(['data','body'],this.EMPTY_BODY);},switchRecip:function ba(ca){var da=ca.get('data'),ea=da.get('from'),fa=da.get('to');return ca.setIn(['data','from'],fa).setIn(['data','to'],i([ea]));},eventToInvite:function ba(ca){return {invite:ca.get('data'),id:ca.get('id'),intentId:ca.get('intent-id'),disabled:true};},urgentReminders:function ba(ca){return ca.get('reminders',i()).sortBy(function(da){return da.get('scheduled-time');}).filter(p.isUrgentReminder);},paidReminders:function ba(ca){return p.urgentReminders(ca).filter(p.isPaidReminder);},isUrgentReminder:function ba(ca){var da=ca.get('state');return da==='active'||da==='active-snoozed';},isPaidReminder:function ba(ca){return !!ca.getIn(['body','suggestion']);},isSnoozedReminder:function ba(ca){var da=ca.get('state');return da==='snoozed'||da==='active-snoozed';},isUrgentTask:function ba(ca){var da=ca.get('state');return da==='dispatched'&&ca.get('deadline')<p.serverNow();},isPaidTask:function ba(ca){return !!ca.getIn(['data','suggestion']);},isCompletedTask:function ba(ca){return ca.get('state')==='completed';},isCanceledTask:function ba(ca){return ca.get('state')==='canceled';},isWaitingTask:function ba(ca){return ca.get('state')==='waiting';},isClosedTask:function ba(ca){return p.isCompletedTask(ca)||p.isCanceledTask(ca);},isOpenTask:function ba(ca){return !p.isClosedTask(ca);},isUnread:function ba(ca){return ca.get('read-state')==='unread';},soonestDueTask:function ba(ca){return ca.filterNot(p.isClosedTask).minBy(function(da){return da.get('start-at');});},nextTaskForIntent:function ba(ca){var da=arguments.length<=1||arguments[1]===undefined?i():arguments[1];return p.soonestDueTask(da.filter(function(ea){return ea.get('intent-id')===ca.get('id');}));},nextTaskForThread:function ba(ca){return p.soonestDueTask(ca.get('tasks',i()));},unreadTs:function ba(ca){return c('OzConfig').ConfigStore.data.getIn(['GK','responsivenessV2'])?ca.get('unread-timestamp'):(p.lastUserMessage(ca)||j()).get('timestamp');},hasPaid:function ba(ca){return !!p.paidReminders(ca).size;},hasReminder:function ba(ca){return !!p.urgentReminders(ca).size;},minAge:function ba(ca){var ba=+ca.getIn(['user-vcard','age-range','min']);return Number.isSafeInteger(ba)?ba:0;},shimURI:function ba(ca){return new (c('URI'))('https://l.facebook.com/l.php').setQueryData({u:ca,h:c('OzConfig').getStaticConfig('shimhash')}).toString();},uiSuggestion:function ba(ca){var da=ca.has('amount')?'$'+(ca.get('amount')/100).toFixed(2):'';return {id:ca.get('item-id')||'-1',name:ca.get('name'),desc:ca.get('description'),thumb_url:ca.get('thumb-url'),merchant_name:ca.get('merchant-name')||'',total_cost:ca.get('amount')?j({amount:ca.get('amount')}):null,display_total_cost:da,target_url:p.shimURI(ca.get('target-url')),payment_id:ca.get('payment-id'),expiration_time:ca.get('expiration-time')};},parsePhoneNumber:function ba(ca){if(!ca)return '';if(ca.length==12&&ca[0]=='+')ca=ca.substr(1);if(ca.length==11&&ca[0]=='1')ca=ca.substr(1);switch(ca.length){case 10:return '('+ca.substr(0,3)+') '+ca.substr(3,3)+'-'+ca.substr(6,4);case 7:return ca.substr(0,3)+'-'+ca.substr(3,4);default:return ca;}},validateURL:function ba(ca){return (!!ca&&typeof ca==='string'&&c('getURLRanges')(ca).length&&c('URI').isValidURI(ca));},normalizeMerchant:function ba(ca){return ca.updateIn(['website'],function(da){if(!da)return da;var ea=c('getURLRanges')(da);if(!ea||ea.length===0)return da;return ea[0].entity.url;}).updateIn(['page-id'],function(da){if(Number.isFinite(da)||typeof da==='string')return parseInt(da,10);return null;});},validateMerchant:function ba(ca){var da=k(['name-dba','country']),ea=k(['address','website','page-id']),fa={},ga=ca.get('website','');if(ga&&!this.validateURL(ga))fa.website='Website is an invalid URL';var ha=ca.get('page-id',null);if(ha!=null&&!Number.isFinite(ha))fa['page-id']='FB Page must be a number';da.map(function(ja){if(!ca.get(ja))fa[ja]='This field is required';});if(k(ca.filter(function(ja){return ja;}).keys()).intersect(ea).isEmpty()){var ia='At least one of '+ea.join(', ')+' is required';ea.forEach(function(ja){fa[ja]=ia;});}return j(fa);},isDaytime:function ba(ca){var da=(Date.now()+ca)%(24*60*60*1000),ea=da/(60*60*1000);return ea>=6;},fullThreadData:function ba(ca,da,ea){var fa=ca.get(ea);if(!fa)return null;return fa.update('intents',function(ga){return (ga||i()).map(function(ha){var ia=q(da,ha),ja=r(fa,ia);return ja;});});},threadPath:function ba(ca){var da=ca.threadid,ea=ca.intentid,fa=ca.taskid,ga=ca.eventid,ha=ea?'/intent/'+ea:'',ia=fa?'/task/'+fa:'',ja=ga?'/event/'+ga:'';return '/inbox/'+da+ha+(ia||ja);},updateInWhen:function ba(ca,da,ea){var fa={};if(ca.getIn(da,fa)!==fa)return ca.updateIn(da,ea);return ca;},getRequirement:function ba(ca,da){return ca.get('requirements',i()).find(function(ea){return ea.get('name')===da;});}};function q(ba,ca){var da=ba.getIn(['byIntent',ca.get('id')],j());return ca.set('events',da);}function r(ba,ca){var da=ba.getIn(['tasks-by-intent',ca.get('id')]);return ca.set('tasks',da);}function s(ba){var ca=arguments.length<=1||arguments[1]===undefined?'OzPureComponent':arguments[1];return (c('React').createClass({displayName:ca,mixins:[c('OzImmutablePureRenderMixin')],render:function da(){return ba(this.props);}}));}function t(ba,ca){var da=arguments.length<=2||arguments[2]===undefined?1000:arguments[2],ea=l();return function(){for(var fa=arguments.length,ga=Array(fa),ha=0;ha<fa;ha++)ga[ha]=arguments[ha];var ia=ca.apply(this,ga);if(ea.get(ia)){return ea.get(ia);}else{var ja=ba.apply(this,ga);ea=ea.set(ia,ja).takeLast(da);return ja;}}.bind(this);}var u=0;function v(){return u++;}function w(){var ba=new Date(),ca=new Date(Date.UTC(ba.getFullYear(),ba.getMonth(),ba.getDate())),da=new Date(+ca);da.setFullYear(ca.getFullYear()+n.RANGE_IN_YEARS);return {dateRestraints:[c('DatePickerRestraints').enforceDateIsNoEarlierThan(ca),c('DatePickerRestraints').enforceDateIsNoLaterThan(da)]};}c('ErrorUtils').addListener(function(ba){var ca=aa({level:'error',message:'[unhandled-error]['+ba.name+'] '+ba.message,data:'--stack\n'+ba.stack+'\n\n--originalError\n'+ba._originalError});z(ca);y(ca);});function x(ba,ca){return function(){for(var da=arguments.length,ea=Array(da),fa=0;fa<da;fa++)ea[fa]=arguments[fa];var ga=ea[0],ha=ea.slice(1);window.console.log(ba,ga,ha);var ia=aa({level:ba,message:ga,data:ha});z(ia);ca&&y(ia);};}function y(ba){var ca=new (c('BanzaiScuba'))(c('OzConfig').getStaticConfig('scubaCategory'));Object.entries(ba).forEach(function(da){var ea=da[0],fa=da[1];Number.isSafeInteger(fa)?ca.addInteger(ea,fa):ca.addNormal(ea,fa);});ca.post();}function z(ba){var ca=c('LogHistory').getInstance('oz-logger');(ca[ba.level]||ca.debug).call(ca,ba.message,'');}function aa(ba){return babelHelpers['extends']({},ba,{uid:c('OzConfig').getStaticConfig('uid'),public_name:c('OzConfig').getStaticConfig('publicName'),rev:c('OzConfig').getStaticConfig('rev'),timestamp:p.serverNow()});}f.exports=p;}),null);
__d('OzServerTime',['OzStores','OzAPI'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('OzStores').ServerOffsetStore,i;function j(){return Math.floor(Date.now()-h.data.get('offsetMs'));}function k(){window.clearInterval(i);}function l(){c('OzAPI').timestamp();k();i=window.setInterval(function(){return c('OzAPI').timestamp();},1000*60*60*3);}f.exports={serverNow:j,setup:l,tearDown:k};}),null);
__d('OzStores',['invariant','OzHelpers','immutable','OzActions','Reflux'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').List,j=c('immutable').Map,k=c('immutable').OrderedMap,l=c('immutable').OrderedSet,m=c('immutable').Set,n=c('immutable').Iterable,o=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').updateRequirements,this._onUpdateRequirements);},getInitialState:function na(){return this.data;},_onUpdateRequirements:function na(oa){this.data=this.data.withMutations(function(pa){oa.forEach(function(qa){var ra=qa.get('name'),sa=pa.get(ra,j()).merge(qa).update('wit-intent-uuids',function(ta){return ta&&ta.toSet()||m();});pa.set(ra,sa);});});c('OzHelpers').debug('[oz] updated RequirementStore');this.trigger(this.data);}}),p=c('Reflux').createStore({init:function na(){this.data=l();this.listenTo(c('OzActions').addBubble,this._onAddBubble);},getInitialState:function na(){return this.data;},_onAddBubble:function na(oa){!j.isMap(oa)?h(0):void 0;this.data=this.data.add(oa).takeLast(100);this.trigger(this.data);},metrics:function na(){return j({bubbleCount:this.data.count()});}}),q=c('Reflux').createStore({init:function na(){this.data=k();this.listenTo(c('OzActions').addAutopilot,this._onAddAutopilot);},getInitialState:function na(){return this.data;},_onAddAutopilot:function na(oa){!j.isMap(oa)?h(0):void 0;this.data=this.data.set(oa.get('id'),oa.get('data')).takeLast(100);this.trigger(this.data);}}),r='id',s=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').updateWitIntents,this._onUpdateWitIntents);},getInitialState:function na(){return this.data;},_onUpdateWitIntents:function na(oa){!c('immutable').List.isList(oa)?h(0):void 0;this.data=this.data.withMutations(function(pa){return oa.reduce(function(qa,ra){return qa.set(ra.get(r),ra);},pa);});this.trigger(this.data);},metrics:function na(){return j({witIntentCount:this.data.count()});}}),t=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').activateThread,this._onActivateThread);},getInitialState:function na(){return this.data;},_onActivateThread:function na(oa){var pa=oa.threadID,qa=oa.intentID,ra=oa.taskID,sa=oa.eventID;c('OzHelpers').info('[store/activeThread] set active thread: ',{threadID:pa,intentID:qa,taskID:ra,eventID:sa});this.data=this.data.set('oldThreadID',this.data.get('threadID')).set('threadID',pa).set('activeIntent',qa).set('activeTask',ra).set('activeEvent',sa);this.trigger(this.data);}}),u='user-id',v=function na(oa,pa){return oa.reduce(function(qa,ra){qa[ra.get(pa)]=ra;return qa;},{});};function w(na,oa){!(j.isMap(na)&&j.isMap(oa))?h(0):void 0;var pa=v(na,'offline-threading-id'),qa=v(na,'mid');return na.withMutations(function(ra){return oa.valueSeq().filterNot(function(sa){var ta=sa.get('attachments');if(ta)return ta.first()&&ta.first().getIn(['xma','body'])===null;return false;}).reduce(function(sa,ta){var ua=ta.get('offline-threading-id'),va=ta.get('mid'),wa=ua&&pa[ua]||va&&qa[va]||sa.get(c('OzHelpers').msgID(ta));if(wa){sa=sa['delete'](c('OzHelpers').msgID(wa));ta=wa.merge(ta);ua=ta.get('offline-threading-id');va=ta.get('mid');}ua&&(pa[ua]=ta);va&&(qa[va]=ta);return sa.set(c('OzHelpers').msgID(ta),ta);},ra);});}var x=function na(oa,pa,qa){switch(qa){case 'messages':return w(oa,pa);case 'intents':case 'reminders':var ra=j().withMutations(function(ua){return ((oa||i()).reduce(function(va,wa){return va.set(wa.get('id'),wa);},ua));}),sa=pa.reduce(function(ua,va){var wa=va.get('id');return ua.set(wa,(ua.get(wa)||j()).merge(va));},ra).valueSeq().toList();return sa;case 'tasks':var ta=pa.map(function(ua){return ua.get('intent-id');}).toSet();return (oa.filterNot(function(ua){return ta.has(ua.get('intent-id'));}).concat(pa));case 'light-thread':return oa&&pa;default:return pa;}},y=function na(oa){return oa.set('tasks-by-intent',oa.get('tasks',i()).groupBy(function(pa){return pa.get('intent-id');}));},z=function na(oa){!(typeof oa==='function')?h(0):void 0;return function(pa,qa){!(j.isMap(qa)&&j.isMap(pa))?h(0):void 0;var ra=qa.get(u),sa=(pa.get(ra)||j()).mergeWith(oa,qa),ta=y(sa);return pa.set(ra,ta);};},aa=c('Reflux').createStore({init:function na(){this.data=j();this.updatedAt=Date.now();this.listenTo(c('OzActions').updateThreads,this._onUpdateThreads);this.listenTo(c('OzActions').maybeUpdateThreads,this._onMaybeUpdateThreads);this.listenTo(c('OzActions').clearReassignState,this._onClearReassignState);this.listenTo(c('OzActions').deleteTask,this._onDeleteTask);},getInitialState:function na(){return this.data;},_onUpdateThreads:function na(oa){!i.isList(oa)?h(0):void 0;this.data=this.data.withMutations(function(pa){return oa.reduce(z(x),pa);});this.updatedAt=Date.now();this.trigger(this.data);},_onMaybeUpdateThreads:function na(oa){!i.isList(oa)?h(0):void 0;var pa=oa.filter(function(qa){return this.data.has(qa.get(u));}.bind(this));if(pa.isEmpty()){c('OzHelpers').debug('[threads] not updating partial threads');return;}this.data=this.data.withMutations(function(qa){return pa.reduce(z(x),qa);});this.updatedAt=Date.now();this.trigger(this.data);},_onClearReassignState:function na(){this.data=this.data.map(function(oa){return (oa.get('ui-reassign')?oa['delete']('ui-reassign'):oa);});this.trigger(this.data);},_onDeleteTask:function na(oa,pa){this.data=this.data.updateIn([oa,'tasks'],function(qa){return qa.filterNot(function(ra){return ra.get('id')===pa;});});this.trigger(this.data);},metrics:function na(){return j({threadCount:this.data.count(),taskCount:this.data.reduce(function(oa,pa){return pa.get('tasks',i()).count()+oa;},0)});}}),ba=c('Reflux').createStore({init:function na(){this.data=this._make(null,null);this.listenTo(c('OzActions').showDialog,this._onShowDialog);this.listenTo(c('OzActions').hideDialog,this._onHideDialog);},getInitialState:function na(){return this.data;},_make:function na(oa,pa){return {dialogClass:oa,dialogProps:pa};},_onShowDialog:function na(oa,pa){this.data=this._make(oa,pa);this.trigger(this.data);},_onHideDialog:function na(){this.data=this._make(null,null);this.trigger(this.data);}}),ca=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').updateMerchants,this._onUpdateMerchants);this.listenTo(c('OzActions').deleteMerchants,this._onDeleteMerchants);},getInitialState:function na(){return this.data;},_onUpdateMerchants:function na(oa){!i.isList(oa)?h(0):void 0;this.data=this.data.withMutations(function(pa){return oa.reduce(function(qa,ra){var sa=ra.get('id'),ta=qa.get(sa,j()).merge(ra);return qa.set(sa,ta);},pa);});c('OzHelpers').debug('[oz] updated merchants',this.data.toJS());this.trigger(this.data);},_onDeleteMerchants:function na(oa){!i.isList(oa)?h(0):void 0;this.data=oa.reduce(function(pa,qa){return pa['delete'](qa);},this.data);c('OzHelpers').debug('[oz] deleted merchants',this.data.toJS());this.trigger(this.data);},metrics:function na(){return j({merchantCount:this.data.count()});}}),da=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').updateReps,this._onUpdateReps);this.listenTo(c('OzActions').replaceReps,this._onReplaceReps);},getInitialState:function na(){return this.data;},_onReplaceReps:function na(oa){this.data=j().withMutations(function(pa){oa.reduce(function(qa,ra){return qa.set(ra.get('fbid'),ra);},pa);});this.trigger(this.data);},_onUpdateReps:function na(oa){this.data=this.data.withMutations(function(pa){return oa.reduce(function(qa,ra){return qa.mergeIn([ra.get('fbid')],ra);},pa);});this.trigger(this.data);},metrics:function na(){return j({repCount:this.data.count()});}}),ea=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').replaceHumans,this._onReplace);},getInitialState:function na(){return this.data;},_onReplace:function na(oa){this.data=oa;this.trigger(this.data);},metrics:function na(){return j({humanCount:this.data.count()});}}),fa=c('Reflux').createStore({init:function na(){this.data=j({queue:j({showTags:m(),hideTags:m()}),all:j({showTags:m(),hideTags:m()})});this.listenTo(c('OzActions').updateQueueFilters,this._onUpdateFilters);},getInitialState:function na(){return this.data;},_onUpdateFilters:function na(oa){this.data=this.data.merge(oa);this.trigger(this.data);}}),ga=c('Reflux').createStore({init:function na(){this._data=j();this.listenTo(c('OzActions').sendMessageStart,this._onShiftSending.bind(this,1));this.listenTo(c('OzActions').sendMessageFinish,this._onShiftSending.bind(this,-1));},getInitialState:function na(){return this._data;},_onShiftSending:function na(oa,pa){this._data=this._data.update(pa,function(qa){return (qa||0)+oa;});this.trigger(this._data);}}),ha=c('Reflux').createStore({init:function na(){this.data=j({byIntent:j(),byThread:j(),byId:j()});this.listenTo(c('OzActions').addHandledEvents,this._onAddHandledEvents);},getInitialState:function na(){return this.data;},_onAddHandledEvents:function na(oa){this.data=this.data.withMutations(function(pa){oa.reduce(function(qa,ra){return (qa.setIn(['byIntent',ra.get('intent-id'),ra.get('id')],ra).setIn(['byId',ra.get('id')],ra));},pa);});this.trigger(this.data);},metrics:function na(){return j({handledEventCount:this.data.get('byId').count()});}}),ia=c('Reflux').createStore({init:function na(){this.data=j({offsetMs:0});this.listenTo(c('OzActions').updateServerOffset,this._onUpdateServerOffset);},getInitialState:function na(){return this.offsetMs;},_onUpdateServerOffset:function na(oa){var pa=oa.offsetMs;this.data=this.data.set('offsetMs',pa);this.trigger(this.data);}}),ja=j({state:'loading',error:null,result:null,skip:false}),ka=c('Reflux').createStore({init:function na(){this.data=j({skywalker:ja,init:ja,'wit-intents':ja,merchants:ja,humans:ja,requirements:ja});this.listenTo(c('OzActions').updateLoadingState,this._onUpdateLoadingState);},getInitialState:function na(){return this.data;},_onUpdateLoadingState:function na(oa){var pa=oa.component,qa=oa.state,ra=oa.error,sa=oa.result,ta=oa.skip;c('OzHelpers').info('[store/loading] '+qa+' '+pa);if(!this.data.has(pa))c('OzHelpers').warn('[store/loading] '+pa+' wasn\'t listed in LoadingStore.init');this.data=this.data.set(pa,j({state:qa,error:ra,result:sa,skip:ta}));this.trigger(this.data);}}),la=c('Reflux').createStore({init:function na(){this.data=j();this.listenTo(c('OzActions').updateCalendarEvents,this._onUpdateCalendarEvents);},getInitialState:function na(){return this.data;},_onUpdateCalendarEvents:function na(oa){var pa=oa.tid,qa=oa.calendarEvents,ra=qa&&qa.sort?qa:[];this.data=this.data.set(pa,ra.sort(function(sa,ta){var ua=new Date(sa.startDate),va=new Date(ta.startDate);return ua.getTime()-va.getTime();}));this.trigger(this.data);},metrics:function na(){return j({calendarEventCount:this.data.count()});}}),ma=c('Reflux').createStore({init:function na(){this.data=j({isStalled:false});this.listenTo(c('OzActions').skywalkerMessage,this._onSkywalkerMessage);this.listenTo(c('OzActions').skywalkerStalled,this._onSkywalkerStalled);},getInitialState:function na(){return this.data;},_onSkywalkerMessage:function na(oa){var pa=oa.timestamp;this.data=this.data.set('last-receive-ts',pa).set('isStalled',false);this.trigger(this.data);},_onSkywalkerStalled:function na(){this.data=this.data.set('isStalled',true);this.trigger(this.data);}});f.exports={ActiveThreadStore:t,BubbleStore:p,DialogStore:ba,MerchantStore:ca,AutopilotStore:q,QueueFilterStore:fa,RepStore:da,HumanStore:ea,LoadingStore:ka,RequirementStore:o,ThreadStore:aa,WitIntentStore:s,PendingMessageStateStore:ga,HandledEventsStore:ha,ServerOffsetStore:ia,CalendarEventStore:la,SkywalkerStore:ma};}),null);
__d('OzAJAX',['invariant','Promise','OzHelpers','OzNotify','OzConfig','URI'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i={metrics:{pendingCount:0,requestCount:0,failedCount:0,totalRequestMs:0,averageRequestMs:0},updateMetricsStart:function m(){i.metrics.pendingCount+=1;},updateMetricsEnd:function m(n,o){var p=i.metrics;p.pendingCount-=1;if(!n.status||n.status===0||n.status>399)p.failedCount+=1;p.requestCount+=1;p.totalRequestMs+=o;p.averageRequestMs=Math.round(p.totalRequestMs/p.requestCount);},ajax:function m(n){var o=n.type,p=n.headers,q=n.params,r=n.body,s=n.url;q=k(q);var t={type:o,url:s,headers:p,params:q,body:r};i.updateMetricsStart();var u=Date.now();return j(t).then(function(v){i.updateMetricsEnd(v,Date.now()-u);return JSON.parse(v.responseText);},function(v){i.updateMetricsEnd(v,Date.now()-u);var w=void 0;try{w=JSON.parse(v.responseText);}catch(x){}l(w||{},v,t);throw w||v;});},beacon:function m(n){!(window.navigator&&window.navigator.sendBeacon)?h(0):void 0;var o=n.params,p=n.body,q=n.url;o=k(o);return window.navigator.sendBeacon(new (c('URI'))(q).addQueryData(o).toString(),new Blob([p],{type:'application/json'}));},buildURI:function m(){var n=c('OzConfig').getStaticConfig('API_PATH');!n?h(0):void 0;for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return [n].concat(p).join('/');}};function j(m){var n=m.type,o=m.headers,p=m.params,q=m.body,r=m.url;return new (c('Promise'))(function(s,t){var u=new XMLHttpRequest(),v=new (c('URI'))(r);if(p)v.addQueryData(p);u.timeout=1000*60*3;u.open(n,v.toString(),true);if(o)for(var w=Object.keys(o),x=Array.isArray(w),y=0,w=x?w:w[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var z;if(x){if(y>=w.length)break;z=w[y++];}else{y=w.next();if(y.done)break;z=y.value;}var aa=z;u.setRequestHeader(aa,o[aa]);}u.onreadystatechange=function(){if(u.readyState!==4)return;if(u.status===200){s(u);}else t(u);};u.send(q);});}function k(m){!c('OzConfig').getStaticConfig('authToken')?h(0):void 0;!c('OzConfig').getStaticConfig('uid')?h(0):void 0;!c('OzConfig').getStaticConfig('API_VERSION')?h(0):void 0;return babelHelpers['extends']({xs:c('OzConfig').getStaticConfig('authToken'),c_user:c('OzConfig').getStaticConfig('uid'),rep_name:c('OzConfig').getStaticConfig('fullName'),v:c('OzConfig').getStaticConfig('API_VERSION')},m);}function l(m,n,o){c('OzHelpers').error('[oz-api] backend rejected',m,n,o);var p=m.error||'Something went wrong, the team has been notified already.';if(m.info){c('OzNotify').info(p);}else if(n.status===400){c('OzNotify').warn(p);}else if(n.status===0){c('OzNotify').error('Something went wrong. If this continues, please contact the Wit oncall');}else c('OzNotify').error(p);}f.exports=i;}),null);
__d('OzEditorStateHelpers',['ContentState','OzHelpers','DraftModifier','EditorState','UnicodeUtils'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(s,t){var u=c('ContentState').createFromText(t),v=c('EditorState').push(s,u,'remove-range');v=c('EditorState').forceSelection(v,v.getSelection());return v;}function i(s){var t=s.getCurrentContent().getBlockMap(),u=s.getSelection().getStartKey();return t.get(u);}function j(s,t){return s.getCurrentContent().getPlainText().indexOf(t)>=0;}function k(s){var t=q(s,function(u){var v=u.getSelection();if(v.getStartOffset()===0)return r(u,1);var w=i(u).getText().length;return v.merge({anchorOffset:w,focusOffset:0,isBackward:true});},'backward');if(t===s.getCurrentContent())return s;return c('EditorState').push(s,t,'remove-range');}function l(s,t){var u=s.getCurrentContent(),v=i(s).getText(),w=s.getSelection().merge({anchorOffset:0,focusOffset:v.length}),x=c('DraftModifier').replaceText(u,w,t);c('OzHelpers').debug('[replaceLine]',t,v,x.getPlainText());if(x===u)return s;return c('EditorState').push(s,x,'remove-range');}function m(s,t){var u=s.getCurrentContent(),v=c('DraftModifier').insertText(u,u.getSelectionAfter(),t);if(v===u)return s;return c('EditorState').push(s,v,'insert-characters');}function n(s,t){var u=i(s).getText(),v=u.length;if(v===0)return false;t=Math.min(t,v-1);return u[t];}function o(s,t){var u=s.getSelection().merge({focusOffset:t,anchorOffset:t});return c('EditorState').forceSelection(s,u);}function p(s,t){var u=q(s,function(w){var x=w.getSelection(),y=w.getCurrentContent(),z=x.getAnchorKey(),aa=x.getAnchorOffset(),ba=y.getBlockForKey(z).getText().slice(aa-t,aa);return r(w,ba?c('UnicodeUtils').strlen(ba):1);},'backward');if(u===s.getCurrentContent())return s;u=u.set('selectionBefore',s.getSelection());var v=s.getSelection().isCollapsed()?'backspace-character':'remove-range';return c('EditorState').push(s,u,v);}function q(s,t,u){var v=s.getSelection(),w=s.getCurrentContent(),x=v;if(v.isCollapsed()){if(u==='forward'){if(s.isSelectionAtEndOfContent())return w;}else if(s.isSelectionAtStartOfContent())return w;x=t(s);if(x===v)return w;}return c('DraftModifier').removeRange(w,x,u);}function r(s,t){var u=s.getSelection(),v=s.getCurrentContent(),w=u.getStartKey(),x=u.getStartOffset(),y=w,z=0;if(t>x){var aa=v.getKeyBefore(w);if(aa==null){y=w;}else{y=aa;var ba=v.getBlockForKey(aa);z=ba.getText().length;}}else z=x-t;return u.merge({focusKey:y,focusOffset:z,isBackward:true});}f.exports={append:m,backspaceTimes:p,charAt:n,currentBlock:i,deleteCurrentLine:k,editorStateHas:j,forceCollapsedSelection:o,replaceContentWithText:h,replaceLine:l};}),null);
__d('OzHistory',['invariant','immutable'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').List,j=c('immutable').OrderedMap,k='oz-history',l=10,m=100;function n(){return j(JSON.parse(localStorage.getItem(k)||'{}')).map(function(s){return i(s);});}function o(s){!j.isOrderedMap(s)?h(0):void 0;return localStorage.setItem(k,JSON.stringify(s));}function p(s){var t=n();if(t.has(s))return;o(t.set(s,[]).takeLast(l));}function q(s){var t={},u={items:function v(){if(!t.items)t.items=n().get(s);return t.items;},persist:function v(w){!i.isList(w)?h(0):void 0;o(n().set(s,w));t.items=w;u.resetPos();},resetPos:function v(){t.pos=u.items().size;},pos:function v(){if(!Number.isSafeInteger(t.pos))u.resetPos();return t.pos;},dec:function v(){t.pos=Math.max(u.pos()-1,0);},inc:function v(){t.pos=Math.min(u.pos()+1,u.items().size);},val:function v(){return u.items().get(u.pos());}};return u;}function r(s){p(s);var t=q(s);return {up:function v(){t.dec();return t.val();},down:function v(){t.inc();return t.val();},push:function v(w){var x=t.items();if(!w||x.last()===w)return;t.persist(x.push(w).takeLast(m));}};}f.exports=r;}),null);
__d('OzHumans',['OzHelpers'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=60000,i=45000,j=-1;function k(s){return s.get('coach-mode?');}function l(s){return s.get('is-coach');}function m(s){return s.get('away?');}function n(s){return s&&!m(s)&&c('OzHelpers').serverNow()-s.get('at',0)<i;}function o(s){return n(s)&&s.get('inactive-ms',0)<h;}function p(s){return o(s)&&s.get('load',0)<=0&&s.get('team',j)!==j;}function q(s){return o(s)&&!k(s);}function r(s){var t=s.filter(q).count(),u=s.reduce(function(v,w){return v+w.get('load',0);},0);return u/t;}f.exports={inCoachMode:k,isCoach:l,isAway:m,isPresent:n,isActive:o,isIdle:p,isWorking:q,avgLoad:r};}),null);
__d('OzInboxThreads',['OzHelpers','OzConfig'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h='GRABBED',i='VIEWING',j='PAST';function k(n){return c('OzConfig').ConfigStore.data.getIn(['GK','responsivenessV2'])?Math.max(c('OzHelpers').unreadTs(n)||0,n.get('last-event-at',0)):n.get('last-event-at',0);}function l(n){var o=function p(q){return q.get('locked-at')&&q.get('locker-id')===n;};return function(p,q){if(o(p)&&!o(q)){return -1;}else if(!o(p)&&o(q)){return 1;}else return c('OzHelpers').compareNums(k(p),k(q));};}var m=c('OzHelpers').memoize(function(n,o){var p=arguments.length<=2||arguments[2]===undefined?'':arguments[2],q=l(o);return n.filter(function(r){var s=c('OzHelpers').isOwner(r,o),t=c('OzHelpers').isLocker(r,o),u=c('OzHelpers').isSubscriber(r,o),v=c('OzHelpers').wasOwner(r,o),w=c('OzHelpers').hasOpenIntents(r);switch(p){case h:return ((s||r.get('ui-reassign')&&v)&&(r.get('ready')||w||t));case i:return u;case j:return (v||s&&!r.get('ready')&&!w);default:return s||u;}}).sort(q);},function(n,o){var p=arguments.length<=2||arguments[2]===undefined?'':arguments[2];return n.hashCode()+o+p;},3);f.exports={getInboxThreads:m,OZ_GRABBED_TAB:h,OZ_VIEWING_TAB:i,OZ_PAST_TAB:j};}),null);
__d('OzLocationSearchSource',['WebAsyncSearchSource'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={allow_places:true,include_likes:false,include_subtext:true,include_address:1,limit:5,map_height:null,map_width:null,render_map:false,use_searchable_entries:true,use_unicorn:true},i=new (c('WebAsyncSearchSource'))({bootstrapRequests:[{uri:'/ajax/places/typeahead',data:h}],getAllForEmptyQuery:true,queryRequests:[{uri:'/ajax/places/typeahead',data:babelHelpers['extends']({},h,{hide_geo:true})}]});i.search('',function(j){return j;});f.exports=i;}),null);
__d('OzBugNub.react',['cx','fbt','Link.react','OzImmutablePureRenderMixin','React','Tooltip','URI'],(function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=1031744366845008,k='Error:\n\nExpected Result:\n\nSteps taken before error occurred:\n',l=c('React').createClass({displayName:'MessengerBugNub',mixins:[c('OzImmutablePureRenderMixin')],render:function m(){var n=new (c('URI'))('/ajax/bugs/report').setQueryData({config_id:j,defaultText:k});return (c('React').createElement('div',{className:"_gml"},c('React').createElement(c('Link.react'),babelHelpers['extends']({href:'#',ajaxify:n,className:"_gmm",rel:'dialog'},c('Tooltip').propsFor(i._("\u56de\u5831\u554f\u984c"))),c('React').createElement('span',{className:"_gmn"}))));}});f.exports=l;}),null);
__d('OzDialogContainer.react',['OzStores','React','Reflux'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('OzStores').DialogStore,i=c('React').createClass({displayName:'OzDialogContainer',mixins:[c('Reflux').connect(h,'dialog')],render:function j(){var k=this.state.dialog.dialogClass;if(k){var l=this.state.dialog.dialogProps||{};return c('React').createElement(k,babelHelpers['extends']({ref:'dialog'},l,{key:'dialog'}));}return null;}});f.exports=i;}),null);
__d('OzExtensionCheck.react',['cx','MessengerDialogHeader.react','MessengerDialogTitle.react','OzActions','React','ReloadPage','SUIAtlasTheme','SUINotice.react','XUIDialog.react'],(function a(b,c,d,e,f,g,h){var i,j,k,l;if(c.__markCompiled)c.__markCompiled();var m=c('React').PropTypes;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;n.prototype.render=function(){'use strict';return (c('React').createElement(c('XUIDialog.react'),{width:544,shown:true,layerHideOnBlur:false,className:"_4ebx"},c('React').createElement('div',{className:"_4eby _2c9g _1-6z"},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogTitle.react'),null,'The Oz Chrome Extension is missing')),c('React').createElement(c('SUINotice.react'),{theme:c('SUIAtlasTheme'),type:'error'},c('React').createElement('div',{className:"_4d80"},'Toto, the oz chrome extension that helps you manage your tabs, and record what was done for each task in the background is missing!',c('React').createElement('strong',null,c('React').createElement('a',{onClick:this.props.onInstall},' Click here to install it.')))))));};function n(){'use strict';i.apply(this,arguments);}n.propTypes={onInstall:m.func.isRequired};k=babelHelpers.inherits(o,c('React').Component);l=k&&k.prototype;function o(){var p,q;'use strict';for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=l.constructor).call.apply(q,[this].concat(s)),this.$OzExtensionCheck1=function(){window.chrome.webstore.install(undefined,function(u){return c('ReloadPage').now();});},p;}o.prototype.componentDidMount=function(){'use strict';var p=!!document.querySelector('#toto-installed');if(p)return;c('OzActions').showDialog(n,{onInstall:this.$OzExtensionCheck1});};o.prototype.render=function(){'use strict';return null;};f.exports=o;}),null);
__d('OzButton.react',['cx','joinClasses','promiseFinally','React'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzButton',propTypes:{disabled:i.bool,onClick:i.func,primary:i.bool,tight:i.bool,type:i.oneOf(['button','submit','reset']),use:i.oneOf(['default','warning','danger'])},getDefaultProps:function k(){return {disabled:false,primary:false,tight:false,type:'button',use:'default'};},getInitialState:function k(){return {loading:false};},render:function k(){var l=this.props,m=l.children,n=l.className,o=l.disabled,p=l.onClick,q=l.primary,r=l.tight,s=l.type,t=l.use,u=babelHelpers.objectWithoutProperties(l,['children','className','disabled','onClick','primary','tight','type','use']),v=this.state.loading,w=c('joinClasses')(n,"_325k"+(v?' '+"_3e2u":'')+(q?' '+"_325m":'')+(r?' '+"_4wku":'')+(t==='default'?' '+"_325o":'')+(t==='warning'?' '+"_325p":'')+(t==='danger'?' '+"_325q":'')+(o?' '+"_ysb":'')+(!o&&!v?' '+"_4wkv":'')+(' '+"_1-hv"));return (c('React').createElement('button',babelHelpers['extends']({className:w,disabled:o,onClick:this._handleClick,type:s},u),c('React').createElement('span',{className:"_325r"},m)));},_handleClick:function k(l){var m=this.props,n=m.disabled,o=m.loading,p=m.onClick;if(n||o){l.preventDefault();return;}if(!p)return;if(p.length>1){this.setState({loading:true});p(l,this._done);return;}var q=p(l);if(q&&q.then){this.setState({loading:true});c('promiseFinally')(q,this._done);}},_done:function k(){if(this.isMounted())this.setState({loading:false});}});f.exports=j;}),null);
__d('OzFailed.react',['cx','immutable','OzButton.react','React','ReloadPage'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('immutable').Iterable,l=c('React').PropTypes;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.prototype.render=function(){'use strict';return (c('React').createElement('div',{className:"_30r7"},c('React').createElement('div',{className:"_4rg-"},c('React').createElement('div',null,'Oz couldn\'t load the following resources:',c('React').createElement('ul',null,this.props.problems.map(function(n,o){return c('React').createElement('li',{key:o},n);})),'Please wait a few seconds, then refresh. If this problem persists for more than a minute or so, contact the oncall.'),c('React').createElement('div',{className:"_4rg_"},c('React').createElement(c('OzButton.react'),{primary:true,onClick:c('ReloadPage').now},'Refresh')))));};function m(){'use strict';i.apply(this,arguments);}m.propTypes={problems:l.instanceOf(k)};f.exports=m;}),null);
__d('OzReps',['OzHelpers'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=1000*60*60*8;function i(l){return !l||c('OzHelpers').serverNow()-l.get('updated-at',0)>h;}function j(l){var m=l.get('stats');return i(m)?0:m.get('closed-intents',0);}function k(l,m){var n=l.get('team');return m.reduce(function(o,p){return o+(p.get('team')===n?j(p):0);},0);}f.exports={closedIntentCount:j,teamClosedIntentCount:k};}),null);
__d('OzTriSwitch.react',['cx','React','joinClasses'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(k){var l=k.className,m=k.value,n=k.onClick,o=k.label,p=k.animated,q=babelHelpers.objectWithoutProperties(k,['className','value','onClick','label','animated']);return (c('React').createElement('div',babelHelpers['extends']({},q,{className:c('joinClasses')(l,"_56de"+(q.reverseColors?' '+"_3tyl":'')+(p?' '+"_56df":'')+(m==='on'?' '+"_56dg":'')+(m==='off'?' '+"_56dh":'')+(m==='neutral'?' '+"_56di":'')),onClick:function(r){function s(t){return r.apply(this,arguments);}s.toString=function(){return r.toString();};return s;}(function(r){return n(j[m]);}),role:'checkbox'}),c('React').createElement('div',{className:"_56dj",tabIndex:'0'},c('React').createElement('div',{className:"_56dk"})),o?c('React').createElement('span',{className:"_56dn"},o):null));}var j={on:'off',off:'neutral',neutral:'on'};i.toBoolean=function(k){if(k==='neutral')return undefined;if(k==='on')return true;if(k==='off')return false;throw new Error('OzTriSwitch: unknown state '+k);};i.fromBoolean=function(k){return k==null?'neutral':k?'on':'off';};f.exports=i;}),null);
__d('OzSwitch.react',['OzImmutablePureRenderMixin','OzTriSwitch.react','React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=c('React').createClass({displayName:'OzSwitch',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{isAnimated:h.bool.isRequired,isOn:h.bool.isRequired,label:h.node.isRequired,onToggle:h.func.isRequired,reverseColors:h.bool},getDefaultProps:function j(){return {isAnimated:false};},render:function j(){var k=this.props,l=k.className,m=k.isAnimated,n=k.isOn,o=k.label,p=k.onToggle;return (c('React').createElement(c('OzTriSwitch.react'),{animated:m,className:l,reverseColors:!!this.props.reverseColors,label:o,onClick:function q(){return p(!n);},value:c('OzTriSwitch.react').fromBoolean(n)}));}});f.exports=i;}),null);
__d("OzReactMetrics",[],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={},i=function l(){return {mountCount:0,mountAvgMs:0,mountTotalMs:0,updateCount:0,updateAvgMs:0,updateTotalMs:0};},j=function l(m,n){if(!h[m])h[m]=i();h[m].mountCount+=1;h[m].mountTotalMs+=n;h[m].mountAvgMs=h[m].mountTotalMs/h[m].mountCount;},k=function l(m,n){if(!h[m])h[m]=i();h[m].updateCount+=1;h[m].updateTotalMs+=n;h[m].updateAvgMs=h[m].updateTotalMs/h[m].updateCount;};f.exports={metrics:h,updateMount:j,updateUpdate:k};}),null);
__d('OzWrapper.react',['React','OzReactMetrics'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){var j,k;j=babelHelpers.inherits(l,c('React').Component);k=j&&j.prototype;l.prototype.componentWillMount=function(){'use strict';this.$Comp1=Date.now();};l.prototype.componentDidMount=function(){'use strict';var m=Date.now()-this.$Comp1;c('OzReactMetrics').updateMount(i.displayName,m);};l.prototype.componentWillUpdate=function(){'use strict';this.$Comp2=Date.now();};l.prototype.componentDidUpdate=function(){'use strict';var m=Date.now()-this.$Comp2;c('OzReactMetrics').updateUpdate(i.displayName,m);};l.prototype.render=function(){'use strict';return c('React').createElement(i,babelHelpers['extends']({},this.props,this.state));};function l(){'use strict';j.apply(this,arguments);}return l;}f.exports=h;}),null);
__d('OzHeader.react',['cx','OzHelpers','immutable','Layout.react','MessengerButton.react','OzButton.react','OzConfig','OzHumans','OzReps','OzStores','OzSwitch.react','React','OzWrapper.react','Reflux','ReactRouter','Tooltip'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('OzStores').RepStore,k=c('OzStores').HumanStore,l=c('ReactRouter').Link,m=c('React').PropTypes,n=c('React').createClass({displayName:'OzHeader',mixins:[c('Reflux').connect(k,'humans'),c('Reflux').connect(j,'reps'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{coachMode:m.bool.isRequired,rev:m.number.isRequired,version:m.string.isRequired,onAway:m.func.isRequired,onCoachModeToggle:m.func.isRequired,params:m.object.isRequired},contextTypes:{uid:m.string.isRequired,router:m.object.isRequired},render:function p(){var q='/inbox/'+(this.props.params.threadid||''),r=this.state.humans.getIn([this.context.uid,'load'],0),s='Inbox'+(r?' ('+r+')':''),t=this.state.config.get('GK',i());return (c('React').createElement(c('Layout.react'),{className:"_2d86"},c('React').createElement('div',{className:"_2d87"},c('React').createElement(l,{to:'/',className:"_2d88"}),this._renderItem(s,q),this._renderItem('Merchants','/merchants'),this._renderItem('Feedback','/feedback'),this._renderItem('Stats','/stats'),this._renderItem('Top','/top'),t.get('IntentDashboard')&&this._renderItem('Intents','/intents'),t.get('AIDashboard')&&this._renderItem('AI','/ai'),t.get('supervisor')&&this._renderItem('Trainers','/trainers'),t.get('allThreads')&&this._renderItem('All Threads','/all')),c('React').createElement('div',{className:"_j6m"},c('React').createElement(o,{humans:this.state.humans,reps:this.state.reps,uid:this.context.uid})),c('React').createElement(c('MessengerButton.react'),{label:'Away',className:"_4s9f",type:'primary',onClick:this.props.onAway}),t.get('supervisor')?c('React').createElement(c('OzSwitch.react'),{className:"_b8c",isAnimated:true,isOn:this.props.coachMode,label:'Coach Mode',onToggle:this.props.onCoachModeToggle}):null));},_renderItem:function p(q,r){return (c('React').createElement(l,{activeClassName:'active',className:"_33os",to:r},c('React').createElement('span',null,q)));}}),o=c('OzHelpers').pure(function(p){var q=p.reps,r=p.humans,s=p.uid,t=q.get(s,i()),u=c('OzReps').closedIntentCount(t),v=c('OzReps').teamClosedIntentCount(t,q),w=Math.round(c('OzHumans').avgLoad(r)),x=isFinite(w)?w:'N/A',y=r.filter(c('OzHumans').isWorking).count();return (c('React').createElement('div',null,c('React').createElement('span',babelHelpers['extends']({className:"_3fs"},c('Tooltip').propsFor('Your closed intents')),u),c('React').createElement('span',{className:"_4s9g"},'closed by you'),' ',c('React').createElement('span',babelHelpers['extends']({className:"_3fs"},c('Tooltip').propsFor('Closed intents for your entire team')),v),c('React').createElement('span',{className:"_4s9g"},'closed by team'),c('React').createElement('span',{className:"_3fs"},x),c('React').createElement('span',{className:"_4s9g"},'average load'),c('React').createElement('span',{className:"_3fs"},y),c('React').createElement('span',{className:"_4s9g"},y===1?'trainer':'trainers')));});f.exports=c('OzWrapper.react')(n);}),null);
__d('OzLoading.react',['cx','MessengerFlexArea.react','MessengerSpinner.react','React'],(function a(b,c,d,e,f,g,h){var i,j,k,l;if(c.__markCompiled)c.__markCompiled();var m=c('React').PropTypes;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;n.prototype.render=function(){'use strict';return (c('React').createElement('div',{className:"_30r7"},c('React').createElement(c('MessengerSpinner.react'),{color:this.props.color}),c('React').createElement('div',{className:"_4rg-",style:{marginLeft:'10px'}},this.props.message)));};function n(){'use strict';i.apply(this,arguments);}n.propTypes={message:m.node,color:m.oneOf(["grey","blue"])};n.defaultProps={color:"blue"};n.Inline=(l=k=function(){var o,p;o=babelHelpers.inherits(q,c('React').Component);p=o&&o.prototype;q.prototype.render=function(){'use strict';var r=this.props,s=r.loading,t=babelHelpers.objectWithoutProperties(r,['loading']);if(!s)return null;return (c('React').createElement('div',{className:"_nkb"},c('React').createElement(n,t)));};function q(){'use strict';o.apply(this,arguments);}return q;}(),k.propTypes={loading:m.bool.isRequired},l);n.Flex=function(){var o,p;o=babelHelpers.inherits(q,c('React').Component);p=o&&o.prototype;q.prototype.render=function(){'use strict';return (c('React').createElement(c('MessengerFlexArea.react'),null,c('React').createElement(n,this.props)));};function q(){'use strict';o.apply(this,arguments);}return q;}();f.exports=n;}),null);
__d('OzDate.react',['cx','formatDate','immutable','joinClasses','React'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=c('immutable').fromJS([{start:0,end:7*24*3600000,format:'D g:ia'},{start:7*24*3600000,end:365*24*3600000,format:'M jS, g:ia'},{start:365*24*3600000,end:Infinity,format:'m/d/Y g:ia'}]);i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.formatTimestamp=function(n){'use strict';if(n<Date.now()+24*3600000){return c('formatDate')(new Date(n),{today:'g:ia',thisYear:'M jS, g:ia',older:'m/d/Y g:ia'});}else return c('formatDate')(new Date(n),l.find(function(o){return n>Date.now()+o.get('start')&&n<Date.now()+o.get('end');}).get('format'));};m.prototype.render=function(){'use strict';var n=this.constructor.formatTimestamp(this.props.timestamp);return (c('React').createElement('time',{className:c('joinClasses')("_2s4p",this.props.className)},n));};function m(){'use strict';i.apply(this,arguments);}m.propTypes={timestamp:k.number.isRequired};f.exports=m;}),null);
__d('OzDraggable.react',['cx','Draggable','joinClasses','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzDraggable',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{getHandle:i.func},componentDidMount:function k(){this._draggable=new (c('Draggable'))(this.refs.root).setUseAbsolute(true).setGutter(15);this._updateHandle();},componentDidUpdate:function k(){this._updateHandle();},_updateHandle:function k(){if(this._handle)this._draggable.removeHandle(this._handle);this._handle=(this.props.getHandle||function(){return this.refs.root;}.bind(this))();this._draggable.addHandle(this._handle);},render:function k(){var l=this.props,m=l.children,n=l.className,o=babelHelpers.objectWithoutProperties(l,['children','className']);return (c('React').createElement('div',{className:"_5k4j"},c('React').createElement('div',babelHelpers['extends']({className:c('joinClasses')("_2c1d",n),ref:'root'},o),m)));},componentWillUnmount:function k(){this._draggable&&this._draggable.destroy();}});f.exports=j;}),null);
__d('OzDraggableModal.react',['cx','joinClasses','OzDraggable.react','React'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('React').PureComponent);j=i&&i.prototype;k.prototype.render=function(){'use strict';var l=this.props,m=l.children,n=l.className,o=babelHelpers.objectWithoutProperties(l,['children','className']);return (c('React').createElement(c('OzDraggable.react'),babelHelpers['extends']({className:c('joinClasses')("_5d80",n)},o),m));};function k(){'use strict';i.apply(this,arguments);}f.exports=k;}),null);
__d('OzUserImage.react',['cx','joinClasses','Image.react','immutable','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzUserImage',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{photo:j.object},render:function l(){var m=c('joinClasses')(this.props.className,"_3c52 _3c53"),n=function p(q){return c('React').createElement(c('Image.react'),{className:m,src:q});},o=this.props.photo||i();return (o.getIn(['data','url'])&&n(o.getIn(['data','url']))||o.get('data')&&n(o.get('mime_type')+','+o.get('data'))||c('React').createElement('span',{className:c('joinClasses')(m,"_3ejm")}));}});f.exports=k;}),null);
__d('OzSearch.react',['cx','OzAPI','OzHelpers','Image.react','immutable','Keys','OzActions','OzDate.react','OzDraggableModal.react','OzStores','OzUserImage.react','ReactComponentWithPureRenderMixin','React','Reflux','XUITextInput.react','OzConfig','debounce'],(function a(b,c,d,e,f,g,h){var i,j,k,l,m;if(c.__markCompiled)c.__markCompiled();var n=c('immutable').List,o=c('immutable').Map,p=c('React').PropTypes,q=c('OzStores').ActiveThreadStore,r=c('OzStores').ThreadStore,s='Messages',t='Side Bar',u='Users',v='Calendars',w='All',x=[s,t,u,v,w],y=(m={},m[s]='messages',m[t]='side-bar',m[u]='users',m[v]='calendar-event',m[w]='all',m),z=c('React').createClass({displayName:'OzSearch',mixins:[c('ReactComponentWithPureRenderMixin'),c('Reflux').connect(q,'activeThread'),c('Reflux').connect(r,'threads'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],contextTypes:{router:p.object.isRequired},componentWillMount:function la(){this._handleTyping=c('debounce')(this._handleTyping,300,this,true);this.setState({calendarGK:this.state.config.get('GK',o()).get('calendar')});},componentDidMount:function la(){document.addEventListener('keydown',this._handleKBShortcuts);this._unlisten=function(){document.removeEventListener('keydown',this._handleKBShortcuts);}.bind(this);this._focusSearch();},getInitialState:function la(){return {currentTab:s,results:n([]),selected:-1,shown:false,text:'',calendarGK:false};},componentWillUnmount:function la(){this._unlisten();},render:function la(){var ma=this.state,na=ma.shown,oa=ma.currentTab,pa=ma.results,qa=ma.selected,ra=ma.threads;if(!na){return null;}else return (c('React').createElement(c('OzDraggableModal.react'),{className:"_cxg"},c('React').createElement(c('XUITextInput.react'),{className:"_cxh",placeholder:'Search...',ref:'searchBar',onChange:function(sa){return this._handleTyping(sa.target.value);}.bind(this)}),c('React').createElement('div',{className:"_cxi"},c('React').createElement(ca,{tabs:x,currentTab:oa,onClickTab:this._handleChangeTab,calendarGK:this.state.calendarGK}),c('React').createElement(da,{onClick:this._handleSelectResult,results:pa,selected:qa,threads:ra,calendarGK:this.state.calendarGK}))));},_search:function la(){var ma=this.state,na=ma.text,oa=ma.currentTab,pa=ma.activeThread,qa={text:na,type:y[oa]};if(oa===t||oa===s)qa['user-id']=pa.get('threadID');c('OzAPI').search(qa).then(function(ra){this.setState({results:ra,selected:0});}.bind(this)).done();},_handleTyping:function la(ma){this.setState({text:ma},this._search);},_handleChangeTab:function la(ma){var na=this.state.text;this.setState({currentTab:ma},function(oa){na.length&&this._search();}.bind(this));},_handleSelectResult:function la(ma){switch(ma.get('_type')){case 'user':this._handleSelectResultUser(ma);break;case 'event':switch(ma.getIn(['_source','type'])){case 'message':case 'message-from-page':this._handleSelectResultMessage(ma);break;case 'send-email':case 'receive-email':this._handleSelectResultEmail(ma);break;case 'calendar-event':this._handleSelectResultCalendarEvent(ma);break;default:}break;default:}this.setState({shown:false});},_handleSelectResultUser:function la(ma){var na=ma.getIn(['_source','user-id']);this.context.router.push('/inbox/'+na);},_handleSelectResultMessage:function la(ma){var na=ma.getIn(['_source','user-id']),oa=ma.getIn(['_source','timestamp']);this.context.router.push('/inbox/'+na);this._createTransitionListener(na,oa);},_createTransitionListener:function la(ma,na){this._transitionListenerId=window.setInterval(function(oa){var pa=this.context.router.isActive('/inbox/'+ma);if(pa){c('OzActions').scrollThreadToTimestamp(na);window.clearInterval(this._transitionListenerId);}}.bind(this),100);},_handleSelectResultEmail:function la(ma){var na=ma.getIn(['_source','user-id']),oa=ma.getIn(['_source','intent-id']);this.context.router.push('/inbox/'+na+'/intent/'+oa);},_handleSelectResultCalendarEvent:function la(ma){var na=ma.getIn(['_source','user-id']);this.context.router.push('/inbox/'+na);},_toggleShown:function la(){this.setState({shown:!this.state.shown});},_focusSearch:function la(){this.refs.searchBar&&this.refs.searchBar.focusInput();},_handleKBShortcuts:function la(ma){var na=this.state,oa=na.results,pa=na.selected,qa=na.shown,ra=na.calendarGK;if(ka(ma)||ma.which===c('Keys').ESC&&qa){ma.preventDefault();this._toggleShown();!qa&&this._focusSearch();}else if(qa)switch(ma.which){case c('Keys').DOWN:ma.preventDefault();this.setState({selected:Math.min(pa+1,ba(oa,ra).count()-1)});break;case c('Keys').UP:ma.preventDefault();this.setState({selected:Math.max(pa-1,0)});break;case c('Keys').RETURN:ma.preventDefault();pa&&this._handleSelectResult(ba(oa,ra).get(pa));break;case c('Keys').TAB:ma.preventDefault();var sa=x.indexOf(this.state.currentTab),ta=x.length;if(ma.getModifierState('Shift')){sa=(sa-1+ta)%ta;if(!ra&&sa===3)sa--;}else{sa++;if(!ra&&sa===3)sa++;sa%=ta;}this._handleChangeTab(x[sa]);break;}}}),aa=function la(ma){return function(na){var oa=na.get('_type');switch(oa){case 'user':return true;case 'event':var pa=na.getIn(['_source','type']);if(pa=='calendar-event'&&!ma)return false;return pa=='message'||pa=='message-from-page'||pa=='send-email'||pa=='receive-email'||pa=='calendar-event';default:return false;}};},ba=function la(ma,na){return (ma.filter(aa(na)).sortBy(function(oa){return oa.getIn(['_source','timestamp']);}).reverse());};i=babelHelpers.inherits(ca,c('React').PureComponent);j=i&&i.prototype;ca.prototype.render=function(){'use strict';var la=this.props,ma=la.tabs,na=la.currentTab,oa=la.onClickTab;return (c('React').createElement('div',{className:"_cxj"},n(ma).map(function(pa){if(!this.props.calendarGK&&pa===v){return null;}else return (c('React').createElement('div',{onClick:function qa(ra){return oa(pa);},key:pa,className:(pa===na?"_cxk":'')+(' '+"_cxl")},pa));}.bind(this)).toSeq()));};function ca(){'use strict';i.apply(this,arguments);}ca.propTypes={tabs:p.arrayOf(p.string).isRequired,currentTab:p.string.isRequired,onClickTab:p.func.isRequired,calendarGK:p.bool.isRequired};k=babelHelpers.inherits(da,c('React').PureComponent);l=k&&k.prototype;da.prototype.render=function(){'use strict';var la=this.props,ma=la.onClick,na=la.results,oa=la.selected,pa=la.threads;return (c('React').createElement('div',{className:"_cxm"},ba(na,this.props.calendarGK).map(function(qa,ra){switch(qa.get('_type')){case 'user':return (c('React').createElement(fa,{result:qa,selected:oa==ra,threads:pa,onClick:ma}));case 'event':switch(qa.getIn(['_source','type'])){case 'message-from-page':if(qa.getIn(['_source','data','attachments']))return (c('React').createElement(ha,{result:qa,selected:oa==ra,threads:pa,onClick:ma}));case 'message':return (c('React').createElement(ga,{result:qa,selected:oa==ra,threads:pa,onClick:ma}));case 'send-email':case 'receive-email':return (c('React').createElement(ia,{result:qa,selected:oa==ra,threads:pa,onClick:ma}));case 'calendar-event':return (c('React').createElement(ja,{result:qa,selected:oa==ra,threads:pa,onClick:ma}));default:return null;}default:return null;}})));};function da(){'use strict';k.apply(this,arguments);}da.propTypes={onClick:p.func,results:p.instanceOf(n),selected:p.number,threads:p.instanceOf(o).isRequired,calendarGK:p.bool.isRequired};var ea=c('OzHelpers').pure(function(la){var ma=la.image,na=la.text,oa=la.selected,pa=la.onClick,qa=la.timestamp;return (c('React').createElement('div',{className:"_cxn",id:oa?'selected':null,onClick:pa},ma,c('React').createElement('div',{className:"_4fwg"},c('React').createElement('div',{className:"_4fwh"},c('React').createElement('div',{className:"_4fwi"},na)),qa?c('React').createElement(c('OzDate.react'),{className:"_4fwj",timestamp:qa}):c('React').createElement('div',{className:"_4fwk"}))));}),fa=c('OzHelpers').pure(function(la){var ma=la.result,na=la.onClick,oa=la.selected,pa=la.threads,qa=ma.getIn(['_source','user-id']),ra=ma.getIn(['_source','user-name']),sa=pa.get(qa);if(!sa)c('OzAPI').thread(qa);return (c('React').createElement(ea,{onClick:function ta(ua){return na(ma);},selected:oa,image:sa?c('React').createElement(c('OzUserImage.react'),{photo:c('OzHelpers').photo(sa),className:"_cxp"}):null,text:ra}));}),ga=c('OzHelpers').pure(function(la){var ma=la.result,na=la.onClick,oa=la.selected,pa=la.threads,qa=ma.getIn(['_source','user-id']),ra=ma.getIn(['_source','data','text']),sa=ma.getIn(['_source','type'])==='message',ta=pa.get(qa);if(sa&&!ta)c('OzAPI').thread(qa);var ua=sa?ta?c('React').createElement(c('OzUserImage.react'),{photo:c('OzHelpers').photo(ta),className:"_cxp"}):null:c('React').createElement(c('Image.react'),{src:'/images/oz/icons/OzMessengerLogo.png',className:"_cxp"});return (c('React').createElement(ea,{onClick:function va(wa){return na(ma);},selected:oa,image:ua,text:ra,timestamp:ma.getIn(['_source','timestamp'])}));}),ha=c('OzHelpers').pure(function(la){var ma=la.result,na=la.onClick,oa=la.selected,pa=la.threads,qa=ma.getIn(['_source','data','attachments',0,'metadata']),ra=qa.get('name'),sa=qa.get('desc'),ta=qa.get('thumb_url');return (c('React').createElement(ea,{onClick:function ua(va){return na(ma);},selected:oa,image:c('React').createElement(c('Image.react'),{src:ta,className:"_cxp"}),text:ra+' - '+sa,timestamp:ma.getIn(['_source','timestamp'])}));}),ia=c('OzHelpers').pure(function(la){var ma=la.result,na=la.onClick,oa=la.selected,pa=la.threads,qa=ma.getIn(['_source','data']),ra=qa.get('to'),sa=qa.get('subject'),ta=(ra?'To: '+ra.toJS().join(', ')+' - ':'')+sa,ua=c('React').createElement(c('Image.react'),{src:'/images/nux_icon_gmail.gif',className:"_cxr _cxp"});return (c('React').createElement(ea,{onClick:function va(wa){return na(ma);},selected:oa,image:ua,text:ta,timestamp:ma.getIn(['_source','timestamp'])}));}),ja=c('OzHelpers').pure(function(la){var ma=la.result,na=la.onClick,oa=la.selected,pa=la.threads,qa=ma.getIn(['_source','user-id']),ra=pa.get(qa),sa=ma.getIn(['_source','data']),ta=new Date(sa.get('start')),ua=ta.toLocaleString('en-US',{timeZoneName:'short'}),va=ra?c('React').createElement(c('OzUserImage.react'),{photo:c('OzHelpers').photo(ra),className:"_cxp"}):null;return (c('React').createElement(ea,{onClick:function wa(xa){return na(ma);},selected:oa,image:va,text:c('React').createElement('div',null,c('React').createElement('div',{className:"_5u4o"},sa.get('title')),c('React').createElement('div',{className:"_5u4p"},ua))}));});function ka(la){return la.getModifierState('Control')&&la.which==83;}f.exports=z;}),null);
__d('OzSkywalkerBanner.react',['cx','OzHelpers','OzStores','OzImmutablePureRenderMixin','React','Reflux','ReloadPage'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('OzStores').SkywalkerStore,j=c('React').createClass({displayName:'OzSkywalkerBanner',mixins:[c('Reflux').connect(i,'skywalker'),c('OzImmutablePureRenderMixin')],componentDidUpdate:function k(l,m){var n=this.state.skywalker;if(n.get('isStalled')&&n.get('last-receive-ts')){window.clearTimeout(this._timer);this._timer=window.setTimeout(this.forceUpdate.bind(this),1000);}},componentWillUnmount:function k(){window.clearTimeout(this._timer);},render:function k(){var l=this.state.skywalker,m=l.get('last-receive-ts'),n=m?'in '+Math.round((c('OzHelpers').serverNow()-m)/1000)+' seconds':'since you opened Oz';return (c('React').createElement('div',{className:"_hsr"+(l.get('isStalled')?' '+"_hss":'')},c('React').createElement('span',null,'We haven\'t received a message from Skywalker ',n,'.',' ',c('React').createElement('a',{onClick:c('ReloadPage').now},'Refresh!'),' ',' or terrible things will happen.')));}});f.exports=j;}),null);
__d('OzSuggestions',['OzHelpers','immutable','OzConstants'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('OzConstants').ATTS,i=c('immutable').List,j=c('immutable').Map;f.exports={toServer:function m(n,o){return n.set('type',h.SUGG).update('data',function(p){return j({name:p.get('title'),description:p.get('description')||'','merchant-name':this.findMerchantName(p.get('merchant'),o),'thumb-url':p.get('images',i()).find(c('OzHelpers').validateURL)||null,'thumb-urls':p.get('images',i()).filter(c('OzHelpers').validateURL),'target-url':p.get('url'),'expiration-time':p.get('expiration-time'),currency:'USD',amount:p.has('price')?k(p.get('price')):null});}.bind(this));},findMerchantName:function m(n,o){var p=o&&n&&o.find(function(q){return (q.get('name-dba')||'').toLowerCase()===n.toLowerCase();});if(p){c('OzHelpers').info('[sugg] found merchant',n,p);return p.get('name-dba');}return null;}};function k(m){return Math.round(100*parseFloat(l(m,'$'),10));}function l(m,n){if(!m||!m.startsWith(n))return m;return m.substr(n.length);}}),null);
__d('OzTwilio',['cx','OzHelpers','immutable','Keys','MessengerButton.react','OzNotify','OzActions','OzConfig','OzDraggableModal.react','OzImmutablePureRenderMixin','React','Reflux','StarsInput.react'],(function a(b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p;if(c.__markCompiled)c.__markCompiled();var q=c('immutable').Record,r=c('immutable').Set,s=c('immutable').List,t=c('React').PropTypes,u=c('OzActions').twilio;function v(){var ta=window.Twilio.Device,ua=function va(wa,xa){return function(){c('OzHelpers').info('[twilio] '+wa,y.data.toJS());xa.apply(undefined,arguments);};};u.setup.listen(function(va){ta.setup(va,{rtc:c('OzConfig').getInStaticConfig(['GK','webRTC']),debug:true});});u.hangUp.listen(function(va){ta.disconnectAll();u.endCall();});u.startCall.listen(ua('start-call',ta.connect));ta.ready(u.ready);ta.error(function(va){var wa=va.message;c('OzNotify').error('VOIP is having issues. '+(wa?wa:'')+'. Please contact the wit oncall');c('OzHelpers').error('[twilio] had an error',va);u.endCall();});ta.connect(ua('connect',u.connect));ta.disconnect(ua('disconnect',u.endCall));ta.cancel(ua('cancel',u.endCall));ta.incoming(ua('incoming',u.incoming));}v();i=babelHelpers.inherits(w,q({'intent-id':null,tid:null,extension:null}));j=i&&i.prototype;function w(){'use strict';i.apply(this,arguments);}k=babelHelpers.inherits(x,q({from:null,meta:new w(),muted:false,status:'pending',to:null,wasIncoming:null,rating:null,sentDigits:null,sentDigitsBuffer:s(),sentDigitsIntervalId:null}));l=k&&k.prototype;function x(){'use strict';k.apply(this,arguments);}var y=c('Reflux').createStore({init:function ta(){this.data=new x();this.listenToMany(u);},getInitialState:function ta(){return this.data;},onChangeTo:function ta(ua){this._u(function(va){return va.set('to',ua);});},onDialAgain:function ta(){this._conn=null;this._u(function(ua){return new x({status:'dial',meta:ua.get('meta'),from:ua.get('from'),to:ia(ua.get('to'))});});},onConnect:function ta(ua){this._conn=ua;},onEndCall:function ta(){this._conn=null;this._u(function(ua){return ua.merge({status:'ended'});});},onIncoming:function ta(ua){this._conn=ua;this._u(function(va){return va.mergeDeep({status:'incoming',to:ua.parameters.From,wasIncoming:true});});},onIncomingAccept:function ta(){if(this._conn){this._conn.accept();this._u(function(ua){return ua.merge({status:'in-call'});});}},onIncomingReject:function ta(){if(this._conn){this._conn.reject();this._conn=null;}this.onEndCall();},onMute:function ta(){if(this._conn){this._conn.mute(true);this._u(function(ua){return ua.set('muted',true);});}},onReady:function ta(){this._u(function(ua){return new x({status:'ready'});});},_sendDigitsFromBuffer:function ta(){var ua=this.data.get('sentDigitsBuffer');if(!ua.isEmpty()){this._conn.sendDigits(ua.first());this._u(function(wa){return wa.update('sentDigitsBuffer',function(xa){return xa.shift();});});}else{var va=this.data.get('sentDigitsIntervalId');clearInterval(va);this._u(function(wa){return wa.set('sentDigitsIntervalId',null);});}},onSendDigits:function ta(ua){if(this._conn){this._u(function(va){return va.update('sentDigits',function(wa){return (wa||'')+ua;});});this._u(function(va){return va.update('sentDigitsBuffer',function(wa){return wa.concat(s(ua.split('')));});});if(!Number.isInteger(this.data.get('sentDigitsIntervalId')))this._u(function(va){return va.set('sentDigitsIntervalId',setInterval(this._sendDigitsFromBuffer,1000));}.bind(this));}},onStartCall:function ta(){this._u(function(ua){return ua.set('status','in-call');});},onUnmute:function ta(){if(this._conn){this._conn.mute(false);this._u(function(ua){return ua.set('muted',false);});}},onUseIntent:function ta(ua){if(this.data.get('status')!=='ready'){c('OzNotify').error('End your call before starting another one');return;}this._u(function(va){return new x({status:'dial',from:ua.get('phone-number'),to:va.get('to'),meta:new w({tid:ua.get('user-id'),'intent-id':ua.get('id'),extension:ua.get('phone-extension')})});});},onUpdateIncomingInfo:function ta(ua){this._u(function(va){return va.merge({meta:new w({tid:ua.get('user-id'),'intent-id':ua.get('intent-id'),extension:ua.get('phone-extension')}),from:ua.get('to'),to:ua.get('from')});});},onUpdateRating:function ta(ua){this._u(function(va){return va.set('rating',ua);});},_u:function ta(ua){this.data=ua(this.data);this.trigger(this.data);}}),z=c('React').createClass({displayName:'OzTwilio',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(y,'store'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],contextTypes:{router:t.object.isRequired},componentDidMount:function ta(){var ua=window.setInterval(function(va){this.state.store.get('status')==='in-call'&&c('OzActions').isActive();}.bind(this),5000);this._cleanup=function(va){return window.clearInterval(ua);};},componentDidUpdate:function ta(ua,va){var wa=va.store.get('status'),xa=this.state.store.get('status');if(wa==='in-call'&&xa==='ended')this.setState({paused:true});},componentWillUnmount:function ta(){this._cleanup();},render:function ta(){var ua=this.state,va=ua.store,wa=ua.startedAt,xa=ua.paused;return (c('React').createElement('span',{className:"_221-"},aa(va)&&c('React').createElement(ba,{startedAt:wa,paused:xa,onCallStart:this._handleStartCall,onDialAgain:u.dialAgain,onHangUp:this._handleHangUp,onIncomingAccept:this._handleIncomingAccept,onIncomingReject:u.incomingReject,onMute:u.mute,onRatingChange:this._handleRatingChange,onReady:u.ready,onSendDigits:u.sendDigits,onThreadClick:this._handleThreadClick,onToChange:u.changeTo,onUnmute:u.unmute,store:va})));},_handleThreadClick:function ta(ua){this.context.router.push('/inbox/'+ua);},_handleStartCall:function ta(){var ua=this.state.store;this._startDurationTimer();u.startCall(babelHelpers['extends']({},ua.get('meta').toJS(),{from:ua.get('from'),to:ia(ua.get('to')),page:this.state.config.get('PAGE_ID'),type:'outgoing'}));},_handleIncomingAccept:function ta(){this._startDurationTimer();u.incomingAccept();},_startDurationTimer:function ta(){this.setState({startedAt:Date.now()});this.setState({paused:false});},_handleHangUp:function ta(){u.hangUp();this.setState({paused:true});},_handleRatingChange:function ta(ua){c('OzHelpers').info('[twilio] rating='+ua,this.state.store.toJS());u.updateRating(ua);}});function aa(ta){return r(['dial','in-call','incoming','ended']).has(ta.get('status'));}m=babelHelpers.inherits(ba,c('React').Component);n=m&&m.prototype;ba.prototype.render=function(){'use strict';return (c('React').createElement(c('OzDraggableModal.react'),{className:"_2221",getHandle:function(ta){return this.refs.header.refs.header;}.bind(this)},c('React').createElement(da,{store:this.props.store,ref:'header'}),c('React').createElement(ea,this.props)));};function ba(){'use strict';m.apply(this,arguments);}o=babelHelpers.inherits(ca,c('React').Component);p=o&&o.prototype;function ca(){var ta,ua;'use strict';for(var va=arguments.length,wa=Array(va),xa=0;xa<va;xa++)wa[xa]=arguments[xa];return ta=(ua=p.constructor).call.apply(ua,[this].concat(wa)),this.state={elapsed:Date.now()-this.props.startedAt},this.$DurationTimer2=function(){this.setState({elapsed:Date.now()-this.props.startedAt});}.bind(this),ta;}ca.prototype.componentDidMount=function(){'use strict';if(!this.props.paused)this.$DurationTimer1=setInterval(this.$DurationTimer2,1000);};ca.prototype.componentWillUnmount=function(){'use strict';clearInterval(this.$DurationTimer1);};ca.prototype.componentWillReceiveProps=function(ta){'use strict';if(ta.paused==this.props.paused)return;ta.paused?clearInterval(this.$DurationTimer1):this.$DurationTimer1=setInterval(this.$DurationTimer2,1000);};ca.prototype.render=function(){'use strict';return (c('React').createElement('div',{className:"_1su8"},ha(this.state.elapsed)));};var da=c('OzHelpers').pure(function(ta){var ua=ta.store,va=ua.get('status'),wa=ua.get('wasIncoming')?'Incoming':'Outgoing';return (c('React').createElement('h2',{className:"_1su5",ref:'header'},va==='ended'&&wa+' Call End'||wa+' Phone Call'));}),ea=c('OzHelpers').pure(function(ta){switch(ta.store.get('status')){case 'dial':return c('React').createElement(fa,ta);case 'in-call':return c('React').createElement(ka,ta);case 'incoming':return c('React').createElement(pa,ta);case 'ended':return c('React').createElement(qa,ta);default:c('OzHelpers').debug('[twilio] unknown status',ta);return null;}}),fa=c('OzHelpers').pure(function(ta){var ua=ta.store,va=ta.onToChange,wa=ta.onCallStart,xa=ta.onReady;return (c('React').createElement('div',{className:"_3hon"},c('React').createElement(sa,{placeholder:'Type a phone number...',value:ua.get('to'),onChange:function ya(za){return va(za.target.value);},onKeyDown:function ya(za){return (za.which===c('Keys').RETURN?ga(ua)&&wa():null);}}),c('React').createElement('div',{className:"_1su6"},ja(ua)),c('React').createElement('div',{className:"_1su7"},c('React').createElement(c('MessengerButton.react'),{onClick:xa,type:'secondary',label:'Cancel'}),c('React').createElement(c('MessengerButton.react'),{disabled:!ga(ua),onClick:wa,type:'primary',label:'Call'}))));});function ga(ta){return (ta.get('from')&&ta.get('to')&&ta.get('to').length>=10);}var ha=function ta(ua){var va=60000,wa=Math.floor(ua/va);ua%=va;var xa=Math.floor(ua/1000);if(wa<10)wa='0'+wa;if(xa<10)xa='0'+xa;return wa+':'+xa;},ia=function ta(ua){return (ua.trim().replace(' ','-').replace(/(.)\+/g,'$1-'));},ja=function ta(ua){var va=ua.getIn(['meta','extension']);return 'My Number: '+c('OzHelpers').parsePhoneNumber(ua.get('from'))+' ext. '+va;},ka=c('OzHelpers').pure(function(ta){var ua=ta.startedAt,va=ta.paused,wa=ta.onHangUp,xa=ta.onMute,ya=ta.onSendDigits,za=ta.onThreadClick,ab=ta.onUnmute,bb=ta.store;return (c('React').createElement('div',{className:"_2225"},c('React').createElement(ca,{startedAt:ua,paused:va}),c('React').createElement('div',{className:"_1su9"},c('OzHelpers').parsePhoneNumber(bb.get('to'))),c('React').createElement(la,{sentDigits:bb.get('sentDigits'),onSendDigits:ya}),c('React').createElement('div',{className:"_1su6"},bb.get('from')?ja(bb):'Searching for our number...'),c('React').createElement('div',{className:"_1su7"},c('React').createElement(oa,{tid:bb.getIn(['meta','tid']),onThreadClick:za}),bb.get('muted')?c('React').createElement(c('MessengerButton.react'),{onClick:ab,type:'secondary',use:'danger',label:'Unmute'}):c('React').createElement(c('MessengerButton.react'),{onClick:xa,type:'secondary',use:'default',label:'Mute'}),c('React').createElement(c('MessengerButton.react'),{onClick:wa,type:'primary',label:'End Call'}))));}),la=c('OzHelpers').pure(function(ta){var ua=ta.onSendDigits,va=ta.sentDigits;return (c('React').createElement('div',null,c('React').createElement(sa,{placeholder:'Type numbers using keyboard',value:'',onChange:function wa(xa){var ya=na(xa.target.value);ya&&ua(ya);}}),c('React').createElement('div',{className:"_538o"},va)));}),ma=r(['1','2','3','4','5','6','7','8','9','0','#','*']);function na(ta){return ta.split('').filter(function(ua){return ma.has(ua);}).join('');}var oa=c('OzHelpers').pure(function(ta){var ua=ta.onThreadClick,va=ta.tid;return va?c('React').createElement(c('MessengerButton.react'),{onClick:function wa(){return ua(va);},type:'secondary',label:'Go to Thread'}):null;}),pa=c('OzHelpers').pure(function(ta){var ua=ta.store,va=ta.onIncomingAccept,wa=ta.onIncomingReject;return (c('React').createElement('div',{className:"_2226"},c('React').createElement('div',{className:"_1su9"},c('OzHelpers').parsePhoneNumber(ua.get('to'))),c('React').createElement('div',{className:"_1su6"},ja(ua)),c('React').createElement('div',{className:"_1su7"},c('React').createElement(c('MessengerButton.react'),{onClick:wa,type:'secondary',label:'Ignore'}),c('React').createElement(c('MessengerButton.react'),{onClick:va,type:'primary',label:'Answer'}))));}),qa=c('OzHelpers').pure(function(ta){var ua=ta.startedAt,va=ta.paused,wa=ta.store,xa=ta.onHideDialog,ya=ta.onRatingChange,za=ta.onDialAgain,ab=ta.onReady;return (c('React').createElement('div',{className:"_5gaw"},c('React').createElement(ca,{startedAt:ua,paused:va}),c('React').createElement('div',{className:"_1su9"},c('OzHelpers').parsePhoneNumber(wa.get('to'))),c('React').createElement('div',{className:"_1su6"},ja(wa)),c('React').createElement(ra,{rating:wa.get('rating'),onRatingChange:ya}),c('React').createElement('div',{className:"_1su7"},c('React').createElement(c('MessengerButton.react'),{onClick:za,type:'secondary',label:'New Call'}),c('React').createElement(c('MessengerButton.react'),{onClick:ab,type:'primary',label:'Close'}))));}),ra=c('OzHelpers').pure(function(ta){var ua=ta.rating,va=ta.onRatingChange;return (c('React').createElement('div',{className:"_5rvp"},ua?c('React').createElement('h3',{className:"_5rvu"},'Thank you for rating!'):c('React').createElement('span',null,c('React').createElement('h3',{className:"_5rvu"},'How would you rate your experience?'),c('React').createElement(c('StarsInput.react'),{large:true,count:0,onClick:va}))));}),sa=c('OzHelpers').pure(function(ta){return (c('React').createElement('input',babelHelpers['extends']({},ta,{className:"_1-i0 _2224"})));});f.exports=z;}),null);
__d('Oz.react',['cx','OzAPI','OzHelpers','immutable','Layout.react','OzActions','OzBugNub.react','OzConfig','OzDialogContainer.react','OzExtensionCheck.react','OzHeader.react','OzLoading.react','OzFailed.react','OzNotify','OzSearch.react','OzSkywalkerBanner.react','OzStores','OzSuggestions','OzTwilio','OzImmutablePureRenderMixin','React','OzWrapper.react','Reflux','Run','XUIDialog.react','XUINotice.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('OzNotify').Component,j=c('OzStores').ActiveThreadStore,k=c('OzStores').MerchantStore,l=c('OzStores').LoadingStore,m=c('OzStores').RepStore,n=c('OzStores').RequirementStore,o=c('OzStores').ThreadStore,p=c('OzStores').WitIntentStore,q=c('React').PropTypes,r=c('immutable').Map,s=20000,t=60000,u=5000,v=100,w=1000*60*60,x=c('React').createClass({displayName:'OzWrapper',mixins:[c('Reflux').connect(l,'loading')],propTypes:{rev:q.number.isRequired,uid:q.string.isRequired,version:q.string.isRequired,skipToto:q.bool,onUnmount:q.func.isRequired},render:function fa(){var ga=this.state.loading.valueSeq().some(function(ha){return ha.get('state')!=='loaded'&&!ha.get('skip');});if(ga)return c('React').createElement(y,null);return c('React').createElement(z,this.props);}}),y=c('React').createClass({displayName:'AppLoading',mixins:[c('Reflux').connect(c('OzConfig').ConfigStore,'config'),c('Reflux').connect(l,'loading')],render:function fa(){return (c('React').createElement('div',null,c('React').createElement(i,null),this._renderBody(),c('React').createElement(c('OzBugNub.react'),null)));},_renderBody:function fa(){var ga=this.state.loading,ha=ga.entrySeq().filter(function(ja){var ka=ja[0],la=ja[1];return la.get('state')==='failed'&&!la.get('skip');}).map(function(ja){var ka=ja[0],la=ja[1];return ka;});if(!ha.isEmpty())return c('React').createElement(c('OzFailed.react'),{problems:ha});var ia='Hello '+this.state.config.get('publicName')+'! Oz is connecting...';return c('React').createElement(c('OzLoading.react'),{message:ia});}}),z=c('React').createClass({displayName:'Oz',mixins:[c('Reflux').connect(k,'merchants'),c('Reflux').connect(m,'reps'),c('Reflux').connect(p,'witIntents'),c('Reflux').connect(n,'requirements'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{rev:q.number.isRequired,uid:q.string.isRequired,version:q.string.isRequired,skipToto:q.bool,onUnmount:q.func.isRequired},childContextTypes:{uid:q.string.isRequired,merchants:q.instanceOf(r).isRequired,reps:q.instanceOf(r).isRequired,witIntents:q.instanceOf(r).isRequired},getChildContext:function fa(){return {uid:this.props.uid,merchants:this.state.merchants,reps:this.state.reps,witIntents:this.state.witIntents};},getInitialState:function fa(){return {almostInactive:false,away:false,coachMode:false,fellAsleep:false,inactive:false};},componentDidMount:function fa(){window.addEventListener('message',this._handleMessage);window.postMessage({type:'consolemounted'},'*');this.lastPulseAt=Date.now();var ga=c('OzActions').sendPulse.listen(this._handlePulse),ha=setInterval(c('OzActions').sendPulse,u);this.lastActiveAt=Date.now();this._isActive=function(la){return c('OzActions').isActive();};window.addEventListener('mousemove',this._isActive);window.addEventListener('keydown',this._isActive);var ia=c('OzActions').isActive.listen(function(){this.lastActiveAt=Date.now();if(this.state.almostInactive||this.state.inactive)this.setState({almostInactive:false,inactive:false});}.bind(this));this.lastAwakeAt=Date.now();var ja=setInterval(function(la){var ma=Date.now();if(ma-this.lastAwakeAt>w)this.setState({fellAsleep:true});this.lastAwakeAt=ma;}.bind(this),v);c('OzActions').updateThreads.preEmit=ca.bind(null,this.props.uid);var ka=c('OzActions').isInactive.listen(function(la){if(Date.now()-this.lastActiveAt>u)this.setState({almostInactive:false,inactive:true});}.bind(this));this._cleanup=function(){window.removeEventListener('message',this._handleMessage);ga();clearInterval(ha);clearInterval(ja);window.removeEventListener('mousemove',this._isActive);ia();ka();}.bind(this);},componentWillUnmount:function fa(){this._cleanup();},render:function fa(){return (c('React').createElement(c('Layout.react'),{className:"_3_ps _li",onKeyPress:this._handleKeyPress},c('React').createElement(i,null),!this.props.skipToto&&c('React').createElement(c('OzExtensionCheck.react'),null),this.state.away?c('React').createElement(aa,{onClick:this._handleAway,text:'You\'re currently away.',className:"_1tir"}):this.state.almostInactive?c('React').createElement(ba,{lastActiveAt:this.lastActiveAt,onZero:this._handleZero}):this.state.fellAsleep&&!this.state.config.get('devMode')?c('React').createElement(aa,{text:'Looks like your computer has gone to sleep. Please '+'refresh the page.'}):this.state.inactive?c('React').createElement(aa,{text:'You\'re currently inactive.',className:"_4da6"}):null,c('React').createElement(c('OzSkywalkerBanner.react'),null),c('React').createElement(c('OzHeader.react'),{away:this.state.away,coachMode:!!this.state.coachMode,onAway:this._handleAway,onCoachModeToggle:this._handleCoachModeToggle,rev:this.props.rev,version:this.props.version,reps:this.state.reps,params:this.props.params}),c('React').cloneElement(this.props.children,{witIntents:this.state.witIntents,requirements:this.state.requirements,merchants:this.state.merchants,reps:this.state.reps}),c('React').createElement(c('OzBugNub.react'),null),c('React').createElement(c('OzDialogContainer.react'),null),c('React').createElement(c('OzSearch.react'),null),c('React').createElement(c('OzTwilio'),null)));},_handleKeyPress:function fa(){c('OzActions').isActive();},_handlePulse:function fa(){var ga=Date.now(),ha=Math.round((ga-this.lastPulseAt)/1000),ia=this._buildPulse();c('OzAPI').sendPulse(ha,ia);ea(j.data,o.data);this.lastPulseAt=ga;if(!this.state.almostInactive&&!this.state.inactive&&ia.get('inactive-ms')>=t-s)this.setState({almostInactive:true});},_handleMessage:function fa(ga){if(ga.source!==window)return;if(!ga.data)return;switch(ga.data.type){case 'active':c('OzActions').isActive();break;case 'recordactivity':var ha=j.data,ia=ga.data.data,ja=ha.get('threadID');c('OzHelpers').debug('[oz-ext] received activity',ia);if(!ja){c('OzHelpers').debug('[oz-ext] skipping event, no threadID');return;}c('OzAPI').recordActivity(ja,ia);break;case 'bubble':c('OzHelpers').debug('[toto] got bubble',ga.data);c('OzActions').addBubble(c('OzSuggestions').toServer(c('immutable').fromJS(ga.data),this.state.merchants));break;case 'autopilot-data':c('OzHelpers').debug('[toto] got autopilot',ga.data);if(ga.data)c('OzActions').addAutopilot(c('immutable').fromJS(ga.data));break;}},_handleAway:function fa(ga){c('OzAPI').away(!this.state.away).done(function(ha){this.setState({away:!!ha});}.bind(this));},_handleCoachModeToggle:function fa(ga){c('OzAPI').coachMode(ga).done(function(){this.setState({coachMode:ga});}.bind(this));},_handleZero:function fa(){this.setState({almostInactive:false,inactive:true});},_buildPulse:function fa(ga){return da(this.props.uid,j.data,o.data,this.lastActiveAt,this.state.away||ga||false,this.state.coachMode);}});function aa(fa){var ga=fa.onClick,ha=fa.text,ia=fa.className;return (c('React').createElement(c('XUIDialog.react'),{width:544,shown:true,layerHideOnBlur:false},c('React').createElement('div',{className:"_1tip"},c('React').createElement('div',{className:ia}),c('React').createElement('div',{className:"_1tis"},ha),ga?c('React').createElement('a',{className:"_1tit _57lt _30yy",onClick:ga},'I\'m back :)'):null)));}var ba=c('React').createClass({displayName:'OzCountdownDialog',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{lastActiveAt:q.number.isRequired,onZero:q.func.isRequired},getInitialState:function fa(){return {countdown:Math.floor((t-(Date.now()-this.props.lastActiveAt))/1000)};},componentDidMount:function fa(){this._interval=setInterval(function(){this.setState({countdown:Math.max(this.state.countdown-1,0)});}.bind(this),1000);},componentDidUpdate:function fa(){if(this.state.countdown===0){clearInterval(this._interval);this.props.onZero();}},componentWillUnmount:function fa(){clearInterval(this._interval);},render:function fa(){return (c('React').createElement(c('XUIDialog.react'),{width:544,shown:true,layerHideOnBlur:false},c('React').createElement('div',{className:"_1tip"},c('React').createElement('div',{className:"_4da6"}),c('React').createElement(c('XUINotice.react'),{use:'warn'},'You\'ll be inactive (and your threads will be reassigned) in approximately ',this.state.countdown,' seconds...'))));}});function ca(fa,ga){var ha=o.data;if(ha.isEmpty())return;ga.filter(function(ia){return ((c('OzHelpers').isOwner(ia,fa)||c('OzHelpers').isSubscriber(ia,fa))&&(ia.get('ready')||c('OzHelpers').isUnread(ia)||c('OzHelpers').hasPaid(ia)||c('OzHelpers').hasReminder(ia)));}).forEach(function(ia){var ja=c('OzHelpers').isUnread(ia)&&c('OzHelpers').shortDesc(c('OzHelpers').lastUserMessage(ia))||c('OzHelpers').hasPaid(ia)&&'Payment received.'||c('OzHelpers').hasReminder(ia)&&'Reminder triggered.';if(!ja)return;var ka=c('OzHelpers').threadID(ia),la=ha.getIn([ka,'last-event-at']);if(ia.get('last-event-at')===la)return;var ma=c('OzHelpers').photo(ia),na=ma?ma.getIn(['data','url'])||ma.get('mime_type')+','+ma.get('data'):null;c('OzAPI').notifyExtension({action:'show',title:c('OzHelpers').getName(ia),desc:ja,picture:na,id:c('OzHelpers').threadID(ia)});});}function da(fa,ga,ha,ia,ja,ka){var la=ga.get('threadID'),ma=la&&ha.get(la),na=r();if(la)na=na.merge({tid:la});if(ma)na=na.merge({'intent-id':ga.get('activeIntent'),'owner-id':ma.getIn(['owner','id']),'user-name':ma.getIn(['user-vcard','name'])});if(Number.isFinite(ia))na=na.set('inactive-ms',Date.now()-ia);na=na.set('load',ha.toSeq().filter(function(oa){return c('OzHelpers').isOwner(oa,fa)&&oa.get('ready');}).count());na=na.set('away?',ja);na=na.set('coach-mode?',ka);return na;}function ea(fa,ga){var ha=fa.get('threadID'),ia=ha&&ga.get(ha),ja=r();if(ia)ja=ja.merge({tid:ha,'intent-id':fa.get('activeIntent'),'user-vcard':ia.get('user-vcard')});window.postMessage({type:'consolepulse',data:ja.toJS()},'*');}f.exports=c('OzWrapper.react')(x);}),null);
__d('OzAIDashboardFilters.react',['cx','immutable','InputLabel.react','OzImmutablePureRenderMixin','React','XUISingleSelector.react'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').List,j=c('immutable').Map,k=c('React').PropTypes,l=c('XUISingleSelector.react').Option,m=c('React').createClass({displayName:'OzAIDashboardFilters',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{intentMetas:k.instanceOf(j).isRequired,modules:k.instanceOf(i).isRequired,isReversed:k.bool.isRequired,onIsReversedChange:k.func.isRequired,onSortByChange:k.func.isRequired,onUUIDChange:k.func.isRequired,onModuleChange:k.func.isRequired,sortBy:k.string,sortableFields:k.instanceOf(j).isRequired,uuid:k.string,selectedModule:k.string},render:function o(){return (c('React').createElement('ul',{className:"_1bo-"},c('React').createElement('li',null,this._renderModuleFilter()),c('React').createElement('li',null,this._renderUUIDFilter()),c('React').createElement('li',null,this._renderSortByFilter()),c('React').createElement('li',null,this._renderIsReversedFilter())));},_renderModuleFilter:function o(){return (c('React').createElement(c('XUISingleSelector.react'),{maxheight:400,onChange:this._handleModuleChange,value:this.props.selectedModule||'__none__'},c('React').createElement(l,{value:'__none__'},'Select a module'),this.props.modules.valueSeq().map(function(p){return (c('React').createElement(l,{key:p,value:p},p));})));},_renderUUIDFilter:function o(){return (c('React').createElement(c('XUISingleSelector.react'),{maxheight:400,onChange:this._handleUUIDChange,value:this.props.uuid||'__none__'},c('React').createElement(l,{value:'__none__'},'Select an intent category'),this.props.intentMetas.sortBy(function(p){return p.get('name');}).valueSeq().map(function(p){return (c('React').createElement(l,{key:p.get('id'),value:p.get('id')},p.get('name')));})));},_renderIsReversedFilter:function o(){return (c('React').createElement(c('InputLabel.react'),null,c('React').createElement('input',{checked:this.props.isReversed,onChange:function(p){this.props.onIsReversedChange(p.target.checked);}.bind(this),type:'checkbox'}),c('React').createElement('label',null,'Reversed?')));},_renderSortByFilter:function o(){return (c('React').createElement(c('XUISingleSelector.react'),{maxheight:400,onChange:this._handleSortByChange,value:this.props.sortBy||'__none__'},c('React').createElement(l,{value:'__none__'},'Select a field to sort by'),this.props.sortableFields.map(function(p,q){return (c('React').createElement(l,{key:q,value:q},p));}).valueSeq()));},_handleSortByChange:function o(p){this.props.onSortByChange(n(p.value));},_handleUUIDChange:function o(p){this.props.onUUIDChange(n(p.value));},_handleModuleChange:function o(p){this.props.onModuleChange(p.value);}});function n(o){return o!=='__none__'?o:undefined;}f.exports=m;}),null);
__d('OzAIDashboardEventSuggestions.react',['cx','immutable','OzConstants','OzImmutablePureRenderMixin','React','XUITable.react'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').List,j=c('immutable').Map,k=c('OzConstants').ATTS,l=c('React').PropTypes,m=c('React').createClass({displayName:'OzAIDashboardEventSuggestions',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{gold:l.instanceOf(j).isRequired,guesses:l.instanceOf(i).isRequired},render:function n(){return (c('React').createElement(c('XUITable.react'),{outerBorder:true},c('React').createElement('thead',null,c('React').createElement('tr',null,c('React').createElement('th',null,'Source'),c('React').createElement('th',null,'Guess'),c('React').createElement('th',null,'Class'),c('React').createElement('th',null,'Confidence'))),c('React').createElement('tbody',null,this._getSuggestions().map(this._renderRow))));},_buildGuess:function n(o){switch(o.get('type')){case k.TEMPLATE:return (c('React').createElement('span',null,o.get('ui-body')||JSON.stringify(o.get('body'))));case k.SUGG:case 'bubble':return (c('React').createElement('a',{href:o.get('target-url'),target:'_blank'},o.get('name')));default:return c('React').createElement('span',null,JSON.stringify(o));}},_renderRow:function n(o,p){var q=this.props.gold,r=o.get('source');return (c('React').createElement('tr',{className:q.get('source')===r&&q.get('position')===o.get('position')?"_31bp":'',key:p},c('React').createElement('td',null,r),c('React').createElement('td',null,this._buildGuess(o)),c('React').createElement('td',null,o.get('class')),c('React').createElement('td',null,o.get('confidence'))));},_getSuggestions:function n(){return this.props.guesses.flatMap(function(o){return o.get('items')||[o].map(function(p){return p.merge(j({position:o.get('position'),confidence:o.get('confidence'),'class':o.get('class')}));});}).toSeq();}});f.exports=m;}),null);
__d('OzAIDashboardEventsDialog.react',['cx','DialogFitHeight','immutable','InputLabel.react','OzAIDashboardEventSuggestions.react','OzImmutablePureRenderMixin','React','XUIDialog.react','XUIDialogBody.react','XUIDialogFooter.react','XUIDialogOkayButton.react','XUIDialogTitle.react','XUITable.react','formatDate'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzAIDashboardEventsDialog',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{session:j.instanceOf(i).isRequired,onToggle:j.func.isRequired,shown:j.bool.isRequired},getInitialState:function n(){return {isFiltered:true};},render:function n(){return (c('React').createElement(c('XUIDialog.react'),{behaviors:{DialogFitHeight:c('DialogFitHeight')},onToggle:this.props.onToggle,shown:this.props.shown,width:800},c('React').createElement(c('XUIDialogTitle.react'),null,c('React').createElement('span',null,'Events for Session  ',this.props.session.get('id'))),c('React').createElement(c('XUIDialogBody.react'),null,c('React').createElement(c('InputLabel.react'),null,c('React').createElement('input',{checked:this.state.isFiltered,onChange:function(o){this.setState({isFiltered:o.target.checked});}.bind(this),type:'checkbox'}),c('React').createElement('label',null,'Filter Non-Message Events?')),this._renderTable()),c('React').createElement(c('XUIDialogFooter.react'),null,c('React').createElement(c('XUIDialogOkayButton.react'),{use:'confirm',action:'cancel'}))));},_renderTable:function n(){return (c('React').createElement(c('XUITable.react'),{className:"_4p5_",outerBorder:true},c('React').createElement('thead',null,c('React').createElement('tr',null,c('React').createElement('th',null,'Time'),c('React').createElement('th',null,'Text/Data'),c('React').createElement('th',null,'Suggestions'),c('React').createElement('th',null,'Winner'))),c('React').createElement('tbody',null,this._getEvents().map(this._renderRow))));},_renderRow:function n(event,o){var p=event.get('type'),q=event.getIn(['aiusage','guesses']),r=event.get('suggestion');return (c('React').createElement('tr',{key:o},c('React').createElement('td',{className:"_4p60"},l(event.get('time'))),c('React').createElement('td',{className:"_4p61"+(p!=='message'?' '+"_31bp":'')},event.get('text')||r&&m(r)),c('React').createElement('td',null,q?c('React').createElement(c('OzAIDashboardEventSuggestions.react'),{gold:event.getIn(['aiusage','gold'])||i(),guesses:q}):''),c('React').createElement('td',null,event.getIn(['aiusage','gold','source']))));},_getEvents:function n(){var o=this.props.session.get('events').toSeq();if(this.state.isFiltered)o=o.filter(function(event){var p=event.get('type');return p==='send'||p==='message'||p==='suggest';});return o;}});function l(n){return c('formatDate')(n/1000,'M d, Y g:ia');}function m(n){return (c('React').createElement('a',{href:n.get('target-url'),target:'_blank'},n.get('name')));}f.exports=k;}),null);
__d('OzAIDashboardRow.react',['immutable','ReactLayeredComponentMixin_DEPRECATED','OzAIDashboardEventsDialog.react','OzImmutablePureRenderMixin','React','formatDate'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('immutable').Map,i=c('React').PropTypes,j=c('React').createClass({displayName:'OzAIDashboardRow',mixins:[c('ReactLayeredComponentMixin_DEPRECATED'),c('OzImmutablePureRenderMixin')],propTypes:{session:i.instanceOf(h).isRequired,intentMeta:i.instanceOf(h),selectedModule:i.string},getInitialState:function l(){return {isDialogOpen:false};},render:function l(){var m=this.props,n=m.session,o=m.intentMeta,p=m.selectedModule;return (c('React').createElement('tr',null,c('React').createElement('td',null,n.get('id')),c('React').createElement('td',null,k(n.get('created-at'))),c('React').createElement('td',null,o&&o.get('name')),c('React').createElement('td',null,n.get('sends')||0),c('React').createElement('td',null,n.get('texts')||0),c('React').createElement('td',null,n.get('suggs')||0),c('React').createElement('td',null,n.get('humans')||0),c('React').createElement('td',null,n.getIn(['shown',p])||0),c('React').createElement('td',null,n.getIn(['won',p])||0),c('React').createElement('td',null,this._renderEventsLink())));},renderLayers:function l(){if(!this.state.isDialogOpen)return {};return {dialog:c('React').createElement(c('OzAIDashboardEventsDialog.react'),{session:this.props.session,onToggle:this._handleDialogToggle,shown:this.state.isDialogOpen})};},_renderEventsLink:function l(){var m=this.props.session.get('events');if(!m||m.isEmpty())return c('React').createElement('span',null,'None');return (c('React').createElement('a',{href:'#',onClick:this._handleEventsLinkClick},'Click to View'));},_handleDialogToggle:function l(m){this.setState({isDialogOpen:m});},_handleEventsLinkClick:function l(m){m.preventDefault();this.setState({isDialogOpen:true});}});function k(l){return c('formatDate')(l/1000,'M d, Y g:ia');}f.exports=j;}),null);
__d('OzAIDashboard.react',['OzAPI','immutable','MessengerFlexScrollableArea.react','OzAIDashboardFilters.react','OzAIDashboardRow.react','OzImmutablePureRenderMixin','React','XUITable.react'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('immutable').List,i=c('immutable').Map,j=c('React').PropTypes,k=i({id:'ID','created-at':'Created At',sends:'Sends',texts:'Texts',suggs:'Suggs',humans:'Humans',shown:'Shown',won:'Won'}),l=c('React').createClass({displayName:'OzAIDashboard',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{intentMetas:j.instanceOf(i).isRequired,sessions:j.instanceOf(h).isRequired,isLoaded:j.bool.isRequired,isLoading:j.bool.isRequired,isReversed:j.bool.isRequired,onFetchRequest:j.func.isRequired,onIsReversedChange:j.func.isRequired,onSortByChange:j.func.isRequired,onUUIDChange:j.func.isRequired,onModuleChange:j.func.isRequired,selectedModule:j.string,sortBy:j.string,uuid:j.string},getInitialState:function m(){return {modules:h()};},componentDidMount:function m(){c('OzAPI').AIModules().done(function(n){if(!this.isMounted())return;this.setState({modules:n});if(n.size>0)this.props.onModuleChange(n.get(0));}.bind(this));},render:function m(){return (c('React').createElement(c('MessengerFlexScrollableArea.react'),{onScroll:this._handleScroll,ref:'scrollable'},c('React').createElement(c('OzAIDashboardFilters.react'),{intentMetas:this.props.intentMetas,modules:this.state.modules,isReversed:this.props.isReversed,onIsReversedChange:this.props.onIsReversedChange,onSortByChange:this.props.onSortByChange,onUUIDChange:this.props.onUUIDChange,onModuleChange:this.props.onModuleChange,sortBy:this.props.sortBy,sortableFields:k,uuid:this.props.uuid,selectedModule:this.props.selectedModule}),this._renderTable(),this._renderLoadMoreLink()));},_renderTable:function m(){var n=this.props,o=n.intentMetas,p=n.selectedModule;return (c('React').createElement(c('XUITable.react'),{outerBorder:false},c('React').createElement('thead',null,c('React').createElement('tr',null,c('React').createElement('th',null,'ID'),c('React').createElement('th',null,'Created At'),c('React').createElement('th',null,'Intent'),c('React').createElement('th',null,'Sends'),c('React').createElement('th',null,'Texts'),c('React').createElement('th',null,'Suggs'),c('React').createElement('th',null,'Humans'),c('React').createElement('th',null,'Shown'),c('React').createElement('th',null,'Won'),c('React').createElement('th',null,'Events'))),c('React').createElement('tbody',null,this.props.sessions.map(function(q){return (c('React').createElement(c('OzAIDashboardRow.react'),{session:q,intentMeta:o.get(q.get('wit-intent-uuid')),selectedModule:p,key:q.get('id')}));}))));},_renderLoadMoreLink:function m(){if(this.props.isLoaded)return null;if(this.props.isLoading)return c('React').createElement('div',null,'Loading...');return (c('React').createElement('div',null,c('React').createElement('a',{href:'#',onClick:function(n){n.preventDefault();this.props.onFetchRequest();}.bind(this)},'Fetch More Sessions')));},_handleScroll:function m(){if(!this.props.isLoading&&!this.props.isLoaded&&this.refs.scrollable&&this.refs.scrollable.isScrolledToBottom())this.props.onFetchRequest();}});f.exports=l;}),null);
__d('OzAIDashboardContainer.react',['immutable','OzAPI','OzAIDashboard.react','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('immutable').List,k=c('immutable').Map,l=c('React').PropTypes,m=30,n={sessions:j(),isLoaded:false,offset:0};h=babelHelpers.inherits(o,c('React').Component);i=h&&h.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=i.constructor).call.apply(q,[this].concat(s)),this.state=babelHelpers['extends']({},n,{isLoading:false,isReversed:true,sortBy:'won',uuid:undefined,selectedModule:undefined}),this.$OzAIDashboardContainer1=function(){if(this.state.isLoading||this.state.isLoaded)return;this.setState({isLoading:true});c('OzAPI').aiDashboard({offset:this.state.offset,limit:m,uuid:this.state.uuid,reverse:this.state.isReversed||undefined,'sort-by':this.state.sortBy||undefined,module:this.state.selectedModule}).done(function(u){this.setState({sessions:this.state.sessions.concat(u),isLoaded:u.size<m,isLoading:false,offset:this.state.offset+u.size});}.bind(this));}.bind(this),this.$OzAIDashboardContainer5=function(u){this.setState(babelHelpers['extends']({},n,{selectedModule:u}),this.$OzAIDashboardContainer1);}.bind(this),this.$OzAIDashboardContainer4=function(u){this.setState(babelHelpers['extends']({},n,{uuid:u}),this.$OzAIDashboardContainer1);}.bind(this),this.$OzAIDashboardContainer2=function(u){this.setState(babelHelpers['extends']({},n,{isReversed:u}),this.$OzAIDashboardContainer1);}.bind(this),this.$OzAIDashboardContainer3=function(u){this.setState(babelHelpers['extends']({},n,{sortBy:u}),this.$OzAIDashboardContainer1);}.bind(this),p;}o.prototype.componentDidMount=function(){this.$OzAIDashboardContainer1();};o.prototype.render=function(){return c('React').createElement(c('OzAIDashboard.react'),{intentMetas:this.props.witIntents,sessions:this.state.sessions,modules:this.state.modules,selectedModule:this.state.selectedModule,isLoaded:this.state.isLoaded,isLoading:this.state.isLoading,isReversed:this.state.isReversed,onFetchRequest:this.$OzAIDashboardContainer1,onIsReversedChange:this.$OzAIDashboardContainer2,onSortByChange:this.$OzAIDashboardContainer3,onUUIDChange:this.$OzAIDashboardContainer4,onModuleChange:this.$OzAIDashboardContainer5,sortBy:this.state.sortBy,uuid:this.state.uuid});};f.exports=o;}),null);
__d('OzLastEvent.react',['cx','OzHelpers','OzConstants','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('OzConstants').AUTHOR_TYPES,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzLastEvent',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{name:j.string.isRequired,lastEvent:j.object.isRequired},render:function l(){var m=this.props.lastEvent,n=c('OzHelpers').authorType(m)===i.USER?this.props.name.split(' ')[0].substr(0,10):'M',o=m.get('text'),p=c('OzHelpers').shortDesc(m)||'did something',q=o&&n+': '+o||n+' '+p;return (c('React').createElement('div',{className:"_4-_6 _4-_7",title:q},this._renderText(n,p)));},_renderText:function l(m,n){return (c('React').createElement('span',null,c('React').createElement('span',{className:"_3ikz"},m,': '),n));}});f.exports=k;}),null);
__d('OzStrings',[],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();f.exports={NOTREADY_BUTTON:'I\'m waiting',IS_NOTREADY:'Currently waiting',READY_BUTTON:'The user is waiting for us!',USER_FILTER_ALL:'All users',USER_FILTER_PUBLIC:'Public only',USER_FILTER_EMPLOYEE:'Employee only',READY_FILTER_ALL:'All threads',READY_FILTER_ATTENTION:'Needs attention',READY_FILTER_WAITING:'I\'m waiting'};}),null);
__d('OzThreadLabels.react',['cx','OzHelpers','OzAPI','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','joinClasses','immutable','ReactLayeredComponentMixin_DEPRECATED','OzImmutablePureRenderMixin','React','XUICloseButton.react','XUIContextualDialog.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('immutable').OrderedMap,k=c('immutable').List,l=c('React').PropTypes,m=c('React').createClass({displayName:'Label',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{noColor:l.bool,removable:l.bool,shade:l.oneOf(['dark','light']),thread:l.instanceOf(i).isRequired},getDefaultProps:function aa(){return {shade:'dark'};},render:function aa(){if(!this.props.shown)return null;return (c('React').createElement('div',{className:c('joinClasses')("_2yqb"+(this.props.noColor?' '+"_2yqc":'')+(' '+"_2yqd"),this.props.className)},this.props.text,this.props.removable&&this.props.onRemove?c('React').createElement(c('XUICloseButton.react'),{className:"_2yqe",onClick:this.props.onRemove,shade:this.props.shade}):c('React').createElement('div',{className:"_4ypj"})));}});function n(aa){return (c('React').createElement(m,babelHelpers['extends']({},aa,{className:"_2yqi",text:'REMINDER',shown:!c('OzHelpers').urgentReminders(aa.thread).isEmpty()})));}function o(aa){return (c('React').createElement(m,babelHelpers['extends']({},aa,{className:"_2yqj",text:'PAID',shown:!c('OzHelpers').paidReminders(aa.thread).isEmpty()})));}function p(aa){var ba=c('OzHelpers').minAge(aa.thread);return (c('React').createElement(m,babelHelpers['extends']({},aa,{className:"_2yqm",text:ba<18&&'UNDER 18'||ba<21&&'UNDER 21',shown:ba<21})));}function q(aa){return (c('React').createElement(m,babelHelpers['extends']({},aa,{className:"_2yql",text:'ENGAGE',shown:c('OzHelpers').hasEngage(aa.thread)})));}var r=j({OzVIPLabel:['vip',"_2yqf"],OzUrgentLabel:['urgent',"_2yqg"],OzAbuserLabel:['abuser',"_2yqh"],OzEscalatedLabel:['escalated',"_1jce"]}),s=j({OzEmployeeLabel:['employee',"_2yqk"]}),t=r.merge(s).map(function(aa){var ba=aa[0],ca=aa[1];return ba;}).toSet();function u(aa,ba,ca){return function(da){return (c('React').createElement(m,babelHelpers['extends']({},da,{className:ba,text:z(aa),shown:c('OzHelpers').hasTag(da.thread,aa),onRemove:function ea(){return c('OzAPI').deleteTag(c('OzHelpers').threadID(da.thread),aa);}})));};}var v=r.map(function(aa){return u.apply(undefined,aa);}),w=s.map(function(aa){return u.apply(undefined,aa);});function x(aa){var ba=aa.className,ca=aa.removable,da=aa.addable,ea=babelHelpers.objectWithoutProperties(aa,['className','removable','addable']);return (c('React').createElement('div',{className:ba},w.map(function(fa,ga){return c('React').createElement(fa,babelHelpers['extends']({key:ga},ea));}).valueSeq(),c('React').createElement(n,ea),v.map(function(fa,ga){return c('React').createElement(fa,babelHelpers['extends']({key:ga,removable:ca},ea));}).valueSeq(),(ea.thread.get('tags')||k()).filterNot(function(fa){return t.has(fa);}).sort().map(function(fa){var ga=u(fa,"_tch");return ga(babelHelpers['extends']({key:fa,removable:ca},ea));}),c('React').createElement(q,ea),c('React').createElement(o,ea),da?c('React').createElement(y,{thread:ea.thread}):null));}var y=c('React').createClass({displayName:'OzAddLabel',mixins:[c('OzImmutablePureRenderMixin'),c('ReactLayeredComponentMixin_DEPRECATED')],propTypes:{thread:l.instanceOf(i).isRequired},getInitialState:function aa(){return {shown:false};},render:function aa(){return (c('React').createElement('span',{ref:'add'},this._tags().isEmpty()?null:c('React').createElement('button',{className:"_1-hv _2yqb _2yqn _2yqo",onClick:function(){return this.setState({shown:true});}.bind(this)},'+')));},renderLayers:function aa(){var ba=this.state.shown;if(!ba)return null;var ca=this.props.thread;return {contextualDialog:c('React').createElement(c('XUIContextualDialog.react'),{behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll')},position:'below',shown:ba,contextRef:function(){return this.refs.add;}.bind(this),onBlur:function(da){return this.setState({shown:false});}.bind(this)},c('React').createElement('div',{className:"_2yqp"},this._tags().map(function(da){var ea=da[0],fa=da[1];return (c('React').createElement('button',{key:ea,className:c('joinClasses')(fa,"_1-hv _2yqq"),onClick:function(){this.setState({shown:false});c('OzAPI').createTag(c('OzHelpers').threadID(ca),ea);}.bind(this)},z(ea)));}.bind(this))))};},_tags:function aa(){return r.filterNot(function(ba){var ca=ba[0],da=ba[1];return c('OzHelpers').hasTag(this.props.thread,ca);}.bind(this)).valueSeq();}});function z(aa){return aa.split('m_experiment_').join('').toUpperCase();}f.exports={OzLabelList:x,OzUnderageLabel:p};}),null);
__d('OzAllRow.react',['cx','OzStrings','OzHelpers','immutable','OzButton.react','OzConfig','OzConstants','OzDate.react','OzLastEvent.react','OzThreadLabels.react','OzUserImage.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('immutable').List,k=c('OzConstants').AUTHOR_TYPES,l=c('React').PropTypes,m=c('OzThreadLabels.react').OzLabelList,n=c('OzHelpers').pure(function(w){var x=w.thread,y=w.witIntents,z=babelHelpers.objectWithoutProperties(w,['thread','witIntents']);return (c('React').createElement('div',{className:"_-66"},c('React').createElement(t,{width:'220px'},c('React').createElement(o,{thread:x})),c('React').createElement(t,{marginLeft:'10px',width:'250px'},c('React').createElement(p,{thread:x,witIntents:y})),c('React').createElement(t,{marginLeft:'10px',width:'350px'},c('React').createElement(q,{thread:x})),c('React').createElement(t,{marginLeft:'10px',width:'150px'},c('React').createElement(r,{thread:x})),c('React').createElement(t,{margineft:'10px',flex:'1',alignItems:'right'},c('React').createElement(s,babelHelpers['extends']({thread:x},z)))));}),o=c('OzHelpers').pure(function(w){var x=w.thread;return (c('React').createElement('div',{className:"_-67"},c('React').createElement(c('OzUserImage.react'),{photo:c('OzHelpers').photo(x)}),c('React').createElement('div',{className:"_-68"},c('React').createElement('h1',{className:"_-69"},c('OzHelpers').getName(x)),c('React').createElement(m,{className:"_-6a",thread:x}))));}),p=c('OzHelpers').pure(function(w){var x=w.thread,y=w.witIntents,z=c('OzHelpers').openIntents(x).toSeq().map(function(ba){return y.getIn([ba.get('wit-intent-uuid'),'name']);}).filter(function(ba){return ba;}).map(function(ba){return 'Intent: '+ba;}),aa=c('OzHelpers').urgentReminders(x).toSeq().map(function(ba){return ba.getIn(['body','description']);}).filter(function(ba){return ba;}).map(function(ba){return 'Reminder: '+ba;});return (c('React').createElement('div',{className:"_-6q"},c('React').createElement('div',{className:"_-6r"},z.concat(aa).map(function(ba,ca){return (c('React').createElement('div',{key:ca,className:"_4-_7 _-6s"},ba));}))));}),q=c('OzHelpers').pure(function(w){var x=w.thread;return (c('React').createElement('div',{className:"_-6u"},u(x).map(function(y){return (c('React').createElement('div',{key:c('OzHelpers').msgID(y),className:"_-6v"+(c('OzHelpers').authorType(y)!==k.USER?' '+"_-6w":'')},c('React').createElement('span',{className:"_4-_7 _-6x"},c('React').createElement(c('OzDate.react'),{timestamp:y.get('timestamp')})),c('React').createElement(c('OzLastEvent.react'),{key:c('OzHelpers').msgID(y),name:c('OzHelpers').getName(x),lastEvent:y})));})));}),r=c('OzHelpers').pure(function(w){var x=w.thread,y=x.getIn(['owner','name'])||'No owner',z=x.getIn(['last-owner','name']);return (c('React').createElement('div',{className:"_-6y"},c('React').createElement('div',{className:"_-6z"},y),z?c('React').createElement('div',{className:"_-6-"},'Last owner: ',z):null));}),s=c('React').createClass({displayName:'Actions',mixins:[c('OzImmutablePureRenderMixin')],contextTypes:{uid:l.string.isRequired},propTypes:{thread:l.instanceOf(i).isRequired,onThreadNotReady:l.func.isRequired,onThreadReady:l.func.isRequired,onThreadRelease:l.func.isRequired,onThreadView:l.func.isRequired},render:function w(){return (c('React').createElement('div',{className:"_-6_"},v(babelHelpers['extends']({},this.props,{uid:this.context.uid})).map(function(x){var y=x.body,z=x.f;return (c('React').createElement(c('OzButton.react'),{key:y,onClick:function(aa,ba){return z(this.props.thread,ba,aa);}.bind(this)},y));}.bind(this))));}}),t=c('OzHelpers').pure(function(w){var x=w.children,y=babelHelpers.objectWithoutProperties(w,['children']);return (c('React').createElement('div',{className:"_-70",style:y},x));});function u(w){var x=c('OzHelpers').lastEvents(w).groupBy(c('OzHelpers').authorType);return j([x.get(k.USER),x.get(k.TRAINER),x.get(k.BOT)]).toSeq().filter(function(y){return y;}).map(function(y){return y.last();}).sortBy(function(y){return y.get('timestamp');});}function v(w){var x=w.onThreadNotReady,y=w.onThreadReady,z=w.onThreadRelease,aa=w.onThreadView,ba=w.thread,ca=w.uid,da=ba,ea=c('OzConfig').getInStaticConfig(['GK','supervisor']),fa=[];if(ea&&c('OzHelpers').hasOwner(da))fa.push({body:'Release',f:z});if(da.get('ready')){fa.push({body:c('OzStrings').NOTREADY_BUTTON,f:x});}else if(ea)fa.push({body:c('OzStrings').READY_BUTTON,f:y});if(da.getIn(['owner','id'])!==ca&&!c('OzHelpers').isSubscriber(da,ca))fa.push({body:'View',f:aa});return fa;}f.exports=n;}),null);
__d('OzAll.react',['cx','OzStrings','OzAPI','OzHelpers','immutable','MessengerFlexScrollableArea.react','OzActions','OzAllRow.react','OzLoading.react','OzStores','promiseFinally','OzImmutablePureRenderMixin','React','Reflux','XUIButton.react','XUIRadioButtonGroup.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('OzLoading.react').Flex,k=c('OzLoading.react').Inline,l=c('OzStores').QueueFilterStore,m=c('OzStores').ThreadStore,n=c('React').PropTypes,o=c('React').createClass({displayName:'OzAll',mixins:[c('Reflux').connect(l,'filters'),c('Reflux').connect(m,'threads')],contextTypes:{router:n.object.isRequired},getInitialState:function ca(){return {clientLimit:y};},componentWillMount:function ca(){if(this.state.threads.size<y)this._fetchThreads();},componentDidUpdate:function ca(da,ea){var fa=ea.filters.get('all'),ga=this.state.filters.get('all');if(!c('immutable').is(fa,ga))this._fetchThreads();},render:function ca(){var da=this._getFilters(),ea=da[0],fa=da[1],ga=this._threads();return (c('React').createElement('div',{className:"_3l5z"},c('React').createElement(q,{showTags:ea,hideTags:fa,onChange:this._handleFilterChange}),c('React').createElement(p,{threads:ga,loading:!!w[aa(ea,fa)],clientLimit:this.state.clientLimit,onScrollBottom:this._handleScrollBottom,onThreadNotReady:this._handleThreadNotReady,onThreadReady:this._handleThreadReady,onThreadRelease:this._handleThreadRelease,onThreadView:this._handleThreadView,witIntents:this.props.witIntents})));},_getFilters:function ca(){var da=this.state.filters.get('all');return [da.get('showTags'),da.get('hideTags')];},_fetchThreads:function ca(){ba(this._getFilters());},_threads:function ca(){return t(s(this.state.threads),this._getFilters());},_handleFilterChange:function ca(da){c('OzActions').updateQueueFilters(i({all:i(da)}));this.setState({clientLimit:y});},_handleScrollBottom:function ca(){var da=this.state.clientLimit,ea=this._threads(),fa=da+y;this.setState({clientLimit:fa});ea.slice(da,fa).size||this._fetchThreads();},_handleThreadNotReady:function ca(da,ea){c('OzAPI').notready(c('OzHelpers').threadID(da)).done(ea,ea);},_handleThreadReady:function ca(da,ea){c('OzAPI').ready(c('OzHelpers').threadID(da)).done(ea,ea);},_handleThreadRelease:function ca(da,ea){c('OzAPI').release(c('OzHelpers').threadID(da)).done(ea,ea);},_handleThreadView:function ca(da,ea,fa){var ga=c('OzHelpers').threadID(da),ha=c('OzHelpers').hasCmdOrCtrl(fa);c('OzAPI').view(ga).done(function(ia){ea();ha||this.context.router.push('/inbox/'+ga);}.bind(this),ea);}}),p=c('React').createClass({displayName:'ThreadList',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{clientLimit:n.number.isRequired,loading:n.bool.isRequired,onScrollBottom:n.func.isRequired,onThreadNotReady:n.func.isRequired,onThreadReady:n.func.isRequired,onThreadRelease:n.func.isRequired,onThreadView:n.func.isRequired,threads:n.instanceOf(i).isRequired,witIntents:n.instanceOf(i).isRequired},render:function ca(){var da=this.props,ea=da.loading,fa=da.threads,ga=da.clientLimit;if(ea&&!fa.count())return c('React').createElement(j,null);return (c('React').createElement(c('MessengerFlexScrollableArea.react'),{ref:'scrollable',onScroll:this._handleScroll},c('React').createElement('div',{className:"_3l5-"},fa.take(ga).map(function(ha){return (c('React').createElement(c('OzAllRow.react'),{key:c('OzHelpers').threadID(ha),thread:ha,witIntents:this.props.witIntents,onThreadNotReady:this.props.onThreadNotReady,onThreadReady:this.props.onThreadReady,onThreadRelease:this.props.onThreadRelease,onThreadView:this.props.onThreadView}));}.bind(this)).valueSeq()),c('React').createElement(k,{loading:ea})));},_handleScroll:function ca(){var da=this.refs.scrollable;da&&da.isScrolledToBottom()&&this.props.onScrollBottom();}}),q=c('OzHelpers').pure(function(ca){var da,ea,fa=ca.showTags,ga=ca.hideTags,ha=ca.onChange,ia=function ja(ka){var la=ka.tagName,ma=ka.value,na=v({tagName:la,value:ma,showTags:fa,hideTags:ga});ha(na);};return (c('React').createElement('div',{className:"_3l5_"},c('React').createElement(r,{tagName:'employee',value:u('employee',fa,ga),onChange:ia,buttons:(da={},da[u.NEUTRAL]=c('OzStrings').USER_FILTER_ALL,da[u.OFF]=c('OzStrings').USER_FILTER_PUBLIC,da[u.ON]=c('OzStrings').USER_FILTER_EMPLOYEE,da)}),c('React').createElement(r,{tagName:'ready',value:u('ready',fa,ga),onChange:ia,buttons:(ea={},ea[u.NEUTRAL]=c('OzStrings').READY_FILTER_ALL,ea[u.OFF]=c('OzStrings').READY_FILTER_ATTENTION,ea[u.ON]=c('OzStrings').READY_FILTER_WAITING,ea)})));}),r=c('OzHelpers').pure(function(ca){var da=ca.tagName,ea=ca.value,fa=ca.buttons,ga=ca.onChange;return (c('React').createElement('div',{key:da,className:"_3l60"},c('React').createElement(c('XUIRadioButtonGroup.react'),{selectedValue:ea,selectedUse:'confirm',onValueChange:function ha(ia){ga({tagName:da,value:ia});}},Object.keys(fa).map(function(ha){return c('React').createElement(c('XUIButton.react'),{key:ha,value:ha,label:fa[ha]});}))));});function s(ca){return ca.sortBy(function(da){return -da.get('last-event-at');});}function t(ca,da){var ea=da[0],fa=da[1];return ca.filter(function(ga){var ha=true;if(ea.size)ha=c('OzHelpers').hasAllTags(ga,ea);if(fa.size)ha=!c('OzHelpers').hasSomeTag(ga,fa);return ha;});}var u=function ca(da,ea,fa){return ea.has(da)?ca.ON:fa.has(da)?ca.OFF:ca.NEUTRAL;};u.ON='on';u.OFF='off';u.NEUTRAL='neutral';function v(ca){var da=ca.tagName,ea=ca.value,fa=ca.showTags,ga=ca.hideTags,ha,ia;switch(ea){case u.ON:ha=fa.add(da);ia=ga.remove(da);break;case u.OFF:ha=fa.remove(da);ia=ga.add(da);break;default:ha=fa.remove(da);ia=ga.remove(da);break;}return {showTags:ha,hideTags:ia};}var w={},x={},y=20,z=2*y;function aa(ca,da){var ea=ca.toJS().join('-'),fa=da.toJS().join('-');return 'show['+ea+']hide['+fa+']';}function ba(ca){var da=ca[0],ea=ca[1],fa=aa(da,ea),ga=w[fa];c('OzHelpers').debug('[oz-all] fetchThreads',fa);if(ga){c('OzHelpers').debug('[oz-all] abort fetchthreads : loading',fa);return;}var ha=x[fa]||0;w[fa]=true;c('promiseFinally')(c('OzAPI').allThreads(da,ea,ha,z),function(ia){return w[fa]=false;}).done(function(ia){return x[fa]=ha+z;});}f.exports=o;}),null);
__d('OzExpirationCountdown.react',['cx','relativeTimeString.atlas','OzDate.react','React'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=30*1000;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(){var n,o;'use strict';for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=j.constructor).call.apply(o,[this].concat(q)),this.$OzExpirationCountdown2=function(){this.forceUpdate();if(this.isExpired()){clearInterval(this.$OzExpirationCountdown1);this.$OzExpirationCountdown1=null;}}.bind(this),this.remainingTime=function(){return this.props.endTime-Date.now();}.bind(this),this.isExpired=function(){return this.props.endTime<=Date.now();}.bind(this),n;}m.prototype.componentDidMount=function(){'use strict';this.$OzExpirationCountdown1=setInterval(this.$OzExpirationCountdown2,l);};m.prototype.componentWillReceiveProps=function(){'use strict';this.$OzExpirationCountdown1=this.$OzExpirationCountdown1||setInterval(this.$OzExpirationCountdown2,l);};m.prototype.componentWillUnmount=function(){'use strict';clearInterval(this.$OzExpirationCountdown1);};m.prototype.render=function(){'use strict';var n=this.props.endTime,o=this.isExpired()&&c('React').createElement('span',null,'Expired ',c('React').createElement(c('OzDate.react'),{timestamp:n}))||this.remainingTime()<=60*1000&&'Expires in less than a minute'||'Expires in '+c('relativeTimeString.atlas')(n,true),p="_3d53"+(this.isExpired()?' '+"_3d54":'')+(!this.isExpired()?' '+"_3d55":'');return c('React').createElement('span',{className:p},o);};m.propTypes={endTime:k.number.isRequired};f.exports=m;}),null);
__d('OzMessage.react',['cx','getURLRanges','OzHelpers','formatDate','Image.react','immutable','Link.react','MNCommerceAgentItemSuggestionMercuryShareAttachment.react','MNCommercePromotionMercuryShareAttachment.react','OzExpirationCountdown.react','OzImmutablePureRenderMixin','React','OzWrapper.react','TextWithEntities.react','XStickerAssetController'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('immutable').List,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzMessage',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{message:k.instanceOf(i).isRequired},render:function ma(){var na=this.props.message,oa=na.get('attachments')||j(),pa=j([na.get('text')&&ka(na.get('text'))]).concat(oa.map(function(qa){var ra=x(qa)&&y(qa)||s(qa)&&t(qa)||ea(qa)&&ga(fa(qa))||da(qa)&&ga(qa.get('uri'))||ba(qa)&&ca(qa)||z(qa)&&aa(qa)||u(qa)&&v(qa)||q(qa)&&r(qa)||m(qa)&&p(o(qa.get('metadata')))||n(qa)&&p(c('OzHelpers').uiSuggestion(qa.get('suggestion')))||ha(qa)&&ia(qa.getIn(['xma','link']))||qa.get('uri')&&ia(qa.get('uri'));if(ra){return ra;}else{c('OzHelpers').error('could not render attachment',qa.toJS(),na.toJS());return la('Oops. We could not render this attachment.');}})).filter(function(qa){return !!qa;}).map(function(qa,ra){return (c('React').createElement('span',{key:ra,className:"_15_n"},qa));});if(pa.size){return c('React').createElement('span',null,pa);}else{c('OzHelpers').error('no text or attachments',na.toJS());return la('Oops. We did not get text or attachments.');}}}),m=function ma(na){return na.hasIn(['metadata','target_url']);},n=function ma(na){return na.has('suggestion');},o=function ma(na){if(!i.isMap(na.get('total_cost'))&&na.has('raw_amount'))na=na.set('total_cost',i({amount:+na.get('raw_amount')}));return na.update('target_url',c('OzHelpers').shimURI).toJS();};function p(ma){return (c('React').createElement('div',{className:"_53qw"},ma.expiration_time?c('React').createElement('div',{className:"_4jjz"},c('React').createElement(c('OzExpirationCountdown.react'),{endTime:ma.expiration_time*1000})):null,c('React').createElement('div',{className:"_4jj-"},c('React').createElement(c('MNCommerceAgentItemSuggestionMercuryShareAttachment.react'),{attachment:{target:ma}}))));}var q=function ma(na){return na.get('mime_type')==='oz/business-message';};function r(ma){var na=ma.get('xma').setIn(['target','call_to_actions'],[]).toJS();return (c('React').createElement('div',{className:"_53qw"},c('React').createElement('div',{className:"_4jj-"},c('React').createElement(c('MNCommercePromotionMercuryShareAttachment.react'),{attachment:na}))));}var s=function ma(na){return na.get('mime_type')==='oz/event';};function t(ma){var na=ma.get('metadata'),oa=function qa(ra){return ra?c('formatDate')(ra,'M jS, g:ia'):'[no time]';},pa=na.getIn(['place','name'])||na.get('description')||'[no location]';return (c('React').createElement('a',{className:"_3is9",href:na.get('url'),target:'_blank'},c('React').createElement('img',{alt:pa,className:"_3isa",src:na.get('image_url')}),c('React').createElement('div',{className:"_3isb"},c('React').createElement('div',{className:"_3isc"},na.get('title')||'[no invitation title]'),c('React').createElement('div',null,oa(na.get('start')),' — ',oa(na.get('end'))),c('React').createElement('div',null,pa))));}var u=function ma(na){var oa=na.get('metadata');return oa&&oa.get('location')&&oa.get('url')&&oa.get('image_url');};function v(ma){return ga(ma.getIn(['metadata','image_url']),ma.getIn(['metadata','url']));}var w=function ma(na){var oa=na.get('uri'),pa=na.get('sticker_id');if(pa)oa=c('XStickerAssetController').getURIBuilder().setInt('sticker_id',pa).getURI().toString();return oa;},x=function ma(na){return (na.get('sticker_id')||c('OzHelpers').isStickerType(na.get('mime_type')))&&w(na);};function y(ma){return (c('React').createElement(c('Image.react'),{className:"__vl",src:w(ma)}));}var z=function ma(na){return (/video/.test(na.get('mime_type'))&&na.get('uri'));};function aa(ma){return (c('React').createElement('video',{controls:true,height:'300',width:'300'},c('React').createElement('source',{src:ma.get('uri'),type:ma.get('mime_type')})));}var ba=function ma(na){return (/audio/.test(na.get('mime_type'))&&na.get('uri'));};function ca(ma){return (c('React').createElement('audio',{className:"_1d86",controls:true},c('React').createElement('source',{src:ma.get('uri'),type:ma.get('mime_type')})));}var da=function ma(na){var oa=/blob:/.test(na.get('uri')),pa=/\.(jpg|gif|png)/.test(na.get('uri'));return na.get('uri')&&(c('OzHelpers').isImageType(na.get('mime_type'))||oa||pa);},ea=function ma(na){return (/base64/.test(na.get('mime_type'))&&na.get('data'));},fa=function ma(na){return na.get('mime_type')+','+na.get('data');};function ga(ma,na){return (c('React').createElement('a',{href:na||ma,target:'_blank',className:"_4y6l",style:{backgroundImage:'url(\''+ma+'\')'}}));}var ha=function ma(na){return !!na.getIn(['xma','link']);};function ia(ma){return (c('React').createElement('div',{className:"_4y6k"},c('React').createElement('a',{href:ma,target:'_blank'},'Attachment Link')));}function ja(ma,na){return (c('React').createElement(c('Link.react'),{target:'_blank',href:c('OzHelpers').shimURI(na.entity.url)},ma));}function ka(ma){return (c('React').createElement(c('TextWithEntities.react'),{className:"_4y6k",text:ma,interpolator:ja,ranges:c('getURLRanges')(ma),renderEmoticons:true,renderEmoji:true}));}function la(ma){return (c('React').createElement('div',{className:"_4y6k _5kng"},ma));}f.exports=c('OzWrapper.react')(l);}),null);
__d('OzSearchSource',['AbstractSearchSource'],(function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('AbstractSearchSource'));i=h&&h.prototype;function j(k){'use strict';i.constructor.call(this);this.$OzSearchSource1=k;}j.prototype.bootstrap=function(){'use strict';return this.$OzSearchSource1({});};j.prototype.suggest=function(k){'use strict';return this.$OzSearchSource1(k);};j.prototype.searchImpl=function(k,l){'use strict';return this.$OzSearchSource1({query:k}).then(function(m){return l(m,k);},function(m){return l([],k);});};f.exports=j;}),null);
__d('OzFeedbackDashboard.react',['cx','Promise','OzAPI','OzHelpers','immutable','OzButton.react','OzConfig','OzMessage.react','OzSearchSource','OzImmutablePureRenderMixin','React','Reflux','SearchableDropdownInput.contrib','SearchableEntry','Stars.react','joinClasses'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzFeedbackDashboard',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],contextTypes:{uid:j.string.isRequired,router:j.object.isRequired},getInitialState:function da(){return {messages:i(),authorID:this.context.uid};},componentWillMount:function da(){this._searchSource=new (c('OzSearchSource'))(function(ea){var fa=(ea.query||'').toLowerCase();return new (c('Promise'))(function(ga){return ga(this.props.reps.valueSeq().map(u).concat([u('autoresponse-bot'),u('survey-bot')]).sortBy(function(ha){return ha.getTitle();}).filter(function(ha){return (ha.getTitle()||'').toLowerCase().indexOf(fa)>-1;}).toJS());}.bind(this));}.bind(this));},componentDidMount:function da(){this._fetchFeedback();},render:function da(){return (c('React').createElement('div',{className:"_60f"},this.state.config.getIn(['GK','supervisor'])?c('React').createElement(l,{reps:this.props.reps,authorID:this.state.authorID,searchSource:this._searchSource,onSelect:function(ea){return this.setState({messages:i(),activeMessage:null,authorID:ea.getUniqueID()},this._fetchFeedback);}.bind(this)}):null,c('React').createElement(m,{messages:this.state.messages}),c('React').createElement(r,{messages:this.state.messages,reps:this.props.reps,activeMessage:this.state.activeMessage||this.state.messages.first(),onMessageClick:function(ea){return this.setState({activeMessage:ea});}.bind(this),onSeeThreadClick:function(ea){return this.context.router.push('/inbox/'+ea);}.bind(this)})));},_fetchFeedback:function da(){c('OzAPI').authorFeedback(this.state.authorID).done(function(ea){ea=ea.sortBy(function(fa){return -fa.get('timestamp');});this.isMounted()&&this.setState({messages:ea});}.bind(this));}}),l=c('OzHelpers').pure(function(da){var ea=da.reps,fa=da.authorID,ga=da.searchSource,ha=da.onSelect;return (c('React').createElement('div',{className:"_5p66"},c('React').createElement('div',{className:"_wa_"},c('React').createElement(c('SearchableDropdownInput.contrib'),{value:u(ea.get(fa)||fa),onSelect:ha,placeholder:'Pick a rep',emptySearchResultsText:'No Rep found',searchSource:ga}))));}),m=c('OzHelpers').pure(function(da){var ea=da.messages;return (c('React').createElement('div',null,c('React').createElement(o,{messages:ea,days:'-7',span:'7'}),c('React').createElement(o,{messages:ea,days:'-14',span:'7'}),c('React').createElement(o,{messages:ea,days:'-21',span:'7'}),c('React').createElement(o,{messages:ea,days:'-30',span:'30'}),c('React').createElement(o,{messages:ea,days:'-60',span:'30'})));}),n=c('OzHelpers').pure(function(da){var ea=da.day,fa=da.span;return (c('React').createElement('div',{className:"_24xm"},ea+fa==0?'LAST '+ -ea+' DAYS':'FROM '+(ea+fa)+' TO '+ea+' DAYS'));}),o=c('OzHelpers').pure(function(da){var ea=da.messages,fa=da.days,ga=da.span,ha=parseInt(fa,10),ia=parseInt(ga,10),ja=ca(ea,ha,ha+ia);return (c('React').createElement('div',{className:"_wb0"},c('React').createElement(n,{day:ha,span:ia}),c('React').createElement('div',{className:"_wb2"},c('React').createElement(p,{label:'TONE'},z(ja)),c('React').createElement(p,{label:'RESPONSIVENESS'},y(ja)),c('React').createElement(p,{label:'EXECUTION'},x(ja)),c('React').createElement(p,{label:'CONSOLE'},aa(ja)),c('React').createElement(q,null,ba(ja))),c('React').createElement('div',{className:"_3gch"},c('React').createElement(p,{label:'FEEDBACK GIVEN'},ja.size))));}),p=c('OzHelpers').pure(function(da){var ea=da.label,fa=da.children,ga=da.variation,ha=da.className;return (c('React').createElement('div',{className:c('joinClasses')(ha,"_wb3")},c('React').createElement('span',{className:"_wb4"},fa),c('React').createElement('span',{className:"_wb5"},ea)));}),q=c('OzHelpers').pure(function(da){var ea=da.children;return (c('React').createElement(p,{label:'POLICY',className:(ea===0?"_wb6":'')+(ea>0?' '+"_wb7":'')},ea));}),r=c('OzHelpers').pure(function(da){var ea=da.messages,fa=da.reps,ga=da.activeMessage,ha=da.onMessageClick,ia=da.onSeeThreadClick,ja=ga&&ga.get('reviews'),ka=ga&&ga.get('user-id');return (c('React').createElement('div',{className:"_wb8"},c('React').createElement('div',{className:"_wbc"},c('React').createElement('div',{className:"_4fj7"},ea.map(function(la){return (c('React').createElement('div',{key:c('OzHelpers').msgID(la),onClick:function ma(na){return ha(la);},className:"_wbf"+(la===ga?' '+"_wbg":'')},c('React').createElement(c('OzMessage.react'),{message:la})));}).valueSeq())),c('React').createElement('div',{className:"_wbh"},c('React').createElement('div',{className:"_wbe"},ja?ja.map(function(la){return (c('React').createElement(s,{key:la.get('id'),rep:fa.get(la.get('reviewer-id')),review:la}));}).valueSeq():null)),c('React').createElement('div',{className:"_wbi"},ka?c('React').createElement(c('OzButton.react'),{onClick:function la(ma){return ia(ka);}},'See Thread'):null)));}),s=c('OzHelpers').pure(function(da){var ea=da.review,fa=da.rep;return (c('React').createElement('div',{className:"_wbj"},c('React').createElement('div',{className:"_wbk"},c('React').createElement('h2',{className:"_wbl"},fa&&fa.get('name')),ea.has('tone')?c('React').createElement(t,{label:'Tone'},c('React').createElement(c('Stars.react'),{count:ea.get('tone'),max:3,size:'large'})):null,ea.has('responsiveness')?c('React').createElement(t,{label:'Responsiveness'},c('React').createElement(c('Stars.react'),{count:ea.get('responsiveness'),max:3,size:'large'})):null,ea.has('execution')?c('React').createElement(t,{label:'Execution'},c('React').createElement(c('Stars.react'),{count:ea.get('execution'),max:3,size:'large'})):null,ea.has('followed-policy')?c('React').createElement(t,{label:'Followed Policy?'},c('React').createElement('div',{className:"_wbm"},ea.get('followed-policy')?'YES':'NO')):null,ea.has('console-proficiency')?c('React').createElement(t,{label:'Console'},c('React').createElement(c('Stars.react'),{count:ea.get('console-proficiency'),max:3,size:'large'})):null),c('React').createElement('div',{className:"_wbn"},ea.get('body'))));}),t=c('OzHelpers').pure(function(da){var ea=da.label,fa=da.children;return (c('React').createElement('div',{className:"_wbo"},fa,c('React').createElement('div',{className:"_wbp"},ea)));});function u(da){var ea=function fa(ga){return new (c('SearchableEntry'))(ga);};return da?da.get?ea({title:da.get('name'),uniqueID:da.get('fbid')}):ea({title:da,uniqueID:da}):null;}function v(da,ea){return function(fa){var ga=fa.valueSeq().flatMap(function(ka){return ka.get('reviews');}).filter(function(ka){return ka&&ka.has(da);}),ha=ga.reduce(function(ka,la){var ma=ka[0],na=ka[1];return [ma+ea,na+la.get(da)];},[0,0]),ia=ha[0],ja=ha[1];return ia?Math.round(ja/ia*100)+'%':' ';};}function w(da){return function(ea){var fa=ea.valueSeq().flatMap(function(ha){return ha.get('reviews');}).filter(function(ha){return ha&&ha.has(da);}),ga=fa.reduce(function(ha,ia){return ha+!ia.get(da);},0);return ga?ga:'';};}var x=v('execution',3),y=v('responsiveness',3),z=v('tone',3),aa=v('console-proficiency',3),ba=w('followed-policy');function ca(da,ea,fa){var ga=new Date().getDate(),ha=+new Date(Date.now()).setDate(ga+ea),ia=+new Date(Date.now()).setDate(ga+fa);return da.filter(function(ja){var ka=+ja.get('timestamp');return ka>=ha&&ka<=ia;});}f.exports=k;}),null);
__d('OzInboxThreadRow.react',['cx','OzHelpers','immutable','OzConfig','OzLastEvent.react','OzThreadLabels.react','OzUserImage.react','OzImmutablePureRenderMixin','React','OzWrapper.react','Reflux','Sound','Timestamp.react','Tooltip'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('OzThreadLabels.react').OzLabelList,k=c('React').PropTypes,l=1000,m=c('React').createClass({displayName:'OzInboxThreadRow',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{thread:k.object.isRequired,locker:k.object.isRequired,selected:k.bool.isRequired,onClick:k.func.isRequired,onUnview:k.func.isRequired,witIntents:k.instanceOf(i).isRequired},contextTypes:{uid:k.string.isRequired},getInitialState:function r(){return {flashing:false,unread:false};},componentWillReceiveProps:function r(s){var t=s.thread,u=s.selected;if(this.state.config.getIn(['GK','responsiveness'])){if(n(this.props.thread,t)){o(t);this.setState({unread:true,flashing:true});window.clearTimeout(this._flashingTimeout);this._flashingTimeout=window.setTimeout(function(v){return this.setState({flashing:false});}.bind(this),l);}if(u)this.setState({unread:false});}},componentWillUnmount:function r(){window.clearTimeout(this._flashingTimeout);},render:function r(){var s=this.props,t=s.thread,u=s.locker,v=s.selected,w=s.subscribed,x=s.owned,y=s.onUnview,z=c('OzHelpers').getName(t),aa=c('OzHelpers').photo(t),ba=c('OzHelpers').lastEvents(t).last(),ca=!x&&t.get('ui-reassign'),da=c('OzHelpers').hasPaid(t),ea=c('OzHelpers').hasReminder(t),fa=t.get('locked'),ga=fa?'Thread locked by '+u.get('name')+'\n       at '+new Date(t.get('locked-at')).toLocaleString():'',ha=x&&(t.get('ready')||da||ea)&&!fa,ia=null,ja=ba&&ba.get('timestamp');if(!x){var ka=t.get('ui-reassign')?'Reassigned to':'Grabbed by';ia=ka+' '+c('OzHelpers').nameOrId(t.get('owner'));}var la=this.state.config.getIn(['GK','responsiveness']),ma=this.state.config.getIn(['GK','responsivenessV2']),na=ma?c('OzHelpers').isUnread(t)&&!v:this.state.unread;return (c('React').createElement('div',{onClick:this._handleClick,className:"_2ic2"+(la&&na?' '+"_2ic4":'')+(la&&this.state.flashing?' '+"_5lan":'')+(ha?' '+"_2ic3":'')+(ea?' '+"_2ic5":'')+(da?' '+"_2ic6":'')+(v?' '+"_2ic7":'')+(ca?' '+"_2q4a":'')},c('React').createElement('div',{className:"_2ic8"},c('React').createElement(c('OzUserImage.react'),{photo:aa}),w?c('React').createElement('button',{className:"_1-hv _2ic9",onClick:function oa(pa){return y(t);}}):null),c('React').createElement('div',{className:"_2ica"},!x?c('React').createElement(p,{name:ia}):null,c('React').createElement('h1',{className:"_4-_7 _2ice"},z),c('React').createElement(q,{thread:t,witIntents:this.props.witIntents}),c('React').createElement('div',{className:"_2icb"},ba?c('React').createElement(c('OzLastEvent.react'),{lastEvent:ba,name:z}):null),c('React').createElement('div',{className:"_3lxn"},c('React').createElement(j,{className:"_2icc",thread:t}))),c('React').createElement('div',{className:"_6f"},ja?c('React').createElement('div',{className:"_2icf"},c('React').createElement(c('Timestamp.react'),{autoUpdate:true,shorten:true,time:ja/1000})):null,c('React').createElement('div',babelHelpers['extends']({className:fa?"_1hw":''},c('Tooltip').propsFor(ga))))));},_handleClick:function r(){this.props.onClick(this.props.thread);}});function n(r,s){return (c('OzHelpers').unreadTs(r)||0)<(c('OzHelpers').unreadTs(s)||0);}c('Sound').init(['audio/ogg','audio/mpeg']);function o(r){var s=c('OzHelpers').unreadTs(r);c('OzHelpers').debug('[inboxThreadRow] sound for tid '+c('OzHelpers').threadID(r)+', ts '+s);var t=c('OzConfig').ConfigStore.data.getIn(['resources','sound','notifyUnread'],i()).toObject(),u=t.ogg,v=t.mp3;if(s&&(u||v)){c('Sound').play([u,v],s,false);}else c('OzHelpers').warn('[inboxThreadRow] sounds not loaded');}function p(r){var s=r.name,t=r.lastEvent,u=t&&t.get('timestamp');return (c('React').createElement('div',{className:"_2icd"},c('React').createElement('h1',{className:"_4-_7 _2ice"},s),u?c('React').createElement('div',{className:"_2icf"},c('React').createElement(c('Timestamp.react'),{autoUpdate:true,shorten:true,time:u/1000})):null));}function q(r){var s=r.thread,t=r.witIntents,u=c('OzHelpers').openIntents(s).first(),v=u&&t.getIn([u.get('wit-intent-uuid'),'name']);return v?c('React').createElement('div',{className:"_2icg"},v):c('React').createElement('span',null);}f.exports=c('OzWrapper.react')(m);}),null);
__d('OzInboxThreadList.react',['cx','OzHelpers','joinClasses','OzInboxThreadRow.react','immutable','OzLoading.react','OzImmutablePureRenderMixin','React','OzWrapper.react'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('immutable').OrderedMap,k=c('React').PropTypes,l=c('OzLoading.react').Inline,m=c('React').createClass({displayName:'OzInboxThreadList',mixins:[c('OzImmutablePureRenderMixin')],contextTypes:{uid:k.string.isRequired},propTypes:{loading:k.bool.isRequired,onThreadClick:k.func.isRequired,onUnview:k.func.isRequired,threadGroups:k.instanceOf(j).isRequired,witIntents:k.instanceOf(i).isRequired,className:k.string,selectedThread:k.string},render:function o(){var p=this.props.threadGroups.some(function(q){return q.count();});return (c('React').createElement('div',{className:c('joinClasses')("_36ob",this.props.className)},p?c('React').createElement(l,{key:'l',loading:this.props.loading}):c('React').createElement(n,null),p?this.props.threadGroups.map(this._renderRows).valueSeq():null));},_renderRows:function o(p,q){var r=p.map(function(s){return (c('React').createElement(c('OzInboxThreadRow.react'),{key:c('OzHelpers').threadID(s),thread:s,locker:this.props.reps.get(s.get('locker-id'),i()),owned:c('OzHelpers').isOwner(s,this.context.uid),selected:c('OzHelpers').threadID(s)===this.props.selectedThread,subscribed:c('OzHelpers').isSubscriber(s,this.context.uid),onClick:this.props.onThreadClick,onUnview:this.props.onUnview,witIntents:this.props.witIntents}));}.bind(this)).valueSeq();return (c('React').createElement('span',{className:"_36oc",key:q},r));}});function n(){return (c('React').createElement('div',{className:"_725"},'You do not own any threads at the moment.',c('React').createElement('br',null)));}f.exports=c('OzWrapper.react')(m);}),null);
__d('OzTabHeader.react',['cx','React'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){var k=j.tabs,l=j.onChange,m=j.active;return (c('React').createElement('div',{className:"_2j6l"},k.map(function(n){var o=n[0],p=n[1];return (c('React').createElement('button',{key:p,role:'button',className:"_1-hv"+(' '+"_2j6m")+(p===m?' '+"_2j6n":''),onClick:function q(r){return l([o,p]);}},o));})));}f.exports=i;}),null);
__d('OzInbox.react',['cx','OzAPI','OzHelpers','DataTransfer','immutable','OzActions','OzInboxThreadList.react','OzInboxThreads','OzStores','OzTabHeader.react','ReactComponentWithPureRenderMixin','React','OzWrapper.react','Reflux','promiseFinally'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('immutable').Map,l=c('immutable').OrderedMap,m=c('immutable').List,n=c('OzStores').HandledEventsStore,o=c('OzStores').HumanStore,p=c('OzStores').ThreadStore,q=c('React').PropTypes,r=c('OzInboxThreads').OZ_GRABBED_TAB,s=c('OzInboxThreads').OZ_VIEWING_TAB,t=c('OzInboxThreads').OZ_PAST_TAB,u=5000,v=30000,w=120*1000,x=r,y=c('React').createClass({displayName:'OzInbox',mixins:[c('ReactComponentWithPureRenderMixin'),c('Reflux').connect(p,'threads'),c('Reflux').connect(o,'humans'),c('Reflux').connect(n,'handledEvents')],contextTypes:{uid:q.string.isRequired,router:q.object.isRequired},getInitialState:function da(){return {activeTab:null,loading:false};},componentDidMount:function da(){this._fetchThreads();var ea=window.setInterval(function(ga){this._fetchThreads();}.bind(this),v),fa=window.setInterval(function(){var ga=this.threads(this._getActiveTab());if(ga.some(function(ha){return ha.get('ui-reassign');}))c('OzActions').clearReassignState();}.bind(this),u);this._cleanup=function(){x=this._getActiveTab();window.clearInterval(fa);window.clearInterval(ea);}.bind(this);},componentDidUpdate:function da(ea,fa){var ga=this.props.params.threadid;if(!ga){var ha=this.threads(),ia=c('OzStores').ActiveThreadStore.data.get('oldThreadID'),ja=ha.get(ia)||ha.first();if(ja){c('OzHelpers').info('[ozinbox] search for best thread, found:',ja);this.context.router.push('/inbox/'+c('OzHelpers').threadID(ja));}}},componentWillUnmount:function da(){this._cleanup();},render:function da(){var ea=this._getActiveTab(),fa=this.threads(ea),ga=this.state.humans.getIn([this.context.uid,'load'],0),ha=function ia(ja){return ja.preventDefault();};return (c('React').createElement('div',{className:"_4b5_",onDragStart:ha,onDragEnd:ha,onDragOver:ha,onDrop:function ia(ja){ha(ja);var ka=new (c('DataTransfer'))(ja.nativeEvent.dataTransfer);c('OzActions').updateComposer({files:ka.getFiles()});}},c('React').createElement(z,{threadGroups:ba(fa,this.context.uid,ea),reps:this.props.reps,loading:this.state.loading,activeCount:ga,activeTab:ea,selectedThread:this.props.params.threadid,onTabChange:this._handleTabChange,onUnview:this._handleUnview,onThreadClick:this._handleThreadClick,witIntents:this.props.witIntents}),this._renderDetails()));},_getActiveTab:function da(){var ea=this.state.threads.get(this.props.params.threadid);return this.state.activeTab||ea&&c('OzHelpers').isOwner(ea,this.context.uid)&&r||ea&&c('OzHelpers').isSubscriber(ea,this.context.uid)&&s||x||r;},_handleUnview:function da(ea){this._callAPIAndShift('unview',ea);},_handleThreadClick:function da(ea){c('OzHelpers').info('[inbox/handleThreadClick] clicked on thread',c('OzHelpers').threadID(ea));var fa=c('OzHelpers').nextTaskForThread(ea);this.context.router.push(c('OzHelpers').threadPath({threadid:c('OzHelpers').threadID(ea),intentid:fa&&fa.get('intent-id'),taskid:fa&&fa.get('id')}));},_handleTabChange:function da(ea){var fa=ea[0],ga=ea[1];this.setState({activeTab:ga});},_callAPIAndShift:function da(ea,fa){var ga=aa(this.threads(r),fa),ha=function(ja){c('OzHelpers').info('[inbox/callAPIAndShift] shifting to thread',c('OzHelpers').threadID(ja));this.context.router.push('/inbox/'+c('OzHelpers').threadID(ja));}.bind(this),ia=c('OzAPI')[ea](c('OzHelpers').threadID(fa));ga&&ha(ga);ia.done(null,function(ja){c('OzHelpers').error('[inbox] could not shift',ja);ha(fa);});},_renderDetails:function da(){var ea=this.props.params.threadid;if(!ea&&this.threads().isEmpty())return this._renderFinished();var fa=c('OzHelpers').fullThreadData(this.state.threads,this.state.handledEvents,ea);if(!fa||!this.props.children)return null;return (c('React').cloneElement(this.props.children,{thread:fa,witIntents:this.props.witIntents,requirements:this.props.requirements,merchants:this.props.merchants,humans:this.state.humans,reps:this.props.reps}));},_renderFinished:function da(){return (c('React').createElement('div',{className:"_57l3"},c('React').createElement('div',{className:"_57l8"},c('React').createElement('div',{className:"_57lo"}),c('React').createElement('h2',null,'Congrats! You\'ve made a lot of people happy'),c('React').createElement('p',null,'Sit tight, new messages should be coming soon!'))));},_fetchThreads:function da(){var ea=this.state.loading;if(ea)return;this.setState({loading:true});c('promiseFinally')(c('OzAPI').myThreads(),function(fa){return this.isMounted()&&this.setState({loading:false});}.bind(this)).done();},threads:function da(ea){return c('OzInboxThreads').getInboxThreads(this.state.threads,this.context.uid,ea);}});i=babelHelpers.inherits(z,c('React').PureComponent);j=i&&i.prototype;z.prototype.render=function(){'use strict';var da=this.props,ea=da.activeTab,fa=da.onTabChange,ga=da.activeCount,ha=babelHelpers.objectWithoutProperties(da,['activeTab','onTabChange','activeCount']),ia=ga?'Open ('+ga+')':'Open';return (c('React').createElement('div',{className:"_4b61"},c('React').createElement('div',{className:"_4cwh"},c('React').createElement(c('OzTabHeader.react'),{active:ea,tabs:[[ia,r],['Viewing',s],['Closed',t]],onChange:fa})),c('React').createElement('div',{className:"_3_cz"},c('React').createElement('div',{className:"_4fj7"},c('React').createElement(c('OzInboxThreadList.react'),babelHelpers['extends']({className:ea===r?"_2sav":''},ha))))));};function z(){'use strict';i.apply(this,arguments);}z.propTypes=babelHelpers['extends']({activeTab:q.oneOf([r,s,t]).isRequired,onTabChange:q.func.isRequired},c('OzInboxThreadList.react').propTypes);function aa(da,ea){var fa=c('OzHelpers').threadID(ea),ga=da.toList(),ha=ga.findIndex(function(ka){return c('OzHelpers').threadID(ka)===fa;}),ia=ha-1,ja=ha+1;if(ja<ga.count()){return ga.get(ja);}else if(ia>=0)return ga.get(ia);}function ba(da,ea,fa){var ga;switch(fa){case r:return ca(da,ea,fa);default:return l((ga={},ga[fa]=da,ga));}}function ca(da,ea,fa){var ga='Needs Attention',ha='Up For Grabs',ia='Waiting',ja=function ka(la){var ma=c('OzHelpers').isOwner(la,ea),na=la.get('ready')||c('OzHelpers').hasPaid(la)||c('OzHelpers').hasReminder(la),oa=c('OzHelpers').isLocker(la,ea),pa=c('OzHelpers').hasOpenIntents(la);return ma&&(oa||na&&pa)?ga:na?ha:ia;};return l().withMutations(function(ka){ka.set(ga,[]);ka.set(ha,[]);ka.set(ia,[]);da.forEach(function(la){return ka.update(ja(la),function(ma){ma.push(la);return ma;});});}).map(function(ka){return m(ka);});}f.exports=c('OzWrapper.react')(y);}),null);
__d('PhotocropConstraintConstants',[],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={BOUNDARY:'boundary',SQUARE:'square',WIDE:'wide'};h.getAspectRatioForType=function(i){switch(i){case h.SQUARE:return 1;case h.WIDE:return 16/9;default:return null;}};f.exports=h;}),null);
__d('PhotocropConstraint',['Vector','PhotocropConstraintConstants','clamp'],(function a(b,c,d,e,f,g){var h,i,j,k;if(c.__markCompiled)c.__markCompiled();function l(p){'use strict';this.photocrop=p;this.pos=null;}l.prototype.onMouseMove=function(p,q,r){'use strict';var s=p.sub(this.pos);if(q){this.onResize(s,r);}else this.onMove(s);this.pos=this.pos.add(s);};l.prototype.onMouseDown=function(p){'use strict';this.pos=p;};l.prototype.onResize=function(p,q){'use strict';};l.prototype.onMove=function(p){'use strict';var q=this.photocrop.box,r=this.photocrop.wrapper.offsetWidth,s=this.photocrop.wrapper.offsetHeight;p.x=c('clamp')(p.x,-q.l,r-q.r);p.y=c('clamp')(p.y,-q.t,s-q.b);this.photocrop.box=q.add(p);};h=babelHelpers.inherits(m,l);i=h&&h.prototype;m.prototype.onResize=function(p,q){'use strict';var r=this.photocrop.min_width,s=this.photocrop.min_height,t=this.photocrop.box,u=this.photocrop.wrapper.offsetWidth,v=this.photocrop.wrapper.offsetHeight;switch(q){case 'ne':t.r+=p.x=c('clamp')(p.x,t.l+r-t.r,u-t.r);t.t+=p.y=c('clamp')(p.y,-t.t,t.b-s-t.t);break;case 'nw':t.l+=p.x=c('clamp')(p.x,-t.l,t.r-r-t.l);t.t+=p.y=c('clamp')(p.y,-t.t,t.b-s-t.t);break;case 'se':t.r+=p.x=c('clamp')(p.x,t.l+r-t.r,u-t.r);t.b+=p.y=c('clamp')(p.y,t.t+s-t.b,v-t.b);break;case 'sw':t.l+=p.x=c('clamp')(p.x,-t.l,t.r-r-t.l);t.b+=p.y=c('clamp')(p.y,t.t+s-t.b,v-t.b);break;}};function m(){'use strict';h.apply(this,arguments);}j=babelHelpers.inherits(n,l);k=j&&j.prototype;n.prototype.setRatio=function(p){'use strict';this.ratio=p;return this;};n.prototype.onMouseDown=function(p){'use strict';k.onMouseDown.call(this,p);var q=this.photocrop.box,r=q.r-q.l,s=q.b-q.t;this.displacement=new (c('Vector'))(r,s);};n.prototype.$AspectRatioConstraint1=function(p,q,r,s,t,u){'use strict';var v,w,x,y,z;v=this.displacement.x/this.displacement.y;w=y=c('clamp')(q,p,r);x=z=c('clamp')(t,s,u);if(v>this.ratio){x=c('clamp')(w/this.ratio,s,u);w=x*this.ratio;}else{w=c('clamp')(x*this.ratio,p,r);x=w/this.ratio;}return new (c('Vector'))(w,x);};n.prototype.onResize=function(p,q){'use strict';var r=this.photocrop.min_width,s=this.photocrop.min_height,t=this.photocrop.box,u=this.photocrop.wrapper.offsetWidth,v=this.photocrop.wrapper.offsetHeight,w;switch(q){case 'ne':this.displacement=this.displacement.add(p.x,-p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,u-t.l,s,this.displacement.y,t.b);t.r=t.l+w.x;t.t=t.b-w.y;break;case 'nw':this.displacement=this.displacement.add(-p.x,-p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,t.r,s,this.displacement.y,t.b);t.l=t.r-w.x;t.t=t.b-w.y;break;case 'se':this.displacement=this.displacement.add(p.x,p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,u-t.l,s,this.displacement.y,v-t.t);t.r=t.l+w.x;t.b=t.t+w.y;break;case 'sw':this.displacement=this.displacement.add(-p.x,p.y);w=this.$AspectRatioConstraint1(r,this.displacement.x,t.r,s,this.displacement.y,v-t.t);t.l=t.r-w.x;t.b=t.t+w.y;break;}};function n(){'use strict';j.apply(this,arguments);}function o(p,q){var r;switch(q){case c('PhotocropConstraintConstants').BOUNDARY:r=new m(p);break;case c('PhotocropConstraintConstants').WIDE:case c('PhotocropConstraintConstants').SQUARE:r=new n(p).setRatio(c('PhotocropConstraintConstants').getAspectRatioForType(q));break;default:throw Error('unsupported PhotocropConstraint type');}return r;}f.exports=o;}),null);
__d('Photocrop2',['ArbiterMixin','PhotocropConstraintConstants','CSS','DOM','Event','PhotosConst','Rect','Style','Vector','mixin','PhotocropConstraint'],(function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();h=babelHelpers.inherits(j,c('mixin')(c('ArbiterMixin')));i=h&&h.prototype;function j(k,l,m){'use strict';i.constructor.call(this);this.photo=k;var n=this.getPhotoDimensions();if(m){this.imageDimensions=new (c('Vector'))(m.x,m.y);}else this.imageDimensions=new (c('Vector'))(n.x,n.y);l.height=l.height||c('PhotosConst').PIC_NORMAL_FBX_SIZE;l.width=l.width||c('PhotosConst').PIC_NORMAL_FBX_SIZE;Object.assign(this,{target:this.photo.parentNode,create_target:false,target_parent:this.photo.parentNode,min_width:c('PhotosConst').PIC_NORMAL_FBX_SIZE,min_height:c('PhotosConst').PIC_NORMAL_FBX_SIZE,center_x:(n.x||l.width)/2,center_y:(n.y||l.height)/2,constraint_type:c('PhotocropConstraintConstants').BOUNDARY},l);this._unscaledMinHeight=this.min_height;this._unscaledMinWidth=this.min_width;this._unscaledHeight=this.height;this._unscaledWidth=this.width;this.setInitialDimensionsAndPos();if(this.create_target){this.target=c('DOM').create('div');c('CSS').addClass(this.target,'stageCropper');this.target_parent.appendChild(this.target);}c('CSS').addClass(this.target,'photocrop');['bg','wrapper','viewport'].forEach(function(o){this[o]=c('DOM').create('div');c('CSS').addClass(this[o],o);}.bind(this));this.highlight=c('DOM').create('img');c('CSS').addClass(this.highlight,'highlight');this.setHighlightSource();c('CSS').addClass(this.wrapper,'photocropWrapper');this.target.appendChild(this.bg);this.target.appendChild(this.wrapper);this.wrapper.appendChild(this.highlight);this.wrapper.appendChild(this.viewport);['ne','nw','sw','se'].forEach(function(o){var p=c('DOM').create('div');c('CSS').addClass(p,o);p.setAttribute('data-cropcorner',o);this.viewport.appendChild(p);c('CSS').addClass(p,'profilePicViewportGrabby');}.bind(this));c('Event').listen(this.viewport,{mousedown:this.mousedown.bind(this),dragstart:c('Event').kill,selectstart:c('Event').kill,click:c('Event').stop});c('Event').listen(document,{mousemove:this.mousemove.bind(this),mouseup:this.mouseup.bind(this)});c('Event').listen(window,{resize:this.adjustForResize.bind(this)});this.realignToPictureSize();this.redraw();}j.prototype.setInitialDimensionsAndPos=function(){'use strict';this._constraint=c('PhotocropConstraint')(this,this.constraint_type);var k=c('PhotocropConstraintConstants').getAspectRatioForType(this.constraint_type),l=this.getPhotoDimensions();if(k){this._unscaledMinHeight=this._unscaledMinWidth/k;this._unscaledHeight=this._unscaledWidth/k;}this.setNewRatio();var m=Math.min(this.width,l.x),n=Math.min(this.height,l.y);this.min_width=Math.min(this.min_width,l.x);this.min_height=Math.min(this.min_height,l.y);if(k)if(l.x/l.y>k){n=Math.min(n,l.y);m=n*k;this.min_width=this.min_height*k;}else{m=Math.min(m,l.x);n=m/k;this.min_height=this.min_width/k;}var o=this.center_x-m/2,p=this.center_y-n/2;this.box=new (c('Rect'))(p,o+m,p+n,o);};j.prototype.getPhotoDimensions=function(){'use strict';return new (c('Vector'))(Math.round(parseFloat(c('Style').get(this.photo,'width'))),Math.round(parseFloat(c('Style').get(this.photo,'height'))));};j.prototype.getPhotoPosition=function(){'use strict';return new (c('Vector'))(this.photo.offsetLeft,this.photo.offsetTop);};j.prototype.setHighlightSource=function(){'use strict';this.highlight.src=this.photo.src;};j.prototype.setConstraintType=function(k){'use strict';this.constraint_type=k;this.setInitialDimensionsAndPos();this.adjustForResize();};j.prototype.adjustForResize=function(){'use strict';var k=this.ratio,l=this.setNewRatio(),m=l/k;this.box.t*=m;this.box.l*=m;this.box.b*=m;this.box.r*=m;this.redraw();this.realignToPictureSize();};j.prototype.setNewRatio=function(){'use strict';this.ratio=this.getPhotoDimensions().x/this.imageDimensions.x;this.min_width=this.ratio*this._unscaledMinWidth;this.min_height=this.ratio*this._unscaledMinHeight;this.width=Math.max(1,this.ratio)*this._unscaledWidth;this.height=Math.max(1,this.ratio)*this._unscaledHeight;return this.ratio;};j.prototype.realignToPictureSize=function(){'use strict';var k=this.photo;if(!k)return;var l=this.getPhotoDimensions(),m=this.getPhotoPosition();[this.bg,this.wrapper].forEach(function(n){n.style.width=l.x+'px';n.style.height=l.y+'px';n.style.top=m.y+'px';n.style.left=m.x+'px';});};j.prototype.redraw=function(){'use strict';var k=[this.box.t,this.box.r,this.box.b,this.box.l],l=this.getPhotoDimensions();this.highlight.style.width=l.x+"px";this.highlight.style.height=l.y+"px";this.highlight.style.clip="rect("+k.join("px ")+"px)";this.viewport.style.top=this.box.t+"px";this.viewport.style.left=this.box.l+"px";this.viewport.style.height=this.box.b-this.box.t+"px";this.viewport.style.width=this.box.r-this.box.l+"px";};j.prototype.done=function(k){'use strict';this.freezeViewport=true;if(!k){[this.bg,this.wrapper].forEach(c('DOM').remove);if(this.create_target){c('DOM').remove(this.target);this.target=null;}else c('CSS').removeClass(this.target,'photocrop');}var l=Math.round(this.box.l*(1/this.ratio)),m=Math.round(this.box.t*(1/this.ratio)),n=Math.round(this.box.r*(1/this.ratio)),o=Math.round(this.box.b*(1/this.ratio));this.inform('done',k);return {x:Math.max(l,0),y:Math.max(m,0),width:n-Math.max(l,0),height:o-Math.max(m,0)};};j.prototype.reset=function(){'use strict';this.freezeViewport=false;};j.prototype.mousedown=function(k){'use strict';if(this.freezeViewport)return;this.mouseTarget=k.getTarget();this._constraint.onMouseDown(c('Vector').getEventPosition(k));c('CSS').addClass(document.body,'draggingMode');return false;};j.prototype.mousemove=function(k){'use strict';if(!this.mouseTarget)return;this._constraint.onMouseMove(c('Vector').getEventPosition(k),this.mouseTarget!==this.viewport,this.mouseTarget.getAttribute('data-cropcorner'));this.redraw();return false;};j.prototype.mouseup=function(k){'use strict';this.mouseTarget=null;c('CSS').removeClass(document.body,'draggingMode');};f.exports=j;}),null);
__d('OzPhotoCropper.react',['cx','OzHelpers','BasicVector','Photocrop2','React'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;'use strict';for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return m=(n=j.constructor).call.apply(n,[this].concat(p)),this.state={imageSize:null},this.finalizeCrop=function(r){var s=this.refs.canvas,t=this.$OzPhotoCropper2.done(r),u=t.x,v=t.y,w=t.height,x=t.width;s.width=x;s.height=w;s.getContext('2d').drawImage(this.$OzPhotoCropper1,Math.max(0,u),Math.max(0,v),x,w,0,0,x,w);return c('OzHelpers').blobFromDataURI(s.toDataURL());}.bind(this),m;}l.prototype.componentDidMount=function(){'use strict';this.$OzPhotoCropper1=new Image();this.$OzPhotoCropper1.src=this.props.src;this.$OzPhotoCropper1.onload=function(m){var n=new (c('BasicVector'))(this.$OzPhotoCropper1.width,this.$OzPhotoCropper1.height);this.setState({imageSize:n});this.$OzPhotoCropper2=new (c('Photocrop2'))(this.refs.img,{},n);}.bind(this);};l.prototype.componentWillUnmount=function(){'use strict';this.$OzPhotoCropper1=null;};l.prototype.render=function(){'use strict';return c('React').createElement('div',{className:"_3x2x"},c('React').createElement('canvas',{ref:'canvas',style:{display:'none'}}),c('React').createElement('img',{src:this.props.src,ref:'img',className:"_3x2y"}));};l.propTypes={src:k.string.isRequired};f.exports=l;}),null);
__d('OzAttachmentCropper.react',['OzHelpers','DialogFitHeight','immutable','OzPhotoCropper.react','OzImmutablePureRenderMixin','React','XUIButton.react','XUIDialog.react','XUIDialogBody.react','XUIDialogFooter.react','XUIDialogTitle.react'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('immutable').Map,i=c('immutable').OrderedMap,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzAttachmentCropper',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{attachment:j.instanceOf(h).isRequired,onSave:j.func.isRequired,onClose:j.func.isRequired},_handleSubmit:function l(){var m=this.props,n=m.attachment,o=m.onSave,p=this.refs.photoCropper.finalizeCrop();o(n.set('ui-blob',p));},render:function l(){return (c('React').createElement(c('XUIDialog.react'),{behaviors:{DialogFitHeight:c('DialogFitHeight')},onToggle:this.props.onClose,shown:true,width:900},c('React').createElement(c('XUIDialogTitle.react'),null,c('React').createElement('span',null,'Crop tool')),c('React').createElement(c('XUIDialogBody.react'),null,c('React').createElement(c('OzPhotoCropper.react'),{src:c('OzHelpers').blobURI(this.props.attachment.get('ui-blob')),ref:'photoCropper'})),c('React').createElement(c('XUIDialogFooter.react'),null,c('React').createElement(c('XUIButton.react'),{onClick:this._handleSubmit,label:'Crop'}))));}});f.exports=k;}),null);
__d('OzAttachmentOverlay.react',['cx','joinClasses','OzLoading.react','OzImmutablePureRenderMixin','React','XUICloseButton.react','XUIEditButton.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzAttachmentOverlay',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onClick:i.func,onEdit:i.func,onRemove:i.func,loading:i.bool},render:function k(){var l=this.props,m=l.onClick,n=l.onEdit,o=l.onRemove,p=l.loading;return (c('React').createElement('div',{className:c('joinClasses')(this.props.className,"_18wc")},p?c('React').createElement(c('OzLoading.react'),null):null,c('React').createElement('div',{className:"_4xe8",onClick:m},n?c('React').createElement(c('XUIEditButton.react'),{className:"_1yll",type:'button',size:'medium',title:'Add Image',onClick:this._handleEdit}):null,o?c('React').createElement(c('XUICloseButton.react'),{type:'button',className:"_1ylm",size:'medium',shade:'dark',onClick:this._handleRemove}):null),this.props.children));},_handleEdit:function k(l){l.stopPropagation();this.props.onEdit&&this.props.onEdit();},_handleRemove:function k(l){l.stopPropagation();this.props.onRemove&&this.props.onRemove();}});f.exports=j;}),null);
__d('OzBubbleImageSelector.react',['cx','Image.react','immutable','OzAttachmentOverlay.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').List,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzBubbleImageSelector',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onImageAdd:j.func.isRequired,onImageSelect:j.func.isRequired,selectedURI:j.string,thumbURIs:j.instanceOf(i).isRequired},render:function m(){var n=this.props,o=n.onImageSelect,p=n.selectedURI,q=n.thumbURIs;return (c('React').createElement('div',{className:"_1-i2"},q.map(function(r,s){return (c('React').createElement(l,{index:s,isSelected:r===p,key:s,onSelect:o,uri:r}));}),this._renderAddButton()));},_renderAddButton:function m(){return (c('React').createElement('button',{type:'button',className:"_1-hv _1-i4",onClick:this.props.onImageAdd},'+'));}}),l=c('React').createClass({displayName:'Thumbnail',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{index:j.number.isRequired,isSelected:j.bool.isRequired,uri:j.string.isRequired},render:function m(){return (c('React').createElement(c('OzAttachmentOverlay.react'),{className:this.props.isSelected?"_4-8e":'',onClick:this._handleSelect},c('React').createElement(c('Image.react'),{src:this.props.uri,className:"_1-i3",alt:'image thumb'})));},_handleSelect:function m(){this.props.onSelect(this.props.uri);}});f.exports=k;}),null);
__d('OzFormPreview.react',['cx','OzHelpers','joinClasses','React','Tooltip'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('OzHelpers').pure(function(k){var l=k.children;return (c('React').createElement('div',{className:"_5bwr"},l));}),j=c('OzHelpers').pure(function(k){var l=k.label,m=k.tip,n=k.children,o=k.className;if(!n)return null;return (c('React').createElement('div',{className:c('joinClasses')("_5bws _5bwt",o)},c('React').createElement('div',{className:"_5bwv"},l),c('React').createElement('div',babelHelpers['extends']({className:"_5bx2"},c('Tooltip').propsFor(m)),n)));});i.Row=j;f.exports=i;}),null);
__d('OzBubblePreview.react',['cx','OzAPI','OzHelpers','formatDate','AdsCurrencyFormatter','immutable','MessengerButton.react','OzConfig','OzFormPreview.react','OzStores','OzActions','OzConstants','OzImmutablePureRenderMixin','React','Reflux','TextWithHighlights.atlas','XUIContextualDialog.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('OzConstants').ATTS,j=c('immutable').Map,k=c('immutable').List,l=c('React').PropTypes,m=c('OzFormPreview.react').Row,n=c('OzStores').AutopilotStore,o=c('React').createClass({displayName:'OzBubblePreview',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{bubble:l.instanceOf(j).isRequired,highlight:l.string,meta:l.instanceOf(j),source:l.string},render:function va(){return ka(this.props)?c('React').createElement(t,this.props):c('React').createElement(p,this.props);}}),p=c('OzHelpers').pure(function(va){var wa=va.bubble,xa=va.highlight,ya=null;if(Number.isSafeInteger(wa.get('amount')))ya=c('AdsCurrencyFormatter').formatCurrencyFullFormat(wa.get('currency'),wa.get('amount'));return (c('React').createElement(fa,{thumbURL:wa.get('thumb-url')},c('React').createElement(ha,{text:wa.get('name'),highlight:xa}),c('React').createElement(ia,null,c('React').createElement(ja,{color:'grey',highlight:xa},wa.get('description')||'No Description')),c('React').createElement(ia,null,c('React').createElement(ja,null,wa.get('merchant-name')||'No Merchant')),c('React').createElement(ia,null,c('React').createElement(ja,{color:'blue',weight:'bold'},ya))));}),q='__overviewTab',r='__hoursTab',s='__moreInfoTab',t=c('React').createClass({displayName:'PlacesPreview',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(n,'autopilot'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{bubble:l.instanceOf(j).isRequired,meta:l.instanceOf(j).isRequired,highlight:l.string},getInitialState:function va(){return {shown:false,activeTab:q};},_makeOpentableRequest:function va(wa,xa){if(!this.state.config.getIn(['GK','openTableAPI'])){var ya=ra(wa);if(ya){var za=v(wa,xa);if(!za)c('OzAPI').requestAutopilot(ya.toJS());}}},componentWillMount:function va(){this._makeOpentableRequest(this.props.meta,this.state.autopilot);window.clearTimeout(this.timeout);},componentWillReceiveProps:function va(wa){var xa=wa.meta;if(sa(xa)!==sa(this.props.meta))this._makeOpentableRequest(xa,this.state.autopilot);},_handleToggle:function va(wa){window.clearTimeout(this.timeout);var xa=function(ya){return this.setState({shown:wa,activeTab:q});}.bind(this);wa?xa():this.timeout=window.setTimeout(xa,100);},render:function va(){var wa=this.props,xa=wa.bubble,ya=wa.meta,za=wa.highlight,ab=this.state,bb=ab.shown,cb=ab.activeTab,db=ab.autopilot,eb=ab.config;return (c('React').createElement('div',{ref:'root',tabIndex:'0',onMouseEnter:function(fb){return this._handleToggle(true);}.bind(this),onMouseLeave:function(fb){return this._handleToggle(false);}.bind(this)},c('React').createElement(fa,{thumbURL:xa.get('thumb-url')},c('React').createElement(ha,{text:xa.get('name'),highlight:za}),c('React').createElement(u,{rating:ya.get('rating')}),c('React').createElement(ia,null,c('React').createElement(ja,null,ya.get('cuisine')),' ',c('React').createElement(ja,null,ya.get('price'))),c('React').createElement(ia,null,c('React').createElement(w,{meta:ya,autopilot:db}))),c('React').createElement(x,babelHelpers['extends']({activeTab:cb,contextRef:function(fb){return this.refs.root;}.bind(this),onTabChange:this._handleTabChange,shown:bb,onToggle:this._handleToggle,autopilot:db,config:eb},this.props))));},_handleTabChange:function va(wa){this.setState({activeTab:wa});}}),u=c('OzHelpers').pure(function(va){var wa=va.rating;return wa?c('React').createElement(ia,null,c('React').createElement(ja,{weight:'500'},wa.get('value'),'/',wa.get('scale')),' ',c('React').createElement(ja,{color:'grey'},wa.get('rating-count')?'('+wa.get('rating-count')+' reviews)':null)):null;}),v=function va(wa,xa){var ya=ra(wa);if(ya)if(c('OzConfig').getInStaticConfig(['GK','openTableAPI'])){return ya.getIn(['data','times']);}else return xa.get(ya.getIn(['data','id']));return null;},w=c('OzHelpers').pure(function(va){var wa=va.meta,xa=va.autopilot,ya=ra(wa);if(!ya)return (c('React').createElement(ja,null,'No OT info'));var za=v(wa,xa);if(!za)return (c('React').createElement(ja,null,'Checking OT...'));if(za.size===0)return (c('React').createElement(ja,{color:'red'},'No Tables Available!'));return (c('React').createElement(ja,null,'Table at ',pa(wa,za)));}),x=c('OzHelpers').pure(function(va){var wa=va.activeTab,xa=va.contextRef,ya=va.meta,za=va.onTabChange,ab=va.onToggle,bb=va.shown,cb=babelHelpers.objectWithoutProperties(va,['activeTab','contextRef','meta','onTabChange','onToggle','shown']);return (c('React').createElement(c('XUIContextualDialog.react'),{contextRef:xa,hoverHideDelay:0,position:'above',shown:bb,hasActionableContext:true},c('React').createElement('div',{className:"_53qb",onMouseEnter:function db(eb){return ab(true);},onMouseLeave:function db(eb){return ab(false);}},c('React').createElement('div',{className:"_c38"},c('React').createElement(y,babelHelpers['extends']({meta:ya},cb)),c('React').createElement(ea,{tabs:[['Overview',q],['Hours',r],['More Info',s]],active:wa,onChange:za})),c('React').createElement(z,babelHelpers['extends']({activeTab:wa,meta:ya},cb)))));}),y=c('OzHelpers').pure(function(va){var wa=va.bubble,xa=va.meta,ya=va.highlight;return (c('React').createElement('div',{className:"_53qc"},c('React').createElement(ga,{url:wa.get('thumb-url')}),c('React').createElement('div',{className:"_53qd"},c('React').createElement(ha,{text:wa.get('name'),highlight:ya}),c('React').createElement(u,{rating:xa.get('rating')}),c('React').createElement(ia,null,c('React').createElement(ja,null,xa.get('cuisine'))),c('React').createElement(ia,null,c('React').createElement(ja,null,xa.get('price'))))));}),z=c('OzHelpers').pure(function(va){var wa=va.activeTab,xa=babelHelpers.objectWithoutProperties(va,['activeTab']);return (c('React').createElement('div',{className:"_53qe"},wa===q&&c('React').createElement(aa,xa)||wa===r&&c('React').createElement(ca,xa)||wa===s&&c('React').createElement(da,xa)||null));}),aa=c('OzHelpers').pure(function(va){var wa=va.bubble,xa=va.highlight,ya=va.meta,za=va.autopilot,ab=va.config,bb=(ya.getIn(['address','street'],'')+'\n     '+ya.getIn(['address','city'],'')+'\n    ').trim();return (c('React').createElement(c('OzFormPreview.react'),null,c('React').createElement(m,{label:'Address'},bb),c('React').createElement(m,{label:'Phone'},ba(wa,ya)),c('React').createElement(m,{label:'Website'},c('React').createElement('a',{href:wa.get('target-url'),target:'_blank',rel:'noopener noreferrer'},'Link')),c('React').createElement(m,{label:'OpenTable'},ma(wa,ya,za)),ab.getIn(['GK','yelpLink'])?c('React').createElement(m,{label:'Yelp'},c('React').createElement('a',{href:ya.get('yelp-url'),target:'_blank',rel:'noopener noreferrer'},'Link')):null,c('React').createElement(m,{label:'Description'},wa.get('description'))));}),ba=function va(wa,xa){var ya=xa.get('phone');return ya?c('React').createElement(ja,{weight:'bold'},c('OzHelpers').parsePhoneNumber(ya)):null;},ca=c('OzHelpers').pure(function(va){var wa=va.meta;return (c('React').createElement(c('OzFormPreview.react'),null,oa(wa.get('hours')||k()).map(function(xa,ya){return c('React').createElement(m,{key:ya,label:ya},xa);}).valueSeq()));}),da=c('OzHelpers').pure(function(va){var wa,xa=va.bubble,ya=va.meta,za=ya.get('payment'),ab=ya.get('infos');if(za&&za.size||ab&&ab.size){var wa=function(){var bb=function cb(db){return db[0].toUpperCase()+db.slice(1).toLowerCase();};return {v:c('React').createElement(c('OzFormPreview.react'),null,ab.map(function(cb,db){return (c('React').createElement(m,{label:bb(db),key:db},cb));}).toList(),za?c('React').createElement(m,{label:'Payments'},za.map(bb).toJS().join(', ')):null)};}();if(typeof wa==="object")return wa.v;}else return c('React').createElement('div',null,'No additional info for this place...');}),ea=c('OzHelpers').pure(function(va){var wa=va.tabs,xa=va.onChange,ya=va.active;return (c('React').createElement('div',{className:"_c39"},wa.map(function(za){var ab=za[0],bb=za[1],cb=bb===ya?{weight:'bold',color:'blue'}:{color:'grey'};return (c('React').createElement('button',{key:bb,role:'button',className:"_1-hv",onClick:function db(eb){return xa(bb);}},c('React').createElement(ja,cb,ab)));})));}),fa=c('OzHelpers').pure(function(va){var wa=va.children,xa=va.thumbURL;return (c('React').createElement('div',{className:"_1q15 _5rxk"},c('React').createElement(ga,{url:xa}),c('React').createElement('div',{className:"_1q17"},wa)));}),ga=c('OzHelpers').pure(function(va){var wa=va.url;return wa?c('React').createElement('div',{className:"_1q16",style:{backgroundImage:'url(\''+wa+'\')'}}):null;}),ha=c('OzHelpers').pure(function(va){var wa=va.text,xa=va.highlight;return (c('React').createElement(ia,null,c('React').createElement(ja,{weight:'bold',highlight:xa},wa||'No Title')));}),ia=c('OzHelpers').pure(function(va){var wa=va.children;return (c('React').createElement('div',{className:"_4-_7 _5rxl"},wa));}),ja=c('OzHelpers').pure(function(va){var wa=va.children,xa=va.color,ya=va.highlight,za=va.size,ab=va.weight,bb=ab===undefined?'normal':ab;return wa?c('React').createElement('span',{className:"_5rxm"+(za==='large'?' '+"_5rxn":'')+(xa==='blue'?' '+"_5ryf":'')+(xa==='grey'?' '+"_5ryk":'')+(xa==='red'?' '+"_5emd":'')+(xa==='green'?' '+"_5emf":''),style:{fontWeight:bb}},ya?c('React').createElement(c('TextWithHighlights.atlas'),{text:wa,highlight:ya}):wa):null;});function ka(va){var wa=va.meta,xa=va.source;return xa==='places'&&wa;}function la(va,wa,xa){c('OzActions').selectAIPick(j({type:i.OPENTABLEQR,bubble:va,meta:wa,'ui-body':xa.count()>1?'Here are available times for today: '+ua(xa):'The only available time for today is '+ua(xa),quickreplies:ta(xa)}));}function ma(va,wa,xa){var ya,za=wa.get('open-table');if(za){var ab,ya=function(){var bb=v(wa,xa);if(bb)if(bb.size===0){ab=c('React').createElement(ja,{color:'red'},'No tables available!');}else ab=c('React').createElement(ja,null,'Tables available at '+ua(bb));return {v:c('React').createElement('div',null,c('React').createElement('a',{href:za.get('url'),target:'_blank',rel:'noopener noreferrer'},'Link (',za.get('area'),')'),c('React').createElement('br',null),ab,bb&&bb.size?c('React').createElement('span',null,c('React').createElement('br',null),c('React').createElement('a',{onClick:function cb(){return la(va,wa,bb);}},'Suggest via quickreplies')):null)};}();if(typeof ya==="object")return ya.v;}return null;}var na=k(['Sun','Mon','Tues','Wed','Thurs','Fri','Sat']);function oa(va){var wa=function bb(){var cb=new Date(c('OzHelpers').serverNow());cb.setHours(0,0,0,0);cb.setDate(cb.getDate()-cb.getDay()+1);return +cb;},xa=wa(),ya=function bb(cb){return new Date(xa+cb*60*1000);},za=function bb(cb){return c('formatDate')(cb,'h:i A',{skipPatternLocalization:true});},ab=function bb(cb){return cb.map(za).join(' - ');};return va.map(function(bb){return bb.map(ya);}).groupBy(function(bb){return bb.get('start').getDay();}).mapKeys(function(bb){return na.get(bb);}).map(function(bb){return bb.map(ab).join(', ');});}function pa(va,wa){var xa=function za(ab){var bb=ab.split(':'),cb=bb[0],db=bb[1];return parseInt(db,10)+parseInt(cb,10)*60;},ya=xa(va.getIn(['open-table','availability','data','hour']));return qa(wa.map(function(za){return za.get('hour');}).minBy(function(za){return Math.abs(ya-xa(za));}));}function qa(va){var wa=va.split(':'),xa=wa[0],ya=wa[1];xa=parseInt(xa,10);if(xa===0){return '12:'+ya+'AM';}else if(xa<12){return va+'AM';}else if(xa===12){return va+'PM';}else return xa-12+':'+ya+'PM';}function ra(va){return va.getIn(['open-table','availability']);}function sa(va){return va.getIn(['open-table','availability','data','id']);}function ta(va){var wa=va.count()>1?'None of these times work for me':'This time doesn\'t work for me';return va.map(function(xa){return qa(xa.get('hour'));}).push(wa);}function ua(va){return va.map(function(wa){return qa(wa.get('hour'));}).toJS().join(', ');}f.exports=o;}),null);
__d('OzMerchantDialog.react',['cx','OzHelpers','immutable','Layout.react','MessengerDialog.react','MessengerDialogHeader.react','MessengerDialogTitle.react','OzActions','React','ReactDOM','XUIDatePicker.react','XUIError.react'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('Layout.react').Column,l=c('Layout.react').FillColumn,m=c('React').PropTypes,n=c('immutable').Map,o=c('immutable').Set,p=o(['name-dba','name-legal','website','phone','address','page-id','country','type','owner-name']),q=n({country:'US'});i=babelHelpers.inherits(r,c('React').Component);j=i&&i.prototype;function r(t){'use strict';j.constructor.call(this,t);s.call(this);var u=t.initialMerchant,v=q.filterNot(function(w,x){return u.get(x);});this.state={inputs:v,errors:n()};}r.prototype.componentDidMount=function(){'use strict';var t=c('ReactDOM').findDOMNode(this.refs['name-dba']);t&&t.focus();};r.prototype.render=function(){'use strict';return (c('React').createElement(c('MessengerDialog.react'),{className:"_18w8",onToggle:this.$OzMerchantDialog1,ref:'dialog',type:'default',width:544},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogTitle.react'),null,this.props.title)),this.$OzMerchantDialog2(),c('React').createElement('div',null,this.$OzMerchantDialog3('Save',this.$OzMerchantDialog4),this.$OzMerchantDialog3('Cancel',c('OzActions').hideDialog))));};r.propTypes={onMerchant:m.func.isRequired,title:m.string,initialMerchant:m.instanceOf(n)};r.defaultProps={title:"Create a merchant",initialMerchant:n()};var s=function t(){this.$OzMerchantDialog3=function(u,v){return c('React').createElement('button',{onClick:v,className:"_bx0 _3e2t _30yy"},u);};this.$OzMerchantDialog2=function(){return (c('React').createElement('div',{className:"_374d _18w9"},this.$OzMerchantDialog5('name-dba','Name *'),this.$OzMerchantDialog5('name-legal','Legal Name'),this.$OzMerchantDialog5('website','Website'),this.$OzMerchantDialog5('phone','Phone'),this.$OzMerchantDialog5('address','Address'),this.$OzMerchantDialog5('page-id','Facebook Page Id'),this.$OzMerchantDialog5('country','Country *'),this.$OzMerchantDialog5('type','Business Type'),this.$OzMerchantDialog5('owner-name','Owner Name'),this.$OzMerchantDialog6('owner-birth-date','Owner Birth Date')));}.bind(this);this.$OzMerchantDialog5=function(u,v){var w=this.props.initialMerchant,x=this.state,y=x.inputs,z=x.errors;return (c('React').createElement(c('Layout.react'),{key:u},c('React').createElement(k,{className:"mrm _bx1"},v),c('React').createElement(l,null,c('React').createElement(c('XUIError.react'),{xuiError:z.get(u)||null},c('React').createElement('input',{ref:u,type:'text',className:"_7q5 _bx2",defaultValue:w.get(u),value:y.get(u),onChange:function(aa){this.setState({inputs:y.set(u,aa.target.value),errors:n()});}.bind(this)})))));}.bind(this);this.$OzMerchantDialog6=function(u,v){var w={},x=this.props.initialMerchant,y=x.get('owner-birth-date');if(y)w.initialTime=y;return (c('React').createElement(c('Layout.react'),{key:u},c('React').createElement(k,{className:"mrm _bx1"},v),c('React').createElement(k,null,c('React').createElement(c('XUIDatePicker.react'),babelHelpers['extends']({ref:u,shouldSetDefaultDate:false},w)))));}.bind(this);this.$OzMerchantDialog4=function(){var u=this.$OzMerchantDialog7();if(u){u.id=this.props.initialMerchant.get('id');this.props.onMerchant(u);}}.bind(this);this.$OzMerchantDialog1=function(u){if(!u)c('OzActions').hideDialog();};this.$OzMerchantDialog7=function(){var u=n(),v=this.props.initialMerchant,w=function(z){var aa=this.state.inputs.get(z,undefined);if(aa===undefined)return v.get(z);return aa||null;}.bind(this);u=n(p.map(function(z){return [z,w(z)];})).set('id',v.get('id'));var x=this.refs['owner-birth-date'].state.selectTime;u=u.set('owner-birth-date',x);u=c('OzHelpers').normalizeMerchant(u);var y=c('OzHelpers').validateMerchant(u);this.setState({errors:y});if(!y.isEmpty())return null;return u;}.bind(this);};f.exports=r;}),null);
__d('OzSetPicURLDialog.react',['cx','getURLRanges','OzHelpers','Image.react','Keys','MessengerDialog.react','MessengerDialogHeader.react','MessengerDialogTitle.react','OzImmutablePureRenderMixin','React','ReactDOM'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzSetPicURLDialog',mixins:[c('OzImmutablePureRenderMixin')],PropTypes:{onURL:i.func.isRequired,onEscape:i.func},componentDidMount:function k(){var l=c('ReactDOM').findDOMNode(this.refs.url);l&&l.focus();},getInitialState:function k(){return {errors:[],url:''};},render:function k(){return (c('React').createElement(c('MessengerDialog.react'),{className:"_18w8",onToggle:this._handleToggle,ref:'dialog',type:'default',width:544},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogTitle.react'),null,'Enter a URL for your picture')),this._renderImage(),this._renderErrors(),c('React').createElement('div',{className:"_374d _18w9"},c('React').createElement('input',{onChange:this._handleChange,onKeyDown:this._handleKeyDown,ref:'url',type:'text',className:"_7q5",placeholder:'URL to picture'})),c('React').createElement('div',{className:"_18wa"},'Press Enter when you\'re done.')));},_renderImage:function k(){var l=this.state.url,m=this.state.errors||[];if(m.length>0||!l||l.length===0)return null;return (c('React').createElement(c('Image.react'),{className:"_24p-",src:l}));},_renderErrors:function k(){var l=this.state.errors;if(!l||l.length===0)return null;return (c('React').createElement('div',{key:'errors',className:"_1yln"},l.map(function(m){var n=m[0],o=m[1];return (c('React').createElement('div',{key:n,className:"_1ylp"},o));})));},_handleChange:function k(l){if(l.target.value.length&&!c('getURLRanges')(l.target.value).length){this.setState({errors:[['invalid_url','You must provide a valid uri']]});return;}var m=l.target.value.length?c('getURLRanges')(l.target.value)[0].entity.url:'';this.setState({errors:[],url:m});},_handleKeyDown:function k(l){if(l.keyCode===c('Keys').ESC){var m=this.props.onEscape;if(m)m(l);return;}var n=this.state.errors||[];if(n.length===0&&l.keyCode===c('Keys').RETURN){l.preventDefault();var o=l.target.value.length?c('getURLRanges')(l.target.value)[0].entity.url:'';this.props.onURL(o);}return;},_handleToggle:function k(){c('OzHelpers').debug('[OzSetPicURLDialog] toggled',arguments);}});f.exports=j;}),null);
__d('OzBubbleEditor.react',['cx','Promise','OzAPI','getURLRanges','OzHelpers','OzNotify','AdsCurrencyInput.react','immutable','Keys','OzActions','OzBubbleImageSelector.react','OzBubblePreview.react','OzConfig','OzMerchantDialog.react','OzSearchSource','OzSetPicURLDialog.react','OzImmutablePureRenderMixin','React','Reflux','SearchableDropdownInput.contrib','SearchableEntry','XUICloseButton.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').List,j=c('immutable').Map,k=c('React').PropTypes,l=['thumb-url'],m=['thumb-urls'],n=q('No Merchant'),o=69,p=c('React').createClass({displayName:'OzBubbleEditor',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{merchants:k.instanceOf(j).isRequired,seedBubble:k.instanceOf(j).isRequired,onSave:k.func.isRequired,onClose:k.func.isRequired},getInitialState:function u(){return {newData:j()};},componentWillMount:function u(){this._searchSource=new (c('OzSearchSource'))(function(v){var w=v.query||'',x=this.props.merchants.valueSeq().filter(function(y){return y.get('name-dba').toLowerCase().indexOf(w.toLowerCase())>-1;}).map(function(y){return q(y.get('name-dba'));}).take(15).toArray();return c('Promise').resolve(this._data().get('merchant-name')?[n].concat(x):x);}.bind(this));},componentDidMount:function u(){this.focus('Title');},focus:function u(v){this.refs[v]&&this.refs[v].focus&&this.refs[v].focus();},render:function u(){return (c('React').createElement('div',{className:"_1-ht"},c('React').createElement('div',{className:"_2zfj"},this._renderSection('Preview',this._renderPreview)),c('React').createElement('form',{className:"_2zfk",onKeyDown:function(v){v.keyCode===c('Keys').ESC&&this.props.onClose(this._bubble());}.bind(this),onSubmit:function(v){v.stopPropagation();v.preventDefault();this._handleSubmit();}.bind(this)},c('React').createElement(c('XUICloseButton.react'),{className:"_1-hu",shade:'dark',size:'medium',onClick:function(v){return this.props.onClose(this._bubble());}.bind(this)}),this._renderSection('Image',this._renderImage),this._renderSection('Title',this._renderInput.bind(this,['name'])),this._renderSection('Description',this._renderDescription),this._renderSection('URL',this._renderInput.bind(this,['target-url'])),this._renderSection('Merchant',this._renderMerchant),this._renderSection('Price',this._renderPrice),this._renderSubmit())));},_bubble:function u(){return this.props.seedBubble.set('data',this._data()).deleteIn(['data','thumb-urls']);},_data:function u(){var v=this.state.newData.updateIn(m,function(w){var x=this.props.seedBubble.getIn(['data'].concat(m));return (x||i()).concat(w);}.bind(this));return this.props.seedBubble.get('data').merge(v);},_handleSubmit:function u(){var v=this._bubble(),w=v.get('data'),x=[[w.get('name'),'Please enter a title.'],[w.get('expires-in')||!w.get('expiration-time'),'Since this bubble is old, please re-enter the expiration time.'],[c('OzHelpers').validateURL(w.get('target-url')),'Please enter a valid url. Usually, you need to add "www."'],[c('OzHelpers').validateURL(w.get('thumb-url'))||!w.get('thumb-url'),'Please enter a valid url for your image.'],[w.get('merchant-name')||!w.get('amount'),'You need to specify a merchant if you\'ve listed a price.'],[w.get('amount')||!w.get('expires-in'),'You need to list a price if you\'ve set an expiration time.']].filter(function(y){var z=y[0],aa=y[1];return !z;}).map(function(y){var z=y[0],aa=y[1];return aa;});if(x.length){c('OzNotify').error(x[0]);return;}this.props.onSave(v.updateIn(['data','target-url'],function(y){return (c('getURLRanges')(y)[0].entity.url);}));},_handleCreateMerchant:function u(){c('OzActions').showDialog(c('OzMerchantDialog.react'),{onMerchant:function(v){c('OzAPI').createMerchant(v);var w=this.state.newData.set('merchant-name',v.get('name-dba'));this.setState({newData:w});c('OzActions').hideDialog();}.bind(this)});},_handleAddImage:function u(){c('OzActions').showDialog(c('OzSetPicURLDialog.react'),{onEscape:function(v){c('OzActions').hideDialog();this.focus('Title');}.bind(this),onURL:function(v){c('OzActions').hideDialog();this.setState(function(w){return {newData:t(w.newData,v)};});this.focus('Title');}.bind(this)});},_handleSelectImage:function u(v){this.setState(function(w){return {newData:w.newData.setIn(l,v)};});},_renderSubmit:function u(){return (c('React').createElement('button',{type:'submit',className:"_1-hv _1-hw"},'DONE'));},_renderSection:function u(v,w){return (c('React').createElement('div',{className:"_1-hx"},c('React').createElement('div',{className:"_1-hz",onClick:function(x){return this.focus(v);}.bind(this)},v),c('React').createElement('div',{className:"_1-h-"},w(v))));},_renderPrice:function u(v){var w=this._data(),x=w.get('currency'),y=w.get('amount');return (c('React').createElement('div',{className:"_1-h_"},c('React').createElement(c('AdsCurrencyInput.react'),{placeholder:'(optional)',currency:x||'USD',value:Number.isSafeInteger(y)?y:null,onDataUpdate:function(z){this.setState({newData:w.set('amount',z)});}.bind(this),eventType:'change'}),this._renderExpiration()));},_renderExpiration:function u(){if(!this.state.config.getIn(['GK','expirationDate']))return null;return (c('React').createElement('div',{className:"_51w3"},c('React').createElement('div',{className:"_1-hz"},'Expiration Time:'),c('React').createElement(s,{expiresIn:this._data().get('expires-in'),onChange:function(v){return this.setState({newData:this.state.newData.set('expires-in',v)});}.bind(this)})));},_renderInput:function u(v,w){var x=this.state.newData;return (c('React').createElement('input',{ref:w,type:'text',className:"_1-i0 _1-i1",value:this._data().getIn(v),onChange:function(y){return this.setState({newData:x.setIn(v,y.target.value)});}.bind(this)}));},_renderImage:function u(){var v=this._data(),w=v.getIn(l),x=r(v,w);return (c('React').createElement(c('OzBubbleImageSelector.react'),{onImageAdd:this._handleAddImage,onImageSelect:this._handleSelectImage,selectedURI:w,thumbURIs:x}));},_renderMerchant:function u(){var v=this._data(),w=v.get('merchant-name'),x=w?q(w):null;return (c('React').createElement('div',{className:"_1-i5"},c('React').createElement('div',{className:"_1-i6"},c('React').createElement(c('SearchableDropdownInput.contrib'),{divClassName:"_1-i7",value:x,onSelect:function(y){var z=y.getUniqueID()===n.getUniqueID()?null:y.getTitle(),aa=this.state.newData.set('merchant-name',z);this.setState({newData:aa});}.bind(this),emptySearchResultsText:'No merchants found. Click + to add',placeholder:'Pick a Merchant (optional)',searchSource:this._searchSource})),c('React').createElement('div',{onClick:this._handleCreateMerchant,className:"_1-hv _4nd4 _1-i8"})));},_renderPreview:function u(){return (c('React').createElement(c('OzBubblePreview.react'),{bubble:this._data()}));},_renderDescription:function u(){var v=this._data(),w=v.get('description'),x=w&&w.length>o;return (c('React').createElement('div',null,c('React').createElement('input',{ref:'description',type:'text',className:"_1-i0 _1-i1",value:w,onChange:function(y){return this.setState({newData:v.set('description',y.target.value)});}.bind(this)}),c('React').createElement('text',{className:x?"_353q":''},o-(w?w.length:0)+' characters left')));}});function q(u){return new (c('SearchableEntry'))({title:u,uniqueID:u});}function r(u,v){return u.getIn(m,i()).toOrderedSet().add(v).toList().filter(function(w){return w;});}var s=c('OzHelpers').pure(function(u){var v=u.expiresIn,w=u.onChange,x="_1-i0 _3owv",y=v||j({hours:0,minutes:0}),z=function ca(da){return Math.max(+da,0);},aa=function ca(da){return w(y.merge(j(da)));},ba=function ca(da,ea){return (y.get(ea)===1?da:da+'s');};return (c('React').createElement('div',{className:"_51wb"},c('React').createElement('label',{className:"_1-hz"},c('React').createElement('input',{className:x,onChange:function ca(da){return aa({hours:z(da.target.value)});},type:'number',value:v?v.get('hours'):null}),ba('hour','hours')),c('React').createElement('label',{className:"_1-hz"},c('React').createElement('input',{className:x,onChange:function ca(da){return aa({minutes:z(da.target.value)});},type:'number',value:v?v.get('minutes'):null}),ba('minute','minutes'))));});function t(u,v){return u.withMutations(function(w){w.updateIn(m,i(),function(x){return x.push(v);});w.setIn(l,v);});}f.exports=p;}),null);
__d('OzComposerAI.react',['cx','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','OzHelpers','joinClasses','immutable','Image.react','LayerHideOnBlur','MessengerSpinner.react','OzBubblePreview.react','OzConfig','OzConstants','OzImmutablePureRenderMixin','React','Reflux','TextWithHighlights.atlas','MessengerButton.react','formatDate','XUIContextualDialog.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('immutable').List,k=c('OzConstants').ATTS,l=c('React').PropTypes,m=c('React').createClass({displayName:'OzComposerAIList',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{filter:l.string,items:l.instanceOf(j).isRequired,onItemClick:l.func.isRequired},getInitialState:function ba(){return {};},render:function ba(){var ca=this.props,da=ca.items,ea=ca.filter,fa=ca.onItemClick,ga={filter:ea,onItemClick:fa};return !da.isEmpty()&&c('React').createElement('div',{className:"_4285"},da.map(function(ha,ia){return (j.isList(ha)?c('React').createElement('div',{key:ia,className:"_2961"},ha.map(function(ja,ka){return (c('React').createElement(s,babelHelpers['extends']({key:ka,column:ka,line:ia,item:ja},ga)));})):c('React').createElement(n,babelHelpers['extends']({key:ia,line:ia,item:ha,onToggleDebug:function(ja){return this.setState({debugLine:this.state.debugLine===ia?null:ia});}.bind(this),debugShown:this.state.debugLine===ia},ga)));}.bind(this)).reverse());}}),n=c('React').createClass({displayName:'ItemRow',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{onToggleDebug:l.func.isRequired,debugShown:l.bool.isRequired},componentDidMount:function ba(){if(this.props.item.get('id')&&this.props.item.get('at'))this._timeout=window.setTimeout(function(ca){return this._timeout!==null&&this.forceUpdate();}.bind(this),aa(this.props.item));},componentWillUnmount:function ba(){window.clearTimeout(this._timeout);this._timeout=null;},render:function ba(){var ca=this.props,da=ca.item,ea=ca.line,fa=ca.onItemClick,ga=ca.filter,ha=i({line:ea,column:0}),ia=da.get('id'),ja=da.get('at'),ka=this.state.config.get('debugAI');return (c('React').createElement('div',{className:"_2962",onClick:function la(ma){ma.preventDefault();fa(ha);}},z(da)?c('React').createElement(r,{label:'AUTO-SENDING',at:ja}):null,c('React').createElement('div',{className:"_58jk",ref:'root'},c('React').createElement('div',{className:"_2964"},c('React').createElement(u,{item:da,filter:ga})),c('React').createElement('span',{className:"_58jl"},y(da)?c('React').createElement(c('MessengerButton.react'),{type:'secondary',label:'EXECUTING NOW...'}):z(da)?c('React').createElement(c('MessengerButton.react'),{type:'secondary',label:'STOP'}):ia&&ja?c('formatDate')(ja/1000,'g:ia M j'):'⌘'+da.get('shortcut',ea+1),ka&&c('React').createElement(q,babelHelpers['extends']({contextRef:function(la){return this.refs.root;}.bind(this)},this.props))))));}});function o(ba,ca,da,ea,fa){var ga='<span style="color: brown">',ha='<span style="color: navy">',ia='<span style="color: navy">',ja=ca||'';if(da)ja=ja+ga+da.replace(/[": ]/g,'')+'</span>: ';if(ea)ja=ja+(ea[0]=='"'?ia:ha)+ea+'</span>';return ja+(fa||'');}function p(ba){var ca=/^( *)("[\w]+": )?("[^"]*"|[\w.+-]*)?([,[{])?$/mg,da={__html:JSON.stringify(ba,null,3).replace(/&/g,'&amp;').replace(/\\"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(ca,o)};return c('React').createElement('div',{dangerouslySetInnerHTML:da});}var q=c('React').createClass({displayName:'DebugInfo',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onToggleDebug:l.func.isRequired,debugShown:l.bool.isRequired},_handleToggleDebugInfo:function ba(event){this.props.onToggleDebug();event.stopPropagation();},render:function ba(){var ca=this.props,da=ca.contextRef,ea=ca.item,fa=ca.debugShown,ga=ea.get('source'),ha=ea.get('debug');return (c('React').createElement('span',null,ga?' '+ga:'',ha?' ':'',ha&&c('React').createElement('span',null,c('React').createElement('a',{className:"_5ufb",onClick:this._handleToggleDebugInfo}),c('React').createElement(c('XUIContextualDialog.react'),{behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll'),LayerHideOnBlur:c('LayerHideOnBlur')},contextRef:da,hoverHideDelay:0,onBlur:this.props.onToggleDebug,position:'right',shown:fa,hasActionableContext:true},c('React').createElement('div',{className:"_5ufd"},p(ha.toJS()))))));}}),r=c('React').createClass({displayName:'TimeProgress',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{at:l.number.isRequired,label:l.string},componentDidMount:function ba(){this._start=Date.now();var ca=window.setInterval(function(da){return this.forceUpdate();}.bind(this));this.unlisten=function(da){return window.clearInterval(ca,1000);};},componentWillUnmount:function ba(){this.unlisten();},render:function ba(){var ca=this.props,da=ca.at,ea=ca.label,fa=w(this._start,Date.now(),da);return (c('React').createElement('div',{className:"_58jn"},c('React').createElement('div',{className:"_16bc",style:{width:fa+'%'}}),c('React').createElement('div',{className:"_16bd"},ea)));}}),s=c('React').createClass({displayName:'ItemColumn',mixins:[c('OzImmutablePureRenderMixin')],componentDidMount:function ba(){if(this.props.item.get('id')&&this.props.item.get('at'))this._timeout=window.setTimeout(function(ca){return this._timeout!==null&&this.forceUpdate();}.bind(this),aa(this.props.item));},componentWillUnmount:function ba(){window.clearTimeout(this._timeout);this._timeout=null;},render:function ba(){var ca=this.props,da=ca.column,ea=ca.filter,fa=ca.item,ga=ca.line,ha=ca.onItemClick,ia=i({line:ga,column:da}),ja=fa.get('at');return (c('React').createElement('div',{className:"_2966",onClick:function ka(la){la.preventDefault();ha(ia);}},z(fa)?c('React').createElement(r,{label:'AUTO-SENDING',at:ja}):null,c('React').createElement('div',{className:"_34mx"},y(fa)?c('React').createElement(c('MessengerButton.react'),{type:'secondary',label:'EXECUTING NOW...'}):z(fa)?c('React').createElement(c('MessengerButton.react'),{type:'secondary',label:'STOP'}):c('React').createElement('span',null,fa.get('id')&&ja?c('formatDate')(ja/1000,'g:ia M j'):'')),c('React').createElement(u,{className:"_34mz",item:fa,filter:ea})));}}),t=c('OzHelpers').pure(function(ba){var ca=ba.images;return (c('React').createElement('div',null,ca.map(function(da,ea){return (c('React').createElement(c('Image.react'),{key:ea,className:"_1q16",src:da.get('url'),alt:da.get('filename')}));})));}),u=c('OzHelpers').pure(function(ba){var ca=ba.filter,da=ba.item,ea=ba.className;switch(da.get('type')){case k.COMMAND:return c('React').createElement(v,{command:da,highlight:ca});case k.SURVEY:case 'send':case k.TEMPLATE:var fa=da.get('ui-body')&&'"'+da.get('ui-body')+'"',ga=da.getIn(['data','images']);return (c('React').createElement('div',{className:ea},fa?c('React').createElement(c('TextWithHighlights.atlas'),{text:fa,highlight:ca}):null,ga?c('React').createElement(t,{images:ga}):null));case 'suggest':case k.SUGG:return (c('React').createElement(c('OzBubblePreview.react'),{bubble:da.get('data'),highlight:ca,meta:da.get('meta'),source:da.get('source')}));default:c('OzHelpers').debug('[composerai] could not render item',da);return null;}}),v=c('OzHelpers').pure(function(ba){var ca=ba.command,da=ba.highlight;return (c('React').createElement('div',{className:"_2_he"},c('React').createElement('i',{className:c('joinClasses')("_2_hf",ca.get('iconCl'))}),c('React').createElement(c('TextWithHighlights.atlas'),{text:ca.get('text'),highlight:da})));});function w(ba,ca,da){var ea=ca-ba,fa=da-ba;return ea>=0&&fa>0?Math.min(100,Math.round(ea/fa*100)):100;}var x=10000;function y(ba){return (ba.get('id')&&ba.get('at')&&c('OzHelpers').serverNow()>ba.get('at'));}function z(ba){return (ba.get('id')&&ba.get('at')&&c('OzHelpers').serverNow()+x>ba.get('at'));}function aa(ba){var ca=500;return z(ba)?ba.get('at')-c('OzHelpers').serverNow()+ca:ba.get('at')-x-c('OzHelpers').serverNow()+ca;}f.exports={OzComposerAIList:m};}),null);
__d('OzListEditor.react',['cx','OzHelpers','joinClasses','immutable','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').List,j=c('immutable').Map,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzListEditor',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{autofocus:k.bool,list:k.instanceOf(i).isRequired,onClose:k.func,onEdit:k.func.isRequired},componentDidMount:function o(){if(this.props.autofocus)this._focus(0);},componentDidUpdate:function o(p){var q=p.list,r=this.props.list.count();q.count()<r&&this._focus(r-1);},_focus:function o(p){this.refs[p]&&this.refs[p].focus();},render:function o(){var p=this.props,q=p.list,r=p.onEdit,s=p.className,t=babelHelpers.objectWithoutProperties(p,['list','onEdit','className']);return (c('React').createElement('div',{className:c('joinClasses')(s,"_42e_")},q.map(function(u,v){return (c('React').createElement('div',{key:u.get('key'),className:"_42f5"},c('React').createElement('input',{type:'text',ref:v,className:"_42f6 _1-i0",value:u.get('text'),onBlur:function(w){return this._handleItemBlur(u.get('text'),v,w);}.bind(this),onChange:function(w){return this._handleItemChange(u.get('text'),v,w);}.bind(this),onKeyDown:function(w){return this._handleBackspace(u.get('text'),v,w);}.bind(this)})));}.bind(this)),c('React').createElement('div',{key:'plus',className:"_42f5"},c('React').createElement('button',{ref:'plus',className:"_42f7 _1-hv _30yy",type:'button',onMouseDown:function u(v){return v.preventDefault();},onClick:this._handlePlusClick,onKeyDown:function(u){return this._handleBackspace(null,q.count(),u);}.bind(this)},'+'))));},_setText:function o(p,q){this.props.onEdit(this.props.list.setIn([p,'text'],q));},_handlePlusClick:function o(){var p=this.props,q=p.list,r=p.onEdit,s=m(q),t=s===null?q.push(n()):q['delete'](s).push(q.get(s));r(t);},_handleItemBlur:function o(p,q,r){var s=this.props,t=s.list,u=s.onEdit;p.trim()?this._setText(q,p.trim()):t.count()>1&&u(t['delete'](q));},_handleItemChange:function o(p,q,r){this._setText(q,r.target.value);},_handleBackspace:function o(p,q,r){var s=this.props,t=s.list,u=s.onClose;if(r.key==='Backspace'&&!p){r.preventDefault();q>0?this._focus(q-1):t.count()===1?u&&u():this._focus(q+1);}}});function m(o){var p=o.findEntry(function(q){return !q.get('text','').trim();});return p?p[0]:null;}function n(){return j({key:c('OzHelpers').uniqId(),text:''});}f.exports=l;}),null);
__d('OzTokenizer.react',['cx','Promise','OzHelpers','immutable','OzSearchSource','OzImmutablePureRenderMixin','React','SearchableEntry','XUITokenizer.react','XUITokenizerToken.react','TypeaheadViewItem','TypeaheadViewPropTypes'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('immutable').List,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzTokenizer',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{allTokens:k.instanceOf(j).isRequired,onCreateToken:k.func.isRequired,onDeleteToken:k.func.isRequired,chosenTokens:k.instanceOf(j).isRequired,resultRank:k.func.isRequired,resultFilter:k.func.isRequired,placeholder:k.string.isRequired,autofocus:k.bool,maxTokenTitleLength:k.number.isRequired,dropUp:k.bool,timeline:k.bool},getDefaultProps:function p(){return {allTokens:j(),chosenTokens:j(),resultRank:function q(r){return 0;},resultFilter:function q(r,s){return true;},maxTokenTitleLength:Number.MAX_SAFE_INTEGER,timeline:false};},getInitialState:function p(){return {q:''};},componentWillMount:function p(){var q=this.props,r=q.allTokens,s=q.chosenTokens,t=q.resultFilter,u=q.resultRank,v=q.maxTokenTitleLength;this._searchSource=new (c('OzSearchSource'))(function(w){var x=w.query;return c('Promise').resolve(m(x,r,s,t,u,v));});},componentDidMount:function p(){if(this.props.autofocus)this.refs.tokenizer.focusInput();},_onAddEntryAttempt:function p(q){var r=this.props,s=r.onCreateToken,t=r.maxTokenTitleLength;if(q.getTitle().length>t)return;this.setState({q:''});s(o(q));},_onDeleteEntryAttempt:function p(q){var r=this.props.onDeleteToken;r(o(q));},_onQueryStringChange:function p(q){var r=q.target.value;if(r.length<=this.props.maxTokenTitleLength)this.setState({q:q.target.value});},render:function p(){var q=this.props,r=q.chosenTokens,s=q.placeholder,t=q.timeline;return (c('React').createElement('div',{className:"_2-e2"},c('React').createElement(c('XUITokenizer.react'),{className:"_2-e3"+(t?' '+"_11_w":''),placeholder:s,entries:r.map(n).toJS(),presenter:this._tokenPresenter(),queryString:this.state.q,searchSource:this._searchSource,onRemoveEntryAttempt:this._onDeleteEntryAttempt,onAddEntryAttempt:this._onAddEntryAttempt,onQueryStringChange:this._onQueryStringChange,ref:'tokenizer'})));},_tokenPresenter:function p(){var q=this.props.dropUp,r=c('OzHelpers').pure(function(u){return (c('React').createElement(c('XUITokenizerToken.react'),babelHelpers['extends']({},u,{className:"_2-e5"})));}),s=c('React').createClass({displayName:'OzTypeaheadViewItem',mixins:[c('TypeaheadViewItem').Mixin],propTypes:c('TypeaheadViewItem').propTypes,render:function u(){var v=this.props.highlighted;return (c('React').createElement('li',{className:"_2-e7"+(v?' '+"_2-e8":''),'aria-selected':this.props.highlighted,onMouseDown:this._onSelect,onMouseEnter:this._onHighlight,role:this.props.role},this.props.entry.getTitle()));}}),t=c('React').createClass({displayName:'OzTypeaheadView',mixins:[c('OzImmutablePureRenderMixin')],propTypes:c('TypeaheadViewPropTypes'),_renderItem:function u(v){var w=v===this.props.highlightedEntry;return (c('React').createElement(s,{key:v.getUniqueID(),entry:v,highlighted:w,onSelect:this.props.onSelect,onHighlight:this.props.onHighlight,onRenderHighlight:this.props.onRenderHighlight}));},render:function u(){var v="_2-e9"+(q?' '+"_2-ea":'')+(!this.props.entries.length?' '+"_599s":'');return (c('React').createElement('ul',{className:v,id:this.props.ariaOwneeID,role:this.props.role},this.props.entries.map(this._renderItem)));}});return {ViewRenderer:t,TokenRenderer:r,useLayer:false};}});function m(){var p=arguments.length<=0||arguments[0]===undefined?'':arguments[0],q=arguments[1],r=arguments[2],s=arguments[3],t=arguments[4],u=arguments[5];if(!p)return [];var v=q.filter(function(w){return !r.includes(w);}).filter(function(w){return w.get('name').length<=u;}).filter(function(w){return s(w,p);}).sortBy(t).map(n).take(10).toList();return v.filter(function(w){return w.getUniqueID()==p;}).count()==0?v.push(n(i({name:p,id:p}))).toJS():v.toJS();}function n(p){return new (c('SearchableEntry'))({title:p.get('name'),uniqueID:p.get('id')});}function o(p){return i({id:p.getUniqueID(),name:p.getTitle()});}f.exports=l;}),null);
__d('OzTextTokenizer.react',['immutable','OzTokenizer.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('immutable').List,i=c('React').PropTypes,j=c('React').createClass({displayName:'OzTextTokenizer',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{allTokens:i.instanceOf(h).isRequired,onChange:i.func.isRequired,chosenTokens:i.instanceOf(h).isRequired,placeholder:i.string.isRequired,autofocus:i.bool,maxTokenLength:i.number},getDefaultProps:function k(){return {allTokens:h(),chosenTokens:h()};},_commitChangedTokens:function k(l){var m=this.props.onChange;this.setState({q:''});m(l);},_onAddEntryAttempt:function k(l){var m=this.props.chosenTokens;this._commitChangedTokens(m.push(l));},_onDeleteEntryAttempt:function k(l){var m=this.props.chosenTokens,n=m.indexOf(l);this._commitChangedTokens(n>=0?m['delete'](n):m);},render:function k(){var l=this.props,m=l.allTokens,n=l.chosenTokens,o=l.placeholder,p=l.maxTokenLength,q=l.autofocus;return (c('React').createElement(c('OzTokenizer.react'),{placeholder:o,allTokens:m,chosenTokens:n,onDeleteToken:this._onDeleteEntryAttempt,onCreateToken:this._onAddEntryAttempt,resultFilter:function r(s,t){return (s.get('name').toLowerCase().indexOf(t.toLowerCase())==0);},maxTokenTitleLength:p,dropUp:true,autofocus:q}));}});f.exports=j;}),null);
__d('OzQuickRepliesComposer.react',['cx','immutable','OzTextTokenizer.react','React','XUICloseButton.react'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('immutable').Map,l=c('immutable').List,m=c('React').PropTypes,n=l(['Yes','No','Maybe later','7:00am','7:30am','8:00am','8:30am','9:00am','11:00am','11:30am','12:00pm','12:30pm','1:00pm','1:30pm','2:00pm','5:00pm','5:30pm','6:00pm','6:30pm','7:00pm','7:30pm','8:00pm','8:30pm','9:00pm','Italian','Japanese','Steakhouse','American','French','Chinese','Thai','Burmese','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday','San Francisco','Menlo Park','Los Angeles','New York','London','Paris','Berlin']);i=babelHelpers.inherits(o,c('React').Component);j=i&&i.prototype;function o(){var p,q;'use strict';for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=j.constructor).call.apply(q,[this].concat(s)),this.$OzQuickRepliesComposer1=function(u){var v=this.props,w=v.attachment,x=v.onEdit;x(w.set('data',u));}.bind(this),p;}o.prototype.render=function(){'use strict';var p=this.props,q=p.attachment,r=p.onRemove;return (c('React').createElement('div',{className:"_46s3"},c('React').createElement('div',{className:"_46s4"},c('React').createElement('div',{className:"_46s5"},'Quick Replies'),c('React').createElement(c('XUICloseButton.react'),{onClick:r})),c('React').createElement(c('OzTextTokenizer.react'),{allTokens:n.map(function(s){return k({id:s,name:s});}),onChange:this.$OzQuickRepliesComposer1,chosenTokens:q.get('data')||l(),placeholder:'Add quick replies...',autofocus:true,maxTokenLength:20})));};o.propTypes={attachment:m.instanceOf(k).isRequired,onEdit:m.func.isRequired,onRemove:m.func.isRequired};f.exports=o;}),null);
__d('OzComposerAttachments.react',['cx','OzHelpers','Image.react','immutable','MNCommerceAgentItemSuggestionMercuryAttachment.react','OzAttachmentOverlay.react','OzConstants','OzListEditor.react','OzQuickRepliesComposer.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').OrderedMap,j=c('immutable').Map,k=c('immutable').List,l=c('OzConstants').ATTS,m=c('React').PropTypes,n=c('React').createClass({displayName:'OzComposerAttachments',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{attachments:m.instanceOf(i).isRequired,onAttachmentCrop:m.func.isRequired,onBubbleEdit:m.func.isRequired,onQuickRepliesEdit:m.func.isRequired,onRemove:m.func.isRequired},render:function q(){var r=this.props,s=r.attachments,t=r.onAttachmentCrop,u=r.onBubbleEdit,v=r.onQuickRepliesEdit,w=r.onRemove;if(s.isEmpty())return null;return (c('React').createElement('div',{className:"_18wb"},s.map(function(x,y){return (c('React').createElement(o,{key:y,id:y,attachment:x,onRemove:w,onBubbleEdit:u,onAttachmentCrop:t,onQuickRepliesEdit:v}));}).valueSeq()));}}),o=c('React').createClass({displayName:'Attachment',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{attachment:m.instanceOf(j).isRequired,id:m.number.isRequired,onAttachmentCrop:m.func.isRequired,onBubbleEdit:m.func.isRequired,onQuickRepliesEdit:m.func.isRequired,onRemove:m.func.isRequired},render:function q(){var r=this.props,s=r.attachment,t=r.id,u=r.onAttachmentCrop,v=r.onBubbleEdit,w=r.onQuickRepliesEdit,x=r.onRemove;switch(s.get('type')){case l.IMAGE:return (c('React').createElement(c('OzAttachmentOverlay.react'),{key:t,onEdit:function y(z){return u(s,t);},onRemove:function y(z){return x(s,t);},loading:s.get('loading')},p(s)));case l.SUGG:return (c('React').createElement(c('OzAttachmentOverlay.react'),{key:t,onRemove:function y(z){return x(s,t);},onEdit:function y(z){return v(s,t);}},c('React').createElement(c('MNCommerceAgentItemSuggestionMercuryAttachment.react'),{itemSuggestion:c('OzHelpers').uiSuggestion(s.get('data'))})));case l.QUICK_REPLIES:return (c('React').createElement(c('OzQuickRepliesComposer.react'),{attachment:s,onEdit:w,onRemove:function y(z){return x(s,t);}}));default:return (c('React').createElement(c('OzAttachmentOverlay.react'),{key:t},c('React').createElement('span',null,JSON.stringify(s))));}}});function p(q){var r=q.get('ui-blob');if(r&&!c('OzHelpers').isImageType(r.type)){return c('React').createElement('p',{className:"_4gpv"},r.name);}else{var s=q.get('url')||c('OzHelpers').blobURI(r);return (c('React').createElement(c('Image.react'),{className:"_4xee",onClick:function t(u){return window.open(s);},src:s}));}}f.exports=n;}),null);
__d('OzConfirmDialog.react',['cx','joinClasses','MessengerDialog.react','MessengerDialogBody.react','MessengerDialogButton.react','MessengerDialogFooter.react','MessengerDialogHeader.react','OzActions','React'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').PureComponent);j=i&&i.prototype;l.prototype.render=function(){'use strict';var n=this.props,o=n.body,p=n.className,q=n.confirmLabel,r=n.cancelLabel,s=n.header,t=n.onCancel,u=n.onConfirm,v=n.width,w=babelHelpers.objectWithoutProperties(n,['body','className','confirmLabel','cancelLabel','header','onCancel','onConfirm','width']);return (c('React').createElement(c('MessengerDialog.react'),babelHelpers['extends']({className:c('joinClasses')("_1vdh",p),onToggle:m(t),width:v||500},w),c('React').createElement(c('MessengerDialogHeader.react'),null,s),c('React').createElement(c('MessengerDialogBody.react'),{className:"_1vdi"},o),c('React').createElement(c('MessengerDialogFooter.react'),null,c('React').createElement(c('MessengerDialogButton.react'),{label:r||'Cancel',onClick:m(t),type:'secondary',use:'default'}),c('React').createElement(c('MessengerDialogButton.react'),{className:'autofocus',label:q||'OK',onClick:m(u),ref:'confirm',type:'primary',use:'default'}))));};function l(){'use strict';i.apply(this,arguments);}l.propTypes={body:k.node.isRequired,confirmLabel:k.string,cancelLabel:k.string,header:k.string.isRequired,onConfirm:k.func.isRequired,onCancel:k.func,width:k.number};function m(n){return function(o){c('OzActions').hideDialog();n&&n();};}f.exports=l;}),null);
__d('OzDateTimePicker.react',['cssVar','cx','OzHelpers','joinClasses','AbstractDateTimePicker.react','AdsTimezone','Arbiter','BUIDatePicker.react','BUITimeInput.react','DatePickerRestraints','immutable','LocalDateTime','OzConfig','ReactComponentWithPureRenderMixin','React','ReactDOM','Reflux','SUIAudiencePlatformTheme','SUITheme','SUITimeZoneSelector.react','Timezone','XUIError.react'],(function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes,m=c('immutable').Map,n=c('React').createClass({displayName:'OzDateTimePicker',mixins:[c('ReactComponentWithPureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:babelHelpers['extends']({dateRestraints:l.arrayOf(l.func),disabled:l.bool,layout:l.oneOf(['one-line','two-line','three-line']),onChange:l.func.isRequired,showTimezoneName:l.bool,timestamp:l.number,timezone:l.string},c('XUIError.react').PropTypes),getDefaultProps:function w(){return {dateRestraints:u(),disabled:false,layout:'one-line',showTimezoneName:true,timezone:q()};},render:function w(){var x=this.props,y=x.className,z=x.dateRestraints,aa=x.disabled,ba=x.layout,ca=x.onChange,da=x.showTimezoneName,ea=x.timestamp,fa=x.timezone,ga=x.xuiError,ha=x.xuiErrorAlignh,ia=x.xuiErrorPosition,ja=babelHelpers.objectWithoutProperties(x,['className','dateRestraints','disabled','layout','onChange','showTimezoneName','timestamp','timezone','xuiError','xuiErrorAlignh','xuiErrorPosition']),ka={xuiError:ga,xuiErrorAlignh:ha,xuiErrorPosition:ia},la=t(fa),ma=o(ea,la),na=c('joinClasses')("_3hma"+(aa?' '+"_3hmb":''),y),oa=ba==='two-line'&&da&&202||!da&&110||'auto';return (c('React').createElement(c('XUIError.react'),ka,c('React').createElement('div',{className:na},c('React').createElement(c('AbstractDateTimePicker.react'),babelHelpers['extends']({},ja,{className:"_3hmc",classNames:{innerWrapper:"_3hmd"},datePicker:c('React').createElement(c('BUIDatePicker.react'),{className:"_3hme",dateRestraints:this._dateRestraints(la),height:'short',placeholder:'mm/dd/yyyy'}),disabled:aa,onChange:function(pa){return this._handleChange(pa,la);}.bind(this),timeInput:c('React').createElement(c('BUITimeInput.react'),{className:"_3hml"+(ba!=='three-line'?' '+"_3hmm":'')+(ba==='three-line'?' '+"_3hmn":''),height:'short'}),timezoneID:la,value:ma})),c('React').createElement(v,{style:!ea&&{display:'none'},className:"_3hmo"+(ba==='one-line'?' '+"_3hmm":'')+(ba!=='one-line'?' '+"_3hmn":''),isDisabled:aa,onChange:function(pa){return this._handleChange(ma,pa.get('timeZoneId'));}.bind(this),shouldShowSubtitleInSelector:da,value:c('SUITimeZoneSelector.react').VALUE({timeZoneId:la}),width:oa}))));},_handleChange:function w(x,y){var z=p(x,y),aa=r(y);this.props.onChange({timestamp:z,timezone:aa});},_dateRestraints:function w(x){return this.props.dateRestraints&&this.props.dateRestraints.map(function(y){return (function(z){return y(z&&z.toDateTime(x).toDate());});});}});function o(w,x){try{if(w&&x!=null){return c('LocalDateTime').fromInstant(Math.round(w/1000),x);}else return null;}catch(y){c('OzHelpers').warn('[dateTimePicker] cannot convert to LocalDateTime',w,x,y);return null;}}function p(w,x){try{if(w&&x!=null){var z=w.toInstant(x)*1000,aa=z-z%60000;return aa;}else return null;}catch(y){c('OzHelpers').warn('[dateTimePicker] cannot convert from LocalDateTime',w,x,y);return null;}}function q(){var w=c('Timezone').getEnvironmentTimezoneID();w==null&&c('OzHelpers').warn('[dateTimePicker] could not get environment time zone');return r(w);}function r(w){var x=c('AdsTimezone').names[w];x==null&&c('OzHelpers').warn('[dateTimePicker] unknown timezone id',w);return x;}var s=m(c('AdsTimezone').names.map(function(w,x){return [w,x];}));function t(w){var x=s.get(w);x===undefined&&c('OzHelpers').warn('[timezoneIDForName] unrecognized timezone',w);return x||s.get('America/Los_Angeles');}function u(){var w=new Date(),x=new Date(Date.UTC(w.getFullYear(),w.getMonth(),w.getDate())),y=new Date(+x),z=new Date(+x);y.setFullYear(x.getFullYear()-5);z.setFullYear(x.getFullYear()+5);return [c('DatePickerRestraints').enforceDateIsNoEarlierThan(y),c('DatePickerRestraints').enforceDateIsNoLaterThan(z)];}j=babelHelpers.inherits(v,c('React').PureComponent);k=j&&j.prototype;v.prototype.componentDidMount=function(){'use strict';c('ReactDOM').findDOMNode(this.refs.timezoneSelector).addEventListener('focusout',function(w){return window.setTimeout(function(x){return c('Arbiter').inform('reflow');});});};v.prototype.render=function(){'use strict';return (c('React').createElement(c('SUITimeZoneSelector.react'),babelHelpers['extends']({},this.props,{ref:'timezoneSelector',theme:c('SUIAudiencePlatformTheme')})));};function v(){'use strict';j.apply(this,arguments);}f.exports=n;}),null);
__d('OzSendLater.react',['cx','OzHelpers','LayerHideOnBlur','MessengerButton.react','OzDateTimePicker.react','OzImmutablePureRenderMixin','React','Tooltip','XUIContextualDialog.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzSendLater',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{numScheduled:i.number.isRequired,onSendLater:i.func.isRequired,onTimeChange:i.func.isRequired,onToggle:i.func.isRequired,shown:i.bool.isRequired,timestamp:i.number,timezone:i.string,disabled:i.bool},render:function k(){var l=this.props,m=l.shown,n=l.disabled,o=l.numScheduled,p=l.onSendLater,q=l.onToggle,r=l.timestamp,s=l.timezone;return (c('React').createElement('span',{className:"_40yd"},c('React').createElement('button',babelHelpers['extends']({ref:'btn',disabled:n,onClick:function t(u){return q(true);}},n?c('Tooltip').propsFor('We can not schedule this message; '+'images are not supported yet'):null,{className:"_1-hv _40ye _30yy"}),c('React').createElement('i',{className:"_40yf"}),o?c('React').createElement('div',{className:"_2ism"},o):null),c('React').createElement(c('XUIContextualDialog.react'),{autoFocus:false,position:'above',contextRef:function(t){return this.refs.btn;}.bind(this),className:"_40yg",shown:m,onToggle:q,behaviors:{LayerHideOnBlur:c('LayerHideOnBlur')}},c('React').createElement('div',{className:"_40yg"},c('React').createElement(c('OzDateTimePicker.react'),babelHelpers['extends']({className:"_40yh",timestamp:r||c('OzHelpers').serverNow(),timezone:s,onChange:this._handleTimeChange},c('OzHelpers').dateRestraints())),c('React').createElement(c('MessengerButton.react'),{onClick:p,label:'Send Later',type:'primary'})))));},_handleTimeChange:function k(l){this.props.onTimeChange(l);}});f.exports=j;}),null);
__d('OzTypingDots.react',['cx','immutable','React'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('immutable').Range,l=c('React').PropTypes,m=3;i=babelHelpers.inherits(n,c('React').PureComponent);j=i&&i.prototype;n.prototype.render=function(){'use strict';var p=this.props,q=p.bouncing,r=p.disabled,s=p.onClick,t=this.props.numDots||m,u="_32p1"+(q&&!r?' '+"_32p2":'')+(r?' '+"_32p3":'')+(' '+"_30yy");return (c('React').createElement('div',{className:u,onClick:s},c('React').createElement('div',{className:"_32p4"},k(0,t).map(function(v){return c('React').createElement(o,{index:v,key:v});}))));};function n(){'use strict';i.apply(this,arguments);}n.propTypes={bouncing:l.bool,disabled:l.bool,numDots:l.number,onClick:l.func};function o(p){var q=p.index,r=100*q;return (c('React').createElement('div',{className:"_32p5",style:{animationDelay:r+'ms'}}));}f.exports=n;}),null);
__d('OzUpdateDateTime.react',['immutable','OzHelpers','React'],(function a(b,c,d,e,f,g){var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('immutable').Map,k=c('React').PropTypes;h=babelHelpers.inherits(l,c('React').Component);i=h&&h.prototype;l.prototype.componentDidMount=function(){'use strict';var m=setInterval(function(){this.forceUpdate();}.bind(this),60000);this.setState({timer:m});};l.prototype.componentWillUnmount=function(){'use strict';if(this.state.timer)clearInterval(this.state.timer);};l.prototype.render=function(){'use strict';var m=new Date(c('OzHelpers').serverNow()+this.props.timezoneOffset);return (c('React').createElement('span',null,m.toLocaleString(this.props.locale,this.props.options.set('timeZone','UTC').toJS())));};function l(){'use strict';h.apply(this,arguments);}l.propTypes={timezoneOffset:k.number.isRequired,locale:k.string.isRequired,options:k.instanceOf(j).isRequired};f.exports=l;}),null);
__d('OzComposer.react',['cx','fbt','invariant','Promise','OzAPI','OzEditorStateHelpers','formatDate','getDefaultKeyBinding','getEntityMatcher','getVisibleValueForContentState','OzHelpers','insertEmoticonIntoEditorState','OzNotify','promiseFinally','ChatContentSearchButton.react','ChatStickerButton.react','CompositeDraftDecorator','DraftEditor.react','DraftModifier','EditorState','EmoticonsList','EmoticonSpan.react','FileInput.react','immutable','KeyBindingUtil','Keys','MessengerContextualDialog.react','MercuryConfig','OzActions','OzAttachmentCropper.react','OzBubbleEditor.react','OzComposerAI.react','OzComposerAttachments.react','OzConfig','OzConfirmDialog.react','OzConstants','OzHistory','OzSendLater.react','OzTypingDots.react','OzStores','OzSuggestions','OzUpdateDateTime.react','React','OzWrapper.react','Reflux','SelectionState','Timestamp.react'],(function a(b,c,d,e,f,g,h,i,j){if(c.__markCompiled)c.__markCompiled();var k=c('OzHistory')('composer-history'),l=c('immutable').Map,m=c('immutable').OrderedMap,n=c('immutable').List,o=c('React').PropTypes,p=c('OzComposerAI.react').OzComposerAIList,q=c('OzConstants').ATTS,r=c('OzConstants').TOKENS,s=c('OzStores').ActiveThreadStore,t=c('OzStores').BubbleStore,u=8*1024*1024,v={CREATE_BUBBLE:'CREATE_BUBBLE',CREATE_REMINDER:'CREATE_REMINDER',CREATE_INTENT:'CREATE_INTENT',CLOSE_INTENT:'CLOSE_INTENT',CLOSE_REMINDER:'CLOSE_REMINDER',ADD_QUICK_REPLIES:'ADD_QUICK_REPLIES'},w=15*60*1000,x=4*60*1000,y=c('React').createClass({displayName:'OzComposer',mixins:[c('Reflux').connect(t,'bubbles'),c('Reflux').connect(s,'activeThread'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{thread:o.instanceOf(l).isRequired,merchants:o.instanceOf(l).isRequired,onResize:o.func},contextTypes:{router:o.object.isRequired,uid:o.string.isRequired},getInitialState:function tb(){return da(this.props.thread);},componentDidMount:function tb(){this._unlistenComposer=c('OzActions').updateComposer.listen(this._onUpdateComposer);this._unlistenAISelect=c('OzActions').selectAIPick.listen(this._handleAISelect);this._cleanup=function(){this._unlistenComposer();this._unlistenAISelect();}.bind(this);this._oldHeight=this.refs.root.offsetHeight;},componentWillReceiveProps:function tb(ub){if(c('OzHelpers').threadID(ub.thread)!==c('OzHelpers').threadID(this.props.thread)){ea(this.tid(),this.state);this.setState(da(ub.thread));}},componentDidUpdate:function tb(ub,vb){window.setTimeout(function(xb){var yb=this.refs.root&&this.refs.root.offsetHeight;if(yb!==this._oldHeight)this.props.onResize&&this.props.onResize();this._oldHeight=yb;}.bind(this));var wb=c('OzHelpers').threadID(ub.thread);wb===this.tid()?fa(this.tid(),vb,this.state):c('OzAPI').notTyping(wb);},componentWillUnmount:function tb(){ea(this.tid(),this.state);this._cleanup();c('OzAPI').notTyping(this.tid());},getValue:function tb(){return c('getVisibleValueForContentState')(this.e().getCurrentContent());},focusInput:function tb(){this.refs.input.focus();},render:function tb(){return (c('React').createElement('div',{ref:'root',className:"_5751 _19ib"},this._renderWidgets(),c('React').createElement('div',{className:"_5754"},this._renderSettings(),c('React').createElement('div',{className:"_19id"},this._renderTextEditor()),this._renderActions())));},_renderTextEditor:function tb(){return (c('React').createElement(c('DraftEditor.react'),{ref:'input',editorState:this.e(),keyBindingFn:this._toKeyCommand,handleKeyCommand:this._handleKeyCommand,handleBeforeInput:this._handleBeforeInput,onChange:this._handleChange,onDownArrow:this._handleDownArrow,onUpArrow:this._handleUpArrow,onTab:this._handleTab,handleReturn:this._handleReturn,onFocus:this._handleFocus,handlePastedFiles:this._handleFiles,handleDroppedFiles:function(ub,vb){this._handleFiles(vb);}.bind(this),placeholder:this.state.sendTyping?i._("Type a message... (\u2318\u21a9 to send)"):i._("Sneakily type a message... (\u2318\u21a9 to exit sneaky mode and send)"),spellCheck:true,textAlignment:'left'}));},_handleFocus:function tb(){this.setState({isAIOpen:true});},_onUpdateComposer:function tb(ub){var vb=ub.text,wb=ub.files;vb&&this._handleChange(c('OzEditorStateHelpers').append(this.e(),vb));wb&&this._handleFiles(wb);this.refs.input.focus();},_validateSend:function tb(){var ub=this.state.attachments;return new (c('Promise'))(function(vb,wb){var xb=[[wa(this.e().getCurrentContent()).length>0,'You have not filled in all the missing information.'],[ub.some(function(yb){return yb.get('loading');}),'Your attachments are still loading. Please wait and send in a bit'],[ja(ub)&&!this.getValue().trim()&&!ub.find(function(yb){return yb.get('type')===q.SUGG;}),'You need to type a message or create a bubble '+'if you want to send quick replies'],[!c('OzHelpers').isOwner(this.t(),this.context.uid),'You do not own this thread. Assign yourself to send messages']].find(function(yb){var zb=yb[0],ac=yb[1];return zb;});xb?wb(xb[1]):vb();}.bind(this));},_sendWith:function tb(ub,vb){this._validateSend().done(function(wb){var xb=c('OzHelpers').threadID(this.t()),yb=this.getValue().trim(),zb=this.state.attachments.groupBy(function(gc){return gc.get('type');}),ac=ua(this.t(),this.state),bc=zb.get(q.IMAGE,n()).map(function(gc){return gc['delete']('ui-blob');}).toList(),cc=ka(this.state.attachments),dc=cc&&{'generic-metadata':cc},ec=function gc(){return yb||!bc.isEmpty()?ub(babelHelpers['extends']({tid:xb,images:bc,text:yb,aiusage:ac},dc)):c('Promise').resolve();},fc=function gc(){return zb.get(q.SUGG,n()).reduce(function(hc,ic){return c('promiseFinally')(hc,function(jc){return vb(babelHelpers['extends']({tid:xb,suggestion:ic.get('data'),aiusage:ac},dc));});},c('Promise').resolve());};c('promiseFinally')(ec(),fc);c('OzAPI').notifyExtension({action:'discard',id:xb});this._toHistory();this.setState(babelHelpers['extends']({},ba(this.t()),{editorState:c('OzEditorStateHelpers').replaceContentWithText(this.e(),''),seedBubble:this.state.seedBubble,isAIOpen:this.state.isAIOpen}));}.bind(this),c('OzNotify').error);},_handleMessageSend:function tb(){la('send',[ma(this.t()),na(this.t(),this.state.activeThread),oa(this.getValue().trim())],function(ub){return this._sendWith(c('OzAPI').sendMessage,c('OzAPI').suggest);}.bind(this));},_handleSendLater:function tb(){var ub=this.state.schedule.timestamp;this.setState({sendTyping:false});if(!ub){c('OzNotify').error('You need to pick a time to send later');return;}if(ub<c('OzHelpers').serverNow()-x){c('OzNotify').error('This time is in the past. Is the timezone correct?');return;}la('schedule',[na(this.t(),this.state.activeThread),oa(this.getValue().trim())],function(vb){this._sendWith(function(wb){return c('OzAPI').scheduleMessage(babelHelpers['extends']({},wb,{at:ub}));},function(wb){return c('OzAPI').scheduleSuggest(babelHelpers['extends']({},wb,{at:ub}));});this.setState({sendTyping:true});}.bind(this));},_handleReturn:function tb(ub){if(c('OzHelpers').hasCmdOrCtrl(ub)){setTimeout(this._handleMessageSend);return true;}return false;},_handleFiles:function tb(ub){var vb=ub;if(vb.some(function(yb){return yb.size>=u;})){c('OzNotify').error('The file you are trying to add is too large.');return false;}if(!vb.length)return false;var wb=this.state.attachments.merge(vb.map(function(yb,zb){return [zb,l({type:q.IMAGE,'ui-blob':yb,loading:true})];}));this.setState({attachments:wb});var xb=function yb(zb){return (vb.reduce(function(ac,bc,cc){return ac['delete'](cc);},zb));};c('Promise').all(vb.map(function(yb){return c('OzAPI').upload(l({type:yb.type,blob:yb}));})).done(function(yb){!yb.every(function(zb){return zb.get('id');})?j(0):void 0;this.setState({attachments:ga(xb(this.state.attachments),yb.map(function(zb,ac){return zb.set('ui-blob',vb[ac]);}))});}.bind(this),function(yb){this.setState({attachments:xb(this.state.attachments)});}.bind(this));return true;},_nonTextSend:function tb(ub){var vb=la('send',[ma(this.t()),na(this.t(),this.state.activeThread)],ub);return this._validateSend().then(vb,c('OzNotify').error);},_handleStickerSelect:function tb(ub){this._nonTextSend(function(vb){c('OzAPI').sendMessage({tid:c('OzHelpers').threadID(this.t()),'sticker-id':ub,aiusage:ua(this.t(),this.state)});}.bind(this));},_handleContentSearchSelect:function tb(ub,vb){if(ub.platformFBID.toString()===c('MercuryConfig').MessengerAppID){this._handleStickerSelect(ub.resultID.toString());return;}this._nonTextSend(function(wb){c('OzAPI').upload(l({type:'image/url','attribution-app-id':ub.platformFBID,'image-url':ub.source.url})).done(function(xb){return c('OzAPI').sendMessage({tid:c('OzHelpers').threadID(this.t()),images:[xb],aiusage:ua(this.t(),this.state)});}.bind(this));}.bind(this));},_handleEmoticonSelect:function tb(ub){var vb=c('EmoticonsList').symbols[ub];vb&&this._handleChange(c('insertEmoticonIntoEditorState')(vb,this.state.editorState));},_handleAttRemove:function tb(ub){this.setState({attachments:this.state.attachments['delete'](ub.get('id'))});},_handleBubbleEdit:function tb(ub){this.setState({seedBubble:ub});},_handleBubbleEditorSave:function tb(ub){this.setState({seedBubble:null,attachments:ga(this.state.attachments,[ub])},function(vb){return this.refs.input.focus();}.bind(this));},_handleBubbleEditorClose:function tb(ub){var vb={seedBubble:null},wb=ub.get('id');if(wb)vb.attachments=this.state.attachments['delete'](wb);this.setState(vb,function(xb){return this.refs.input.focus();}.bind(this));},_handleAttachmentCrop:function tb(ub){this.setState({cropAttachment:ub});},_handleAttCropperSave:function tb(ub){var vb=this.state.attachments['delete'](ub.get('id'));this.setState({cropAttachment:null,attachments:vb},function(wb){this._handleFiles([ub.get('ui-blob')]);this.refs.input.focus();}.bind(this));},_handleAttCropperClose:function tb(ub){this.setState({cropAttachment:null},function(vb){return this.refs.input.focus();}.bind(this));},_handleQuickRepliesEdit:function tb(ub){this.setState({attachments:ga(this.state.attachments,[ub])});},_handleTypingDotsClick:function tb(){this.setState({sendTyping:!this.state.sendTyping});},_renderWidgets:function tb(){if(this.state.seedBubble)return (c('React').createElement(c('OzBubbleEditor.react'),{merchants:this.props.merchants,seedBubble:this.state.seedBubble,onSave:this._handleBubbleEditorSave,onClose:this._handleBubbleEditorClose}));if(this.state.cropAttachment)return (c('React').createElement(c('OzAttachmentCropper.react'),{attachment:this.state.cropAttachment,onSave:this._handleAttCropperSave,onClose:this._handleAttCropperClose}));return (c('React').createElement('div',null,c('React').createElement(p,{filter:this.getValue(),items:this._AIItems(),onItemClick:this._handleAIItemClick}),c('React').createElement(c('OzComposerAttachments.react'),{attachments:this.state.attachments,onRemove:this._handleAttRemove,onBubbleEdit:this._handleBubbleEdit,onAttachmentCrop:this._handleAttachmentCrop,onQuickRepliesEdit:this._handleQuickRepliesEdit})));},_renderSettings:function tb(){return (c('React').createElement('div',{className:"_41s9"},c('React').createElement(c('OzTypingDots.react'),{disabled:!this.state.sendTyping,onClick:this._handleTypingDotsClick})));},_renderActions:function tb(){return (c('React').createElement('div',{className:"_575c"},c('React').createElement(c('ChatStickerButton.react'),{className:"_30yy"+(' '+"_1v3y"),flyoutAlignment:'right',flyoutClassName:"_293j",onStickerSelect:this._handleStickerSelect,onEmoticonSelect:this._handleEmoticonSelect}),c('React').createElement(c('FileInput.react'),{ref:'fileInput',display:'inline-block',containerClassName:"_30yy _41sr",accept:'*/*',multiple:true,onChange:function(ub){this._handleFiles([].slice.apply(ub.target.files));this.refs.fileInput.getFileInput().clear();}.bind(this)},c('React').createElement('a',{title:'add images',className:"_2e01 _30yy"})),c('React').createElement(c('ChatContentSearchButton.react'),{className:"_yht _30yy _592k",ref:'chatContentSearch',ContextualDialogClass:c('MessengerContextualDialog.react'),flyoutAlignment:'right',flyoutClassName:"_293j",flyoutWidth:285,onStickerSelect:this._handleStickerSelect,getInput:function(){return this.refs.input;}.bind(this),getQuery:this.getValue,onSelect:this._handleContentSearchSelect}),c('React').createElement(c('OzSendLater.react'),babelHelpers['extends']({},this.state.schedule,{numScheduled:this.props.thread.get('events')?this.props.thread.get('events').count():0,onTimeChange:this._handleScheduleTimeChange,onToggle:this._handleScheduleToggle,onSendLater:this._handleSendLater}))));},_handleChange:function tb(ub){this.setState({editorState:ub});},_handleDownArrow:function tb(ub){if(c('OzHelpers').hasCmdOrCtrl(ub)&&this.e().isSelectionAtStartOfContent()){this._fromHistory('down');ub.preventDefault();return true;}},_handleUpArrow:function tb(ub){if(c('OzHelpers').hasCmdOrCtrl(ub)&&this.e().isSelectionAtStartOfContent()){this._fromHistory('up');ub.preventDefault();return true;}},_handleTab:function tb(ub){var vb=ya(this.e());if(vb){this.setState({editorState:c('EditorState').forceSelection(this.e(),vb)});ub.preventDefault();return true;}var wb=sa(this._AIItems(),l({line:0,column:0}));if(wb){this._handleAISelect(wb);ub.preventDefault();return true;}},_toKeyCommand:function tb(ub){var vb=function(){var xb=ub.keyCode-c('Keys').ZERO;if(this.state.isAIOpen&&xb<=this._AIItems().size)return 'SELECT-AI-ITEM-'+(xb-1);}.bind(this),wb=function(xb){return (qa(xb)&&!ja(this.state.attachments)&&this.state.config.getIn(['GK','quickReplies']));}.bind(this);return (pa(ub)&&v.CREATE_BUBBLE||wb(ub)&&v.ADD_QUICK_REPLIES||ta(ub)&&vb()||ra(ub)&&'PREFERRED-NAME'||c('getDefaultKeyBinding')(ub));},_handleKeyCommand:function tb(ub){switch(ub){case 'SELECT-AI-ITEM-0':case 'SELECT-AI-ITEM-1':case 'SELECT-AI-ITEM-2':case 'SELECT-AI-ITEM-3':case 'SELECT-AI-ITEM-4':case 'SELECT-AI-ITEM-5':case 'SELECT-AI-ITEM-6':case 'SELECT-AI-ITEM-7':case 'SELECT-AI-ITEM-8':case 'SELECT-AI-ITEM-9':this._handleAIItemClick(l({line:+ub.slice(-1),column:0}));return true;case 'PREFERRED-NAME':this._handleChange(c('EditorState').push(this.e(),c('DraftModifier').replaceText(this.e().getCurrentContent(),this.e().getSelection(),c('OzHelpers').preferredName(this.t()))));return true;case v.CREATE_BUBBLE:this.setState({seedBubble:ha()});return true;case v.ADD_QUICK_REPLIES:this.setState({attachments:ga(this.state.attachments,[ia()])});return true;}return false;},_AIItems:function tb(ub){return bb(this.state.isAIOpen,this.props.thread,this.state.attachments,this.state.bubbles,this.props.merchants,this.getValue());},_handleAISelect:function tb(ub){this.setState({lastAIPick:ub,lastAIGuesses:this.t().get('guesses'),sendTyping:eb(ub)?false:this.state.sendTyping},function(){var vb=ub.get('id');if(eb(ub)){c('OzAPI').deleteScheduled(c('OzHelpers').threadID(this.t()),vb);this._handleScheduleTimeChange({timestamp:ub.get('at'),timezone:c('OzHelpers').timezone(this.t())});}switch(ub.get('type')){case q.COMMAND:if(!eb(ub))switch(ub.get('action')){case v.CREATE_REMINDER:this._handleCreateReminder(ub);break;case v.CLOSE_REMINDER:this._handleCloseReminder(ub);break;case v.CREATE_INTENT:this._handleCreateIntent(ub);break;case v.CLOSE_INTENT:this._handleCloseIntent(ub);break;default:this._handleKeyCommand(ub.get('action'));}break;case q.SURVEY:case 'send':case q.TEMPLATE:var wb=ub.get('f'),xb=wb&&wb()||ub.get('ui-body'),yb=ub.getIn(['data','images']),zb=c('OzEditorStateHelpers').replaceLine(this.e(),xb+' '),ac=ya(zb);if(xb)this._handleChange(ac?c('EditorState').forceSelection(zb,ac):zb);if(yb)this.setState({attachments:ga(this.state.attachments,yb.toArray())});break;case 'suggest':case q.SUGG:this.setState({seedBubble:ub});break;case q.OPENTABLEQR:this.setState({attachments:ga(this.state.attachments,[l({data:ub.get('bubble')['delete']('thumb-urls'),meta:ub.get('meta'),source:'places',type:q.SUGG}),ia(ub.get('quickreplies'))])});var bc=c('OzEditorStateHelpers').replaceLine(this.e(),ub.get('ui-body'));this._handleChange(bc);break;}}.bind(this));this.focusInput();},_handleAIItemClick:function tb(ub){this._handleAISelect(sa(this._AIItems(),ub));},_handleCreateReminder:function tb(ub){c('OzAPI').createReminder(this.tid(),l({body:ub.get('body'),'scheduled-time':ub.get('scheduled-time')}));},_handleCloseReminder:function tb(ub){c('OzAPI').closeReminder(this.tid(),ub.get('id')||ub.get('reminder-id'),false);},_handleCreateIntent:function tb(ub){c('OzAPI').createIntent(this.tid(),l({'wit-intent-uuid':ub.get('wit-intent-uuid'),name:ub.get('name'),metadata:ub.get('metadata'),params:ub.get('params'),actions:ub.get('actions'),notes:ub.get('notes'),requirements:ub.get('requirements')})).done(function(vb){c('OzHelpers').info('[composer/handleCreateIntent] created for:',c('OzHelpers').threadID(vb));this.context.router.push(c('OzHelpers').threadPath({threadid:c('OzHelpers').threadID(vb),intentid:vb.getIn(['intents',-1,'id'])}));}.bind(this));},_handleCloseIntent:function tb(ub){c('OzAPI').closeIntent(this.tid(),ub.get('id'));},_toHistory:function tb(){var ub=this.state.attachments,vb=ub.filter(function(xb){return xb.get('type')===q.SUGG;}),wb=this.getValue();k.push(JSON.stringify({bubbles:vb,text:wb}));},_fromHistory:function tb(ub){var vb=c('OzHelpers').safeParse(k[ub]()),wb=vb.bubbles,xb=vb.text;xb&&this._handleChange(c('OzEditorStateHelpers').replaceContentWithText(this.e(),xb));wb&&this.setState({attachments:m(wb).mapEntries(function(yb){return c('immutable').fromJS(yb);}).mapKeys(function(yb){return +yb;})});},_handleScheduleToggle:function tb(ub){var vb=this.state.schedule,wb=vb.timestamp||c('OzHelpers').serverNow();vb.shown===ub?null:this.setState({schedule:babelHelpers['extends']({},vb,{shown:ub,timestamp:wb})});},_handleScheduleTimeChange:function tb(ub){this.setState({schedule:babelHelpers['extends']({},this.state.schedule,ub)});},e:function tb(){return this.state.editorState;},t:function tb(){return this.props.thread;},tid:function tb(){return c('OzHelpers').threadID(this.t());}});function z(){var tb=new (c('CompositeDraftDecorator'))([{strategy:function ub(vb,wb){wa(vb.getText()).map(function(xb){return wb.apply(undefined,xb);});},component:ab},{strategy:c('getEntityMatcher')(function(ub){return ub.getType()==='EMOTICON';}),component:c('EmoticonSpan.react')}]);return c('EditorState').createEmpty(tb);}function aa(tb){return {shown:false,timestamp:null,timezone:c('OzHelpers').timezone(tb)};}function ba(tb){return {attachments:m(),editorState:z(),sendTyping:true,seedBubble:null,isAIOpen:false,lastAIPick:null,lastAIGuesses:null,schedule:aa(tb)};}var ca={};function da(tb){return ca[c('OzHelpers').threadID(tb)]||ba(tb);}function ea(tb,ub){var vb=babelHelpers['extends']({},ub);delete vb.bubbles;delete vb.activeThread;delete vb.config;vb.isAIOpen=false;ca[tb]=vb;}function fa(tb,ub,vb){var wb=ub.editorState.getCurrentContent().getPlainText(),xb=vb.editorState.getCurrentContent().getPlainText();wb!==xb&&c('OzHelpers').debug('[composer] changed from',wb,xb);if(vb.sendTyping){var yb=[wb,xb].map(function(bc){return !!bc.length;}),zb=yb[0],ac=yb[1];!zb&&ac&&c('OzAPI').typing(tb);zb&&!ac&&c('OzAPI').notTyping(tb);}ub.sendTyping&&!vb.sendTyping&&c('OzAPI').notTyping(tb);}function ga(tb,ub){!m.isOrderedMap(tb)?j(0):void 0;!Array.isArray(ub)?j(0):void 0;return tb.withMutations(function(vb){return ub.reduce(function(wb,xb){xb=xb.set('id',xb.get('id')||xb.hashCode());return wb.set(xb.get('id'),xb);},vb);});}function ha(){return c('immutable').fromJS({data:{currency:'USD'},type:q.SUGG});}function ia(tb){return c('immutable').fromJS({type:q.QUICK_REPLIES,data:tb?tb.map(function(ub){return l({id:ub,name:ub});}):n()});}function ja(tb){return tb.find(function(ub){return ub.get('type')===q.QUICK_REPLIES;});}function ka(tb){var ub=l(ja(tb)).get('data',n()).map(function(vb){return vb.get('name','').trim();}).filter(function(vb){return !!vb;});return ub.isEmpty()?null:{agent_quick_replies:ub.toArray()};}function la(tb,ub,vb){var wb=n(ub).filter(function(xb){return !!xb;});wb.isEmpty()?vb():c('OzActions').showDialog(c('OzConfirmDialog.react'),{body:wb.size===1?wb.first():c('React').createElement('ul',null,wb.map(function(xb,yb){return c('React').createElement('li',{key:yb},xb);})),confirmLabel:c('OzHelpers').toTitleCase(tb),header:'Are you sure you want to '+tb+' this message?',onConfirm:vb});}function ma(tb){var ub=l({hour:'numeric',minute:'numeric'}),vb=tb.getIn(['location','timezone-offset']),wb=c('OzHelpers').preferredName(tb),xb=c('OzHelpers').lastPresence(tb);if(vb&&!c('OzHelpers').isDaytime(vb)&&xb&&c('OzHelpers').serverNow()-xb>w)return (c('React').createElement('span',null,'It\'s ',c('React').createElement('strong',null,c('React').createElement(c('OzUpdateDateTime.react'),{locale:'en-US',options:ub,timezoneOffset:vb||0})),' at ',wb,'\'s last known location and they haven\'t interacted with us since ',c('React').createElement('strong',null,c('React').createElement(c('Timestamp.react'),{autoUpdate:true,time:xb/1000})),'.'));}function na(tb,ub){var vb=ub.get('activeIntent'),wb=vb&&tb.get('intents').find(function(xb){return xb.get('id')===vb;});if(!wb||wb.get('state')!=='open')return 'You should create an intent or select an open one so the AI can '+'learn from what you\'re sending.';}function oa(tb){var ub=n([[/ +/g,function(vb){return vb.length>1;},'a bunch of spaces in a row'],[/^ | $/gm,function(vb){return true;},'whitespace at the beginning or end of a line']]).map(function(vb){var wb=vb[0],xb=vb[1],yb=vb[2];return n(tb.match(wb)).some(xb)&&yb;}).filter(function(vb){return !!vb;});if(!ub.isEmpty())return (c('React').createElement('div',null,'Your text contains some weird formatting:',c('React').createElement('ul',null,ub.map(function(vb,wb){return c('React').createElement('li',{key:wb},vb);}))));}function pa(tb){return c('OzHelpers').hasCmdOrCtrl(tb)&&tb.which===66;}function qa(tb){return c('OzHelpers').hasCmdOrCtrl(tb)&&tb.which===191;}function ra(tb){return tb.getModifierState('Control')&&tb.which===78;}function sa(tb,ub){var vb=tb.get(ub.get('line'));return n.isList(vb)?vb.get(ub.get('column')):vb;}function ta(tb){return (c('KeyBindingUtil').hasCommandModifier(tb)&&tb.keyCode>=c('Keys').ZERO+1&&tb.keyCode<=c('Keys').ZERO+9);}function ua(tb,ub){var vb=ub.lastAIPick,wb=ub.lastAIGuesses,xb=wb||tb.get('guesses'),yb=c('OzHelpers').openIntents(tb).map(function(zb){return zb.filter(c('OzHelpers').keysIn('name','wit-intent-uuid'));});c('OzHelpers').debug('building ai usage',c('OzHelpers').threadID(tb));return l({gold:vb,guesses:xb,intents:yb});}var va=/(@\[[^\]]+\])/g;function wa(tb){var ub=void 0,vb=[];while(ub=va.exec(tb))vb.push([ub.index,ub.index+ub[0].length]);return vb;}function xa(tb){return '@['+tb+']';}function ya(tb){var ub=tb.getCurrentContent().getBlockMap().toSeq().map(function(xb){return [xb,wa(xb.getText())[0]];}).find(function(xb){var yb=xb[0],zb=xb[1];return !!zb;},null,[]),vb=ub[0],wb=ub[1];return vb&&wb?za.apply(undefined,[vb.getKey()].concat(wb)):null;}function za(tb,ub,vb){return new (c('SelectionState'))({anchorKey:tb,focusKey:tb,anchorOffset:ub,focusOffset:vb,hasFocus:true,isBackward:false});}var ab=c('OzHelpers').pure(function(tb){var ub=tb.offsetKey,vb=tb.children;return (c('React').createElement('span',{'data-offset-key':ub,className:"_a5n"},vb));});function bb(tb,ub,vb,wb,xb,yb){var zb=db(ub,xb,yb),ac=cb(ub,zb,vb,xb,wb,yb),bc=ac.groupBy(function(ec){return ec.get('ui-scheduled')?'scheduled':ec.get('type')===q.SUGG?q.SUGG:'rest';}),cc=bc.get('rest',n()).push(bc.get(q.SUGG)).filter(function(ec){return !!ec;}),dc=bc.get('scheduled',n());if(!tb){return dc.isEmpty()?n():n().push(dc);}else if(dc.isEmpty()){return cc;}else return cc.push(dc);}function cb(tb,ub,vb,wb,xb,yb){var zb=ub.filter(function(cc){return cc.get('type')==q.SUGG;}).take(25),ac=ub.filter(function(cc){return cc.get('type')!=q.SUGG;}).concat(sb(tb,yb)).take(5),bc=zb.concat(ac);return (mb(xb,yb).takeLast(1).concat(bc).concat(kb(vb,yb)).concat(fb(tb,wb,yb)));}function db(tb,ub,vb){return (tb.get('guesses')||n()).flatMap(function(wb){return wb.get('items')||[wb].map(function(xb){return xb.merge(l({position:wb.get('position'),confidence:wb.get('confidence'),'class':wb.get('class')}));});}).map(function(wb){switch(wb.get('type')){case q.TEMPLATE:var xb=nb(tb,wb.get('body'));return eb(wb)||rb(xb,vb)?wb.set('ui-body',xb):null;case 'bubble':return eb(wb)||qb(wb.get('data'),vb)?c('OzSuggestions').toServer(wb,ub):null;case 'close-intent':return hb(tb,wb);case 'create-intent':return gb(tb,wb);case 'close-reminder':return ib(tb,wb);case 'reminder':var yb=wb.getIn(['body','description']),zb=wb.get('scheduled-time'),ac=c('formatDate')(zb/1000,'g:ia M j');return l({type:q.COMMAND,action:v.CREATE_REMINDER,text:'Create Reminder for '+ac+': "'+yb+'"',iconCl:"_3e_w",body:wb.get('body'),'scheduled-time':zb});}}).filter(function(wb){return !!wb;});}function eb(tb){return !!(tb.get('id')&&tb.get('at'));}function fb(tb,ub,vb){return (tb.get('events')||n()).concat(tb.get('scheduled')||n()).toSeq().map(function(wb){switch(wb.get('type')){case 'send':return wb.set('ui-body',wb.getIn(['data','text']));case 'suggest':return wb.set('type',q.SUGG).set('data',wb.getIn(['data','suggestion'])).updateIn(['data','merchant-name'],function(xb){return c('OzSuggestions').findMerchantName(xb,ub);});case 'create-intent':return gb(tb,wb.get('data')).set('id',wb.get('id'));case 'close-intent':return hb(tb,wb.get('data')).set('id',wb.get('id'));case 'close-reminder':return ib(tb,wb.get('data')).merge({id:wb.get('id'),at:wb.get('at')});case 'create-reminder':return jb(tb,wb.get('data')).set('id',wb.get('id'));case q.SURVEY:case q.TEMPLATE:return wb.set('ui-body',nb(tb,wb.getIn(['data','body'])));case 'bubble':return c('OzSuggestions').toServer(wb.get('data'),ub).setIn(['data','amount'],+wb.getIn(['data','data','price'])).set('id',wb.get('id'));case 'send-calendar':return wb.set('type',q.SUGG).set('data',l({name:wb.getIn(['data','title']),description:c('OzHelpers').toLocaleDate(wb.getIn(['data','start'])),'merchant-name':'Invite bubble'}));default:c('OzHelpers').debug('[oz-scheduled], unk scheduled',wb);}}).filter(function(wb){return !!wb;}).map(function(wb){return wb.set('ui-scheduled',true);}).sortBy(function(wb){return wb.get('at');});}function gb(tb,ub){var vb=ub.get('name');return ub.set('type',q.COMMAND).set('action',v.CREATE_INTENT).set('text','Create intent '+vb).set('iconCl',"_3e_w");}function hb(tb,ub){var vb=ub.get('id'),wb=tb.get('intents').findLast(function(yb){return yb.get('id')===vb;}),xb=wb?wb.get('alias')||wb.get('name'):ub.get('source');return ub.set('type',q.COMMAND).set('action',v.CLOSE_INTENT).set('text','Close intent '+xb).set('iconCl',"_3e_w");}function ib(tb,ub){var vb=ub.get('id')||ub.get('reminder-id'),wb=tb.get('reminders').findLast(function(yb){return yb.get('id')===vb;}),xb=wb?wb.getIn(['body','description']):ub.get('source');return ub.set('type',q.COMMAND).set('action',v.CLOSE_REMINDER).set('text','Close reminder '+xb).set('iconCl',"_3e_w");}function jb(tb,ub){var vb=ub.getIn(['body','description']);return ub.set('type',q.COMMAND).set('action',v.CREATE_REMINDER).set('text','Create reminder '+vb).set('iconCl',"_3e_w");}function kb(tb,ub){return c('immutable').fromJS([{type:q.COMMAND,action:v.CREATE_BUBBLE,text:'Create Bubble',iconCl:"_3e_w",shortcut:'B'},!ja(tb)&&lb()]).filter(function(vb){return vb&&rb(vb.get('text'),ub);});}function lb(){if(c('OzConfig').getInStaticConfig(['GK','quickReplies']))return {type:q.COMMAND,action:v.ADD_QUICK_REPLIES,text:'Add Quick Replies',iconCl:"_3e_w",shortcut:'/'};}function mb(tb,ub){var vb=tb.filter(function(wb){return qb(wb,ub);});return (vb.isEmpty()?tb:vb).toList();}function nb(tb,ub){if(typeof ub==='string')return ub;return ub&&ub.map(function(vb){if(typeof vb==='string')return vb;return pb(tb,vb);}).toJS().join('');}function ob(tb){var ub=tb.get('index');return xa(tb.get('type')+(ub?' '+ub:''));}function pb(tb,ub){if(ub.get('type')===r.USER_FIRST_NAME)return c('OzHelpers').preferredName(tb);return ob(ub);}function qb(tb,ub){var vb=tb.get('data',l());return rb(vb.get('name','')+'\n     '+vb.get('description','')+'\n     '+vb.get('target-url',''),ub);}function rb(tb,ub){return tb&&tb.toLowerCase().indexOf((ub||'').toLowerCase())>-1;}function sb(tb,ub){var vb=function yb(zb){return nb(tb,zb[Math.floor(zb.length*Math.random())]);},wb='\uD83D\uDC64',xb=n([nb(tb,c('immutable').fromJS([{type:r.USER_FIRST_NAME}])),[wb+' Who are you?',function(){return vb(["My name is M! I'm your personal assistant in Messenger.","My name is M! I'm your personal assistant. I can help you with things like making reservations, finding the perfect gift or planning your next vacation.","My name is M! I'm your personal assistant in Messenger. I'm here to help you do things better and faster.","My name is M! I'm here to help make your life easier."]);}],[wb+' What can you do for me?',function(){return vb(["I can help you with lots of things, like figuring out where to go to dinner, finding a great gift for someone, or planning your weekend. Just ask!","I can help you with lots of things. Just ask and I'll let you know if it's something I can't do.","In general, I can help you with anything that's not illegal. Just ask and I'll let you know if there's something I can't do."]);}],['Sent the wrong info',function(){return 'Sorry! It looks like I sent you the wrong info. @[Right info]';}],[wb+' How did you pick this?',function(){return "I look at a variety of things and try to find the info that's best for you. Would you like me to send you some other options?";}],[wb+' What does M stand for?',function(){return vb(["M is just my name! ","Just M!","I'm just M, like Messenger."]);}],[wb+' Do you have a partnership with X?',function(){return "No, I just try to find the best info for you. Do you want me to send you some other options?";}],["Storing contact info",function(){return vb(["Thanks! I'll remember this for next time."]);}],["Don't have an opinion",function(){return "I don't have an opinion about that, but...@[point to resources]";}],['Not my area of expertise',function(){return "I'm not a @[lawyer, financial adviser, etc.] so I can't give you @[legal, financial, etc.] advice, but I can do some research for you. ";}],[wb+' What\'s your favorite sticker?',function(){return vb(["I can't pick a favorite!","They're all great!","I love all of the stickers equally!"]);}],["General redirect",function(){return "I'm not really sure how to answer that, but can I help you with something else?";}],["Bugs redirect",function(){return "You can actually report things like this right from Facebook. Here's how: https://www.facebook.com/help/326603310765065/ ";}],["Facebook support redirect",function(){return vb(["I'm not an expert, so I'd recommend checking out the Help Center: www.facebook.com/help (http://www.facebook.com/)","I'm not an expert in that, so I'd recommend going here: www.facebook.com/help (http://www.facebook.com/)"]);}],[wb+' What languages do you support?',function(){return "Right now I can only chat in English. Sorry for the inconvenience!";}],["Trolling (abusing M/the agents)",function(){return vb(["Is there anything I can help you with?","Unfortunately I won't be able to chat with you if you say things like that."]);}],["Generic don't support message",function(){return vb(["Unfortunately I can't do that. Is there anything else I can help you with?","Unfortunately I can't help you with that. @[Sorry for the inconvenience.] Is there anything else I can do for you?","Unfortunately I can't support this type of request. Is there anything else I can help you with?"]);}],[wb+' What are you? Are you human?',function(){return vb(["I'm M! I use artificial intelligence, but people help train me to so I'll get better and better over time.","I'm M! I use artificial intelligence, but people help train me."]);}],[wb+' What gender are you?',function(){return "I don't have a gender. I'm just M.";}],[wb+' How old are you?',function(){return "I don't have an age. Maybe 42?";}],[wb+' Who made you? Where did you come from?',function(){return vb(["I was designed by the Messenger Team.","I was created by the Messenger Team."]);}],[wb+' What do you look like?',function(){return "That's me in the picture next to this message.";}],[wb+' Can you talk or just type?',function(){return "I can send you messages here in Messenger. ";}],[wb+' Where do you live?',function(){return "Right here in Messenger.";}],[wb+' Can you call/message/email my friend?',function(){return "Unfortunately I can't do that. Is there anything else I can help you with?";}],["Medical redirect",function(){return "Unfortunately I can't support this type of request right now. Is there anything else I can help you with?";}],"I'm a little busier than usual right now. I want to give you my full attention, so I'll get back to you as soon as I can. In the meantime, feel free to send me any extra info about your request.","I'm on it!",["You're welcome.",function(){return vb(["You're welcome.","You're welcome! Let me know if there's anything else I can help you with.","You're welcome! Let me know if you need anything else.","You're welcome! Let me know if I can help you with anything else."]);}],["Anything else",function(){return vb(["Let me know if there's anything else I can help you with.","Let me know if I can help with anything else.","Great! Let me know if there's anything else I can help you with.","Let me know if there's anything else I can help you with today."]);}],"How does this look?",["I'm on it",function(){return vb(["Sure, I'm on it!","I'll look into that for you.","I'll look into that for you!","I'll do some research."]);}],"How can I help you today?","How about this?","Is this what you're looking for?","I'll take care of it!","What email should I use for the invite?","Where should I send the invite?","When would you like to dine and how many people will be joining you?",["Save phone number",vb(["Would you like me to save your phone number for future requests?","What phone number would you like me to use for the reservation?"])],"Do you have a price range in mind?","Here are some options:"]).map(function(yb){return (Array.isArray(yb)?l({'ui-body':yb[0],type:q.TEMPLATE,f:yb[1]}):l({'ui-body':yb,type:q.TEMPLATE}));}).filter(function(yb){return rb(yb.get('ui-body'),ub);});return xb;}f.exports=c('OzWrapper.react')(y);}),null);
__d('OzCheckboxInput.react',['cx','invariant','AbstractCheckboxInput.react','OzImmutablePureRenderMixin','React','joinClasses'],(function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('React').createClass({displayName:'OzCheckboxInput',mixins:[c('OzImmutablePureRenderMixin')],render:function k(){return (c('React').createElement(c('AbstractCheckboxInput.react'),babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,"_55sg _4k1t"),onChange:this._handleChange})));},_handleChange:function k(l){var m=l.target;!(m instanceof HTMLInputElement)?i(0):void 0;this.props.onChange&&this.props.onChange(m.checked);}});f.exports=j;}),null);
__d('OzMessageFeedbackDialog.react',['cx','invariant','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','InputLabel.react','OzButton.react','OzCheckboxInput.react','React','StarsInput.react','XUIContextualDialog.react','XUIContextualDialogBody.react'],(function a(b,c,d,e,f,g,h,i){'use strict';var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes,m=['Poor','Average','Great'];j=babelHelpers.inherits(n,c('React').Component);k=j&&j.prototype;function n(){var o,p;for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return o=(p=k.constructor).call.apply(p,[this].concat(r)),this.$OzMessageFeedbackDialog1=function(){var t=this.props.onFollowedPolicyChange;t&&t(true);}.bind(this),this.$OzMessageFeedbackDialog2=function(){var t=this.props.onFollowedPolicyChange;t&&t(false);}.bind(this),this.$OzMessageFeedbackDialog3=function(t){!(t.target instanceof HTMLTextAreaElement)?i(0):void 0;this.props.onFeedbackChange(t.target.value);}.bind(this),o;}n.prototype.render=function(){return c('React').createElement(c('XUIContextualDialog.react'),{behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll')},contextRef:this.props.contextRef,shown:true},c('React').createElement(c('XUIContextualDialogBody.react'),{className:"_5dx"},c('React').createElement('div',{className:"_5333"},c('React').createElement('div',{className:"_5334"},c('React').createElement('div',null,c('React').createElement('h3',null,'Tone'),c('React').createElement(c('StarsInput.react'),{count:this.props.toneRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onToneRatingChange,starLabels:m}),c('React').createElement('h3',null,'Execution'),c('React').createElement(c('StarsInput.react'),{count:this.props.executionRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onExecutionRatingChange,starLabels:m}))),c('React').createElement('div',{className:"_5335"},c('React').createElement('div',null,c('React').createElement('h3',null,'Responsiveness'),c('React').createElement(c('StarsInput.react'),{count:this.props.responsivenessRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onResponsivenessRatingChange,starLabels:m}),c('React').createElement('h3',null,'Console'),c('React').createElement(c('StarsInput.react'),{count:this.props.consoleRating,large:true,allowMultipleSubmissions:true,onClick:this.props.onConsoleRatingChange,starLabels:m})))),c('React').createElement('div',null,c('React').createElement('h3',null,'Followed Policy'),c('React').createElement('div',null,c('React').createElement(c('InputLabel.react'),null,c('React').createElement(c('OzCheckboxInput.react'),{checked:this.props.followedPolicy===true,onChange:this.$OzMessageFeedbackDialog1}),c('React').createElement('label',null,'Yes')),c('React').createElement(c('InputLabel.react'),null,c('React').createElement(c('OzCheckboxInput.react'),{checked:this.props.followedPolicy===false,onChange:this.$OzMessageFeedbackDialog2}),c('React').createElement('label',null,'No'))),c('React').createElement('h3',null,'Message'),c('React').createElement('div',{className:"_5336"},c('React').createElement('textarea',{maxLength:'2500',value:this.props.feedback,onChange:this.$OzMessageFeedbackDialog3,placeholder:'Give more details here'}))),c('React').createElement('div',{className:"_5dy"},c('React').createElement(c('OzButton.react'),{onClick:this.props.onClose},'Cancel'),c('React').createElement(c('OzButton.react'),{className:"_5dz",onClick:this.props.onSave,primary:true},'Save'))));};n.propTypes={contextRef:l.func.isRequired,executionRating:l.oneOf([0,1,2,3]),followedPolicy:l.bool,onClose:l.func,onExecutionRatingChange:l.func,onFollowedPolicyChange:l.func,onResponsivenessRatingChange:l.func,onConsoleRatingChange:l.func,onSave:l.func,onToneRatingChange:l.func,responsivenessRating:l.oneOf([0,1,2,3]),consoleRating:l.oneOf([0,1,2,3]),toneRating:l.oneOf([0,1,2,3])};f.exports=n;}),null);
__d('OzMessageFeedback.react',['cx','joinClasses','immutable','ReactLayeredComponentMixin_DEPRECATED','OzMessageFeedbackDialog.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('immutable').Map,l=c('React').PropTypes,m='feedback_dialog',n='no_dialog',o=c('React').createClass({displayName:'OzMessageFeedback',mixins:[c('ReactLayeredComponentMixin_DEPRECATED'),c('OzImmutablePureRenderMixin')],propTypes:{message:l.instanceOf(k).isRequired,onSave:l.func.isRequired},getInitialState:function s(){return babelHelpers['extends']({currentDialog:n},q(this.props.message));},componentWillReceiveProps:function s(t){if(t.message!==this.props.message)this.setState(q(t.message));},render:function s(){var t=this.state.currentDialog,u=r(this.state);return (c('React').createElement('div',{className:"_2bxa"+(' '+"_2bxb")+(u?' '+"_2bxc":'')+(t!==n?' '+"_2bxd":'')},c('React').createElement(p,{className:"_2bxf",onClick:function(v){return this.setState({currentDialog:m});}.bind(this),isActive:u||t===m,ref:'flag'})));},renderLayers:function s(){switch(this.state.currentDialog){case m:return {contextualDialog:this._renderFeedbackDialog()};default:return null;}},_renderFeedbackDialog:function s(){return (c('React').createElement(c('OzMessageFeedbackDialog.react'),{contextRef:function(){return this.refs.flag;}.bind(this),executionRating:this.state.executionRating,followedPolicy:this.state.followedPolicy,onClose:this._handleDialogClose,onExecutionRatingChange:function(t){this.setState({executionRating:t});}.bind(this),onFollowedPolicyChange:function(t){this.setState({followedPolicy:t});}.bind(this),onResponsivenessRatingChange:function(t){this.setState({responsivenessRating:t});}.bind(this),onSave:this._handleFeedbackSave,onToneRatingChange:function(t){this.setState({toneRating:t});}.bind(this),onConsoleRatingChange:function(t){this.setState({consoleRating:t});}.bind(this),responsivenessRating:this.state.responsivenessRating,toneRating:this.state.toneRating,consoleRating:this.state.consoleRating,feedback:this.state.feedback,onFeedbackChange:function(t){this.setState({feedback:t});}.bind(this)}));},_handleFeedbackSave:function s(){this.props.onSave(k({execution:this.state.executionRating,'followed-policy':this.state.followedPolicy,mid:this.props.message.get('mid'),'offline-threading-id':this.props.message.get('offline-threading-id'),responsiveness:this.state.responsivenessRating,tone:this.state.toneRating,feedback:this.state.feedback,'console-proficiency':this.state.consoleRating}));this._handleDialogClose();},_handleDialogClose:function s(){this.setState({currentDialog:n});}});i=babelHelpers.inherits(p,c('React').Component);j=i&&i.prototype;p.prototype.render=function(){'use strict';var s=this.props,t=s.className,u=s.onClick,v=s.isActive;return (c('React').createElement('button',{role:'button',className:c('joinClasses')("_1-hv"+(' '+"_2bxi")+(v?' '+"_2bxj":''),t),onClick:u}));};function p(){'use strict';i.apply(this,arguments);}function q(s){return {executionRating:s.get('execution'),feedback:s.get('feedback'),followedPolicy:s.get('followed-policy'),responsivenessRating:s.get('responsiveness'),toneRating:s.get('tone'),consoleRating:s.get('console-proficiency')};}function r(s){return !!(s.executionRating||s.followedPolicy!==undefined||s.responsivenessRating||s.toneRating||s.consoleRating);}f.exports=o;}),null);
__d('OzMessageQuickReplies.react',['cx','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','React','XUICloseButton.react','immutable','XUIContextualDialog.react','XUIContextualDialogBody.react','ReactLayeredComponentMixin_DEPRECATED','OzImmutablePureRenderMixin'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('immutable').Map,k=c('immutable').List,l=c('React').createClass({displayName:'OzMessageQuickReplies',mixins:[c('ReactLayeredComponentMixin_DEPRECATED'),c('OzImmutablePureRenderMixin')],propTypes:{message:i.instanceOf(j).isRequired},getInitialState:function n(){return babelHelpers['extends']({displayDialog:false},m(this.props.message));},render:function n(){return (c('React').createElement('div',{className:"_g8_"},c('React').createElement('button',{className:"_1-hv _g90 _g91",onClick:function(o){return (this.setState({displayDialog:!this.state.displayDialog}));}.bind(this),ref:'flag'})));},renderLayers:function n(){if(this.state.displayDialog){return {contextualDialog:this._renderQRDialog()};}else return null;},_renderQRDialog:function n(){return (c('React').createElement(c('XUIContextualDialog.react'),{behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll')},contextRef:function(){return this.refs.flag;}.bind(this),shown:true},c('React').createElement(c('XUIContextualDialogBody.react'),null,c('React').createElement('div',{className:"_g92"},c('React').createElement('div',{className:"_g93"},c('React').createElement('ul',null,this.state.quickReplies.map(function(o){return c('React').createElement('li',{key:o},o);}))),c('React').createElement(c('XUICloseButton.react'),{onClick:function(o){return this.setState({displayDialog:false});}.bind(this)})))));}});function m(n){return {quickReplies:n.getIn(['generic-metadata','agent_quick_replies'],k())};}f.exports=l;}),null);
__d('OzInboxMessage.react',['cx','OzAPI','OzHelpers','immutable','OzActions','OzConfig','OzConstants','OzMessage.react','OzMessageFeedback.react','OzMessageQuickReplies.react','OzImmutablePureRenderMixin','React','Reflux'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('OzConstants').AUTHOR_TYPES,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzInboxMessage',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{authorType:k.oneOf(c('OzHelpers').values(j)),isActive:k.bool.isRequired,message:k.instanceOf(i).isRequired,threadID:k.string.isRequired},render:function m(){var n=this.props,o=n.message,p=n.authorType,q=n.threadID,r=n.isActive,s=!!o.get('author'),t=c('OzConfig').ConfigStore.data.getIn(['GK','displayQR'])&&!!o.getIn(['generic-metadata','agent_quick_replies']),u=this.state.config;return (c('React').createElement('div',{className:"clearfix"+(' '+"_4y6j")+(r?' '+"_4qv0":'')+(p===j.TRAINER?' '+"_2ij4":'')+(p===j.BOT?' '+"_2ij5":'')+(p===j.USER?' '+"_2p0":'')+(u.getIn(['GK','supervisor'])?' '+"_1w52":'')},c('React').createElement('div',{className:"_2pf"},c('React').createElement(c('OzMessage.react'),{message:o}),p===j.USER?c('React').createElement('button',{onClick:function v(){return c('OzActions').intentCreator.toggle();},className:"_1-hv _30yy _4nd4 _ftb"}):null),t?c('React').createElement(c('OzMessageQuickReplies.react'),{message:o}):null,s?c('React').createElement(c('OzMessageFeedback.react'),{message:o,onSave:function v(w){return c('OzAPI').updateMessage(q,w);}}):null));}});f.exports=l;}),null);
__d('OzInboxMessageGroup.react',['cx','OzHelpers','immutable','OzConfig','OzConstants','OzDate.react','OzInboxMessage.react','OzUserImage.react','OzImmutablePureRenderMixin','React','Reflux','Tooltip'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('React').PropTypes,k=c('OzConstants').AUTHOR_TYPES,l=c('React').createClass({displayName:'OzInboxMessageGroup',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{activeMsgID:j.string,authorID:j.string,authorType:j.oneOf(c('OzHelpers').values(k)),execTime:j.number,intentID:j.number,messages:j.array.isRequired,repNames:j.instanceOf(i).isRequired,thread:j.object.isRequired,timestamp:j.number.isRequired},scrollMessageIntoViewIfNeeded:function n(o){var p=this.refs[o];p?p.scrollIntoViewIfNeeded():c('OzHelpers').error('[inboxgroup] message id '+o+' not in group');},render:function n(){return (c('React').createElement('div',{className:"_528w"},this._renderGroup()));},_renderGroup:function n(){var o=this.props.authorType,p=k.BOT,q=k.TRAINER,r=k.USER;switch(o){case q:case p:return (c('React').createElement('div',{className:(o===p?"_4m3p":'')+(o===q?' '+"_4m3r":'')},this._renderMessages(),this._renderBottomMeta()));case r:return (c('React').createElement('div',{className:"_4m3u"},c('React').createElement('div',{className:"_2wyu"},this._renderPhoto()),c('React').createElement('div',{className:"_2wyv"},this._renderMessages(),this._renderBottomMeta())));default:c('OzHelpers').error('got unk author type',this.props);return null;}},_renderPhoto:function n(){var o=c('OzHelpers').photo(this.props.thread),p=c('OzHelpers').getName(this.props.thread),q=c('OzHelpers').lastPresence(this.props.thread),r=c('OzDate.react').formatTimestamp(q);return (c('React').createElement('div',{className:"_528y"},c('React').createElement('span',c('Tooltip').propsFor('Seen by '+p+' at '+r,'left'),c('React').createElement(c('OzUserImage.react'),{photo:o}))));},_renderSeen:function n(){return (c('React').createElement('div',{className:"_40ue"},this._renderPhoto()));},_renderMessages:function n(){var o=this.props,p=o.messages,q=o.authorType,r=o.thread,s=o.activeMsgID;return (c('React').createElement('div',{className:"_528z"},p.map(function(t){return (c('React').createElement('div',{key:c('OzHelpers').msgID(t),ref:c('OzHelpers').msgID(t)},c('React').createElement(c('OzInboxMessage.react'),{authorType:q,isActive:c('OzHelpers').msgID(t)===s,message:t,threadID:c('OzHelpers').threadID(r)}),t.get('ui-seen')?this._renderSeen():null));}.bind(this))));},_renderBottomMeta:function n(){var o=this.props,p=o.authorID,q=o.execTime,r=o.intentID,s=o.repNames,t=o.thread,u=o.timestamp;return (c('React').createElement('div',{className:"_4m3v"},c('React').createElement('div',null,c('React').createElement('span',{className:"_4m3w"},s.get(p)||p||null),c('React').createElement(c('OzDate.react'),{className:"_4m3x",timestamp:u})),this.state.config.getIn(['GK','responsivenessExecTime'])&&r!=null&&q!=null&&c('React').createElement('div',{className:"_5sme"},c('React').createElement('span',c('Tooltip').propsFor(m(c('OzHelpers').intentById(t,r)),'below'),'I'),' + ',c('OzHelpers').durationStr(q))));}});function m(){var n=arguments.length<=0||arguments[0]===undefined?i():arguments[0],o=n.get('name'),p=n.get('alias');return p&&o?p+' ('+o+')':p||o||'[unknown intent]';}f.exports=l;}),null);
__d('OzInboxMessageList.react',['cx','OzHelpers','immutable','OzConstants','OzInboxMessageGroup.react','OzLoading.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('immutable').Map,l=c('React').PropTypes,m=c('OzLoading.react').Inline,n=20;i=babelHelpers.inherits(o,c('React').Component);j=i&&i.prototype;function o(){var u,v;'use strict';for(var w=arguments.length,x=Array(w),y=0;y<w;y++)x[y]=arguments[y];return u=(v=j.constructor).call.apply(v,[this].concat(x)),this.scrollToMessage=function(z){return k(this.refs).find(function(aa){return aa.props.messages.some(function(ba){return c('OzHelpers').msgID(ba)===z;});}).scrollMessageIntoViewIfNeeded(z);}.bind(this),this.$OzGroupList1=function(z,aa){var ba=this.props.thread,ca=z[0],da=z[z.length-1],ea=ca.get('sender'),fa=ca.get('author'),ga=ca.get('timestamp'),ha=da.get('timestamp'),ia=da.get('intent-id'),ja=da.get('executional-time'),ka=ea+ga;return (c('React').createElement(c('OzInboxMessageGroup.react'),{authorID:fa,authorType:c('OzHelpers').authorType(ca),activeMsgID:this.props.activeMsgID,execTime:ja,intentID:ia,key:ka,messages:z,ref:ka,repNames:this.props.repNames,thread:ba,timestamp:ha}));}.bind(this),u;}o.prototype.shouldComponentUpdate=function(u,v){'use strict';return !(this.props.activeMsgID===u.activeMsgID&&c('immutable').is(this.props.thread,u.thread)&&c('immutable').is(this.props.repNames,u.repNames)&&c('immutable').is(this.props.messages,u.messages));};o.prototype.render=function(){'use strict';var u=this.props.messages.reduceRight(r.bind(null,this.props.thread),{groupsList:[],nextTimestamp:null}).groupsList.map(this.$OzGroupList1);return c('React').createElement('frag',null,u);};o.propTypes={activeMsgID:l.string,messages:l.instanceOf(k).isRequired,repNames:l.instanceOf(k).isRequired,thread:l.instanceOf(k).isRequired};var p=c('React').createClass({displayName:'OzInboxMessageList',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{activeMsgID:l.string,clientLimit:l.number.isRequired,loading:l.bool.isRequired,messages:l.instanceOf(k).isRequired,onScrollTop:l.func.isRequired,repNames:l.instanceOf(k).isRequired,thread:l.instanceOf(k).isRequired},componentDidMount:function u(){c('OzHelpers').scrollToBottom(this.refs.scrollable);},componentWillUpdate:function u(){this._wasScrolledToBottom=t(this.refs.scrollable);this._originalScrollHeight=this.refs.scrollable.scrollHeight;this._originalScrollTop=this.refs.scrollable.scrollTop;this._originalActiveMsgID=this._visiblyActiveMsgID();},componentDidUpdate:function u(v){var w=this._visiblyActiveMsgID();if(w&&w!==this._originalActiveMsgID){c('OzHelpers').debug('[messagelist] scrolling to active msg id '+w);this.refs.groupList.scrollToMessage(w);}else if(this._wasScrolledToBottom||s(v.messages,this.props.messages)||c('OzHelpers').threadID(v.thread)!==c('OzHelpers').threadID(this.props.thread)){c('OzHelpers').debug('[messagelist] scrolling bottom');c('OzHelpers').scrollToBottom(this.refs.scrollable);}else{var x=this.refs.scrollable.scrollHeight-this._originalScrollHeight+this._originalScrollTop;this.refs.scrollable.scrollTop=x;}},resize:function u(){this.componentDidUpdate(this.props);},_visibleMessages:function u(){var v=this.props,w=v.messages,x=v.clientLimit;return w.takeLast(x);},_visiblyActiveMsgID:function u(){var v=this.props.activeMsgID,w=this._visibleMessages();if(w.some(function(x){return c('OzHelpers').msgID(x)===v;}))return v;if(v)c('OzHelpers').debug('[messagelist] msg '+v+' not visible',w.toJS());return null;},render:function u(){var v=this.props,w=v.loading,x=v.sending,y=v.thread;return (c('React').createElement('div',{onScroll:this._handleScroll,className:"_4fj7",ref:'scrollable'},c('React').createElement(m,{loading:w}),c('React').createElement(o,{activeMsgID:this.props.activeMsgID,thread:y,messages:this._visibleMessages(),ref:'groupList',repNames:this.props.repNames}),c('React').createElement(m,{loading:x})));},_handleScroll:function u(){if(this.refs.scrollable.scrollTop<n)this.props.onScrollTop();}});function q(u,v,w){var x=u.get('timestamp'),y=function aa(ba){var ca=ba>=x,da=!w||ba<w;return ca&&da;},z=v.get('last-seen');if(y(z))u=u.set('ui-seen',true);return u;}function r(u,v,w){var x=v.groupsList,y=v.nextTimestamp;w=q(w,u,y);var z=w.get('author'),aa=w.get('timestamp'),ba=c('OzHelpers').authorType(w),ca=x[0],da=ca&&ca[ca.length-1],ea=da&&da.get('author'),fa=da?da.get('timestamp'):Infinity,ga=da&&c('OzHelpers').authorType(da);if(ea!==z||fa-aa>60000||ga!==ba){x.unshift([w]);}else ca.unshift(w);return {groupsList:x,nextTimestamp:aa};}function s(u,v){var w=u.last(),x=v.last();return x.get('timestamp')>w.get('timestamp');}function t(u){return u.scrollHeight-u.scrollTop===u.clientHeight;}f.exports=p;}),null);
__d('OzIntentDropdown.react',['cx','Promise','immutable','OzSearchSource','React','SearchableDropdownInput.contrib','SearchableEntry'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('immutable').Map,l=c('immutable').List,m=c('React').PropTypes;i=babelHelpers.inherits(n,c('React').PureComponent);j=i&&i.prototype;n.prototype.componentWillMount=function(){'use strict';this.$OzIntentDropdown1=new (c('OzSearchSource'))(function(s){var t=s.query;return c('Promise').resolve(o(t,this.props.witIntents));}.bind(this));};n.prototype.componentDidMount=function(){'use strict';var s=this.refs.dropdown;s&&s.focusInput();};n.prototype.render=function(){'use strict';var s=this.props,t=s.onSelect,u=s.selected;return (c('React').createElement('div',{className:"_5yeg"},c('React').createElement(c('SearchableDropdownInput.contrib'),{ref:'dropdown',listClassName:"_2sg3",searchSource:this.$OzIntentDropdown1,value:u?r(u):null,onSelect:function v(w){return t(q(w));},placeholder:'Pick Intent',showSelectedSubtitle:false})));};function n(){'use strict';i.apply(this,arguments);}n.propTypes={selected:m.instanceOf(k),witIntents:m.instanceOf(k).isRequired,onSelect:m.func.isRequired};function o(s,t){var u=function v(w){return w.map(r).toArray();};if(!s)return u(t.take(10));return u(p(t,s).take(10));}function p(s,t){var u=function w(x){return (x||'').toLowerCase().indexOf(t)>=0;},v=s.groupBy(function(w){return u(w.get('name'))?'with-name':'other';});return (v.get('with-name')||l()).concat((v.get('other')||l()).filter(function(w){return u(w.get('doc'));}));}function q(s){return k({name:s.getTitle(),doc:s.getSubtitle(),id:s.getUniqueID()});}function r(s){return new (c('SearchableEntry'))({title:s.get('name'),subtitle:s.get('doc'),uniqueID:s.get('id')});}f.exports=n;}),null);
__d('OzIntentCreator.react',['cx','OzAPI','OzHelpers','immutable','Keys','OzNotify','OzActions','OzDraggable.react','OzIntentDropdown.react','ReactComponentWithPureRenderMixin','React','Reflux'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Record,j=c('immutable').Map,k=c('React').PropTypes,l=i({shown:false,selected:null}),m=c('Reflux').createStore({init:function t(){this.data=l();this.listenToMany(c('OzActions').intentCreator);},getInitialState:function t(){return this.data;},onSelect:function t(u){this._u(function(v){return v.set('selected',u);});},toggle:function t(){this._u(function(u){return u.update('shown',function(v){return !v;});});},clear:function t(){this._u(function(u){return l();});},_u:function t(u){this.data=u(this.data);this.trigger(this.data);}}),n=c('React').createClass({displayName:'OzIntentCreator',mixins:[c('Reflux').connect(m,'store'),c('ReactComponentWithPureRenderMixin')],propTypes:{witIntents:k.instanceOf(j).isRequired,thread:k.instanceOf(j).isRequired},contextTypes:{router:k.object.isRequired},componentDidMount:function t(){document.addEventListener('keydown',this._handleKBShortcuts);this._unlisten=function(){document.removeEventListener('keydown',this._handleKBShortcuts);}.bind(this);},componentWillUnmount:function t(){this._unlisten();},render:function t(){if(!this.state.store.get('shown'))return null;var u=this.props.witIntents;return (c('React').createElement(c('OzDraggable.react'),{className:"_1l0z"},c('React').createElement('div',{className:"_1l0-"},c('React').createElement('div',{className:"_1l0_"},c('React').createElement('div',{className:"_1l10"},'Intent'),c('React').createElement('div',{className:"_1l11"},c('React').createElement(c('OzIntentDropdown.react'),{witIntents:u.filterNot(q),selected:this._selected(),onSelect:c('OzActions').intentCreator.select}))),c('React').createElement('div',{className:"_1l14"},c('React').createElement(o,{color:'blue',onClick:this._handleSave},'Save'),c('React').createElement(o,{color:'grey',onClick:c('OzActions').intentCreator.clear},'Cancel')))));},_selected:function t(){var u=this.state.store.get('selected'),v=this.props.thread.get('intent-diag');return u||p(v,this.props.witIntents);},_handleSave:function t(){var u=this._selected(),v=this.props.thread;if(!u){c('OzNotify').error('You need to pick an intent!');return;}c('OzActions').intentCreator.clear();c('OzAPI').createIntent(c('OzHelpers').threadID(v),r(u,v.get('intent-diag'))).done(function(w){this.context.router.push(c('OzHelpers').threadPath({threadid:c('OzHelpers').threadID(w),intentid:w.getIn(['intents',-1,'id'])}));}.bind(this));},_handleKBShortcuts:function t(u){var v=this.state.store.get('shown');if(s(u)||u.which===c('Keys').ESC&&v){u.preventDefault();c('OzActions').intentCreator.toggle();}}}),o=c('OzHelpers').pure(function(t){var u=t.color,v=t.children,w=t.onClick;return (c('React').createElement('button',{onClick:w,className:"_1-hv"+(' '+"_1l1b")+(u==='blue'?' '+"_1l1x":'')+(u==='grey'?' '+"_1l1y":'')},v));});function p(t,u){if(!t)return null;var v=u.get(t.get('wit-intent-uuid'));if(!v||q(v))return null;return v;}function q(t){return t.get('name').match(/^dialog_/);}function r(t,u){var v=j({name:t.get('name'),'wit-intent-uuid':t.get('id')});return u&&v.get('wit-intent-uuid')===u.get('wit-intent-uuid')?v.merge(u):v;}function s(t){return t.getModifierState('Control')&&t.which==c('Keys').SPACE;}f.exports=n;}),null);
__d('OzInboxShow.react',['cx','Promise','OzStrings','OzAPI','OzHelpers','immutable','OzNotify','relativeTimeString.atlas','OzActions','OzButton.react','OzComposer.react','OzConfig','OzConfirmDialog.react','OzConstants','OzInboxMessageList.react','OzIntentCreator.react','OzStores','OzThreadLabels.react','OzUpdateDateTime.react','promiseFinally','OzImmutablePureRenderMixin','React','Reflux','Tooltip'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').List,j=c('immutable').Map,k=c('React').PropTypes,l=c('OzConstants').AUTHOR_TYPES,m=c('OzStores').PendingMessageStateStore,n=c('OzThreadLabels.react').OzLabelList,o=c('OzConfig').ConfigStore,p=c('Reflux').createAction(),q=c('Reflux').createStore({init:function aa(){this._data=j();this.listenTo(p,this._onUpdateFetchState);},getInitialState:function aa(){return this._data;},_onUpdateFetchState:function aa(ba,ca){this._data=this._data.update(ba,function(da){return (da||j()).merge(ca);});this.trigger(this._data);}}),r='NO_OWNER',s=25,t=25,u=100,v=10000,w=c('React').createClass({displayName:'OzInboxShow',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(q,'fetchStates'),c('Reflux').connect(m,'pendingMessageState'),c('Reflux').connect(o,'config')],contextTypes:{uid:k.string.isRequired,router:k.object.isRequired},getInitialState:function aa(){return z();},componentDidMount:function aa(){this._init(this.props);var ba=c('OzActions').scrollThreadToTimestamp.listen(this._scrollToTimestamp);this._unlisten=function(){ba();};},componentWillReceiveProps:function aa(ba){if(c('OzHelpers').threadID(ba.thread)!==c('OzHelpers').threadID(this.props.thread)){c('OzHelpers').debug('[inboxshow] thread changed');this._init(ba);}if(c('OzHelpers').isUnread(ba.thread)&&c('OzHelpers').isOwner(ba.thread,this.context.uid))c('OzAPI').markRead(c('OzHelpers').threadID(ba.thread));},_init:function aa(ba){this.setState(z(),function(ca){if(!ba.thread.get('light-thread')&&x(ba.thread).size<s)this._fetchMessages();}.bind(this));},componentWillUnmount:function aa(){this._unlisten();},render:function aa(){var ba=this.state,ca=ba.fetchStates,da=ba.pendingMessageState,ea=ba.clientLimit,fa=ba.activeMsgID,ga=this.props,ha=ga.reps,ia=ga.thread,ja=ga.merchants,ka=ga.witIntents,la=x(ia),ma=c('OzHelpers').threadID(ia),na=da.get(ma,0)>0,oa=ha.map(function(qa){return qa.get('name');});if(fa)c('OzHelpers').debug('[inboxshow] Rendering with active msg id '+fa);var pa={humans:this.props.humans,onOwnerChange:this._handleOwnerChange,repNames:oa,reps:ha,requirements:this.props.requirements,thread:ia,witIntents:this.props.witIntents};return (c('React').createElement('div',{className:"_1x8x"+(c('OzHelpers').hasTag(ia,'employee')?' '+"_1yyg":'')+(c('OzHelpers').hasEngage(ia)?' '+"_1fi":'')},c('React').createElement(c('OzIntentCreator.react'),{thread:ia,witIntents:ka}),c('React').createElement('div',{className:"_1x8y"},this._renderHistoryHeader(),c('React').createElement('div',{className:"_1x96"},c('React').createElement(c('OzInboxMessageList.react'),{activeMsgID:fa,clientLimit:ea,loading:!!ca.getIn([ma,'loading']),onScrollTop:this._fetchMessages,messages:la,ref:'messageList',repNames:oa,sending:na,thread:ia})),c('React').createElement('div',{className:"_237y"},c('React').createElement(c('OzComposer.react'),{merchants:ja,onResize:this._handleResize,thread:ia}))),c('React').cloneElement(this.props.children,pa)));},_scrollToTimestamp:function aa(ba){var ca=c('OzHelpers').threadID(this.props.thread);c('OzHelpers').debug('[inboxshow] received request to scroll to ts '+ba);this.setState({activeMsgID:null});this._backloadHistoryUntil(ca,ba)['catch'](function(da){return c('OzActions').doneScrollingToTimestamp(ba,true);}).then(function(da){c('OzActions').doneScrollingToTimestamp(ba);if(c('OzHelpers').threadID(this.props.thread)!==ca){c('OzHelpers').debug('[inboxshow] aborting scroll because thread changed');}else{this.setState({clientLimit:this.state.clientLimit+da.size});var ea=da.isEmpty()?x(this.props.thread):da,fa=c('OzHelpers').msgID(ea.filter(function(ga){return c('OzHelpers').authorType(ga)===l.USER;}).findLast(function(ga){return ga.get('timestamp')<=ba;}));this._activateAndScrollToMsg(fa);}}.bind(this)).done();},_backloadHistoryUntil:function aa(ba,ca){var da=function ha(ia,ja){return (c('OzAPI').history(ba,ia,u).then(function(ka){var la=y(ka,ia);if(la===ia||ka.isEmpty())throw la;var ma=ja.merge(ka);c('OzHelpers').debug('[inboxshow] got '+ma.size+'; dt='+(la-ca));var na=ka.filter(function(oa){return c('OzHelpers').authorType(oa)===l.USER;});return na.some(function(oa){return oa.get('timestamp')<=ca;})?ma:ha(la,ja.merge(ka));}));},ea=this.state.fetchStates.getIn([ba,'timestamp']),fa=this._unseenButLoadedMessages(),ga=x(this.props.thread).filter(function(ha){return c('OzHelpers').authorType(ha)===l.USER;}).some(function(ha){return ha.get('timestamp')<=ca;});if(ga){c('OzHelpers').debug('[inboxshow] desired timestamp '+ca+' already loaded');return new (c('Promise'))(function(ha){return ha(fa);});}c('OzHelpers').debug('[inboxshow] backloading to ts '+ca+' from '+ea);return this._withFetchState(ba,ea,da(ea,j())).then(function(ha){return ha.merge(fa).sortBy(function(ia){return ia.get('timestamp');});});},_activateAndScrollToMsg:function aa(ba){this.setState({activeMsgID:ba},function(ca){window.setTimeout(function(){if(this.state.activeMsgID===ba){c('OzHelpers').debug('[inboxshow] CLEARING ACTIVE MSG ID');this.setState({activeMsgID:null});}}.bind(this),v);}.bind(this));},_withFetchState:function aa(ba,ca,da){var ea=this.state.fetchStates.get(ba,j());if(ea.get('loading')||ea.get('fetchedAll')){c('OzHelpers').debug('[inboxshow] already loading or at beginning of time');return new (c('Promise'))(function(fa){return fa();});}c('OzHelpers').debug('[inboxshow] performing load');p(ba,j({loading:true}));return c('promiseFinally')(da,function(fa){return p(ba,j({loading:false}));}).then(function(fa){var ga=y(fa,ca||Infinity);c('OzHelpers').debug('[inboxshow] loaded '+fa.size+'; ts='+ga);p(ba,j({fetchedAll:fa.isEmpty()||ga===ca,timestamp:ga}));return fa;});},_unseenButLoadedMessages:function aa(){return x(this.props.thread).skipLast(this.state.clientLimit);},_fetchMessages:function aa(){var ba=c('OzHelpers').threadID(this.props.thread),ca=this.state.fetchStates.getIn([ba,'timestamp']);this.setState({clientLimit:this.state.clientLimit+s});if(!this._unseenButLoadedMessages().isEmpty()){c('OzHelpers').debug('[inboxshow] using client cache instead of fetch');return;}this._withFetchState(ba,ca,c('OzAPI').history(ba,ca,t)).done();},_handleGrab:function aa(){c('OzAPI').grab(c('OzHelpers').threadID(this.props.thread));},_handleResize:function aa(){this.refs.messageList.resize();},_handleOwnerChange:function aa(ba){var ca=ba.value;if(ca&&ca!==r){var da=this.props.reps.get(ca),ea=this.props.thread,fa=c('OzHelpers').threadID(ea);if(!c('OzHelpers').hasOpenIntents(ea)){var ga='You must create an intent first';c('OzNotify').warn(ga);}else{if(da.get('is-coach')&&!c('OzHelpers').isEscalated(ea)){c('OzAPI').escalateTo(fa,ca);}else c('OzAPI').assignTo(fa,ca);if(!da.get('is-coach')&&c('OzHelpers').isEscalated(ea)){var ha='Please remove the "Escalated" tag to prevent the '+'thread from getting reassigned to a coach';c('OzNotify').warn(ha);}}}},_renderHistoryHeader:function aa(){var ba=this.props.thread,ca=c('OzHelpers').threadID(ba),da=c('OzHelpers').hasTag(ba,'employee')||c('OzHelpers').hasEngage(ba)?'light':'dark',ea=function ja(ka,la){return c('React').createElement(c('OzButton.react'),{onClick:la},ka);},fa=function(ja){return function(ka){c('OzHelpers').isOwner(ba,this.context.uid)?ja():c('OzActions').showDialog(c('OzConfirmDialog.react'),{onConfirm:ja,body:'You don\'t own this thread. If you proceed, the user '+'may be forgotten until they message us again.',header:'Are you sure this user doesn\'t need to be engaged?'});}.bind(this);}.bind(this),ga=c('OzHelpers').locationLastSeen(ba),ha=j({hour:'numeric',minute:'numeric'}),ia=(c('OzHelpers').timezone(ba)||'location unknown').replace(/_/g,' ');return (c('React').createElement('div',{className:"_1q4l"},c('React').createElement('div',{className:"_4l-w"},c('React').createElement('h2',{className:"_1q4m"},c('OzHelpers').getName(ba)),c('React').createElement('div',{className:"_29x1"},ba.getIn(['location','timezone'])?c('React').createElement('span',c('Tooltip').propsFor('at the user\'s last known location, updated '+c('relativeTimeString.atlas')(+ga,true),'below'),c('React').createElement(c('OzUpdateDateTime.react'),{locale:'en-US',options:ha,timezoneOffset:ba.getIn(['location','timezone-offset'],0)}),' ('+ia+')'):c('React').createElement('span',null,'(location unknown)'))),c('React').createElement('div',{className:"_1q4n"},c('React').createElement(n,{className:"_1q4o",thread:ba,shade:da,removable:true,addable:true}),c('React').createElement('div',{className:"_1q4p"},c('OzHelpers').hasEngage(ba)&&ea('No need to engage',fa(function(ja){return c('OzAPI').notready(ca);}))))));}}),x=c('OzHelpers').memoize(function(aa){return aa.get('messages').sortBy(function(ba){return ba.get('timestamp');});},function(aa){return aa.get('messages').hashCode();});function y(aa,ba){return aa.map(function(ca){return ca.get('timestamp');}).reduce(function(ca,da){return Math.min(ca,da);},ba);}function z(){return {activeMsgID:null,clientLimit:s};}f.exports=w;}),null);
__d('OzIntentDashboardCategoryFilter.react',['immutable','React','XUISingleSelector.react'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('immutable').Map,k=c('React').PropTypes,l=c('XUISingleSelector.react').Option;h=babelHelpers.inherits(m,c('React').PureComponent);i=h&&h.prototype;function m(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=i.constructor).call.apply(q,[this].concat(s)),this.$OzIntentDashboardCategoryFilter1=function(u){this.props.onCategoryChange(o(u.value));}.bind(this),p;}m.prototype.render=function(){return c('React').createElement(c('XUISingleSelector.react'),{maxheight:400,onChange:this.$OzIntentDashboardCategoryFilter1,value:this.props.category||'__none__'},c('React').createElement(l,{value:'__none__'},'Select an intent category'),n(this.props.intentMetas).valueSeq().map(function(p){return c('React').createElement(l,{key:p.get('id'),value:p.get('name')},p.get('name'));}));};m.propTypes={intentMetas:k.instanceOf(j).isRequired,onCategoryChange:k.func.isRequired,category:k.string};function n(p){return p.sortBy(function(q){return q.get('name');});}function o(p){return p!=='__none__'?p:undefined;}f.exports=m;}),null);
__d('OzIntentDashboardFilters.react',['cx','immutable','InputLabel.react','OzIntentDashboardCategoryFilter.react','OzTriSwitch.react','OzImmutablePureRenderMixin','React','XUISingleSelector.react'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('React').PropTypes,k=c('XUISingleSelector.react').Option,l=c('OzTriSwitch.react').fromBoolean,m=c('OzTriSwitch.react').toBoolean,n=c('React').createClass({displayName:'OzIntentDashboardFilters',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{intentMetas:j.instanceOf(i).isRequired,isEmployee:j.bool,isReversed:j.bool.isRequired,onIsEmployeeChange:j.func.isRequired,onIsReversedChange:j.func.isRequired,onSortByChange:j.func.isRequired,onCategoryChange:j.func.isRequired,sortBy:j.string,sortableFields:j.instanceOf(i).isRequired,category:j.string},render:function p(){return (c('React').createElement('ul',{className:"_1bo-"},c('React').createElement('li',null,this._renderCategoryFilter()),c('React').createElement('li',null,this._renderSortByFilter()),c('React').createElement('li',null,this._renderIsReversedFilter()),c('React').createElement('li',null,this._renderIsEmployeeFilter())));},_renderCategoryFilter:function p(){return (c('React').createElement(c('OzIntentDashboardCategoryFilter.react'),{intentMetas:this.props.intentMetas,onCategoryChange:this.props.onCategoryChange,category:this.props.category}));},_renderIsEmployeeFilter:function p(){return (c('React').createElement(c('OzTriSwitch.react'),{animated:true,label:'Employee?',onClick:function(q){this.props.onIsEmployeeChange(m(q));}.bind(this),value:l(this.props.isEmployee)}));},_renderIsReversedFilter:function p(){return (c('React').createElement(c('InputLabel.react'),null,c('React').createElement('input',{checked:this.props.isReversed,onChange:function(q){this.props.onIsReversedChange(q.target.checked);}.bind(this),type:'checkbox'}),c('React').createElement('label',null,'Reversed?')));},_renderSortByFilter:function p(){return (c('React').createElement(c('XUISingleSelector.react'),{maxheight:400,onChange:this._handleSortByChange,value:this.props.sortBy||'__none__'},c('React').createElement(k,{value:'__none__'},'Select a field to sort by'),this.props.sortableFields.map(function(q,r){return (c('React').createElement(k,{key:r,value:r},q));}).valueSeq()));},_handleSortByChange:function p(q){this.props.onSortByChange(o(q.value));}});function o(p){return p!=='__none__'?p:undefined;}f.exports=n;}),null);
__d('ozFormatTime',[],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=3600,i=60;function j(k){var l=Math.floor(k/h);k%=h;var m=Math.floor(k/i);k%=i;var n=Math.round(k),o='';if(l)o+=l+'h ';if(m)o+=m+'m ';if(n)o+=n+'s';return o;}f.exports=j;}),null);
__d('OzIntentDashboardRow.react',['OzHelpers','immutable','React','ReactRouter','formatDate','ozFormatTime'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('immutable').Map,k=c('ReactRouter').Link,l=c('React').PropTypes;h=babelHelpers.inherits(m,c('React').Component);i=h&&h.prototype;m.prototype.render=function(){var p=this.props.intent,q=p.get('user-vcard')||j();return (c('React').createElement('tr',null,c('React').createElement('td',null,p.get('intent-id')),c('React').createElement('td',null,c('React').createElement(k,{to:'/inbox/'+p.get('user-id')},q.get('name',p.get('user-id')))),c('React').createElement('td',null,o(q)),c('React').createElement('td',null,p.get('intent-category')),c('React').createElement('td',null,p.get('create-date')?n(p.get('create-date')):null),c('React').createElement('td',null,p.get('close-date')?n(p.get('close-date')):null),c('React').createElement('td',null,p.get('active-time-seconds')?c('ozFormatTime')(p.get('active-time-seconds')):null),c('React').createElement('td',null,c('React').createElement(k,{to:c('OzHelpers').threadPath({threadid:p.get('user-id'),intentid:p.get('intent-id')})},'Click to go to the thread'))));};function m(){h.apply(this,arguments);}m.propTypes={intent:l.instanceOf(j).isRequired};function n(p){return c('formatDate')(p/1000,'M d, Y g:ia');}function o(p){var q=p.get('is-employee');return q==null?'UNKNOWN':q?'YES':'NO';}f.exports=m;}),null);
__d('OzIntentDashboard.react',['immutable','MessengerFlexScrollableArea.react','OzIntentDashboardFilters.react','OzIntentDashboardRow.react','OzImmutablePureRenderMixin','React','XUITable.react'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('immutable').Map,i=c('immutable').OrderedMap,j=c('React').PropTypes,k=h({id:'ID',close_date:'Closed At',create_date:'Created At',active_time_seconds:'Time Spent'}),l=c('React').createClass({displayName:'OzIntentDashboard',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{intentMetas:j.instanceOf(h).isRequired,intents:j.instanceOf(i).isRequired,isEmployee:j.bool,isLoaded:j.bool.isRequired,isLoading:j.bool.isRequired,isReversed:j.bool.isRequired,onFetchRequest:j.func.isRequired,onIsEmployeeChange:j.func.isRequired,onIsReversedChange:j.func.isRequired,onSortByChange:j.func.isRequired,onCategoryChange:j.func.isRequired,sortBy:j.string,uuid:j.string},render:function m(){return (c('React').createElement(c('MessengerFlexScrollableArea.react'),{onScroll:this._handleScroll,ref:'scrollable'},c('React').createElement(c('OzIntentDashboardFilters.react'),{intentMetas:this.props.intentMetas,isEmployee:this.props.isEmployee,isReversed:this.props.isReversed,onIsEmployeeChange:this.props.onIsEmployeeChange,onIsReversedChange:this.props.onIsReversedChange,onSortByChange:this.props.onSortByChange,onCategoryChange:this.props.onCategoryChange,sortBy:this.props.sortBy,sortableFields:k,uuid:this.props.uuid}),this._renderTable(),this._renderLoadMoreLink()));},_renderTable:function m(){return (c('React').createElement(c('XUITable.react'),{outerBorder:false},c('React').createElement('thead',null,c('React').createElement('tr',null,c('React').createElement('th',null,'ID'),c('React').createElement('th',null,'User Name'),c('React').createElement('th',null,'Employee?'),c('React').createElement('th',null,'Intent'),c('React').createElement('th',null,'Created At'),c('React').createElement('th',null,'Closed At'),c('React').createElement('th',null,'Time Spent'),c('React').createElement('th',null,'Events'))),c('React').createElement('tbody',null,this.props.intents.entrySeq().map(function(n){var o=n[0],p=n[1];return (c('React').createElement(c('OzIntentDashboardRow.react'),{intent:p,key:o}));}))));},_renderLoadMoreLink:function m(){if(this.props.isLoaded)return null;if(this.props.isLoading)return c('React').createElement('div',null,'Loading...');return (c('React').createElement('div',null,c('React').createElement('a',{href:'#',onClick:function(n){n.preventDefault();this.props.onFetchRequest();}.bind(this)},'Fetch More Intents')));},_handleScroll:function m(){if(!this.props.isLoading&&!this.props.isLoaded&&this.refs.scrollable&&this.refs.scrollable.isScrolledToBottom())this.props.onFetchRequest();}});f.exports=l;}),null);
__d('OzIntentDashboardContainer.react',['immutable','OzAPI','OzIntentDashboard.react','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('immutable').Map,k=c('immutable').OrderedMap,l=c('React').PropTypes,m=30,n={intents:k(),isLoaded:false,offset:0};h=babelHelpers.inherits(o,c('React').Component);i=h&&h.prototype;function o(){var p,q;for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=i.constructor).call.apply(q,[this].concat(s)),this.state=babelHelpers['extends']({},n,{isEmployee:undefined,isLoading:false,isReversed:false,sortBy:undefined,category:undefined}),this.$OzIntentDashboardContainer1=function(){if(this.state.isLoading||this.state.isLoaded)return;this.setState({isLoading:true});c('OzAPI').intentsDashboard({offset:this.state.offset,limit:m,'intent-category':this.state.category,reverse:this.state.isReversed||undefined,'sort-by':this.state.sortBy||undefined,'is-employee':this.state.isEmployee}).done(function(u){var v=u.reduce(function(w,x){return w.set(x.get('intent-id'),x);},this.state.intents);this.setState({intents:v,isLoaded:u.size===0,isLoading:false,offset:this.state.offset+u.size});}.bind(this));}.bind(this),this.$OzIntentDashboardContainer5=function(u){this.$OzIntentDashboardContainer6({category:u});}.bind(this),this.$OzIntentDashboardContainer2=function(u){this.$OzIntentDashboardContainer6({isEmployee:u});}.bind(this),this.$OzIntentDashboardContainer3=function(u){this.$OzIntentDashboardContainer6({isReversed:u});}.bind(this),this.$OzIntentDashboardContainer4=function(u){this.$OzIntentDashboardContainer6({sortBy:u});}.bind(this),this.$OzIntentDashboardContainer6=function(u){this.setState(babelHelpers['extends']({},n,u),this.$OzIntentDashboardContainer1);}.bind(this),p;}o.prototype.componentDidMount=function(){this.$OzIntentDashboardContainer1();};o.prototype.render=function(){return c('React').createElement(c('OzIntentDashboard.react'),{intentMetas:this.props.witIntents,intents:this.state.intents,isEmployee:this.state.isEmployee,isLoaded:this.state.isLoaded,isLoading:this.state.isLoading,isReversed:this.state.isReversed,onFetchRequest:this.$OzIntentDashboardContainer1,onIsEmployeeChange:this.$OzIntentDashboardContainer2,onIsReversedChange:this.$OzIntentDashboardContainer3,onSortByChange:this.$OzIntentDashboardContainer4,onCategoryChange:this.$OzIntentDashboardContainer5,sortBy:this.state.sortBy,category:this.state.category});};f.exports=o;}),null);
__d('OzMerchantStatus.react',['cx','immutable','React'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('immutable').Map,l=c('React').PropTypes;i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;m.prototype.render=function(){'use strict';var n=this.props.merchant,o=n.get('approved'),p=n.get('blacklisted');return (c('React').createElement('i',{className:"_4wc0"+(o?' '+"_4wbz":'')+(p?' '+"_4wb-":''),title:o&&'approved'||p&&'blacklisted'}));};function m(){'use strict';i.apply(this,arguments);}m.propTypes={merchant:l.instanceOf(k).isRequired};f.exports=m;}),null);
__d('OzMerchantRow.react',['cx','OzAPI','OzHelpers','immutable','Layout.react','LeftRight.react','MessengerDialogHeader.react','MessengerDialogTitle.react','OzActions','OzButton.react','OzMerchantDialog.react','OzMerchantStatus.react','OzImmutablePureRenderMixin','React','SUIAtlasTheme','SUINotice.react','XUIDialog.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('Layout.react').Column,k=c('Layout.react').FillColumn,l=c('React').PropTypes,m=c('React').createClass({displayName:'DeleteMerchantDialog',propTypes:{merchant:l.object.isRequired,onConfirm:l.func.isRequired},render:function o(){return (c('React').createElement(c('XUIDialog.react'),{width:544,shown:true,layerHideOnBlur:false,className:"_4ebx"},c('React').createElement('div',{className:"_4eby _2c9g"},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogTitle.react'),null,'Delete merchant "'+this.props.merchant.get('name-dba')+'\"?')),c('React').createElement(c('SUINotice.react'),{theme:c('SUIAtlasTheme'),type:'error'},c('React').createElement('div',{className:"_4wby"},'This action is irreversible. Are you sure?'),c('React').createElement(c('LeftRight.react'),null,c('React').createElement(c('OzButton.react'),{onClick:c('OzActions').hideDialog},'Cancel'),c('React').createElement(c('OzButton.react'),{onClick:this.props.onConfirm},'Yes, permanently delete this merchant'))))));},_handleToggle:function o(p){c('OzHelpers').debug('[merchantdialog] toggle',arguments);if(!p)c('OzActions').hideDialog();}}),n=c('React').createClass({displayName:'OzMerchantRow',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{merchant:l.instanceOf(i).isRequired},render:function o(){var p=this.props.merchant,q=p.get('website'),r=function t(u){return '$'+(u?(u/100).toFixed(2):0);},s=function t(u){return u||0;};return (c('React').createElement(c('Layout.react'),{className:"_59hd"},c('React').createElement(j,{className:"mrm _728"},c('React').createElement(c('OzMerchantStatus.react'),{merchant:p})),this._renderMerchantInfo('name-dba'),this._renderMerchantInfo('name-legal'),this._renderMerchantInfo('phone'),this._renderMerchantInfo('cumulative-transaction-amount',r),this._renderMerchantInfo('cumulative-transaction-count',s),c('React').createElement(k,{className:"mrm _4wc2 _4wc3"},c('React').createElement('a',{target:'_blank',href:q},q)),this._renderActions()));},_renderMerchantInfo:function o(p,q){var r=this.props.merchant,s=r.get(p);if(q)s=q(s);return (c('React').createElement(j,{className:"mrm _4wc2 _72a"},s));},_renderActions:function o(){var p=this._getActions();if(!p)return null;var q=p.map(function(r){var s=r.f,t=r.body;return c('React').createElement(c('OzButton.react'),{key:t,onClick:s},t);});return (c('React').createElement(j,{className:"mrm _6w4"},q));},_getActions:function o(){var p=[],q=this.props.merchant;p.push({body:'Edit',f:this._handleMerchantEdit()});p.push({body:'Delete',f:this._handleMerchantDelete()});if(q.get('blacklisted')===true){p.push({body:'Whitelist',f:this._handleMerchantBlacklist(false)});}else p.push({body:'Blacklist',f:this._handleMerchantBlacklist(true)});return p;},_handleMerchantEdit:function o(){return function(p,q){var r=this.props.merchant;c('OzActions').showDialog(c('OzMerchantDialog.react'),{initialMerchant:r,title:'Edit merchant '+r.get('name-dba'),onMerchant:function s(t){c('OzAPI').editMerchant(t);c('OzActions').hideDialog();}});q();}.bind(this);},_handleMerchantBlacklist:function o(p){return function(q,r){var s=this.props.merchant;c('OzAPI').editMerchant(i({id:s.get('id'),blacklisted:p}));r();}.bind(this);},_handleMerchantDelete:function o(){return function(p,q){var r=this.props.merchant;c('OzActions').showDialog(m,{merchant:this.props.merchant,onConfirm:function s(){c('OzAPI').deleteMerchant(i({id:r.get('id')})).then(c('OzActions').hideDialog);}});q();}.bind(this);}});f.exports=n;}),null);
__d('OzMerchants.react',['cx','OzAPI','immutable','Layout.react','MessengerFlexScrollableArea.react','OzActions','OzButton.react','OzMerchantDialog.react','OzMerchantRow.react','React'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('Layout.react').Column,l=c('Layout.react').FillColumn,m=c('immutable').Map,n=c('React').PropTypes;i=babelHelpers.inherits(o,c('React').Component);j=i&&i.prototype;function o(){var p,q;'use strict';for(var r=arguments.length,s=Array(r),t=0;t<r;t++)s[t]=arguments[t];return p=(q=j.constructor).call.apply(q,[this].concat(s)),this.state={slice:25},this.$OzMerchants4=function(){c('OzActions').showDialog(c('OzMerchantDialog.react'),{onMerchant:function u(v){c('OzAPI').createMerchant(v);c('OzActions').hideDialog();}});},this.$OzMerchants2=function(){return (c('React').createElement(c('Layout.react'),{className:"_726"},c('React').createElement(k,{className:"mrm _727 _728"},'Status'),this.$OzMerchants5('Name'),this.$OzMerchants5('Legal Name'),this.$OzMerchants5('Phone'),this.$OzMerchants5('Transaction total'),this.$OzMerchants5('Transaction count'),c('React').createElement(l,{className:"mrm _727"},'Website'),c('React').createElement(k,{className:"mrm _729"},c('React').createElement(c('OzButton.react'),{onClick:this.$OzMerchants4},'New merchant'))));}.bind(this),this.$OzMerchants5=function(u){return (c('React').createElement(k,{className:"mrm _727 _72a"},u));},this.$OzMerchants3=function(){var u=this.props.merchants.sortBy(function(v){return v.get('name-dba','').toLowerCase();}).toSeq().take(this.state.slice).map(function(v){return (c('React').createElement(c('OzMerchantRow.react'),{key:v.get('name-dba'),merchant:v}));}).valueSeq();return (c('React').createElement(c('MessengerFlexScrollableArea.react'),{className:"_72b",onScroll:this.$OzMerchants6,ref:'scrollable'},u));}.bind(this),this.$OzMerchants1=function(){return c('React').createElement('div',null,'No merchants to show');},this.$OzMerchants6=function(){if(this.refs.scrollable.isScrolledToBottom())this.setState(function(u){return {slice:u.slice+25};});}.bind(this),p;}o.prototype.render=function(){'use strict';if(this.props.merchants.isEmpty())return this.$OzMerchants1();return c('React').createElement(c('Layout.react'),null,c('React').createElement(l,null,this.$OzMerchants2(),this.$OzMerchants3()));};f.exports=o;}),null);
__d('OzPerformance',['OzHelpers','OzStores','immutable','OzAPI','OzAJAX','OzReactMetrics'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('immutable').Map,i=1000*60,j=function p(){if(!window.performance||!window.performance.memory)return h({});var q=window.performance.memory,r=q.totalJSHeapSize,s=q.usedJSHeapSize,t=Math.round(100*s/r);return h({totalHeap:r,usedHeap:s,percent:t});},k=function p(){var q=Object.keys(c('OzStores')).map(function(s){return c('OzStores')[s];}),r=q.map(function(s){return s.metrics&&s.metrics();});return r.reduce(function(s,t){return s.merge(t);},h());},l=function p(){var q=c('OzAPI').metrics,r=q.getIn(['realtime','updated-thread-fetch-thread'],0),s=q.getIn(['realtime','updated-thread'],1),t=Math.round(100*r/s),u=q.getIn(['realtime','thread-metrics-update-thread'],0),v=q.getIn(['realtime','thread-metrics'],1),w=Math.round(100*u/v);return q.setIn(['realtime','percent-fetched'],t).setIn(['realtime','percent-metrics-stored'],w);},m=function p(){c('OzHelpers').info('[perf]',{memory:j().toJS(),stores:k().toJS(),api:l().toJS(),react:c('OzReactMetrics').metrics,ajax:c('OzAJAX').metrics});},n,o=function p(){n=window.setInterval(m,i);};f.exports={init:o,timer:n};}),null);
__d('OzStatsDashboardFilters.react',['cx','Promise','immutable','OzSearchSource','OzSwitch.react','OzImmutablePureRenderMixin','React','SearchableDropdownInput.contrib','SearchableEntry'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzStatsDashboardFilters',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onTeamViewChange:j.func.isRequired,onTrainerIDChange:j.func.isRequired,reps:j.instanceOf(i).isRequired,teamView:j.bool.isRequired,trainerID:j.string.isRequired},getInitialState:function n(){return {searchSource:l(this.props.reps)};},componentWillReceiveProps:function n(o){if(!c('immutable').is(o.reps,this.props.reps))this.setState({searchSource:l(o.reps)});},render:function n(){var o=this.props,p=o.onTeamViewChange,q=o.onTrainerIDChange,r=o.reps,s=o.teamView,t=o.trainerID;return (c('React').createElement('div',{className:"_5p66"},c('React').createElement(c('OzSwitch.react'),{className:"_4vlt",isAnimated:true,isOn:s,label:'Team View',onToggle:p}),!s?c('React').createElement('div',{className:"_4vlu"},c('React').createElement(c('SearchableDropdownInput.contrib'),{value:m(r.get(t)),onSelect:function u(v){return q(v.getUniqueID());},placeholder:'Select a trainer...',emptySearchResultsText:'No trainers found',searchSource:this.state.searchSource})):null));}});function l(n){return new (c('OzSearchSource'))(function(o){var p=(o.query||'').toLowerCase();return c('Promise').resolve(n.valueSeq().map(m).sortBy(function(q){return q.getTitle();}).filter(function(r){return (r.getTitle()||'').toLowerCase().indexOf(p)>-1;}).toJS());});}function m(n){return n&&new (c('SearchableEntry'))({title:n.get('name'),uniqueID:n.get('fbid')});}f.exports=k;}),null);
__d('OzStatsDashboard.react',['cx','CandelaGroupScaleBuilder','immutable','BUIInsightsLegendChart.react','BUIInsightsLineAreaChart.react','OzConfig','OzStatsDashboardFilters.react','OzImmutablePureRenderMixin','React','ReactRouter','Stars.react','XUISingleSelector.react','formatDate','OzHelpers','ozFormatTime','Reflux','Timezone','XUITable.react'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('ReactRouter').Link,j=c('XUISingleSelector.react').Option,k=c('CandelaGroupScaleBuilder').group,l=c('immutable').List,m=c('immutable').Map,n=c('immutable').OrderedSet,o=c('immutable').Range,p=c('React').PropTypes,q=604800,r=c('React').createClass({displayName:'OzStatsDashboard',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{displayTime:p.number.isRequired,finalWeek:p.number.isRequired,isLoading:p.bool.isRequired,onDateChange:p.func.isRequired,onTeamViewChange:p.func.isRequired,onTrainerIDChange:p.func.isRequired,reps:p.instanceOf(m).isRequired,stats:p.oneOfType([p.instanceOf(l),p.instanceOf(m)]).isRequired,teamView:p.bool.isRequired,trainerID:p.string.isRequired},render:function ea(){var fa=this.props,ga=fa.displayTime,ha=fa.finalWeek,ia=fa.onDateChange,ja=fa.onTeamViewChange,ka=fa.onTrainerIDChange,la=fa.reps,ma=fa.stats,na=fa.teamView,oa=fa.trainerID;return (c('React').createElement('div',{className:"_16u3"},this.state.config.getIn(['GK','supervisor'])?c('React').createElement(c('OzStatsDashboardFilters.react'),{onTeamViewChange:ja,onTrainerIDChange:ka,reps:la,teamView:na,trainerID:oa}):null,c('React').createElement(s,{currentWeek:ga,finalWeek:ha,onDateSelect:ia}),c('React').createElement('div',{className:"_16u4"},na?c('React').createElement(t,{stats:ma,displayTime:ga}):c('React').createElement(u,{displayTime:ga,stats:ma,reps:la,trainerID:oa}))));}}),s=c('OzHelpers').pure(function(ea){var fa=ea.currentWeek,ga=ea.finalWeek,ha=ea.onDateSelect,ia=13,ja=o(ga,ga-ia*q,q).map(function(ka){var la=c('formatDate')(ka,'M j');return (c('React').createElement(j,{key:la,value:ka},la));});return (c('React').createElement('div',{className:"_16-n"},'Stats for week starting ',c('React').createElement(c('XUISingleSelector.react'),{name:'OzStatsSelector',maxheight:240,onChange:ha,value:fa},ja)));}),t=c('OzHelpers').pure(function(ea){var fa=ea.displayTime,ga=ea.stats;return (c('React').createElement('div',null,c('React').createElement(v,{chartType:'CR',teamStats:ga,weekStart:fa}),c('React').createElement(v,{chartType:'ER',teamStats:ga,weekStart:fa})));}),u=c('OzHelpers').pure(function(ea){var fa=ea.displayTime,ga=ea.stats,ha=ea.reps,ia=ea.trainerID;return (c('React').createElement('div',null,!ga.isEmpty()?c('React').createElement('div',null,c('React').createElement(aa,{chartType:'CR',stats:ga,weekStart:fa}),c('React').createElement(aa,{chartType:'ER',stats:ga,weekStart:fa})):c('React').createElement('div',null,'Stats loading...'),c('React').createElement('div',{style:{padding:'10px'}},ga.map(function(ja,ka){return (c('React').createElement(ba,{key:ka,section:ja,reps:ha,trainerID:ia}));}))));}),v=c('OzHelpers').pure(function(ea){var fa=ea.chartType,ga=ea.displayTime,ha=ea.teamStats,ia=fa.toLowerCase(),ja=ha.map(function(ka,la){return m({time:parseInt(la,10),team1:ka.getIn(['1',ia])/ka.getIn(['1','n']),team2:ka.getIn(['2',ia])/ka.getIn(['2','n'])});}).toList().sortBy(function(ka){return ka.get('time');});return (ha.size?c('React').createElement(y,{data:ja,graphSchema:w,legendItems:x,yAxisTitle:fa+' (mins)'}):null);}),w={time:{timezoneID:c('Timezone').PST8PDT,type:'time'},team1:{renderAs:'line',type:'number'},team2:{renderAs:'line',type:'number'}},x=n([{key:'team1',label:'Team 1'},{key:'team2',label:'Team 2'}]),y=c('OzHelpers').pure(function(ea){var fa=ea.data,ga=ea.graphSchema,ha=ea.legendItems,ia=ea.yAxisTitle,ja=[k.apply(null,ha.map(function(ka){return ka.key;}).toJS())];return (c('React').createElement('div',{className:"_16-o"},c('React').createElement('div',{className:"_3aw3"},ia),c('React').createElement(c('BUIInsightsLegendChart.react'),{items:ha,layoutInterval:200,minItemWidthPercentage:.67},c('React').createElement(c('BUIInsightsLineAreaChart.react'),{axisMarkFormatterFactory:z,data:fa.toJS(),height:300,width:800,schema:ga,plotX:k('time').from(fa.first().get('time')).to(fa.last().get('time')+1000),plotY:ja}))));}),z=function ea(fa,ga){if(ga==='vertical'){return function(ha){var ia=Math.floor(ha/60)+':';if(Math.floor(ha%60)<10)ia+='0';return ia+Math.floor(ha%60);};}else return function(ha){return c('formatDate')(ha.instant,'M j');};},aa=c('OzHelpers').pure(function(ea){var fa=ea.chartType,ga=ea.stats,ha=ea.weekStart,ia=ga.sortBy(function(na){return na.get('start-time');}).map(function(na){var oa=na.get('start-time'),pa=na.getIn(['summary','n']),qa=pa?na.getIn(['summary','er'])/pa:null,ra=pa?na.getIn(['summary','cr'])/pa:null,sa=na.getIn(['all-agents','er'])/na.getIn(['all-agents','n']),ta=na.getIn(['all-agents','cr'])/na.getIn(['all-agents','n']);return m({er:qa,cr:ra,time:oa,avg_er:sa,avg_cr:ta});}),ja={time:{timezoneID:c('Timezone').PST8PDT,type:'time'}},ka=fa.toLowerCase(),la='avg_'+ka;ja[ka]={renderAs:'area',type:'number'};ja[la]={renderAs:'line',type:'number'};var ma=n([{key:ka,label:fa==='ER'?'Execution Responsiveness':'Conversational Responsiveness'},{key:la,label:fa==='ER'?'Avg. ER':'Avg. CR'}]);return (c('React').createElement(y,{data:ia,graphSchema:ja,legendItems:ma,yAxisTitle:fa+' (mins)'}));}),ba=c('OzHelpers').pure(function(ea){var fa=ea.section,ga=ea.reps,ha=ea.trainerID,ia=fa.get('summary'),ja=c('formatDate')(fa.get('start-time'),'M j');if(!ia.get('n'))return c('React').createElement('div',null);return (c('React').createElement('div',{className:"_16-v"},c('React').createElement('div',{className:"_16-w"},'Stats for ',c('React').createElement('strong',null,ja)),c('React').createElement('div',{className:"_16-y"},'Average ER: ',c('ozFormatTime')(ia.get('er')/ia.get('n')),', Average CR: ',c('ozFormatTime')(ia.get('cr')/ia.get('n'))),c('React').createElement(da,{threads:fa.get('threads',l()),reps:ga,trainerID:ha})));}),ca=c('OzHelpers').pure(function(ea){var fa=ea.meta,ga=fa&&fa.get('send-survey',false);if(ga){var ha=fa.get('rating3')||'-1',ia=parseInt(ha,10);return (c('React').createElement('div',{className:"_4_w"+(ia===1?' '+"_505":'')+(ia===0?' '+"_506":'')},ia===0?c('React').createElement('span',{title:'User says M is not done'},'Not Done'):c('React').createElement(c('Stars.react'),{count:ia,max:3,size:'small',title:fa.get('user-feedback')})));}else{var ja=fa&&fa.getIn(['feedback','did-not-send-survey-reason']);return (c('React').createElement('div',{className:"_4_w"},c('React').createElement('span',null,ja==='option-not-presented'?c('React').createElement('span',{title:'Not relevant'},'N/A'):ja==='really-bad-experience'&&c('React').createElement('span',{className:"_505",title:'Survey not sent because of really bad ux'},'Bad'))));}}),da=c('OzHelpers').pure(function(ea){var fa=ea.threads,ga=ea.reps,ha=ea.trainerID;return (c('React').createElement(c('XUITable.react'),{outerBorder:true},c('React').createElement('thead',null,c('React').createElement('tr',null,c('React').createElement('th',{className:"_1ruu"},'User ID'),c('React').createElement('th',{className:"_1ruw"},'Intent'),c('React').createElement('th',{className:"_1rux"},'ER'),c('React').createElement('th',{className:"_1ruz"},'CR'),c('React').createElement('th',{className:"_1ru-"},'Start Time'),c('React').createElement('th',{className:"_1ru_"},'End Time'),c('React').createElement('th',{className:"_1rv0"},'Survey'))),c('React').createElement('tbody',null,fa.map(function(ia,ja){return (c('React').createElement('tr',{key:ja},c('React').createElement('td',null,c('React').createElement(i,{target:'blank',to:c('OzHelpers').threadPath({threadid:ia.get('user-id'),intentid:ia.get('oz-intent')})},ia.get('user-id'))),c('React').createElement('td',null,c('React').createElement(i,{target:'blank',to:c('OzHelpers').threadPath({threadid:ia.get('user-id'),intentid:ia.get('oz-intent')})},ia.get('intent-name'))),c('React').createElement('td',null,c('ozFormatTime')(ia.get('er'))),c('React').createElement('td',null,c('ozFormatTime')(ia.get('cr'))),c('React').createElement('td',null,c('OzHelpers').toLocaleTime(ia.get('start-time')*1000)),c('React').createElement('td',null,c('OzHelpers').toLocaleTime(ia.get('end-time')*1000)),c('React').createElement('td',null,c('React').createElement(ca,{meta:ia.get('intent-meta',m())}))));}))));});f.exports={OzStatsSurvey:ca,OzStatsDashboard:r};}),null);
__d('OzStatsDashboardContainer.react',['immutable','OzAPI','OzStatsDashboard.react','React'],(function a(b,c,d,e,f,g){'use strict';var h,i;if(c.__markCompiled)c.__markCompiled();var j=c('OzStatsDashboard.react').OzStatsDashboard,k=c('immutable').List,l=c('React').PropTypes,m=7;h=babelHelpers.inherits(n,c('React').Component);i=h&&h.prototype;function n(o,p){i.constructor.call(this,o,p);this.$OzStatsDashboardContainer1=function(){if(this.state.isLoading)return;this.setState({isLoading:true});if(this.state.teamView){c('OzAPI').teamStatsDashboard({start:this.state.displayTime,days:m}).done(function(r){this.setState({isLoading:false,stats:r});}.bind(this));}else c('OzAPI').statsDashboard({start:this.state.displayTime,days:m,'trainer-id':this.state.trainerID}).done(function(r){this.setState({isLoading:false,stats:r});}.bind(this));}.bind(this);this.$OzStatsDashboardContainer3=function(r){this.setState({stats:k(),teamView:r},this.$OzStatsDashboardContainer1);}.bind(this);this.$OzStatsDashboardContainer4=function(r){this.setState({stats:k(),trainerID:r},this.$OzStatsDashboardContainer1);}.bind(this);this.$OzStatsDashboardContainer2=function(r){this.setState({displayTime:r.value,stats:k()},this.$OzStatsDashboardContainer1);}.bind(this);var q=new Date();q.setDate(q.getDate()-q.getDay());q.setHours(0);q.setMinutes(0);q.setSeconds(0);q.setMilliseconds(0);this.state={displayTime:q.getTime()/1000,finalWeek:q.getTime()/1000,isLoading:false,stats:k(),summary:k(),teamView:false,trainerID:p.uid};}n.prototype.componentDidMount=function(){this.$OzStatsDashboardContainer1();};n.prototype.render=function(){return c('React').createElement(j,{displayTime:this.state.displayTime,finalWeek:this.state.finalWeek,isLoading:this.state.isLoading,onDateChange:this.$OzStatsDashboardContainer2,onTeamViewChange:this.$OzStatsDashboardContainer3,onTrainerIDChange:this.$OzStatsDashboardContainer4,reps:this.props.reps,stats:this.state.stats,teamView:this.state.teamView,trainerID:this.state.trainerID});};n.contextTypes={uid:l.string.isRequired,router:l.object.isRequired};f.exports=n;}),null);
__d('OzEventShow.react',['cx','OzAPI','OzHelpers','immutable','OzActions','OzDate.react','ozFormatTime','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzEventShow',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{activeIntent:j.instanceOf(i).isRequired,event:j.instanceOf(i).isRequired},render:function q(){var event=this.props.event;switch(event.get('type')){case 'send-email':case 'receive-email':return (c('React').createElement(m,{event:event,onEmailView:this._handleEmailView,onEmailReply:this._handleEmailReply}));case 'send-calendar':return c('React').createElement(l,{invite:event.get('data')});case 'completed-call':return (c('React').createElement(n,{event:event,onCallPlay:this._handleCallPlay,onCallBack:this._handleCallBack}));default:return c('React').createElement('div',null,'\'Not supported yet\'');}},_handleEmailView:function q(r){c('OzActions').emailComposer.add(babelHelpers['extends']({},c('OzHelpers').eventToEmail(r),{disabled:true}));},_handleEmailReply:function q(r){c('OzActions').emailComposer.add(c('OzHelpers').eventToEmail(c('OzHelpers').reEmail(r)));},_handleCallPlay:function q(r){return c('OzAPI').everstoreURI(r).then(function(s){return window.open(s);});},_handleCallBack:function q(r){c('OzActions').twilio.changeTo(r.getIn(['data','remote-phone']));c('OzActions').twilio.useIntent(this.props.activeIntent);}}),l=c('OzHelpers').pure(function(q){var r=q.invite;return (c('React').createElement('div',{className:"_1h7p"},c('React').createElement('div',{className:"_1h7q"}),c('React').createElement('div',{className:"_1h7v _p44"},c('React').createElement('span',{className:"_1h7r"},r.get('title'))),c('React').createElement(o,{label:'Location',row:r.get('location')||'n/a'}),c('React').createElement(o,{label:'Start',row:c('React').createElement(c('OzDate.react'),{timestamp:r.get('start')})}),c('React').createElement(o,{label:'End',row:c('React').createElement(c('OzDate.react'),{timestamp:r.get('end')})})));},'Invite'),m=c('OzHelpers').pure(function(q){var event=q.event,r=q.onEmailView,s=q.onEmailReply,t=event.get('type')==='send-email',u=event.get('data'),v='Email '+(t?'to '+u.get('to').join(', '):'from '+u.get('from'));return (c('React').createElement('div',{className:"_1h7p"},c('React').createElement('div',{className:"_1h7q"}),c('React').createElement('div',{className:"_1h7v _p44"},c('React').createElement('span',{className:"_1h7r"},v)),c('React').createElement(o,{label:'Subject',row:u.get('subject','[No subject]')}),c('OzHelpers').nonempty(u.get('cc'))?c('React').createElement(o,{label:'C.C.',row:u.get('cc').join(', ')}):null,c('OzHelpers').nonempty(u.get('bcc'))?c('React').createElement(o,{label:'B.C.C.',row:u.get('bcc').join(', ')}):null,c('React').createElement(o,{label:'Sent',row:c('React').createElement(c('OzDate.react'),{timestamp:u.get('sent-at')})}),c('React').createElement(p,{actions:c('immutable').fromJS([['View',function(w){r(t?event:c('OzHelpers').switchRecip(event));}],['Reply',function(w){s(t?event:c('OzHelpers').switchRecip(event));}]])})));},'Email'),n=c('OzHelpers').pure(function(q){var event=q.event,r=q.onCallPlay,s=q.onCallBack,t=event.get('data'),u={'in':'Call from ',out:'Call to ',voicemail:'Voicemail from '}[t.get('direction')],v=c('OzHelpers').parsePhoneNumber(t.get('remote-phone')),w=t.get('RecordingDuration'),x=t.get('recording-ev-handle'),y=x?[['Call Back',function(z){return s(event);}],['Play Voicemail',function(z){return r(x);}]]:[['Call Back',function(z){return s(event);}]];return (c('React').createElement('div',{className:"_1h7p"},c('React').createElement('div',{className:"_1h7q"}),c('React').createElement('div',{className:"_1h7v _p44"},c('React').createElement('span',{className:"_1h7r"},u+v)),c('React').createElement(o,{label:'Date',row:c('React').createElement(c('OzDate.react'),{timestamp:event.get('timestamp')})}),c('React').createElement(o,{label:'Duration',row:c('ozFormatTime')(w)}),c('React').createElement(p,{actions:c('immutable').fromJS(y)})));},'Call'),o=c('OzHelpers').pure(function(q){var r=q.label,s=q.row;return (c('React').createElement('div',{className:"_1h7v"},c('React').createElement('div',{className:"_1h7w"},r),c('React').createElement('div',{className:"_1h7y"},s)));},'Row'),p=c('OzHelpers').pure(function(q){var r=q.actions;return (c('React').createElement('div',{className:"_1h7t"},r.map(function(s){return (c('React').createElement('div',{key:s.first(),className:"_47yc",onClick:s.last()},s.first()));})));},'ActionRow');f.exports=k;}),null);
__d('OzFeedbackCloseDialog.react',['cx','invariant','ix','OzHelpers','relativeTimeString.atlas','Image.react','immutable','MessengerDialog.react','MessengerDialogHeader.react','MessengerDialogTitle.react','OzActions','OzBubblePreview.react','OzConfig','OzDate.react','OzFormPreview.react','React','ReactDOM','Reflux','TextAreaWithLineLimit.react','XUIButton.react','XUIRadioButtonGroup.react','XUISingleSelector.react'],(function a(b,c,d,e,f,g,h,i,j){var k,l;if(c.__markCompiled)c.__markCompiled();var m=c('React').PropTypes,n=c('immutable').List,o=c('immutable').Map,p=c('immutable').OrderedMap,q=c('immutable').Set,r=c('OzFormPreview.react').Row,s='fulfilled',t='unfulfilled',u='deleted',v='completed',w='out-of-scope',x='not-completed-user-cancel',y='not-completed-user-wish-na',z='not-completed-other',aa='delete-irrelevant',ba='good',ca='no-need',da='opportunity',ea=p((k={},k[v]='Request Successfully Completed',k[w]='Request Out of Scope',k[x]='Request Not Completed:'+' User Changed Their Mind',k[y]='Request Not Completed: User Wish N/A',k[z]='Request Not Completed: Other Reason',k[aa]='Delete: Irrelevant Intent',k)),fa=p({'POL-LEGAL-FINANCIAL-MEDICAL':'1- Provide legal, financial, medical,'+' or professional advice or services','POL-INSURANCE':'2- Purchase insurance or provide quotes','POL-PERSONAL-ACCOUNTS':'3- Access personal accounts that require logins','POL-CREATIVE-CONTENT':'4- Develop creative content','POL-AUTHENTICATE':'5- Authenticate goods or services','POL-NEGOTIATE':'6- Negotiate pricing or trade of products or services','POL-FB-VIOLATION':'7- Activity violating FB\'s Statement'+' of Rights and Responsibilities','POL-TOBACCO-FIREARMS-ADULT':'8- Action violating FB/3rd party terms:'+' tobacco, firearms, adult products/services, etc','POL-FOREIGN-PURCHASE':'9- Facilitate foreign purchases','POL-DONATION':'10- Make donations or contributions in a customer\'s name','POL-MEDICAL-SEARCH-APPOINTMENT':'11- Search for medical products'+' or make medical appointments','POL-TRAVEL-UNDERAGED-SOLO':'12- Book travel for persons under the age'+' of 18 unless purchased by a user who is the parent or legal guardian'}),ga=o({flight_request:'Did you book the flight?',restaurant:'Did you book the restaurant?',restaurant_bar:'Did you book the restaurant?',ticket_purchase:'Did you buy the ticket?',movie_concert_show:'Did you buy the ticket?'}),ha='Objective_None',ia=o({restaurant:'M has finished working on your restaurant request.',restaurant_bar:'M has finished working on your restaurant request.',ticket_purchase:'M has finished working on your ticket request.',movie_concert_show:'M has finished working on your ticket request.',flight_request:'M has finished working on your air-travel request.'}),ja='option-not-presented',ka='really-bad-experience',la='other',ma=p((l={},l[ka]='Very bad experience; sending the survey'+' would make it worse',l[la]='Other',l)),na=function ta(ua){return (ua.map(function(va,wa){return (c('React').createElement(c('XUISingleSelector.react').Option,{key:va,value:wa},va));}).toList());};function oa(ta){switch(ta){case v:return s;case w:case x:case y:case z:return t;case aa:return u;default:return undefined;}}function pa(ta,ua){var va=ga.get(ua.get('name'),ha);return ta===v&&va!==ha;}var qa=c('React').createClass({displayName:'OzFeedbackCloseDialog',mixins:[c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{onFeedbackDone:m.func.isRequired,title:m.string,intent:m.instanceOf(o).isRequired,scheduleds:m.instanceOf(n).isRequired},getDefaultProps:function ta(){return {title:'Before closing, please tell us how well M did'};},getInitialState:function ta(){return {feedback:o({'close-state':'fulfilled','close-sub-state':v,'objective-reached':null,'not-completed-other':'','user-happy':0,'was-fast':true,'policy-value':fa.keySeq().first(),'automation-value':ba,'automation-opportunity':'','was-bug':false,'did-not-send-survey-reason':this._shouldAllowSendSurvey()?ka:ja}),willSendSurvey:this._shouldAllowSendSurvey(),scheduledsToCancel:q()};},_onCloseChange:function ta(ua){var va=this.props.intent;this.setState({feedback:this.state.feedback.set('close-state',oa(ua.value)).set('close-sub-state',ua.value).set('objective-reached',pa(ua.value,va))});},_onPolicyChange:function ta(ua){this.setState(function(va){var wa=va.feedback;return {feedback:wa.setIn(['policy-value'],ua.value)};});},_onReasonForNotSendingSurveyChange:function ta(ua){this.setState(function(va){var wa=va.feedback;return {feedback:wa.setIn(['did-not-send-survey-reason'],ua.value)};});},_makeOnChangeHandler:function ta(ua){return function(va){this.setState(function(wa){var xa=wa.feedback;return {feedback:xa.set(ua,va)};});}.bind(this);},componentDidMount:function ta(){var ua=this.refs['selector_close-sub-state']?c('ReactDOM').findDOMNode(this.refs['selector_close-sub-state'].refs.button):null;ua&&ua.focus();},render:function ta(){var ua=this.state.scheduledsToCancel&&this.state.scheduledsToCancel.count(),va=!ua&&'Close Intent'||ua===1&&'Close Intent and Delete 1 Scheduled Send'||'Close Intent and Delete '+ua+' Scheduled Sends';return (c('React').createElement(c('MessengerDialog.react'),{onToggle:this._handleToggle,ref:'dialog',type:'default',width:544},c('React').createElement(c('MessengerDialogHeader.react'),null,c('React').createElement(c('MessengerDialogTitle.react'),null,this.props.title)),this._renderFields(),this._renderOptions(),this._renderTimeWarning(),c('React').createElement('div',{className:"_4k_x"},this._renderDialogAction(va,this._handleSave),this._renderDialogAction('Cancel',c('OzActions').hideDialog))));},_renderTimeWarning:function ta(){var ua=this.props.intent,va=ua.getIn(['params','datetime']),wa=va&&va.first()&&va.first().get('value')&&va.first().get('value').endsWith('07:00:00.000Z');return (wa?c('React').createElement('div',{className:"_581n"},'The time set in this intent is 12am, and the AI might schedule some messages around that time. Are you sure you set the time correctly?'):null);},_renderDialogAction:function ta(ua,va){return (c('React').createElement(c('XUIButton.react'),{onClick:va,className:"_42hl",label:ua}));},_renderFields:function ta(){var ua=this.props.intent,va=this.state.feedback,wa=ga.get(ua.get('name'),ha);return (c('React').createElement('div',{className:"_42hk"},c('React').createElement(r,{label:ua.get('name')},c('React').createElement('div',{className:"_8o2"},c('React').createElement('span',null,'Intent opened ',c('OzDate.react').formatTimestamp(ua.get('created-at'))),c('React').createElement('br',null),c('React').createElement('span',null,c('relativeTimeString.atlas')(ua.get('created-at'))))),c('React').createElement(r,{label:'Why are you closing this intent?'},c('React').createElement(c('XUISingleSelector.react'),{className:"_8o2",maxwidth:300,name:'selector_close-sub-state',ref:'selector_close-sub-state',onChange:this._onCloseChange,value:va.get('close-sub-state')},na(ea))),va.get('close-sub-state')===v&&wa!==ha&&c('React').createElement(r,{label:wa},c('React').createElement(c('XUIRadioButtonGroup.react'),{selectedValue:va.get('objective-reached'),onValueChange:this._makeOnChangeHandler('objective-reached'),selectedUse:'confirm',className:"_8o2"},c('React').createElement(c('XUIButton.react'),{value:true,label:'Yes'}),c('React').createElement(c('XUIButton.react'),{value:false,label:'No'}))),va.get('close-sub-state')===w&&c('React').createElement(r,{label:'What policy did the request violate?'},c('React').createElement(c('XUISingleSelector.react'),{maxwidth:1000,name:'selector_policy-value',size:'large',onChange:this._onPolicyChange,value:va.get('policy-value'),className:"_8o2"},na(fa))),va.get('close-sub-state')===z&&c('React').createElement(r,{label:'What was your reason?'},c('React').createElement(c('TextAreaWithLineLimit.react'),{value:va.get('not-completed-other'),onChange:this._makeOnChangeHandler('not-completed-other')})),c('React').createElement(r,{label:'How did the user seem?'},c('React').createElement(c('XUIRadioButtonGroup.react'),{className:"_8o2",selectedValue:va.get('user-happy'),onValueChange:this._makeOnChangeHandler('user-happy'),selectedUse:'confirm'},c('React').createElement(c('XUIButton.react'),{value:4,image:c('React').createElement(c('Image.react'),{src:j('/images/emoticons/heart.png'),title:'User loved it!'})}),c('React').createElement(c('XUIButton.react'),{value:3,image:c('React').createElement(c('Image.react'),{src:j('/images/emoticons/smile.png'),title:'User was happy'})}),c('React').createElement(c('XUIButton.react'),{value:2,image:c('React').createElement(c('Image.react'),{src:j('/images/emoticons/unsure.png'),title:'User was meh'})}),c('React').createElement(c('XUIButton.react'),{value:1,image:c('React').createElement(c('Image.react'),{src:j('/images/emoticons/frown.png'),title:'User was unhappy'})}),c('React').createElement(c('XUIButton.react'),{value:0,image:c('React').createElement(c('Image.react'),{src:j('images/devsite/questionmark.gif'),title:'No Feedback'})}))),c('React').createElement(r,{label:'Did the request go smoothly?'},c('React').createElement(c('XUIRadioButtonGroup.react'),{selectedValue:va.get('was-fast'),onValueChange:this._makeOnChangeHandler('was-fast'),selectedUse:'confirm',className:"_8o2"},c('React').createElement(c('XUIButton.react'),{value:true,label:'Yes: No Bugs and Good Automation'}),c('React').createElement(c('XUIButton.react'),{value:false,label:'No: I have something to report'}))),!va.get('was-fast')&&c('React').createElement(r,{label:'Did a bug affect your work on this request?'},c('React').createElement(c('XUIRadioButtonGroup.react'),{className:"_8o2",selectedValue:va.get('was-bug'),onValueChange:this._makeOnChangeHandler('was-bug'),selectedUse:'confirm'},c('React').createElement(c('XUIButton.react'),{value:false,label:'No'}),c('React').createElement(c('XUIButton.react'),{value:true,label:'Yes'}))),!va.get('was-fast')&&va.get('was-bug')&&c('React').createElement('div',{className:"_4k_y"},'Please',' ',c('React').createElement('a',{href:'https://our.intern.facebook.com/intern/tasks/?q=732683726825240',target:'_blank'},'create a task'),' or use the bugnub. Your feedback helps us make this product great!'),!va.get('was-fast')&&c('React').createElement(r,{label:'Did AI help?',tooltip:'i.e. auto sends, scheduled sends, bubble suggestions, ...'},c('React').createElement(c('XUIRadioButtonGroup.react'),{className:"_8o2",selectedValue:va.get('automation-value'),onValueChange:this._makeOnChangeHandler('automation-value'),selectedUse:'confirm'},c('React').createElement(c('XUIButton.react'),{value:ca,label:'There was no need'}),c('React').createElement(c('XUIButton.react'),{value:ba,label:'Yes, perfectly'}),c('React').createElement(c('XUIButton.react'),{value:da,label:'Could have been better'}))),!va.get('was-fast')&&va.get('automation-value')==da&&c('React').createElement('div',null,c('React').createElement('div',{className:"_4k_y"},'You can provide some feedback here or post in the',' ',c('React').createElement('a',{href:'https://www.facebook.com/groups/880028888735948/',target:'_blank'},'Feedback Group'),'.'),c('React').createElement(r,{label:'How could the AI be improved?'},c('React').createElement(c('TextAreaWithLineLimit.react'),{value:va.get('automation-opportunity'),onChange:this._makeOnChangeHandler('automation-opportunity')})))));},_renderOptions:function ta(){var ua=this.props.intent,va=this.state.feedback;return (c('React').createElement('div',null,this._shouldAllowSendSurvey()&&c('React').createElement('div',{className:"_10-h"},c('React').createElement('input',{type:'checkbox',checked:this.state.willSendSurvey,onChange:this._handleToggleSendSurvey}),c('React').createElement('div',{className:"_10-i"},'Send survey and completion message to user:',c('React').createElement('br',null),c('React').createElement('span',{className:"_10-j"},'"',ia.get(ua.get('name')),'"'))),this._shouldAllowSendSurvey()&&!this.state.willSendSurvey&&c('React').createElement('div',{className:"_10-h"},c('React').createElement(r,{label:'Why have you decided not to send the survey?'},c('React').createElement(c('XUISingleSelector.react'),{className:"_8o2",maxwidth:400,onChange:this._onReasonForNotSendingSurveyChange,value:va.get('did-not-send-survey-reason')},na(ma)))),this.state.config.getIn(['GK','cancelRestaurant'])&&this._perhapsDisplayScheduleds()));},_handleSave:function ta(){this.props.onFeedbackDone(this.props.intent,this._sanitizeFeedback(this.state.feedback.toJS()),this.state.willSendSurvey,this.state.scheduledsToCancel);c('OzActions').hideDialog();},_sanitizeFeedback:function ta(ua){if(ua['close-state']!==s)ua['objective-reached']=false;if(ua['close-sub-state']!==w)ua['policy-value']='';if(ua['close-sub-state']!==z)ua['not-completed-other']='';if(ua['was-fast']){ua['was-bug']=false;ua['automation-value']=ba;}if(ua['automation-value']!==da)ua['automation-opportunity']='';return ua;},_handleToggle:function ta(ua){if(!ua)c('OzActions').hideDialog();},_shouldAllowSendSurvey:function ta(){return ia.has(this.props.intent.get('name'));},_handleToggleSendSurvey:function ta(ua){this.setState({willSendSurvey:!this.state.willSendSurvey});},_handleScheduledItemClick:function ta(ua){!o.isMap(ua)?i(0):void 0;this.setState(function(va){var wa=va.scheduledsToCancel;return {scheduledsToCancel:wa.has(ua)?wa.remove(ua):wa.add(ua)};});},_perhapsDisplayScheduleds:function ta(){var ua=this.props,va=ua.intent,wa=ua.scheduleds,xa={restaurant:'request_type',restaurant_bar:'request_type',appointment:'appt_action'}[va.get('name')],ya=xa&&va.getIn(['params',xa,0,'value']);if(q(['restaurant','restaurant_bar','appointment']).has(va.get('name'))&&ya==='cancel'&&!wa.isEmpty())return (c('React').createElement('div',{className:"_10-h"},c('React').createElement('div',{className:"_10-i"},'Do you need to cancel any scheduled sends?'),c('React').createElement('div',{className:"_5c03"},c('React').createElement('div',{className:"_5c04"},wa.map(function(za,ab){return (c('React').createElement(ra,{key:ab,item:za,isPendingCancel:this.state.scheduledsToCancel.has(za),onClick:this._handleScheduledItemClick}));}.bind(this))))));return null;}});function ra(ta){var ua=ta.item,va=ta.onClick,wa=ta.isPendingCancel,xa=function(ya){switch(ua.get('type')){case 'send':var za=ua.getIn(['data','text']),ab=ua.getIn(['data','images']);return (c('React').createElement('div',{className:"_5c05"},za&&'"'+za+'"',ab&&c('React').createElement(sa,{images:ab})));case 'suggest':return (c('React').createElement('div',{className:"_5c05"},c('React').createElement(c('OzBubblePreview.react'),{bubble:ua.getIn(['data','suggestion']),meta:ua.get('meta'),source:ua.get('source')})));default:c('OzHelpers').debug('[feedbackCloseDialog] could not render scheduled item',ua);return null;}}();return (c('React').createElement('div',{className:"_5c06"+(wa?' '+"_5c07":''),onClick:function ya(za){return va(ua);}},c('React').createElement('div',{className:"_5c11"}),c('React').createElement('div',{className:"_5c12"},c('OzDate.react').formatTimestamp(ua.get('at'))),xa));}function sa(ta){var ua=ta.images;return (c('React').createElement('div',{className:"_5c4_"},ua.map(function(va,wa){return (c('React').createElement(c('Image.react'),{key:wa,className:"_1q16",src:va.get('url'),alt:va.get('filename')}));})));}f.exports=qa;}),null);
__d('OzReminderTaskEditor.react',['cx','OzConstants','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','DatePickerRestraints','OzHelpers','immutable','InputLabel.react','ReactLayeredComponentMixin_DEPRECATED','LayerHideOnBlur','MessengerButton.react','React','XUIContextualDialog.react','XUIDateTimePicker.react','XUIError.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('OzConstants').REMINDERS,j=c('immutable').Map,k=c('immutable').Set,l=c('React').PropTypes,m=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],n=c('immutable').fromJS({traffic:{label:'Include traffic update',params:[{name:'origin',placeholder:'Origin address',err:'What is the origin address?'},{name:'destination',placeholder:'Destination address',err:'What is the destination address?'}]},weather:{label:'Include weather forecast',params:[{name:'location',placeholder:'City',err:'What city is the forecast for?'},{name:'metric',placeholder:'Celsius or Fahrenheit',err:'You need to set Celsius or Fahrenheit'}]}}),o=c('OzHelpers').pure(function(r){var s=r.action,t=r.errors,u=r.onToggle,v=r.onUpdate,w=r.task,x=!!w.getIn(['data','actions',s]);return (c('React').createElement('div',null,c('React').createElement(c('InputLabel.react'),null,c('React').createElement('input',{type:'checkbox',checked:x,onChange:function y(z){return u(z,w,s);}}),c('React').createElement('label',null,n.getIn([s,'label']))),x&&c('React').createElement('div',null,n.getIn([s,'params']).map(function(y){var z=y.get('name'),aa=['data','actions',s,z],ba=w.getIn(aa);return (c('React').createElement(c('XUIError.react'),{key:s+'-'+z,xuiError:t.getIn([s,z])},c('React').createElement('input',{type:y.get('type','text'),className:"_wbw",placeholder:y.get('placeholder'),value:ba,onChange:function ca(da){return v(da,aa);}})));}).valueSeq())));}),p=c('OzHelpers').pure(function(r){var s=r.task,t=r.errors,u=r.onToggle,v=r.onUpdate;return (c('React').createElement('div',null,c('React').createElement('h3',{className:"_17f0"},'Actions'),n.keySeq().map(function(w){return (c('React').createElement(o,{key:w,action:w,task:s,errors:t,onToggle:u,onUpdate:v}));}).valueSeq()));}),q=c('React').createClass({displayName:'OzReminderTaskEditor',mixins:[c('ReactLayeredComponentMixin_DEPRECATED')],propTypes:{onSave:l.func.isRequired,seedTask:l.instanceOf(j),layered:l.bool,location:l.instanceOf(j).isRequired},getInitialState:function r(){return {shown:false,task:this.props.seedTask||j({type:'reminder',state:'waiting'}),errors:j()};},componentWillReceiveProps:function r(s){if(!c('immutable').is(s.seedTask,this.props.seedTask))this.setState({task:s.seedTask,errors:j()});},_renderBody:function r(){var s=this.state,t=s.task,u=s.errors,v=this.props.location,w=k(t.getIn(['schedule','repeat-condition','days']));return (c('React').createElement('ul',{className:"_3ssq"},c('React').createElement('div',{className:"_wbu"},c('React').createElement(c('XUIDateTimePicker.react'),babelHelpers['extends']({xuiError:u.get('scheduled-time'),className:"_wbv",date:new Date(t.get('start-at',c('OzHelpers').serverNow())),allowDuplicateDateSelection:true,onChange:function(x){this.setState({task:c('OzHelpers').updateInWhen(t.set('start-at',+x).set('deadline',+x),['schedule'],function(y){return y.set('start-at',+x);})});}.bind(this)},c('OzHelpers').dateRestraints())),c('React').createElement(c('XUIError.react'),{xuiError:u.get('description')},c('React').createElement('input',{ref:'input',className:"_wbw",placeholder:'Describe the Reminder',value:t.getIn(['data','description']),onChange:function(x){this.setState({task:t.setIn(['data','description'],x.target.value)});}.bind(this)})),c('React').createElement('h3',{className:"_17f0"},'Recurrence'),m.map(function(x,y){var z=y+1;return (c('React').createElement(c('InputLabel.react'),{key:y},c('React').createElement('input',{type:'checkbox',checked:w.has(z),onChange:function(aa){var ba=aa.target.checked?w.add(z):w['delete'](z);this.setState({task:t.set('schedule',j({'start-at':t.get('start-at'),frequency:'weekly',timezone:v.get('timezone'),'timezone-offset':v.get('timezone-offset'),'repeat-condition':j({spacing:1,days:ba.toList()})}))});}.bind(this)}),c('React').createElement('label',null,x)));}.bind(this)),c('React').createElement(p,{task:t,errors:u,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate}),c('React').createElement('div',{className:"_wbz"},c('React').createElement(c('MessengerButton.react'),{label:this.props.seedTask?'Update Reminder':'Add Reminder',disabled:this.state.saving,onClick:this._handleSave,type:'primary'})))));},render:function r(){if(this.props.layered){var s=c('React').Children.only(this.props.children);return c('React').cloneElement(s,{onClick:function(t){return this.setState({shown:!this.state.shown});}.bind(this)});}return this._renderBody();},renderLayers:function r(){var s=this.state.shown;if(!s)return null;return {contextualDialog:c('React').createElement(c('XUIContextualDialog.react'),{behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll'),LayerHideOnBlur:c('LayerHideOnBlur')},position:'below',shown:s,contextRef:function(){return this;}.bind(this),onToggle:function(t){return this.setState({shown:t});}.bind(this)},this._renderBody())};},_handleActionToggle:function r(s,t,u){var v=s.target.checked?t.setIn(['data','actions'],j([[u,j()]])):t.deleteIn(['data','actions']);this.setState({task:v});},_handleActionUpdate:function r(s,t){this.setState({task:this.state.task.setIn(t,s.target.value)});},_handleSave:function r(){var s=this.state.task,t=s.get('start-at'),u=function x(y){return !!s.getIn(['actions',y]);},v=j(),w=c('OzHelpers').dateRestraints().dateRestraints;if(!t){v=v.set('scheduled-time','When would you like the reminder?');}else if(t<c('OzHelpers').serverNow()+60*1000){v=v.set('scheduled-time','Reminders should be in the future!');}else if(!c('DatePickerRestraints').isValidDate(new Date(t),w))v=v.set('scheduled-time','Reminder is outside of the '+i.RANGE_IN_YEARS+' year range');if(!s.getIn(['data','description']))v=v.set('description','What is the reminder about?');v=n.reduce(function(x,y,z){if(u(z))x=y.get('params').reduce(function(aa,ba){return s.getIn(['data','actions',z,ba.get('name')])?aa:aa.setIn([z,ba.get('name')],ba.get('err'));},x);return x;},v);this.setState({errors:v});if(v.size)return;this.setState({saving:true},function(x){this.props.onSave(s).then(function(y){if(this.props.layered)this.setState({shown:false,saving:false});}.bind(this))['catch'](function(y){return this.setState({saving:false});}.bind(this));}.bind(this));}});f.exports=q;}),null);
__d('OzIntentActions.react',['cx','Promise','OzAPI','OzHelpers','Image.react','immutable','joinClasses','OzActions','OzConfig','OzDraggable.react','OzReminderTaskEditor.react','OzImmutablePureRenderMixin','React','Reflux','XUICloseButton.react'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('immutable').Map,l=c('React').PropTypes,m=5*60000,n=10*60000,o=c('React').createClass({displayName:'OzIntentActions',propTypes:{intent:l.instanceOf(k).isRequired,location:l.instanceOf(k).isRequired,userEmail:l.string},mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],contextTypes:{router:l.object.isRequired},getInitialState:function r(){return {reminderShown:false};},render:function r(){var s=this.state.config,t=s.get('display-tasks')||s.getIn(['GK','timeline']);return (c('React').createElement('div',{className:c('joinClasses')("_x-r",this.props.className)},c('React').createElement('div',{className:(t?"_2p6s":'')+(!t?' '+"_ukm":''),style:this.props.timelineGK?{borderTop:'none'}:null},t?[['mail',this._handleEmail],['call',this._handleCall],['calendar',this._handleInvite],['todo',this._handleTask]].map(function(u){var v=u[0],w=u[1];return (c('React').createElement('button',{key:v,className:"_1-hv _2p6t",onClick:w},c('React').createElement(c('Image.react'),{className:"_2p6u",id:v,src:'/images/oz/intent/'+v+'-2x.png'})));}):[['call',this._handleCall],['email',this._handleEmail],['invite',this._handleInvite]].map(function(u){var v=u[0],w=u[1];return (c('React').createElement('button',{key:v,className:"_1-hv _ukn",onClick:w},v));})),this.state.reminderShown&&t?c('React').createElement(p,{onClose:this._handleCloseReminderTask,onCreate:this._handleCreateReminderTask,location:this.props.location}):null));},_handleTask:function r(){var s=this.props.intent,t=s.get('id'),u=s.get('user-id'),v=k({deadline:c('OzHelpers').serverNow()+n+m,'intent-id':t,'start-at':c('OzHelpers').serverNow()+n,state:'waiting',type:'reminder',data:{description:''}});c('OzAPI').createTask(u,v).then(function(w){this.context.router.push(c('OzHelpers').threadPath({threadid:u,intentid:t,taskid:w}));}.bind(this)).done();},_handleCreateReminderTask:function r(s){var t=this.props.intent;return c('OzAPI').createTask(t.get('user-id'),s.set('intent-id',t.get('id'))).then(function(u){return this.setState({reminderShown:false});}.bind(this));},_handleCloseReminderTask:function r(){this.setState({reminderShown:false});},_handleEmail:function r(){var s=this.props.intent;c('OzActions').emailComposer.add({intentId:s.get('id'),from:s.get('email-address')});},_handleInvite:function r(){c('OzActions').inviteComposer.create(this.props.intent.get('id'),this.props.userEmail,this.props.location.get('timezone'));},_handleCall:function r(){q(this.props.intent).done(function(s){return c('OzActions').twilio.useIntent(s);});}});i=babelHelpers.inherits(p,c('React').Component);j=i&&i.prototype;p.prototype.render=function(){'use strict';var r=this.props,s=r.onClose,t=r.onCreate,u=r.location;return (c('React').createElement(c('OzDraggable.react'),{className:"_2jc4"},c('React').createElement('div',{className:"_2jc5"},'Reminder',c('React').createElement(c('XUICloseButton.react'),{onClick:s})),c('React').createElement(c('OzReminderTaskEditor.react'),{onSave:t,location:u})));};function p(){'use strict';i.apply(this,arguments);}p.propTypes={onClose:l.func.isRequired,onCreate:l.func.isRequired};function q(r){var s=r.get('phone-number');return s?c('Promise').resolve(r):c('OzAPI').addPhoneNumber(r.get('user-id'),r.get('id')).then(function(t){return r.merge(t);});}f.exports=o;}),null);
__d('OzIntentParams.react',['cx','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();i=babelHelpers.inherits(k,c('React').Component);j=i&&i.prototype;k.prototype.render=function(){return (c('React').createElement('div',{className:"_3-ue"},this.props.children));};function k(){i.apply(this,arguments);}f.exports=k;}),null);
__d('OzIntentParamsAbstractField.react',['cx','React'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;l.prototype.render=function(){return (c('React').createElement('div',{className:"_5nij"+(!this.props.hasValue?' '+"_2ez0":'')},this.props.label?c('React').createElement('label',{className:"_2230 ellipsis"},this.props.label):null,c('React').createElement('div',{className:"_2ulp"},c('React').Children.only(this.props.children))));};function l(){i.apply(this,arguments);}l.propTypes={hasValue:k.bool,label:k.string};f.exports=l;}),null);
__d('OzIntentParamsTextField.react',['invariant','AbstractTextArea.react','DOMQuery','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React','ReactDOM','TextAreaControl'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzIntentParamsTextField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:i.string,onAsk:i.func,onChange:i.func,question:i.string,value:i.string.isRequired},_control:null,componentDidMount:function k(){var l=c('DOMQuery').find(c('ReactDOM').findDOMNode(this),'textarea');this._control=new (c('TextAreaControl'))(l);this._control.setAutogrow(true);this._control.onupdate();},componentDidUpdate:function k(l,m){if(l.value!==this.props.value)this._control.onupdate();},render:function k(){return (c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!this.props.value,onAsk:this.props.onAsk,question:this.props.question},c('React').createElement(c('AbstractTextArea.react'),{onChange:this._handleChange,placeholder:this.props.label,value:this.props.value})));},_handleChange:function k(l){var m=l.target;!(m instanceof HTMLTextAreaElement)?h(0):void 0;this.props.onChange&&this.props.onChange(m.value);}});f.exports=j;}),null);
__d('OzRequirementTokenizer.react',['immutable','OzImmutablePureRenderMixin','React','OzTokenizer.react'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('immutable').Map,i=c('immutable').List,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzRequirementTokenizer',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{allRequirements:j.instanceOf(h).isRequired,onDeleteRequirement:j.func.isRequired,onCreateRequirement:j.func.isRequired,selectedRequirements:j.instanceOf(i),placeholder:j.string.isRequired,timeline:j.bool},getDefaultProps:function l(){return {timeline:false};},_requirementSort:function l(m){var n=this.props.witIntentUUID,o=m.get('wit-intent-uuids').has(n)?100000:0;return -(o+m.get('used-count',0));},render:function l(){var m=this.props,n=m.allRequirements,o=m.selectedRequirements,p=m.placeholder,q=m.onDeleteRequirement,r=m.onCreateRequirement,s=m.timeline;return (c('React').createElement(c('OzTokenizer.react'),{placeholder:p,allTokens:n.toList(),chosenTokens:o,onDeleteToken:q,onCreateToken:r,resultRank:this._requirementSort,resultFilter:function t(u,v){return (u.get('name').toLowerCase().indexOf(v.toLowerCase())>=0);},timeline:s}));}});f.exports=k;}),null);
__d('OzTimestampScrolling.react',['cx','OzActions','React','Tooltip'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=3000;i=babelHelpers.inherits(m,c('React').PureComponent);j=i&&i.prototype;function m(){var n,o;'use strict';for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=j.constructor).call.apply(o,[this].concat(q)),this.state={state:null},this.$OzTimestampScrolling2=function(){this.setState({state:'loading'});c('OzActions').scrollThreadToTimestamp(this.props.timestamp);}.bind(this),n;}m.prototype.componentDidMount=function(){'use strict';this.$OzTimestampScrolling1=c('OzActions').doneScrollingToTimestamp.listen(function(n,o){if(this.props.timestamp===n)if(o){this.setState({state:'error'},function(p){window.setTimeout(function(q){this.setState({state:null});}.bind(this),l);}.bind(this));}else this.setState({state:null});}.bind(this));};m.prototype.componentWillUnmount=function(){'use strict';this.$OzTimestampScrolling1();};m.prototype.render=function(){'use strict';var n="_1e3l"+(!this.state.state?' '+"_1y5w":'')+(this.state.state==='loading'?' '+"_1y5x":'')+(this.state.state==='error'?' '+"_1y5y":'');return (c('React').createElement('span',{className:n,onClick:this.$OzTimestampScrolling2},this.props.children));};m.propTypes={timestamp:k.number.isRequired};f.exports=m;}),null);
__d('OzSidebarItemHeader.react',['cx','OzHelpers','Keys','OzCheckboxInput.react','OzConfig','OzDate.react','OzTimestampScrolling.react','OzImmutablePureRenderMixin','React','Reflux','Tooltip','XUIAbstractGlyphButton.react','XUICloseButton.react','FBButtonMenuCombo.react','OzButton.react','joinClasses'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('FBButtonMenuCombo.react').Item,j=c('React').PropTypes,k=c('React').createClass({displayName:'OzSidebarItemHeader',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{alias:j.string,closedAt:j.number,createdAt:j.number,creator:j.string,intentId:j.number,isBlocked:j.bool,isClosed:j.bool.isRequired,isExpanded:j.bool,label:j.string,onCancel:j.func,onChangeAlias:j.func,onIsExpandedToggle:j.func,onToggle:j.func,skipScrollToTimestamp:j.bool,subtitle:j.node,timelineGK:j.bool,title:j.string.isRequired},getDefaultProps:function m(){return {timelineGK:false};},getInitialState:function m(){return {isEditing:false};},render:function m(){var n=this.props,o=n.alias,p=n.className,q=n.closedAt,r=n.createdAt,s=n.intentId,t=n.isBlocked,u=n.isClosed,v=n.isExpanded,w=n.label,x=n.onCancel,y=n.onIsExpandedToggle,z=n.onToggle,aa=n.skipScrollToTimestamp,ba=n.subtitle,ca=n.timelineGK,da=n.title,ea=u?q:r,fa=this.state.config.getIn(['GK','timeline']),ga=s&&fa?{color:'white'}:{},ha=s&&fa?{background:c('OzHelpers').color(s)}:{};return (c('React').createElement('div',{className:c('joinClasses')(p,"_31gu"+(v?' '+"_31gx":'')+(t?' '+"_27qc":'')+(u&&!ca?' '+"_31gy":''))},z?c('React').createElement(c('OzCheckboxInput.react'),{checked:u,className:"_31gz",onChange:z}):null,c('React').createElement('div',{className:"_31g-"},c('React').createElement('div',null,c('React').createElement('span',null,ea?aa?c('React').createElement(c('OzDate.react'),{className:"_56sd",timestamp:ea}):c('React').createElement(c('OzTimestampScrolling.react'),{timestamp:ea},c('React').createElement(c('OzDate.react'),{className:"_56sd",timestamp:ea})):null),c('React').createElement(l,{alias:o,isBlocked:t,isEditing:this.state.isEditing,name:da,onChange:this._handleChangeAlias,onStartEditing:this._handleStartEditing,onCancelEditing:this._handleCancelEditing}),w?c('React').createElement('span',{className:"_5o4m"},w):null),c('React').createElement('span',{className:"_31h0"},ba)),c('React').createElement('div',{className:"_3_41"},this.props.children,y?c('React').createElement(c('XUIAbstractGlyphButton.react'),{className:"_31h1",onClick:y}):null,x&&c('React').createElement(c('XUICloseButton.react'),{onClick:x}))));},_handleStartEditing:function m(){this.props.onChangeAlias&&this.setState({isEditing:true});},_handleCancelEditing:function m(){this.setState({isEditing:false});},_handleChangeAlias:function m(n){var o=this.props.onChangeAlias;if(n.which===c('Keys').RETURN){o&&o(n.target.value);this.setState({isEditing:false});}}}),l=c('OzHelpers').pure(function(m){var n=m.name,o=m.isBlocked,p=m.isEditing,q=m.alias,r=m.onChange,s=m.onStartEditing,t=m.onCancelEditing,u=m.style;return (p?c('React').createElement('textarea',{className:"_31g_"+(' '+"_1p0b"),style:u,onKeyDown:r,placeholder:n,defaultValue:q,onBlur:t,ref:function v(w){if(w){w.focus();c('OzHelpers').moveCursorToInputEnd(w);}}}):c('React').createElement('span',babelHelpers['extends']({className:"_31g_"+(o?' '+"_7ok":''),style:u,onClick:s},c('Tooltip').propsFor(q?n:null)),q||n));});f.exports=k;}),null);
__d('OzGenericIntent.react',['ix','cx','Promise','OzAPI','fbglyph','OzHelpers','promiseFinally','Image.react','immutable','MessengerButton.react','OzButton.react','OzConfig','OzFormPreview.react','OzIntentActions.react','OzIntentParams.react','OzRequirementTokenizer.react','OzSidebarItemHeader.react','OzImmutablePureRenderMixin','React','Reflux','OzIntentParamsTextField.react','Tooltip','OzDate.react','OzStatsDashboard.react','OzTimestampScrolling.react','URI','XUISingleSelector.react','OzActions','OzFeedbackCloseDialog.react'],(function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('OzStatsDashboard.react').OzStatsSurvey,k=c('immutable').List,l=c('immutable').Map,m=c('immutable').Set,n=c('React').PropTypes,o=c('OzFormPreview.react').Row,p=c('XUISingleSelector.react').Option,q=c('React').createClass({displayName:'OzGenericIntent',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{intent:n.instanceOf(l).isRequired,location:n.instanceOf(l).isRequired,notes:n.string.isRequired,onChangeAlias:n.func.isRequired,onClose:n.func.isRequired,onNotesChange:n.func.isRequired,onOpen:n.func.isRequired,onIsBlockedToggle:n.func.isRequired,onTriggerAI:n.func.isRequired,requirements:n.instanceOf(l).isRequired,onCreateRequirement:n.func,onDeleteRequirement:n.func,repNames:n.instanceOf(l).isRequired,userEmail:n.string,thread:n.instanceOf(l).isRequired,timelineGK:n.bool},render:function aa(){var ba=this.props,ca=ba.intent,da=ba.repNames,ea=ba.timelineGK,fa=c('OzHelpers').isDeleted(ca);if(fa)return c('React').createElement('span',null);var ga=ca.get('creator-fbid'),ha=da.get(ga,ga),ia=ca.get('blocked'),ja=c('OzHelpers').intentName(ca);return (c('React').createElement('div',{className:"_37lt"},c('React').createElement(c('OzSidebarItemHeader.react'),{alias:ca.get('alias'),className:(!ea?"_a2q":'')+(ea?' '+"_37lv":''),intentId:ca.get('id'),isClosed:c('OzHelpers').isClosedIntent(ca),onClose:this._handleClose,closeState:ca.get('state'),isBlocked:ia,onChangeAlias:this._handleChangeAlias,onFeedback:this._handleIntentFeedback,onToggle:this._handleToggle,onTriggerAI:this.props.onTriggerAI,timelineGK:ea,title:ja,creator:ha},this._renderTriggerAI()),this._renderBody()));},_renderTriggerAI:function aa(){var ba=h("\/images\/assets_DO_NOT_HARDCODE\/fb_glyphs\/bolt-auto_16_white.png"),ca=h("\/images\/assets_DO_NOT_HARDCODE\/fb_glyphs\/bolt-auto_16_fig-black.png"),da=this.state.config.getIn(['GK','timeline'])?ba:ca;return (c('React').createElement(c('OzButton.react'),babelHelpers['extends']({tight:true,onClick:this.props.onTriggerAI},c('Tooltip').propsFor('Rerun the AI for this intent')),c('React').createElement(c('Image.react'),{src:da})));},_renderBody:function aa(){var ba=this.props,ca=ba.intent,da=ba.repNames,ea=ba.userEmail,fa=ba.location,ga=ba.thread,ha=ba.timelineGK,ia=ba.children,ja=ca.get('creator-fbid'),ka=ja===c('OzConfig').getStaticConfig('PAGE_ID')?'Bot':ja,la='Created by '+da.get(ja,ka);return (c('React').createElement('div',null,!ha?c('React').createElement(c('OzIntentActions.react'),{intent:ca,userEmail:ea,location:fa}):null,c('React').createElement('div',{className:"_1x_z"},c('React').createElement(c('OzFormPreview.react'),null,c('React').createElement(o,{label:'Status',className:"_10sn"},c('React').createElement(s,{intent:ca,thread:ga})),c('React').createElement(o,{label:'Created',tip:la,className:"_10sn"},t(ca.get('created-at'))),c('React').createElement(o,{label:'Closed',className:"_10sn"},t(ca.get('closed-at'))),c('React').createElement(o,{label:'Assigned Bot',className:"_10sn"},ca.get('assigned-bot')||'None'))),c('React').createElement('div',{className:"_10sn"},ia.length?c('React').createElement(c('OzIntentParams.react'),null,ia):null,c('React').createElement('div',{className:"_2qn_"},this.state.config.getIn(['GK','bookOnOpenTableButton'])&&w(ca)?this._renderOpenTableButton():null,this.state.config.getIn(['GK','scriptRestaurantClose'])&&w(ca)?this._renderAutomationTrigger():null)),c('React').createElement('div',{className:"_1x-e _10sn"},c('React').createElement(c('OzRequirementTokenizer.react'),{allRequirements:this.props.requirements,onCreateRequirement:this._handleCreateRequirement,onDeleteRequirement:this._handleDeleteRequirement,selectedRequirements:ca.get('requirements'),placeholder:'Add a requirement/tag...'})),c('React').createElement(c('OzIntentParams.react'),null,c('React').createElement('div',{className:"_19ny"},c('React').createElement(c('OzIntentParamsTextField.react'),{label:'Add notes about this intent...',onChange:this.props.onNotesChange,value:this.props.notes}))),ha?c('React').createElement(c('OzIntentActions.react'),{intent:ca,userEmail:ea,location:fa,timelineGK:ha}):null));},_renderOpenTableButton:function aa(){var ba=this.props,ca=ba.thread,da=ba.intent,ea=x(ca,da),fa=y(ea);if(!this.state.config.getIn(['GK','openTableAPI'])){return (c('React').createElement(c('MessengerButton.react'),{className:(!(fa&&fa.length>0)?"_2qo0":'')+(' '+"_2qo1"),onClick:this._handleOpenTableClick,type:'primary',label:'Book on OT'}));}else{var ga=da.getIn(['params','request_type'],k()).first();if(!ga||ga.get('value')!=='reservation')return null;var ha=z(da),ia=!ha.isEmpty()?'Missing fields: '+ha.join(', '):'Book on OpenTable, schedule autosends, and send invite';return (c('React').createElement(c('MessengerButton.react'),{className:(!ha.isEmpty()?"_2qo0":'')+(' '+"_2qo1"),onClick:this._handleOpenTableClick,type:'primary',label:'Book on OT via API',title:ia}));}},_renderAutomationTrigger:function aa(){var ba=this.props.intent,ca=ba.getIn(['params','request_type'],k()).first();if(!ca||ca.get('value')!=='reservation')return null;var da=z(ba),ea=!da.isEmpty()?'Missing fields: '+da.join(', '):'Send confirmation message, schedule autosends, and send invite';return (c('React').createElement(c('MessengerButton.react'),{className:(!da.isEmpty()?"_2qo0":'')+(' '+"_2qo1"),onClick:this._handleAutomationClick,type:'primary',label:'Run close automation',title:ea}));},_handleAutomationClick:function aa(ba){var ca=this.props,da=ca.thread,ea=ca.intent,fa=c('OzHelpers').threadID(da),ga=ea.get('id'),ha='close-restaurant',ia=c('OzHelpers').getRequirement(ea,ha),ja=ia?c('OzAPI').deleteIntentRequirement(fa,ga,ia.get('id')):c('Promise').resolve();return ja.then(function(){return c('OzAPI').createIntentRequirement(fa,ga,ha);});},_handleOpenTableClick:function aa(ba){var ca=this.props,da=ca.thread,ea=ca.intent,fa=x(da,ea);if(fa.has('opentable-url'))if(this.state.config.getIn(['GK','openTableAPI'])&&fa.has('ts')&&fa.has('rid')&&fa.has('party-size')){c('OzAPI').bookOpenTable(c('OzHelpers').threadID(da),ea.get('id'),fa.get('rid'),fa.get('ts'),fa.get('party-size'));}else{var ga=y(fa);if(ga.length)window.open(ga,'_blank').focus();}},_handleChangeAlias:function aa(ba){var ca=this.props,da=ca.intent,ea=ca.onChangeAlias;ea&&ea(da,ba);},_handleOpen:function aa(){var ba=this.props,ca=ba.intent,da=ba.onOpen;da(ca.get('id'));},_handleClose:function aa(ba){var ca=this.props,da=ca.intent,ea=ca.onClose;ea(da.get('id'),ba);},_handleIsBlockedToggle:function aa(){var ba=this.props,ca=ba.intent,da=ba.onIsBlockedToggle;da(ca);},_handleCreateRequirement:function aa(ba){var ca=this.props,da=ca.intent,ea=ca.onCreateRequirement;if(ea)ea(da.get('id'),ba.get('name'));},_handleDeleteRequirement:function aa(ba){var ca=this.props,da=ca.intent,ea=ca.onDeleteRequirement;if(ea)ea(da.get('id'),ba.get('id'));}}),r=['Active','Waiting','Closed'],s=c('React').createClass({displayName:'StatusDropdown',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{intent:n.instanceOf(l).isRequired,thread:n.instanceOf(l).isRequired},getInitialState:function aa(){return {sem:0};},render:function aa(){var ba=this.props.intent,ca=v(ba),da=u(ba).set('rating3',ca.rating3).set('user-feedback',ca.feedback);return (c('React').createElement('div',null,c('React').createElement(c('XUISingleSelector.react'),{maxHeight:240,onChange:this._handleChange,value:this._value(),disabled:this.state.sem!==0},r.map(function(ea){return (c('React').createElement(p,{key:ea,value:ea},ea));})),c('React').createElement(j,{meta:da})));},_value:function aa(){var ba=this.props.intent;return (c('OzHelpers').isBlockedIntent(ba)&&'Waiting'||c('OzHelpers').isClosedIntent(ba)&&'Closed'||'Active');},_handleChange:function aa(ba){var ca=ba.value;switch(ca){case 'Active':this._handleOpen();break;case 'Waiting':this._handleWaiting();break;case 'Closed':this._handleIntentFeedback();break;default:c('OzHelpers').debug('[unknown intent state]');}},_sem:function aa(ba){var ca=function(da){return this.setState(function(ea){return {sem:ea.sem+da};});}.bind(this);ca(1);c('promiseFinally')(ba,function(da){return ca(-1);});},_handleOpen:function aa(){var ba=this.props.intent;this._sem(c('OzAPI').openIntent(ba.get('user-id'),ba.get('id')));},_handleWaiting:function aa(){var ba=this.props.intent;this._sem(c('OzAPI').blockIntent(ba.get('user-id'),ba.get('id')));},_handleIntentFeedback:function aa(){var ba=this.props,ca=ba.intent,da=ba.thread,ea=da.get('events',k()).filter(function(fa){return (m(['send','suggest']).has(fa.get('type'))&&fa.get('at',0)>c('OzHelpers').serverNow());}).sortBy(function(fa){return fa.get('at');});c('OzActions').showDialog(c('OzFeedbackCloseDialog.react'),{intent:ca,scheduleds:ea,title:'Close Intent',onFeedbackDone:function(fa,ga,ha,ia){var ja=ga['close-state'];ia&&ia.map(function(ka){return (c('OzAPI').deleteScheduled(c('OzHelpers').threadID(da),ka.get('id')));});this._sem(c('OzAPI').closeIntent(fa.get('user-id'),fa.get('id'),ja,ga,ha));c('OzActions').hideDialog();}.bind(this)});}});function t(aa){return aa?c('React').createElement(c('OzTimestampScrolling.react'),{timestamp:aa},c('React').createElement(c('OzDate.react'),{timestamp:aa})):null;}function u(aa){return (aa.get('events',k()).filter(function(ba){return ba.get('type')==='close-intent';}).maxBy(function(ba){return ba.get('timestamp');})||l()).get('data',l());}function v(aa){var ba=(aa.get('events',k()).filter(function(ca){return ca&&ca.getIn(['data','action'])==='intent_survey';}).last()||l()).getIn(['data','metadata'],'{}');return JSON.parse(ba);}function w(aa){var ba=aa.getIn(['metadata','category']);return ba==='restaurant';}function x(aa,ba){var ca=l(),da=aa.get('guesses',k()).filter(function(oa){return oa.get('class')==='suggestions';}).first(),ea=da?da.get('items',k()).filter(function(oa){return oa.get('type')==='bubble';}):k();if(ea.count()>0){var fa=ea.first().get('meta',l()),ga=fa.getIn(['open-table','url']),ha=fa.getIn(['open-table','rid']);ca=ca.set('rid',ha);if(ga&&ga.length>0){ca=ca.set('opentable-url',ga);var ia=ba.get('params',l()),ja=ia.get('datetime',k()).first(),ka=ja?ja.get('value',''):'';if(ka.length>0){var la=new Date(ka).getTime();ca=ca.set('ts',la);}var ma=ia.get('people_number',k()).first(),na=ma?ma.get('value',0):0;if(na>0)ca=ca.set('party-size',na);}}return ca;}function y(aa){var ba=aa.get('opentable-url');if(ba&&ba.length>0){var ca=new (c('URI'))(ba),da=aa.get('ts');if(da){var ea=new Date().getTimezoneOffset()*60000,fa=new Date(da-ea).toISOString().slice(0,-1);ca.addQueryData('dateTime',fa);}var ga=aa.get('party-size',0);if(ga>0)ca.addQueryData('covers',ga);return ca.toString();}return '';}function z(aa){var ba=k(['datetime','location','people_number','restaurant_name','place_id']);return ba.filterNot(function(ca){return aa.getIn(['params',ca]);});}f.exports=q;}),null);
__d('OzIntentParamsDateTimeField.react',['immutable','OzDateTimePicker.react','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=c('immutable').Map,j=c('React').createClass({displayName:'OzIntentParamsDateTimeField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:h.string,location:h.instanceOf(i).isRequired,onChange:h.func,value:h.instanceOf(Date)},getInitialState:function k(){return {timezone:this.props.location.get('timezone')};},render:function k(){return (c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!this.props.value,label:this.props.label},c('React').createElement(c('OzDateTimePicker.react'),{datePlaceholder:this.props.label,layout:'three-line',onChange:this._handleChange,showTimezoneName:false,timestamp:this.props.value&&this.props.value.getTime(),timezone:this.state.timezone})));},_handleChange:function k(l){var m=l.timezone,n=l.timestamp;this.props.onChange(new Date(n));this.setState({timezone:m});}});f.exports=j;}),null);
__d('OzIntentParamsEnumField.react',['immutable','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React','XUISingleSelector.react'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('immutable').List,i=c('immutable').OrderedSet,j=c('React').PropTypes,k=c('XUISingleSelector.react').Option,l=c('React').createClass({displayName:'OzIntentParamsEnumField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:j.string,onChange:j.func,onSave:j.func,placeholder:j.string,values:j.arrayOf(j.string).isRequired,value:j.string},getInitialState:function m(){return {value:this.props.value||''};},render:function m(){var n=(this.state.value?i(this.props.values).add(this.state.value).toList():h(this.props.values)).map(function(o){return (c('React').createElement(k,{key:o,value:o},o));}).unshift(c('React').createElement(k,{key:this.props.placeholder,value:''},this.props.placeholder));return (c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!this.state.value,label:this.props.label},c('React').createElement(c('XUISingleSelector.react'),{maxHeight:240,onChange:this._handleChange,value:this.state.value},n)));},_handleChange:function m(n){this.props.onChange&&this.props.onChange(n.value);this.setState({value:n.value},this._save);},_save:function m(){if(this.props.onSave)this.props.onSave(this.state.value);}});f.exports=l;}),null);
__d('OzIntentParamsNumberField.react',['cx','FBNumberInput.react','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzIntentParamsNumberField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:i.string,onChange:i.func,placeholder:i.string,value:i.number},render:function k(){return (c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:this.props.value!=null,label:this.props.label},c('React').createElement(c('FBNumberInput.react'),{className:"_3dag",onValueChange:this.props.onChange,placeholder:this.props.placeholder,value:this.props.value})));}});f.exports=j;}),null);
__d('OzPlaceField.react',['cx','joinClasses','immutable','OzConfig','OzLocationSearchSource','ReactComponentWithPureRenderMixin','React','Reflux','SearchableEntry','XUIError.react','XUITypeahead.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('immutable').Map,k=c('React').createClass({displayName:'OzPlaceField',mixins:[c('ReactComponentWithPureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:babelHelpers['extends']({disabled:i.bool,onQueryStringChange:i.func.isRequired,onSelect:i.func.isRequired,placeholder:i.string,queryString:i.string,selectedEntry:i.instanceOf(j)},c('XUIError.react').PropTypes),getDefaultProps:function n(){return {disabled:false,placeholder:'Place'};},render:function n(){var o=this.props,p=o.className,q=o.disabled,r=o.onQueryStringChange,s=o.onSelect,t=o.placeholder,u=o.queryString,v=o.selectedEntry,w=c('joinClasses')("_44sp"+(q?' '+"_44sq":''),p);return (c('React').createElement(c('XUITypeahead.react'),{className:w,disabled:q,onChange:function x(y){return r(y.target.value);},onSelectAttempt:function x(y){return s(l(y));},placeholder:t,queryString:u,searchSource:c('OzLocationSearchSource'),selectedEntry:v&&v.get('id')&&v.get('name')?m(v):null,showEntriesOnFocus:true,tallInput:false,xuiErrorPosition:'left'}));}});function l(n){return j({id:+n.getUniqueID(),name:n.getTitle(),description:n.getSubtitle(),photo:n.getPhoto()});}function m(n){return new (c('SearchableEntry'))({title:n.get('name'),subtitle:n.get('description'),uniqueID:n.get('id'),photo:n.get('photo')});}f.exports=k;}),null);
__d('OzIntentParamsPlaceField.react',['OzIntentParamsAbstractField.react','OzPlaceField.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=c('React').createClass({displayName:'OzIntentParamsPlaceField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:h.string,onChange:h.func,onSave:h.func,placeholder:h.string,value:h.oneOfType([h.string,h.object])},render:function j(){var k=this.props,l=k.value,m=k.label,n=k.onChange,o=k.placeholder,p=l?typeof l==='string'?l:l.get('name')||'':'';return (c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!l,label:m},c('React').createElement(c('OzPlaceField.react'),{onQueryStringChange:n,onSelect:n,placeholder:o,queryString:p,selectedEntry:typeof l==='object'?l:null})));}});f.exports=i;}),null);
__d('OzIntentParamsPriceRangeField.react',['cx','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=[1,2,3,4],k=c('React').createClass({displayName:'OzIntentParamsPriceRangeField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:i.string,onChange:i.func,value:i.oneOf(j)},render:function l(){var m=this.props.value;return (c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!m,label:this.props.label},c('React').createElement('span',{className:"_8l3"},j.map(function(n){return (c('React').createElement('span',{className:"_8l4"+(m&&n<=m?' '+"_8l6":''),key:n,onClick:function(o){return this._handleDollarClick(o,n);}.bind(this)},'$'));}.bind(this)))));},_handleDollarClick:function l(m,n){m.preventDefault();var o=this.props.value==n?null:n;this.props.onChange&&this.props.onChange(o);}});f.exports=k;}),null);
__d('OzIntentParamsStringField.react',['invariant','AbstractTextInput.react','OzIntentParamsAbstractField.react','OzImmutablePureRenderMixin','React','debounce'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('React').PropTypes,j=c('React').createClass({displayName:'OzIntentParamsStringField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{label:i.string,onChange:i.func,onSave:i.func,placeholder:i.string,value:i.string},getInitialState:function k(){return {value:this.props.value||''};},componentWillMount:function k(){this._save=c('debounce')(this._save,750,this,true);},render:function k(){return (c('React').createElement(c('OzIntentParamsAbstractField.react'),{hasValue:!!this.state.value,label:this.props.label},c('React').createElement(c('AbstractTextInput.react'),{onChange:this._handleChange,placeholder:this.props.placeholder,type:'text',value:this.state.value})));},_handleChange:function k(l){var m=l.target;!(m instanceof HTMLInputElement)?h(0):void 0;this.props.onChange&&this.props.onChange(m.value);this.setState({value:m.value},this._save);},_save:function k(){if(this.props.onSave)this.props.onSave(this.state.value);}});f.exports=j;}),null);
__d('OzIntentFactoryHelpers',['immutable','React','OzIntentParamsStringField.react','OzIntentParamsNumberField.react','OzIntentParamsPriceRangeField.react','OzIntentParamsEnumField.react','OzIntentParamsDateTimeField.react','OzIntentParamsPlaceField.react'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('immutable').Map,i={makeStateUpdater:function l(m){return function(n){var o;this._setStateAndSave((o={},o[m]=n,o));};},makeStateExtractor:function l(m){return function(n){var o=n.get('params')||h(),p={};for(var q=m,r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var t;if(r){if(s>=q.length)break;t=q[s++];}else{s=q.next();if(s.done)break;t=s.value;}var u=t,v=u.name,w=u.type,x=j(o,v);switch(w){case 'string':case 'enum':p[v]=''+(x||'');break;case 'number':case 'pricerange':p[v]=+x||null;break;case 'datetime':p[v]=x&&new Date(x);break;case 'place':var y=j(o,'place_id');p[v]=h({id:y,name:x});break;}}return babelHelpers['extends']({},p,{notes:n.get('notes')||''});};},makeParamsUpdater:function l(m){return function(n,o){return (n||h()).withMutations(function(p){for(var q=m,r=Array.isArray(q),s=0,q=r?q:q[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var t;if(r){if(s>=q.length)break;t=q[s++];}else{s=q.next();if(s.done)break;t=s.value;}var u=t,v=u.name,w=u.type;switch(w){case 'datetime':var x=o[v],y=x?{value:x.toISOString(),grain:'minute'}:undefined;k(p,v,y);break;case 'place':var z=o[v];if(typeof z==='object'){k(p,'place_id',{value:z.get('id')});k(p,v,{value:z.get('name')});}else{k(p,'place_id',{value:null});k(p,v,{value:z});}break;default:k(p,v,{value:o[v]});break;}}});};},makeFieldRenderer:function l(m){return function(n){return m.map(function(o){var p=o.label,q=o.name,r=o.placeholder,s=o.type,t=o.values,u=i.getFieldComponent(s);return (c('React').createElement(u,{key:q,label:p,location:n,onChange:this._changeHandlers.get(q),placeholder:r||p,value:this.state[q],values:t}));}.bind(this));};},getFieldComponent:function l(m){switch(m){case 'string':return c('OzIntentParamsStringField.react');case 'number':return c('OzIntentParamsNumberField.react');case 'pricerange':return c('OzIntentParamsPriceRangeField.react');case 'enum':return c('OzIntentParamsEnumField.react');case 'datetime':return c('OzIntentParamsDateTimeField.react');case 'place':return c('OzIntentParamsPlaceField.react');default:throw new Error('OzIntentFactoryHelpers: Unknown field type '+m+'.');}}};function j(l,m){var n=l.get(m);if(n&&!n.isEmpty())return n.first().get('value');return null;}function k(l,m,n){l.set(m,c('immutable').fromJS([n]));}f.exports=i;}),null);
__d('OzIntentSchemas',['immutable'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h={get:function ba(ca,da){var ea=da.getIn(['GK','scriptRestaurantClose']);switch(ca){case 'restaurant':case 'restaurant_bar':return ea?k:j;case 'reminder':return l;case 'appointment':case 'nonmedical_appointment':return m;case 'local_search':return n;case 'good_purchase':return o;case 'customer_service':case 'customer_service_general':return p;case 'weather_forecast':return q;case 'hotel_and_accommodation':return r;case 'activities_things_to_do':return s;case 'ticket_purchase':case 'movie_concert_show':return t;case 'food_purchase':return u;case 'utility':return v;case 'book_car_transportation':case 'vehicle_service':return w;case 'traffic':return x;case 'navigation':return y;case 'flight_request':return z;case 'stocks':return aa;default:return i;}}},i={name:'Generic',fields:[]},j={name:'Restaurant',fields:[{type:'enum',name:'request_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','confirm','change','info','location','option']},{type:'string',name:'restaurant_name',label:'Name',placeholder:'Restaurant Name'},{type:'string',name:'restaurant_cuisine',label:'Cuisine'},{type:'string',name:'location',label:'Location'},{type:'number',name:'people_number',label:'Guests',placeholder:'Number of guests'},{type:'pricerange',name:'amount_of_money',label:'Price Range'},{type:'datetime',name:'datetime',label:'Date/Time'}]},k={name:'Restaurant',fields:[{type:'enum',name:'request_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','confirm','change','info','location','option']},{type:'place',name:'restaurant_name',label:'Name',placeholder:'Restaurant Name'},{type:'string',name:'restaurant_cuisine',label:'Cuisine'},{type:'string',name:'location',label:'Location'},{type:'number',name:'people_number',label:'Guests',placeholder:'Number of guests'},{type:'pricerange',name:'amount_of_money',label:'Price Range'},{type:'datetime',name:'datetime',label:'Date/Time'}]},l={name:'reminder',fields:[{type:'datetime',name:'datetime',label:'Reminder Time'},{type:'string',name:'reminder',label:'About'}]},m={name:'NonMedicalAppt',fields:[{type:'enum',name:'appt_action',label:'Action',placeholder:'Pick one...',values:['availability','cancel','move','confirm','book']},{type:'string',name:'appt_type',label:'Appt Type',placeholder:'Type of appointment'},{type:'string',name:'location',label:'Location',placeholder:'Location of appointment'},{type:'datetime',name:'datetime',label:'Datetime',placeholder:'Date and time of the appointment'},{type:'string',name:'local_search_query',label:'Name',placeholder:'Name of the place'}]},n={name:'LocalSearch',fields:[{type:'string',name:'local_query',label:'Query',placeholder:'Search query like yoga class...'},{type:'string',name:'location',label:'Location',placeholder:''},{type:'string',name:'local_name',label:'Name',placeholder:'Name of the place or business...'},{type:'datetime',name:'datetime',label:'Datetime',placeholder:''}]},o={name:'GoodPurchase',fields:[{type:'string',name:'good',label:'Good',placeholder:''},{type:'string',name:'provider',label:'Merchant',placeholder:''},{type:'string',name:'amount_of_money',label:'Price'},{type:'number',name:'good_number',label:'Items #',placeholder:'Number of Items'},{type:'string',name:'location',label:'Location',placeholder:''}]},p={name:'CustomerService',fields:[{type:'string',name:'provider',label:'Merchant'},{type:'string',name:'order_number',label:'Order #'}]},q={name:'Weather',fields:[{type:'string',name:'location',label:'Location'},{type:'datetime',name:'datetime',label:'Datetime'},{type:'string',name:'weather_type',label:'Type of forecast',placeholder:'temperature, snow, tide...'},{type:'string',name:'temperature_metric',label:'Metric',placeholder:'Celsius or Fahrenheit'}]},r={name:'Hotel',fields:[{type:'enum',name:'hotel_query_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','change','contact','extend','receipt']},{type:'string',name:'location',label:'Location'},{type:'datetime',name:'datetime',label:'Check in',placeholder:'Date and time of the appointment'},{type:'number',name:'night_number',label:'Nights #',placeholder:'Number of Nights'},{type:'number',name:'people',label:'People',placeholder:'Number of Guests'},{type:'string',name:'amount_of_money',label:'Price'},{type:'string',name:'hotel_name',label:'Hotel Name'}]},s={name:'Activities',fields:[{type:'string',name:'reservation_type',label:'Activity'},{type:'string',name:'location',label:'Location'},{type:'datetime',name:'datetime',label:'Datetime'},{type:'string',name:'amount_of_money',label:'Price'},{type:'number',name:'people_number',label:'People',placeholder:'Number of People'}]},t={name:'Tickets',fields:[{type:'enum',name:'request_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','change','info','location','option','price','receipt','time','schedule']},{type:'string',name:'event_type',label:'Type',placeholder:'Movie, show, concert...'},{type:'string',name:'event',label:'Name'},{type:'string',name:'event_venue',label:'Venue'},{type:'string',name:'location',label:'Location'},{type:'datetime',name:'datetime',label:'Datetime'},{type:'string',name:'amount_of_money',label:'Price'},{type:'number',name:'people_number',label:'Tickets #',placeholder:'Number of Tickets'}]},u={name:'FoodPurchase',fields:[{type:'string',name:'order',label:'Order',placeholder:''},{type:'string',name:'food_type',label:'Food Type',placeholder:''},{type:'string',name:'food_place',label:'Place'},{type:'enum',name:'delivery_type',label:'Delivery',placeholder:'Pick one...',values:['deliver','takeout']},{type:'string',name:'location',label:'Location',placeholder:''},{type:'datetime',name:'datetime',label:'Datetime'}]},v={name:'Utility',fields:[{type:'enum',name:'request_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','change','info','location','option','price','receipt','time','schedule']},{type:'string',name:'utility_provider',label:'Name',placeholder:'Name of the utility company'},{type:'string',name:'location',label:'Location',placeholder:''},{type:'string',name:'account_nbr',label:'Account #',placeholder:''}]},w={name:'Vehicle',fields:[{type:'enum',name:'hotel_query_type',label:'Action',placeholder:'Pick one...',values:['reservation','availability','cancel','change','info','location','option','price','receipt','time','schedule']},{type:'string',name:'from',label:'From'},{type:'string',name:'to',label:'To'},{type:'datetime',name:'datetime',label:'Datetime',placeholder:'Date and time of the ride'},{type:'string',name:'car_type',label:'Car Type',placeholder:'Type of car (limo, uber, lift...)'},{type:'string',name:'people_number',label:'People',placeholder:'Number of Guests'},{type:'string',name:'vehicle_provider',label:'Rental Name',placeholder:'Car rental name like Hertz, Avis..'}]},x={name:'Traffic',fields:[{type:'string',name:'from',label:'Starting Point'},{type:'string',name:'to',label:'Destination'},{type:'datetime',name:'datetime',label:'Date/Time',placeholder:'Intended departure time (not supported by automation)'}]},y={name:'Navigation',fields:[{type:'string',name:'from',label:'Starting Point'},{type:'string',name:'to',label:'Destination'},{type:'datetime',name:'datetime',label:'Date/Time',placeholder:'Intended departure time (not supported by automation)'}]},z={name:'flight_request',fields:[{type:'enum',name:'flight_query_type',label:'Action',placeholder:'Pick one...',values:['book','price','upgrade','flight_status','cancel','change']},{type:'string',name:'from',label:'From'},{type:'string',name:'to',label:'To'},{type:'datetime',name:'departure',label:'Departure'},{type:'datetime',name:'arrival',label:'Arrival'},{type:'string',name:'carrier',label:'Carrier'},{type:'string',name:'reference',label:'Reference #'},{type:'string',name:'passenger_num',label:'Passenger #'}]},aa={name:'stocks',fields:[{type:'string',name:'stock_symbol_list',label:'Stocks',placeholder:'Comma separated list of symbols'}]};f.exports=h;}),null);
__d('OzIntentFactory',['immutable','Map','OzAPI','OzGenericIntent.react','OzIntentFactoryHelpers','OzIntentSchemas','OzImmutablePureRenderMixin','React','debounce'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=new (c('Map'))(),j={get:function l(m,n){var o=c('OzIntentSchemas').get(m,n);if(!i.has(m))i.set(m,k(o));return i.get(m);}};function k(l){var m=c('immutable').Map,n=l.name,o=l.fields,p=10000,q=c('OzIntentFactoryHelpers').makeStateExtractor(o),r=c('OzIntentFactoryHelpers').makeFieldRenderer(o),s=c('OzIntentFactoryHelpers').makeParamsUpdater(o);return c('React').createClass({displayName:'Oz'+n+'DynamicIntent',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{intent:h.instanceOf(m).isRequired,location:h.instanceOf(m).isRequired,onChangeAlias:h.func.isRequired,onClose:h.func.isRequired,onOpen:h.func.isRequired,onIsBlockedToggle:h.func.isRequired,onTriggerAI:h.func.isRequired,requirements:h.instanceOf(m).isRequired,repNames:h.instanceOf(m).isRequired,onCreateRequirement:h.func,onDeleteRequirement:h.func,thread:h.instanceOf(m).isRequired,userEmail:h.string},getInitialState:function t(){return babelHelpers['extends']({isEditing:false},q(this.props.intent));},componentWillMount:function t(){this._saveIntent=c('debounce')(this._saveIntent,500,this,true);this._changeHandlers=m().withMutations(function(u){for(var v=o,w=Array.isArray(v),x=0,v=w?v:v[typeof Symbol==='function'?Symbol.iterator:'@@iterator']();;){var y;if(w){if(x>=v.length)break;y=v[x++];}else{x=v.next();if(x.done)break;y=x.value;}var z=y;u.set(z.name,c('OzIntentFactoryHelpers').makeStateUpdater(z.name).bind(this));}}.bind(this));},componentWillReceiveProps:function t(u){var v=this.state.isEditing;if(c('immutable').is(u.intent,this.props.intent)||v)return;this.setState(q(u.intent));},componentWillUnmount:function t(){window.clearTimeout(this._editingTimeout);},render:function t(){return (c('React').createElement(c('OzGenericIntent.react'),babelHelpers['extends']({},this.props,{notes:this.state.notes,onNotesChange:this._handleNotesChange}),this._renderFields(this.props.location)));},_renderFields:r,_handleNotesChange:function t(u){this._setStateAndSave({notes:u});},_saveIntent:function t(){var u=this.props.intent;c('OzAPI').editIntent(u.get('user-id'),m({id:u.get('id'),params:s(u.get('params'),this.state),notes:this.state.notes}));},_setStateAndSave:function t(u){window.clearTimeout(this._editingTimeout);this.setState(babelHelpers['extends']({isEditing:true},u),this._saveIntent);this._editingTimeout=window.setTimeout(function(v){return this.setState({isEditing:false});}.bind(this),p);}});}f.exports=j;}),null);
__d('OzIntent.react',['OzAPI','OzHelpers','immutable','OzIntentFactory','OzImmutablePureRenderMixin','React','Reflux','OzConfig','OzWrapper.react'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('immutable').Map,i=c('React').PropTypes,j=c('React').createClass({displayName:'OzIntent',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{intent:i.instanceOf(h).isRequired,requirements:i.instanceOf(h).isRequired,repNames:i.instanceOf(h).isRequired,location:i.instanceOf(h).isRequired,thread:i.instanceOf(h).isRequired},render:function k(){var l=this.props,m=l.intent,n=l.intentMeta,o=l.location,p=l.repNames,q=l.requirements,r=l.thread,s=l.timelineGK,t=c('OzIntentFactory').get(c('OzHelpers').intentName(m),this.state.config);return (c('React').createElement(t,{key:m.get('id'),intent:m,intentMeta:n,onChangeAlias:this._handleChangeAlias,onClose:this._handleClose,onCreateRequirement:this._handleCreateRequirement,onDeleteRequirement:this._handleDeleteRequirement,onOpen:this._handleOpen,onIsBlockedToggle:this._handleIsBlockedToggle,onTriggerAI:this._handleTriggerAI,repNames:p,requirements:q,location:o,thread:r,timelineGK:s}));},_handleClose:function k(l,m,n){c('OzAPI').closeIntent(c('OzHelpers').threadID(this.props.thread),l,m,n);},_handleOpen:function k(l){c('OzAPI').openIntent(c('OzHelpers').threadID(this.props.thread),l);},_handleDeleteRequirement:function k(l,m){c('OzAPI').deleteIntentRequirement(c('OzHelpers').threadID(this.props.thread),l,m);},_handleCreateRequirement:function k(l,m){c('OzAPI').createIntentRequirement(c('OzHelpers').threadID(this.props.thread),l,m);},_handleChangeAlias:function k(l,m){c('OzAPI').editIntent(l.get('user-id'),h({id:l.get('id'),alias:m}));},_handleIsBlockedToggle:function k(l){l.get('blocked')?c('OzAPI').unblockIntent(c('OzHelpers').threadID(this.props.thread),l.get('id')):c('OzAPI').blockIntent(c('OzHelpers').threadID(this.props.thread),l.get('id'));},_handleTriggerAI:function k(l,m){var n=this.props.intent;c('OzAPI').triggerAIForIntent(n.get('user-id'),n.get('id'));window.setTimeout(m,2500);}});f.exports=c('OzWrapper.react')(j);}),null);
__d('OzIntentEvents.react',['cx','OzAPI','OzHelpers','ozFormatTime','immutable','OzConfig','OzDate.react','OzTimestampScrolling.react','React','Reflux','Tooltip','OzActions'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('immutable').List,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzIntentEvents',mixins:[c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{intent:k.instanceOf(i).isRequired},render:function y(){var z=this.props.intent,aa=(z.get('events')||j()).toList(),ba=aa.filter(function(fa){return fa.get('type')==='completed-call';}),ca=aa.filter(function(fa){return (fa.get('type')==='send-email'||fa.get('type')==='receive-email');}),da=aa.filter(function(fa){return fa.get('type')==='send-calendar';}),ea=aa.filter(function(fa){return fa.get('type')==='book-reservation'&&fa.getIn(['data','confirmation-number']);});return (c('React').createElement('div',{className:"_4h0y"},c('React').createElement(s,{header:'Calls',events:ba,onCallPlay:p}),c('React').createElement(s,{header:'Emails',events:ca}),c('React').createElement(s,{header:'Invites',events:da}),c('React').createElement(s,{header:'Reservations',events:ea})));}}),m=function y(z){c('OzActions').emailComposer.add(babelHelpers['extends']({},c('OzHelpers').eventToEmail(z),{disabled:true}));},n=function y(z){c('OzActions').emailComposer.add(c('OzHelpers').eventToEmail(c('OzHelpers').reEmail(z)));},o=function y(z){c('OzActions').inviteComposer.add(c('OzHelpers').eventToInvite(z));},p=function y(z){return c('OzAPI').everstoreURI(z).then(function(aa){return window.open(aa);});},q=function y(z){window.open(z.getIn(['data','opentable-listing','url']));},r=function y(z){return -z.get('id');},s=c('OzHelpers').pure(function(y){var z=y.header,aa=y.events;return aa&&!aa.isEmpty()?c('React').createElement('details',{open:true},c('React').createElement('summary',{className:"_177e _3_lv"},z,'... (',aa.count(),')'),c('React').createElement('div',{className:"_4h0z"},aa.map(function(event){return (c('React').createElement(t,{orderBy:r,event:event,key:event.get('id')}));}))):null;}),t=c('OzHelpers').pure(function(y){var event=y.event,z=y.orderBy,aa=event.get('data');switch(event.get('type')){case 'send-email':return (c('React').createElement(x,{order:z(event),sign:'@',subtitle:aa.get('subject'),actions:[['VIEW',function(ea){return m(event);}],['REPLY',function(ea){return n(event);}]]},c('React').createElement(u,{data:aa,type:'to'})));case 'receive-email':return (c('React').createElement(x,{order:z(event),sign:'@',subtitle:aa.get('subject'),actions:[['VIEW',function(ea){return m(c('OzHelpers').switchRecip(event));}],['REPLY',function(ea){return n(c('OzHelpers').switchRecip(event));}]]},c('React').createElement(u,{data:aa,type:'from'})));case 'send-calendar':return (c('React').createElement(x,{order:z(event),sign:'@',subtitle:aa.get('title'),timestamp:aa.get('start'),actions:[['VIEW',function(ea){return o(event);}]]},c('React').createElement(v,{data:aa})));case 'completed-call':return (c('React').createElement(w,{event:event,onCallPlay:p,orderBy:z}));case 'book-reservation':var ba=new Date(aa.get('ts')),ca=c('OzHelpers').toLocaleDate(ba)+' at '+c('OzHelpers').toLocaleTime(ba),da='Table for '+aa.get('covers')+' on '+ca;return (c('React').createElement(x,{order:z(event),sign:'',subtitle:da,event:event,actions:[['VIEW',function(ea){return q(event);}]]}));default:return null;}}),u=c('OzHelpers').pure(function(y){var z=y.data,aa=y.type,ba=(aa==='to'?'Sent':'Received')+' at '+c('OzHelpers').toLocaleTime(z.get('sent-at'))+' on '+c('OzHelpers').toLocaleDate(z.get('sent-at')),ca=aa==='from'?z.get('from'):(z.get('to')||j()).join(', '),da=aa==='to'?'To':'From';return (c('React').createElement('span',c('Tooltip').propsFor(ba),da,' ',c('React').createElement('strong',null,ca)));}),v=c('OzHelpers').pure(function(y){var z=y.data,aa='Sent at '+c('OzHelpers').toLocaleTime(z.get('sent-at'))+' on '+c('OzHelpers').toLocaleDate(z.get('sent-at'));return (c('React').createElement('span',c('Tooltip').propsFor(aa),c('React').createElement('strong',null,(z.get('to')||j()).join(', ')||null)));}),w=c('OzHelpers').pure(function(y){var event=y.event,z=y.onCallPlay,aa=y.orderBy,ba=event.get('data'),ca={'in':'Call from',out:'Call to',voicemail:'Voicemail from'}[ba.get('direction')],da=c('OzHelpers').parsePhoneNumber(ba.get('remote-phone')),ea=ba.get('RecordingDuration'),fa=ba.get('recording-ev-handle'),ga=fa?[['PLAY',function(ha){return z(fa);}]]:[];return (c('React').createElement(x,{order:aa(event),sign:'#',subtitle:c('ozFormatTime')(+ea),timestamp:event.get('timestamp'),actions:ga},c('React').createElement('span',null,ca,' ',c('React').createElement('strong',null,da))));}),x=c('OzHelpers').pure(function(y){var z=y.sign,aa=y.children,ba=y.subtitle,ca=y.actions,da=y.timestamp,ea=y.order;return (c('React').createElement('div',{className:"_25js",style:{order:ea}},c('React').createElement('div',{className:"_4h12"},z),c('React').createElement('div',{className:"_4h18"},c('React').createElement('div',null,aa),c('React').createElement('div',null,ba,ba&&da?c('React').createElement('span',null,' — '):null,da?c('React').createElement(c('OzTimestampScrolling.react'),{timestamp:da},c('React').createElement(c('OzDate.react'),{timestamp:da,className:"_3_lw"})):null)),c('React').createElement('div',{className:"_4h19"},ca.map(function(fa,ga){var ha=fa[0],ia=fa[1];return (c('React').createElement('div',{key:ga},c('React').createElement('button',{key:ga,className:"_1-hv _30yy _4h1a",onClick:ia},ha)));}))));});f.exports={OzIntentEvents:l,EventContainer:t};}),null);
__d('OzIntentList.react',['cx','OzHelpers','immutable','OzIntentEvents.react','OzSidebarItemHeader.react','OzImmutablePureRenderMixin','React','OzWrapper.react','ReactDOM','ReactRouter'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('OzIntentEvents.react').OzIntentEvents,j=c('React').PropTypes,k=c('ReactRouter').Link,l=c('React').createClass({displayName:'OzIntentList',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{activeIntentId:j.number,intents:j.instanceOf(c('immutable').List).isRequired,timelineGK:j.bool},componentDidMount:function n(){var o=c('ReactDOM').findDOMNode(this.refs[this.props.activeIntentId]);o&&o.scrollIntoViewIfNeeded();},componentDidUpdate:function n(o){var p=this.props,q=p.activeIntentId,r=p.isHistory,s=c('ReactDOM').findDOMNode(this.refs[q]);if(s&&(o.activeIntentId!==q||o.isHistory!==r))s.scrollIntoViewIfNeeded();},render:function n(){return (c('React').createElement('div',null,this.props.intents.map(this._renderIntent)));},_renderIntent:function n(o){var p=o.get('id'),q=this.props,r=q.activeIntentId,s=q.timelineGK,t=r===p;return (c('React').createElement(m,{ref:p,key:p,intent:o,isExpanded:t,timelineGK:s}));}}),m=c('OzHelpers').pure(function(n){var o=n.intent,p=n.isExpanded,q=n.timelineGK;return (c('React').createElement('div',null,c('React').createElement(k,{className:"_qsr",to:c('OzHelpers').threadPath({threadid:o.get('user-id'),intentid:o.get('id')})},c('React').createElement(c('OzSidebarItemHeader.react'),{alias:o.get('alias'),className:"_qsu"+(p?' '+"_qsv":''),closedAt:o.get('closed-at'),closeState:o.get('state'),createdAt:o.get('created-at'),isBlocked:o.get('blocked'),isClosed:c('OzHelpers').isClosedIntent(o),label:c('OzHelpers').isOpenIntent(o)&&o.get('assigned-bot')?'BOT':null,skipScrollToTimestamp:true,title:c('OzHelpers').intentName(o),timelineGK:q})),p&&c('React').createElement(i,{intent:o})));});f.exports=c('OzWrapper.react')(l);}),null);
__d('OzIntentTabs.react',['cx','OzHelpers','immutable','OzImmutablePureRenderMixin','React','ReactRouter'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('ReactRouter').Link,j=c('immutable').List,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzIntentTabs',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{intents:k.instanceOf(j).isRequired,tasks:k.instanceOf(j).isRequired,threadId:k.string.isRequired,activeIntentId:k.number},render:function n(){var o=this.props,p=o.activeIntentId,q=o.intents,r=o.tasks,s=o.threadId;return (c('React').createElement('div',{className:"_27fz"},c('React').createElement(i,{className:"_27f-"+(!p?' '+"_27f_":''),to:c('OzHelpers').threadPath({threadid:s})},'All tasks'),q.map(function(t){return (c('React').createElement(m,{key:t.get('id'),intent:t,tasks:r,activeIntentId:p}));})));}}),m=c('OzHelpers').pure(function(n){var o=n.intent,p=n.activeIntentId,q=n.tasks,r=o.get('id')===p,s=c('OzHelpers').isBlockedIntent(o),t=c('OzHelpers').isClosedIntent(o),u=c('OzHelpers').nextTaskForIntent(o,q);return (c('React').createElement(i,{className:"_27f-"+(r?' '+"_27f_":'')+(s||t?' '+"_xpo":''),to:c('OzHelpers').threadPath({threadid:o.get('user-id'),intentid:o.get('id'),taskid:u&&u.get('id')})},o.get('alias',o.get('name'))));});f.exports=l;}),null);
__d('OzReminderNotesField.react',['OzIntentParamsTextField.react','OzImmutablePureRenderMixin','React','debounce'],(function a(b,c,d,e,f,g){'use strict';if(c.__markCompiled)c.__markCompiled();var h=c('React').PropTypes,i=c('React').createClass({displayName:'OzReminderNotesField',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{seedNotes:h.string,onSave:h.func.isRequired},getInitialState:function j(){return {notes:this.props.seedNotes||''};},componentWillMount:function j(){this._save=c('debounce')(this._save,750,this,true);},render:function j(){return (c('React').createElement(c('OzIntentParamsTextField.react'),{label:'Add notes about this reminder...',onChange:this._handleChange,value:this.state.notes}));},_handleChange:function j(k){this.setState({notes:k},this._save);},_save:function j(){this.props.onSave(this.state.notes);}});f.exports=i;}),null);
__d('OzReminderTask.react',['cx','OzAPI','OzHelpers','immutable','OzIntentParamsAbstractField.react','OzIntentParamsStringField.react','OzReminderTaskEditor.react','OzReminderNotesField.react','OzSidebarItemHeader.react','OzImmutablePureRenderMixin','React','ReactRouter','formatDate'],(function a(b,c,d,e,f,g,h){'use strict';if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('React').PropTypes,k=c('ReactRouter').Link,l=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],m=c('React').createClass({displayName:'OzReminderTask',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{task:j.instanceOf(i).isRequired,repNames:j.instanceOf(i).isRequired,location:j.instanceOf(i).isRequired},render:function o(){var p=this.props,q=p.task,r=p.repNames,s=p.location,t=q.getIn(['data','description']),u=c('OzHelpers').isUrgentTask(q),v=q.getIn(['data','suggestion']),w=c('OzHelpers').isClosedTask(q),x=q.get('from'),y=r.get(x,x);return (c('React').createElement('div',{className:"_wc0"+(u?' '+"_wc2":'')+(c('OzHelpers').isPaidTask(q)?' '+"_3d-l":'')+(w?' '+"_3d-m":'')},c('React').createElement(c('OzSidebarItemHeader.react'),{className:"_1k8u",creator:y,isClosed:w,isExpanded:true,onToggle:this._handleToggle,onCancel:this._handleCancel,title:t||n(v)},u?c('React').createElement('button',{className:"_1-hv _260v _260w",alt:'Snooze',onClick:this._handleSnooze}):null,!w?c('React').createElement(c('OzReminderTaskEditor.react'),{layered:true,onSave:this._handleEdit,seedTask:q,location:s},c('React').createElement('a',{className:"_260y"},c('React').createElement('i',{className:"_5x82"}))):null),this._renderBody()));},_renderBody:function o(){var p=this.props.task,q=p.getIn(['schedule','repeat-condition','days']),r=c('OzHelpers').threadPath({threadid:p.get('user-id'),intentid:p.get('intent-id')}),s=p.get('state')==='waiting'?'Fires on':'Fired on';return (c('React').createElement('div',{className:"_wc3"},c('React').createElement('div',{className:"_1k8v _3-ue"},c('React').createElement(k,{to:r},c('React').createElement('span',null,'Go to intent')),this._renderPayment(p),c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:s},c('React').createElement('span',null,c('formatDate')(new Date(p.get('start-at')),'M jS, g:ia'))),c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Due'},c('React').createElement('span',null,c('formatDate')(new Date(p.get('deadline')),'M jS, g:ia'))),q&&!q.isEmpty()?c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Recurs'},c('React').createElement('span',null,q.size===7?'Every Day':q.sort().map(function(t){return l[t%7];}).toArray().join(' '))):null,c('React').createElement(c('OzReminderNotesField.react'),{seedNotes:p.getIn(['data','notes'])||p.getIn(['data','description']),onSave:this._handleNotesSave}))));},_renderPayment:function o(p){var q=p.getIn(['data','suggestion']);if(!q)return null;var r=p.getIn(['data','credit-card']),s=q.get('name');return (c('React').createElement('div',null,c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Link'},c('React').createElement('div',{className:"_3d-q"},c('React').createElement('a',{className:"_3d-r",target:'_blank',href:q.get('target-url'),title:q.get('description')},'Click here to view ',s),r?c('React').createElement('a',{className:"_3d-s",href:'#',title:'Show credit card information',onClick:this._handlePaymentLinkClick}):null)),c('React').createElement(c('OzIntentParamsStringField.react'),{label:'Confirmation #',onSave:this._handleItemNumberSave,placeholder:'Confirmation number',value:p.getIn(['data','item-number'])||''})));},_handleNotesSave:function o(p){this._handleEdit(this.props.task.setIn(['data','notes'],p));},_handleItemNumberSave:function o(p){this._handleEdit(this.props.task.setIn(['data','item-number'],p));},_handleToggle:function o(){var p=this.props.task;c('OzHelpers').isClosedTask(p)?this._handleOpen(p):this._handleComplete(p);},_handleComplete:function o(p){c('OzAPI').completeTask(p.get('user-id'),p);},_handleCancel:function o(){var p=this.props.task;c('OzAPI').cancelTask(p.get('user-id'),p);},_handleEdit:function o(p){return c('OzAPI').editTask(p.get('user-id'),p);},_handleOpen:function o(p){c('OzAPI').openTask(p.get('user-id'),p);},_handleSnooze:function o(){var p=this.props.task,q=c('OzHelpers').serverNow()+1000*60*10;c('OzAPI').editTask(p.get('user-id'),p.set('deadline',q));},_handlePaymentLinkClick:function o(p){var q=this.props.task.getIn(['data','credit-card']);if(!q)return;var r=this.props.task.getIn(['data','suggestion','amount'])/100,s=q.get('number'),t=q.get('cvv'),u=q.get('month'),v=q.get('year'),w=q.get('zip'),x='https://cdn4.iconfinder.com/data/icons/simple-peyment-methods/'+'512/mastercard-128.png';c('OzAPI').notifyExtension({action:'show',title:'Temporary Credit Card Information',desc:'Amount: $'+r+' Number: '+s+' cvv: '+t+' zip: '+w,html:'Amount: $'+r+'<br/>\n      Number: '+s+'<br/>\n      CVV: '+t+'<br/>\n      Month: '+u+'<br/>\n      Year: '+v,id:s,timeout:0,picture:x});}});function n(o){if(!o)return null;var p=o.get('amount')/100,q=o.get('name');return 'User paid $'+p+' for '+q;}f.exports=m;}),null);
__d('OzReminderTasks.react',['cx','OzAPI','OzHelpers','immutable','OzSidebarItemHeader.react','OzStores','OzImmutablePureRenderMixin','React','ReactCSSTransitionGroup','ReactRouter','Reflux'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('OzStores').ActiveThreadStore,j=c('ReactRouter').Link,k=c('immutable').List,l=c('immutable').Map,m=c('React').PropTypes,n=c('React').createClass({displayName:'OzReminderTasks',propTypes:{isHistory:m.bool,repNames:m.instanceOf(l).isRequired,thread:m.object.isRequired},mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(i,'activeThread')],render:function q(){return (c('React').createElement('div',{className:"_1x92"},c('React').createElement('h2',{className:"_1x93"},'Reminders for thread'),this._renderTasks()));},_handleCreate:function q(r){c('OzAPI').createTask(c('OzHelpers').threadID(this.props.thread),r);},_handleClose:function q(r){c('OzAPI').completeTask(c('OzHelpers').threadID(this.props.thread),r);},_handleEdit:function q(r){return c('OzAPI').editTask(c('OzHelpers').threadID(this.props.thread),r);},_handleOpen:function q(r){c('OzAPI').editTask(c('OzHelpers').threadID(this.props.thread),l({id:r.get('id'),state:'dispatched'}));},_handleSnooze:function q(r){c('OzAPI').editTask(c('OzHelpers').threadID(this.props.thread),l({id:r.get('id'),deadline:c('OzHelpers').serverNow()+1000*60*5}));},_renderTasks:function q(){var r=this.props,s=r.isHistory,t=r.repNames,u=r.thread,v=this.state.activeThread.get('activeTask'),w=c('OzHelpers').threadID(u),x=u.get('tasks',k()).filter(function(y){return y.get('type')==='reminder'&&(s?c('OzHelpers').isClosedTask(y):!c('OzHelpers').isClosedTask(y));}).toSeq().sortBy(function(y){return y.get('deadline');}).map(function(y){return (c('React').createElement(o,{key:y.get('id'),task:y,isExpanded:y.get('id')===v,repNames:t}));});return (c('React').createElement('div',{key:w+'-'+!!s,className:"_wc7"},c('React').createElement(c('ReactCSSTransitionGroup'),{transitionName:'oz-fade-in-out',transitionEnterTimeout:300,transitionLeaveTimeout:300},x)));}}),o=c('OzHelpers').pure(function(q){var r=q.task,s=q.isExpanded,t=q.repNames,u=r.getIn(['data','description']),v=c('OzHelpers').isClosedTask(r),w=r.get('from'),x=t.get(w,w),y=r.getIn(['data','suggestion']);return (c('React').createElement(j,{className:"_qsr"+(' '+"_wc0")+(c('OzHelpers').isUrgentTask(r)?' '+"_wc2":'')+(c('OzHelpers').isPaidTask(r)?' '+"_3d-l":'')+(v?' '+"_3d-m":''),to:c('OzHelpers').threadPath({threadid:r.get('user-id'),intentid:r.get('intent-id'),taskid:r.get('id')})},c('React').createElement(c('OzSidebarItemHeader.react'),{className:"_1k8u"+(s?' '+"_qsv":''),creator:x,isClosed:v,isExpanded:s,title:u||p(y)||'[No Title]'})));});function p(q){if(!q)return null;var r=q.get('amount')/100,s=q.get('name');return 'User paid $'+r+' for '+s;}f.exports=n;}),null);
__d('OzReminderEditor.react',['cx','OzConstants','ContextualLayerAutoFlip','ContextualLayerUpdateOnScroll','DatePickerRestraints','OzHelpers','immutable','InputLabel.react','ReactLayeredComponentMixin_DEPRECATED','LayerHideOnBlur','MessengerButton.react','OzDateTimePicker.react','React','XUIContextualDialog.react','XUIError.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('OzConstants').REMINDERS,j=c('immutable').Map,k=c('immutable').Set,l=c('React').PropTypes,m=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],n=c('immutable').fromJS({traffic:{label:'Include traffic update',params:[{name:'origin',placeholder:'Origin address',err:'What is the origin address?'},{name:'destination',placeholder:'Destination address',err:'What is the destination address?'}]},weather:{label:'Include weather forecast',params:[{name:'location',placeholder:'City',err:'What city is the forecast for?'},{name:'metric',placeholder:'Celsius or Fahrenheit',err:'You need to set Celsius or Fahrenheit'}]}}),o=c('OzHelpers').pure(function(r){var s=r.action,t=r.errors,u=r.onToggle,v=r.onUpdate,w=r.reminder,x=!!w.getIn(['actions',s]);return (c('React').createElement('div',null,c('React').createElement(c('InputLabel.react'),{className:"_2_xq"},c('React').createElement('input',{type:'checkbox',checked:x,onChange:function y(z){return u(z,w,s);}}),c('React').createElement('label',null,n.getIn([s,'label']))),x&&c('React').createElement('div',null,n.getIn([s,'params']).map(function(y){var z=y.get('name'),aa=['actions',s,z];return (c('React').createElement('div',{key:s+'-'+z},c('React').createElement(c('XUIError.react'),{xuiError:t.getIn([s,z])},c('React').createElement('input',{type:y.get('type','text'),className:"_2_xr",placeholder:y.get('placeholder'),value:w.getIn(aa),onChange:function ba(ca){return v(ca,aa);}}))));}).valueSeq())));}),p=c('OzHelpers').pure(function(r){var s=r.reminder,t=r.errors,u=r.onToggle,v=r.onUpdate;return (c('React').createElement('div',null,c('React').createElement('h3',{className:"_17f0"},'Actions'),n.keySeq().map(function(w){return (c('React').createElement(o,{key:w,action:w,reminder:s,errors:t,onToggle:u,onUpdate:v}));}).valueSeq()));}),q=c('React').createClass({displayName:'OzReminderEditor',mixins:[c('ReactLayeredComponentMixin_DEPRECATED')],propTypes:{onSave:l.func.isRequired,seedReminder:l.instanceOf(j),timezone:l.string},getInitialState:function r(){return {shown:false,reminder:this.props.seedReminder||j(),timezone:this.props.timezone,errors:j()};},componentWillReceiveProps:function r(s){if(!c('immutable').is(s.seedReminder,this.props.seedReminder))this.setState({reminder:s.seedReminder,errors:j()});},render:function r(){var s=c('React').Children.only(this.props.children);return c('React').cloneElement(s,{onClick:function(t){return this.setState({shown:!this.state.shown});}.bind(this)});},renderLayers:function r(){var s=this.state,t=s.shown,u=s.reminder,v=s.errors;if(!t)return null;var w=k(u.get('days'));return {contextualDialog:c('React').createElement(c('XUIContextualDialog.react'),{autoFocus:false,behaviors:{ContextualLayerAutoFlip:c('ContextualLayerAutoFlip'),ContextualLayerUpdateOnScroll:c('ContextualLayerUpdateOnScroll'),LayerHideOnBlur:c('LayerHideOnBlur')},position:'below',shown:t,contextRef:function(){return this;}.bind(this),onToggle:function(x){return this.setState({shown:x});}.bind(this)},c('React').createElement('ul',{className:"_3ssq"},c('React').createElement('div',{className:"_wbu"},c('React').createElement(c('OzDateTimePicker.react'),babelHelpers['extends']({xuiError:v.get('scheduled-time'),className:"_wbv",showTimezoneName:false,timestamp:u.get('scheduled-time',c('OzHelpers').serverNow()),timezone:this.state.timezone,onChange:function(x){var y=x.timestamp,z=x.timezone;this.setState({reminder:u.set('scheduled-time',+y),timezone:z});}.bind(this)},c('OzHelpers').dateRestraints())),c('React').createElement(c('XUIError.react'),{xuiError:v.get('description')},c('React').createElement('input',{ref:'input',className:"_wbw",placeholder:'Describe the Reminder',value:u.getIn(['body','description']),onChange:function(x){this.setState({reminder:u.setIn(['body','description'],x.target.value)});}.bind(this)})),c('React').createElement('h3',{className:"_17f0"},'Recurrence'),m.map(function(x,y){var z=y+1;return (c('React').createElement(c('InputLabel.react'),{key:y,className:"_2_xq"},c('React').createElement('input',{type:'checkbox',checked:w.has(z),onChange:function(aa){var ba=aa.target.checked?w.add(z):w['delete'](z);this.setState({reminder:u.set('days',ba.toList())});}.bind(this)}),c('React').createElement('label',null,x)));}.bind(this)),c('React').createElement(p,{reminder:u,errors:v,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate}),c('React').createElement('div',{className:"_wbz"},c('React').createElement(c('MessengerButton.react'),{label:this.props.seedReminder?'Update Reminder':'Add Reminder',onClick:this._handleSave,type:'primary'})))))};},_handleActionToggle:function r(s,t,u){var v=s.target.checked?t.set('actions',j([[u,j()]])):t['delete']('actions');this.setState({reminder:v});},_handleActionUpdate:function r(s,t){this.setState({reminder:this.state.reminder.setIn(t,s.target.value)});},_handleSave:function r(){var s=this.state.reminder,t=s.get('scheduled-time'),u=function x(y){return !!s.getIn(['actions',y]);},v=j(),w=c('OzHelpers').dateRestraints().dateRestraints;if(!t){v=v.set('scheduled-time','When would you like the reminder?');}else if(t<c('OzHelpers').serverNow()+60*1000){v=v.set('scheduled-time','Reminders should be in the future!');}else if(!c('DatePickerRestraints').isValidDate(new Date(t),w))v=v.set('scheduled-time','Reminder is outside of the '+i.RANGE_IN_YEARS+' year range');if(!s.getIn(['body','description']))v=v.set('description','What is the reminder about?');v=n.reduce(function(x,y,z){if(u(z))x=y.get('params').reduce(function(aa,ba){return s.getIn(['actions',z,ba.get('name')])?aa:aa.setIn([z,ba.get('name')],ba.get('err'));},x);return x;},v);this.setState({errors:v});if(v.size)return;this.setState({reminder:j(),shown:false},function(x){return this.props.onSave(s);}.bind(this));}});f.exports=q;}),null);
__d('OzReminder.react',['cx','invariant','OzAPI','OzHelpers','Event','immutable','OzIntentParamsAbstractField.react','OzIntentParamsStringField.react','OzReminderEditor.react','OzReminderNotesField.react','OzSidebarItemHeader.react','OzImmutablePureRenderMixin','React','XUICloseButton.react','formatDate'],(function a(b,c,d,e,f,g,h,i){'use strict';if(c.__markCompiled)c.__markCompiled();var j=c('immutable').List,k=c('immutable').Map,l=c('React').PropTypes,m=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'],n=c('React').createClass({displayName:'OzReminder',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onClose:l.func.isRequired,onEdit:l.func.isRequired,onOpen:l.func.isRequired,onSnooze:l.func.isRequired,reminder:l.instanceOf(k).isRequired,repNames:l.instanceOf(k).isRequired,timezone:l.string},getInitialState:function p(){return {isExpanded:c('OzHelpers').isUrgentReminder(this.props.reminder)};},componentWillReceiveProps:function p(q){if(q.reminder.get('id')===this.props.reminder.get('id')&&c('OzHelpers').isUrgentReminder(q.reminder)&&!c('OzHelpers').isUrgentReminder(this.props.reminder))this.setState({isExpanded:true});},render:function p(){var q=this.props,r=q.onEdit,s=q.onSnooze,t=q.reminder,u=q.repNames,v=q.timezone,w=t.getIn(['body','description']),x=c('OzHelpers').isUrgentReminder(t),y=t.getIn(['body','suggestion']),z=t.get('state')==='closed',aa=t.get('creator-fbid'),ba=u.get(aa,aa);return (c('React').createElement('div',{className:"_wc0"+(x?' '+"_wc2":'')+(c('OzHelpers').isPaidReminder(t)?' '+"_3d-l":'')+(z?' '+"_3d-m":'')},c('React').createElement(c('OzSidebarItemHeader.react'),{className:"_1k8u",creator:ba,isClosed:z,isExpanded:this.state.isExpanded,onIsExpandedToggle:this._handleIsExpandedToggle,onToggle:this._handleToggle,subtitle:c('OzHelpers').isSnoozedReminder(t)?'(snoozed)':null,title:w||o(y)||'[No Title]'},x?c('React').createElement('button',{className:"_1-hv _260v _260w",alt:'Snooze',onClick:function ca(da){return s(t);}}):null,c('React').createElement(c('OzReminderEditor.react'),{onSave:r,seedReminder:t,timezone:v},c('React').createElement('a',{className:"_260y"},c('React').createElement('i',{className:"_5x82"})))),this._renderBody()));},_renderBody:function p(){if(!this.state.isExpanded)return null;var q=this.props.reminder,r=q.get('scheduled-time'),s=q.get('last-fired'),t=q.get('state')==='closed',u=c('OzHelpers').isUrgentReminder(q),v=q.get('state')==='snoozed'&&s||r>c('OzHelpers').serverNow()&&r,w=(u||t)&&s,x=q.get('days');return (c('React').createElement('div',{className:"_wc3"},c('React').createElement('div',{className:"_1k8v _3-ue"},this._renderPayment(q),w?c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Fired On'},c('React').createElement('span',null,c('formatDate')(new Date(w),'M jS, g:ia'))):null,v?c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Will Fire On'},c('React').createElement('span',null,c('formatDate')(new Date(v),'M jS, g:ia'))):null,x&&!x.isEmpty()?c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Recurs'},c('React').createElement('span',null,x.size===7?'Every Day':x.sort().map(function(y){return m[y%7];}).toArray().join(' '))):null,c('React').createElement(c('OzReminderNotesField.react'),{seedNotes:q.get('notes')||q.getIn(['body','description']),onSave:this._handleNotesSave}))));},_renderPayment:function p(q){var r=q.getIn(['body','suggestion']);if(!r)return null;var s=q.getIn(['body','credit-card']),t=r.get('name');return (c('React').createElement('div',null,c('React').createElement(c('OzIntentParamsAbstractField.react'),{label:'Link'},c('React').createElement('div',{className:"_3d-q"},c('React').createElement('a',{className:"_3d-r",target:'_blank',href:r.get('target-url'),title:r.get('description')},'Click here to view ',t),s?c('React').createElement('a',{className:"_3d-s",href:'#',title:'Show credit card information',onClick:this._handlePaymentLinkClick}):null)),c('React').createElement(c('OzIntentParamsStringField.react'),{label:'Confirmation #',onSave:this._handleItemNumberSave,placeholder:'Confirmation number',value:q.getIn(['body','item-number'])||''})));},_handleIsExpandedToggle:function p(){this.setState({isExpanded:!this.state.isExpanded});},_handleNotesSave:function p(q){this.props.onEdit(this.props.reminder.set('notes',q));},_handleItemNumberSave:function p(q){this.props.onEdit(this.props.reminder.setIn(['body','item-number'],q));},_handleToggle:function p(q){var r=this.props,s=r.onClose,t=r.onOpen,u=r.reminder;q?s(u):t(u);},_handlePaymentLinkClick:function p(q){var r=this.props.reminder.getIn(['body','credit-card']);if(!r)return;var s=this.props.reminder.getIn(['body','suggestion','amount'])/100,t=r.get('number'),u=r.get('cvv'),v=r.get('month'),w=r.get('year'),x=r.get('zip');c('OzAPI').notifyExtension({action:'show',title:'Temporary Credit Card Information',desc:'Amount: $'+s+' Number: '+t+' cvv: '+u+' zip: '+x,html:'Amount: $'+s+'<br/>\n      Number: '+t+'<br/>\n      CVV: '+u+'<br/>\n      Month: '+v+'<br/>\n      Year: '+w,id:t,timeout:0,picture:'https://cdn4.iconfinder.com/data/icons/simple-peyment-methods/512/mastercard-128.png'});}});function o(p){if(!p)return null;var q=p.get('amount')/100,r=p.get('name');return 'User paid $'+q+' for '+r;}f.exports=n;}),null);
__d('OzReminders.react',['cx','OzAPI','OzHelpers','immutable','OzReminder.react','OzReminderEditor.react','React','OzWrapper.react'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('immutable').List,l=c('immutable').Map,m=c('React').PropTypes;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;function n(){var o,p;'use strict';for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return o=(p=j.constructor).call.apply(p,[this].concat(r)),this.$OzReminders2=function(t){c('OzAPI').createReminder(c('OzHelpers').threadID(this.props.thread),t);}.bind(this),this.$OzReminders3=function(t){c('OzAPI').closeReminder(c('OzHelpers').threadID(this.props.thread),t.get('id'),!!t.get('days')&&t.get('state')==='pending');}.bind(this),this.$OzReminders4=function(t){c('OzAPI').editReminder(c('OzHelpers').threadID(this.props.thread),t);}.bind(this),this.$OzReminders5=function(t){c('OzAPI').editReminder(c('OzHelpers').threadID(this.props.thread),t.set('state','pending'));}.bind(this),this.$OzReminders6=function(t){c('OzAPI').snoozeReminder(c('OzHelpers').threadID(this.props.thread),t.get('id'));}.bind(this),this.$OzReminders1=function(){var t=this.props,u=t.isHistory,v=t.repNames,w=t.thread,x=c('OzHelpers').threadID(w),y=w.get('reminders',k()).sortBy(function(z){return z.get('last-fired')||z.get('scheduled-time');}).toSeq().filter(function(z){return u?z.get('state')==='closed':z.get('state')!=='closed';}).map(function(z){return (c('React').createElement(c('OzReminder.react'),{key:z.get('id'),onClose:this.$OzReminders3,onEdit:this.$OzReminders4,onOpen:this.$OzReminders5,onSnooze:this.$OzReminders6,reminder:z,repNames:v,timezone:c('OzHelpers').timezone(w)}));}.bind(this));return (c('React').createElement('div',{key:x+'-'+!!u,className:"_wc7"},y));}.bind(this),o;}n.prototype.render=function(){'use strict';return c('React').createElement('div',{className:"_1x92"},c('React').createElement('h2',{className:"_1x93"},'Reminders'),this.$OzReminders1(),!this.props.isHistory?c('React').createElement(c('OzReminderEditor.react'),{onSave:this.$OzReminders2,timezone:c('OzHelpers').timezone(this.props.thread)},c('React').createElement('a',{className:"_59jg"},c('React').createElement('div',{className:"_4nd4"}),c('React').createElement('span',{className:"_59jh"},'Add a reminder...'))):null);};n.propTypes={isHistory:m.bool,repNames:m.instanceOf(l).isRequired,thread:m.object.isRequired};f.exports=c('OzWrapper.react')(n);}),null);
/**
 * @providesModule CajaHTMLSanitizer
 * @preserve-header
 * @nolint
 */__d("CajaHTMLSanitizer",[],(function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();var h=1,i=2,j=4,k=8,l=16,m=64,n=128,o=512,p=1024,q=(function(){var fa=[['aliceblue','antiquewhite','aqua','aquamarine','azure','beige','bisque','black','blanchedalmond','blue','blueviolet','brown','burlywood','cadetblue','chartreuse','chocolate','coral','cornflowerblue','cornsilk','crimson','cyan','darkblue','darkcyan','darkgoldenrod','darkgray','darkgreen','darkkhaki','darkmagenta','darkolivegreen','darkorange','darkorchid','darkred','darksalmon','darkseagreen','darkslateblue','darkslategray','darkturquoise','darkviolet','deeppink','deepskyblue','dimgray','dodgerblue','firebrick','floralwhite','forestgreen','fuchsia','gainsboro','ghostwhite','gold','goldenrod','gray','green','greenyellow','honeydew','hotpink','indianred','indigo','ivory','khaki','lavender','lavenderblush','lawngreen','lemonchiffon','lightblue','lightcoral','lightcyan','lightgoldenrodyellow','lightgreen','lightgrey','lightpink','lightsalmon','lightseagreen','lightskyblue','lightslategray','lightsteelblue','lightyellow','lime','limegreen','linen','magenta','maroon','mediumaquamarine','mediumblue','mediumorchid','mediumpurple','mediumseagreen','mediumslateblue','mediumspringgreen','mediumturquoise','mediumvioletred','midnightblue','mintcream','mistyrose','moccasin','navajowhite','navy','oldlace','olive','olivedrab','orange','orangered','orchid','palegoldenrod','palegreen','paleturquoise','palevioletred','papayawhip','peachpuff','peru','pink','plum','powderblue','purple','red','rosybrown','royalblue','saddlebrown','salmon','sandybrown','seagreen','seashell','sienna','silver','skyblue','slateblue','slategray','snow','springgreen','steelblue','tan','teal','thistle','tomato','transparent','turquoise','violet','wheat','white','whitesmoke','yellow','yellowgreen'],['all-scroll','col-resize','crosshair','default','e-resize','hand','help','move','n-resize','ne-resize','no-drop','not-allowed','nw-resize','pointer','progress','row-resize','s-resize','se-resize','sw-resize','text','vertical-text','w-resize','wait'],['armenian','decimal','decimal-leading-zero','disc','georgian','lower-alpha','lower-greek','lower-latin','lower-roman','square','upper-alpha','upper-latin','upper-roman'],['100','200','300','400','500','600','700','800','900','bold','bolder','lighter'],['block-level','inline-level','table-caption','table-cell','table-column','table-column-group','table-footer-group','table-header-group','table-row','table-row-group'],['condensed','expanded','extra-condensed','extra-expanded','narrower','semi-condensed','semi-expanded','ultra-condensed','ultra-expanded','wider'],['inherit','inline','inline-block','inline-box','inline-flex','inline-grid','inline-list-item','inline-stack','inline-table','run-in'],['behind','center-left','center-right','far-left','far-right','left-side','leftwards','right-side','rightwards'],['large','larger','small','smaller','x-large','x-small','xx-large','xx-small'],['dashed','dotted','double','groove','outset','ridge','solid'],['ease','ease-in','ease-in-out','ease-out','linear','step-end','step-start'],['at','closest-corner','closest-side','ellipse','farthest-corner','farthest-side'],['baseline','middle','sub','super','text-bottom','text-top'],['caption','icon','menu','message-box','small-caption','status-bar'],['fast','faster','slow','slower','x-fast','x-slow'],['above','below','higher','level','lower'],['cursive','fantasy','monospace','sans-serif','serif'],['loud','silent','soft','x-loud','x-soft'],['no-repeat','repeat-x','repeat-y','round','space'],['blink','line-through','overline','underline'],['block','flex','grid','table'],['high','low','x-high','x-low'],['nowrap','pre','pre-line','pre-wrap'],['absolute','relative','static'],['alternate','alternate-reverse','reverse'],['border-box','content-box','padding-box'],['capitalize','lowercase','uppercase'],['child','female','male'],['=','opacity'],['backwards','forwards'],['bidi-override','embed'],['bottom','top'],['break-all','keep-all'],['clip','ellipsis'],['contain','cover'],['continuous','digits'],['end','start'],['flat','preserve-3d'],['hide','show'],['horizontal','vertical'],['inside','outside'],['italic','oblique'],['left','right'],['ltr','rtl'],['no-content','no-display'],['paused','running'],['suppress','unrestricted'],['thick','thin'],[','],['/'],['all'],['always'],['auto'],['avoid'],['both'],['break-word'],['center'],['circle'],['code'],['collapse'],['contents'],['fixed'],['hidden'],['infinite'],['inset'],['invert'],['justify'],['list-item'],['local'],['medium'],['mix'],['none'],['normal'],['once'],['repeat'],['scroll'],['separate'],['small-caps'],['spell-out'],['to'],['visible']],ga={animation:{cssPropBits:517,cssLitGroup:[fa[10],fa[24],fa[29],fa[45],fa[48],fa[54],fa[63],fa[71],fa[72]],cssFns:['cubic-bezier()','steps()']},'animation-delay':{cssPropBits:5,cssLitGroup:[fa[48]],cssFns:[]},'animation-direction':{cssPropBits:0,cssLitGroup:[fa[24],fa[48],fa[72]],cssFns:[]},'animation-duration':'animation-delay','animation-fill-mode':{cssPropBits:0,cssLitGroup:[fa[29],fa[48],fa[54],fa[71]],cssFns:[]},'animation-iteration-count':{cssPropBits:5,cssLitGroup:[fa[48],fa[63]],cssFns:[]},'animation-name':{cssPropBits:512,cssLitGroup:[fa[48],fa[71]],cssFns:[]},'animation-play-state':{cssPropBits:0,cssLitGroup:[fa[45],fa[48]],cssFns:[]},'animation-timing-function':{cssPropBits:0,cssLitGroup:[fa[10],fa[48]],cssFns:['cubic-bezier()','steps()']},appearance:{cssPropBits:0,cssLitGroup:[fa[71]],cssFns:[]},azimuth:{cssPropBits:5,cssLitGroup:[fa[7],fa[42],fa[56]],cssFns:[]},'backface-visibility':{cssPropBits:0,cssLitGroup:[fa[59],fa[62],fa[80]],cssFns:[]},background:{cssPropBits:23,cssLitGroup:[fa[0],fa[18],fa[25],fa[31],fa[34],fa[42],fa[48],fa[49],fa[52],fa[56],fa[61],fa[68],fa[71],fa[74],fa[75]],cssFns:['image()','linear-gradient()','radial-gradient()','repeating-linear-gradient()','repeating-radial-gradient()','rgb()','rgba()']},'background-attachment':{cssPropBits:0,cssLitGroup:[fa[48],fa[61],fa[68],fa[75]],cssFns:[]},'background-color':{cssPropBits:2,cssLitGroup:[fa[0]],cssFns:['rgb()','rgba()']},'background-image':{cssPropBits:16,cssLitGroup:[fa[48],fa[71]],cssFns:['image()','linear-gradient()','radial-gradient()','repeating-linear-gradient()','repeating-radial-gradient()']},'background-position':{cssPropBits:5,cssLitGroup:[fa[31],fa[42],fa[48],fa[56]],cssFns:[]},'background-repeat':{cssPropBits:0,cssLitGroup:[fa[18],fa[48],fa[74]],cssFns:[]},'background-size':{cssPropBits:5,cssLitGroup:[fa[34],fa[48],fa[52]],cssFns:[]},border:{cssPropBits:7,cssLitGroup:[fa[0],fa[9],fa[47],fa[62],fa[64],fa[69],fa[71]],cssFns:['rgb()','rgba()']},'border-bottom':'border','border-bottom-color':'background-color','border-bottom-left-radius':{cssPropBits:5,cssFns:[]},'border-bottom-right-radius':'border-bottom-left-radius','border-bottom-style':{cssPropBits:0,cssLitGroup:[fa[9],fa[62],fa[64],fa[71]],cssFns:[]},'border-bottom-width':{cssPropBits:5,cssLitGroup:[fa[47],fa[69]],cssFns:[]},'border-collapse':{cssPropBits:0,cssLitGroup:[fa[59],fa[76]],cssFns:[]},'border-color':'background-color','border-left':'border','border-left-color':'background-color','border-left-style':'border-bottom-style','border-left-width':'border-bottom-width','border-radius':{cssPropBits:5,cssLitGroup:[fa[49]],cssFns:[]},'border-right':'border','border-right-color':'background-color','border-right-style':'border-bottom-style','border-right-width':'border-bottom-width','border-spacing':'border-bottom-left-radius','border-style':'border-bottom-style','border-top':'border','border-top-color':'background-color','border-top-left-radius':'border-bottom-left-radius','border-top-right-radius':'border-bottom-left-radius','border-top-style':'border-bottom-style','border-top-width':'border-bottom-width','border-width':'border-bottom-width',bottom:{cssPropBits:5,cssLitGroup:[fa[52]],cssFns:[]},box:{cssPropBits:0,cssLitGroup:[fa[60],fa[71],fa[72]],cssFns:[]},'box-shadow':{cssPropBits:7,cssLitGroup:[fa[0],fa[48],fa[64],fa[71]],cssFns:['rgb()','rgba()']},'box-sizing':{cssPropBits:0,cssLitGroup:[fa[25]],cssFns:[]},'caption-side':{cssPropBits:0,cssLitGroup:[fa[31]],cssFns:[]},clear:{cssPropBits:0,cssLitGroup:[fa[42],fa[54],fa[71]],cssFns:[]},clip:{cssPropBits:0,cssLitGroup:[fa[52]],cssFns:['rect()']},color:'background-color',content:{cssPropBits:8,cssLitGroup:[fa[71],fa[72]],cssFns:[]},cue:{cssPropBits:16,cssLitGroup:[fa[71]],cssFns:[]},'cue-after':'cue','cue-before':'cue',cursor:{cssPropBits:16,cssLitGroup:[fa[1],fa[48],fa[52]],cssFns:[]},direction:{cssPropBits:0,cssLitGroup:[fa[43]],cssFns:[]},display:{cssPropBits:0,cssLitGroup:[fa[4],fa[6],fa[20],fa[52],fa[67],fa[71]],cssFns:[]},'display-extras':{cssPropBits:0,cssLitGroup:[fa[67],fa[71]],cssFns:[]},'display-inside':{cssPropBits:0,cssLitGroup:[fa[20],fa[52]],cssFns:[]},'display-outside':{cssPropBits:0,cssLitGroup:[fa[4],fa[71]],cssFns:[]},elevation:{cssPropBits:5,cssLitGroup:[fa[15]],cssFns:[]},'empty-cells':{cssPropBits:0,cssLitGroup:[fa[38]],cssFns:[]},filter:{cssPropBits:0,cssFns:['alpha()']},'float':{cssPropBits:0,cssLitGroup:[fa[42],fa[71]],cssFns:[]},font:{cssPropBits:73,cssLitGroup:[fa[3],fa[8],fa[13],fa[16],fa[41],fa[48],fa[49],fa[69],fa[72],fa[77]],cssFns:[]},'font-family':{cssPropBits:72,cssLitGroup:[fa[16],fa[48]],cssFns:[]},'font-size':{cssPropBits:1,cssLitGroup:[fa[8],fa[69]],cssFns:[]},'font-stretch':{cssPropBits:0,cssLitGroup:[fa[5],fa[72]],cssFns:[]},'font-style':{cssPropBits:0,cssLitGroup:[fa[41],fa[72]],cssFns:[]},'font-variant':{cssPropBits:0,cssLitGroup:[fa[72],fa[77]],cssFns:[]},'font-weight':{cssPropBits:0,cssLitGroup:[fa[3],fa[72]],cssFns:[]},height:'bottom',left:'bottom','letter-spacing':{cssPropBits:5,cssLitGroup:[fa[72]],cssFns:[]},'line-height':{cssPropBits:1,cssLitGroup:[fa[72]],cssFns:[]},'list-style':{cssPropBits:16,cssLitGroup:[fa[2],fa[40],fa[57],fa[71]],cssFns:['image()','linear-gradient()','radial-gradient()','repeating-linear-gradient()','repeating-radial-gradient()']},'list-style-image':{cssPropBits:16,cssLitGroup:[fa[71]],cssFns:['image()','linear-gradient()','radial-gradient()','repeating-linear-gradient()','repeating-radial-gradient()']},'list-style-position':{cssPropBits:0,cssLitGroup:[fa[40]],cssFns:[]},'list-style-type':{cssPropBits:0,cssLitGroup:[fa[2],fa[57],fa[71]],cssFns:[]},margin:'bottom','margin-bottom':'bottom','margin-left':'bottom','margin-right':'bottom','margin-top':'bottom','max-height':{cssPropBits:1,cssLitGroup:[fa[52],fa[71]],cssFns:[]},'max-width':'max-height','min-height':{cssPropBits:1,cssLitGroup:[fa[52]],cssFns:[]},'min-width':'min-height',opacity:{cssPropBits:1,cssFns:[]},outline:{cssPropBits:7,cssLitGroup:[fa[0],fa[9],fa[47],fa[62],fa[64],fa[65],fa[69],fa[71]],cssFns:['rgb()','rgba()']},'outline-color':{cssPropBits:2,cssLitGroup:[fa[0],fa[65]],cssFns:['rgb()','rgba()']},'outline-style':'border-bottom-style','outline-width':'border-bottom-width',overflow:{cssPropBits:0,cssLitGroup:[fa[52],fa[62],fa[75],fa[80]],cssFns:[]},'overflow-wrap':{cssPropBits:0,cssLitGroup:[fa[55],fa[72]],cssFns:[]},'overflow-x':{cssPropBits:0,cssLitGroup:[fa[44],fa[52],fa[62],fa[75],fa[80]],cssFns:[]},'overflow-y':'overflow-x',padding:'opacity','padding-bottom':'opacity','padding-left':'opacity','padding-right':'opacity','padding-top':'opacity','page-break-after':{cssPropBits:0,cssLitGroup:[fa[42],fa[51],fa[52],fa[53]],cssFns:[]},'page-break-before':'page-break-after','page-break-inside':{cssPropBits:0,cssLitGroup:[fa[52],fa[53]],cssFns:[]},pause:'border-bottom-left-radius','pause-after':'border-bottom-left-radius','pause-before':'border-bottom-left-radius',perspective:{cssPropBits:5,cssLitGroup:[fa[71]],cssFns:[]},'perspective-origin':{cssPropBits:5,cssLitGroup:[fa[31],fa[42],fa[56]],cssFns:[]},pitch:{cssPropBits:5,cssLitGroup:[fa[21],fa[69]],cssFns:[]},'pitch-range':'border-bottom-left-radius','play-during':{cssPropBits:16,cssLitGroup:[fa[52],fa[70],fa[71],fa[74]],cssFns:[]},position:{cssPropBits:0,cssLitGroup:[fa[23]],cssFns:[]},quotes:{cssPropBits:8,cssLitGroup:[fa[71]],cssFns:[]},resize:{cssPropBits:0,cssLitGroup:[fa[39],fa[54],fa[71]],cssFns:[]},richness:'border-bottom-left-radius',right:'bottom',speak:{cssPropBits:0,cssLitGroup:[fa[71],fa[72],fa[78]],cssFns:[]},'speak-header':{cssPropBits:0,cssLitGroup:[fa[51],fa[73]],cssFns:[]},'speak-numeral':{cssPropBits:0,cssLitGroup:[fa[35]],cssFns:[]},'speak-punctuation':{cssPropBits:0,cssLitGroup:[fa[58],fa[71]],cssFns:[]},'speech-rate':{cssPropBits:5,cssLitGroup:[fa[14],fa[69]],cssFns:[]},stress:'border-bottom-left-radius','table-layout':{cssPropBits:0,cssLitGroup:[fa[52],fa[61]],cssFns:[]},'text-align':{cssPropBits:0,cssLitGroup:[fa[42],fa[56],fa[66]],cssFns:[]},'text-decoration':{cssPropBits:0,cssLitGroup:[fa[19],fa[71]],cssFns:[]},'text-indent':'border-bottom-left-radius','text-overflow':{cssPropBits:8,cssLitGroup:[fa[33]],cssFns:[]},'text-shadow':'box-shadow','text-transform':{cssPropBits:0,cssLitGroup:[fa[26],fa[71]],cssFns:[]},'text-wrap':{cssPropBits:0,cssLitGroup:[fa[46],fa[71],fa[72]],cssFns:[]},top:'bottom',transform:{cssPropBits:0,cssLitGroup:[fa[71]],cssFns:['matrix()','perspective()','rotate()','rotate3d()','rotatex()','rotatey()','rotatez()','scale()','scale3d()','scalex()','scaley()','scalez()','skew()','skewx()','skewy()','translate()','translate3d()','translatex()','translatey()','translatez()']},'transform-origin':'perspective-origin','transform-style':{cssPropBits:0,cssLitGroup:[fa[37]],cssFns:[]},transition:{cssPropBits:1029,cssLitGroup:[fa[10],fa[48],fa[50],fa[71]],cssFns:['cubic-bezier()','steps()']},'transition-delay':'animation-delay','transition-duration':'animation-delay','transition-property':{cssPropBits:1024,cssLitGroup:[fa[48],fa[50]],cssFns:[]},'transition-timing-function':'animation-timing-function','unicode-bidi':{cssPropBits:0,cssLitGroup:[fa[30],fa[72]],cssFns:[]},'vertical-align':{cssPropBits:5,cssLitGroup:[fa[12],fa[31]],cssFns:[]},visibility:'backface-visibility','voice-family':{cssPropBits:8,cssLitGroup:[fa[27],fa[48]],cssFns:[]},volume:{cssPropBits:1,cssLitGroup:[fa[17],fa[69]],cssFns:[]},'white-space':{cssPropBits:0,cssLitGroup:[fa[22],fa[72]],cssFns:[]},width:'min-height','word-break':{cssPropBits:0,cssLitGroup:[fa[32],fa[72]],cssFns:[]},'word-spacing':'letter-spacing','word-wrap':'overflow-wrap','z-index':'bottom',zoom:'line-height','cubic-bezier()':'animation-delay','steps()':{cssPropBits:5,cssLitGroup:[fa[36],fa[48]],cssFns:[]},'image()':{cssPropBits:18,cssLitGroup:[fa[0],fa[48]],cssFns:['rgb()','rgba()']},'linear-gradient()':{cssPropBits:7,cssLitGroup:[fa[0],fa[31],fa[42],fa[48],fa[79]],cssFns:['rgb()','rgba()']},'radial-gradient()':{cssPropBits:7,cssLitGroup:[fa[0],fa[11],fa[31],fa[42],fa[48],fa[56],fa[57]],cssFns:['rgb()','rgba()']},'repeating-linear-gradient()':'linear-gradient()','repeating-radial-gradient()':'radial-gradient()','rgb()':{cssPropBits:1,cssLitGroup:[fa[48]],cssFns:[]},'rgba()':'rgb()','rect()':{cssPropBits:5,cssLitGroup:[fa[48],fa[52]],cssFns:[]},'alpha()':{cssPropBits:1,cssLitGroup:[fa[28]],cssFns:[]},'matrix()':'animation-delay','perspective()':'border-bottom-left-radius','rotate()':'border-bottom-left-radius','rotate3d()':'animation-delay','rotatex()':'border-bottom-left-radius','rotatey()':'border-bottom-left-radius','rotatez()':'border-bottom-left-radius','scale()':'animation-delay','scale3d()':'animation-delay','scalex()':'border-bottom-left-radius','scaley()':'border-bottom-left-radius','scalez()':'border-bottom-left-radius','skew()':'animation-delay','skewx()':'border-bottom-left-radius','skewy()':'border-bottom-left-radius','translate()':'animation-delay','translate3d()':'animation-delay','translatex()':'border-bottom-left-radius','translatey()':'border-bottom-left-radius','translatez()':'border-bottom-left-radius'};for(var ha in ga)if('string'===typeof ga[ha]&&Object.hasOwnProperty.call(ga,ha))ga[ha]=ga[ga[ha]];return ga;})();if(typeof window!=='undefined')window.cssSchema=q;var r,s;(function(){function fa(bc){var cc=parseInt(bc.substring(1),16);if(cc>65535){return cc-=65536,String.fromCharCode(55296+(cc>>10),56320+(cc&1023));}else if(cc==cc){return String.fromCharCode(cc);}else if(bc[1]<' '){return '';}else return bc[1];}function ga(bc,cc){return '"'+bc.replace(/[\u0000-\u001f\\\"<>]/g,cc)+'"';}function ha(bc){return ja[bc]||(ja[bc]='\\'+bc.charCodeAt(0).toString(16)+' ');}function ia(bc){return ka[bc]||(ka[bc]=(bc<'\x10'?'%0':'%')+bc.charCodeAt(0).toString(16));}var ja={'\\':'\\\\'},ka={'\\':'%5c'},la='[\\t\\n\\f ]',ma=la+'*',na='[\\n\\f]',oa='[\\ud800-\\udbff][\\udc00-\\udfff]',pa='[\\u0080-\\ud7ff\\ue000-\\ufffd]|'+oa,qa='[0-9a-fA-F]{1,6}'+la+'?',ra='\\\\'+qa,sa='(?:'+qa+'|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|'+oa+')',ta='\\\\'+sa,ua='(?:[\\t\\x21\\x23-\\x26\\x28-\\x5b\\x5d-\\x7e]|'+pa+'|'+ta+')',va='[^\'"\\n\\f\\\\]|\\\\[\\s\\S]',wa='"(?:\'|'+va+')*"'+'|\'(?:\"|'+va+')*\'',xa='[-+]?(?:[0-9]+(?:[.][0-9]+)?|[.][0-9]+)',ya='(?:[a-zA-Z_]|'+pa+'|'+ta+')',za='(?:[a-zA-Z0-9_-]|'+pa+'|'+ta+')',ab=za+'+',bb='-?'+ya+za+'*',cb='@'+bb,db='#'+ab,eb=xa,fb='(?:@?-?'+ya+'|#)'+za+'*',gb=xa+'%',hb=xa+bb,ib=xa+'(?:%|'+bb+')?',jb='url[(]'+ma+'(?:'+wa+'|'+ua+'*)'+ma+'[)]',kb='U[+][0-9A-F?]{1,6}(?:-[0-9A-F]{1,6})?',lb='<\!--',mb='-->',nb=la+'+',ob='/(?:[*][^*]*[*]+(?:[^/][^*]*[*]+)*/|/[^\\n\\f]*)',pb='(?!url[(])'+bb+'[(]',qb='~=',rb='[|]=',sb='[^]=',tb='[$]=',ub='[*]=',vb='[~|^$*]=',wb='[^"\'\\\\/]|/(?![/*])',xb='\\uFEFF',yb=new RegExp([xb,kb,jb,pb,fb,wa,ib,lb,mb,nb,ob,vb,wb].join("|"),'gi'),zb=new RegExp('\\\\(?:'+sa+'|'+na+')','g'),ac=new RegExp('^url\\('+ma+'["\']?|["\']?'+ma+'\\)$','gi');s=function(bc){return bc.replace(zb,fa);};r=function(bc){bc=('\uffff'+bc).replace(/^\uffff/,'');bc=bc.replace(/\r\n?/g,'\n');var cc=bc.match(yb)||[],dc=0,ec=' ';for(var fc=0,gc=cc.length;fc<gc;++fc){var hc=s(cc[fc]),ic=hc.length,jc=hc.charCodeAt(0);hc=(jc=='"'.charCodeAt(0)||jc=='\''.charCodeAt(0))?ga(hc.substring(1,ic-1),ha):(jc=='/'.charCodeAt(0)&&ic>1||hc=='\\'||hc==mb||hc==lb||hc=='\ufeff'||jc<=' '.charCodeAt(0))?' ':/url\(/i.test(hc)?'url('+ga(hc.replace(ac,''),ia)+')':hc;if(ec!=hc||hc!=' ')cc[dc++]=ec=hc;}cc.length=dc;return cc;};})();if(typeof window!=='undefined'){window.lexCss=r;window.decodeCss=s;}var t=(function(){function fa(va){var wa=(''+va).match(sa);if(!wa)return null;return new qa(ra(wa[1]),ra(wa[2]),ra(wa[3]),ra(wa[4]),ra(wa[5]),ra(wa[6]),ra(wa[7]));}function ga(va,wa,xa,ya,za,ab,bb){var cb=new qa(ia(va,ta),ia(wa,ta),ha(xa),ya>0?ya.toString():null,ia(za,ua),null,ha(bb));if(ab)if('string'===typeof ab){cb.setRawQuery(ab.replace(/[^?&=0-9A-Za-z_\-~.%]/g,ja));}else cb.setAllParameters(ab);return cb;}function ha(va){if('string'==typeof va)return encodeURIComponent(va);return null;}function ia(va,wa){if('string'==typeof va)return encodeURI(va).replace(wa,ja);return null;}function ja(va){var wa=va.charCodeAt(0);return '%'+'0123456789ABCDEF'.charAt((wa>>4)&15)+'0123456789ABCDEF'.charAt(wa&15);}function ka(va){return va.replace(/(^|\/)\.(?:\/|$)/g,'$1').replace(/\/{2,}/g,'/');}var la=new RegExp(''+'(/|^)'+'(?:[^./][^/]*|\\.{2,}(?:[^./][^/]*)|\\.{3,}[^/]*)'+'/\\.\\.(?:/|$)'),ma=new RegExp(la),na=/^(?:\.\.\/)*(?:\.\.$)?/;function oa(va){if(va===null)return null;var wa=ka(va),xa=ma;for(var ya;(ya=wa.replace(xa,'$1'))!=wa;wa=ya);return wa;}function pa(va,wa){var xa=va.clone(),ya=wa.hasScheme();if(ya){xa.setRawScheme(wa.getRawScheme());}else ya=wa.hasCredentials();if(ya){xa.setRawCredentials(wa.getRawCredentials());}else ya=wa.hasDomain();if(ya){xa.setRawDomain(wa.getRawDomain());}else ya=wa.hasPort();var za=wa.getRawPath(),ab=oa(za);if(ya){xa.setPort(wa.getPort());ab=ab&&ab.replace(na,'');}else{ya=!!za;if(ya){if(ab.charCodeAt(0)!==47){var bb=oa(xa.getRawPath()||'').replace(na,''),cb=bb.lastIndexOf('/')+1;ab=oa((cb?bb.substring(0,cb):'')+oa(za)).replace(na,'');}}else{ab=ab&&ab.replace(na,'');if(ab!==za)xa.setRawPath(ab);}}if(ya){xa.setRawPath(ab);}else ya=wa.hasQuery();if(ya){xa.setRawQuery(wa.getRawQuery());}else ya=wa.hasFragment();if(ya)xa.setRawFragment(wa.getRawFragment());return xa;}function qa(va,wa,xa,ya,za,ab,bb){this.scheme_=va;this.credentials_=wa;this.domain_=xa;this.port_=ya;this.path_=za;this.query_=ab;this.fragment_=bb;this.paramCache_=null;}qa.prototype.toString=function(){var va=[];if(null!==this.scheme_)va.push(this.scheme_,':');if(null!==this.domain_){va.push('//');if(null!==this.credentials_)va.push(this.credentials_,'@');va.push(this.domain_);if(null!==this.port_)va.push(':',this.port_.toString());}if(null!==this.path_)va.push(this.path_);if(null!==this.query_)va.push('?',this.query_);if(null!==this.fragment_)va.push('#',this.fragment_);return va.join('');};qa.prototype.clone=function(){return new qa(this.scheme_,this.credentials_,this.domain_,this.port_,this.path_,this.query_,this.fragment_);};qa.prototype.getScheme=function(){return this.scheme_&&decodeURIComponent(this.scheme_).toLowerCase();};qa.prototype.getRawScheme=function(){return this.scheme_;};qa.prototype.setScheme=function(va){this.scheme_=ia(va,ta);return this;};qa.prototype.setRawScheme=function(va){this.scheme_=va?va:null;return this;};qa.prototype.hasScheme=function(){return null!==this.scheme_;};qa.prototype.getCredentials=function(){return this.credentials_&&decodeURIComponent(this.credentials_);};qa.prototype.getRawCredentials=function(){return this.credentials_;};qa.prototype.setCredentials=function(va){this.credentials_=ia(va,ta);return this;};qa.prototype.setRawCredentials=function(va){this.credentials_=va?va:null;return this;};qa.prototype.hasCredentials=function(){return null!==this.credentials_;};qa.prototype.getDomain=function(){return this.domain_&&decodeURIComponent(this.domain_);};qa.prototype.getRawDomain=function(){return this.domain_;};qa.prototype.setDomain=function(va){return this.setRawDomain(va&&encodeURIComponent(va));};qa.prototype.setRawDomain=function(va){this.domain_=va?va:null;return this.setRawPath(this.path_);};qa.prototype.hasDomain=function(){return null!==this.domain_;};qa.prototype.getPort=function(){return this.port_&&decodeURIComponent(this.port_);};qa.prototype.setPort=function(va){if(va){va=Number(va);if(va!==(va&65535))throw new Error('Bad port number '+va);this.port_=''+va;}else this.port_=null;return this;};qa.prototype.hasPort=function(){return null!==this.port_;};qa.prototype.getPath=function(){return this.path_&&decodeURIComponent(this.path_);};qa.prototype.getRawPath=function(){return this.path_;};qa.prototype.setPath=function(va){return this.setRawPath(ia(va,ua));};qa.prototype.setRawPath=function(va){if(va){va=String(va);this.path_=(!this.domain_||/^\//.test(va))?va:'/'+va;}else this.path_=null;return this;};qa.prototype.hasPath=function(){return null!==this.path_;};qa.prototype.getQuery=function(){return this.query_&&decodeURIComponent(this.query_).replace(/\+/g,' ');};qa.prototype.getRawQuery=function(){return this.query_;};qa.prototype.setQuery=function(va){this.paramCache_=null;this.query_=ha(va);return this;};qa.prototype.setRawQuery=function(va){this.paramCache_=null;this.query_=va?va:null;return this;};qa.prototype.hasQuery=function(){return null!==this.query_;};qa.prototype.setAllParameters=function(va){if(typeof va==='object')if(!(va instanceof Array)&&(va instanceof Object||Object.prototype.toString.call(va)!=='[object Array]')){var wa=[],xa=-1;for(var ya in va){var za=va[ya];if('string'===typeof za){wa[++xa]=ya;wa[++xa]=za;}}va=wa;}this.paramCache_=null;var ab=[],bb='';for(var cb=0;cb<va.length;){var ya=va[cb++],za=va[cb++];ab.push(bb,encodeURIComponent(ya.toString()));bb='&';if(za)ab.push('=',encodeURIComponent(za.toString()));}this.query_=ab.join('');return this;};qa.prototype.checkParameterCache_=function(){if(!this.paramCache_){var va=this.query_;if(!va){this.paramCache_=[];}else{var wa=va.split(/[&\?]/),xa=[],ya=-1;for(var za=0;za<wa.length;++za){var ab=wa[za].match(/^([^=]*)(?:=(.*))?$/);xa[++ya]=decodeURIComponent(ab[1]).replace(/\+/g,' ');xa[++ya]=decodeURIComponent(ab[2]||'').replace(/\+/g,' ');}this.paramCache_=xa;}}};qa.prototype.setParameterValues=function(va,wa){if(typeof wa==='string')wa=[wa];this.checkParameterCache_();var xa=0,ya=this.paramCache_,za=[];for(var ab=0,bb=0;ab<ya.length;ab+=2)if(va===ya[ab]){if(xa<wa.length)za.push(va,wa[xa++]);}else za.push(ya[ab],ya[ab+1]);while(xa<wa.length)za.push(va,wa[xa++]);this.setAllParameters(za);return this;};qa.prototype.removeParameter=function(va){return this.setParameterValues(va,[]);};qa.prototype.getAllParameters=function(){this.checkParameterCache_();return this.paramCache_.slice(0,this.paramCache_.length);};qa.prototype.getParameterValues=function(va){this.checkParameterCache_();var wa=[];for(var xa=0;xa<this.paramCache_.length;xa+=2)if(va===this.paramCache_[xa])wa.push(this.paramCache_[xa+1]);return wa;};qa.prototype.getParameterMap=function(va){this.checkParameterCache_();var wa={};for(var xa=0;xa<this.paramCache_.length;xa+=2){var ya=this.paramCache_[xa++],za=this.paramCache_[xa++];if(!(ya in wa)){wa[ya]=[za];}else wa[ya].push(za);}return wa;};qa.prototype.getParameterValue=function(va){this.checkParameterCache_();for(var wa=0;wa<this.paramCache_.length;wa+=2)if(va===this.paramCache_[wa])return this.paramCache_[wa+1];return null;};qa.prototype.getFragment=function(){return this.fragment_&&decodeURIComponent(this.fragment_);};qa.prototype.getRawFragment=function(){return this.fragment_;};qa.prototype.setFragment=function(va){this.fragment_=va?encodeURIComponent(va):null;return this;};qa.prototype.setRawFragment=function(va){this.fragment_=va?va:null;return this;};qa.prototype.hasFragment=function(){return null!==this.fragment_;};function ra(va){return ('string'==typeof va)&&(va.length>0)?va:null;}var sa=new RegExp("^"+"(?:"+"([^:/?#]+)"+":)?"+"(?://"+"(?:([^/?#]*)@)?"+"([^/?#:@]*)"+"(?::([0-9]+))?"+")?"+"([^?#]+)?"+"(?:\\?([^#]*))?"+"(?:#(.*))?"+"$"),ta=/[#\/\?@]/g,ua=/[\#\?]/g;qa.parse=fa;qa.create=ga;qa.resolve=pa;qa.collapse_dots=oa;qa.utils={mimeTypeOf:function(va){var wa=fa(va);if(/\.html$/.test(wa.getPath())){return 'text/html';}else return 'application/javascript';},resolve:function(va,wa){if(va){return pa(fa(va),fa(wa)).toString();}else return ''+wa;}};return qa;})();typeof window!=='undefined';var u=undefined,v=undefined,w=undefined,x=undefined,y=undefined;(function(){var fa='url("about:blank")',ga=/[\n\f\r\"\'()*<>]/g,ha={'\n':'%0a','\f':'%0c','\r':'%0d','"':'%22','\'':'%27','(':'%28',')':'%29','*':'%2a','<':'%3c','>':'%3e'};function ia(ra){if('string'===typeof ra){return 'url("'+ra.replace(ga,ja)+'")';}else return fa;}function ja(ra){return ha[ra];}var ka=new RegExp('^'+'(?:'+'([^:\/?# ]+)'+':)?'),la=/^(?:https?|mailto)$/i;function ma(ra,sa){if(ra)return t.utils.resolve(ra,sa);return sa;}function na(ra,sa,ta){if(!ta)return null;var ua=(''+ra).match(ka);if(ua&&(!ua[1]||la.test(ua[1]))){return ta(ra,sa);}else return null;}function oa(ra){return ra.replace(/^-(?:apple|css|epub|khtml|moz|mso?|o|rim|wap|webkit|xv)-(?=[a-z])/,'');}u=(function(){function ra(ta){var ua={};for(var va=ta.length;--va>=0;){var wa=ta[va];for(var xa=wa.length;--xa>=0;)ua[wa[xa]]=sa;}return ua;}var sa={};return function ta(ua,va,wa,xa,ya){var za=oa(ua),ab=q[za];if(!ab||'object'!==typeof ab){va.length=0;return;}var bb=ab.cssPropBits;function cb(rb,sb){var tb=1,ub=sb+1,vb=rb.length;while(ub<vb&&tb){var wb=rb[ub++];tb+=(wb===')'?-1:/^[^"']*\($/.test(wb));}if(!tb){var xb=rb[sb].toLowerCase(),yb=oa(xb),zb=rb.splice(sb,ub-sb,''),ac=ab.cssFns;for(var bc=0,cc=ac.length;bc<cc;++bc)if(ac[bc].substring(0,yb.length)==yb){zb[0]=zb[zb.length-1]='';ta(ac[bc],zb,wa,xa);return xb+zb.join(' ')+')';}}return '';}var db=bb&(l|m),eb=bb&(o|p),fb=NaN,gb=0,hb=0;for(;gb<va.length;++gb){var ib=va[gb].toLowerCase(),jb=ib.charCodeAt(0),kb,lb,mb,nb,ob,pb,qb;ib=((jb===' '.charCodeAt(0))?'':(jb==='"'.charCodeAt(0))?((db===l)?(wa?(ia(na(ma(xa,s(va[gb].substring(1,ib.length-1))),za,wa))):''):((bb&k)&&!(db&(db-1)))?ib:''):ib==='inherit'?ib:(pb=ab.cssLitGroup,qb=(pb?(ab.cssLitMap||(ab.cssLitMap=ra(pb))):sa),(qb[oa(ib)]===sa))?ib:(jb==='#'.charCodeAt(0)&&/^#(?:[0-9a-f]{3}){1,2}$/.test(ib))?(bb&i?ib:''):('0'.charCodeAt(0)<=jb&&jb<='9'.charCodeAt(0))?((bb&h)?ib:''):(kb=ib.charCodeAt(1),lb=ib.charCodeAt(2),mb='0'.charCodeAt(0)<=kb&&kb<='9'.charCodeAt(0),nb='0'.charCodeAt(0)<=lb&&lb<='9'.charCodeAt(0),(jb==='+'.charCodeAt(0)&&(mb||(kb==='.'.charCodeAt(0)&&nb))))?((bb&h)?((mb?'':'0')+ib.substring(1)):''):(jb==='-'.charCodeAt(0)&&(mb||(kb==='.'.charCodeAt(0)&&nb)))?((bb&j)?((mb?'-':'-0')+ib.substring(1)):((bb&h)?'0':'')):(jb==='.'.charCodeAt(0)&&mb)?((bb&h)?'0'+ib:''):('url("'===ib.substring(0,5))?((wa&&(bb&l))?ia(na(ma(xa,va[gb].substring(5,ib.length-2)),za,wa)):''):(ib.charAt(ib.length-1)==='(')?cb(va,gb):(eb&&/^-?[a-z_][\w\-]*$/.test(ib)&&!/__$/.test(ib))?(ya&&eb===o?va[gb]+ya:(eb===p&&q[ib]&&'number'===typeof q[ib].cssPropBits)?ib:''):(/^\w+$/.test(ib)&&db===m&&(bb&k))?(fb+1===hb?(va[fb]=(va[fb].substring(0,va[fb].length-1)+' '+ib+'"'),ib=''):(fb=hb,'"'+ib+'"')):'');if(ib)va[hb++]=ib;}if(hb===1&&va[0]===fa)hb=0;va.length=hb;};})();var pa=new RegExp('^(active|after|before|blank|checked|default|disabled'+'|drop|empty|enabled|first|first-child|first-letter'+'|first-line|first-of-type|fullscreen|focus|hover'+'|in-range|indeterminate|invalid|last-child|last-of-type'+'|left|link|only-child|only-of-type|optional|out-of-range'+'|placeholder-shown|read-only|read-write|required|right'+'|root|scope|user-error|valid|visited'+')$'),qa={};qa['>']=qa['+']=qa['~']=qa;v=function(ra,sa,ta){var ua=sa.containerClass,va=sa.idSuffix,wa=sa.tagPolicy,xa=[],ya=0,za,ab=0,bb;for(za=0;za<ra.length;++za){bb=ra[za];if((bb=='('||bb=='[')?(++ab,true):(bb==')'||bb==']')?(ab&&--ab,true):!(ra[za]==' '&&(ab||qa[ra[za-1]]===qa||qa[ra[za+1]]===qa)))ra[ya++]=ra[za];}ra.length=ya;var cb=ra.length,db=0;for(za=0;za<cb;++za)if(ra[za]===','){if(!eb(db,za))return null;db=za+1;}if(!eb(db,cb))return null;function eb(fb,gb){if(ra[fb]===' ')++fb;if(gb-1!==fb&&ra[gb]===' ')--gb;var hb=[],ib=fb,jb=true;for(var kb=fb;jb&&kb<gb;++kb){var lb=ra[kb];if(qa[lb]===qa||lb===' ')if(!mb(ib,kb,lb)){jb=false;}else ib=kb+1;}if(!mb(ib,gb,''))jb=false;function mb(ob,pb,qb){var rb,sb,tb,ub,vb,wb=true;rb='';if(ob<pb){vb=ra[ob];if(vb==='*'){++ob;rb=vb;}else if(/^[a-zA-Z]/.test(vb)){var xb=wa(vb.toLowerCase(),[]);if(xb){if('tagName' in xb)vb=xb.tagName;++ob;rb=vb;}}}sb='';tb='';ub='';for(;wb&&ob<pb;++ob){vb=ra[ob];if(vb.charAt(0)==='#'){if(/^#_|__$|[^\w#:\-]/.test(vb)){wb=false;}else sb+=vb+va;}else if(vb==='.'){if(++ob<pb&&/^[0-9A-Za-z:_\-]+$/.test(vb=ra[ob])&&!/^_|__$/.test(vb)){sb+='.'+vb;}else wb=false;}else if(ob+1<pb&&ra[ob]==='['){++ob;var yb=ra[ob++].toLowerCase(),zb=ba.ATTRIBS[rb+'::'+yb];if(zb!==+zb)zb=ba.ATTRIBS['*::'+yb];var ac;if(sa.virtualizeAttrName){ac=sa.virtualizeAttrName(rb,yb);if(typeof ac!=='string'){wb=false;ac=yb;}if(wb&&zb!==+zb)zb=ba.atype.NONE;}else{ac=yb;if(zb!==+zb)wb=false;}var bc='',cc='',dc=false;if(/^[~^$*|]?=$/.test(ra[ob])){bc=ra[ob++];cc=ra[ob++];if(/^[0-9A-Za-z:_\-]+$/.test(cc)){cc='"'+cc+'"';}else if(cc===']'){cc='""';--ob;}if(!/^"([^\"\\]|\\.)*"$/.test(cc))wb=false;dc=ra[ob]==="i";if(dc)++ob;}if(ra[ob]!==']'){++ob;wb=false;}switch(zb){case ba.atype.CLASSES:case ba.atype.LOCAL_NAME:case ba.atype.NONE:break;case ba.atype.GLOBAL_NAME:case ba.atype.ID:case ba.atype.IDREF:if((bc==='='||bc==='~='||bc==='$=')&&cc!='""'&&!dc){cc='"'+cc.substring(1,cc.length-1)+va+'"';}else if(!(bc==='|='||bc===''))wb=false;break;case ba.atype.URI:case ba.atype.URI_FRAGMENT:if(bc!=='')wb=false;break;default:wb=false;}if(wb)tb+='['+ac.replace(/[^\w-]/g,'\\$&')+bc+cc+(dc?' i]':']');}else if(ob<pb&&ra[ob]===':'){vb=ra[++ob];if(pa.test(vb)){ub+=':'+vb;}else break;}else break;}if(ob!==pb)wb=false;if(wb){var ec=(rb+sb).replace(/[^ .*#\w-]/g,'\\$&')+tb+ub+qb;if(ec)hb.push(ec);}return wb;}if(jb){if(hb.length){var nb=hb.join('');if(ua!==null)nb='.'+ua+' '+nb;xa.push(nb);}return true;}else return !ta||ta(ra.slice(fb,gb));}return xa;};(function(){var ra='(?:'+'all|aural|braille|embossed|handheld|print'+'|projection|screen|speech|tty|tv'+')',sa='(?:'+'(?:min-|max-)?'+'(?:'+('(?:device-)?'+'(?:aspect-ratio|height|width)'+'|color(?:-index)?'+'|monochrome'+'|orientation'+'|resolution')+')'+'|grid'+'|hover'+'|luminosity'+'|pointer'+'|scan'+'|script'+')',ta='(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)',ua='-?(?:'+'[a-z]\\w+(?:-\\w+)*'+'|\\d+(?: / \\d+|(?:\\.\\d+)?'+ta+'?)'+')',va='\\( '+sa+' (?:'+': '+ua+' )?\\)',wa='(?:'+'(?:(?:(?:only|not) )?'+ra+'|'+va+')'+'(?: and ?'+va+')*'+')',xa=/^\w/,ya=new RegExp('^'+wa+'(?: , '+wa+')*'+'$','i');y=function(za){za=za.slice();var ab=za.length,bb=0;for(var cb=0;cb<ab;++cb){var db=za[cb];if(db!=' ')za[bb++]=db;}za.length=bb;var eb=za.join(' ');eb=(!eb.length?'':!(ya.test(eb))?'not all':xa.test(eb)?eb:'not all , '+eb);return eb;};}());(function(){function ra(ta){var ua=/^\s*["]([^"]*)["]\s*$/,va=/^\s*[']([^']*)[']\s*$/,wa=/^\s*url\s*[(]["]([^"]*)["][)]\s*$/,xa=/^\s*url\s*[(][']([^']*)['][)]\s*$/,ya=/^\s*url\s*[(]([^)]*)[)]\s*$/,za;if((za=ua.exec(ta))){return za[1];}else if((za=va.exec(ta))){return za[1];}else if((za=wa.exec(ta))){return za[1];}else if((za=xa.exec(ta))){return za[1];}else if((za=ya.exec(ta)))return za[1];return null;}function sa(ta,ua,va,wa,xa,ya,za){var ab=void 0,bb=za||[0],cb=[],db=false;z(ua,{startStylesheet:function(){ab=[];},endStylesheet:function(){},startAtrule:function(fb,gb){if(db){fb=null;}else if(fb==='@media'){ab.push('@media',' ',y(gb));}else if(fb==='@keyframes'||fb==='@-webkit-keyframes'){var hb=gb[0];if(gb.length===1&&!/__$|[^\w\-]/.test(hb)){ab.push(fb,' ',hb+va.idSuffix);fb='@keyframes';}else fb=null;}else if(fb==='@import'&&gb.length>0){fb=null;if('function'===typeof ya){var ib=y(gb.slice(1));if(ib!=='not all'){++bb[0];var jb=[];ab.push(jb);var kb=na(ma(ta,ra(gb[0])),function(lb){var mb=sa(kb,lb.html,va,wa,xa,ya,bb);--bb[0];var nb=ib?{toString:function(){return ('@media '+ib+' {'+mb.result+'}');}}:mb.result;jb[0]=nb;ya(nb,!!bb[0]);},xa);}}else if(window.console)window.console.log('@import '+gb.join(' ')+' elided');}db=!fb;cb.push(fb);},endAtrule:function(){cb.pop();if(!db)ab.push(';');eb();},startBlock:function(){if(!db)ab.push('{');},endBlock:function(){if(!db){ab.push('}');db=true;}},startRuleset:function(fb){if(!db){var gb=void 0;if(cb[cb.length-1]==='@keyframes'){gb=fb.join(' ').match(/^ *(?:from|to|\d+(?:\.\d+)?%) *(?:, *(?:from|to|\d+(?:\.\d+)?%) *)*$/i);db=!gb;if(gb)gb=gb[0].replace(/ +/g,'');}else{var hb=v(fb,va);if(!hb||!hb.length){db=true;}else gb=hb.join(', ');}if(!db)ab.push(gb,'{');}cb.push(null);},endRuleset:function(){cb.pop();if(!db)ab.push('}');eb();},declaration:function(fb,gb){if(!db){var hb=false,ib=gb.length;if(ib>=2&&gb[ib-2]==='!'&&gb[ib-1].toLowerCase()==='important'){hb=true;gb.length-=2;}u(fb,gb,wa,ta,va.idSuffix);if(gb.length)ab.push(fb,':',gb.join(' '),hb?' !important;':';');}}});function eb(){db=cb.length&&cb[cb.length-1]===null;}return {result:{toString:function(){return ab.join('');}},moreToCome:!!bb[0]};}w=function(ta,ua,va,wa){return sa(ta,ua,va,wa,undefined,undefined).result.toString();};x=function(ta,ua,va,wa,xa,ya){return sa(ta,ua,va,wa,xa,ya);};})();})();if(typeof window!=='undefined'){window.sanitizeCssProperty=u;window.sanitizeCssSelectorList=v;window.sanitizeStylesheet=w;window.sanitizeMediaQuery=y;}if('I'.toLowerCase()!=='i')throw 'I/i problem';var z,aa;(function(){z=function(na,oa){var pa=r(na);if(oa.startStylesheet)oa.startStylesheet();for(var qa=0,ra=pa.length;qa<ra;)qa=pa[qa]===' '?qa+1:fa(pa,qa,ra,oa);if(oa.endStylesheet)oa.endStylesheet();};function fa(na,oa,pa,qa){if(oa<pa){var ra=na[oa];if(ra.charAt(0)==='@'){return ga(na,oa,pa,qa,true);}else return ia(na,oa,pa,qa);}else return oa;}function ga(na,oa,pa,qa,ra){var sa=oa++;while(oa<pa&&na[oa]!=='{'&&na[oa]!==';')++oa;if(oa<pa&&(ra||na[oa]===';')){var ta=sa+1,ua=oa;if(ta<pa&&na[ta]===' ')++ta;if(ua>ta&&na[ua-1]===' ')--ua;if(qa.startAtrule)qa.startAtrule(na[sa].toLowerCase(),na.slice(ta,ua));oa=(na[oa]==='{')?ha(na,oa,pa,qa):oa+1;if(qa.endAtrule)qa.endAtrule();}return oa;}function ha(na,oa,pa,qa){++oa;if(qa.startBlock)qa.startBlock();while(oa<pa){var ra=na[oa].charAt(0);if(ra=='}'){++oa;break;}if(ra===' '||ra===';'){oa=oa+1;}else if(ra==='@'){oa=ga(na,oa,pa,qa,false);}else if(ra==='{'){oa=ha(na,oa,pa,qa);}else oa=ia(na,oa,pa,qa);}if(qa.endBlock)qa.endBlock();return oa;}function ia(na,oa,pa,qa){var ra=oa,sa=ja(na,oa,pa,true);if(sa<0){sa=~sa;return sa===ra?sa+1:sa;}var ta=na[sa];if(ta!=='{')return sa===ra?sa+1:sa;oa=sa+1;if(sa>ra&&na[sa-1]===' ')--sa;if(qa.startRuleset)qa.startRuleset(na.slice(ra,sa));while(oa<pa){ta=na[oa];if(ta==='}'){++oa;break;}if(ta===' '){oa=oa+1;}else oa=ma(na,oa,pa,qa);}if(qa.endRuleset)qa.endRuleset();return oa;}function ja(na,oa,pa,qa){var ra=oa,sa,ta=[],ua=-1;for(;oa<pa;++oa){sa=na[oa].charAt(0);if(sa==='['||sa==='('){ta[++ua]=sa;}else if((sa===']'&&ta[ua]==='[')||(sa===')'&&ta[ua]==='(')){--ua;}else if(sa==='{'||sa==='}'||sa===';'||sa==='@'||(sa===':'&&!qa))break;}if(ua>=0)oa=~(oa+1);return oa;}var ka=/^-?[a-z]/i;function la(na,oa,pa){while(oa<pa&&na[oa]!==';'&&na[oa]!=='}')++oa;return oa<pa&&na[oa]===';'?oa+1:oa;}function ma(na,oa,pa,qa){var ra=na[oa++];if(!ka.test(ra))return la(na,oa,pa);var sa;if(oa<pa&&na[oa]===' ')++oa;if(oa==pa||na[oa]!==':')return la(na,oa,pa);++oa;if(oa<pa&&na[oa]===' ')++oa;var ta=oa,ua=ja(na,oa,pa,false);if(ua<0){ua=~ua;}else{var va=[],wa=0;for(var xa=ta;xa<ua;++xa){sa=na[xa];if(sa!==' ')va[wa++]=sa;}if(ua<pa){do{sa=na[ua];if(sa===';'||sa==='}')break;wa=0;}while(++ua<pa);if(sa===';')++ua;}if(wa&&qa.declaration)qa.declaration(ra.toLowerCase(),va);}return ua;}aa=function(na,oa){var pa=r(na);for(var qa=0,ra=pa.length;qa<ra;)qa=pa[qa]!==' '?ma(pa,qa,ra,oa):qa+1;};})();if(typeof window!=='undefined'){window.parseCssStylesheet=z;window.parseCssDeclarations=aa;}var ba={};ba.atype={NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,HTML:12,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10,MEDIA_QUERY:13};ba.atype=ba.atype;ba.ATTRIBS={'*::class':9,'*::dir':0,'*::draggable':0,'*::hidden':0,'*::id':4,'*::inert':0,'*::itemprop':0,'*::itemref':6,'*::itemscope':0,'*::lang':0,'*::onblur':2,'*::onchange':2,'*::onclick':2,'*::ondblclick':2,'*::onerror':2,'*::onfocus':2,'*::onkeydown':2,'*::onkeypress':2,'*::onkeyup':2,'*::onload':2,'*::onmousedown':2,'*::onmousemove':2,'*::onmouseout':2,'*::onmouseover':2,'*::onmouseup':2,'*::onreset':2,'*::onscroll':2,'*::onselect':2,'*::onsubmit':2,'*::ontouchcancel':2,'*::ontouchend':2,'*::ontouchenter':2,'*::ontouchleave':2,'*::ontouchmove':2,'*::ontouchstart':2,'*::onunload':2,'*::spellcheck':0,'*::style':3,'*::tabindex':0,'*::title':0,'*::translate':0,'a::accesskey':0,'a::coords':0,'a::href':1,'a::hreflang':0,'a::name':7,'a::onblur':2,'a::onfocus':2,'a::shape':0,'a::target':10,'a::type':0,'area::accesskey':0,'area::alt':0,'area::coords':0,'area::href':1,'area::nohref':0,'area::onblur':2,'area::onfocus':2,'area::shape':0,'area::target':10,'audio::controls':0,'audio::loop':0,'audio::mediagroup':5,'audio::muted':0,'audio::preload':0,'audio::src':1,'bdo::dir':0,'blockquote::cite':1,'br::clear':0,'button::accesskey':0,'button::disabled':0,'button::name':8,'button::onblur':2,'button::onfocus':2,'button::type':0,'button::value':0,'canvas::height':0,'canvas::width':0,'caption::align':0,'col::align':0,'col::char':0,'col::charoff':0,'col::span':0,'col::valign':0,'col::width':0,'colgroup::align':0,'colgroup::char':0,'colgroup::charoff':0,'colgroup::span':0,'colgroup::valign':0,'colgroup::width':0,'command::checked':0,'command::command':5,'command::disabled':0,'command::icon':1,'command::label':0,'command::radiogroup':0,'command::type':0,'data::value':0,'del::cite':1,'del::datetime':0,'details::open':0,'dir::compact':0,'div::align':0,'dl::compact':0,'fieldset::disabled':0,'font::color':0,'font::face':0,'font::size':0,'form::accept':0,'form::action':1,'form::autocomplete':0,'form::enctype':0,'form::method':0,'form::name':7,'form::novalidate':0,'form::onreset':2,'form::onsubmit':2,'form::target':10,'h1::align':0,'h2::align':0,'h3::align':0,'h4::align':0,'h5::align':0,'h6::align':0,'hr::align':0,'hr::noshade':0,'hr::size':0,'hr::width':0,'iframe::align':0,'iframe::frameborder':0,'iframe::height':0,'iframe::marginheight':0,'iframe::marginwidth':0,'iframe::width':0,'img::align':0,'img::alt':0,'img::border':0,'img::height':0,'img::hspace':0,'img::ismap':0,'img::name':7,'img::src':1,'img::usemap':11,'img::vspace':0,'img::width':0,'input::accept':0,'input::accesskey':0,'input::align':0,'input::alt':0,'input::autocomplete':0,'input::checked':0,'input::disabled':0,'input::inputmode':0,'input::ismap':0,'input::list':5,'input::max':0,'input::maxlength':0,'input::min':0,'input::multiple':0,'input::name':8,'input::onblur':2,'input::onchange':2,'input::onfocus':2,'input::onselect':2,'input::pattern':0,'input::placeholder':0,'input::readonly':0,'input::required':0,'input::size':0,'input::src':1,'input::step':0,'input::type':0,'input::usemap':11,'input::value':0,'ins::cite':1,'ins::datetime':0,'label::accesskey':0,'label::for':5,'label::onblur':2,'label::onfocus':2,'legend::accesskey':0,'legend::align':0,'li::type':0,'li::value':0,'map::name':7,'menu::compact':0,'menu::label':0,'menu::type':0,'meter::high':0,'meter::low':0,'meter::max':0,'meter::min':0,'meter::optimum':0,'meter::value':0,'ol::compact':0,'ol::reversed':0,'ol::start':0,'ol::type':0,'optgroup::disabled':0,'optgroup::label':0,'option::disabled':0,'option::label':0,'option::selected':0,'option::value':0,'output::for':6,'output::name':8,'p::align':0,'pre::width':0,'progress::max':0,'progress::min':0,'progress::value':0,'q::cite':1,'select::autocomplete':0,'select::disabled':0,'select::multiple':0,'select::name':8,'select::onblur':2,'select::onchange':2,'select::onfocus':2,'select::required':0,'select::size':0,'source::type':0,'table::align':0,'table::bgcolor':0,'table::border':0,'table::cellpadding':0,'table::cellspacing':0,'table::frame':0,'table::rules':0,'table::summary':0,'table::width':0,'tbody::align':0,'tbody::char':0,'tbody::charoff':0,'tbody::valign':0,'td::abbr':0,'td::align':0,'td::axis':0,'td::bgcolor':0,'td::char':0,'td::charoff':0,'td::colspan':0,'td::headers':6,'td::height':0,'td::nowrap':0,'td::rowspan':0,'td::scope':0,'td::valign':0,'td::width':0,'textarea::accesskey':0,'textarea::autocomplete':0,'textarea::cols':0,'textarea::disabled':0,'textarea::inputmode':0,'textarea::name':8,'textarea::onblur':2,'textarea::onchange':2,'textarea::onfocus':2,'textarea::onselect':2,'textarea::placeholder':0,'textarea::readonly':0,'textarea::required':0,'textarea::rows':0,'textarea::wrap':0,'tfoot::align':0,'tfoot::char':0,'tfoot::charoff':0,'tfoot::valign':0,'th::abbr':0,'th::align':0,'th::axis':0,'th::bgcolor':0,'th::char':0,'th::charoff':0,'th::colspan':0,'th::headers':6,'th::height':0,'th::nowrap':0,'th::rowspan':0,'th::scope':0,'th::valign':0,'th::width':0,'thead::align':0,'thead::char':0,'thead::charoff':0,'thead::valign':0,'tr::align':0,'tr::bgcolor':0,'tr::char':0,'tr::charoff':0,'tr::valign':0,'track::default':0,'track::kind':0,'track::label':0,'track::srclang':0,'ul::compact':0,'ul::type':0,'video::controls':0,'video::height':0,'video::loop':0,'video::mediagroup':5,'video::muted':0,'video::poster':1,'video::preload':0,'video::src':1,'video::width':0};ba.ATTRIBS=ba.ATTRIBS;ba.eflags={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128,VIRTUALIZED:256};ba.eflags=ba.eflags;ba.ELEMENTS={a:0,abbr:0,acronym:0,address:0,applet:272,area:2,article:0,aside:0,audio:0,b:0,base:274,basefont:274,bdi:0,bdo:0,big:0,blockquote:0,body:305,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,command:2,data:0,datalist:0,dd:1,del:0,details:0,dfn:0,dialog:272,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,figcaption:0,figure:0,font:0,footer:0,form:0,frame:274,frameset:272,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:305,header:0,hgroup:0,hr:2,html:305,i:0,iframe:4,img:2,input:2,ins:0,isindex:274,kbd:0,keygen:274,label:0,legend:0,li:1,link:274,map:0,mark:0,menu:0,meta:274,meter:0,nav:0,nobr:0,noembed:276,noframes:276,noscript:276,object:272,ol:0,optgroup:0,option:1,output:0,p:1,param:274,pre:0,progress:0,q:0,s:0,samp:0,script:84,section:0,select:0,small:0,source:2,span:0,strike:0,strong:0,style:148,sub:0,summary:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,time:0,title:280,tr:1,track:2,tt:0,u:0,ul:0,'var':0,video:0,wbr:2};ba.ELEMENTS=ba.ELEMENTS;ba.ELEMENT_DOM_INTERFACES={a:'HTMLAnchorElement',abbr:'HTMLElement',acronym:'HTMLElement',address:'HTMLElement',applet:'HTMLAppletElement',area:'HTMLAreaElement',article:'HTMLElement',aside:'HTMLElement',audio:'HTMLAudioElement',b:'HTMLElement',base:'HTMLBaseElement',basefont:'HTMLBaseFontElement',bdi:'HTMLElement',bdo:'HTMLElement',big:'HTMLElement',blockquote:'HTMLQuoteElement',body:'HTMLBodyElement',br:'HTMLBRElement',button:'HTMLButtonElement',canvas:'HTMLCanvasElement',caption:'HTMLTableCaptionElement',center:'HTMLElement',cite:'HTMLElement',code:'HTMLElement',col:'HTMLTableColElement',colgroup:'HTMLTableColElement',command:'HTMLCommandElement',data:'HTMLElement',datalist:'HTMLDataListElement',dd:'HTMLElement',del:'HTMLModElement',details:'HTMLDetailsElement',dfn:'HTMLElement',dialog:'HTMLDialogElement',dir:'HTMLDirectoryElement',div:'HTMLDivElement',dl:'HTMLDListElement',dt:'HTMLElement',em:'HTMLElement',fieldset:'HTMLFieldSetElement',figcaption:'HTMLElement',figure:'HTMLElement',font:'HTMLFontElement',footer:'HTMLElement',form:'HTMLFormElement',frame:'HTMLFrameElement',frameset:'HTMLFrameSetElement',h1:'HTMLHeadingElement',h2:'HTMLHeadingElement',h3:'HTMLHeadingElement',h4:'HTMLHeadingElement',h5:'HTMLHeadingElement',h6:'HTMLHeadingElement',head:'HTMLHeadElement',header:'HTMLElement',hgroup:'HTMLElement',hr:'HTMLHRElement',html:'HTMLHtmlElement',i:'HTMLElement',iframe:'HTMLIFrameElement',img:'HTMLImageElement',input:'HTMLInputElement',ins:'HTMLModElement',isindex:'HTMLUnknownElement',kbd:'HTMLElement',keygen:'HTMLKeygenElement',label:'HTMLLabelElement',legend:'HTMLLegendElement',li:'HTMLLIElement',link:'HTMLLinkElement',map:'HTMLMapElement',mark:'HTMLElement',menu:'HTMLMenuElement',meta:'HTMLMetaElement',meter:'HTMLMeterElement',nav:'HTMLElement',nobr:'HTMLElement',noembed:'HTMLElement',noframes:'HTMLElement',noscript:'HTMLElement',object:'HTMLObjectElement',ol:'HTMLOListElement',optgroup:'HTMLOptGroupElement',option:'HTMLOptionElement',output:'HTMLOutputElement',p:'HTMLParagraphElement',param:'HTMLParamElement',pre:'HTMLPreElement',progress:'HTMLProgressElement',q:'HTMLQuoteElement',s:'HTMLElement',samp:'HTMLElement',script:'HTMLScriptElement',section:'HTMLElement',select:'HTMLSelectElement',small:'HTMLElement',source:'HTMLSourceElement',span:'HTMLSpanElement',strike:'HTMLElement',strong:'HTMLElement',style:'HTMLStyleElement',sub:'HTMLElement',summary:'HTMLElement',sup:'HTMLElement',table:'HTMLTableElement',tbody:'HTMLTableSectionElement',td:'HTMLTableDataCellElement',textarea:'HTMLTextAreaElement',tfoot:'HTMLTableSectionElement',th:'HTMLTableHeaderCellElement',thead:'HTMLTableSectionElement',time:'HTMLTimeElement',title:'HTMLTitleElement',tr:'HTMLTableRowElement',track:'HTMLTrackElement',tt:'HTMLElement',u:'HTMLElement',ul:'HTMLUListElement','var':'HTMLElement',video:'HTMLVideoElement',wbr:'HTMLElement'};ba.ELEMENT_DOM_INTERFACES=ba.ELEMENT_DOM_INTERFACES;ba.ueffects={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2};ba.ueffects=ba.ueffects;ba.URIEFFECTS={'a::href':2,'area::href':2,'audio::src':1,'blockquote::cite':0,'command::icon':1,'del::cite':0,'form::action':2,'img::src':1,'input::src':1,'ins::cite':0,'q::cite':0,'video::poster':1,'video::src':1};ba.URIEFFECTS=ba.URIEFFECTS;ba.ltypes={UNSANDBOXED:2,SANDBOXED:1,DATA:0};ba.ltypes=ba.ltypes;ba.LOADERTYPES={'a::href':2,'area::href':2,'audio::src':2,'blockquote::cite':2,'command::icon':1,'del::cite':2,'form::action':2,'img::src':1,'input::src':1,'ins::cite':2,'q::cite':2,'video::poster':1,'video::src':2};ba.LOADERTYPES=ba.LOADERTYPES;if(typeof window!=='undefined')window.html4=ba;if('I'.toLowerCase()!=='i')throw 'I/i problem';var ca={};ca.TagPolicyDecision;ca.TagPolicy;var da=(function(fa){var ga,ha,ia;if('undefined'!==typeof window){ga=window.parseCssDeclarations;ha=window.sanitizeCssProperty;ia=window.cssSchema;}var ja={lt:'<',LT:'<',gt:'>',GT:'>',amp:'&',AMP:'&',quot:'"',apos:'\'',nbsp:'\u00A0'},ka=/^#(\d+)$/,la=/^#x([0-9A-Fa-f]+)$/,ma=/^[A-Za-z][A-za-z0-9]+$/,na=('undefined'!==typeof window&&window.document)?window.document.createElement('textarea'):null;function oa(ec){if(ja.hasOwnProperty(ec))return ja[ec];var fc=ec.match(ka);if(fc){return String.fromCharCode(parseInt(fc[1],10));}else if(!!(fc=ec.match(la))){return String.fromCharCode(parseInt(fc[1],16));}else if(na&&ma.test(ec)){na.innerHTML='&'+ec+';';var gc=na.textContent;ja[ec]=gc;return gc;}else return '&'+ec+';';}function pa(ec,fc){return oa(fc);}var qa=/\0/g;function ra(ec){return ec.replace(qa,'');}var sa=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,ta=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/;function ua(ec){return ec.replace(sa,pa);}var va=/&/g,wa=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,xa=/[<]/g,ya=/>/g,za=/\"/g;function ab(ec){return (''+ec).replace(va,'&amp;').replace(xa,'&lt;').replace(ya,'&gt;').replace(za,'&#34;');}function bb(ec){return ec.replace(wa,'&amp;$1').replace(xa,'&lt;').replace(ya,'&gt;');}var cb=new RegExp('^\\s*'+'([-.:\\w]+)'+'(?:'+('\\s*(=)\\s*'+'('+('(\")[^\"]*(\"|$)'+'|'+'(\')[^\']*(\'|$)'+'|'+'(?=[a-z][-\\w]*\\s*=)'+'|'+'[^\"\'\\s]*')+')')+')?','i'),db=('a,b'.split(/(,)/).length===3),eb=fa.eflags.CDATA|fa.eflags.RCDATA;function fb(ec){var fc={cdata:ec.cdata||ec.cdata,comment:ec.comment||ec.comment,endDoc:ec.endDoc||ec.endDoc,endTag:ec.endTag||ec.endTag,pcdata:ec.pcdata||ec.pcdata,rcdata:ec.rcdata||ec.rcdata,startDoc:ec.startDoc||ec.startDoc,startTag:ec.startTag||ec.startTag};return function(gc,hc){return hb(gc,fc,hc);};}var gb={};function hb(ec,fc,gc){var hc,ic,jc,kc=kb(ec),lc={noMoreGT:false,noMoreEndComments:false};jb(fc,kc,0,lc,gc);}function ib(ec,fc,gc,hc,ic){return function(){jb(ec,fc,gc,hc,ic);};}function jb(ec,fc,gc,hc,ic){try{if(ec.startDoc&&gc==0)ec.startDoc(ic);var kc,lc,mc;for(var nc=gc,oc=fc.length;nc<oc;){var pc=fc[nc++],qc=fc[nc];switch(pc){case '&':if(ta.test(qc)){if(ec.pcdata)ec.pcdata('&'+qc,ic,gb,ib(ec,fc,nc,hc,ic));nc++;}else if(ec.pcdata)ec.pcdata("&amp;",ic,gb,ib(ec,fc,nc,hc,ic));break;case '<\/':if((kc=/^([-\w:]+)[^\'\"]*/.exec(qc))){if(kc[0].length===qc.length&&fc[nc+1]==='>'){nc+=2;mc=kc[1].toLowerCase();if(ec.endTag)ec.endTag(mc,ic,gb,ib(ec,fc,nc,hc,ic));}else nc=lb(fc,nc,ec,ic,gb,hc);}else if(ec.pcdata)ec.pcdata('&lt;/',ic,gb,ib(ec,fc,nc,hc,ic));break;case '<':if(kc=/^([-\w:]+)\s*\/?/.exec(qc)){if(kc[0].length===qc.length&&fc[nc+1]==='>'){nc+=2;mc=kc[1].toLowerCase();if(ec.startTag)ec.startTag(mc,[],ic,gb,ib(ec,fc,nc,hc,ic));var rc=fa.ELEMENTS[mc];if(rc&eb){var sc={name:mc,next:nc,eflags:rc};nc=ob(fc,sc,ec,ic,gb,hc);}}else nc=mb(fc,nc,ec,ic,gb,hc);}else if(ec.pcdata)ec.pcdata('&lt;',ic,gb,ib(ec,fc,nc,hc,ic));break;case '<\!--':if(!hc.noMoreEndComments){for(lc=nc+1;lc<oc;lc++)if(fc[lc]==='>'&&/--$/.test(fc[lc-1]))break;if(lc<oc){if(ec.comment){var tc=fc.slice(nc,lc).join('');ec.comment(tc.substr(0,tc.length-2),ic,gb,ib(ec,fc,lc+1,hc,ic));}nc=lc+1;}else hc.noMoreEndComments=true;}if(hc.noMoreEndComments)if(ec.pcdata)ec.pcdata('&lt;!--',ic,gb,ib(ec,fc,nc,hc,ic));break;case '<\!':if(!/^\w/.test(qc)){if(ec.pcdata)ec.pcdata('&lt;!',ic,gb,ib(ec,fc,nc,hc,ic));}else{if(!hc.noMoreGT){for(lc=nc+1;lc<oc;lc++)if(fc[lc]==='>')break;if(lc<oc){nc=lc+1;}else hc.noMoreGT=true;}if(hc.noMoreGT)if(ec.pcdata)ec.pcdata('&lt;!',ic,gb,ib(ec,fc,nc,hc,ic));}break;case '<?':if(!hc.noMoreGT){for(lc=nc+1;lc<oc;lc++)if(fc[lc]==='>')break;if(lc<oc){nc=lc+1;}else hc.noMoreGT=true;}if(hc.noMoreGT)if(ec.pcdata)ec.pcdata('&lt;?',ic,gb,ib(ec,fc,nc,hc,ic));break;case '>':if(ec.pcdata)ec.pcdata("&gt;",ic,gb,ib(ec,fc,nc,hc,ic));break;case '':break;default:if(ec.pcdata)ec.pcdata(pc,ic,gb,ib(ec,fc,nc,hc,ic));break;}}if(ec.endDoc)ec.endDoc(ic);}catch(jc){if(jc!==gb)throw jc;}}function kb(ec){var fc=/(<\/|<\!--|<[!?]|[&<>])/g;ec+='';if(db){return ec.split(fc);}else{var gc=[],hc=0,ic;while((ic=fc.exec(ec))!==null){gc.push(ec.substring(hc,ic.index));gc.push(ic[0]);hc=ic.index+ic[0].length;}gc.push(ec.substring(hc));return gc;}}function lb(ec,fc,gc,hc,ic,jc){var kc=pb(ec,fc);if(!kc)return ec.length;if(gc.endTag)gc.endTag(kc.name,hc,ic,ib(gc,ec,fc,jc,hc));return kc.next;}function mb(ec,fc,gc,hc,ic,jc){var kc=pb(ec,fc);if(!kc)return ec.length;if(gc.startTag)gc.startTag(kc.name,kc.attrs,hc,ic,ib(gc,ec,kc.next,jc,hc));if(kc.eflags&eb){return ob(ec,kc,gc,hc,ic,jc);}else return kc.next;}var nb={};function ob(ec,fc,gc,hc,ic,jc){var kc=ec.length;if(!nb.hasOwnProperty(fc.name))nb[fc.name]=new RegExp('^'+fc.name+'(?:[\\s\\/]|$)','i');var lc=nb[fc.name],mc=fc.next,nc=fc.next+1;for(;nc<kc;nc++)if(ec[nc-1]==='<\/'&&lc.test(ec[nc]))break;if(nc<kc)nc-=1;var oc=ec.slice(mc,nc).join('');if(fc.eflags&fa.eflags.CDATA){if(gc.cdata)gc.cdata(oc,hc,ic,ib(gc,ec,nc,jc,hc));}else if(fc.eflags&fa.eflags.RCDATA){if(gc.rcdata)gc.rcdata(bb(oc),hc,ic,ib(gc,ec,nc,jc,hc));}else throw new Error('bug');return nc;}function pb(ec,fc){var gc=/^([-\w:]+)/.exec(ec[fc]),hc={};hc.name=gc[1].toLowerCase();hc.eflags=fa.ELEMENTS[hc.name];var ic=ec[fc].substr(gc[0].length),jc=fc+1,kc=ec.length;for(;jc<kc;jc++){if(ec[jc]==='>')break;ic+=ec[jc];}if(kc<=jc)return void 0;var lc=[];while(ic!==''){gc=cb.exec(ic);if(!gc){ic=ic.replace(/^[\s\S][^a-z\s]*/,'');}else if((gc[4]&&!gc[5])||(gc[6]&&!gc[7])){var mc=gc[4]||gc[6],nc=false,oc=[ic,ec[jc++]];for(;jc<kc;jc++){if(nc){if(ec[jc]==='>')break;}else if(0<=ec[jc].indexOf(mc))nc=true;oc.push(ec[jc]);}if(kc<=jc)break;ic=oc.join('');continue;}else{var pc=gc[1].toLowerCase(),qc=gc[2]?qb(gc[3]):'';lc.push(pc,qc);ic=ic.substr(gc[0].length);}}hc.attrs=lc;hc.next=jc+1;return hc;}function qb(ec){var fc=ec.charCodeAt(0);if(fc===34||fc===39)ec=ec.substr(1,ec.length-2);return ua(ra(ec));}function rb(ec){var fc,gc,hc=function(ic,jc){if(!gc)jc.push(ic);};return fb({startDoc:function(ic){fc=[];gc=false;},startTag:function(ic,jc,kc){if(gc)return;if(!fa.ELEMENTS.hasOwnProperty(ic))return;var lc=fa.ELEMENTS[ic];if(lc&fa.eflags.FOLDABLE)return;var mc=ec(ic,jc);if(!mc){gc=!(lc&fa.eflags.EMPTY);return;}else if(typeof mc!=='object')throw new Error('tagPolicy did not return object (old API?)');if('attribs' in mc){jc=mc.attribs;}else throw new Error('tagPolicy gave no attribs');var nc,oc;if('tagName' in mc){oc=mc.tagName;nc=fa.ELEMENTS[oc];}else{oc=ic;nc=lc;}if(lc&fa.eflags.OPTIONAL_ENDTAG){var pc=fc[fc.length-1];if(pc&&pc.orig===ic&&(pc.rep!==oc||ic!==oc))kc.push('<\/',pc.rep,'>');}if(!(lc&fa.eflags.EMPTY))fc.push({orig:ic,rep:oc});kc.push('<',oc);for(var qc=0,rc=jc.length;qc<rc;qc+=2){var sc=jc[qc],tc=jc[qc+1];if(tc!==null&&tc!==void 0)kc.push(' ',sc,'="',ab(tc),'"');}kc.push('>');if((lc&fa.eflags.EMPTY)&&!(nc&fa.eflags.EMPTY))kc.push('<\/',oc,'>');},endTag:function(ic,jc){if(gc){gc=false;return;}if(!fa.ELEMENTS.hasOwnProperty(ic))return;var kc=fa.ELEMENTS[ic];if(!(kc&(fa.eflags.EMPTY|fa.eflags.FOLDABLE))){var lc;if(kc&fa.eflags.OPTIONAL_ENDTAG){for(lc=fc.length;--lc>=0;){var mc=fc[lc].orig;if(mc===ic)break;if(!(fa.ELEMENTS[mc]&fa.eflags.OPTIONAL_ENDTAG))return;}}else for(lc=fc.length;--lc>=0;)if(fc[lc].orig===ic)break;if(lc<0)return;for(var nc=fc.length;--nc>lc;){var oc=fc[nc].rep;if(!(fa.ELEMENTS[oc]&fa.eflags.OPTIONAL_ENDTAG))jc.push('<\/',oc,'>');}if(lc<fc.length)ic=fc[lc].rep;fc.length=lc;jc.push('<\/',ic,'>');}},pcdata:hc,rcdata:hc,cdata:hc,endDoc:function(ic){for(;fc.length;fc.length--)ic.push('<\/',fc[fc.length-1].rep,'>');}});}var sb=/^(?:https?|mailto)$/i;function tb(ec,fc,gc,hc,ic){if(!ic)return null;try{var kc=t.parse(''+ec);if(kc)if(!kc.hasScheme()||sb.test(kc.getScheme())){var lc=ic(kc,fc,gc,hc);return lc?lc.toString():null;}}catch(jc){return null;}return null;}function ub(ec,fc,gc,hc,ic){if(!gc)ec(fc+" removed",{change:"removed",tagName:fc});if(hc!==ic){var jc="changed";if(hc&&!ic){jc="removed";}else if(!hc&&ic)jc="added";ec(fc+"."+gc+" "+jc,{change:jc,tagName:fc,attribName:gc,oldValue:hc,newValue:ic});}}function vb(ec,fc,gc){var hc;hc=fc+'::'+gc;if(ec.hasOwnProperty(hc))return ec[hc];hc='*::'+gc;if(ec.hasOwnProperty(hc))return ec[hc];return void 0;}function wb(ec,fc){return vb(fa.ATTRIBS,ec,fc);}function xb(ec,fc){return vb(fa.LOADERTYPES,ec,fc);}function yb(ec,fc){return vb(fa.URIEFFECTS,ec,fc);}function zb(ec,fc,gc,hc,ic){for(var jc=0;jc<fc.length;jc+=2){var kc=fc[jc],lc=fc[jc+1],mc=lc,nc=null,oc;if((oc=ec+'::'+kc,fa.ATTRIBS.hasOwnProperty(oc))||(oc='*::'+kc,fa.ATTRIBS.hasOwnProperty(oc)))nc=fa.ATTRIBS[oc];if(nc!==null){switch(nc){case fa.atype.NONE:break;case fa.atype.SCRIPT:lc=null;if(ic)ub(ic,ec,kc,mc,lc);break;case fa.atype.STYLE:if('undefined'===typeof ga){lc=null;if(ic)ub(ic,ec,kc,mc,lc);break;}var pc=[];ga(lc,{declaration:function(qc,rc){var sc=qc.toLowerCase();ha(sc,rc,gc?function(tc){return tb(tc,fa.ueffects.SAME_DOCUMENT,fa.ltypes.SANDBOXED,{TYPE:"CSS",CSS_PROP:sc},gc);}:null);if(rc.length)pc.push(sc+': '+rc.join(' '));}});lc=pc.length>0?pc.join(' ; '):null;if(ic)ub(ic,ec,kc,mc,lc);break;case fa.atype.ID:case fa.atype.IDREF:case fa.atype.IDREFS:case fa.atype.GLOBAL_NAME:case fa.atype.LOCAL_NAME:case fa.atype.CLASSES:lc=hc?hc(lc):lc;if(ic)ub(ic,ec,kc,mc,lc);break;case fa.atype.URI:lc=tb(lc,yb(ec,kc),xb(ec,kc),{TYPE:"MARKUP",XML_ATTR:kc,XML_TAG:ec},gc);if(ic)ub(ic,ec,kc,mc,lc);break;case fa.atype.URI_FRAGMENT:if(lc&&'#'===lc.charAt(0)){lc=lc.substring(1);lc=hc?hc(lc):lc;if(lc!==null&&lc!==void 0)lc='#'+lc;}else lc=null;if(ic)ub(ic,ec,kc,mc,lc);break;default:lc=null;if(ic)ub(ic,ec,kc,mc,lc);break;}}else{lc=null;if(ic)ub(ic,ec,kc,mc,lc);}fc[jc+1]=lc;}return fc;}function ac(ec,fc,gc,hc){return function(ic,jc){var kc=true;if(hc){kc=false;hc.forEach(function(lc){if(ic==lc)kc=true;});}if(!(fa.ELEMENTS[ic]&fa.eflags.UNSAFE)&&kc){return {attribs:zb(ic,jc,ec,fc,gc)};}else if(gc)ub(gc,ic,undefined,undefined,undefined);};}function bc(ec,fc){var gc=[];rb(fc)(ec,gc);return gc.join('');}function cc(ec,fc,gc,hc,ic){var jc=ac(fc,gc,hc,ic);return bc(ec,jc);}var dc={};dc.escapeAttrib=dc.escapeAttrib=ab;dc.makeHtmlSanitizer=dc.makeHtmlSanitizer=rb;dc.makeSaxParser=dc.makeSaxParser=fb;dc.makeTagPolicy=dc.makeTagPolicy=ac;dc.normalizeRCData=dc.normalizeRCData=bb;dc.sanitize=dc.sanitize=cc;dc.sanitizeAttribs=dc.sanitizeAttribs=zb;dc.sanitizeWithPolicy=dc.sanitizeWithPolicy=bc;dc.unescapeEntities=dc.unescapeEntities=ua;return dc;})(ba),ea=da.sanitize;if(typeof window!=='undefined'){window.html=da;window.html_sanitize=ea;}f.exports=da;}),null);
__d('OzTaskComposers.react',['cx','OzHelpers','OzAPI','CajaHTMLSanitizer','CIWebmailValidator','DraftEditor.react','EditorState','ContentState','FileInput.react','immutable','OzNotify','OzActions','OzDateTimePicker.react','OzDraggableModal.react','OzPlaceField.react','promiseFinally','OzImmutablePureRenderMixin','React','Reflux','XUICloseButton.react','XUIError.react'],(function a(b,c,d,e,f,g,h){var i,j,k,l;if(c.__markCompiled)c.__markCompiled();var m=c('CIWebmailValidator').isValidEmail,n=c('immutable').Map,o=c('immutable').List,p=c('immutable').Record,q=c('React').PropTypes,r={intentId:null,id:null,type:null,errors:n(),disabled:false,sending:false},s=['to'],t=['from'],u=['cc'],v=['bcc'],w=['body',0,'body','contents'],x=c('immutable').fromJS([{'content-type':'text/plain; charset=UTF-8',body:{contents:''}}]),y=c('immutable').fromJS({to:'',cc:'',bcc:'',from:'',subject:'',body:x}),z=p(babelHelpers['extends']({},r,{email:y,uploadSem:0})),aa=c('Reflux').createStore({init:function za(){this._offlineId=0;this.data=n();this.listenToMany(c('OzActions').emailComposer);},getInitialState:function za(){return this.data;},onUpdate:function za(ab){this._u(function(bb){return bb.set(ab.get('id'),ab);});},onDelete:function za(ab){this._u(function(bb){return bb['delete'](ab);});},onAdd:function za(){var ab=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],bb=new z(ab).update('id',function(cb){return cb||this._offlineId++;}.bind(this)).updateIn(['email','from'],function(cb){return ab.from||(o.isList(cb)?cb.first():cb);}).update('email',oa);this._u(function(cb){return cb.set(bb.get('id'),bb);});},_u:function za(ab){this.data=ab(this.data);this.trigger(this.data);}}),ba=c('React').createClass({displayName:'EmailContainer',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{emailState:q.instanceOf(z).isRequired},render:function za(){var ab=this.props.emailState;return (c('React').createElement(ca,{email:ab.get('email'),errors:ab.get('errors'),disabled:ab.get('disabled'),sending:ab.get('sending'),onClose:this._handleClose,onChange:this._handleChange,onSend:this._handleSend,onUpload:this._handleUpload,onAttOpen:this._handleAttOpen}));},_handleClose:function za(){c('OzActions').emailComposer['delete'](this.props.emailState.get('id'));},_handleChange:function za(ab){c('OzActions').emailComposer.update(this.props.emailState.set('email',ab));},_handleSend:function za(){var ab=this.props.emailState,bb=ab.get('email'),cb=[[bb.getIn(s),'Please specify a destination email address'],[bb.get('subject'),'Please write a subject'],[bb.getIn(w),'Please write a message'],[ab.get('uploadSem')===0,'Your attachments are still uploading']].find(function(fb){var gb=fb[0],hb=fb[1];return !gb;});if(cb){c('OzNotify').error(cb[1]);return;}var db=pa(bb).set('intent-id',ab.get('intentId')),eb=n({to:s,cc:u,bcc:v}).map(function(fb){return ma(db.getIn(fb));}).filter(function(fb){return fb;});if(!eb.isEmpty()){c('OzActions').emailComposer.update(ab.set('errors',eb));return;}c('OzActions').emailComposer.update(ab.set('sending',true));c('OzAPI').sendEmail(db,ab.get('intentId')).then(function(fb){c('OzActions').emailComposer['delete'](ab.get('id'));})['catch'](function(fb){c('OzActions').emailComposer.update(ab.set('sending',false));});},_handleAttOpen:function za(ab){var bb=ab.getIn(['body','everstore-handle']);c('OzAPI').everstoreURI(bb).done(function(cb){return window.open(cb);});},_handleUpload:function za(ab){var bb=function(db){return c('OzActions').emailComposer.update(this.props.emailState.update('uploadSem',function(eb){return eb+db;}));}.bind(this);bb(1);var cb=c('OzAPI').everstoreUpload(n({blob:ab})).then(function(db){return na(db,ab);}).then(function(db){c('OzActions').emailComposer.update(this.props.emailState.updateIn(['email','body'],function(eb){return eb.push(db);}));}.bind(this));c('promiseFinally')(cb,function(db){return bb(-1);});}});i=babelHelpers.inherits(ca,c('React').Component);j=i&&i.prototype;function ca(za){'use strict';j.constructor.call(this,za);var ab=function bb(cb){return c('EditorState').createWithContent(c('ContentState').createFromText(za.email.getIn(cb)||''));};this.state={showCC:false,showBCC:false,inputEditorStates:{from:ab(t),to:ab(s),cc:ab(u),bcc:ab(v),subject:ab(['subject'])}};}ca.prototype.componentDidMount=function(){'use strict';var za=['to','subject'].find(function(bb){var cb=this.state.inputEditorStates[bb];return cb&&!cb.getCurrentContent().getPlainText().length;}.bind(this)),ab=this.refs[za||'body'];ab&&ab.focus();};ca.prototype.render=function(){var za;'use strict';var ab=this.props,bb=ab.email,cb=ab.errors,db=ab.onClose,eb=ab.onUpload,fb=ab.onAttOpen,gb=ab.onChange,hb=ab.onSend,ib=ab.disabled,jb=ab.sending,kb=this.state.showCC||ib&&bb.getIn(u),lb=this.state.showBCC||ib&&bb.getIn(v),mb=function(pb,qb,rb){return (c('React').createElement(ea,{error:cb.get(qb),editorState:this.state.inputEditorStates[qb],disabled:ib||jb,placeholder:pb,ref:qb,onChange:function(sb){this.setState({inputEditorStates:babelHelpers['extends']({},this.state.inputEditorStates,(za={},za[qb]=sb,za))});var tb=sb.getCurrentContent().getPlainText();gb(bb.setIn(rb,tb));}.bind(this)}));}.bind(this),nb=ja(bb,'text/plain');if(nb==-1)nb=0;var ob=['body',nb,'body','contents'];return (c('React').createElement(c('OzDraggableModal.react'),{className:"_4h1d",getHandle:function(pb){return this.refs.header;}.bind(this)},c('React').createElement('div',null,c('React').createElement('div',{className:"_4h1e",ref:'header'},c('React').createElement(c('XUICloseButton.react'),{onClick:db})),c('React').createElement(ea,{editorState:this.state.inputEditorStates.from,disabled:true,onChange:function pb(qb){return null;}}),c('React').createElement('div',{className:"_1jg2"},mb('To','to',s),!kb&&!(ib||jb)?c('React').createElement('button',{tabIndex:'-1',className:"_1jg3",onClick:function(pb){return this.setState({showCC:true});}.bind(this)},'CC'):null,!lb&&!(ib||jb)?c('React').createElement('button',{tabIndex:'-1',className:"_1jg3",onClick:function(pb){return this.setState({showBCC:true});}.bind(this)},'BCC'):null),kb?mb('Cc','cc',u):null,lb?mb('Bcc','bcc',v):null,mb('Subject','subject',['subject']),ib?c('React').createElement(da,{email:bb}):c('React').createElement('textarea',{disabled:ib||jb,placeholder:'Write your masterpiece',ref:'body',className:"_1-i0 _4h1j",value:bb.getIn(ob),onChange:function pb(qb){return gb(bb.setIn(ob,qb.target.value));}}),c('React').createElement(ga,{email:bb,onChange:gb,onAttOpen:fb}),ib?null:c('React').createElement('div',{className:"_5l1v"},c('React').createElement('button',{onClick:hb,disabled:jb,className:"_1-hv _30yy _n8p"},jb?'Sending...':'Send'),c('React').createElement(c('FileInput.react'),{ref:'fileInput',onChange:function(pb){eb(pb.target.files[0]);this.refs.fileInput.getFileInput().clear();}.bind(this)},c('React').createElement('a',{title:'add images',className:"_5l1w _30yy"}))))));};ca.propTypes={onClose:q.func.isRequired,onSend:q.func,disabled:q.bool,sending:q.bool,email:q.instanceOf(n).isRequired,errors:q.instanceOf(n),onChange:q.func.isRequired,onUpload:q.func.isRequired,onAttOpen:q.func.isRequired};var da=c('OzHelpers').pure(function(za){var ab=za.email,bb=ia(ab,'text/html','text/plain'),cb=bb.getIn(['body','contents']);return (c('React').createElement('div',{className:"_3x40"},la(bb)?c('React').createElement('div',{style:{whiteSpace:'pre-wrap'}},cb):c('React').createElement(fa,{html:cb})));}),ea=c('React').createClass({displayName:'EmailInput',propTypes:{disabled:q.bool,editorState:q.instanceOf(c('EditorState')).isRequired,error:q.string,onChange:q.func,placeholder:q.string},defaultProps:{disabled:false,error:null,onChange:function za(){},placeholder:null},focus:function za(){this.refs.editor.focus();},render:function za(){return (c('React').createElement(c('XUIError.react'),{xuiError:this.props.error,xuiErrorPosition:'left'},c('React').createElement('div',{className:"_1-i0 _4h1i",onClick:this.focus},c('React').createElement(c('DraftEditor.react'),{editorState:this.props.editorState,ref:'editor',onChange:this.props.onChange,placeholder:this.props.placeholder,readOnly:this.props.disabled}))));}}),fa=c('OzHelpers').pure(function(za){var ab=za.html,bb=babelHelpers.objectWithoutProperties(za,['html']);return (c('React').createElement('div',babelHelpers['extends']({},bb,{dangerouslySetInnerHTML:{__html:c('CajaHTMLSanitizer').sanitize(ab,function(cb){return cb;})}})));}),ga=c('OzHelpers').pure(function(za){var ab=za.email,bb=za.onAttOpen,cb=za.onChange,db=ab.get('body').map(function(eb,fb){return ka(eb)?null:c('React').createElement(ha,{key:fb,part:eb,onClick:function gb(hb){return bb(eb);},onRemove:function gb(hb){return cb(ab.update('body',function(ib){return ib['delete'](fb);}));}});}).filter(function(eb){return !!eb;});return db.isEmpty()?null:c('React').createElement('div',{className:"_5l1-"},db);}),ha=c('OzHelpers').pure(function(za){var ab=za.part,bb=za.onClick,cb=za.onRemove;return (c('React').createElement('div',{className:"_5l26"},c('React').createElement('button',{className:"_1-hv",onClick:bb},ab.getIn(['body','filename'])),c('React').createElement(c('XUICloseButton.react'),{onClick:cb})));});function ia(za){for(var ab=arguments.length,bb=Array(ab>1?ab-1:0),cb=1;cb<ab;cb++)bb[cb-1]=arguments[cb];var db=bb.map(function(eb){return ja(za,eb);}).find(function(eb){return eb>-1;});return Number.isSafeInteger(db)?za.getIn(['body',db]):x.first();}function ja(za,ab){return za.get('body').findIndex(function(bb){return bb.get('content-type').indexOf(ab)>-1;});}function ka(za){var ab=za.get('content-type');return (ab&&ab.indexOf('text/plain')>-1||ab.indexOf('text/html')>-1);}function la(za){return za.get('content-type').indexOf('text/plain')>-1;}function ma(za){za=o(za);var ab=za.filterNot(m);return ab.isEmpty()?null:'Invalid email address(es): '+ab.join(', ')+'.';}function na(za,ab){return c('immutable').fromJS({'content-type':ab.type,body:{'everstore-handle':za,filename:ab.name}});}function oa(za){return za.updateIn(s,qa).updateIn(u,qa).updateIn(v,qa);}function pa(za){return za.updateIn(s,ra).updateIn(u,ra).updateIn(v,ra);}function qa(za){return za&&za.join(', ');}function ra(za){return za?za.split(/[, ]/).filter(function(ab){return ab.length;}):[];}var sa=c('immutable').fromJS({title:'',description:'',start:null,startTimezone:'',end:null,endTimezone:'',location:'',to:''}),ta=p(babelHelpers['extends']({},r,{invite:sa})),ua=c('Reflux').createStore({init:function za(){this._offlineId=0;this.data=n();this.listenToMany(c('OzActions').inviteComposer);},getInitialState:function za(){return this.data;},onUpdate:function za(ab){this._u(function(bb){return bb.set(ab.get('id'),ab);});},onDelete:function za(ab){this._u(function(bb){return bb['delete'](ab);});},onAdd:function za(){var ab=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],bb=new ta(ab).update('id',function(cb){return cb||this._offlineId++;}.bind(this)).updateIn(['invite','to'],qa);this._u(function(cb){return cb.set(bb.get('id'),bb);});},onCreate:function za(ab,bb,cb){var db=new ta({intentId:ab,invite:xa(bb,cb),id:this._offlineId++});this._u(function(eb){return eb.set(db.get('id'),db);});},_u:function za(ab){this.data=ab(this.data);this.trigger(this.data);}}),va=c('React').createClass({displayName:'InviteContainer',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{inviteState:q.instanceOf(ta).isRequired},render:function za(){var ab=this.props.inviteState;return (c('React').createElement(wa,{disabled:ab.get('disabled'),sending:ab.get('sending'),initialTimezone:ab.get('timezone'),invite:ab.get('invite'),errors:ab.get('errors'),onChange:this._handleChange,onClose:this._handleClose,onSend:this._handleSend}));},_handleChange:function za(ab){c('OzActions').inviteComposer.update(this.props.inviteState.set('invite',ab));},_handleClose:function za(){c('OzActions').inviteComposer['delete'](this.props.inviteState.get('id'));},_handleSend:function za(){var ab=this.props.inviteState,bb=ab.get('invite'),cb=bb.get('selectedPlace'),db=[[bb.get('to')||cb,'Please click on a location in the dropdown or enter an email address'],[bb.get('title'),'Please choose a title'],[bb.get('start'),'Please select a start time'],[bb.get('end'),'Please select an end time'],[bb.get('end')>=bb.get('start'),'Event must start before it ends']].find(function(gb){var hb=gb[0],ib=gb[1];return !hb;});if(db){c('OzNotify').error(db[1]);return;}var eb=cb?bb['delete']('selectedPlace').set('intent-id',ab.get('intentId'))['delete']('to')['delete']('description').set('place-id',cb.get('id')):bb['delete']('selectedPlace').set('intent-id',ab.get('intentId')).update('to',ra),fb=n({to:'to'}).map(function(gb){return ma(eb.get(gb));}).filter(function(gb){return gb;});if(!fb.isEmpty()){c('OzActions').inviteComposer.update(ab.set('errors',fb));return;}c('OzActions').inviteComposer.update(ab.set('sending',true));c('OzAPI').sendInvite(eb,ab.get('intentId')).then(function(gb){c('OzActions').inviteComposer['delete'](ab.get('id'));})['catch'](function(gb){c('OzActions').inviteComposer.update(ab.set('sending',false));});}});k=babelHelpers.inherits(wa,c('React').Component);l=k&&k.prototype;wa.prototype.componentDidMount=function(){'use strict';var za=['title','description','location','to'].map(function(ab){return this.refs[ab];}.bind(this)).find(function(ab){return ab&&!ab.value;});za&&za.focus();};wa.prototype.render=function(){'use strict';var za=this.props,ab=za.disabled,bb=za.sending,cb=za.invite,db=za.errors,eb=za.onClose,fb=za.onChange,gb=za.onSend,hb=function lb(mb,nb){return (c('React').createElement(c('XUIError.react'),{xuiError:db.get(nb),xuiErrorPosition:'left'},c('React').createElement('input',{type:'text',className:"_1-i0 _4h1i",disabled:ab||bb,placeholder:mb,ref:nb,value:cb.get(nb),onChange:function ob(pb){return fb(cb.set(nb,pb.target.value));}})));},ib=function lb(mb,nb){return (c('React').createElement('div',null,mb+':',c('React').createElement(c('OzDateTimePicker.react'),babelHelpers['extends']({className:"_pto",layout:'two-line',timestamp:cb.get(nb)||c('OzHelpers').serverNow(),timezone:cb.get(nb+'Timezone'),disabled:ab||bb,onChange:function ob(pb){var qb=pb.timestamp,rb=pb.timezone;return fb(cb.set(nb,+qb).set(nb+'Timezone',rb));}},c('OzHelpers').dateRestraints()))));},jb=function lb(mb,nb,ob){return (c('React').createElement(c('OzPlaceField.react'),{className:"_1-i0 _n8q",disabled:ab||bb,onQueryStringChange:function pb(qb){fb(cb['delete'](ob).set(nb,qb));},onSelect:function pb(qb){fb(cb.set(ob,qb).set(nb,qb.get('name')));},placeholder:mb,queryString:cb.get(nb),selectedEntry:cb.get(ob),xuiError:db.get(nb)||db.get(ob)}));},kb=!!cb.get('selectedPlace')||!!cb.get('place-id');return (c('React').createElement(c('OzDraggableModal.react'),{className:"_ptp"},c('React').createElement('div',{className:"_ptq"},'Calendar Invite',c('React').createElement(c('XUICloseButton.react'),{onClick:eb})),hb('Title','title'),kb||hb('Description','description'),jb('Location...','location','selectedPlace'),kb||hb('Email to...','to'),ib('Start Time','start'),ib('End Time','end'),ab?null:c('React').createElement('div',{className:"_5l1v"},c('React').createElement('button',{onClick:gb,disabled:bb,className:"_1-hv _30yy _n8p"},bb?'Sending...':kb?'Send Bubble':'Send Email'))));};function wa(){'use strict';k.apply(this,arguments);}wa.propTypes={invite:q.instanceOf(n).isRequired,errors:q.instanceOf(n),onClose:q.func.isRequired,onChange:q.func.isRequired,onSend:q.func.isRequired,disabled:q.bool,sending:q.bool};function xa(){var za=arguments.length<=0||arguments[0]===undefined?'':arguments[0],ab=arguments.length<=1||arguments[1]===undefined?'':arguments[1];return sa.set('start',c('OzHelpers').serverNow()).set('startTimezone',ab).set('end',c('OzHelpers').serverNow()).set('endTimezone',ab).set('to',za);}var ya=c('React').createClass({displayName:'OzTaskComposers',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(aa,'emails'),c('Reflux').connect(ua,'invites')],propTypes:{intent:q.instanceOf(n).isRequired},render:function za(){var ab=function(db){return db.get('intentId')==this.props.intent.get('id');}.bind(this),bb=this.state.emails.filter(ab),cb=this.state.invites.filter(ab);return (c('React').createElement('span',null,bb.map(function(db){return c('React').createElement(ba,{key:db.get('id'),emailState:db});}).valueSeq(),cb.map(function(db){return c('React').createElement(va,{key:db.get('id'),inviteState:db});}).valueSeq()));}});f.exports=ya;}),null);
__d('OzTaskActionEditor.react',['cx','OzHelpers','immutable','InputLabel.react','MessengerButton.react','OzImmutablePureRenderMixin','React','XUIError.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('React').PropTypes,k=c('immutable').fromJS({traffic:{label:'Include traffic update',params:[{name:'origin',placeholder:'Origin address',err:'What is the origin address?'},{name:'destination',placeholder:'Destination address',err:'What is the destination address?'}]},weather:{label:'Include weather forecast',params:[{name:'location',placeholder:'City',err:'What city is the forecast for?'},{name:'metric',placeholder:'Celsius or Fahrenheit',err:'You need to set Celsius or Fahrenheit'}]}}),l=c('OzHelpers').pure(function(n){var o=n.action,p=n.errors,q=n.onToggle,r=n.onUpdate,s=n.actions,t=!!s.get(o);return (c('React').createElement('div',null,c('React').createElement(c('InputLabel.react'),null,c('React').createElement('input',{type:'checkbox',checked:t,onChange:function u(v){return q(v,o);}}),c('React').createElement('label',null,k.getIn([o,'label']))),t&&c('React').createElement('div',null,k.getIn([o,'params']).map(function(u){var v=u.get('name'),w=[o,v],x=s.getIn(w);return (c('React').createElement(c('XUIError.react'),{key:o+'-'+v,xuiError:p.getIn([o,v])},c('React').createElement('input',{type:u.get('type','text'),className:"_wbw",placeholder:u.get('placeholder'),value:x,onChange:function y(z){return r(z,w);}})));}).valueSeq())));}),m=c('React').createClass({displayName:'OzTaskActionEditor',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{task:j.instanceOf(i).isRequired,onSelectAction:j.func.isRequired},getInitialState:function n(){return {errors:i(),actions:this.props.task.getIn(['data','actions'],i())};},render:function n(){return (c('React').createElement('div',{className:"_3zsp"},k.keySeq().map(function(o){return (c('React').createElement(l,{key:o,action:o,actions:this.state.actions,errors:this.state.errors,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate}));}.bind(this)).valueSeq(),c('React').createElement(c('MessengerButton.react'),{onClick:this._handleSaveActions,label:'Set Actions',type:'primary'})));},_handleActionToggle:function n(o,p){var q=o.target.checked?i([[p,i()]]):i();this.setState({actions:q});},_handleActionUpdate:function n(o,p){this.setState({actions:this.state.actions.setIn(p,o.target.value)});},_handleSaveActions:function n(){var o=this.props.onSelectAction,p=this.state.actions,q=this._findErrors();if(q.count()){this.setState({errors:q});}else o(p);},_findErrors:function n(){var o=this.state.actions,p=function q(r){return !!o.get(r);};return k.reduce(function(q,r,s){if(p(s))q=r.get('params').reduce(function(t,u){return o.getIn([s,u.get('name')])?t:t.setIn([s,u.get('name')],u.get('err'));},q);return q;},i());}});f.exports=m;}),null);
__d('OzTaskShow.react',['cx','debounce','getActiveElement','OzHelpers','immutable','InputLabel.react','Keys','LayerHideOnBlur','MessengerButton.react','OzNotify','OzActions','OzConfirmDialog.react','OzDate.react','OzDateTimePicker.react','OzTaskActionEditor.react','OzImmutablePureRenderMixin','React','XUIContextualDialog.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('immutable').List,k=c('immutable').Set,l=c('React').PropTypes,m=1000,n=c('React').createClass({displayName:'OzTaskShow',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{location:l.instanceOf(i).isRequired,onCancel:l.func.isRequired,onComplete:l.func.isRequired,onOpen:l.func.isRequired,onSave:l.func.isRequired,task:l.instanceOf(i).isRequired},render:function w(){var x=this.props,y=x.task,z=x.location,aa=x.onCancel,ba=x.onComplete,ca=x.onOpen;return (c('React').createElement('div',{className:"_1h7p"},c('React').createElement('div',{className:"_1h7q"}),c('React').createElement(o,{task:y,onChangeDescription:this._handleChangeDescription}),c('React').createElement(v,{task:y,onChangeNotes:this._handleChangeNotes}),c('React').createElement(q,{task:y,location:z,onSelectDeadline:this._handleSelectDeadline}),c('React').createElement(r,{task:y,onChangeDuration:this._handleChangeDuration}),c('React').createElement(u,{task:y,onChangeActions:this._handleChangeActions}),c('React').createElement(t,{task:y,onChangeRecur:this._handleChangeRecur}),c('React').createElement(p,{task:y,onCancelTask:aa,onOpenTask:ca,onCompleteTask:ba})));},_handleChangeDescription:function w(x){var y=this.props,z=y.onSave,aa=y.task;z(aa.setIn(['data','description'],x));},_handleSelectDeadline:function w(x){var y=this.props,z=y.onSave,aa=y.task,ba=x-aa.get('deadline');z(aa.set('deadline',x).update('start-at',function(ca){return ca+ba;}));},_handleChangeDuration:function w(x){var y=this.props,z=y.onSave,aa=y.task;if(x<0){c('OzNotify').warn('Duration must be greater than 0');}else z(aa.set('start-at',aa.get('deadline')-x*60000));},_handleChangeRecur:function w(x){var y=this.props,z=y.onSave,aa=y.task,ba=y.location;z(aa.set('schedule',i({'start-at':aa.get('start-at'),frequency:'weekly',timezone:ba.get('timezone'),'timezone-offset':ba.get('timezone-offset'),'repeat-condition':i({spacing:1,days:x.toList()})})));},_handleChangeActions:function w(x){var y=this.props,z=y.onSave,aa=y.task;z(aa.setIn(['data','actions'],x));},_handleChangeNotes:function w(x){var y=this.props,z=y.onSave,aa=y.task;z(aa.setIn(['data','notes'],x));}}),o=c('React').createClass({displayName:'OzTaskShowDescription',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onChangeDescription:l.func.isRequired,task:l.instanceOf(i).isRequired},componentDidMount:function w(){if(!this.props.task.getIn(['data','description']))this.setState({editing:true});},getInitialState:function w(){return {editing:false};},render:function w(){var x=this.props.task,y=(x.get('state')==='completed'?'[Closed] ':'')+(x.getIn(['data','description'],'').length?x.getIn(['data','description']):'untitled task');return (c('React').createElement('div',{className:"_1h7v _p44"},this.state.editing?c('React').createElement('textarea',{className:"_1h7r _1h7s",placeholder:'untitled task',defaultValue:x.getIn(['data','description']),onBlur:function(z){return this.setState({editing:false});}.bind(this),onKeyDown:this._handleKeydown,ref:function z(aa){if(aa){aa.focus();c('OzHelpers').moveCursorToInputEnd(aa);}}}):c('React').createElement('span',{onClick:function(z){return this.setState({editing:true});}.bind(this),className:"_1h7r"},y)));},_handleKeydown:function w(x){var y=this.props.onChangeDescription;switch(x.which){case c('Keys').RETURN:case c('Keys').TAB:y(x.target.value);case c('Keys').ESC:this.setState({editing:false});}}}),p=c('React').createClass({displayName:'OzTaskShowStateSelector',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onCancelTask:l.func.isRequired,onCompleteTask:l.func.isRequired,onOpenTask:l.func.isRequired,task:l.instanceOf(i).isRequired},_maybeConfirmCancel:function w(){var x=this.props,y=x.task,z=x.onCancelTask;if(y.has('schedule')){c('OzActions').showDialog(c('OzConfirmDialog.react'),{onConfirm:function aa(ba){return z(y,true);},onCancel:function aa(ba){return z(y,false);},body:'This is a recurring task. Do you want to delete just '+'this instance or all future occurrences also?',header:'Delete Recurring Task',confirmLabel:'Delete Future Tasks',cancelLabel:'Only This One'});}else z(y,false);},render:function w(){var x=this.props,y=x.onCancelTask,z=x.onCompleteTask,aa=x.onOpenTask,ba=x.task;return (c('React').createElement('div',{className:"_1h7t"},c('React').createElement('div',{className:"_47xm",onClick:this._maybeConfirmCancel},'Delete'),ba.get('state')==='completed'?c('React').createElement('div',{className:"_47yc",onClick:function ca(da){return aa(ba);}},'Reopen task'):c('React').createElement('div',{className:"_47yd",onClick:function ca(da){return z(ba);}},'Mark complete')));}}),q=c('React').createClass({displayName:'OzTaskShowDeadlineSelector',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onSelectDeadline:l.func.isRequired,location:l.instanceOf(i).isRequired,task:l.instanceOf(i).isRequired},getInitialState:function w(){return {editing:false};},render:function w(){var x=this.props,y=x.task,z=x.location;return (c('React').createElement('div',{className:"_1h7v"},c('React').createElement('div',{className:"_1h7w"},'Due'),c('React').createElement('div',{className:"_1h7y"},this.state.editing?c('React').createElement('div',{className:"_1h7z"},c('React').createElement(c('OzDateTimePicker.react'),{className:"_1xh-",layout:'three-line',showTimezoneName:false,timestamp:this.state.timestamp||Date.now(),timezone:this.state.timezone||z.get('timezone'),onChange:function(aa){return this.setState(aa);}.bind(this)}),c('React').createElement('div',{className:"_1xh_"},c('React').createElement('div',{className:"_1h7-",onClick:this._handleSelectDeadline},'✓'),c('React').createElement('div',{className:"_1h7_",onClick:this._handleCancel},'✕'))):c('React').createElement('div',{className:"_1h80",onClick:this._handleStartEditing},c('React').createElement(c('OzDate.react'),{timestamp:y.get('deadline')})))));},_handleSelectDeadline:function w(){this.props.onSelectDeadline(this.state.timestamp);this.setState({editing:false});},_handleStartEditing:function w(){this.setState({editing:true,timestamp:this.props.task.get('deadline')});},_handleCancel:function w(){this.setState({editing:false});}}),r=c('React').createClass({displayName:'OzTaskShowDuration',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onChangeDuration:l.func.isRequired,task:l.instanceOf(i).isRequired},getInitialState:function w(){return {editing:false};},render:function w(){return (c('React').createElement('div',{className:"_1h7v"},c('React').createElement('div',{className:"_1h7w"},'Duration (min)'),c('React').createElement('div',{className:"_1h7y"},this.state.editing?c('React').createElement('textarea',{className:"_1h81 _1h7s",defaultValue:this._getDuration(),onBlur:function(x){return this.setState({editing:false});}.bind(this),onKeyDown:this._handleKeydown,ref:function x(y){if(y){y.focus();c('OzHelpers').moveCursorToInputEnd(y);}}}):c('React').createElement('span',{onClick:function(x){return this.setState({editing:true});}.bind(this),className:"_1h81"},this._getDuration()))));},_getDuration:function w(){var x=this.props.task;return Math.round((x.get('deadline')-x.get('start-at'))/60000);},_handleKeydown:function w(x){var y=this.props.onChangeDuration;if(x.which===c('Keys').RETURN){y(x.target.value);this.setState({editing:false});}}}),s=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],t=c('React').createClass({displayName:'OzTaskShowRecurSelector',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onChangeRecur:l.func.isRequired,task:l.instanceOf(i).isRequired},getInitialState:function w(){return {editing:false,daysSet:k()};},componentWillMount:function w(){var x=this.props.task;this.setState({daysSet:k(x.getIn(['schedule','repeat-condition','days']))});},render:function w(){var x=this.props.task,y=this.state,z=y.editing,aa=y.daysSet,ba=x.getIn(['schedule','repeat-condition','days'],j()).map(function(ca){return s[ca-1];}).join(', ');return (c('React').createElement('div',{className:"_1h7v"},c('React').createElement('div',{className:"_1h7w"},'Recurrence'),c('React').createElement('div',{className:"_1h7y"},c('React').createElement('span',{onClick:function(ca){return this.setState({editing:true});}.bind(this),ref:'setSpan'},ba.length?ba:'Set Recurrence...'),c('React').createElement(c('XUIContextualDialog.react'),{position:'above',contextRef:function(ca){return this.refs.setSpan;}.bind(this),className:"_3zsp",shown:z,onToggle:function(ca){return this.setState({editing:ca});}.bind(this),behaviors:{LayerHideOnBlur:c('LayerHideOnBlur')}},c('React').createElement('div',{className:"_3zsp"},s.map(function(ca,da){var ea=da+1;return (c('React').createElement(c('InputLabel.react'),{key:da},c('React').createElement('input',{type:'checkbox',checked:aa.has(ea),onChange:function(fa){var ga=fa.target.checked?aa.add(ea):aa['delete'](ea);this.setState({daysSet:ga});}.bind(this)}),c('React').createElement('label',null,ca)));}.bind(this)),c('React').createElement(c('MessengerButton.react'),{onClick:this._handleChangeRecur,label:'Set Recurrence',type:'primary'}))))));},_handleChangeRecur:function w(){this.props.onChangeRecur(this.state.daysSet);this.setState({editing:false});}}),u=c('React').createClass({displayName:'OzTaskShowActionSelector',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onChangeActions:l.func.isRequired,task:l.instanceOf(i).isRequired},getInitialState:function w(){return {editing:false};},render:function w(){var x=this.props.task,y=this.state.editing,z=x.getIn(['data','actions'],i()).keySeq().join(', ');return (c('React').createElement('div',{className:"_1h7v"},c('React').createElement('div',{className:"_1h7w"},'Actions'),c('React').createElement('div',{className:"_1h7y"},c('React').createElement('span',{onClick:function(aa){return this.setState({editing:true});}.bind(this),ref:'setSpan'},z.length?z:'Set Actions...'),c('React').createElement(c('XUIContextualDialog.react'),{position:'above',contextRef:function(aa){return this.refs.setSpan;}.bind(this),className:"_3zsp",shown:y,onToggle:function(aa){return this.setState({editing:aa});}.bind(this),behaviors:{LayerHideOnBlur:c('LayerHideOnBlur')}},c('React').createElement(c('OzTaskActionEditor.react'),{task:x,onSelectAction:this._handleSelectAction})))));},_handleSelectAction:function w(x){this.props.onChangeActions(x);this.setState({editing:false});}}),v=c('React').createClass({displayName:'OzTaskShowNotes',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onChangeNotes:l.func.isRequired,task:l.instanceOf(i).isRequired},getInitialState:function w(){return {editedText:this.props.task.getIn(['data','notes'],'')};},componentWillReceiveProps:function w(x){var y=x.task.get(['data','notes']),z=c('getActiveElement')()===this.refs.textarea;if(y!==this.props.task.get(['data','notes'])&&!z)this.setState({editedText:y});},componentWillMount:function w(){this._save=c('debounce')(this._save,m,this,true);},render:function w(){return (c('React').createElement('div',{className:"_1h7v"},c('React').createElement('textarea',{className:"_1h83 _1h7s",placeholder:'Add a note...',ref:'textarea',value:this.state.editedText,onChange:this._handleChange})));},_handleChange:function w(){var x=this.refs.textarea.value;this.setState({editedText:x},this._save);},_save:function w(){this.props.onChangeNotes(this.state.editedText);}});f.exports=n;}),null);
__d('OzCalendarEvent.react',['cx','Image.react','LineClamp.react','React','Tooltip','formatDate','joinClasses'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l="_2erb",m=60000;i=babelHelpers.inherits(n,c('React').Component);j=i&&i.prototype;function n(){var o,p;'use strict';for(var q=arguments.length,r=Array(q),s=0;s<q;s++)r[s]=arguments[s];return o=(p=j.constructor).call.apply(p,[this].concat(r)),this.state={mouseDown:false},this.$OzCalendarEvent1=function(t,u){return {backgroundColor:'rgb(1, 136, 245)',backgroundImage:'repeating-linear-gradient(-45deg,'+'rgba(70, 130, 200, 0.8),rgba(70, 130, 200, 0.8) 10px,'+'rgba(70, 130, 200, 0.5) 10px,rgba(70, 130, 200, 0.5) 20px)'};},this.$OzCalendarEvent2=function(){this.setState({mouseDown:true});}.bind(this),this.$OzCalendarEvent3=function(){this.setState({mouseDown:false});}.bind(this),this.$OzCalendarEvent4=function(){var t=this.props;return function(u){if(this.state.mouseDown){if(this.props.onInitiateDrag&&this.props.draggable)this.props.onInitiateDrag(t,u);this.setState({mouseDown:false});}}.bind(this);}.bind(this),this.$OzCalendarEvent5=function(){if(!this.props.animation)return null;return (c('React').createElement('div',{className:"_2ere",style:this.$OzCalendarEvent1(this.props.shade,this.props.tentative)}));}.bind(this),o;}n.prototype.render=function(){'use strict';var o=Math.floor((this.props.height-12)/14)-1,p=Math.max(0,this.props.endTime-this.props.startTime),q=Math.round(p/m),r=q<15,s=q===15,t="_2erb"+(this.props.selected?' '+"_2erf":'')+(this.props.tentative?' '+"_2erg":'')+(s?' '+"_2erh":'')+(r?' '+"_2erk":''),u=[];if(this.props.icons)for(var v=0;v<this.props.icons.length;v++){var w=this.props.icons[v],x=w[0],y=w[1],z=c('React').createElement(c('Image.react'),{className:"_2erl",src:x,key:v,'aria-label':y,'data-hover':'tooltip','data-tooltip-content':y});u.push(z);}var aa=c('React').createElement('div',null,u),ba=null,ca=null;if(this.props.showTime){var da=null,ea=null;if(!this.props.isAllDayEvent){da=c('formatDate')(new Date(this.props.startTime),'g:ia');ea='-'+c('formatDate')(new Date(this.props.endTime),'g:ia');}else da='All day';ca=da+ea;ba=c('React').createElement('span',{className:"_2erm"},da);}var fa=ca+'\n'+this.props.title+'\n'+this.props.location,ga=null;if(o>0)ga=c('React').createElement(c('LineClamp.react'),{disableNative:true,lineHeight:14,className:"_2ero",lines:o},this.props.subTitle);var ha=this.props.draggable?{onMouseDown:this.$OzCalendarEvent2,onMouseUp:this.$OzCalendarEvent3,onMouseMove:this.$OzCalendarEvent4()}:{},ia=this.props.hasOutline?"_2ers":'';return (c('React').createElement('div',babelHelpers['extends']({},this.props,ha,{className:c('joinClasses')("_2ert",ia),title:'',onClick:this.props.onEventClicked}),this.$OzCalendarEvent5(),c('React').createElement('div',{className:c('joinClasses')(this.props.className,t),style:this.$OzCalendarEvent1(this.props.shade,this.props.tentative)},aa,c('React').createElement('div',{className:"_2eru"},c('React').createElement('span',babelHelpers['extends']({className:"_2erv"+(r?' '+"_2erw":'')},c('Tooltip').propsFor(this.props.hasTooltip?fa:null)),ba,this.props.title),ga))));};n.propTypes={startTime:k.number.isRequired,endTime:k.number.isRequired,title:k.oneOfType([k.string,k.object]),location:k.string,shade:k.string.isRequired,icons:k.array,hasOutline:k.bool,hasTooltip:k.bool,height:k.number.isRequired,selected:k.bool.isRequired,tentative:k.bool,onEventClicked:k.func.isRequired,onInitiateDrag:k.func,draggable:k.bool,subTitle:k.oneOfType([k.string,k.object]),isAllDayEvent:k.bool,showTime:k.bool};n.defaultProps={showTime:true,draggable:false};n.EVENT_CLASS_NAME=l;f.exports=n;}),null);
__d('OzCalendarUtils',['DateConsts','immutable'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=c('DateConsts').MIN_PER_HOUR*c('DateConsts').SEC_PER_MIN*c('DateConsts').MS_PER_SEC,i=c('DateConsts').HOUR_PER_DAY*h,j=7;function k(y,z){return q(y).toDateString()===q(z).toDateString();}function l(y,z){var aa=new Date(y);aa.setDate(aa.getDate()+z);return aa.getTime();}function m(y,z){var aa=new Date(y),ba=new Date(z),ca=Date.UTC(aa.getFullYear(),aa.getMonth(),aa.getDate()),da=Date.UTC(ba.getFullYear(),ba.getMonth(),ba.getDate());return Math.floor((da-ca)/i);}function n(y){var z=arguments.length<=1||arguments[1]===undefined?1:arguments[1];if(z===null)z=1;var aa=new Date(y);aa.setHours(0);aa.setMinutes(0);aa.setSeconds(0);aa.setMilliseconds(0);var ba=aa.getDay()-z;if(ba<0)ba+=7;return l(aa.getTime(),-ba);}function o(y){var z=arguments.length<=1||arguments[1]===undefined?1:arguments[1];return new Date(n(y.getTime(),z));}function p(y,z){return n(y.getTime())===n(z.getTime());}function q(y){var z=new Date(y),aa=new Date(z.getFullYear(),z.getMonth(),z.getDate());return aa;}function r(y,z){var aa=new Date(y);aa.setDate(aa.getDate()+z);return aa;}function s(y,z){var aa=arguments.length<=2||arguments[2]===undefined?1:arguments[2],ba=[],ca=0,da=new Date(n(y,aa));do{var ea=r(da,ca),fa=r(da,ca+7);ba.push(ea);ca+=7;}while(fa.getTime()<z);return ba;}function t(y,z){var aa=[],ba=0;if(y>z)return aa;do{var ca=r(y,ba),da=r(y,ba+1);aa.push(ca);ba+=1;}while(da.getTime()<=z);return aa;}function u(event){return x.datesFrameToDays(x.timestampToDateOnly(event.props.startTime),x.timestampToDateOnly(event.props.endTime));}function v(event,y,z){var aa=q(event.props.startTime),ba=q(event.props.endTime),ca=q(y),da=l(q(z).getTime(),1);return x.datesFrameToDays(new Date(Math.max(aa,ca)),new Date(Math.min(ba,da)));}function w(y,z,aa){var ba=c('immutable').Map(),ca=c('immutable').Map();y.concat().sort(function(da,ea){return da.props.startTime-ea.props.startTime;}).forEach(function(event){var da=c('immutable').List(v(event,z,aa)),ea=0;while(true){var fa=da.every(function(ga){return (!ba.get(ga,c('immutable').Set()).has(ea));});if(fa){ca=ca.set(event.key,ea);ba=da.reduce(function(ga,ha){return ga.update(ha,c('immutable').Set(),function(ia){return ia.add(ea);});},ba);break;}ea++;}});return ca;}var x={MS_IN_HOUR:h,DAY_IN_WEEK:j,datesEqual:k,compareWeeks:p,datesFrameToDays:t,timeFrameToWeeks:s,getWeekStartDate:o,addDaysToTimestamp:l,getDayDifference:m,getWeekStartTimestamp:n,timestampToDateOnly:q,getShiftedDate:r,slotsByEventKey:w,daysOfEvent:u,daysOfEventInRange:v};f.exports=x;}),null);
__d('OzFlexBox.react',['cx','invariant','DOM','React','joinClasses'],(function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();var l;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;m.prototype.render=function(){'use strict';var p="_4o6j"+(this.props.direction&&m.VERTICAL?' '+"_4o6k":'')+(this.props.direction&&m.REVERSE?' '+"_4o6l":'');return (c('React').createElement('div',babelHelpers['extends']({},this.props,{className:c('joinClasses')(this.props.className,p)}),c('React').Children.map(this.props.children,n,this)));};function m(){'use strict';j.apply(this,arguments);}m.VERTICAL=1;m.REVERSE=2;function n(p){if(!p)return null;var q=this.props.direction&&m.VERTICAL,r=p.props,s=r.boxFlex,t=r.boxSize,u=r.boxMinSize,v=r.boxMaxSize;!!(s&&t)?i(0):void 0;var w={WebkitBoxFlex:s,WebkitFlex:s,MozFlex:s,flex:s,width:q?null:t,height:q?t:null,minWidth:q?null:u,minHeight:q?u:null,maxWidth:q?null:v,maxHeight:q?v:null};return (c('React').createElement('div',{style:w,className:"_4o6m"},p));}function o(){if(l!==undefined)return l;var p=c('DOM').create('div');p.style.display='-webkit-flex';if(p.style.display==='-webkit-flex')return l=false;p.style.display='-moz-flex';if(p.style.display==='-moz-flex')return l=false;p.style.display='flex';if(p.style.display==='flex')return l=false;return l=true;}m.isLolzyFlex=o;f.exports=m;}),null);
__d('OzCalendarMonthly.react',['cx','OzFlexBox.react','DateConsts','DateStrings','OzCalendarUtils','Link.react','React','ReactDOM','ResizeListener','ScrollableArea.react','getElementPosition','joinClasses'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;'use strict';for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return m=(n=j.constructor).call.apply(n,[this].concat(p)),this.state={selectedEventKey:null,currentTime:new Date(),dayHeight:null},this.$OzCalendarMonthly1=null,this.$OzCalendarMonthly2=27,this.$OzCalendarMonthly3=20,this.$OzCalendarMonthly4=22,this.$OzCalendarMonthly5=null,this.getCalendarContentPosition=function(){var r=c('ReactDOM').findDOMNode(this.refs.scrollable);if(r)return c('getElementPosition')(r);return null;}.bind(this),this.$OzCalendarMonthly6=function(){var r=c('getElementPosition')(c('ReactDOM').findDOMNode(this.refs.testCell));return r.height;}.bind(this),this.$OzCalendarMonthly8=function(){var r=this.getCalendarStartDate(),s=c('OzCalendarUtils').getShiftedDate(r,c('DateConsts').DAYS_PER_WEEK*6-1);return {start:r.getTime(),end:s.getTime()};}.bind(this),this.$OzCalendarMonthly7=function(){var r=this.$OzCalendarMonthly8();if(this.props.onFrameChange)this.props.onFrameChange(r.start,r.end);if(this.props.scrollToCurrentTime){var s=this.refs.scrollable.getArea();if(s)s.setScrollTop(this.state.dayHeight*(this.getCurrentDateRow()-1)+1,false);}}.bind(this),this.groupEvents=function(){var r=[],s=c('React').Children.toArray(this.props.children).sort(function(u,v){return u.props.startTime-v.props.startTime;}),t=c('OzCalendarUtils').slotsByEventKey(s,this.getCalendarStartDate(),this.getCalendarEndDate());s.forEach(function(event){var u=c('OzCalendarUtils').daysOfEventInRange(event,this.getCalendarStartDate(),this.getCalendarEndDate());u.forEach(function(v){var w=t.get(event.key);if(!r[v])r[v]=[];r[v][w]=this.cloneOfEventForDay(event,v,w);}.bind(this));}.bind(this));return r;}.bind(this),this.cloneOfEventForDay=function(event,r,s){var t=!c('OzCalendarUtils').datesEqual(event.props.startTime,event.props.endTime),u=c('OzCalendarUtils').datesEqual(r,event.props.startTime)||c('OzCalendarUtils').datesEqual(r,this.getCalendarStartDate()),v=c('OzCalendarUtils').datesEqual(r,event.props.endTime)||c('OzCalendarUtils').datesEqual(r,this.getCalendarEndDate());return c('React').cloneElement(event,{className:(!u&&!v?"_2bg_":'')+(t&&u?' '+"_2bh2":'')+(t&&v?' '+"_2bh3":''),key:event.key,height:24,onEventClicked:function(){return this.setState({selectedEventKey:event.key});}.bind(this),selected:this.state.selectedEventKey===event.key,style:{top:s*this.$OzCalendarMonthly4+this.$OzCalendarMonthly2+'px'}});}.bind(this),this.getCalendarStartDate=function(){var r=new Date(this.props.date.getFullYear(),this.props.date.getMonth(),1);r.setDate(r.getDate()-r.getDay());return r;}.bind(this),this.getCalendarEndDate=function(){var r=new Date(this.props.date.getFullYear(),this.props.date.getMonth(),1);r.setDate(r.getDate()+42);return r;}.bind(this),this.getCurrentDateRow=function(){var r=c('OzCalendarUtils').getDayDifference(this.getCalendarStartDate().getTime(),this.state.currentTime.getTime()),s=Math.floor(r/7);if(s>5)return 0;return s;}.bind(this),this.renderGridLines=function(r,s,t){var u=0,v=5,w=[];for(var x=0;x<=v;x++){u=x*c('DateConsts').DAYS_PER_WEEK+r;var y=c('OzCalendarUtils').getShiftedDate(this.getCalendarStartDate(),u),z=this.props.highlightedDay,aa=(t&&x===0?"_2bh4":'')+(!t&&x===0?' '+"_2bh5":'')+(r===0&&x===v?' '+"_2bh6":'')+(t&&x===v?' '+"_2bh7":'')+(t&&x!==v?' '+"_2bh8":'')+(!t&&x===v?' '+"_2bh9":'')+(r===0?' '+"_2bha":'')+(' '+"_2bhb")+(y.toDateString()===this.state.currentTime.toDateString()?' '+"_2bhe":'')+(z&&y.toDateString()===z.toDateString()?' '+"_2bhf":''),ba=null;if(this.state.dayHeight){var ca=Math.floor((this.state.dayHeight-this.$OzCalendarMonthly2-this.$OzCalendarMonthly3)/this.$OzCalendarMonthly4)+1;if(s[y]&&s[y].length>ca){(function(da){ba=c('React').createElement(c('Link.react'),{onClick:function(){return this.$OzCalendarMonthly9(da);}.bind(this),className:"_2bhg"},'Show more ('+(s[y].length-ca)+')');}).bind(this)(y);s[y]=s[y].slice(0,ca);}}else s[y]=[];w.push(c('React').createElement('div',{key:x,ref:r===0&&x===0?'testCell':null,style:{height:'16.666%'},onDoubleClick:this.$OzCalendarMonthly10(y),className:aa},c('React').createElement('div',{className:"_2bhh"+(y.getMonth()!==this.props.date.getMonth()?' '+"_2bhi":'')},y.getMonth()!==this.props.date.getMonth()&&y.getDate()===1?c('DateStrings').getMonthNameShort(y.getMonth()+1).toString()+' ':null,y.getDate()),c('React').createElement('div',{className:"_2bhj"},s[y],ba)));}return (c('React').createElement('div',null,w));}.bind(this),this.$OzCalendarMonthly10=function(r){if(this.props.onDateClick){var s=this.props.onDateClick;return function(){return s(r);};}else return null;}.bind(this),this.$OzCalendarMonthly9=function(r){if(this.props.onShowMore)this.props.onShowMore(r);}.bind(this),this.renderDayHeader=function(r){var s=c('React').createElement('div',{className:"_2bhk"},c('DateStrings').getWeekdayName(r)),t=r===6;return (c('React').createElement('div',{className:"_2bhx",boxFlex:1,key:r},c('React').createElement('div',{className:"_2bhy"+(t?' '+"_2bhz":'')+(r===0?' '+"_2bh-":'')},s)));},this.renderCol=function(r,s){var t=r===6;return (c('React').createElement('div',{className:"_2bhx",boxFlex:1,key:r},this.renderGridLines(r,s,t)));}.bind(this),m;}l.prototype.componentDidMount=function(){'use strict';this.$OzCalendarMonthly1=setInterval(function(){return this.setState({currentTime:new Date()});}.bind(this),60*1000);this.setState({dayHeight:this.$OzCalendarMonthly6()});setTimeout(function(){return this.$OzCalendarMonthly7();}.bind(this),0);this.$OzCalendarMonthly5=c('ResizeListener').add(function(){return this.setState({dayHeight:this.$OzCalendarMonthly6()});}.bind(this));};l.prototype.componentWillUnmount=function(){'use strict';if(this.$OzCalendarMonthly1)clearInterval(this.$OzCalendarMonthly1);if(this.$OzCalendarMonthly5)this.$OzCalendarMonthly5.remove();};l.prototype.componentDidUpdate=function(m,n){'use strict';if(m&&m.date!==this.props.date)this.$OzCalendarMonthly7();};l.prototype.render=function(){'use strict';var m=this.groupEvents(),n=[],o=[];for(var p=0;p<c('DateConsts').DAYS_PER_WEEK;p++){n.push(this.renderCol(p,m));o.push(this.renderDayHeader(p));}var q=c('React').createElement(c('ScrollableArea.react'),{className:"_2bgx",ref:'scrollable',shadow:false},c('React').createElement(c('OzFlexBox.react'),{className:"_2bgy"},n)),r=c('joinClasses')(this.props.className,"_2bgz _2bg-"),s={};if(this.props.calendarHeight)s={height:this.props.calendarHeight+'px'};return c('React').createElement('div',{style:s,className:r},c('React').createElement(c('OzFlexBox.react'),{className:"_2bgy"},o),q);};l.propTypes={date:k.instanceOf(Date).isRequired,calendarHeight:k.number,onShowMore:k.func,scrollToCurrentTime:k.bool,onDateClick:k.func,highlightedDay:k.instanceOf(Date)};l.defaultProps={dayStartHour:9,dayEndHour:17,daysPerWeek:5,date:new Date(),weekStartDay:1,enableCurrentTimeMarker:true,calendarHeight:700};f.exports=l;}),null);
__d("OzCalendarType",[],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();f.exports={MONTH:1,WEEK:2,DAY:3};}),null);
__d('OzCalendarPager.react',['cx','ix','OzCalendarUtils','Image.react','OzCalendarType','React','XUIButton.react','XUIButtonGroup.react'],(function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();var l=c('React').PropTypes;j=babelHelpers.inherits(m,c('React').Component);k=j&&j.prototype;function m(){var n,o;'use strict';for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=k.constructor).call.apply(o,[this].concat(q)),this.onWeekNavigate=function(s){this.props.onDateChange&&this.props.onDateChange(new Date(s));}.bind(this),this.$OzCalendarPager1=function(s){var t=this.props.date.getTime(),u=c('OzCalendarUtils').addDaysToTimestamp(t,s);return u;}.bind(this),this.$OzCalendarPager2=function(s){var t=c('OzCalendarUtils').getWeekStartTimestamp(this.props.date.getTime()),u=c('OzCalendarUtils').addDaysToTimestamp(t,s*c('OzCalendarUtils').DAY_IN_WEEK);return u;}.bind(this),this.$OzCalendarPager3=function(s){return new Date(this.props.date.getFullYear(),this.props.date.getMonth()+s*1,1).getTime();}.bind(this),this.$OzCalendarPager4=function(s){return new Date(this.props.date.getFullYear()+s*1,this.props.date.getMonth(),1).getTime();}.bind(this),this.$OzCalendarPager5=function(s){var t;switch(this.props.mode){case c('OzCalendarType').MONTH:t=this.$OzCalendarPager3(s);break;case c('OzCalendarType').WEEK:t=this.$OzCalendarPager2(s);break;case c('OzCalendarType').DAY:t=this.$OzCalendarPager1(s);break;}this.onWeekNavigate(t);}.bind(this),this.$OzCalendarPager6=function(s){var t=this.props.mode===c('OzCalendarType').MONTH?this.$OzCalendarPager4(s):this.$OzCalendarPager3(s);this.onWeekNavigate(t);}.bind(this),n;}m.prototype.render=function(){'use strict';var n=this.props,o=n.buttonSize,p=n.disabled,q=n.hasFastSwitch;return (c('React').createElement(c('XUIButtonGroup.react'),{className:"_3-95"},q?c('React').createElement(c('XUIButton.react'),{style:{opacity:.63},image:c('React').createElement(c('Image.react'),{src:i('/images/ui/x/pager/double-left.png')}),role:'button',disabled:p,size:o,onClick:function(){return this.$OzCalendarPager6(-1);}.bind(this)}):null,c('React').createElement(c('XUIButton.react'),{image:c('React').createElement(c('Image.react'),{src:i('/images/ui/x/pager/left.png')}),role:'button',disabled:p,size:o,onClick:function(){return this.$OzCalendarPager5(-1);}.bind(this)}),c('React').createElement(c('XUIButton.react'),{label:'Today',disabled:p,size:o,onClick:function(){return this.onWeekNavigate(Date.now());}.bind(this)}),c('React').createElement(c('XUIButton.react'),{image:c('React').createElement(c('Image.react'),{src:i('/images/ui/x/pager/right.png')}),role:'button',disabled:p,size:o,onClick:function(){return this.$OzCalendarPager5(1);}.bind(this)}),q?c('React').createElement(c('XUIButton.react'),{style:{opacity:.63},image:c('React').createElement(c('Image.react'),{src:i('/images/ui/x/pager/double-right.png')}),role:'button',disabled:p,size:o,onClick:function(){return this.$OzCalendarPager6(1);}.bind(this)}):null));};m.propTypes={date:l.instanceOf(Date).isRequired,onDateChange:l.func,buttonSize:l.string,mode:l.oneOf([c('OzCalendarType').MONTH,c('OzCalendarType').WEEK,c('OzCalendarType').DAY]),hasFastSwitch:l.bool,disabled:l.bool};m.defaultProps={mode:c('OzCalendarType').WEEK};f.exports=m;}),null);
__d('OzPagedMonthlyCalendar.react',['cx','DateStrings','OzCalendarMonthly.react','OzCalendarPager.react','OzCalendarType','LoadingIndicator.react','React'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes;i=babelHelpers.inherits(l,c('React').Component);j=i&&i.prototype;function l(){var m,n;'use strict';for(var o=arguments.length,p=Array(o),q=0;q<o;q++)p[q]=arguments[q];return m=(n=j.constructor).call.apply(n,[this].concat(p)),this.state={date:new Date(this.props.date)},this.$OzPagedMonthlyCalendar1=function(){return (c('React').createElement('div',{className:"_1if9"},c('React').createElement('div',{className:"_1ifa"},this.props.events.length+' events'),c('React').createElement('div',{className:"_1ifb"},c('React').createElement(c('OzCalendarPager.react'),{date:this.state.date,mode:c('OzCalendarType').MONTH,onDateChange:this.$OzPagedMonthlyCalendar4,hasFastSwitch:true})),c('React').createElement('div',{className:"_1ifc"},c('React').createElement('strong',null,c('DateStrings').getMonthName(this.state.date.getMonth()+1)),'  ',this.state.date.getFullYear())));}.bind(this),this.$OzPagedMonthlyCalendar2=function(){if(!this.props.isLoading)return null;return (c('React').createElement('div',{className:"_1ifd"},c('React').createElement(c('LoadingIndicator.react'),{size:'large',color:'white'})));}.bind(this),this.$OzPagedMonthlyCalendar3=function(){return (c('React').createElement('div',{className:"_1ife"},c('React').createElement(c('OzCalendarMonthly.react'),{date:this.state.date,className:"_1iff",onDateClick:this.props.onDateClick,onShowMore:this.props.onShowMore,highlightedDay:this.props.highlightedDay},this.props.events)));}.bind(this),this.$OzPagedMonthlyCalendar4=function(r){this.setState({date:r},function(){this.props.onDateChange(r);}.bind(this));}.bind(this),m;}l.prototype.render=function(){'use strict';return c('React').createElement('div',{className:"_1if8"},this.$OzPagedMonthlyCalendar1(),this.$OzPagedMonthlyCalendar2(),this.$OzPagedMonthlyCalendar3());};l.propTypes={date:k.instanceOf(Date).isRequired,events:k.array.isRequired,isLoading:k.bool,onDateClick:k.func,onDateChange:k.func.isRequired,onShowMore:k.func.isRequired,highlightedDay:k.instanceOf(Date)};f.exports=l;}),null);
__d('OzCalendarModal.react',['cx','OzConfig','OzImmutablePureRenderMixin','immutable','React','Reflux','OzDraggableModal.react','XUICloseButton.react','OzPagedMonthlyCalendar.react','OzCalendarEvent.react','XUIDialog.react','XUIDialogBody.react','XUIDialogTitle.react','formatDate'],(function a(b,c,d,e,f,g,h){var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('React').PropTypes,l=c('immutable').Map,m=c('React').createClass({displayName:'OzCalendarModal',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{events:k.array.isRequired,onClose:k.func.isRequired},getInitialState:function q(){return {moreDialogShown:false,moreDialogDate:new Date()};},render:function q(){var r=this.state.config.get('GK',l()),s=r.get('calendar'),t=this.props,u=t.events,v=t.onClose;return (c('React').createElement(c('OzDraggableModal.react'),{className:"_33-2",getHandle:function(w){return this.refs.header;}.bind(this)},c('React').createElement('div',{className:"_33-3",ref:'header'},!s?'Calendar - Busy/Free Access only':'Calendar',c('React').createElement(c('XUICloseButton.react'),{onClick:v})),c('React').createElement(c('OzPagedMonthlyCalendar.react'),{isLoading:false,events:n(u,s),date:new Date(),onDateChange:function w(x){},onShowMore:this._calendarShowMore}),this._renderShowMoreDialog(s)));},_renderShowMoreDialog:function q(r){if(this.state.moreDialogShown)return (c('React').createElement(p,{events:o(this.props.events,this.state.moreDialogDate),date:this.state.moreDialogDate,onToggle:this._onShowMoreToggle,calendarBusy:r}));return null;},_calendarShowMore:function q(r){this.setState({moreDialogShown:true,moreDialogDate:r});}}),n=function q(r,s){return (r.map(function(t){return (c('React').createElement(c('OzCalendarEvent.react'),{key:t.identifier,title:s?t.title:'Busy',location:s?t.location:'',startTime:new Date(t.startDate).getTime(),endTime:new Date(t.endDate).getTime(),shade:'DarkBlue',hasTooltip:s}));}));},o=function q(r,s){var t=new Date(s);t.setTime(t.getTime()+86400000);return (r.sort(function(u,v){return (new Date(u.startDate).getTime()-new Date(v.startDate).getTime());}).filter(function(u){return (new Date(u.startDate).getTime()>=new Date(s).getTime()||new Date(u.endDate).getTime()>=new Date(s).getTime());}).filter(function(u){return (new Date(u.startDate).getTime()<t.getTime());}));};i=babelHelpers.inherits(p,c('React').Component);j=i&&i.prototype;function p(){var q,r;'use strict';for(var s=arguments.length,t=Array(s),u=0;u<s;u++)t[u]=arguments[u];return q=(r=j.constructor).call.apply(r,[this].concat(t)),this.$OzCalendarEventShowMoreDialog1=function(v,w){var x=null,y='',z=null,aa=new Date(v),ba=new Date(w),ca=aa.getDate()==ba.getDate()&&aa.getMonth()==ba.getMonth(),da=Math.floor((ba-aa)/(1000*60*60))>13;if(!da||!ca){x=c('formatDate')(aa,ca?'g:ia':'D M j, g:ia');y=c('formatDate')(ba,ca?'g:ia':'D M j, g:ia');z=x+(ca?' - ':'\n')+y;}else z='All day';return (c('React').createElement('div',{className:"_33-c"},z));},q;}p.prototype.render=function(){'use strict';var q=this.props.events.map(function(r){return c('React').createElement('div',{key:r.identifier,className:"_33-4"},this.$OzCalendarEventShowMoreDialog1(r.startDate,r.endDate),c('React').createElement('div',{className:"_33-b"},c('React').createElement('span',null,this.props.calendarBusy?r.title+'\n'+r.location:'Busy')));}.bind(this));return c('React').createElement(c('XUIDialog.react'),{shown:true,width:500,onToggle:this.props.onToggle},c('React').createElement(c('XUIDialogTitle.react'),null,q.length+' events on '+this.props.date.toDateString()),c('React').createElement(c('XUIDialogBody.react'),null,q));};p.propTypes={events:k.array.isRequired,date:k.instanceOf(Date).isRequired,onToggle:k.func,calendarBusy:k.bool};f.exports=m;}),null);
__d('OzThreadMeta.react',['cx','OzAPI','OzHelpers','immutable','Keys','MessengerButton.react','OzFormPreview.react','OzThreadLabels.react','OzStores','OzSwitch.react','OzImmutablePureRenderMixin','React','Reflux','Tooltip','OzCalendarModal.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('OzFormPreview.react').Row,k=c('OzThreadLabels.react').OzUnderageLabel,l=c('React').PropTypes,m=c('OzStores').CalendarEventStore,n=c('React').createClass({displayName:'OzThreadMeta',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(m,'calendarEvents')],propTypes:{thread:l.object.isRequired,repNames:l.instanceOf(i).isRequired},getInitialState:function w(){return {newMeta:null,muted:v(this.props.thread),calendarShown:false};},componentWillReceiveProps:function w(x){if(c('OzHelpers').threadID(x.thread)!==c('OzHelpers').threadID(this.props.thread)){this.setState({newMeta:null,muted:v(x.thread),locked:x.thread.get('locked')});}else this.setState({muted:v(x.thread),locked:x.thread.get('locked')});},render:function w(){var x=c('OzHelpers').threadID(this.props.thread),y=this.state.calendarEvents.get(x,[]),z=[['Cancel','secondary',this._handleCancel],['DONE','primary',this._handleDone]],aa=['Edit','primary',this._handleEdit],ba=y&&y.length?[['Calendar','primary',this._handleCalendar],aa]:[aa],ca=this.state.newMeta?z:ba;return (c('React').createElement('div',{className:"_56t0"+(this.state.newMeta?' '+"_56t1":'')},this.state.calendarShown&&c('React').createElement(c('OzCalendarModal.react'),{events:y,onClose:this._onCalendarClose}),c('React').createElement(o,{thread:this.props.thread,buttons:ca}),this.state.newMeta?c('React').createElement(s,{meta:this.state.newMeta,onCancel:this._handleCancel,onChange:this._handleChange,onDone:this._handleDone,onMutedToggle:this._handleMutedToggle,isMuted:this.state.muted}):c('React').createElement(q,{meta:u(this.props.thread),onMutedToggle:this._handleMutedToggle,isMuted:this.state.muted}),c('React').createElement(r,{thread:this.props.thread,repNames:this.props.repNames,locked:!!this.state.locked,onToggle:this._handleThreadLockToggle})));},_handleEdit:function w(){this.setState({newMeta:u(this.props.thread)});},_handleCancel:function w(){this.setState({newMeta:null});},_handleDone:function w(){c('OzAPI').saveMeta(c('OzHelpers').threadID(this.props.thread),this.state.newMeta);this.setState({newMeta:null});},_handleChange:function w(x){this.setState({newMeta:x});},_handleMutedToggle:function w(x){c('OzAPI').saveMuted(c('OzHelpers').threadID(this.props.thread),!x);this.setState({muted:!x});},_handleThreadLockToggle:function w(x){var y=this.props.thread,z=c('OzHelpers').threadID(y);if(this.state.locked){this.setState({locked:false});c('OzAPI').unlockThread(z,y.get('locked-at'));}else{this.setState({locked:true});c('OzAPI').lockThread(z);}},_handleCalendar:function w(){var x=this.props.thread,y=c('OzHelpers').threadID(x);c('OzAPI').fetchCalendar(y);this.setState({calendarShown:true});},_onCalendarClose:function w(){this.setState({calendarShown:false});}}),o=c('OzHelpers').pure(function(w){var x=w.thread,y=w.buttons;return (c('React').createElement('div',{className:"_56t2"},c('React').createElement('div',{className:"_56t6"},c('React').createElement('h2',{className:"_56tb"},c('OzHelpers').getName(x)),c('React').createElement('div',{className:"_56tc"},y.map(function(z,aa){var ba=z[0],ca=z[1],da=z[2];return (c('React').createElement(c('MessengerButton.react'),{key:ba,label:ba,type:ca,onClick:da}));}))),c('React').createElement('div',{className:"_56td"},c('React').createElement(k,{thread:x}))));}),p=c('OzHelpers').pure(function(w){var x=w.isMuted,y=w.onMutedToggle,z=function ca(da){y(x);},aa='Uncheck if person dislikes our proactive messages, e.g. surveys',ba=c('React').createElement('span',c('Tooltip').propsFor(aa),'Proactive?');return (c('React').createElement(j,{label:ba},c('React').createElement('input',{type:'checkbox',checked:!x,onChange:z})));}),q=c('OzHelpers').pure(function(w){var x=w.meta,y=w.isMuted,z=w.onMutedToggle,aa=(x.get('address1','')+' '+x.get('address2','')+'\n     '+x.get('city','')+' '+x.get('state','')+' '+x.get('zip','')+'\n    ').trim();return (c('React').createElement(c('OzFormPreview.react'),null,c('React').createElement(j,{label:'Nickname'},x.get('preferred-name')),c('React').createElement(j,{label:'Email'},x.get('email')),c('React').createElement(j,{label:'Phone'},x.get('phone')),c('React').createElement(j,{label:'Address'},aa),c('React').createElement(j,{label:'Device OS'},x.get('os-type')),c('React').createElement(j,{label:'App Version'},x.get('app-version')),c('React').createElement(p,{isMuted:y,onMutedToggle:z})));}),r=c('OzHelpers').pure(function(w){var x=w.thread,y=w.repNames,z=w.locked,aa=w.onToggle,ba=y.get(x.get('locker-id')),ca=ba?(x.get('locked')?'Locked':'Last locked')+' by '+ba:'';ca+=ca&&x.get('locked-at')?' at '+new Date(x.get('locked-at')).toLocaleString():'';var da=c('React').createElement('span',c('Tooltip').propsFor(ca),z?'Click to unlock thread':'Click to lock thread');return (c('React').createElement(c('OzSwitch.react'),{className:"_z1m",isAnimated:true,reverseColors:true,isOn:z,label:da,onToggle:aa}));}),s=c('React').createClass({displayName:'EditView',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{meta:l.instanceOf(i).isRequired,onCancel:l.func.isRequired,onChange:l.func.isRequired,onDone:l.func.isRequired,isMuted:l.bool.isRequired,onMutedToggle:l.func.isRequired},componentDidMount:function w(){this.refs['preferred-name'].focus();},render:function w(){var x=this._renderRow;return (c('React').createElement('form',{className:"_56to",onKeyDown:this._handleKeyDown},c('React').createElement(t,null,x('Nickname','preferred-name','Add Preferred Name')),c('React').createElement(t,null,x('Email','email','Add email')),c('React').createElement(t,null,x('Phone','phone','Add phone')),c('React').createElement(t,null,x('Street','address1','Add Street'),x('Street','address2','Add Street'),x('City','city','Add City'),x('State','state'),x('Zip Code','zip')),c('React').createElement(t,null,c('React').createElement(p,{isMuted:this.props.isMuted,onMutedToggle:this.props.onMutedToggle}))));},_handleKeyDown:function w(x){x.which===c('Keys').ESC?this.props.onCancel():x.which===c('Keys').RETURN?this.props.onDone():null;},_renderRow:function w(x,y,z){var aa=this.props,ba=aa.meta,ca=aa.onChange;return (c('React').createElement(j,{label:x},c('React').createElement('input',{ref:y,type:'text',className:"_1-i0 _56uv",placeholder:z,value:ba.get(y),onChange:function da(ea){return ca(ba.set(y,ea.target.value));}})));}}),t=c('OzHelpers').pure(function(w){var x=w.children;return c('React').createElement('div',{className:"_56vn"},x);});function u(w){return w.get('metadata-json')||i();}function v(w){return !!w.get('muted');}f.exports=n;}),null);
__d('OzThreadNote.react',['cx','OzAPI','getActiveElement','OzHelpers','immutable','OzConfig','OzRequirementTokenizer.react','React','Reflux'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('React').PropTypes,k=1000,l=c('React').createClass({displayName:'OzThreadNote',mixins:[c('Reflux').connect(c('OzConfig').ConfigStore,'config')],propTypes:{thread:j.instanceOf(i).isRequired,requirements:j.instanceOf(i).isRequired,timeline:j.bool},getDefaultProps:function m(){return {timeline:false};},getInitialState:function m(){return {editedText:this.props.thread.get('notes')||''};},componentWillReceiveProps:function m(n){var o=n.thread.get('notes'),p=c('getActiveElement')()===this.refs.textarea;if(o!==this.props.thread.get('notes')&&!p)this.setState({editedText:o});},render:function m(){var n=this.props,o=n.requirements,p=n.thread,q=n.timeline;return (c('React').createElement('div',{className:"_1x92"},c('React').createElement('h2',{className:"_1x93"},'Thread Notes'),c('React').createElement('div',{className:"_41v4"},c('React').createElement(c('OzRequirementTokenizer.react'),{allRequirements:o,onDeleteRequirement:this._handleDeleteRequirement,onCreateRequirement:this._handleCreateRequirement,selectedRequirements:p.get('requirements'),placeholder:'Add a user tag...',timeline:q})),c('React').createElement('textarea',{ref:'textarea',className:"_1x95"+(this.props.timeline?' '+"_11_w":''),placeholder:'Leave a note',value:this.state.editedText,onChange:this._handleChange})));},_handleChange:function m(){var n=this.props.thread,o=this.refs.textarea.value;this.setState({editedText:o});window.clearTimeout(this.timeout);this.timeout=window.setTimeout(function(){c('OzAPI').saveNote(c('OzHelpers').threadID(n),o);},k);},_handleCreateRequirement:function m(n){var o=this.props.thread;c('OzAPI').createThreadRequirement(c('OzHelpers').threadID(o),n.get('name'));},_handleDeleteRequirement:function m(n){var o=this.props.thread;c('OzAPI').deleteThreadRequirement(c('OzHelpers').threadID(o),n.get('id'));}});f.exports=l;}),null);
__d('OzTimeline.react',['csx','cx','OzAPI','OzHelpers','immutable','OzActions','OzDate.react','OzStores','ozFormatTime','OzImmutablePureRenderMixin','React','ReactRouter','Reflux'],(function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j=c('immutable').Map,k=c('immutable').List,l=c('React').PropTypes,m=c('ReactRouter').Link,n=c('OzStores').ActiveThreadStore,o=j({'send-email':'sent email','receive-email':'received email','send-calendar':'sent invite','completed-call':'phone call'}),p=c('React').createClass({displayName:'OzTimeline',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(n,'activeThread')],propTypes:{closedIntents:l.instanceOf(k).isRequired,events:l.instanceOf(k).isRequired,tasks:l.instanceOf(k).isRequired},contextTypes:{router:l.object.isRequired},componentDidMount:function w(){this._scrollTimeline();this._timeUpdateInterval=window.setInterval(function(x){return (this.setState({time:c('OzHelpers').serverNow()}));}.bind(this),60000);},componentDidUpdate:function w(){this._scrollTimeline();},_scrollTimeline:function w(){var x=document.querySelector("._415b");if(x)x.scrollIntoView(true);var y=document.querySelector("._2mg4");if(y)y.scrollIntoView(true);},componentWillUnmount:function w(){window.clearInterval(this._timeUpdateInterval);},getInitialState:function w(){return {time:c('OzHelpers').serverNow()};},render:function w(){var x=this._sortedItems();return (c('React').createElement('div',{className:"_201k"},c('React').createElement('div',{className:"_201l"},'Activity & tasks'),c('React').createElement('div',{className:"_4fj7 _201m",ref:'scrollable'},x.map(this._renderTimelineElement),c('React').createElement('div',{key:'OzTimelineSpacer',className:"_415b"}))));},_sortedItems:function w(){var x=this.props,y=x.events,z=x.tasks,aa=x.closedIntents;return (y.filter(function(ba){return o.has(ba.get('type'));}).map(function(ba){return ba.set('item-type','event');}).concat(z.map(function(ba){return ba.set('item-type','task');})).concat(aa.map(function(ba){return ba.set('item-type','intent').set('intent-id',ba.get('id'));})).sortBy(v));},_renderTimelineElement:function w(x){var y=this.state,z=y.activeThread,aa=y.time,ba=this.props.tasks,ca=x.get('item-type')+'-'+x.get('id');switch(x.get('item-type')){case 'event':return c('React').createElement(r,{key:ca,event:x,onEmailView:this._handleEmailView,onEmailReply:this._handleEmailReply,onInviteView:this._handleInviteView,activeThread:z});case 'task':return c('React').createElement(s,{key:ca,task:x,activeThread:z,time:aa});case 'intent':return c('React').createElement(t,{key:ca,intent:x,tasks:ba,activeThread:z});default:c('OzHelpers').err('unknown item',x);return null;}},_handleEmailView:function w(x){c('OzActions').emailComposer.add(babelHelpers['extends']({},c('OzHelpers').eventToEmail(x),{disabled:true}));},_handleEmailReply:function w(x){c('OzActions').emailComposer.add(c('OzHelpers').eventToEmail(c('OzHelpers').reEmail(x)));},_handleInviteView:function w(x){c('OzActions').inviteComposer.add(c('OzHelpers').eventToInvite(x));},_handleCallPlay:function w(x){return c('OzAPI').everstoreURI(x).then(function(y){return window.open(y);});}}),q=c('OzHelpers').pure(function(w){var x=w.activeThread,y=w.contents,z=w.item,aa=w.onClick,ba=w.path,ca=w.status,da=w.summary,ea=z.get('intent-id')===x.get('activeIntent'),fa=z.get('id')===x.get(z.get('item-type')==='task'?'activeTask':'activeEvent');ca=ca||'completed';return (c('React').createElement(m,{to:ba,className:"_8i9"+(ea?' '+"_8ia":'')+(!ea?' '+"_8ib":'')+(fa?' '+"_2mg4":'')+(ca==='pending'?' '+"_4rsf":'')+(ca==='completed'?' '+"_4rsg":'')+(ca==='close'?' '+"_4rsj":'')+(ca==='late'?' '+"_4rsm":'')},c('React').createElement('div',{className:"_8id"}),c('React').createElement('div',{className:"_201o"}),c('React').createElement('div',{className:"_201p"},c('React').createElement('div',{className:"_201r"},z.get('intent-name')),c('React').createElement('div',{className:"_8ie"},da||'[Untitled]'),c('React').createElement('div',{className:"_2022"},ca!=='completed'?'Due: ':null,c('React').createElement(c('OzDate.react'),{className:"_1qdh",timestamp:v(z)})))));},'OzTimelineItem'),r=c('OzHelpers').pure(function(w){var x=w.activeThread,event=w.event,y=w.onCallPlay,z=w.onEmailReply,aa=w.onEmailView,ba=w.onInviteView,ca=event.get('type'),da;switch(ca){case 'send-email':da='Email to '+event.getIn(['data','to']).join(', ');break;case 'receive-email':da='Email from '+event.getIn(['data','from']);break;case 'send-calendar':if(event.hasIn(['data','place-id'])){da='Invite bubble';}else da='Invite to '+event.getIn(['data','to']).join(', ');break;case 'completed-call':var ea=event.get('data'),fa={'in':'Call from ',out:'Call to ',voicemail:'Voicemail from '}[ea.get('direction')],ga=c('OzHelpers').parsePhoneNumber(ea.get('remote-phone')),ha=ea.get('RecordingDuration'),ia=ea.get('recording-ev-handle');da=fa+ga;break;default:da='Another event';}return (c('React').createElement(q,{activeThread:x,path:c('OzHelpers').threadPath({threadid:event.get('user-id'),intentid:event.get('intent-id'),eventid:event.get('id')}),item:event,summary:da}));},'OzTimelineEvent'),s=c('OzHelpers').pure(function(w){var x=w.task,y=w.time,z=w.activeThread,aa=function da(ea){switch(ea.get('type')){case 'reminder':return ea.getIn(['data','description']);default:return ea.get('type');}},ba;if(c('OzHelpers').isCompletedTask(x)){ba='completed';}else if(x.get('start-at')>y){ba='pending';}else if(x.get('deadline')>y){ba='close';}else ba='late';var ca=c('React').createElement('div',null,x.getIn(['data','notes']));return (c('React').createElement(q,{activeThread:z,path:c('OzHelpers').threadPath({threadid:x.get('user-id'),intentid:x.get('intent-id'),taskid:x.get('id')}),item:x,status:ba,summary:aa(x),contents:ca}));},'OzTimelineTask'),t=c('OzHelpers').pure(function(w){var x=w.intent,y=w.activeThread,z=w.tasks,aa='Closed: '+x.get('alias',x.get('name')),ba=c('OzHelpers').nextTaskForIntent(x,z);return (c('React').createElement(q,{activeThread:y,path:c('OzHelpers').threadPath({threadid:x.get('user-id'),intentid:x.get('id'),taskid:ba&&ba.get('id')}),item:x,summary:aa}));}),u=j({event:'timestamp',task:'deadline',separator:'timestamp',intent:'closed-at'});function v(w){var x=u.get(w.get('item-type'));return w.get(x,w.get('created-at'));}f.exports=p;}),null);
__d('OzThreadPanel.react',['cx','OzAPI','OzHelpers','immutable','OzConfig','OzHumans','OzEventShow.react','OzIntent.react','OzIntentActions.react','OzIntentList.react','OzIntentTabs.react','OzReminders.react','OzReminderTask.react','OzReminderTasks.react','OzStores','OzTabHeader.react','OzTaskComposers.react','OzTaskShow.react','OzThreadMeta.react','OzThreadNote.react','OzTimeline.react','OzImmutablePureRenderMixin','React','OzWrapper.react','Reflux','XUISelector.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('XUISelector.react').Option,j=c('immutable').Map,k=c('immutable').List,l=c('immutable').Set,m=c('React').PropTypes,n=c('OzStores').ActiveThreadStore,o='NO_OWNER',p='TODO',q='HISTORY',r=c('React').createClass({displayName:'OzThreadPanel',mixins:[c('OzImmutablePureRenderMixin'),c('Reflux').connect(c('OzConfig').ConfigStore,'config'),c('Reflux').connect(n,'activeThread'),c('Reflux').listenTo(n,'onActiveIntentChange')],onActiveIntentChange:function u(v){if(v.get('activeIntent')&&!v.get('activeTask')){var w=this._activeTabForIntent();if(w)this.setState({activeTab:w});}},componentWillMount:function u(){var v=this._activeTabForIntent();if(v)this.setState({activeTab:v});},componentWillReceiveProps:function u(v){if(!this.state.activeTab){var w=this._activeTabForIntent();if(w)this.setState({activeTab:w});}},render:function u(){var v=this.props,w=v.thread,x=v.repNames,y=this.state,z=y.activeTab,aa=y.config,ba=y.activeThread,ca=aa.getIn(['GK','timeline']),da=aa.get('display-tasks')||ca,ea=ba.get('activeIntent'),fa=ba.get('activeTask'),ga=ba.get('activeEvent'),ha=!(ca||z!==q),ia=c('OzHelpers').intents(w).find(function(sa){return sa.get('id')===ea;}),ja=ha?c('OzHelpers').closedIntents(w).filterNot(c('OzHelpers').isDeleted):ia?l(c('OzHelpers').openIntents(w).push(ia)).toList():c('OzHelpers').openIntents(w),ka=ia&&fa?(ia.get('tasks')||k()).find(function(sa){return sa.get('id')===fa;}):null,la=ia&&ga?(ia.get('events')||k()).find(function(sa){return sa.get('id')===ga;}):null,ma={isHistory:ha,repNames:x,thread:w},na=j(ja.map(function(sa){return [sa.get('id'),c('OzHelpers').intentAlias(sa)];}).concat(ia?[[ea,c('OzHelpers').intentAlias(ia)]]:[])),oa=w.get('tasks',k()).filter(function(sa){return (ia?sa.get('intent-id')==ia.get('id'):true);}).map(function(sa){return (sa.set('intent-name',na.get(sa.get('intent-id'))));}),pa=w.get('tasks',k()).filter(function(sa){return sa.get('state')!=='completed';}).map(function(sa){return sa.get('intent-id');}).toSet(),qa=w.get('intents').filter(function(sa){return c('OzHelpers').isClosedIntent(sa)&&pa.get(sa.get('id'));}),ra=ia?ia.get('events',j()).valueSeq().map(function(sa){return sa.set('intent-name',na.get(sa.get('intent-id')));}).toList():ja.reduce(function(sa,ta){return sa.concat(ta.get('events',j()).valueSeq());},k()).map(function(sa){return sa.set('intent-name',na.get(sa.get('intent-id')));});return (c('React').createElement('div',{className:"_5l_x"},ia&&c('React').createElement(c('OzTaskComposers.react'),{intent:ia}),ca?c('React').createElement(c('OzIntentTabs.react'),{intents:c('OzHelpers').openIntents(w).concat(qa),tasks:oa,activeIntentId:ea,threadId:w.get('user-id')}):null,c('React').createElement('div',{className:"_1c1k"+(ca?' '+"_5mt9":'')},c('React').createElement('div',{className:"_5l_y"},!ca&&c('React').createElement(c('OzTabHeader.react'),{active:z,tabs:[['Todo',p],['History',q]],onChange:this._handleTabChange}),c('React').createElement('div',{className:"_5l_z"+(ca?' '+"_5mt9":'')},ca?c('React').createElement(c('OzTimeline.react'),{events:ra,tasks:oa,closedIntents:!ea?c('OzHelpers').closedIntents(w):k()}):c('React').createElement('div',{className:"_4fj7"},c('React').createElement(c('OzIntentList.react'),{intents:ja,activeIntentId:ba.get('activeIntent'),witIntents:this.props.witIntents,isHistory:ha,timelineGK:ca}))),ha||!ca?c('React').createElement('div',{className:"_4sm5"},da?c('React').createElement(c('OzReminderTasks.react'),ma):c('React').createElement(c('OzReminders.react'),ma)):null),c('React').createElement('div',{className:"_5l_-"+(ca?' '+"_11_w":'')+(ca?' '+"_5mt9":'')},c('React').createElement('div',{className:"_5l__"},c('React').createElement('div',{className:"_4fj7"},ia?c('React').createElement(c('OzIntent.react'),{intent:ia,key:'intent-'+ia.get('id'),location:w.get('location')||j(),repNames:x,requirements:this.props.requirements,timelineGK:ca,thread:w}):null,ca&&ka?c('React').createElement(c('OzTaskShow.react'),{key:'task-'+ka.get('id'),location:w.get('location')||j(),onCancel:this._handleCancelTask,onComplete:this._handleCompleteTask,onSave:this._handleSaveTask,onOpen:this._handleOpenTask,task:ka}):la?c('React').createElement(c('OzEventShow.react'),{key:'event-'+la.get('id'),activeIntent:ia,event:la}):null)),!ca&&c('React').createElement('div',null,c('React').createElement(c('OzThreadNote.react'),{key:c('OzHelpers').threadID(w),thread:w,requirements:this.props.requirements}),c('React').createElement(c('OzThreadMeta.react'),{thread:w,repNames:x}),c('React').createElement(s,{onOwnerChange:this.props.onOwnerChange,humans:this.props.humans,reps:this.props.reps,thread:w})))),ca&&c('React').createElement('div',{className:"_5mtb"},c('React').createElement('div',null,c('React').createElement(c('OzThreadMeta.react'),{thread:w,repNames:x}),c('React').createElement(s,{onOwnerChange:this.props.onOwnerChange,humans:this.props.humans,reps:this.props.reps,thread:w})),c('React').createElement(c('OzThreadNote.react'),{key:c('OzHelpers').threadID(w),thread:w,timeline:ca,requirements:this.props.requirements}))));},_activeTab:function u(){return this.state.activeTab||p;},_activeTabForIntent:function u(){var v=this.state.activeThread.get('activeIntent'),w=this.props.thread.get('intents',k()),x=v?w.find(function(y){return y.get('id')===v;}):null;if(x)if(c('OzHelpers').isClosedIntent(x)){return q;}else return p;},_handleTabChange:function u(v){var w=v[0],x=v[1];this.setState({activeTab:x});},_handleSaveTask:function u(v){return c('OzAPI').editTask(c('OzHelpers').threadID(this.props.thread),v);},_handleCompleteTask:function u(v){return c('OzAPI').completeTask(c('OzHelpers').threadID(this.props.thread),v);},_handleCancelTask:function u(v){var w=arguments.length<=1||arguments[1]===undefined?false:arguments[1];return c('OzAPI').cancelTask(c('OzHelpers').threadID(this.props.thread),v,w);},_handleOpenTask:function u(v){return c('OzAPI').openTask(c('OzHelpers').threadID(this.props.thread),v);}}),s=c('OzHelpers').pure(function(u){var v=u.onOwnerChange,w=u.humans,x=u.reps,y=u.thread,z=y,aa=c('OzHelpers').nameOrId(z.get('last-owner')).split(' ')[0];return (c('React').createElement('div',{className:"_5m00"},x&&!x.isEmpty()?c('React').createElement(t,{onChange:v,value:z.getIn(['owner','id'])||o,reps:x,humans:w}):null,c('React').createElement('span',{className:"_5m01"},aa?'Last owner: '+aa:null)));}),t=c('OzHelpers').pure(function(u){var v=u.reps,w=u.humans,x=u.value,y=u.onChange,z=v.toSeq().filter(function(da){return c('OzHumans').isActive(w.get(da.get('fbid')));}).sortBy(function(da){return da.get('name');}).map(function(da){var ea=da.get('fbid'),fa=da.get('is-coach',false)?"_5m02":'';return (c('React').createElement(i,{key:ea,value:ea},c('React').createElement('span',{className:fa},da.get('name'))));}),aa=z.get(x);z=z.valueSeq();if(!aa){var ba=v.get(x,j()),ca=ba.get('is-coach',false)?"_5m02":'';z=z.toList().unshift(c('React').createElement(i,{key:'current',value:x},c('React').createElement('span',{className:ca},ba.get('name','None'))));}return (c('React').createElement(c('XUISelector.react'),{size:'medium',value:x,onChange:y,maxheight:500},z));});f.exports=c('OzWrapper.react')(r);}),null);
__d('OzTop.react',['cx','OzAPI','OzHelpers','MessengerFlexScrollableArea.react','React','relativeTimeString.atlas','XUITextInput.react','SRTAdvancedDataTable.react','escapeRegex','ObjectSort','ReactRouter'],(function a(b,c,d,e,f,g,h){'use strict';var i,j;if(c.__markCompiled)c.__markCompiled();var k=c('ReactRouter').Link,l=[{id:'priority',label:'Priority',sortable:true,comparator:function n(o,p){return c('OzHelpers').compareBools(o.priority,p.priority);},cellRenderer:function n(o){return (c('React').createElement('span',{className:o?"_1nnl":''},o?'yes':'no'));}},{id:'trainer',label:'Trainer',sortable:true,comparator:c('ObjectSort').getStringSortFunction('trainer')},{id:'trainer-load',label:'Load',sortable:true,comparator:c('ObjectSort').getReverseNumericSortFunction('trainer-load'),isNumeric:true,cellRenderer:function n(o){return (c('React').createElement('div',{className:o>3?"_1nnl":''},o?o:'Not present'));}},{id:'trainer-team',label:'Team',sortable:true,comparator:c('ObjectSort').getStringSortFunction('trainer-team')},{id:'user-name',label:'User name',sortable:true,comparator:c('ObjectSort').getStringSortFunction('user-name'),cellRenderer:function n(o,p,q){return (c('React').createElement(k,{target:'blank',to:c('OzHelpers').threadPath({threadid:q['user-id']})},o));}},{id:'external',label:'External',sortable:true,comparator:function n(o,p){return c('OzHelpers').compareBools(o.external,p.external);},cellRenderer:function n(o){return (c('React').createElement('span',null,o?'external':'internal'));}},{id:'vip',label:'Vip',sortable:true,comparator:function n(o,p){return c('OzHelpers').compareBools(o.vip,p.vip);},cellRenderer:function n(o){return (c('React').createElement('span',null,o?'yes':'no'));}},{id:'name',label:'Type',sortable:true,comparator:c('ObjectSort').getStringSortFunction('name'),cellRenderer:function n(o,p,q){return (c('React').createElement(k,{target:'blank',to:c('OzHelpers').threadPath({threadid:q['user-id'],intentid:q.id})},o));}},{id:'blocked',label:'Status',sortable:true,comparator:function n(o,p){return c('OzHelpers').compareBools(o.blocked,p.blocked);},cellRenderer:function n(o){return (c('React').createElement('span',null,o?'waiting':'open'));}},{id:'created-at',label:'Open',sortable:true,comparator:c('ObjectSort').getReverseNumericSortFunction('created-at'),isNumeric:true,cellRenderer:function n(o){return c('relativeTimeString.atlas')(o,true);}},{id:'ir',label:'IR',sortable:true,comparator:c('ObjectSort').getReverseNumericSortFunction('ir'),isNumeric:true,cellRenderer:function n(o,p,q){return (c('React').createElement('div',null,o===0?'**':o));}},{id:'cr',label:'Current CR (s)',sortable:true,comparator:c('ObjectSort').getReverseNumericSortFunction('cr'),isNumeric:true,cellRenderer:function n(o){return (c('React').createElement('div',null,o===0?'**':o));}}];i=babelHelpers.inherits(m,c('React').Component);j=i&&i.prototype;function m(){var n,o;for(var p=arguments.length,q=Array(p),r=0;r<p;r++)q[r]=arguments[r];return n=(o=j.constructor).call.apply(o,[this].concat(q)),this.state={items:[],filterText:''},this.$OzTop2=function(s){var t=s.trim().replace(/ +/g,' ').split(' '),u=new RegExp(t.map(c('escapeRegex')).join('.* .*'),'i');return function(v){return u.test(v.name)||u.test(v['user-name'])||u.test(v['trainer-team'])||u.test(v.trainer)||u.test(v['user-id'])||u.test(v.id);};},this.$OzTop3=function(event){this.setState({filterText:event.target.value});this.refs.theTable.setFilter(this.$OzTop2(event.target.value));}.bind(this),n;}m.prototype.componentWillMount=function(){var n=function(){return c('OzAPI').topIntents().then(function(o){return this.setState({items:o.toJS()});}.bind(this));}.bind(this);n();this.$OzTop1=setInterval(n,30*1000);};m.prototype.componentWillUnmount=function(){clearInterval(this.$OzTop1);};m.prototype.render=function(){return (c('React').createElement('div',null,c('React').createElement('div',null,c('React').createElement('label',null,'Filter:',' ',c('React').createElement(c('XUITextInput.react'),{onChange:this.$OzTop3,value:this.state.filterText})),c('React').createElement('span',null,this.state.items.length,' open intents')),c('React').createElement(c('MessengerFlexScrollableArea.react'),null,c('React').createElement(c('SRTAdvancedDataTable.react'),{ref:'theTable',rowKeyField:'id',outerBorder:true,columns:l,rows:this.state.items,enableSelection:false}))));};f.exports=m;}),null);
__d('OzTrainerDashboard.react',['cx','OzHelpers','relativeTimeString.atlas','immutable','OzButton.react','OzHumans','OzStores','OzImmutablePureRenderMixin','React','Reflux','XUITable.react'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=c('immutable').Map,j=c('OzStores').HumanStore,k=c('React').PropTypes,l=c('React').createClass({displayName:'OzTrainerDashboard',mixins:[c('Reflux').connect(j,'humans')],contextTypes:{router:k.object.isRequired},render:function q(){return (c('React').createElement(m,{onThreadSelect:this._handleThreadSelect,humans:this.state.humans,reps:this.props.reps}));},_handleThreadSelect:function q(r){this.context.router.push('inbox/'+r);}}),m=c('React').createClass({displayName:'Main',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onThreadSelect:k.func.isRequired,humans:k.instanceOf(i).isRequired,reps:k.instanceOf(i).isRequired},render:function q(){return (c('React').createElement('div',{className:"_10cd"},c('React').createElement(c('XUITable.react'),null,c('React').createElement('thead',null,c('React').createElement('tr',null,c('React').createElement('th',null,'Trainer'),c('React').createElement('th',null,'Load'),c('React').createElement('th',null,'Status'),c('React').createElement('th',null,'Team'),c('React').createElement('th',null,'Link to Thread'))),c('React').createElement('tbody',null,this._getHumans().map(function(r){return (c('React').createElement(n,{key:r.get('id'),onSelect:this._handleThreadSelect,human:r,rep:this.props.reps.get(r.get('id'))}));}.bind(this))))));},_getHumans:function q(){var r=this.props,s=r.humans,t=r.reps;return s.sortBy(function(u){return t.getIn([u.get('id'),'name']);}).valueSeq();},_handleThreadSelect:function q(r){this.props.onThreadSelect(r.get('tid'));}}),n=c('React').createClass({displayName:'DashboardRow',mixins:[c('OzImmutablePureRenderMixin')],propTypes:{onSelect:k.func.isRequired,human:k.instanceOf(i).isRequired,rep:k.instanceOf(i)},render:function q(){var r=this.props,s=r.onSelect,t=r.human,u=r.rep;return (c('React').createElement('tr',null,c('React').createElement('td',null,o(u,t)),c('React').createElement('td',null,t.get('load')),c('React').createElement('td',null,p(t)),c('React').createElement('td',null,t.get('team')),c('React').createElement('td',null,t.get('tid')?c('React').createElement(c('OzButton.react'),{onClick:function v(){return s(t);}},'See Thread'):null)));}});function o(q,r){var s=q&&q.get('name')||'Unknown name';return ''+s+(c('OzHumans').isCoach(r)?' (Coach)':'');}function p(q){var r=c('relativeTimeString.atlas')(+c('OzHelpers').serverNow()-q.get('inactive-ms',0),true),s=c('OzHumans').isActive(q)?'Active':'Away ('+r+')';return c('OzHumans').inCoachMode(q)?s+' | In Coach Mode':s;}f.exports=l;}),null);
__d('OzMount',['invariant','OzAPI','OzHelpers','promiseFinally','immutable','Oz.react','OzActions','OzAIDashboardContainer.react','OzAll.react','OzConfig','OzFeedbackDashboard.react','OzInbox.react','OzInboxShow.react','OzIntentDashboardContainer.react','OzMerchants.react','OzStatsDashboardContainer.react','OzStores','OzThreadPanel.react','OzTop.react','OzTrainerDashboard.react','React','ReactDOM','ReactRouter','URI','OzTwilio','OzServerTime','OzPerformance'],(function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();c('OzTwilio');var i=c('ReactRouter').Route,j=c('ReactRouter').IndexRoute,k=c('ReactRouter').browserHistory,l=c('ReactRouter').match,m=c('ReactRouter').Router,n=c('ReactRouter').Redirect,o=c('OzStores').CalendarEventStore,p={mount:function x(y,z){z=babelHelpers['extends']({},z,u());c('OzPerformance').init();c('OzConfig').setConfig(c('immutable').fromJS(z));c('OzHelpers').info('[config]',z);var aa=void 0,ba=v(c('Oz.react'),{rev:z.rev,uid:z.uid,version:z.API_VERSION,skipToto:z.skipToto==='true',onUnmount:function ka(){aa&&aa();}}),ca=function ka(la){var ma=la.threadid,na=la.intentid,oa=la.taskid,pa=la.eventid;c('OzHelpers').info('[mount] storeParams',ma,na,oa,pa);var qa=na?parseInt(na,10):null;c('OzActions').activateThread({threadID:ma,intentID:qa,taskID:oa?parseInt(oa,10):null,eventID:pa?parseInt(pa,10):null});ma&&c('OzAPI').threadFocus(ma,qa);if(!o.data.get(ma))c('OzAPI').fetchCalendar(ma);},da=w(c('OzAPI').thread,500),ea={},fa=function ka(la,ma,na){c('OzHelpers').info('[mount] onThreadEnter',la);ca(la.params);var oa=la.params,pa=oa.threadid,qa=oa.intentid;if(pa)da(pa);if(qa){na();}else{c('OzHelpers').info('[mount] no intent id; computing');if(pa&&ea[pa]){c('OzHelpers').info('[mount] loading intent from history',pa,ea[pa]);ma(c('OzHelpers').threadPath({threadid:pa,intentid:ea[pa]}));na();}else if(pa){c('promiseFinally')(da(pa).then(function(ra){c('OzHelpers').info('[mount] missing intent; looking for last created');var sa=c('OzHelpers').openIntents(ra).maxBy(function(ta){return ta.get('created-at');});if(sa){c('OzHelpers').info('[mount] missing intent; using last created',pa,sa.get('id'));ma(c('OzHelpers').threadPath({threadid:pa,intentid:sa.get('id')}));}else c('OzHelpers').info('[mount] no intent to pick',pa);}),function(ra){return na();}).done();}else{c('OzHelpers').warn('[mount] somehow missing threadid',la);na();}}},ga=function ka(la){c('OzHelpers').info('[mount] onIntentEnter',la);ca(la.params);var ma=la.params,na=ma.threadid,oa=ma.intentid,pa=oa?parseInt(oa,10):null;na&&pa&&(ea[na]=pa);pa&&c('OzAPI').handledEvents(pa);c('OzConfig').ConfigStore.data.getIn(['GK','timeline'])&&na&&pa&&c('OzAPI').tasksForIntent(pa,na);},ha=function ka(la){c('OzHelpers').info('[mount] onThreadLeave',la);c('OzActions').activateThread({threadID:null,intentID:null,taskID:null});},ia=c('React').createElement(i,{component:ba},c('React').createElement(i,{path:'/',component:c('OzInbox.react')},c('React').createElement(i,{path:'/inbox/:threadid',component:c('OzInboxShow.react'),onEnter:fa,onLeave:ha},c('React').createElement(j,{onEnter:function ka(la){var ma=la.params;return ca(ma);},component:c('OzThreadPanel.react')}),c('React').createElement(i,{path:'intent/:intentid',component:c('OzThreadPanel.react'),onEnter:ga}),c('React').createElement(i,{path:'intent/:intentid/task/:taskid',component:c('OzThreadPanel.react'),onEnter:ga}),c('React').createElement(i,{path:'intent/:intentid/event/:eventid',component:c('OzThreadPanel.react'),onEnter:ga}))),c('React').createElement(i,{path:'/all',component:c('OzAll.react')}),c('React').createElement(i,{path:'/merchants',component:c('OzMerchants.react')}),c('React').createElement(i,{path:'/top',component:c('OzTop.react')}),c('React').createElement(i,{path:'/intents',component:c('OzIntentDashboardContainer.react')}),c('React').createElement(i,{path:'/ai',component:c('OzAIDashboardContainer.react')}),c('React').createElement(i,{path:'/feedback',component:c('OzFeedbackDashboard.react')}),c('React').createElement(i,{path:'/trainers',component:c('OzTrainerDashboard.react')}),c('React').createElement(i,{path:'/stats',component:c('OzStatsDashboardContainer.react')}),c('React').createElement(n,{from:'/inbox',to:'/'})),ja=function ka(){c('ReactDOM').render(c('React').createElement(m,{history:k,routes:ia}),y);};ja();q(function(){var ka=c('OzConfig').getStaticConfig('skipSky')==='true',la=c('OzConfig').getStaticConfig('skipAPIInit')==='true';c('OzHelpers').info('[sky] connecting to '+z.skyTopic);if(ka)c('OzActions').updateLoadingState({component:'skywalker',state:'loading',skip:true});var ma=function oa(pa){if(typeof aa==='function')aa();aa=c('OzAPI').realTime(z.skyTopic,function(qa,ra,sa){if(qa){c('OzHelpers').warn('[sky] could not connect: '+qa);if(pa>0){return oa(pa-1);}else c('OzActions').updateLoadingState({component:'skywalker',state:'failed',error:qa,skip:ka});}else{c('OzHelpers').info('[sky] connected to '+z.skyTopic+': '+ra.t,ra);c('OzAPI').repsSync();c('OzActions').updateLoadingState({component:'skywalker',state:'loaded',result:{data:ra,token:sa},skip:ka});}});};ma(3);var na=function oa(pa,qa,ra){ra().then(function(sa){c('OzActions').updateLoadingState({component:qa,state:'loaded',result:sa,skip:la});})['catch'](function(sa){if(pa>0){oa(pa-1,qa,ra);}else c('OzActions').updateLoadingState({component:qa,state:'failed',error:sa,skip:la});}).done();};na(3,'init',c('OzAPI').init);na(3,'wit-intents',c('OzAPI').witIntents);na(3,'merchants',c('OzAPI').merchants);na(3,'humans',c('OzAPI').humans);na(3,'requirements',c('OzAPI').requirements);c('OzServerTime').setup();});}},q=function x(y){var z;if(window.loaded){y();}else (function(){var aa=window.onload;if(typeof aa=='function'){window.onload=function(){try{aa.apply(undefined,arguments);}catch(ba){c('OzHelpers').log('Exception on window,inload',ba);}y.apply(undefined,arguments);};}else window.onload=y;})();},r=/^ozcfg(.+)/;function s(){var x=new (c('URI'))(window.location.href).getQueryData();Object.keys(x).forEach(function(y){if(r.test(y))localStorage.setItem(y,x[y]);});}function t(){var x,y,z,aa={};for(x=0;x<localStorage.length;x++){y=localStorage.key(x);z=y.match(r);if(z&&z.length)aa[z[1]]=localStorage.getItem(y);}return aa;}function u(){s();var x=t(),y,z=document.location.hostname;if(z==='www.oz.wit.ai'){y={skyTopic:'oz/all',env:'prod',scubaCategory:'oz_console',PAGE_ID:'881263441913087',API_PATH:'https://www.oz.wit.ai/api'};}else if(z==='intern.oz.wit.ai'||!x.API_PATH){y={skyTopic:'oz-staging/all',env:'staging',scubaCategory:'oz_console_dev',PAGE_ID:'506060876211905',API_PATH:'https://intern.oz.wit.ai/api'};}else{var aa=z.split('.')[1];y={skyTopic:'oz-dev/'+aa,env:'dev',scubaCategory:'oz_console_dev',PAGE_ID:'1579802578966277'};}y=babelHelpers['extends']({},y,x,{API_VERSION:'20151027'});!y.API_PATH?h(0):void 0;return y;}function v(x,y){var z,aa;return aa=z=function(){var ba,ca;ba=babelHelpers.inherits(da,c('React').Component);ca=ba&&ba.prototype;da.prototype.render=function(){'use strict';return c('React').createElement(x,babelHelpers['extends']({},y,this.props));};function da(){'use strict';ba.apply(this,arguments);}return da;}(),z.displayName='Curried'+x.displayName,aa;}var w=function x(y,z){var aa={},ba={};return function(ca){if(Date.now()-(aa[ca]||0)<=z&&ba[ca]){c('OzHelpers').info('[mount/throttle] using result',ca,ba[ca]);return ba[ca];}else{aa[ca]=Date.now();c('OzHelpers').info('[mount/throttle] running!',ca);return ba[ca]=y(ca);}};};f.exports=p;}),null);